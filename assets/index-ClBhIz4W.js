var QX=Object.defineProperty;var o4=r=>{throw TypeError(r)};var JX=(r,t,n)=>t in r?QX(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n;var Bt=(r,t,n)=>JX(r,typeof t!="symbol"?t+"":t,n),lC=(r,t,n)=>t.has(r)||o4("Cannot "+n);var dt=(r,t,n)=>(lC(r,t,"read from private field"),n?n.call(r):t.get(r)),Jn=(r,t,n)=>t.has(r)?o4("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,n),Hs=(r,t,n,s)=>(lC(r,t,"write to private field"),s?s.call(r,n):t.set(r,n),n),Yr=(r,t,n)=>(lC(r,t,"access private method"),n);function eY(r,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in r)){const a=Object.getOwnPropertyDescriptor(s,i);a&&Object.defineProperty(r,i,a.get?a:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var tY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zD(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function nY(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var t=r.default;if(typeof t=="function"){var n=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var i=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:function(){return r[s]}})}),n}var cC={exports:{}},nm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u4;function rY(){if(u4)return nm;u4=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(s,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var u in i)u!=="key"&&(a[u]=i[u])}else a=i;return i=a.ref,{$$typeof:r,type:s,key:o,ref:i!==void 0?i:null,props:a}}return nm.Fragment=t,nm.jsx=n,nm.jsxs=n,nm}var l4;function sY(){return l4||(l4=1,cC.exports=rY()),cC.exports}var Se=sY(),hC={exports:{}},ln={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c4;function iY(){if(c4)return ln;c4=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function p(z){return z===null||typeof z!="object"?null:(z=f&&z[f]||z["@@iterator"],typeof z=="function"?z:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function v(z,X,Y){this.props=z,this.context=X,this.refs=x,this.updater=Y||g}v.prototype.isReactComponent={},v.prototype.setState=function(z,X){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,X,"setState")},v.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function S(){}S.prototype=v.prototype;function w(z,X,Y){this.props=z,this.context=X,this.refs=x,this.updater=Y||g}var E=w.prototype=new S;E.constructor=w,y(E,v.prototype),E.isPureReactComponent=!0;var _=Array.isArray,D={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function k(z,X,Y,se,ue,fe){return Y=fe.ref,{$$typeof:r,type:z,key:X,ref:Y!==void 0?Y:null,props:fe}}function A(z,X){return k(z.type,X,void 0,void 0,void 0,z.props)}function N(z){return typeof z=="object"&&z!==null&&z.$$typeof===r}function F(z){var X={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(Y){return X[Y]})}var $=/\/+/g;function O(z,X){return typeof z=="object"&&z!==null&&z.key!=null?F(""+z.key):X.toString(36)}function M(){}function B(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(M,M):(z.status="pending",z.then(function(X){z.status==="pending"&&(z.status="fulfilled",z.value=X)},function(X){z.status==="pending"&&(z.status="rejected",z.reason=X)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function U(z,X,Y,se,ue){var fe=typeof z;(fe==="undefined"||fe==="boolean")&&(z=null);var de=!1;if(z===null)de=!0;else switch(fe){case"bigint":case"string":case"number":de=!0;break;case"object":switch(z.$$typeof){case r:case t:de=!0;break;case h:return de=z._init,U(de(z._payload),X,Y,se,ue)}}if(de)return ue=ue(z),de=se===""?"."+O(z,0):se,_(ue)?(Y="",de!=null&&(Y=de.replace($,"$&/")+"/"),U(ue,X,Y,"",function(_e){return _e})):ue!=null&&(N(ue)&&(ue=A(ue,Y+(ue.key==null||z&&z.key===ue.key?"":(""+ue.key).replace($,"$&/")+"/")+de)),X.push(ue)),1;de=0;var be=se===""?".":se+":";if(_(z))for(var Me=0;Me<z.length;Me++)se=z[Me],fe=be+O(se,Me),de+=U(se,X,Y,fe,ue);else if(Me=p(z),typeof Me=="function")for(z=Me.call(z),Me=0;!(se=z.next()).done;)se=se.value,fe=be+O(se,Me++),de+=U(se,X,Y,fe,ue);else if(fe==="object"){if(typeof z.then=="function")return U(B(z),X,Y,se,ue);throw X=String(z),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return de}function V(z,X,Y){if(z==null)return z;var se=[],ue=0;return U(z,se,"","",function(fe){return X.call(Y,fe,ue++)}),se}function Z(z){if(z._status===-1){var X=z._result;X=X(),X.then(function(Y){(z._status===0||z._status===-1)&&(z._status=1,z._result=Y)},function(Y){(z._status===0||z._status===-1)&&(z._status=2,z._result=Y)}),z._status===-1&&(z._status=0,z._result=X)}if(z._status===1)return z._result.default;throw z._result}var J=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function ne(){}return ln.Children={map:V,forEach:function(z,X,Y){V(z,function(){X.apply(this,arguments)},Y)},count:function(z){var X=0;return V(z,function(){X++}),X},toArray:function(z){return V(z,function(X){return X})||[]},only:function(z){if(!N(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ln.Component=v,ln.Fragment=n,ln.Profiler=i,ln.PureComponent=w,ln.StrictMode=s,ln.Suspense=l,ln.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ln.__COMPILER_RUNTIME={__proto__:null,c:function(z){return D.H.useMemoCache(z)}},ln.cache=function(z){return function(){return z.apply(null,arguments)}},ln.cloneElement=function(z,X,Y){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var se=y({},z.props),ue=z.key,fe=void 0;if(X!=null)for(de in X.ref!==void 0&&(fe=void 0),X.key!==void 0&&(ue=""+X.key),X)!I.call(X,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&X.ref===void 0||(se[de]=X[de]);var de=arguments.length-2;if(de===1)se.children=Y;else if(1<de){for(var be=Array(de),Me=0;Me<de;Me++)be[Me]=arguments[Me+2];se.children=be}return k(z.type,ue,void 0,void 0,fe,se)},ln.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:a,_context:z},z},ln.createElement=function(z,X,Y){var se,ue={},fe=null;if(X!=null)for(se in X.key!==void 0&&(fe=""+X.key),X)I.call(X,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(ue[se]=X[se]);var de=arguments.length-2;if(de===1)ue.children=Y;else if(1<de){for(var be=Array(de),Me=0;Me<de;Me++)be[Me]=arguments[Me+2];ue.children=be}if(z&&z.defaultProps)for(se in de=z.defaultProps,de)ue[se]===void 0&&(ue[se]=de[se]);return k(z,fe,void 0,void 0,null,ue)},ln.createRef=function(){return{current:null}},ln.forwardRef=function(z){return{$$typeof:u,render:z}},ln.isValidElement=N,ln.lazy=function(z){return{$$typeof:h,_payload:{_status:-1,_result:z},_init:Z}},ln.memo=function(z,X){return{$$typeof:c,type:z,compare:X===void 0?null:X}},ln.startTransition=function(z){var X=D.T,Y={};D.T=Y;try{var se=z(),ue=D.S;ue!==null&&ue(Y,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ne,J)}catch(fe){J(fe)}finally{D.T=X}},ln.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ln.use=function(z){return D.H.use(z)},ln.useActionState=function(z,X,Y){return D.H.useActionState(z,X,Y)},ln.useCallback=function(z,X){return D.H.useCallback(z,X)},ln.useContext=function(z){return D.H.useContext(z)},ln.useDebugValue=function(){},ln.useDeferredValue=function(z,X){return D.H.useDeferredValue(z,X)},ln.useEffect=function(z,X,Y){var se=D.H;if(typeof Y=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(z,X)},ln.useId=function(){return D.H.useId()},ln.useImperativeHandle=function(z,X,Y){return D.H.useImperativeHandle(z,X,Y)},ln.useInsertionEffect=function(z,X){return D.H.useInsertionEffect(z,X)},ln.useLayoutEffect=function(z,X){return D.H.useLayoutEffect(z,X)},ln.useMemo=function(z,X){return D.H.useMemo(z,X)},ln.useOptimistic=function(z,X){return D.H.useOptimistic(z,X)},ln.useReducer=function(z,X,Y){return D.H.useReducer(z,X,Y)},ln.useRef=function(z){return D.H.useRef(z)},ln.useState=function(z){return D.H.useState(z)},ln.useSyncExternalStore=function(z,X,Y){return D.H.useSyncExternalStore(z,X,Y)},ln.useTransition=function(){return D.H.useTransition()},ln.version="19.1.0",ln}var h4;function UD(){return h4||(h4=1,hC.exports=iY()),hC.exports}var ht=UD(),fC={exports:{}},rm={},dC={exports:{}},pC={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f4;function aY(){return f4||(f4=1,function(r){function t(V,Z){var J=V.length;V.push(Z);e:for(;0<J;){var ne=J-1>>>1,z=V[ne];if(0<i(z,Z))V[ne]=Z,V[J]=z,J=ne;else break e}}function n(V){return V.length===0?null:V[0]}function s(V){if(V.length===0)return null;var Z=V[0],J=V.pop();if(J!==Z){V[0]=J;e:for(var ne=0,z=V.length,X=z>>>1;ne<X;){var Y=2*(ne+1)-1,se=V[Y],ue=Y+1,fe=V[ue];if(0>i(se,J))ue<z&&0>i(fe,se)?(V[ne]=fe,V[ue]=J,ne=ue):(V[ne]=se,V[Y]=J,ne=Y);else if(ue<z&&0>i(fe,J))V[ne]=fe,V[ue]=J,ne=ue;else break e}}return Z}function i(V,Z){var J=V.sortIndex-Z.sortIndex;return J!==0?J:V.id-Z.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();r.unstable_now=function(){return o.now()-u}}var l=[],c=[],h=1,f=null,p=3,g=!1,y=!1,x=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function _(V){for(var Z=n(c);Z!==null;){if(Z.callback===null)s(c);else if(Z.startTime<=V)s(c),Z.sortIndex=Z.expirationTime,t(l,Z);else break;Z=n(c)}}function D(V){if(x=!1,_(V),!y)if(n(l)!==null)y=!0,I||(I=!0,O());else{var Z=n(c);Z!==null&&U(D,Z.startTime-V)}}var I=!1,k=-1,A=5,N=-1;function F(){return v?!0:!(r.unstable_now()-N<A)}function $(){if(v=!1,I){var V=r.unstable_now();N=V;var Z=!0;try{e:{y=!1,x&&(x=!1,w(k),k=-1),g=!0;var J=p;try{t:{for(_(V),f=n(l);f!==null&&!(f.expirationTime>V&&F());){var ne=f.callback;if(typeof ne=="function"){f.callback=null,p=f.priorityLevel;var z=ne(f.expirationTime<=V);if(V=r.unstable_now(),typeof z=="function"){f.callback=z,_(V),Z=!0;break t}f===n(l)&&s(l),_(V)}else s(l);f=n(l)}if(f!==null)Z=!0;else{var X=n(c);X!==null&&U(D,X.startTime-V),Z=!1}}break e}finally{f=null,p=J,g=!1}Z=void 0}}finally{Z?O():I=!1}}}var O;if(typeof E=="function")O=function(){E($)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,B=M.port2;M.port1.onmessage=$,O=function(){B.postMessage(null)}}else O=function(){S($,0)};function U(V,Z){k=S(function(){V(r.unstable_now())},Z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return p},r.unstable_next=function(V){switch(p){case 1:case 2:case 3:var Z=3;break;default:Z=p}var J=p;p=Z;try{return V()}finally{p=J}},r.unstable_requestPaint=function(){v=!0},r.unstable_runWithPriority=function(V,Z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var J=p;p=V;try{return Z()}finally{p=J}},r.unstable_scheduleCallback=function(V,Z,J){var ne=r.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ne+J:ne):J=ne,V){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=J+z,V={id:h++,callback:Z,priorityLevel:V,startTime:J,expirationTime:z,sortIndex:-1},J>ne?(V.sortIndex=J,t(c,V),n(l)===null&&V===n(c)&&(x?(w(k),k=-1):x=!0,U(D,J-ne))):(V.sortIndex=z,t(l,V),y||g||(y=!0,I||(I=!0,O()))),V},r.unstable_shouldYield=F,r.unstable_wrapCallback=function(V){var Z=p;return function(){var J=p;p=Z;try{return V.apply(this,arguments)}finally{p=J}}}}(pC)),pC}var d4;function oY(){return d4||(d4=1,dC.exports=aY()),dC.exports}var mC={exports:{}},qs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p4;function uY(){if(p4)return qs;p4=1;var r=UD();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(l,c,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:f==null?null:""+f,children:l,containerInfo:c,implementation:h}}var o=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,qs.createPortal=function(l,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return a(l,c,null,h)},qs.flushSync=function(l){var c=o.T,h=s.p;try{if(o.T=null,s.p=2,l)return l()}finally{o.T=c,s.p=h,s.d.f()}},qs.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,s.d.C(l,c))},qs.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},qs.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var h=c.as,f=u(h,c.crossOrigin),p=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;h==="style"?s.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:p,fetchPriority:g}):h==="script"&&s.d.X(l,{crossOrigin:f,integrity:p,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},qs.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var h=u(c.as,c.crossOrigin);s.d.M(l,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&s.d.M(l)},qs.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var h=c.as,f=u(h,c.crossOrigin);s.d.L(l,h,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},qs.preloadModule=function(l,c){if(typeof l=="string")if(c){var h=u(c.as,c.crossOrigin);s.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else s.d.m(l)},qs.requestFormReset=function(l){s.d.r(l)},qs.unstable_batchedUpdates=function(l,c){return l(c)},qs.useFormState=function(l,c,h){return o.H.useFormState(l,c,h)},qs.useFormStatus=function(){return o.H.useHostTransitionStatus()},qs.version="19.1.0",qs}var m4;function lY(){if(m4)return mC.exports;m4=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),mC.exports=uY(),mC.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g4;function cY(){if(g4)return rm;g4=1;var r=oY(),t=UD(),n=lY();function s(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var m=d,b=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(b=m.return),d=m.return;while(d)}return m.tag===3?b:null}function o(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function u(d){if(a(d)!==d)throw Error(s(188))}function l(d){var m=d.alternate;if(!m){if(m=a(d),m===null)throw Error(s(188));return m!==d?null:d}for(var b=d,C=m;;){var T=b.return;if(T===null)break;var R=T.alternate;if(R===null){if(C=T.return,C!==null){b=C;continue}break}if(T.child===R.child){for(R=T.child;R;){if(R===b)return u(T),d;if(R===C)return u(T),m;R=R.sibling}throw Error(s(188))}if(b.return!==C.return)b=T,C=R;else{for(var j=!1,ee=T.child;ee;){if(ee===b){j=!0,b=T,C=R;break}if(ee===C){j=!0,C=T,b=R;break}ee=ee.sibling}if(!j){for(ee=R.child;ee;){if(ee===b){j=!0,b=R,C=T;break}if(ee===C){j=!0,C=R,b=T;break}ee=ee.sibling}if(!j)throw Error(s(189))}}if(b.alternate!==C)throw Error(s(190))}if(b.tag!==3)throw Error(s(188));return b.stateNode.current===b?d:m}function c(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=c(d),m!==null)return m;d=d.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),E=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),$=Symbol.iterator;function O(d){return d===null||typeof d!="object"?null:(d=$&&d[$]||d["@@iterator"],typeof d=="function"?d:null)}var M=Symbol.for("react.client.reference");function B(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===M?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case y:return"Fragment";case v:return"Profiler";case x:return"StrictMode";case D:return"Suspense";case I:return"SuspenseList";case N:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case g:return"Portal";case E:return(d.displayName||"Context")+".Provider";case w:return(d._context.displayName||"Context")+".Consumer";case _:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case k:return m=d.displayName||null,m!==null?m:B(d.type)||"Memo";case A:m=d._payload,d=d._init;try{return B(d(m))}catch{}}return null}var U=Array.isArray,V=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ne=[],z=-1;function X(d){return{current:d}}function Y(d){0>z||(d.current=ne[z],ne[z]=null,z--)}function se(d,m){z++,ne[z]=d.current,d.current=m}var ue=X(null),fe=X(null),de=X(null),be=X(null);function Me(d,m){switch(se(de,m),se(fe,d),se(ue,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?O$(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=O$(m),d=M$(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}Y(ue),se(ue,d)}function _e(){Y(ue),Y(fe),Y(de)}function Ne(d){d.memoizedState!==null&&se(be,d);var m=ue.current,b=M$(m,d.type);m!==b&&(se(fe,d),se(ue,b))}function ve(d){fe.current===d&&(Y(ue),Y(fe)),be.current===d&&(Y(be),Zp._currentValue=J)}var Pe=Object.prototype.hasOwnProperty,et=r.unstable_scheduleCallback,Ve=r.unstable_cancelCallback,re=r.unstable_shouldYield,Q=r.unstable_requestPaint,ce=r.unstable_now,xe=r.unstable_getCurrentPriorityLevel,Ge=r.unstable_ImmediatePriority,Oe=r.unstable_UserBlockingPriority,lt=r.unstable_NormalPriority,ot=r.unstable_LowPriority,bt=r.unstable_IdlePriority,Et=r.log,ft=r.unstable_setDisableYieldValue,It=null,ut=null;function wt(d){if(typeof Et=="function"&&ft(d),ut&&typeof ut.setStrictMode=="function")try{ut.setStrictMode(It,d)}catch{}}var St=Math.clz32?Math.clz32:sn,hr=Math.log,qn=Math.LN2;function sn(d){return d>>>=0,d===0?32:31-(hr(d)/qn|0)|0}var Pn=256,P=4194304;function K(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function ie(d,m,b){var C=d.pendingLanes;if(C===0)return 0;var T=0,R=d.suspendedLanes,j=d.pingedLanes;d=d.warmLanes;var ee=C&134217727;return ee!==0?(C=ee&~R,C!==0?T=K(C):(j&=ee,j!==0?T=K(j):b||(b=ee&~d,b!==0&&(T=K(b))))):(ee=C&~R,ee!==0?T=K(ee):j!==0?T=K(j):b||(b=C&~d,b!==0&&(T=K(b)))),T===0?0:m!==0&&m!==T&&(m&R)===0&&(R=T&-T,b=m&-m,R>=b||R===32&&(b&4194048)!==0)?m:T}function le(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function ge(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xe(){var d=Pn;return Pn<<=1,(Pn&4194048)===0&&(Pn=256),d}function nt(){var d=P;return P<<=1,(P&62914560)===0&&(P=4194304),d}function gt(d){for(var m=[],b=0;31>b;b++)m.push(d);return m}function Ft(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function qt(d,m,b,C,T,R){var j=d.pendingLanes;d.pendingLanes=b,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=b,d.entangledLanes&=b,d.errorRecoveryDisabledLanes&=b,d.shellSuspendCounter=0;var ee=d.entanglements,pe=d.expirationTimes,Be=d.hiddenUpdates;for(b=j&~b;0<b;){var tt=31-St(b),st=1<<tt;ee[tt]=0,pe[tt]=-1;var ze=Be[tt];if(ze!==null)for(Be[tt]=null,tt=0;tt<ze.length;tt++){var je=ze[tt];je!==null&&(je.lane&=-536870913)}b&=~st}C!==0&&Vn(d,C,0),R!==0&&T===0&&d.tag!==0&&(d.suspendedLanes|=R&~(j&~m))}function Vn(d,m,b){d.pendingLanes|=m,d.suspendedLanes&=~m;var C=31-St(m);d.entangledLanes|=m,d.entanglements[C]=d.entanglements[C]|1073741824|b&4194090}function L(d,m){var b=d.entangledLanes|=m;for(d=d.entanglements;b;){var C=31-St(b),T=1<<C;T&m|d[C]&m&&(d[C]|=m),b&=~T}}function q(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function W(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function H(){var d=Z.p;return d!==0?d:(d=window.event,d===void 0?32:t4(d.type))}function ae(d,m){var b=Z.p;try{return Z.p=d,m()}finally{Z.p=b}}var qe=Math.random().toString(36).slice(2),Ze="__reactFiber$"+qe,Qe="__reactProps$"+qe,ct="__reactContainer$"+qe,Gt="__reactEvents$"+qe,pn="__reactListeners$"+qe,ws="__reactHandles$"+qe,Br="__reactResources$"+qe,oo="__reactMarker$"+qe;function Rh(d){delete d[Ze],delete d[Qe],delete d[Gt],delete d[pn],delete d[ws]}function Ms(d){var m=d[Ze];if(m)return m;for(var b=d.parentNode;b;){if(m=b[ct]||b[Ze]){if(b=m.alternate,m.child!==null||b!==null&&b.child!==null)for(d=V$(d);d!==null;){if(b=d[Ze])return b;d=V$(d)}return m}d=b,b=d.parentNode}return null}function Oh(d){if(d=d[Ze]||d[ct]){var m=d.tag;if(m===5||m===6||m===13||m===26||m===27||m===3)return d}return null}function lp(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(s(33))}function Mh(d){var m=d[Br];return m||(m=d[Br]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Ss(d){d[oo]=!0}var CA=new Set,_A={};function Zl(d,m){Lh(d,m),Lh(d+"Capture",m)}function Lh(d,m){for(_A[d]=m,d=0;d<m.length;d++)CA.add(m[d])}var jq=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),EA={},DA={};function Wq(d){return Pe.call(DA,d)?!0:Pe.call(EA,d)?!1:jq.test(d)?DA[d]=!0:(EA[d]=!0,!1)}function a1(d,m,b){if(Wq(m))if(b===null)d.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var C=m.toLowerCase().slice(0,5);if(C!=="data-"&&C!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+b)}}function o1(d,m,b){if(b===null)d.removeAttribute(m);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+b)}}function Go(d,m,b,C){if(C===null)d.removeAttribute(b);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(b);return}d.setAttributeNS(m,b,""+C)}}var rw,TA;function Bh(d){if(rw===void 0)try{throw Error()}catch(b){var m=b.stack.trim().match(/\n( *(at )?)/);rw=m&&m[1]||"",TA=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rw+d+TA}var sw=!1;function iw(d,m){if(!d||sw)return"";sw=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var C={DetermineComponentFrameRoot:function(){try{if(m){var st=function(){throw Error()};if(Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(je){var ze=je}Reflect.construct(d,[],st)}else{try{st.call()}catch(je){ze=je}d.call(st.prototype)}}else{try{throw Error()}catch(je){ze=je}(st=d())&&typeof st.catch=="function"&&st.catch(function(){})}}catch(je){if(je&&ze&&typeof je.stack=="string")return[je.stack,ze.stack]}return[null,null]}};C.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(C.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(C.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=C.DetermineComponentFrameRoot(),j=R[0],ee=R[1];if(j&&ee){var pe=j.split(`
`),Be=ee.split(`
`);for(T=C=0;C<pe.length&&!pe[C].includes("DetermineComponentFrameRoot");)C++;for(;T<Be.length&&!Be[T].includes("DetermineComponentFrameRoot");)T++;if(C===pe.length||T===Be.length)for(C=pe.length-1,T=Be.length-1;1<=C&&0<=T&&pe[C]!==Be[T];)T--;for(;1<=C&&0<=T;C--,T--)if(pe[C]!==Be[T]){if(C!==1||T!==1)do if(C--,T--,0>T||pe[C]!==Be[T]){var tt=`
`+pe[C].replace(" at new "," at ");return d.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",d.displayName)),tt}while(1<=C&&0<=T);break}}}finally{sw=!1,Error.prepareStackTrace=b}return(b=d?d.displayName||d.name:"")?Bh(b):""}function Hq(d){switch(d.tag){case 26:case 27:case 5:return Bh(d.type);case 16:return Bh("Lazy");case 13:return Bh("Suspense");case 19:return Bh("SuspenseList");case 0:case 15:return iw(d.type,!1);case 11:return iw(d.type.render,!1);case 1:return iw(d.type,!0);case 31:return Bh("Activity");default:return""}}function NA(d){try{var m="";do m+=Hq(d),d=d.return;while(d);return m}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function ra(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function kA(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function qq(d){var m=kA(d)?"checked":"value",b=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),C=""+d[m];if(!d.hasOwnProperty(m)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var T=b.get,R=b.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return T.call(this)},set:function(j){C=""+j,R.call(this,j)}}),Object.defineProperty(d,m,{enumerable:b.enumerable}),{getValue:function(){return C},setValue:function(j){C=""+j},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function u1(d){d._valueTracker||(d._valueTracker=qq(d))}function AA(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var b=m.getValue(),C="";return d&&(C=kA(d)?d.checked?"true":"false":d.value),d=C,d!==b?(m.setValue(d),!0):!1}function l1(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var Kq=/[\n"\\]/g;function sa(d){return d.replace(Kq,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function aw(d,m,b,C,T,R,j,ee){d.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?d.type=j:d.removeAttribute("type"),m!=null?j==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+ra(m)):d.value!==""+ra(m)&&(d.value=""+ra(m)):j!=="submit"&&j!=="reset"||d.removeAttribute("value"),m!=null?ow(d,j,ra(m)):b!=null?ow(d,j,ra(b)):C!=null&&d.removeAttribute("value"),T==null&&R!=null&&(d.defaultChecked=!!R),T!=null&&(d.checked=T&&typeof T!="function"&&typeof T!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?d.name=""+ra(ee):d.removeAttribute("name")}function IA(d,m,b,C,T,R,j,ee){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(d.type=R),m!=null||b!=null){if(!(R!=="submit"&&R!=="reset"||m!=null))return;b=b!=null?""+ra(b):"",m=m!=null?""+ra(m):b,ee||m===d.value||(d.value=m),d.defaultValue=m}C=C??T,C=typeof C!="function"&&typeof C!="symbol"&&!!C,d.checked=ee?d.checked:!!C,d.defaultChecked=!!C,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(d.name=j)}function ow(d,m,b){m==="number"&&l1(d.ownerDocument)===d||d.defaultValue===""+b||(d.defaultValue=""+b)}function Ph(d,m,b,C){if(d=d.options,m){m={};for(var T=0;T<b.length;T++)m["$"+b[T]]=!0;for(b=0;b<d.length;b++)T=m.hasOwnProperty("$"+d[b].value),d[b].selected!==T&&(d[b].selected=T),T&&C&&(d[b].defaultSelected=!0)}else{for(b=""+ra(b),m=null,T=0;T<d.length;T++){if(d[T].value===b){d[T].selected=!0,C&&(d[T].defaultSelected=!0);return}m!==null||d[T].disabled||(m=d[T])}m!==null&&(m.selected=!0)}}function $A(d,m,b){if(m!=null&&(m=""+ra(m),m!==d.value&&(d.value=m),b==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=b!=null?""+ra(b):""}function FA(d,m,b,C){if(m==null){if(C!=null){if(b!=null)throw Error(s(92));if(U(C)){if(1<C.length)throw Error(s(93));C=C[0]}b=C}b==null&&(b=""),m=b}b=ra(m),d.defaultValue=b,C=d.textContent,C===b&&C!==""&&C!==null&&(d.value=C)}function Vh(d,m){if(m){var b=d.firstChild;if(b&&b===d.lastChild&&b.nodeType===3){b.nodeValue=m;return}}d.textContent=m}var Xq=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function RA(d,m,b){var C=m.indexOf("--")===0;b==null||typeof b=="boolean"||b===""?C?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":C?d.setProperty(m,b):typeof b!="number"||b===0||Xq.has(m)?m==="float"?d.cssFloat=b:d[m]=(""+b).trim():d[m]=b+"px"}function OA(d,m,b){if(m!=null&&typeof m!="object")throw Error(s(62));if(d=d.style,b!=null){for(var C in b)!b.hasOwnProperty(C)||m!=null&&m.hasOwnProperty(C)||(C.indexOf("--")===0?d.setProperty(C,""):C==="float"?d.cssFloat="":d[C]="");for(var T in m)C=m[T],m.hasOwnProperty(T)&&b[T]!==C&&RA(d,T,C)}else for(var R in m)m.hasOwnProperty(R)&&RA(d,R,m[R])}function uw(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yq=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zq=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function c1(d){return Zq.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var lw=null;function cw(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var zh=null,Uh=null;function MA(d){var m=Oh(d);if(m&&(d=m.stateNode)){var b=d[Qe]||null;e:switch(d=m.stateNode,m.type){case"input":if(aw(d,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name),m=b.name,b.type==="radio"&&m!=null){for(b=d;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll('input[name="'+sa(""+m)+'"][type="radio"]'),m=0;m<b.length;m++){var C=b[m];if(C!==d&&C.form===d.form){var T=C[Qe]||null;if(!T)throw Error(s(90));aw(C,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(m=0;m<b.length;m++)C=b[m],C.form===d.form&&AA(C)}break e;case"textarea":$A(d,b.value,b.defaultValue);break e;case"select":m=b.value,m!=null&&Ph(d,!!b.multiple,m,!1)}}}var hw=!1;function LA(d,m,b){if(hw)return d(m,b);hw=!0;try{var C=d(m);return C}finally{if(hw=!1,(zh!==null||Uh!==null)&&(X1(),zh&&(m=zh,d=Uh,Uh=zh=null,MA(m),d)))for(m=0;m<d.length;m++)MA(d[m])}}function cp(d,m){var b=d.stateNode;if(b===null)return null;var C=b[Qe]||null;if(C===null)return null;b=C[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(d=d.type,C=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!C;break e;default:d=!1}if(d)return null;if(b&&typeof b!="function")throw Error(s(231,m,typeof b));return b}var jo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fw=!1;if(jo)try{var hp={};Object.defineProperty(hp,"passive",{get:function(){fw=!0}}),window.addEventListener("test",hp,hp),window.removeEventListener("test",hp,hp)}catch{fw=!1}var Ru=null,dw=null,h1=null;function BA(){if(h1)return h1;var d,m=dw,b=m.length,C,T="value"in Ru?Ru.value:Ru.textContent,R=T.length;for(d=0;d<b&&m[d]===T[d];d++);var j=b-d;for(C=1;C<=j&&m[b-C]===T[R-C];C++);return h1=T.slice(d,1<C?1-C:void 0)}function f1(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function d1(){return!0}function PA(){return!1}function yi(d){function m(b,C,T,R,j){this._reactName=b,this._targetInst=T,this.type=C,this.nativeEvent=R,this.target=j,this.currentTarget=null;for(var ee in d)d.hasOwnProperty(ee)&&(b=d[ee],this[ee]=b?b(R):R[ee]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?d1:PA,this.isPropagationStopped=PA,this}return h(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=d1)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=d1)},persist:function(){},isPersistent:d1}),m}var Ql={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},p1=yi(Ql),fp=h({},Ql,{view:0,detail:0}),Qq=yi(fp),pw,mw,dp,m1=h({},fp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yw,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==dp&&(dp&&d.type==="mousemove"?(pw=d.screenX-dp.screenX,mw=d.screenY-dp.screenY):mw=pw=0,dp=d),pw)},movementY:function(d){return"movementY"in d?d.movementY:mw}}),VA=yi(m1),Jq=h({},m1,{dataTransfer:0}),eK=yi(Jq),tK=h({},fp,{relatedTarget:0}),gw=yi(tK),nK=h({},Ql,{animationName:0,elapsedTime:0,pseudoElement:0}),rK=yi(nK),sK=h({},Ql,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),iK=yi(sK),aK=h({},Ql,{data:0}),zA=yi(aK),oK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cK(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=lK[d])?!!m[d]:!1}function yw(){return cK}var hK=h({},fp,{key:function(d){if(d.key){var m=oK[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=f1(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?uK[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yw,charCode:function(d){return d.type==="keypress"?f1(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?f1(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),fK=yi(hK),dK=h({},m1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UA=yi(dK),pK=h({},fp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yw}),mK=yi(pK),gK=h({},Ql,{propertyName:0,elapsedTime:0,pseudoElement:0}),yK=yi(gK),xK=h({},m1,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),bK=yi(xK),vK=h({},Ql,{newState:0,oldState:0}),wK=yi(vK),SK=[9,13,27,32],xw=jo&&"CompositionEvent"in window,pp=null;jo&&"documentMode"in document&&(pp=document.documentMode);var CK=jo&&"TextEvent"in window&&!pp,GA=jo&&(!xw||pp&&8<pp&&11>=pp),jA=" ",WA=!1;function HA(d,m){switch(d){case"keyup":return SK.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qA(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Gh=!1;function _K(d,m){switch(d){case"compositionend":return qA(m);case"keypress":return m.which!==32?null:(WA=!0,jA);case"textInput":return d=m.data,d===jA&&WA?null:d;default:return null}}function EK(d,m){if(Gh)return d==="compositionend"||!xw&&HA(d,m)?(d=BA(),h1=dw=Ru=null,Gh=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return GA&&m.locale!=="ko"?null:m.data;default:return null}}var DK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KA(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!DK[d.type]:m==="textarea"}function XA(d,m,b,C){zh?Uh?Uh.push(C):Uh=[C]:zh=C,m=ty(m,"onChange"),0<m.length&&(b=new p1("onChange","change",null,b,C),d.push({event:b,listeners:m}))}var mp=null,gp=null;function TK(d){A$(d,0)}function g1(d){var m=lp(d);if(AA(m))return d}function YA(d,m){if(d==="change")return m}var ZA=!1;if(jo){var bw;if(jo){var vw="oninput"in document;if(!vw){var QA=document.createElement("div");QA.setAttribute("oninput","return;"),vw=typeof QA.oninput=="function"}bw=vw}else bw=!1;ZA=bw&&(!document.documentMode||9<document.documentMode)}function JA(){mp&&(mp.detachEvent("onpropertychange",eI),gp=mp=null)}function eI(d){if(d.propertyName==="value"&&g1(gp)){var m=[];XA(m,gp,d,cw(d)),LA(TK,m)}}function NK(d,m,b){d==="focusin"?(JA(),mp=m,gp=b,mp.attachEvent("onpropertychange",eI)):d==="focusout"&&JA()}function kK(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return g1(gp)}function AK(d,m){if(d==="click")return g1(m)}function IK(d,m){if(d==="input"||d==="change")return g1(m)}function $K(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var Li=typeof Object.is=="function"?Object.is:$K;function yp(d,m){if(Li(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var b=Object.keys(d),C=Object.keys(m);if(b.length!==C.length)return!1;for(C=0;C<b.length;C++){var T=b[C];if(!Pe.call(m,T)||!Li(d[T],m[T]))return!1}return!0}function tI(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function nI(d,m){var b=tI(d);d=0;for(var C;b;){if(b.nodeType===3){if(C=d+b.textContent.length,d<=m&&C>=m)return{node:b,offset:m-d};d=C}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=tI(b)}}function rI(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?rI(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function sI(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=l1(d.document);m instanceof d.HTMLIFrameElement;){try{var b=typeof m.contentWindow.location.href=="string"}catch{b=!1}if(b)d=m.contentWindow;else break;m=l1(d.document)}return m}function ww(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var FK=jo&&"documentMode"in document&&11>=document.documentMode,jh=null,Sw=null,xp=null,Cw=!1;function iI(d,m,b){var C=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Cw||jh==null||jh!==l1(C)||(C=jh,"selectionStart"in C&&ww(C)?C={start:C.selectionStart,end:C.selectionEnd}:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection(),C={anchorNode:C.anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset}),xp&&yp(xp,C)||(xp=C,C=ty(Sw,"onSelect"),0<C.length&&(m=new p1("onSelect","select",null,m,b),d.push({event:m,listeners:C}),m.target=jh)))}function Jl(d,m){var b={};return b[d.toLowerCase()]=m.toLowerCase(),b["Webkit"+d]="webkit"+m,b["Moz"+d]="moz"+m,b}var Wh={animationend:Jl("Animation","AnimationEnd"),animationiteration:Jl("Animation","AnimationIteration"),animationstart:Jl("Animation","AnimationStart"),transitionrun:Jl("Transition","TransitionRun"),transitionstart:Jl("Transition","TransitionStart"),transitioncancel:Jl("Transition","TransitionCancel"),transitionend:Jl("Transition","TransitionEnd")},_w={},aI={};jo&&(aI=document.createElement("div").style,"AnimationEvent"in window||(delete Wh.animationend.animation,delete Wh.animationiteration.animation,delete Wh.animationstart.animation),"TransitionEvent"in window||delete Wh.transitionend.transition);function ec(d){if(_w[d])return _w[d];if(!Wh[d])return d;var m=Wh[d],b;for(b in m)if(m.hasOwnProperty(b)&&b in aI)return _w[d]=m[b];return d}var oI=ec("animationend"),uI=ec("animationiteration"),lI=ec("animationstart"),RK=ec("transitionrun"),OK=ec("transitionstart"),MK=ec("transitioncancel"),cI=ec("transitionend"),hI=new Map,Ew="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ew.push("scrollEnd");function Ba(d,m){hI.set(d,m),Zl(m,[d])}var fI=new WeakMap;function ia(d,m){if(typeof d=="object"&&d!==null){var b=fI.get(d);return b!==void 0?b:(m={value:d,source:m,stack:NA(m)},fI.set(d,m),m)}return{value:d,source:m,stack:NA(m)}}var aa=[],Hh=0,Dw=0;function y1(){for(var d=Hh,m=Dw=Hh=0;m<d;){var b=aa[m];aa[m++]=null;var C=aa[m];aa[m++]=null;var T=aa[m];aa[m++]=null;var R=aa[m];if(aa[m++]=null,C!==null&&T!==null){var j=C.pending;j===null?T.next=T:(T.next=j.next,j.next=T),C.pending=T}R!==0&&dI(b,T,R)}}function x1(d,m,b,C){aa[Hh++]=d,aa[Hh++]=m,aa[Hh++]=b,aa[Hh++]=C,Dw|=C,d.lanes|=C,d=d.alternate,d!==null&&(d.lanes|=C)}function Tw(d,m,b,C){return x1(d,m,b,C),b1(d)}function qh(d,m){return x1(d,null,null,m),b1(d)}function dI(d,m,b){d.lanes|=b;var C=d.alternate;C!==null&&(C.lanes|=b);for(var T=!1,R=d.return;R!==null;)R.childLanes|=b,C=R.alternate,C!==null&&(C.childLanes|=b),R.tag===22&&(d=R.stateNode,d===null||d._visibility&1||(T=!0)),d=R,R=R.return;return d.tag===3?(R=d.stateNode,T&&m!==null&&(T=31-St(b),d=R.hiddenUpdates,C=d[T],C===null?d[T]=[m]:C.push(m),m.lane=b|536870912),R):null}function b1(d){if(50<Gp)throw Gp=0,FS=null,Error(s(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var Kh={};function LK(d,m,b,C){this.tag=d,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(d,m,b,C){return new LK(d,m,b,C)}function Nw(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Wo(d,m){var b=d.alternate;return b===null?(b=Bi(d.tag,m,d.key,d.mode),b.elementType=d.elementType,b.type=d.type,b.stateNode=d.stateNode,b.alternate=d,d.alternate=b):(b.pendingProps=m,b.type=d.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=d.flags&65011712,b.childLanes=d.childLanes,b.lanes=d.lanes,b.child=d.child,b.memoizedProps=d.memoizedProps,b.memoizedState=d.memoizedState,b.updateQueue=d.updateQueue,m=d.dependencies,b.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},b.sibling=d.sibling,b.index=d.index,b.ref=d.ref,b.refCleanup=d.refCleanup,b}function pI(d,m){d.flags&=65011714;var b=d.alternate;return b===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=b.childLanes,d.lanes=b.lanes,d.child=b.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=b.memoizedProps,d.memoizedState=b.memoizedState,d.updateQueue=b.updateQueue,d.type=b.type,m=b.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function v1(d,m,b,C,T,R){var j=0;if(C=d,typeof d=="function")Nw(d)&&(j=1);else if(typeof d=="string")j=PX(d,b,ue.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case N:return d=Bi(31,b,m,T),d.elementType=N,d.lanes=R,d;case y:return tc(b.children,T,R,m);case x:j=8,T|=24;break;case v:return d=Bi(12,b,m,T|2),d.elementType=v,d.lanes=R,d;case D:return d=Bi(13,b,m,T),d.elementType=D,d.lanes=R,d;case I:return d=Bi(19,b,m,T),d.elementType=I,d.lanes=R,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case S:case E:j=10;break e;case w:j=9;break e;case _:j=11;break e;case k:j=14;break e;case A:j=16,C=null;break e}j=29,b=Error(s(130,d===null?"null":typeof d,"")),C=null}return m=Bi(j,b,m,T),m.elementType=d,m.type=C,m.lanes=R,m}function tc(d,m,b,C){return d=Bi(7,d,C,m),d.lanes=b,d}function kw(d,m,b){return d=Bi(6,d,null,m),d.lanes=b,d}function Aw(d,m,b){return m=Bi(4,d.children!==null?d.children:[],d.key,m),m.lanes=b,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var Xh=[],Yh=0,w1=null,S1=0,oa=[],ua=0,nc=null,Ho=1,qo="";function rc(d,m){Xh[Yh++]=S1,Xh[Yh++]=w1,w1=d,S1=m}function mI(d,m,b){oa[ua++]=Ho,oa[ua++]=qo,oa[ua++]=nc,nc=d;var C=Ho;d=qo;var T=32-St(C)-1;C&=~(1<<T),b+=1;var R=32-St(m)+T;if(30<R){var j=T-T%5;R=(C&(1<<j)-1).toString(32),C>>=j,T-=j,Ho=1<<32-St(m)+T|b<<T|C,qo=R+d}else Ho=1<<R|b<<T|C,qo=d}function Iw(d){d.return!==null&&(rc(d,1),mI(d,1,0))}function $w(d){for(;d===w1;)w1=Xh[--Yh],Xh[Yh]=null,S1=Xh[--Yh],Xh[Yh]=null;for(;d===nc;)nc=oa[--ua],oa[ua]=null,qo=oa[--ua],oa[ua]=null,Ho=oa[--ua],oa[ua]=null}var si=null,Ir=null,zn=!1,sc=null,uo=!1,Fw=Error(s(519));function ic(d){var m=Error(s(418,""));throw wp(ia(m,d)),Fw}function gI(d){var m=d.stateNode,b=d.type,C=d.memoizedProps;switch(m[Ze]=d,m[Qe]=C,b){case"dialog":Sn("cancel",m),Sn("close",m);break;case"iframe":case"object":case"embed":Sn("load",m);break;case"video":case"audio":for(b=0;b<Wp.length;b++)Sn(Wp[b],m);break;case"source":Sn("error",m);break;case"img":case"image":case"link":Sn("error",m),Sn("load",m);break;case"details":Sn("toggle",m);break;case"input":Sn("invalid",m),IA(m,C.value,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name,!0),u1(m);break;case"select":Sn("invalid",m);break;case"textarea":Sn("invalid",m),FA(m,C.value,C.defaultValue,C.children),u1(m)}b=C.children,typeof b!="string"&&typeof b!="number"&&typeof b!="bigint"||m.textContent===""+b||C.suppressHydrationWarning===!0||R$(m.textContent,b)?(C.popover!=null&&(Sn("beforetoggle",m),Sn("toggle",m)),C.onScroll!=null&&Sn("scroll",m),C.onScrollEnd!=null&&Sn("scrollend",m),C.onClick!=null&&(m.onclick=ny),m=!0):m=!1,m||ic(d)}function yI(d){for(si=d.return;si;)switch(si.tag){case 5:case 13:uo=!1;return;case 27:case 3:uo=!0;return;default:si=si.return}}function bp(d){if(d!==si)return!1;if(!zn)return yI(d),zn=!0,!1;var m=d.tag,b;if((b=m!==3&&m!==27)&&((b=m===5)&&(b=d.type,b=!(b!=="form"&&b!=="button")||XS(d.type,d.memoizedProps)),b=!b),b&&Ir&&ic(d),yI(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8)if(b=d.data,b==="/$"){if(m===0){Ir=Va(d.nextSibling);break e}m--}else b!=="$"&&b!=="$!"&&b!=="$?"||m++;d=d.nextSibling}Ir=null}}else m===27?(m=Ir,Yu(d.type)?(d=JS,JS=null,Ir=d):Ir=m):Ir=si?Va(d.stateNode.nextSibling):null;return!0}function vp(){Ir=si=null,zn=!1}function xI(){var d=sc;return d!==null&&(vi===null?vi=d:vi.push.apply(vi,d),sc=null),d}function wp(d){sc===null?sc=[d]:sc.push(d)}var Rw=X(null),ac=null,Ko=null;function Ou(d,m,b){se(Rw,m._currentValue),m._currentValue=b}function Xo(d){d._currentValue=Rw.current,Y(Rw)}function Ow(d,m,b){for(;d!==null;){var C=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,C!==null&&(C.childLanes|=m)):C!==null&&(C.childLanes&m)!==m&&(C.childLanes|=m),d===b)break;d=d.return}}function Mw(d,m,b,C){var T=d.child;for(T!==null&&(T.return=d);T!==null;){var R=T.dependencies;if(R!==null){var j=T.child;R=R.firstContext;e:for(;R!==null;){var ee=R;R=T;for(var pe=0;pe<m.length;pe++)if(ee.context===m[pe]){R.lanes|=b,ee=R.alternate,ee!==null&&(ee.lanes|=b),Ow(R.return,b,d),C||(j=null);break e}R=ee.next}}else if(T.tag===18){if(j=T.return,j===null)throw Error(s(341));j.lanes|=b,R=j.alternate,R!==null&&(R.lanes|=b),Ow(j,b,d),j=null}else j=T.child;if(j!==null)j.return=T;else for(j=T;j!==null;){if(j===d){j=null;break}if(T=j.sibling,T!==null){T.return=j.return,j=T;break}j=j.return}T=j}}function Sp(d,m,b,C){d=null;for(var T=m,R=!1;T!==null;){if(!R){if((T.flags&524288)!==0)R=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var j=T.alternate;if(j===null)throw Error(s(387));if(j=j.memoizedProps,j!==null){var ee=T.type;Li(T.pendingProps.value,j.value)||(d!==null?d.push(ee):d=[ee])}}else if(T===be.current){if(j=T.alternate,j===null)throw Error(s(387));j.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(d!==null?d.push(Zp):d=[Zp])}T=T.return}d!==null&&Mw(m,d,b,C),m.flags|=262144}function C1(d){for(d=d.firstContext;d!==null;){if(!Li(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function oc(d){ac=d,Ko=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Ws(d){return bI(ac,d)}function _1(d,m){return ac===null&&oc(d),bI(d,m)}function bI(d,m){var b=m._currentValue;if(m={context:m,memoizedValue:b,next:null},Ko===null){if(d===null)throw Error(s(308));Ko=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else Ko=Ko.next=m;return b}var BK=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(b,C){d.push(C)}};this.abort=function(){m.aborted=!0,d.forEach(function(b){return b()})}},PK=r.unstable_scheduleCallback,VK=r.unstable_NormalPriority,is={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Lw(){return{controller:new BK,data:new Map,refCount:0}}function Cp(d){d.refCount--,d.refCount===0&&PK(VK,function(){d.controller.abort()})}var _p=null,Bw=0,Zh=0,Qh=null;function zK(d,m){if(_p===null){var b=_p=[];Bw=0,Zh=VS(),Qh={status:"pending",value:void 0,then:function(C){b.push(C)}}}return Bw++,m.then(vI,vI),m}function vI(){if(--Bw===0&&_p!==null){Qh!==null&&(Qh.status="fulfilled");var d=_p;_p=null,Zh=0,Qh=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function UK(d,m){var b=[],C={status:"pending",value:null,reason:null,then:function(T){b.push(T)}};return d.then(function(){C.status="fulfilled",C.value=m;for(var T=0;T<b.length;T++)(0,b[T])(m)},function(T){for(C.status="rejected",C.reason=T,T=0;T<b.length;T++)(0,b[T])(void 0)}),C}var wI=V.S;V.S=function(d,m){typeof m=="object"&&m!==null&&typeof m.then=="function"&&zK(d,m),wI!==null&&wI(d,m)};var uc=X(null);function Pw(){var d=uc.current;return d!==null?d:fr.pooledCache}function E1(d,m){m===null?se(uc,uc.current):se(uc,m.pool)}function SI(){var d=Pw();return d===null?null:{parent:is._currentValue,pool:d}}var Ep=Error(s(460)),CI=Error(s(474)),D1=Error(s(542)),Vw={then:function(){}};function _I(d){return d=d.status,d==="fulfilled"||d==="rejected"}function T1(){}function EI(d,m,b){switch(b=d[b],b===void 0?d.push(m):b!==m&&(m.then(T1,T1),m=b),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,TI(d),d;default:if(typeof m.status=="string")m.then(T1,T1);else{if(d=fr,d!==null&&100<d.shellSuspendCounter)throw Error(s(482));d=m,d.status="pending",d.then(function(C){if(m.status==="pending"){var T=m;T.status="fulfilled",T.value=C}},function(C){if(m.status==="pending"){var T=m;T.status="rejected",T.reason=C}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,TI(d),d}throw Dp=m,Ep}}var Dp=null;function DI(){if(Dp===null)throw Error(s(459));var d=Dp;return Dp=null,d}function TI(d){if(d===Ep||d===D1)throw Error(s(483))}var Mu=!1;function zw(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uw(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Lu(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function Bu(d,m,b){var C=d.updateQueue;if(C===null)return null;if(C=C.shared,(Kn&2)!==0){var T=C.pending;return T===null?m.next=m:(m.next=T.next,T.next=m),C.pending=m,m=b1(d),dI(d,null,b),m}return x1(d,C,m,b),b1(d)}function Tp(d,m,b){if(m=m.updateQueue,m!==null&&(m=m.shared,(b&4194048)!==0)){var C=m.lanes;C&=d.pendingLanes,b|=C,m.lanes=b,L(d,b)}}function Gw(d,m){var b=d.updateQueue,C=d.alternate;if(C!==null&&(C=C.updateQueue,b===C)){var T=null,R=null;if(b=b.firstBaseUpdate,b!==null){do{var j={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};R===null?T=R=j:R=R.next=j,b=b.next}while(b!==null);R===null?T=R=m:R=R.next=m}else T=R=m;b={baseState:C.baseState,firstBaseUpdate:T,lastBaseUpdate:R,shared:C.shared,callbacks:C.callbacks},d.updateQueue=b;return}d=b.lastBaseUpdate,d===null?b.firstBaseUpdate=m:d.next=m,b.lastBaseUpdate=m}var jw=!1;function Np(){if(jw){var d=Qh;if(d!==null)throw d}}function kp(d,m,b,C){jw=!1;var T=d.updateQueue;Mu=!1;var R=T.firstBaseUpdate,j=T.lastBaseUpdate,ee=T.shared.pending;if(ee!==null){T.shared.pending=null;var pe=ee,Be=pe.next;pe.next=null,j===null?R=Be:j.next=Be,j=pe;var tt=d.alternate;tt!==null&&(tt=tt.updateQueue,ee=tt.lastBaseUpdate,ee!==j&&(ee===null?tt.firstBaseUpdate=Be:ee.next=Be,tt.lastBaseUpdate=pe))}if(R!==null){var st=T.baseState;j=0,tt=Be=pe=null,ee=R;do{var ze=ee.lane&-536870913,je=ze!==ee.lane;if(je?(An&ze)===ze:(C&ze)===ze){ze!==0&&ze===Zh&&(jw=!0),tt!==null&&(tt=tt.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var Xt=d,jt=ee;ze=m;var Qn=b;switch(jt.tag){case 1:if(Xt=jt.payload,typeof Xt=="function"){st=Xt.call(Qn,st,ze);break e}st=Xt;break e;case 3:Xt.flags=Xt.flags&-65537|128;case 0:if(Xt=jt.payload,ze=typeof Xt=="function"?Xt.call(Qn,st,ze):Xt,ze==null)break e;st=h({},st,ze);break e;case 2:Mu=!0}}ze=ee.callback,ze!==null&&(d.flags|=64,je&&(d.flags|=8192),je=T.callbacks,je===null?T.callbacks=[ze]:je.push(ze))}else je={lane:ze,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},tt===null?(Be=tt=je,pe=st):tt=tt.next=je,j|=ze;if(ee=ee.next,ee===null){if(ee=T.shared.pending,ee===null)break;je=ee,ee=je.next,je.next=null,T.lastBaseUpdate=je,T.shared.pending=null}}while(!0);tt===null&&(pe=st),T.baseState=pe,T.firstBaseUpdate=Be,T.lastBaseUpdate=tt,R===null&&(T.shared.lanes=0),Hu|=j,d.lanes=j,d.memoizedState=st}}function NI(d,m){if(typeof d!="function")throw Error(s(191,d));d.call(m)}function kI(d,m){var b=d.callbacks;if(b!==null)for(d.callbacks=null,d=0;d<b.length;d++)NI(b[d],m)}var Jh=X(null),N1=X(0);function AI(d,m){d=nu,se(N1,d),se(Jh,m),nu=d|m.baseLanes}function Ww(){se(N1,nu),se(Jh,Jh.current)}function Hw(){nu=N1.current,Y(Jh),Y(N1)}var Pu=0,mn=null,Yn=null,Kr=null,k1=!1,ef=!1,lc=!1,A1=0,Ap=0,tf=null,GK=0;function Pr(){throw Error(s(321))}function qw(d,m){if(m===null)return!1;for(var b=0;b<m.length&&b<d.length;b++)if(!Li(d[b],m[b]))return!1;return!0}function Kw(d,m,b,C,T,R){return Pu=R,mn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,V.H=d===null||d.memoizedState===null?d5:m5,lc=!1,R=b(C,T),lc=!1,ef&&(R=$I(m,b,C,T)),II(d),R}function II(d){V.H=M1;var m=Yn!==null&&Yn.next!==null;if(Pu=0,Kr=Yn=mn=null,k1=!1,Ap=0,tf=null,m)throw Error(s(300));d===null||Cs||(d=d.dependencies,d!==null&&C1(d)&&(Cs=!0))}function $I(d,m,b,C){mn=d;var T=0;do{if(ef&&(tf=null),Ap=0,ef=!1,25<=T)throw Error(s(301));if(T+=1,Kr=Yn=null,d.updateQueue!=null){var R=d.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}V.H=YK,R=m(b,C)}while(ef);return R}function jK(){var d=V.H,m=d.useState()[0];return m=typeof m.then=="function"?Ip(m):m,d=d.useState()[0],(Yn!==null?Yn.memoizedState:null)!==d&&(mn.flags|=1024),m}function Xw(){var d=A1!==0;return A1=0,d}function Yw(d,m,b){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~b}function Zw(d){if(k1){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}k1=!1}Pu=0,Kr=Yn=mn=null,ef=!1,Ap=A1=0,tf=null}function xi(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?mn.memoizedState=Kr=d:Kr=Kr.next=d,Kr}function Xr(){if(Yn===null){var d=mn.alternate;d=d!==null?d.memoizedState:null}else d=Yn.next;var m=Kr===null?mn.memoizedState:Kr.next;if(m!==null)Kr=m,Yn=d;else{if(d===null)throw mn.alternate===null?Error(s(467)):Error(s(310));Yn=d,d={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},Kr===null?mn.memoizedState=Kr=d:Kr=Kr.next=d}return Kr}function Qw(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ip(d){var m=Ap;return Ap+=1,tf===null&&(tf=[]),d=EI(tf,d,m),m=mn,(Kr===null?m.memoizedState:Kr.next)===null&&(m=m.alternate,V.H=m===null||m.memoizedState===null?d5:m5),d}function I1(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Ip(d);if(d.$$typeof===E)return Ws(d)}throw Error(s(438,String(d)))}function Jw(d){var m=null,b=mn.updateQueue;if(b!==null&&(m=b.memoCache),m==null){var C=mn.alternate;C!==null&&(C=C.updateQueue,C!==null&&(C=C.memoCache,C!=null&&(m={data:C.data.map(function(T){return T.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),b===null&&(b=Qw(),mn.updateQueue=b),b.memoCache=m,b=m.data[m.index],b===void 0)for(b=m.data[m.index]=Array(d),C=0;C<d;C++)b[C]=F;return m.index++,b}function Yo(d,m){return typeof m=="function"?m(d):m}function $1(d){var m=Xr();return eS(m,Yn,d)}function eS(d,m,b){var C=d.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=b;var T=d.baseQueue,R=C.pending;if(R!==null){if(T!==null){var j=T.next;T.next=R.next,R.next=j}m.baseQueue=T=R,C.pending=null}if(R=d.baseState,T===null)d.memoizedState=R;else{m=T.next;var ee=j=null,pe=null,Be=m,tt=!1;do{var st=Be.lane&-536870913;if(st!==Be.lane?(An&st)===st:(Pu&st)===st){var ze=Be.revertLane;if(ze===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),st===Zh&&(tt=!0);else if((Pu&ze)===ze){Be=Be.next,ze===Zh&&(tt=!0);continue}else st={lane:0,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},pe===null?(ee=pe=st,j=R):pe=pe.next=st,mn.lanes|=ze,Hu|=ze;st=Be.action,lc&&b(R,st),R=Be.hasEagerState?Be.eagerState:b(R,st)}else ze={lane:st,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},pe===null?(ee=pe=ze,j=R):pe=pe.next=ze,mn.lanes|=st,Hu|=st;Be=Be.next}while(Be!==null&&Be!==m);if(pe===null?j=R:pe.next=ee,!Li(R,d.memoizedState)&&(Cs=!0,tt&&(b=Qh,b!==null)))throw b;d.memoizedState=R,d.baseState=j,d.baseQueue=pe,C.lastRenderedState=R}return T===null&&(C.lanes=0),[d.memoizedState,C.dispatch]}function tS(d){var m=Xr(),b=m.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=d;var C=b.dispatch,T=b.pending,R=m.memoizedState;if(T!==null){b.pending=null;var j=T=T.next;do R=d(R,j.action),j=j.next;while(j!==T);Li(R,m.memoizedState)||(Cs=!0),m.memoizedState=R,m.baseQueue===null&&(m.baseState=R),b.lastRenderedState=R}return[R,C]}function FI(d,m,b){var C=mn,T=Xr(),R=zn;if(R){if(b===void 0)throw Error(s(407));b=b()}else b=m();var j=!Li((Yn||T).memoizedState,b);j&&(T.memoizedState=b,Cs=!0),T=T.queue;var ee=MI.bind(null,C,T,d);if($p(2048,8,ee,[d]),T.getSnapshot!==m||j||Kr!==null&&Kr.memoizedState.tag&1){if(C.flags|=2048,nf(9,F1(),OI.bind(null,C,T,b,m),null),fr===null)throw Error(s(349));R||(Pu&124)!==0||RI(C,m,b)}return b}function RI(d,m,b){d.flags|=16384,d={getSnapshot:m,value:b},m=mn.updateQueue,m===null?(m=Qw(),mn.updateQueue=m,m.stores=[d]):(b=m.stores,b===null?m.stores=[d]:b.push(d))}function OI(d,m,b,C){m.value=b,m.getSnapshot=C,LI(m)&&BI(d)}function MI(d,m,b){return b(function(){LI(m)&&BI(d)})}function LI(d){var m=d.getSnapshot;d=d.value;try{var b=m();return!Li(d,b)}catch{return!0}}function BI(d){var m=qh(d,2);m!==null&&Gi(m,d,2)}function nS(d){var m=xi();if(typeof d=="function"){var b=d;if(d=b(),lc){wt(!0);try{b()}finally{wt(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:d},m}function PI(d,m,b,C){return d.baseState=b,eS(d,Yn,typeof C=="function"?C:Yo)}function WK(d,m,b,C,T){if(O1(d))throw Error(s(485));if(d=m.action,d!==null){var R={payload:T,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){R.listeners.push(j)}};V.T!==null?b(!0):R.isTransition=!1,C(R),b=m.pending,b===null?(R.next=m.pending=R,VI(m,R)):(R.next=b.next,m.pending=b.next=R)}}function VI(d,m){var b=m.action,C=m.payload,T=d.state;if(m.isTransition){var R=V.T,j={};V.T=j;try{var ee=b(T,C),pe=V.S;pe!==null&&pe(j,ee),zI(d,m,ee)}catch(Be){rS(d,m,Be)}finally{V.T=R}}else try{R=b(T,C),zI(d,m,R)}catch(Be){rS(d,m,Be)}}function zI(d,m,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(C){UI(d,m,C)},function(C){return rS(d,m,C)}):UI(d,m,b)}function UI(d,m,b){m.status="fulfilled",m.value=b,GI(m),d.state=b,m=d.pending,m!==null&&(b=m.next,b===m?d.pending=null:(b=b.next,m.next=b,VI(d,b)))}function rS(d,m,b){var C=d.pending;if(d.pending=null,C!==null){C=C.next;do m.status="rejected",m.reason=b,GI(m),m=m.next;while(m!==C)}d.action=null}function GI(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function jI(d,m){return m}function WI(d,m){if(zn){var b=fr.formState;if(b!==null){e:{var C=mn;if(zn){if(Ir){t:{for(var T=Ir,R=uo;T.nodeType!==8;){if(!R){T=null;break t}if(T=Va(T.nextSibling),T===null){T=null;break t}}R=T.data,T=R==="F!"||R==="F"?T:null}if(T){Ir=Va(T.nextSibling),C=T.data==="F!";break e}}ic(C)}C=!1}C&&(m=b[0])}}return b=xi(),b.memoizedState=b.baseState=m,C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jI,lastRenderedState:m},b.queue=C,b=c5.bind(null,mn,C),C.dispatch=b,C=nS(!1),R=uS.bind(null,mn,!1,C.queue),C=xi(),T={state:m,dispatch:null,action:d,pending:null},C.queue=T,b=WK.bind(null,mn,T,R,b),T.dispatch=b,C.memoizedState=d,[m,b,!1]}function HI(d){var m=Xr();return qI(m,Yn,d)}function qI(d,m,b){if(m=eS(d,m,jI)[0],d=$1(Yo)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var C=Ip(m)}catch(j){throw j===Ep?D1:j}else C=m;m=Xr();var T=m.queue,R=T.dispatch;return b!==m.memoizedState&&(mn.flags|=2048,nf(9,F1(),HK.bind(null,T,b),null)),[C,R,d]}function HK(d,m){d.action=m}function KI(d){var m=Xr(),b=Yn;if(b!==null)return qI(m,b,d);Xr(),m=m.memoizedState,b=Xr();var C=b.queue.dispatch;return b.memoizedState=d,[m,C,!1]}function nf(d,m,b,C){return d={tag:d,create:b,deps:C,inst:m,next:null},m=mn.updateQueue,m===null&&(m=Qw(),mn.updateQueue=m),b=m.lastEffect,b===null?m.lastEffect=d.next=d:(C=b.next,b.next=d,d.next=C,m.lastEffect=d),d}function F1(){return{destroy:void 0,resource:void 0}}function XI(){return Xr().memoizedState}function R1(d,m,b,C){var T=xi();C=C===void 0?null:C,mn.flags|=d,T.memoizedState=nf(1|m,F1(),b,C)}function $p(d,m,b,C){var T=Xr();C=C===void 0?null:C;var R=T.memoizedState.inst;Yn!==null&&C!==null&&qw(C,Yn.memoizedState.deps)?T.memoizedState=nf(m,R,b,C):(mn.flags|=d,T.memoizedState=nf(1|m,R,b,C))}function YI(d,m){R1(8390656,8,d,m)}function ZI(d,m){$p(2048,8,d,m)}function QI(d,m){return $p(4,2,d,m)}function JI(d,m){return $p(4,4,d,m)}function e5(d,m){if(typeof m=="function"){d=d();var b=m(d);return function(){typeof b=="function"?b():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function t5(d,m,b){b=b!=null?b.concat([d]):null,$p(4,4,e5.bind(null,m,d),b)}function sS(){}function n5(d,m){var b=Xr();m=m===void 0?null:m;var C=b.memoizedState;return m!==null&&qw(m,C[1])?C[0]:(b.memoizedState=[d,m],d)}function r5(d,m){var b=Xr();m=m===void 0?null:m;var C=b.memoizedState;if(m!==null&&qw(m,C[1]))return C[0];if(C=d(),lc){wt(!0);try{d()}finally{wt(!1)}}return b.memoizedState=[C,m],C}function iS(d,m,b){return b===void 0||(Pu&1073741824)!==0?d.memoizedState=m:(d.memoizedState=b,d=o$(),mn.lanes|=d,Hu|=d,b)}function s5(d,m,b,C){return Li(b,m)?b:Jh.current!==null?(d=iS(d,b,C),Li(d,m)||(Cs=!0),d):(Pu&42)===0?(Cs=!0,d.memoizedState=b):(d=o$(),mn.lanes|=d,Hu|=d,m)}function i5(d,m,b,C,T){var R=Z.p;Z.p=R!==0&&8>R?R:8;var j=V.T,ee={};V.T=ee,uS(d,!1,m,b);try{var pe=T(),Be=V.S;if(Be!==null&&Be(ee,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var tt=UK(pe,C);Fp(d,m,tt,Ui(d))}else Fp(d,m,C,Ui(d))}catch(st){Fp(d,m,{then:function(){},status:"rejected",reason:st},Ui())}finally{Z.p=R,V.T=j}}function qK(){}function aS(d,m,b,C){if(d.tag!==5)throw Error(s(476));var T=a5(d).queue;i5(d,T,m,J,b===null?qK:function(){return o5(d),b(C)})}function a5(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:J},next:null};var b={};return m.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:b},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function o5(d){var m=a5(d).next.queue;Fp(d,m,{},Ui())}function oS(){return Ws(Zp)}function u5(){return Xr().memoizedState}function l5(){return Xr().memoizedState}function KK(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var b=Ui();d=Lu(b);var C=Bu(m,d,b);C!==null&&(Gi(C,m,b),Tp(C,m,b)),m={cache:Lw()},d.payload=m;return}m=m.return}}function XK(d,m,b){var C=Ui();b={lane:C,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},O1(d)?h5(m,b):(b=Tw(d,m,b,C),b!==null&&(Gi(b,d,C),f5(b,m,C)))}function c5(d,m,b){var C=Ui();Fp(d,m,b,C)}function Fp(d,m,b,C){var T={lane:C,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(O1(d))h5(m,T);else{var R=d.alternate;if(d.lanes===0&&(R===null||R.lanes===0)&&(R=m.lastRenderedReducer,R!==null))try{var j=m.lastRenderedState,ee=R(j,b);if(T.hasEagerState=!0,T.eagerState=ee,Li(ee,j))return x1(d,m,T,0),fr===null&&y1(),!1}catch{}finally{}if(b=Tw(d,m,T,C),b!==null)return Gi(b,d,C),f5(b,m,C),!0}return!1}function uS(d,m,b,C){if(C={lane:2,revertLane:VS(),action:C,hasEagerState:!1,eagerState:null,next:null},O1(d)){if(m)throw Error(s(479))}else m=Tw(d,b,C,2),m!==null&&Gi(m,d,2)}function O1(d){var m=d.alternate;return d===mn||m!==null&&m===mn}function h5(d,m){ef=k1=!0;var b=d.pending;b===null?m.next=m:(m.next=b.next,b.next=m),d.pending=m}function f5(d,m,b){if((b&4194048)!==0){var C=m.lanes;C&=d.pendingLanes,b|=C,m.lanes=b,L(d,b)}}var M1={readContext:Ws,use:I1,useCallback:Pr,useContext:Pr,useEffect:Pr,useImperativeHandle:Pr,useLayoutEffect:Pr,useInsertionEffect:Pr,useMemo:Pr,useReducer:Pr,useRef:Pr,useState:Pr,useDebugValue:Pr,useDeferredValue:Pr,useTransition:Pr,useSyncExternalStore:Pr,useId:Pr,useHostTransitionStatus:Pr,useFormState:Pr,useActionState:Pr,useOptimistic:Pr,useMemoCache:Pr,useCacheRefresh:Pr},d5={readContext:Ws,use:I1,useCallback:function(d,m){return xi().memoizedState=[d,m===void 0?null:m],d},useContext:Ws,useEffect:YI,useImperativeHandle:function(d,m,b){b=b!=null?b.concat([d]):null,R1(4194308,4,e5.bind(null,m,d),b)},useLayoutEffect:function(d,m){return R1(4194308,4,d,m)},useInsertionEffect:function(d,m){R1(4,2,d,m)},useMemo:function(d,m){var b=xi();m=m===void 0?null:m;var C=d();if(lc){wt(!0);try{d()}finally{wt(!1)}}return b.memoizedState=[C,m],C},useReducer:function(d,m,b){var C=xi();if(b!==void 0){var T=b(m);if(lc){wt(!0);try{b(m)}finally{wt(!1)}}}else T=m;return C.memoizedState=C.baseState=T,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:T},C.queue=d,d=d.dispatch=XK.bind(null,mn,d),[C.memoizedState,d]},useRef:function(d){var m=xi();return d={current:d},m.memoizedState=d},useState:function(d){d=nS(d);var m=d.queue,b=c5.bind(null,mn,m);return m.dispatch=b,[d.memoizedState,b]},useDebugValue:sS,useDeferredValue:function(d,m){var b=xi();return iS(b,d,m)},useTransition:function(){var d=nS(!1);return d=i5.bind(null,mn,d.queue,!0,!1),xi().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,b){var C=mn,T=xi();if(zn){if(b===void 0)throw Error(s(407));b=b()}else{if(b=m(),fr===null)throw Error(s(349));(An&124)!==0||RI(C,m,b)}T.memoizedState=b;var R={value:b,getSnapshot:m};return T.queue=R,YI(MI.bind(null,C,R,d),[d]),C.flags|=2048,nf(9,F1(),OI.bind(null,C,R,b,m),null),b},useId:function(){var d=xi(),m=fr.identifierPrefix;if(zn){var b=qo,C=Ho;b=(C&~(1<<32-St(C)-1)).toString(32)+b,m=""+m+"R"+b,b=A1++,0<b&&(m+="H"+b.toString(32)),m+=""}else b=GK++,m=""+m+"r"+b.toString(32)+"";return d.memoizedState=m},useHostTransitionStatus:oS,useFormState:WI,useActionState:WI,useOptimistic:function(d){var m=xi();m.memoizedState=m.baseState=d;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=b,m=uS.bind(null,mn,!0,b),b.dispatch=m,[d,m]},useMemoCache:Jw,useCacheRefresh:function(){return xi().memoizedState=KK.bind(null,mn)}},m5={readContext:Ws,use:I1,useCallback:n5,useContext:Ws,useEffect:ZI,useImperativeHandle:t5,useInsertionEffect:QI,useLayoutEffect:JI,useMemo:r5,useReducer:$1,useRef:XI,useState:function(){return $1(Yo)},useDebugValue:sS,useDeferredValue:function(d,m){var b=Xr();return s5(b,Yn.memoizedState,d,m)},useTransition:function(){var d=$1(Yo)[0],m=Xr().memoizedState;return[typeof d=="boolean"?d:Ip(d),m]},useSyncExternalStore:FI,useId:u5,useHostTransitionStatus:oS,useFormState:HI,useActionState:HI,useOptimistic:function(d,m){var b=Xr();return PI(b,Yn,d,m)},useMemoCache:Jw,useCacheRefresh:l5},YK={readContext:Ws,use:I1,useCallback:n5,useContext:Ws,useEffect:ZI,useImperativeHandle:t5,useInsertionEffect:QI,useLayoutEffect:JI,useMemo:r5,useReducer:tS,useRef:XI,useState:function(){return tS(Yo)},useDebugValue:sS,useDeferredValue:function(d,m){var b=Xr();return Yn===null?iS(b,d,m):s5(b,Yn.memoizedState,d,m)},useTransition:function(){var d=tS(Yo)[0],m=Xr().memoizedState;return[typeof d=="boolean"?d:Ip(d),m]},useSyncExternalStore:FI,useId:u5,useHostTransitionStatus:oS,useFormState:KI,useActionState:KI,useOptimistic:function(d,m){var b=Xr();return Yn!==null?PI(b,Yn,d,m):(b.baseState=d,[d,b.queue.dispatch])},useMemoCache:Jw,useCacheRefresh:l5},rf=null,Rp=0;function L1(d){var m=Rp;return Rp+=1,rf===null&&(rf=[]),EI(rf,d,m)}function Op(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function B1(d,m){throw m.$$typeof===f?Error(s(525)):(d=Object.prototype.toString.call(m),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function g5(d){var m=d._init;return m(d._payload)}function y5(d){function m(Ae,we){if(d){var Le=Ae.deletions;Le===null?(Ae.deletions=[we],Ae.flags|=16):Le.push(we)}}function b(Ae,we){if(!d)return null;for(;we!==null;)m(Ae,we),we=we.sibling;return null}function C(Ae){for(var we=new Map;Ae!==null;)Ae.key!==null?we.set(Ae.key,Ae):we.set(Ae.index,Ae),Ae=Ae.sibling;return we}function T(Ae,we){return Ae=Wo(Ae,we),Ae.index=0,Ae.sibling=null,Ae}function R(Ae,we,Le){return Ae.index=Le,d?(Le=Ae.alternate,Le!==null?(Le=Le.index,Le<we?(Ae.flags|=67108866,we):Le):(Ae.flags|=67108866,we)):(Ae.flags|=1048576,we)}function j(Ae){return d&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function ee(Ae,we,Le,rt){return we===null||we.tag!==6?(we=kw(Le,Ae.mode,rt),we.return=Ae,we):(we=T(we,Le),we.return=Ae,we)}function pe(Ae,we,Le,rt){var Nt=Le.type;return Nt===y?tt(Ae,we,Le.props.children,rt,Le.key):we!==null&&(we.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===A&&g5(Nt)===we.type)?(we=T(we,Le.props),Op(we,Le),we.return=Ae,we):(we=v1(Le.type,Le.key,Le.props,null,Ae.mode,rt),Op(we,Le),we.return=Ae,we)}function Be(Ae,we,Le,rt){return we===null||we.tag!==4||we.stateNode.containerInfo!==Le.containerInfo||we.stateNode.implementation!==Le.implementation?(we=Aw(Le,Ae.mode,rt),we.return=Ae,we):(we=T(we,Le.children||[]),we.return=Ae,we)}function tt(Ae,we,Le,rt,Nt){return we===null||we.tag!==7?(we=tc(Le,Ae.mode,rt,Nt),we.return=Ae,we):(we=T(we,Le),we.return=Ae,we)}function st(Ae,we,Le){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return we=kw(""+we,Ae.mode,Le),we.return=Ae,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case p:return Le=v1(we.type,we.key,we.props,null,Ae.mode,Le),Op(Le,we),Le.return=Ae,Le;case g:return we=Aw(we,Ae.mode,Le),we.return=Ae,we;case A:var rt=we._init;return we=rt(we._payload),st(Ae,we,Le)}if(U(we)||O(we))return we=tc(we,Ae.mode,Le,null),we.return=Ae,we;if(typeof we.then=="function")return st(Ae,L1(we),Le);if(we.$$typeof===E)return st(Ae,_1(Ae,we),Le);B1(Ae,we)}return null}function ze(Ae,we,Le,rt){var Nt=we!==null?we.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Nt!==null?null:ee(Ae,we,""+Le,rt);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case p:return Le.key===Nt?pe(Ae,we,Le,rt):null;case g:return Le.key===Nt?Be(Ae,we,Le,rt):null;case A:return Nt=Le._init,Le=Nt(Le._payload),ze(Ae,we,Le,rt)}if(U(Le)||O(Le))return Nt!==null?null:tt(Ae,we,Le,rt,null);if(typeof Le.then=="function")return ze(Ae,we,L1(Le),rt);if(Le.$$typeof===E)return ze(Ae,we,_1(Ae,Le),rt);B1(Ae,Le)}return null}function je(Ae,we,Le,rt,Nt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return Ae=Ae.get(Le)||null,ee(we,Ae,""+rt,Nt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case p:return Ae=Ae.get(rt.key===null?Le:rt.key)||null,pe(we,Ae,rt,Nt);case g:return Ae=Ae.get(rt.key===null?Le:rt.key)||null,Be(we,Ae,rt,Nt);case A:var xn=rt._init;return rt=xn(rt._payload),je(Ae,we,Le,rt,Nt)}if(U(rt)||O(rt))return Ae=Ae.get(Le)||null,tt(we,Ae,rt,Nt,null);if(typeof rt.then=="function")return je(Ae,we,Le,L1(rt),Nt);if(rt.$$typeof===E)return je(Ae,we,Le,_1(we,rt),Nt);B1(we,rt)}return null}function Xt(Ae,we,Le,rt){for(var Nt=null,xn=null,Lt=we,Wt=we=0,Es=null;Lt!==null&&Wt<Le.length;Wt++){Lt.index>Wt?(Es=Lt,Lt=null):Es=Lt.sibling;var Rn=ze(Ae,Lt,Le[Wt],rt);if(Rn===null){Lt===null&&(Lt=Es);break}d&&Lt&&Rn.alternate===null&&m(Ae,Lt),we=R(Rn,we,Wt),xn===null?Nt=Rn:xn.sibling=Rn,xn=Rn,Lt=Es}if(Wt===Le.length)return b(Ae,Lt),zn&&rc(Ae,Wt),Nt;if(Lt===null){for(;Wt<Le.length;Wt++)Lt=st(Ae,Le[Wt],rt),Lt!==null&&(we=R(Lt,we,Wt),xn===null?Nt=Lt:xn.sibling=Lt,xn=Lt);return zn&&rc(Ae,Wt),Nt}for(Lt=C(Lt);Wt<Le.length;Wt++)Es=je(Lt,Ae,Wt,Le[Wt],rt),Es!==null&&(d&&Es.alternate!==null&&Lt.delete(Es.key===null?Wt:Es.key),we=R(Es,we,Wt),xn===null?Nt=Es:xn.sibling=Es,xn=Es);return d&&Lt.forEach(function(tl){return m(Ae,tl)}),zn&&rc(Ae,Wt),Nt}function jt(Ae,we,Le,rt){if(Le==null)throw Error(s(151));for(var Nt=null,xn=null,Lt=we,Wt=we=0,Es=null,Rn=Le.next();Lt!==null&&!Rn.done;Wt++,Rn=Le.next()){Lt.index>Wt?(Es=Lt,Lt=null):Es=Lt.sibling;var tl=ze(Ae,Lt,Rn.value,rt);if(tl===null){Lt===null&&(Lt=Es);break}d&&Lt&&tl.alternate===null&&m(Ae,Lt),we=R(tl,we,Wt),xn===null?Nt=tl:xn.sibling=tl,xn=tl,Lt=Es}if(Rn.done)return b(Ae,Lt),zn&&rc(Ae,Wt),Nt;if(Lt===null){for(;!Rn.done;Wt++,Rn=Le.next())Rn=st(Ae,Rn.value,rt),Rn!==null&&(we=R(Rn,we,Wt),xn===null?Nt=Rn:xn.sibling=Rn,xn=Rn);return zn&&rc(Ae,Wt),Nt}for(Lt=C(Lt);!Rn.done;Wt++,Rn=Le.next())Rn=je(Lt,Ae,Wt,Rn.value,rt),Rn!==null&&(d&&Rn.alternate!==null&&Lt.delete(Rn.key===null?Wt:Rn.key),we=R(Rn,we,Wt),xn===null?Nt=Rn:xn.sibling=Rn,xn=Rn);return d&&Lt.forEach(function(ZX){return m(Ae,ZX)}),zn&&rc(Ae,Wt),Nt}function Qn(Ae,we,Le,rt){if(typeof Le=="object"&&Le!==null&&Le.type===y&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case p:e:{for(var Nt=Le.key;we!==null;){if(we.key===Nt){if(Nt=Le.type,Nt===y){if(we.tag===7){b(Ae,we.sibling),rt=T(we,Le.props.children),rt.return=Ae,Ae=rt;break e}}else if(we.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===A&&g5(Nt)===we.type){b(Ae,we.sibling),rt=T(we,Le.props),Op(rt,Le),rt.return=Ae,Ae=rt;break e}b(Ae,we);break}else m(Ae,we);we=we.sibling}Le.type===y?(rt=tc(Le.props.children,Ae.mode,rt,Le.key),rt.return=Ae,Ae=rt):(rt=v1(Le.type,Le.key,Le.props,null,Ae.mode,rt),Op(rt,Le),rt.return=Ae,Ae=rt)}return j(Ae);case g:e:{for(Nt=Le.key;we!==null;){if(we.key===Nt)if(we.tag===4&&we.stateNode.containerInfo===Le.containerInfo&&we.stateNode.implementation===Le.implementation){b(Ae,we.sibling),rt=T(we,Le.children||[]),rt.return=Ae,Ae=rt;break e}else{b(Ae,we);break}else m(Ae,we);we=we.sibling}rt=Aw(Le,Ae.mode,rt),rt.return=Ae,Ae=rt}return j(Ae);case A:return Nt=Le._init,Le=Nt(Le._payload),Qn(Ae,we,Le,rt)}if(U(Le))return Xt(Ae,we,Le,rt);if(O(Le)){if(Nt=O(Le),typeof Nt!="function")throw Error(s(150));return Le=Nt.call(Le),jt(Ae,we,Le,rt)}if(typeof Le.then=="function")return Qn(Ae,we,L1(Le),rt);if(Le.$$typeof===E)return Qn(Ae,we,_1(Ae,Le),rt);B1(Ae,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint"?(Le=""+Le,we!==null&&we.tag===6?(b(Ae,we.sibling),rt=T(we,Le),rt.return=Ae,Ae=rt):(b(Ae,we),rt=kw(Le,Ae.mode,rt),rt.return=Ae,Ae=rt),j(Ae)):b(Ae,we)}return function(Ae,we,Le,rt){try{Rp=0;var Nt=Qn(Ae,we,Le,rt);return rf=null,Nt}catch(Lt){if(Lt===Ep||Lt===D1)throw Lt;var xn=Bi(29,Lt,null,Ae.mode);return xn.lanes=rt,xn.return=Ae,xn}finally{}}}var sf=y5(!0),x5=y5(!1),la=X(null),lo=null;function Vu(d){var m=d.alternate;se(as,as.current&1),se(la,d),lo===null&&(m===null||Jh.current!==null||m.memoizedState!==null)&&(lo=d)}function b5(d){if(d.tag===22){if(se(as,as.current),se(la,d),lo===null){var m=d.alternate;m!==null&&m.memoizedState!==null&&(lo=d)}}else zu()}function zu(){se(as,as.current),se(la,la.current)}function Zo(d){Y(la),lo===d&&(lo=null),Y(as)}var as=X(0);function P1(d){for(var m=d;m!==null;){if(m.tag===13){var b=m.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||QS(b)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}function lS(d,m,b,C){m=d.memoizedState,b=b(C,m),b=b==null?m:h({},m,b),d.memoizedState=b,d.lanes===0&&(d.updateQueue.baseState=b)}var cS={enqueueSetState:function(d,m,b){d=d._reactInternals;var C=Ui(),T=Lu(C);T.payload=m,b!=null&&(T.callback=b),m=Bu(d,T,C),m!==null&&(Gi(m,d,C),Tp(m,d,C))},enqueueReplaceState:function(d,m,b){d=d._reactInternals;var C=Ui(),T=Lu(C);T.tag=1,T.payload=m,b!=null&&(T.callback=b),m=Bu(d,T,C),m!==null&&(Gi(m,d,C),Tp(m,d,C))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var b=Ui(),C=Lu(b);C.tag=2,m!=null&&(C.callback=m),m=Bu(d,C,b),m!==null&&(Gi(m,d,b),Tp(m,d,b))}};function v5(d,m,b,C,T,R,j){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(C,R,j):m.prototype&&m.prototype.isPureReactComponent?!yp(b,C)||!yp(T,R):!0}function w5(d,m,b,C){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(b,C),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(b,C),m.state!==d&&cS.enqueueReplaceState(m,m.state,null)}function cc(d,m){var b=m;if("ref"in m){b={};for(var C in m)C!=="ref"&&(b[C]=m[C])}if(d=d.defaultProps){b===m&&(b=h({},b));for(var T in d)b[T]===void 0&&(b[T]=d[T])}return b}var V1=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function S5(d){V1(d)}function C5(d){console.error(d)}function _5(d){V1(d)}function z1(d,m){try{var b=d.onUncaughtError;b(m.value,{componentStack:m.stack})}catch(C){setTimeout(function(){throw C})}}function E5(d,m,b){try{var C=d.onCaughtError;C(b.value,{componentStack:b.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function hS(d,m,b){return b=Lu(b),b.tag=3,b.payload={element:null},b.callback=function(){z1(d,m)},b}function D5(d){return d=Lu(d),d.tag=3,d}function T5(d,m,b,C){var T=b.type.getDerivedStateFromError;if(typeof T=="function"){var R=C.value;d.payload=function(){return T(R)},d.callback=function(){E5(m,b,C)}}var j=b.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(d.callback=function(){E5(m,b,C),typeof T!="function"&&(qu===null?qu=new Set([this]):qu.add(this));var ee=C.stack;this.componentDidCatch(C.value,{componentStack:ee!==null?ee:""})})}function ZK(d,m,b,C,T){if(b.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){if(m=b.alternate,m!==null&&Sp(m,b,T,!0),b=la.current,b!==null){switch(b.tag){case 13:return lo===null?OS():b.alternate===null&&$r===0&&($r=3),b.flags&=-257,b.flags|=65536,b.lanes=T,C===Vw?b.flags|=16384:(m=b.updateQueue,m===null?b.updateQueue=new Set([C]):m.add(C),LS(d,C,T)),!1;case 22:return b.flags|=65536,C===Vw?b.flags|=16384:(m=b.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([C])},b.updateQueue=m):(b=m.retryQueue,b===null?m.retryQueue=new Set([C]):b.add(C)),LS(d,C,T)),!1}throw Error(s(435,b.tag))}return LS(d,C,T),OS(),!1}if(zn)return m=la.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=T,C!==Fw&&(d=Error(s(422),{cause:C}),wp(ia(d,b)))):(C!==Fw&&(m=Error(s(423),{cause:C}),wp(ia(m,b))),d=d.current.alternate,d.flags|=65536,T&=-T,d.lanes|=T,C=ia(C,b),T=hS(d.stateNode,C,T),Gw(d,T),$r!==4&&($r=2)),!1;var R=Error(s(520),{cause:C});if(R=ia(R,b),Up===null?Up=[R]:Up.push(R),$r!==4&&($r=2),m===null)return!0;C=ia(C,b),b=m;do{switch(b.tag){case 3:return b.flags|=65536,d=T&-T,b.lanes|=d,d=hS(b.stateNode,C,d),Gw(b,d),!1;case 1:if(m=b.type,R=b.stateNode,(b.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(qu===null||!qu.has(R))))return b.flags|=65536,T&=-T,b.lanes|=T,T=D5(T),T5(T,d,b,C),Gw(b,T),!1}b=b.return}while(b!==null);return!1}var N5=Error(s(461)),Cs=!1;function Ls(d,m,b,C){m.child=d===null?x5(m,null,b,C):sf(m,d.child,b,C)}function k5(d,m,b,C,T){b=b.render;var R=m.ref;if("ref"in C){var j={};for(var ee in C)ee!=="ref"&&(j[ee]=C[ee])}else j=C;return oc(m),C=Kw(d,m,b,j,R,T),ee=Xw(),d!==null&&!Cs?(Yw(d,m,T),Qo(d,m,T)):(zn&&ee&&Iw(m),m.flags|=1,Ls(d,m,C,T),m.child)}function A5(d,m,b,C,T){if(d===null){var R=b.type;return typeof R=="function"&&!Nw(R)&&R.defaultProps===void 0&&b.compare===null?(m.tag=15,m.type=R,I5(d,m,R,C,T)):(d=v1(b.type,null,C,m,m.mode,T),d.ref=m.ref,d.return=m,m.child=d)}if(R=d.child,!bS(d,T)){var j=R.memoizedProps;if(b=b.compare,b=b!==null?b:yp,b(j,C)&&d.ref===m.ref)return Qo(d,m,T)}return m.flags|=1,d=Wo(R,C),d.ref=m.ref,d.return=m,m.child=d}function I5(d,m,b,C,T){if(d!==null){var R=d.memoizedProps;if(yp(R,C)&&d.ref===m.ref)if(Cs=!1,m.pendingProps=C=R,bS(d,T))(d.flags&131072)!==0&&(Cs=!0);else return m.lanes=d.lanes,Qo(d,m,T)}return fS(d,m,b,C,T)}function $5(d,m,b){var C=m.pendingProps,T=C.children,R=d!==null?d.memoizedState:null;if(C.mode==="hidden"){if((m.flags&128)!==0){if(C=R!==null?R.baseLanes|b:b,d!==null){for(T=m.child=d.child,R=0;T!==null;)R=R|T.lanes|T.childLanes,T=T.sibling;m.childLanes=R&~C}else m.childLanes=0,m.child=null;return F5(d,m,C,b)}if((b&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&E1(m,R!==null?R.cachePool:null),R!==null?AI(m,R):Ww(),b5(m);else return m.lanes=m.childLanes=536870912,F5(d,m,R!==null?R.baseLanes|b:b,b)}else R!==null?(E1(m,R.cachePool),AI(m,R),zu(),m.memoizedState=null):(d!==null&&E1(m,null),Ww(),zu());return Ls(d,m,T,b),m.child}function F5(d,m,b,C){var T=Pw();return T=T===null?null:{parent:is._currentValue,pool:T},m.memoizedState={baseLanes:b,cachePool:T},d!==null&&E1(m,null),Ww(),b5(m),d!==null&&Sp(d,m,C,!0),null}function U1(d,m){var b=m.ref;if(b===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(s(284));(d===null||d.ref!==b)&&(m.flags|=4194816)}}function fS(d,m,b,C,T){return oc(m),b=Kw(d,m,b,C,void 0,T),C=Xw(),d!==null&&!Cs?(Yw(d,m,T),Qo(d,m,T)):(zn&&C&&Iw(m),m.flags|=1,Ls(d,m,b,T),m.child)}function R5(d,m,b,C,T,R){return oc(m),m.updateQueue=null,b=$I(m,C,b,T),II(d),C=Xw(),d!==null&&!Cs?(Yw(d,m,R),Qo(d,m,R)):(zn&&C&&Iw(m),m.flags|=1,Ls(d,m,b,R),m.child)}function O5(d,m,b,C,T){if(oc(m),m.stateNode===null){var R=Kh,j=b.contextType;typeof j=="object"&&j!==null&&(R=Ws(j)),R=new b(C,R),m.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=cS,m.stateNode=R,R._reactInternals=m,R=m.stateNode,R.props=C,R.state=m.memoizedState,R.refs={},zw(m),j=b.contextType,R.context=typeof j=="object"&&j!==null?Ws(j):Kh,R.state=m.memoizedState,j=b.getDerivedStateFromProps,typeof j=="function"&&(lS(m,b,j,C),R.state=m.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(j=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),j!==R.state&&cS.enqueueReplaceState(R,R.state,null),kp(m,C,R,T),Np(),R.state=m.memoizedState),typeof R.componentDidMount=="function"&&(m.flags|=4194308),C=!0}else if(d===null){R=m.stateNode;var ee=m.memoizedProps,pe=cc(b,ee);R.props=pe;var Be=R.context,tt=b.contextType;j=Kh,typeof tt=="object"&&tt!==null&&(j=Ws(tt));var st=b.getDerivedStateFromProps;tt=typeof st=="function"||typeof R.getSnapshotBeforeUpdate=="function",ee=m.pendingProps!==ee,tt||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(ee||Be!==j)&&w5(m,R,C,j),Mu=!1;var ze=m.memoizedState;R.state=ze,kp(m,C,R,T),Np(),Be=m.memoizedState,ee||ze!==Be||Mu?(typeof st=="function"&&(lS(m,b,st,C),Be=m.memoizedState),(pe=Mu||v5(m,b,pe,C,ze,Be,j))?(tt||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(m.flags|=4194308)):(typeof R.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=C,m.memoizedState=Be),R.props=C,R.state=Be,R.context=j,C=pe):(typeof R.componentDidMount=="function"&&(m.flags|=4194308),C=!1)}else{R=m.stateNode,Uw(d,m),j=m.memoizedProps,tt=cc(b,j),R.props=tt,st=m.pendingProps,ze=R.context,Be=b.contextType,pe=Kh,typeof Be=="object"&&Be!==null&&(pe=Ws(Be)),ee=b.getDerivedStateFromProps,(Be=typeof ee=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(j!==st||ze!==pe)&&w5(m,R,C,pe),Mu=!1,ze=m.memoizedState,R.state=ze,kp(m,C,R,T),Np();var je=m.memoizedState;j!==st||ze!==je||Mu||d!==null&&d.dependencies!==null&&C1(d.dependencies)?(typeof ee=="function"&&(lS(m,b,ee,C),je=m.memoizedState),(tt=Mu||v5(m,b,tt,C,ze,je,pe)||d!==null&&d.dependencies!==null&&C1(d.dependencies))?(Be||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(C,je,pe),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(C,je,pe)),typeof R.componentDidUpdate=="function"&&(m.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof R.componentDidUpdate!="function"||j===d.memoizedProps&&ze===d.memoizedState||(m.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||j===d.memoizedProps&&ze===d.memoizedState||(m.flags|=1024),m.memoizedProps=C,m.memoizedState=je),R.props=C,R.state=je,R.context=pe,C=tt):(typeof R.componentDidUpdate!="function"||j===d.memoizedProps&&ze===d.memoizedState||(m.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||j===d.memoizedProps&&ze===d.memoizedState||(m.flags|=1024),C=!1)}return R=C,U1(d,m),C=(m.flags&128)!==0,R||C?(R=m.stateNode,b=C&&typeof b.getDerivedStateFromError!="function"?null:R.render(),m.flags|=1,d!==null&&C?(m.child=sf(m,d.child,null,T),m.child=sf(m,null,b,T)):Ls(d,m,b,T),m.memoizedState=R.state,d=m.child):d=Qo(d,m,T),d}function M5(d,m,b,C){return vp(),m.flags|=256,Ls(d,m,b,C),m.child}var dS={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pS(d){return{baseLanes:d,cachePool:SI()}}function mS(d,m,b){return d=d!==null?d.childLanes&~b:0,m&&(d|=ca),d}function L5(d,m,b){var C=m.pendingProps,T=!1,R=(m.flags&128)!==0,j;if((j=R)||(j=d!==null&&d.memoizedState===null?!1:(as.current&2)!==0),j&&(T=!0,m.flags&=-129),j=(m.flags&32)!==0,m.flags&=-33,d===null){if(zn){if(T?Vu(m):zu(),zn){var ee=Ir,pe;if(pe=ee){e:{for(pe=ee,ee=uo;pe.nodeType!==8;){if(!ee){ee=null;break e}if(pe=Va(pe.nextSibling),pe===null){ee=null;break e}}ee=pe}ee!==null?(m.memoizedState={dehydrated:ee,treeContext:nc!==null?{id:Ho,overflow:qo}:null,retryLane:536870912,hydrationErrors:null},pe=Bi(18,null,null,0),pe.stateNode=ee,pe.return=m,m.child=pe,si=m,Ir=null,pe=!0):pe=!1}pe||ic(m)}if(ee=m.memoizedState,ee!==null&&(ee=ee.dehydrated,ee!==null))return QS(ee)?m.lanes=32:m.lanes=536870912,null;Zo(m)}return ee=C.children,C=C.fallback,T?(zu(),T=m.mode,ee=G1({mode:"hidden",children:ee},T),C=tc(C,T,b,null),ee.return=m,C.return=m,ee.sibling=C,m.child=ee,T=m.child,T.memoizedState=pS(b),T.childLanes=mS(d,j,b),m.memoizedState=dS,C):(Vu(m),gS(m,ee))}if(pe=d.memoizedState,pe!==null&&(ee=pe.dehydrated,ee!==null)){if(R)m.flags&256?(Vu(m),m.flags&=-257,m=yS(d,m,b)):m.memoizedState!==null?(zu(),m.child=d.child,m.flags|=128,m=null):(zu(),T=C.fallback,ee=m.mode,C=G1({mode:"visible",children:C.children},ee),T=tc(T,ee,b,null),T.flags|=2,C.return=m,T.return=m,C.sibling=T,m.child=C,sf(m,d.child,null,b),C=m.child,C.memoizedState=pS(b),C.childLanes=mS(d,j,b),m.memoizedState=dS,m=T);else if(Vu(m),QS(ee)){if(j=ee.nextSibling&&ee.nextSibling.dataset,j)var Be=j.dgst;j=Be,C=Error(s(419)),C.stack="",C.digest=j,wp({value:C,source:null,stack:null}),m=yS(d,m,b)}else if(Cs||Sp(d,m,b,!1),j=(b&d.childLanes)!==0,Cs||j){if(j=fr,j!==null&&(C=b&-b,C=(C&42)!==0?1:q(C),C=(C&(j.suspendedLanes|b))!==0?0:C,C!==0&&C!==pe.retryLane))throw pe.retryLane=C,qh(d,C),Gi(j,d,C),N5;ee.data==="$?"||OS(),m=yS(d,m,b)}else ee.data==="$?"?(m.flags|=192,m.child=d.child,m=null):(d=pe.treeContext,Ir=Va(ee.nextSibling),si=m,zn=!0,sc=null,uo=!1,d!==null&&(oa[ua++]=Ho,oa[ua++]=qo,oa[ua++]=nc,Ho=d.id,qo=d.overflow,nc=m),m=gS(m,C.children),m.flags|=4096);return m}return T?(zu(),T=C.fallback,ee=m.mode,pe=d.child,Be=pe.sibling,C=Wo(pe,{mode:"hidden",children:C.children}),C.subtreeFlags=pe.subtreeFlags&65011712,Be!==null?T=Wo(Be,T):(T=tc(T,ee,b,null),T.flags|=2),T.return=m,C.return=m,C.sibling=T,m.child=C,C=T,T=m.child,ee=d.child.memoizedState,ee===null?ee=pS(b):(pe=ee.cachePool,pe!==null?(Be=is._currentValue,pe=pe.parent!==Be?{parent:Be,pool:Be}:pe):pe=SI(),ee={baseLanes:ee.baseLanes|b,cachePool:pe}),T.memoizedState=ee,T.childLanes=mS(d,j,b),m.memoizedState=dS,C):(Vu(m),b=d.child,d=b.sibling,b=Wo(b,{mode:"visible",children:C.children}),b.return=m,b.sibling=null,d!==null&&(j=m.deletions,j===null?(m.deletions=[d],m.flags|=16):j.push(d)),m.child=b,m.memoizedState=null,b)}function gS(d,m){return m=G1({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function G1(d,m){return d=Bi(22,d,null,m),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function yS(d,m,b){return sf(m,d.child,null,b),d=gS(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function B5(d,m,b){d.lanes|=m;var C=d.alternate;C!==null&&(C.lanes|=m),Ow(d.return,m,b)}function xS(d,m,b,C,T){var R=d.memoizedState;R===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:C,tail:b,tailMode:T}:(R.isBackwards=m,R.rendering=null,R.renderingStartTime=0,R.last=C,R.tail=b,R.tailMode=T)}function P5(d,m,b){var C=m.pendingProps,T=C.revealOrder,R=C.tail;if(Ls(d,m,C.children,b),C=as.current,(C&2)!==0)C=C&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&B5(d,b,m);else if(d.tag===19)B5(d,b,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}C&=1}switch(se(as,C),T){case"forwards":for(b=m.child,T=null;b!==null;)d=b.alternate,d!==null&&P1(d)===null&&(T=b),b=b.sibling;b=T,b===null?(T=m.child,m.child=null):(T=b.sibling,b.sibling=null),xS(m,!1,T,b,R);break;case"backwards":for(b=null,T=m.child,m.child=null;T!==null;){if(d=T.alternate,d!==null&&P1(d)===null){m.child=T;break}d=T.sibling,T.sibling=b,b=T,T=d}xS(m,!0,b,null,R);break;case"together":xS(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function Qo(d,m,b){if(d!==null&&(m.dependencies=d.dependencies),Hu|=m.lanes,(b&m.childLanes)===0)if(d!==null){if(Sp(d,m,b,!1),(b&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(s(153));if(m.child!==null){for(d=m.child,b=Wo(d,d.pendingProps),m.child=b,b.return=m;d.sibling!==null;)d=d.sibling,b=b.sibling=Wo(d,d.pendingProps),b.return=m;b.sibling=null}return m.child}function bS(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&C1(d)))}function QK(d,m,b){switch(m.tag){case 3:Me(m,m.stateNode.containerInfo),Ou(m,is,d.memoizedState.cache),vp();break;case 27:case 5:Ne(m);break;case 4:Me(m,m.stateNode.containerInfo);break;case 10:Ou(m,m.type,m.memoizedProps.value);break;case 13:var C=m.memoizedState;if(C!==null)return C.dehydrated!==null?(Vu(m),m.flags|=128,null):(b&m.child.childLanes)!==0?L5(d,m,b):(Vu(m),d=Qo(d,m,b),d!==null?d.sibling:null);Vu(m);break;case 19:var T=(d.flags&128)!==0;if(C=(b&m.childLanes)!==0,C||(Sp(d,m,b,!1),C=(b&m.childLanes)!==0),T){if(C)return P5(d,m,b);m.flags|=128}if(T=m.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),se(as,as.current),C)break;return null;case 22:case 23:return m.lanes=0,$5(d,m,b);case 24:Ou(m,is,d.memoizedState.cache)}return Qo(d,m,b)}function V5(d,m,b){if(d!==null)if(d.memoizedProps!==m.pendingProps)Cs=!0;else{if(!bS(d,b)&&(m.flags&128)===0)return Cs=!1,QK(d,m,b);Cs=(d.flags&131072)!==0}else Cs=!1,zn&&(m.flags&1048576)!==0&&mI(m,S1,m.index);switch(m.lanes=0,m.tag){case 16:e:{d=m.pendingProps;var C=m.elementType,T=C._init;if(C=T(C._payload),m.type=C,typeof C=="function")Nw(C)?(d=cc(C,d),m.tag=1,m=O5(null,m,C,d,b)):(m.tag=0,m=fS(null,m,C,d,b));else{if(C!=null){if(T=C.$$typeof,T===_){m.tag=11,m=k5(null,m,C,d,b);break e}else if(T===k){m.tag=14,m=A5(null,m,C,d,b);break e}}throw m=B(C)||C,Error(s(306,m,""))}}return m;case 0:return fS(d,m,m.type,m.pendingProps,b);case 1:return C=m.type,T=cc(C,m.pendingProps),O5(d,m,C,T,b);case 3:e:{if(Me(m,m.stateNode.containerInfo),d===null)throw Error(s(387));C=m.pendingProps;var R=m.memoizedState;T=R.element,Uw(d,m),kp(m,C,null,b);var j=m.memoizedState;if(C=j.cache,Ou(m,is,C),C!==R.cache&&Mw(m,[is],b,!0),Np(),C=j.element,R.isDehydrated)if(R={element:C,isDehydrated:!1,cache:j.cache},m.updateQueue.baseState=R,m.memoizedState=R,m.flags&256){m=M5(d,m,C,b);break e}else if(C!==T){T=ia(Error(s(424)),m),wp(T),m=M5(d,m,C,b);break e}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Ir=Va(d.firstChild),si=m,zn=!0,sc=null,uo=!0,b=x5(m,null,C,b),m.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling}else{if(vp(),C===T){m=Qo(d,m,b);break e}Ls(d,m,C,b)}m=m.child}return m;case 26:return U1(d,m),d===null?(b=j$(m.type,null,m.pendingProps,null))?m.memoizedState=b:zn||(b=m.type,d=m.pendingProps,C=ry(de.current).createElement(b),C[Ze]=m,C[Qe]=d,Ps(C,b,d),Ss(C),m.stateNode=C):m.memoizedState=j$(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return Ne(m),d===null&&zn&&(C=m.stateNode=z$(m.type,m.pendingProps,de.current),si=m,uo=!0,T=Ir,Yu(m.type)?(JS=T,Ir=Va(C.firstChild)):Ir=T),Ls(d,m,m.pendingProps.children,b),U1(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&zn&&((T=C=Ir)&&(C=DX(C,m.type,m.pendingProps,uo),C!==null?(m.stateNode=C,si=m,Ir=Va(C.firstChild),uo=!1,T=!0):T=!1),T||ic(m)),Ne(m),T=m.type,R=m.pendingProps,j=d!==null?d.memoizedProps:null,C=R.children,XS(T,R)?C=null:j!==null&&XS(T,j)&&(m.flags|=32),m.memoizedState!==null&&(T=Kw(d,m,jK,null,null,b),Zp._currentValue=T),U1(d,m),Ls(d,m,C,b),m.child;case 6:return d===null&&zn&&((d=b=Ir)&&(b=TX(b,m.pendingProps,uo),b!==null?(m.stateNode=b,si=m,Ir=null,d=!0):d=!1),d||ic(m)),null;case 13:return L5(d,m,b);case 4:return Me(m,m.stateNode.containerInfo),C=m.pendingProps,d===null?m.child=sf(m,null,C,b):Ls(d,m,C,b),m.child;case 11:return k5(d,m,m.type,m.pendingProps,b);case 7:return Ls(d,m,m.pendingProps,b),m.child;case 8:return Ls(d,m,m.pendingProps.children,b),m.child;case 12:return Ls(d,m,m.pendingProps.children,b),m.child;case 10:return C=m.pendingProps,Ou(m,m.type,C.value),Ls(d,m,C.children,b),m.child;case 9:return T=m.type._context,C=m.pendingProps.children,oc(m),T=Ws(T),C=C(T),m.flags|=1,Ls(d,m,C,b),m.child;case 14:return A5(d,m,m.type,m.pendingProps,b);case 15:return I5(d,m,m.type,m.pendingProps,b);case 19:return P5(d,m,b);case 31:return C=m.pendingProps,b=m.mode,C={mode:C.mode,children:C.children},d===null?(b=G1(C,b),b.ref=m.ref,m.child=b,b.return=m,m=b):(b=Wo(d.child,C),b.ref=m.ref,m.child=b,b.return=m,m=b),m;case 22:return $5(d,m,b);case 24:return oc(m),C=Ws(is),d===null?(T=Pw(),T===null&&(T=fr,R=Lw(),T.pooledCache=R,R.refCount++,R!==null&&(T.pooledCacheLanes|=b),T=R),m.memoizedState={parent:C,cache:T},zw(m),Ou(m,is,T)):((d.lanes&b)!==0&&(Uw(d,m),kp(m,null,null,b),Np()),T=d.memoizedState,R=m.memoizedState,T.parent!==C?(T={parent:C,cache:C},m.memoizedState=T,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=T),Ou(m,is,C)):(C=R.cache,Ou(m,is,C),C!==T.cache&&Mw(m,[is],b,!0))),Ls(d,m,m.pendingProps.children,b),m.child;case 29:throw m.pendingProps}throw Error(s(156,m.tag))}function Jo(d){d.flags|=4}function z5(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!X$(m)){if(m=la.current,m!==null&&((An&4194048)===An?lo!==null:(An&62914560)!==An&&(An&536870912)===0||m!==lo))throw Dp=Vw,CI;d.flags|=8192}}function j1(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?nt():536870912,d.lanes|=m,lf|=m)}function Mp(d,m){if(!zn)switch(d.tailMode){case"hidden":m=d.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?d.tail=null:b.sibling=null;break;case"collapsed":b=d.tail;for(var C=null;b!==null;)b.alternate!==null&&(C=b),b=b.sibling;C===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:C.sibling=null}}function Nr(d){var m=d.alternate!==null&&d.alternate.child===d.child,b=0,C=0;if(m)for(var T=d.child;T!==null;)b|=T.lanes|T.childLanes,C|=T.subtreeFlags&65011712,C|=T.flags&65011712,T.return=d,T=T.sibling;else for(T=d.child;T!==null;)b|=T.lanes|T.childLanes,C|=T.subtreeFlags,C|=T.flags,T.return=d,T=T.sibling;return d.subtreeFlags|=C,d.childLanes=b,m}function JK(d,m,b){var C=m.pendingProps;switch($w(m),m.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(m),null;case 1:return Nr(m),null;case 3:return b=m.stateNode,C=null,d!==null&&(C=d.memoizedState.cache),m.memoizedState.cache!==C&&(m.flags|=2048),Xo(is),_e(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(d===null||d.child===null)&&(bp(m)?Jo(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,xI())),Nr(m),null;case 26:return b=m.memoizedState,d===null?(Jo(m),b!==null?(Nr(m),z5(m,b)):(Nr(m),m.flags&=-16777217)):b?b!==d.memoizedState?(Jo(m),Nr(m),z5(m,b)):(Nr(m),m.flags&=-16777217):(d.memoizedProps!==C&&Jo(m),Nr(m),m.flags&=-16777217),null;case 27:ve(m),b=de.current;var T=m.type;if(d!==null&&m.stateNode!=null)d.memoizedProps!==C&&Jo(m);else{if(!C){if(m.stateNode===null)throw Error(s(166));return Nr(m),null}d=ue.current,bp(m)?gI(m):(d=z$(T,C,b),m.stateNode=d,Jo(m))}return Nr(m),null;case 5:if(ve(m),b=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==C&&Jo(m);else{if(!C){if(m.stateNode===null)throw Error(s(166));return Nr(m),null}if(d=ue.current,bp(m))gI(m);else{switch(T=ry(de.current),d){case 1:d=T.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:d=T.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":d=T.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":d=T.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":d=T.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof C.is=="string"?T.createElement("select",{is:C.is}):T.createElement("select"),C.multiple?d.multiple=!0:C.size&&(d.size=C.size);break;default:d=typeof C.is=="string"?T.createElement(b,{is:C.is}):T.createElement(b)}}d[Ze]=m,d[Qe]=C;e:for(T=m.child;T!==null;){if(T.tag===5||T.tag===6)d.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break e;for(;T.sibling===null;){if(T.return===null||T.return===m)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}m.stateNode=d;e:switch(Ps(d,b,C),b){case"button":case"input":case"select":case"textarea":d=!!C.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Jo(m)}}return Nr(m),m.flags&=-16777217,null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==C&&Jo(m);else{if(typeof C!="string"&&m.stateNode===null)throw Error(s(166));if(d=de.current,bp(m)){if(d=m.stateNode,b=m.memoizedProps,C=null,T=si,T!==null)switch(T.tag){case 27:case 5:C=T.memoizedProps}d[Ze]=m,d=!!(d.nodeValue===b||C!==null&&C.suppressHydrationWarning===!0||R$(d.nodeValue,b)),d||ic(m)}else d=ry(d).createTextNode(C),d[Ze]=m,m.stateNode=d}return Nr(m),null;case 13:if(C=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(T=bp(m),C!==null&&C.dehydrated!==null){if(d===null){if(!T)throw Error(s(318));if(T=m.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(s(317));T[Ze]=m}else vp(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Nr(m),T=!1}else T=xI(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=T),T=!0;if(!T)return m.flags&256?(Zo(m),m):(Zo(m),null)}if(Zo(m),(m.flags&128)!==0)return m.lanes=b,m;if(b=C!==null,d=d!==null&&d.memoizedState!==null,b){C=m.child,T=null,C.alternate!==null&&C.alternate.memoizedState!==null&&C.alternate.memoizedState.cachePool!==null&&(T=C.alternate.memoizedState.cachePool.pool);var R=null;C.memoizedState!==null&&C.memoizedState.cachePool!==null&&(R=C.memoizedState.cachePool.pool),R!==T&&(C.flags|=2048)}return b!==d&&b&&(m.child.flags|=8192),j1(m,m.updateQueue),Nr(m),null;case 4:return _e(),d===null&&jS(m.stateNode.containerInfo),Nr(m),null;case 10:return Xo(m.type),Nr(m),null;case 19:if(Y(as),T=m.memoizedState,T===null)return Nr(m),null;if(C=(m.flags&128)!==0,R=T.rendering,R===null)if(C)Mp(T,!1);else{if($r!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(R=P1(d),R!==null){for(m.flags|=128,Mp(T,!1),d=R.updateQueue,m.updateQueue=d,j1(m,d),m.subtreeFlags=0,d=b,b=m.child;b!==null;)pI(b,d),b=b.sibling;return se(as,as.current&1|2),m.child}d=d.sibling}T.tail!==null&&ce()>q1&&(m.flags|=128,C=!0,Mp(T,!1),m.lanes=4194304)}else{if(!C)if(d=P1(R),d!==null){if(m.flags|=128,C=!0,d=d.updateQueue,m.updateQueue=d,j1(m,d),Mp(T,!0),T.tail===null&&T.tailMode==="hidden"&&!R.alternate&&!zn)return Nr(m),null}else 2*ce()-T.renderingStartTime>q1&&b!==536870912&&(m.flags|=128,C=!0,Mp(T,!1),m.lanes=4194304);T.isBackwards?(R.sibling=m.child,m.child=R):(d=T.last,d!==null?d.sibling=R:m.child=R,T.last=R)}return T.tail!==null?(m=T.tail,T.rendering=m,T.tail=m.sibling,T.renderingStartTime=ce(),m.sibling=null,d=as.current,se(as,C?d&1|2:d&1),m):(Nr(m),null);case 22:case 23:return Zo(m),Hw(),C=m.memoizedState!==null,d!==null?d.memoizedState!==null!==C&&(m.flags|=8192):C&&(m.flags|=8192),C?(b&536870912)!==0&&(m.flags&128)===0&&(Nr(m),m.subtreeFlags&6&&(m.flags|=8192)):Nr(m),b=m.updateQueue,b!==null&&j1(m,b.retryQueue),b=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),C=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),C!==b&&(m.flags|=2048),d!==null&&Y(uc),null;case 24:return b=null,d!==null&&(b=d.memoizedState.cache),m.memoizedState.cache!==b&&(m.flags|=2048),Xo(is),Nr(m),null;case 25:return null;case 30:return null}throw Error(s(156,m.tag))}function eX(d,m){switch($w(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return Xo(is),_e(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return ve(m),null;case 13:if(Zo(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(s(340));vp()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return Y(as),null;case 4:return _e(),null;case 10:return Xo(m.type),null;case 22:case 23:return Zo(m),Hw(),d!==null&&Y(uc),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return Xo(is),null;case 25:return null;default:return null}}function U5(d,m){switch($w(m),m.tag){case 3:Xo(is),_e();break;case 26:case 27:case 5:ve(m);break;case 4:_e();break;case 13:Zo(m);break;case 19:Y(as);break;case 10:Xo(m.type);break;case 22:case 23:Zo(m),Hw(),d!==null&&Y(uc);break;case 24:Xo(is)}}function Lp(d,m){try{var b=m.updateQueue,C=b!==null?b.lastEffect:null;if(C!==null){var T=C.next;b=T;do{if((b.tag&d)===d){C=void 0;var R=b.create,j=b.inst;C=R(),j.destroy=C}b=b.next}while(b!==T)}}catch(ee){rr(m,m.return,ee)}}function Uu(d,m,b){try{var C=m.updateQueue,T=C!==null?C.lastEffect:null;if(T!==null){var R=T.next;C=R;do{if((C.tag&d)===d){var j=C.inst,ee=j.destroy;if(ee!==void 0){j.destroy=void 0,T=m;var pe=b,Be=ee;try{Be()}catch(tt){rr(T,pe,tt)}}}C=C.next}while(C!==R)}}catch(tt){rr(m,m.return,tt)}}function G5(d){var m=d.updateQueue;if(m!==null){var b=d.stateNode;try{kI(m,b)}catch(C){rr(d,d.return,C)}}}function j5(d,m,b){b.props=cc(d.type,d.memoizedProps),b.state=d.memoizedState;try{b.componentWillUnmount()}catch(C){rr(d,m,C)}}function Bp(d,m){try{var b=d.ref;if(b!==null){switch(d.tag){case 26:case 27:case 5:var C=d.stateNode;break;case 30:C=d.stateNode;break;default:C=d.stateNode}typeof b=="function"?d.refCleanup=b(C):b.current=C}}catch(T){rr(d,m,T)}}function co(d,m){var b=d.ref,C=d.refCleanup;if(b!==null)if(typeof C=="function")try{C()}catch(T){rr(d,m,T)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(T){rr(d,m,T)}else b.current=null}function W5(d){var m=d.type,b=d.memoizedProps,C=d.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":b.autoFocus&&C.focus();break e;case"img":b.src?C.src=b.src:b.srcSet&&(C.srcset=b.srcSet)}}catch(T){rr(d,d.return,T)}}function vS(d,m,b){try{var C=d.stateNode;wX(C,d.type,b,m),C[Qe]=m}catch(T){rr(d,d.return,T)}}function H5(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Yu(d.type)||d.tag===4}function wS(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||H5(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Yu(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function SS(d,m,b){var C=d.tag;if(C===5||C===6)d=d.stateNode,m?(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b).insertBefore(d,m):(m=b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,m.appendChild(d),b=b._reactRootContainer,b!=null||m.onclick!==null||(m.onclick=ny));else if(C!==4&&(C===27&&Yu(d.type)&&(b=d.stateNode,m=null),d=d.child,d!==null))for(SS(d,m,b),d=d.sibling;d!==null;)SS(d,m,b),d=d.sibling}function W1(d,m,b){var C=d.tag;if(C===5||C===6)d=d.stateNode,m?b.insertBefore(d,m):b.appendChild(d);else if(C!==4&&(C===27&&Yu(d.type)&&(b=d.stateNode),d=d.child,d!==null))for(W1(d,m,b),d=d.sibling;d!==null;)W1(d,m,b),d=d.sibling}function q5(d){var m=d.stateNode,b=d.memoizedProps;try{for(var C=d.type,T=m.attributes;T.length;)m.removeAttributeNode(T[0]);Ps(m,C,b),m[Ze]=d,m[Qe]=b}catch(R){rr(d,d.return,R)}}var eu=!1,Vr=!1,CS=!1,K5=typeof WeakSet=="function"?WeakSet:Set,_s=null;function tX(d,m){if(d=d.containerInfo,qS=ly,d=sI(d),ww(d)){if("selectionStart"in d)var b={start:d.selectionStart,end:d.selectionEnd};else e:{b=(b=d.ownerDocument)&&b.defaultView||window;var C=b.getSelection&&b.getSelection();if(C&&C.rangeCount!==0){b=C.anchorNode;var T=C.anchorOffset,R=C.focusNode;C=C.focusOffset;try{b.nodeType,R.nodeType}catch{b=null;break e}var j=0,ee=-1,pe=-1,Be=0,tt=0,st=d,ze=null;t:for(;;){for(var je;st!==b||T!==0&&st.nodeType!==3||(ee=j+T),st!==R||C!==0&&st.nodeType!==3||(pe=j+C),st.nodeType===3&&(j+=st.nodeValue.length),(je=st.firstChild)!==null;)ze=st,st=je;for(;;){if(st===d)break t;if(ze===b&&++Be===T&&(ee=j),ze===R&&++tt===C&&(pe=j),(je=st.nextSibling)!==null)break;st=ze,ze=st.parentNode}st=je}b=ee===-1||pe===-1?null:{start:ee,end:pe}}else b=null}b=b||{start:0,end:0}}else b=null;for(KS={focusedElem:d,selectionRange:b},ly=!1,_s=m;_s!==null;)if(m=_s,d=m.child,(m.subtreeFlags&1024)!==0&&d!==null)d.return=m,_s=d;else for(;_s!==null;){switch(m=_s,R=m.alternate,d=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&R!==null){d=void 0,b=m,T=R.memoizedProps,R=R.memoizedState,C=b.stateNode;try{var Xt=cc(b.type,T,b.elementType===b.type);d=C.getSnapshotBeforeUpdate(Xt,R),C.__reactInternalSnapshotBeforeUpdate=d}catch(jt){rr(b,b.return,jt)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,b=d.nodeType,b===9)ZS(d);else if(b===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":ZS(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(s(163))}if(d=m.sibling,d!==null){d.return=m.return,_s=d;break}_s=m.return}}function X5(d,m,b){var C=b.flags;switch(b.tag){case 0:case 11:case 15:Gu(d,b),C&4&&Lp(5,b);break;case 1:if(Gu(d,b),C&4)if(d=b.stateNode,m===null)try{d.componentDidMount()}catch(j){rr(b,b.return,j)}else{var T=cc(b.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(T,m,d.__reactInternalSnapshotBeforeUpdate)}catch(j){rr(b,b.return,j)}}C&64&&G5(b),C&512&&Bp(b,b.return);break;case 3:if(Gu(d,b),C&64&&(d=b.updateQueue,d!==null)){if(m=null,b.child!==null)switch(b.child.tag){case 27:case 5:m=b.child.stateNode;break;case 1:m=b.child.stateNode}try{kI(d,m)}catch(j){rr(b,b.return,j)}}break;case 27:m===null&&C&4&&q5(b);case 26:case 5:Gu(d,b),m===null&&C&4&&W5(b),C&512&&Bp(b,b.return);break;case 12:Gu(d,b);break;case 13:Gu(d,b),C&4&&Q5(d,b),C&64&&(d=b.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(b=cX.bind(null,b),NX(d,b))));break;case 22:if(C=b.memoizedState!==null||eu,!C){m=m!==null&&m.memoizedState!==null||Vr,T=eu;var R=Vr;eu=C,(Vr=m)&&!R?ju(d,b,(b.subtreeFlags&8772)!==0):Gu(d,b),eu=T,Vr=R}break;case 30:break;default:Gu(d,b)}}function Y5(d){var m=d.alternate;m!==null&&(d.alternate=null,Y5(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&Rh(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var wr=null,bi=!1;function tu(d,m,b){for(b=b.child;b!==null;)Z5(d,m,b),b=b.sibling}function Z5(d,m,b){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(It,b)}catch{}switch(b.tag){case 26:Vr||co(b,m),tu(d,m,b),b.memoizedState?b.memoizedState.count--:b.stateNode&&(b=b.stateNode,b.parentNode.removeChild(b));break;case 27:Vr||co(b,m);var C=wr,T=bi;Yu(b.type)&&(wr=b.stateNode,bi=!1),tu(d,m,b),qp(b.stateNode),wr=C,bi=T;break;case 5:Vr||co(b,m);case 6:if(C=wr,T=bi,wr=null,tu(d,m,b),wr=C,bi=T,wr!==null)if(bi)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(b.stateNode)}catch(R){rr(b,m,R)}else try{wr.removeChild(b.stateNode)}catch(R){rr(b,m,R)}break;case 18:wr!==null&&(bi?(d=wr,P$(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,b.stateNode),tm(d)):P$(wr,b.stateNode));break;case 4:C=wr,T=bi,wr=b.stateNode.containerInfo,bi=!0,tu(d,m,b),wr=C,bi=T;break;case 0:case 11:case 14:case 15:Vr||Uu(2,b,m),Vr||Uu(4,b,m),tu(d,m,b);break;case 1:Vr||(co(b,m),C=b.stateNode,typeof C.componentWillUnmount=="function"&&j5(b,m,C)),tu(d,m,b);break;case 21:tu(d,m,b);break;case 22:Vr=(C=Vr)||b.memoizedState!==null,tu(d,m,b),Vr=C;break;default:tu(d,m,b)}}function Q5(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{tm(d)}catch(b){rr(m,m.return,b)}}function nX(d){switch(d.tag){case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new K5),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new K5),m;default:throw Error(s(435,d.tag))}}function _S(d,m){var b=nX(d);m.forEach(function(C){var T=hX.bind(null,d,C);b.has(C)||(b.add(C),C.then(T,T))})}function Pi(d,m){var b=m.deletions;if(b!==null)for(var C=0;C<b.length;C++){var T=b[C],R=d,j=m,ee=j;e:for(;ee!==null;){switch(ee.tag){case 27:if(Yu(ee.type)){wr=ee.stateNode,bi=!1;break e}break;case 5:wr=ee.stateNode,bi=!1;break e;case 3:case 4:wr=ee.stateNode.containerInfo,bi=!0;break e}ee=ee.return}if(wr===null)throw Error(s(160));Z5(R,j,T),wr=null,bi=!1,R=T.alternate,R!==null&&(R.return=null),T.return=null}if(m.subtreeFlags&13878)for(m=m.child;m!==null;)J5(m,d),m=m.sibling}var Pa=null;function J5(d,m){var b=d.alternate,C=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:Pi(m,d),Vi(d),C&4&&(Uu(3,d,d.return),Lp(3,d),Uu(5,d,d.return));break;case 1:Pi(m,d),Vi(d),C&512&&(Vr||b===null||co(b,b.return)),C&64&&eu&&(d=d.updateQueue,d!==null&&(C=d.callbacks,C!==null&&(b=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=b===null?C:b.concat(C))));break;case 26:var T=Pa;if(Pi(m,d),Vi(d),C&512&&(Vr||b===null||co(b,b.return)),C&4){var R=b!==null?b.memoizedState:null;if(C=d.memoizedState,b===null)if(C===null)if(d.stateNode===null){e:{C=d.type,b=d.memoizedProps,T=T.ownerDocument||T;t:switch(C){case"title":R=T.getElementsByTagName("title")[0],(!R||R[oo]||R[Ze]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=T.createElement(C),T.head.insertBefore(R,T.querySelector("head > title"))),Ps(R,C,b),R[Ze]=d,Ss(R),C=R;break e;case"link":var j=q$("link","href",T).get(C+(b.href||""));if(j){for(var ee=0;ee<j.length;ee++)if(R=j[ee],R.getAttribute("href")===(b.href==null||b.href===""?null:b.href)&&R.getAttribute("rel")===(b.rel==null?null:b.rel)&&R.getAttribute("title")===(b.title==null?null:b.title)&&R.getAttribute("crossorigin")===(b.crossOrigin==null?null:b.crossOrigin)){j.splice(ee,1);break t}}R=T.createElement(C),Ps(R,C,b),T.head.appendChild(R);break;case"meta":if(j=q$("meta","content",T).get(C+(b.content||""))){for(ee=0;ee<j.length;ee++)if(R=j[ee],R.getAttribute("content")===(b.content==null?null:""+b.content)&&R.getAttribute("name")===(b.name==null?null:b.name)&&R.getAttribute("property")===(b.property==null?null:b.property)&&R.getAttribute("http-equiv")===(b.httpEquiv==null?null:b.httpEquiv)&&R.getAttribute("charset")===(b.charSet==null?null:b.charSet)){j.splice(ee,1);break t}}R=T.createElement(C),Ps(R,C,b),T.head.appendChild(R);break;default:throw Error(s(468,C))}R[Ze]=d,Ss(R),C=R}d.stateNode=C}else K$(T,d.type,d.stateNode);else d.stateNode=H$(T,C,d.memoizedProps);else R!==C?(R===null?b.stateNode!==null&&(b=b.stateNode,b.parentNode.removeChild(b)):R.count--,C===null?K$(T,d.type,d.stateNode):H$(T,C,d.memoizedProps)):C===null&&d.stateNode!==null&&vS(d,d.memoizedProps,b.memoizedProps)}break;case 27:Pi(m,d),Vi(d),C&512&&(Vr||b===null||co(b,b.return)),b!==null&&C&4&&vS(d,d.memoizedProps,b.memoizedProps);break;case 5:if(Pi(m,d),Vi(d),C&512&&(Vr||b===null||co(b,b.return)),d.flags&32){T=d.stateNode;try{Vh(T,"")}catch(je){rr(d,d.return,je)}}C&4&&d.stateNode!=null&&(T=d.memoizedProps,vS(d,T,b!==null?b.memoizedProps:T)),C&1024&&(CS=!0);break;case 6:if(Pi(m,d),Vi(d),C&4){if(d.stateNode===null)throw Error(s(162));C=d.memoizedProps,b=d.stateNode;try{b.nodeValue=C}catch(je){rr(d,d.return,je)}}break;case 3:if(ay=null,T=Pa,Pa=sy(m.containerInfo),Pi(m,d),Pa=T,Vi(d),C&4&&b!==null&&b.memoizedState.isDehydrated)try{tm(m.containerInfo)}catch(je){rr(d,d.return,je)}CS&&(CS=!1,e$(d));break;case 4:C=Pa,Pa=sy(d.stateNode.containerInfo),Pi(m,d),Vi(d),Pa=C;break;case 12:Pi(m,d),Vi(d);break;case 13:Pi(m,d),Vi(d),d.child.flags&8192&&d.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(AS=ce()),C&4&&(C=d.updateQueue,C!==null&&(d.updateQueue=null,_S(d,C)));break;case 22:T=d.memoizedState!==null;var pe=b!==null&&b.memoizedState!==null,Be=eu,tt=Vr;if(eu=Be||T,Vr=tt||pe,Pi(m,d),Vr=tt,eu=Be,Vi(d),C&8192)e:for(m=d.stateNode,m._visibility=T?m._visibility&-2:m._visibility|1,T&&(b===null||pe||eu||Vr||hc(d)),b=null,m=d;;){if(m.tag===5||m.tag===26){if(b===null){pe=b=m;try{if(R=pe.stateNode,T)j=R.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none";else{ee=pe.stateNode;var st=pe.memoizedProps.style,ze=st!=null&&st.hasOwnProperty("display")?st.display:null;ee.style.display=ze==null||typeof ze=="boolean"?"":(""+ze).trim()}}catch(je){rr(pe,pe.return,je)}}}else if(m.tag===6){if(b===null){pe=m;try{pe.stateNode.nodeValue=T?"":pe.memoizedProps}catch(je){rr(pe,pe.return,je)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break e;for(;m.sibling===null;){if(m.return===null||m.return===d)break e;b===m&&(b=null),m=m.return}b===m&&(b=null),m.sibling.return=m.return,m=m.sibling}C&4&&(C=d.updateQueue,C!==null&&(b=C.retryQueue,b!==null&&(C.retryQueue=null,_S(d,b))));break;case 19:Pi(m,d),Vi(d),C&4&&(C=d.updateQueue,C!==null&&(d.updateQueue=null,_S(d,C)));break;case 30:break;case 21:break;default:Pi(m,d),Vi(d)}}function Vi(d){var m=d.flags;if(m&2){try{for(var b,C=d.return;C!==null;){if(H5(C)){b=C;break}C=C.return}if(b==null)throw Error(s(160));switch(b.tag){case 27:var T=b.stateNode,R=wS(d);W1(d,R,T);break;case 5:var j=b.stateNode;b.flags&32&&(Vh(j,""),b.flags&=-33);var ee=wS(d);W1(d,ee,j);break;case 3:case 4:var pe=b.stateNode.containerInfo,Be=wS(d);SS(d,Be,pe);break;default:throw Error(s(161))}}catch(tt){rr(d,d.return,tt)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function e$(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;e$(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function Gu(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)X5(d,m.alternate,m),m=m.sibling}function hc(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:Uu(4,m,m.return),hc(m);break;case 1:co(m,m.return);var b=m.stateNode;typeof b.componentWillUnmount=="function"&&j5(m,m.return,b),hc(m);break;case 27:qp(m.stateNode);case 26:case 5:co(m,m.return),hc(m);break;case 22:m.memoizedState===null&&hc(m);break;case 30:hc(m);break;default:hc(m)}d=d.sibling}}function ju(d,m,b){for(b=b&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var C=m.alternate,T=d,R=m,j=R.flags;switch(R.tag){case 0:case 11:case 15:ju(T,R,b),Lp(4,R);break;case 1:if(ju(T,R,b),C=R,T=C.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(Be){rr(C,C.return,Be)}if(C=R,T=C.updateQueue,T!==null){var ee=C.stateNode;try{var pe=T.shared.hiddenCallbacks;if(pe!==null)for(T.shared.hiddenCallbacks=null,T=0;T<pe.length;T++)NI(pe[T],ee)}catch(Be){rr(C,C.return,Be)}}b&&j&64&&G5(R),Bp(R,R.return);break;case 27:q5(R);case 26:case 5:ju(T,R,b),b&&C===null&&j&4&&W5(R),Bp(R,R.return);break;case 12:ju(T,R,b);break;case 13:ju(T,R,b),b&&j&4&&Q5(T,R);break;case 22:R.memoizedState===null&&ju(T,R,b),Bp(R,R.return);break;case 30:break;default:ju(T,R,b)}m=m.sibling}}function ES(d,m){var b=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==b&&(d!=null&&d.refCount++,b!=null&&Cp(b))}function DS(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&Cp(d))}function ho(d,m,b,C){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)t$(d,m,b,C),m=m.sibling}function t$(d,m,b,C){var T=m.flags;switch(m.tag){case 0:case 11:case 15:ho(d,m,b,C),T&2048&&Lp(9,m);break;case 1:ho(d,m,b,C);break;case 3:ho(d,m,b,C),T&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&Cp(d)));break;case 12:if(T&2048){ho(d,m,b,C),d=m.stateNode;try{var R=m.memoizedProps,j=R.id,ee=R.onPostCommit;typeof ee=="function"&&ee(j,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(pe){rr(m,m.return,pe)}}else ho(d,m,b,C);break;case 13:ho(d,m,b,C);break;case 23:break;case 22:R=m.stateNode,j=m.alternate,m.memoizedState!==null?R._visibility&2?ho(d,m,b,C):Pp(d,m):R._visibility&2?ho(d,m,b,C):(R._visibility|=2,af(d,m,b,C,(m.subtreeFlags&10256)!==0)),T&2048&&ES(j,m);break;case 24:ho(d,m,b,C),T&2048&&DS(m.alternate,m);break;default:ho(d,m,b,C)}}function af(d,m,b,C,T){for(T=T&&(m.subtreeFlags&10256)!==0,m=m.child;m!==null;){var R=d,j=m,ee=b,pe=C,Be=j.flags;switch(j.tag){case 0:case 11:case 15:af(R,j,ee,pe,T),Lp(8,j);break;case 23:break;case 22:var tt=j.stateNode;j.memoizedState!==null?tt._visibility&2?af(R,j,ee,pe,T):Pp(R,j):(tt._visibility|=2,af(R,j,ee,pe,T)),T&&Be&2048&&ES(j.alternate,j);break;case 24:af(R,j,ee,pe,T),T&&Be&2048&&DS(j.alternate,j);break;default:af(R,j,ee,pe,T)}m=m.sibling}}function Pp(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var b=d,C=m,T=C.flags;switch(C.tag){case 22:Pp(b,C),T&2048&&ES(C.alternate,C);break;case 24:Pp(b,C),T&2048&&DS(C.alternate,C);break;default:Pp(b,C)}m=m.sibling}}var Vp=8192;function of(d){if(d.subtreeFlags&Vp)for(d=d.child;d!==null;)n$(d),d=d.sibling}function n$(d){switch(d.tag){case 26:of(d),d.flags&Vp&&d.memoizedState!==null&&zX(Pa,d.memoizedState,d.memoizedProps);break;case 5:of(d);break;case 3:case 4:var m=Pa;Pa=sy(d.stateNode.containerInfo),of(d),Pa=m;break;case 22:d.memoizedState===null&&(m=d.alternate,m!==null&&m.memoizedState!==null?(m=Vp,Vp=16777216,of(d),Vp=m):of(d));break;default:of(d)}}function r$(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function zp(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var b=0;b<m.length;b++){var C=m[b];_s=C,i$(C,d)}r$(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)s$(d),d=d.sibling}function s$(d){switch(d.tag){case 0:case 11:case 15:zp(d),d.flags&2048&&Uu(9,d,d.return);break;case 3:zp(d);break;case 12:zp(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,H1(d)):zp(d);break;default:zp(d)}}function H1(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var b=0;b<m.length;b++){var C=m[b];_s=C,i$(C,d)}r$(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:Uu(8,m,m.return),H1(m);break;case 22:b=m.stateNode,b._visibility&2&&(b._visibility&=-3,H1(m));break;default:H1(m)}d=d.sibling}}function i$(d,m){for(;_s!==null;){var b=_s;switch(b.tag){case 0:case 11:case 15:Uu(8,b,m);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var C=b.memoizedState.cachePool.pool;C!=null&&C.refCount++}break;case 24:Cp(b.memoizedState.cache)}if(C=b.child,C!==null)C.return=b,_s=C;else e:for(b=d;_s!==null;){C=_s;var T=C.sibling,R=C.return;if(Y5(C),C===b){_s=null;break e}if(T!==null){T.return=R,_s=T;break e}_s=R}}}var rX={getCacheForType:function(d){var m=Ws(is),b=m.data.get(d);return b===void 0&&(b=d(),m.data.set(d,b)),b}},sX=typeof WeakMap=="function"?WeakMap:Map,Kn=0,fr=null,wn=null,An=0,Xn=0,zi=null,Wu=!1,uf=!1,TS=!1,nu=0,$r=0,Hu=0,fc=0,NS=0,ca=0,lf=0,Up=null,vi=null,kS=!1,AS=0,q1=1/0,K1=null,qu=null,Bs=0,Ku=null,cf=null,hf=0,IS=0,$S=null,a$=null,Gp=0,FS=null;function Ui(){if((Kn&2)!==0&&An!==0)return An&-An;if(V.T!==null){var d=Zh;return d!==0?d:VS()}return H()}function o$(){ca===0&&(ca=(An&536870912)===0||zn?Xe():536870912);var d=la.current;return d!==null&&(d.flags|=32),ca}function Gi(d,m,b){(d===fr&&(Xn===2||Xn===9)||d.cancelPendingCommit!==null)&&(ff(d,0),Xu(d,An,ca,!1)),Ft(d,b),((Kn&2)===0||d!==fr)&&(d===fr&&((Kn&2)===0&&(fc|=b),$r===4&&Xu(d,An,ca,!1)),fo(d))}function u$(d,m,b){if((Kn&6)!==0)throw Error(s(327));var C=!b&&(m&124)===0&&(m&d.expiredLanes)===0||le(d,m),T=C?oX(d,m):MS(d,m,!0),R=C;do{if(T===0){uf&&!C&&Xu(d,m,0,!1);break}else{if(b=d.current.alternate,R&&!iX(b)){T=MS(d,m,!1),R=!1;continue}if(T===2){if(R=m,d.errorRecoveryDisabledLanes&R)var j=0;else j=d.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){m=j;e:{var ee=d;T=Up;var pe=ee.current.memoizedState.isDehydrated;if(pe&&(ff(ee,j).flags|=256),j=MS(ee,j,!1),j!==2){if(TS&&!pe){ee.errorRecoveryDisabledLanes|=R,fc|=R,T=4;break e}R=vi,vi=T,R!==null&&(vi===null?vi=R:vi.push.apply(vi,R))}T=j}if(R=!1,T!==2)continue}}if(T===1){ff(d,0),Xu(d,m,0,!0);break}e:{switch(C=d,R=T,R){case 0:case 1:throw Error(s(345));case 4:if((m&4194048)!==m)break;case 6:Xu(C,m,ca,!Wu);break e;case 2:vi=null;break;case 3:case 5:break;default:throw Error(s(329))}if((m&62914560)===m&&(T=AS+300-ce(),10<T)){if(Xu(C,m,ca,!Wu),ie(C,0,!0)!==0)break e;C.timeoutHandle=L$(l$.bind(null,C,b,vi,K1,kS,m,ca,fc,lf,Wu,R,2,-0,0),T);break e}l$(C,b,vi,K1,kS,m,ca,fc,lf,Wu,R,0,-0,0)}}break}while(!0);fo(d)}function l$(d,m,b,C,T,R,j,ee,pe,Be,tt,st,ze,je){if(d.timeoutHandle=-1,st=m.subtreeFlags,(st&8192||(st&16785408)===16785408)&&(Yp={stylesheets:null,count:0,unsuspend:VX},n$(m),st=UX(),st!==null)){d.cancelPendingCommit=st(g$.bind(null,d,m,R,b,C,T,j,ee,pe,tt,1,ze,je)),Xu(d,R,j,!Be);return}g$(d,m,R,b,C,T,j,ee,pe)}function iX(d){for(var m=d;;){var b=m.tag;if((b===0||b===11||b===15)&&m.flags&16384&&(b=m.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var C=0;C<b.length;C++){var T=b[C],R=T.getSnapshot;T=T.value;try{if(!Li(R(),T))return!1}catch{return!1}}if(b=m.child,m.subtreeFlags&16384&&b!==null)b.return=m,m=b;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Xu(d,m,b,C){m&=~NS,m&=~fc,d.suspendedLanes|=m,d.pingedLanes&=~m,C&&(d.warmLanes|=m),C=d.expirationTimes;for(var T=m;0<T;){var R=31-St(T),j=1<<R;C[R]=-1,T&=~j}b!==0&&Vn(d,b,m)}function X1(){return(Kn&6)===0?(jp(0),!1):!0}function RS(){if(wn!==null){if(Xn===0)var d=wn.return;else d=wn,Ko=ac=null,Zw(d),rf=null,Rp=0,d=wn;for(;d!==null;)U5(d.alternate,d),d=d.return;wn=null}}function ff(d,m){var b=d.timeoutHandle;b!==-1&&(d.timeoutHandle=-1,CX(b)),b=d.cancelPendingCommit,b!==null&&(d.cancelPendingCommit=null,b()),RS(),fr=d,wn=b=Wo(d.current,null),An=m,Xn=0,zi=null,Wu=!1,uf=le(d,m),TS=!1,lf=ca=NS=fc=Hu=$r=0,vi=Up=null,kS=!1,(m&8)!==0&&(m|=m&32);var C=d.entangledLanes;if(C!==0)for(d=d.entanglements,C&=m;0<C;){var T=31-St(C),R=1<<T;m|=d[T],C&=~R}return nu=m,y1(),b}function c$(d,m){mn=null,V.H=M1,m===Ep||m===D1?(m=DI(),Xn=3):m===CI?(m=DI(),Xn=4):Xn=m===N5?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,zi=m,wn===null&&($r=1,z1(d,ia(m,d.current)))}function h$(){var d=V.H;return V.H=M1,d===null?M1:d}function f$(){var d=V.A;return V.A=rX,d}function OS(){$r=4,Wu||(An&4194048)!==An&&la.current!==null||(uf=!0),(Hu&134217727)===0&&(fc&134217727)===0||fr===null||Xu(fr,An,ca,!1)}function MS(d,m,b){var C=Kn;Kn|=2;var T=h$(),R=f$();(fr!==d||An!==m)&&(K1=null,ff(d,m)),m=!1;var j=$r;e:do try{if(Xn!==0&&wn!==null){var ee=wn,pe=zi;switch(Xn){case 8:RS(),j=6;break e;case 3:case 2:case 9:case 6:la.current===null&&(m=!0);var Be=Xn;if(Xn=0,zi=null,df(d,ee,pe,Be),b&&uf){j=0;break e}break;default:Be=Xn,Xn=0,zi=null,df(d,ee,pe,Be)}}aX(),j=$r;break}catch(tt){c$(d,tt)}while(!0);return m&&d.shellSuspendCounter++,Ko=ac=null,Kn=C,V.H=T,V.A=R,wn===null&&(fr=null,An=0,y1()),j}function aX(){for(;wn!==null;)d$(wn)}function oX(d,m){var b=Kn;Kn|=2;var C=h$(),T=f$();fr!==d||An!==m?(K1=null,q1=ce()+500,ff(d,m)):uf=le(d,m);e:do try{if(Xn!==0&&wn!==null){m=wn;var R=zi;t:switch(Xn){case 1:Xn=0,zi=null,df(d,m,R,1);break;case 2:case 9:if(_I(R)){Xn=0,zi=null,p$(m);break}m=function(){Xn!==2&&Xn!==9||fr!==d||(Xn=7),fo(d)},R.then(m,m);break e;case 3:Xn=7;break e;case 4:Xn=5;break e;case 7:_I(R)?(Xn=0,zi=null,p$(m)):(Xn=0,zi=null,df(d,m,R,7));break;case 5:var j=null;switch(wn.tag){case 26:j=wn.memoizedState;case 5:case 27:var ee=wn;if(!j||X$(j)){Xn=0,zi=null;var pe=ee.sibling;if(pe!==null)wn=pe;else{var Be=ee.return;Be!==null?(wn=Be,Y1(Be)):wn=null}break t}}Xn=0,zi=null,df(d,m,R,5);break;case 6:Xn=0,zi=null,df(d,m,R,6);break;case 8:RS(),$r=6;break e;default:throw Error(s(462))}}uX();break}catch(tt){c$(d,tt)}while(!0);return Ko=ac=null,V.H=C,V.A=T,Kn=b,wn!==null?0:(fr=null,An=0,y1(),$r)}function uX(){for(;wn!==null&&!re();)d$(wn)}function d$(d){var m=V5(d.alternate,d,nu);d.memoizedProps=d.pendingProps,m===null?Y1(d):wn=m}function p$(d){var m=d,b=m.alternate;switch(m.tag){case 15:case 0:m=R5(b,m,m.pendingProps,m.type,void 0,An);break;case 11:m=R5(b,m,m.pendingProps,m.type.render,m.ref,An);break;case 5:Zw(m);default:U5(b,m),m=wn=pI(m,nu),m=V5(b,m,nu)}d.memoizedProps=d.pendingProps,m===null?Y1(d):wn=m}function df(d,m,b,C){Ko=ac=null,Zw(m),rf=null,Rp=0;var T=m.return;try{if(ZK(d,T,m,b,An)){$r=1,z1(d,ia(b,d.current)),wn=null;return}}catch(R){if(T!==null)throw wn=T,R;$r=1,z1(d,ia(b,d.current)),wn=null;return}m.flags&32768?(zn||C===1?d=!0:uf||(An&536870912)!==0?d=!1:(Wu=d=!0,(C===2||C===9||C===3||C===6)&&(C=la.current,C!==null&&C.tag===13&&(C.flags|=16384))),m$(m,d)):Y1(m)}function Y1(d){var m=d;do{if((m.flags&32768)!==0){m$(m,Wu);return}d=m.return;var b=JK(m.alternate,m,nu);if(b!==null){wn=b;return}if(m=m.sibling,m!==null){wn=m;return}wn=m=d}while(m!==null);$r===0&&($r=5)}function m$(d,m){do{var b=eX(d.alternate,d);if(b!==null){b.flags&=32767,wn=b;return}if(b=d.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!m&&(d=d.sibling,d!==null)){wn=d;return}wn=d=b}while(d!==null);$r=6,wn=null}function g$(d,m,b,C,T,R,j,ee,pe){d.cancelPendingCommit=null;do Z1();while(Bs!==0);if((Kn&6)!==0)throw Error(s(327));if(m!==null){if(m===d.current)throw Error(s(177));if(R=m.lanes|m.childLanes,R|=Dw,qt(d,b,R,j,ee,pe),d===fr&&(wn=fr=null,An=0),cf=m,Ku=d,hf=b,IS=R,$S=T,a$=C,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,fX(lt,function(){return w$(),null})):(d.callbackNode=null,d.callbackPriority=0),C=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||C){C=V.T,V.T=null,T=Z.p,Z.p=2,j=Kn,Kn|=4;try{tX(d,m,b)}finally{Kn=j,Z.p=T,V.T=C}}Bs=1,y$(),x$(),b$()}}function y$(){if(Bs===1){Bs=0;var d=Ku,m=cf,b=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||b){b=V.T,V.T=null;var C=Z.p;Z.p=2;var T=Kn;Kn|=4;try{J5(m,d);var R=KS,j=sI(d.containerInfo),ee=R.focusedElem,pe=R.selectionRange;if(j!==ee&&ee&&ee.ownerDocument&&rI(ee.ownerDocument.documentElement,ee)){if(pe!==null&&ww(ee)){var Be=pe.start,tt=pe.end;if(tt===void 0&&(tt=Be),"selectionStart"in ee)ee.selectionStart=Be,ee.selectionEnd=Math.min(tt,ee.value.length);else{var st=ee.ownerDocument||document,ze=st&&st.defaultView||window;if(ze.getSelection){var je=ze.getSelection(),Xt=ee.textContent.length,jt=Math.min(pe.start,Xt),Qn=pe.end===void 0?jt:Math.min(pe.end,Xt);!je.extend&&jt>Qn&&(j=Qn,Qn=jt,jt=j);var Ae=nI(ee,jt),we=nI(ee,Qn);if(Ae&&we&&(je.rangeCount!==1||je.anchorNode!==Ae.node||je.anchorOffset!==Ae.offset||je.focusNode!==we.node||je.focusOffset!==we.offset)){var Le=st.createRange();Le.setStart(Ae.node,Ae.offset),je.removeAllRanges(),jt>Qn?(je.addRange(Le),je.extend(we.node,we.offset)):(Le.setEnd(we.node,we.offset),je.addRange(Le))}}}}for(st=[],je=ee;je=je.parentNode;)je.nodeType===1&&st.push({element:je,left:je.scrollLeft,top:je.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<st.length;ee++){var rt=st[ee];rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}ly=!!qS,KS=qS=null}finally{Kn=T,Z.p=C,V.T=b}}d.current=m,Bs=2}}function x$(){if(Bs===2){Bs=0;var d=Ku,m=cf,b=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||b){b=V.T,V.T=null;var C=Z.p;Z.p=2;var T=Kn;Kn|=4;try{X5(d,m.alternate,m)}finally{Kn=T,Z.p=C,V.T=b}}Bs=3}}function b$(){if(Bs===4||Bs===3){Bs=0,Q();var d=Ku,m=cf,b=hf,C=a$;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?Bs=5:(Bs=0,cf=Ku=null,v$(d,d.pendingLanes));var T=d.pendingLanes;if(T===0&&(qu=null),W(b),m=m.stateNode,ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(It,m,void 0,(m.current.flags&128)===128)}catch{}if(C!==null){m=V.T,T=Z.p,Z.p=2,V.T=null;try{for(var R=d.onRecoverableError,j=0;j<C.length;j++){var ee=C[j];R(ee.value,{componentStack:ee.stack})}}finally{V.T=m,Z.p=T}}(hf&3)!==0&&Z1(),fo(d),T=d.pendingLanes,(b&4194090)!==0&&(T&42)!==0?d===FS?Gp++:(Gp=0,FS=d):Gp=0,jp(0)}}function v$(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,Cp(m)))}function Z1(d){return y$(),x$(),b$(),w$()}function w$(){if(Bs!==5)return!1;var d=Ku,m=IS;IS=0;var b=W(hf),C=V.T,T=Z.p;try{Z.p=32>b?32:b,V.T=null,b=$S,$S=null;var R=Ku,j=hf;if(Bs=0,cf=Ku=null,hf=0,(Kn&6)!==0)throw Error(s(331));var ee=Kn;if(Kn|=4,s$(R.current),t$(R,R.current,j,b),Kn=ee,jp(0,!1),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(It,R)}catch{}return!0}finally{Z.p=T,V.T=C,v$(d,m)}}function S$(d,m,b){m=ia(b,m),m=hS(d.stateNode,m,2),d=Bu(d,m,2),d!==null&&(Ft(d,2),fo(d))}function rr(d,m,b){if(d.tag===3)S$(d,d,b);else for(;m!==null;){if(m.tag===3){S$(m,d,b);break}else if(m.tag===1){var C=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof C.componentDidCatch=="function"&&(qu===null||!qu.has(C))){d=ia(b,d),b=D5(2),C=Bu(m,b,2),C!==null&&(T5(b,C,m,d),Ft(C,2),fo(C));break}}m=m.return}}function LS(d,m,b){var C=d.pingCache;if(C===null){C=d.pingCache=new sX;var T=new Set;C.set(m,T)}else T=C.get(m),T===void 0&&(T=new Set,C.set(m,T));T.has(b)||(TS=!0,T.add(b),d=lX.bind(null,d,m,b),m.then(d,d))}function lX(d,m,b){var C=d.pingCache;C!==null&&C.delete(m),d.pingedLanes|=d.suspendedLanes&b,d.warmLanes&=~b,fr===d&&(An&b)===b&&($r===4||$r===3&&(An&62914560)===An&&300>ce()-AS?(Kn&2)===0&&ff(d,0):NS|=b,lf===An&&(lf=0)),fo(d)}function C$(d,m){m===0&&(m=nt()),d=qh(d,m),d!==null&&(Ft(d,m),fo(d))}function cX(d){var m=d.memoizedState,b=0;m!==null&&(b=m.retryLane),C$(d,b)}function hX(d,m){var b=0;switch(d.tag){case 13:var C=d.stateNode,T=d.memoizedState;T!==null&&(b=T.retryLane);break;case 19:C=d.stateNode;break;case 22:C=d.stateNode._retryCache;break;default:throw Error(s(314))}C!==null&&C.delete(m),C$(d,b)}function fX(d,m){return et(d,m)}var Q1=null,pf=null,BS=!1,J1=!1,PS=!1,dc=0;function fo(d){d!==pf&&d.next===null&&(pf===null?Q1=pf=d:pf=pf.next=d),J1=!0,BS||(BS=!0,pX())}function jp(d,m){if(!PS&&J1){PS=!0;do for(var b=!1,C=Q1;C!==null;){if(d!==0){var T=C.pendingLanes;if(T===0)var R=0;else{var j=C.suspendedLanes,ee=C.pingedLanes;R=(1<<31-St(42|d)+1)-1,R&=T&~(j&~ee),R=R&201326741?R&201326741|1:R?R|2:0}R!==0&&(b=!0,T$(C,R))}else R=An,R=ie(C,C===fr?R:0,C.cancelPendingCommit!==null||C.timeoutHandle!==-1),(R&3)===0||le(C,R)||(b=!0,T$(C,R));C=C.next}while(b);PS=!1}}function dX(){_$()}function _$(){J1=BS=!1;var d=0;dc!==0&&(SX()&&(d=dc),dc=0);for(var m=ce(),b=null,C=Q1;C!==null;){var T=C.next,R=E$(C,m);R===0?(C.next=null,b===null?Q1=T:b.next=T,T===null&&(pf=b)):(b=C,(d!==0||(R&3)!==0)&&(J1=!0)),C=T}jp(d)}function E$(d,m){for(var b=d.suspendedLanes,C=d.pingedLanes,T=d.expirationTimes,R=d.pendingLanes&-62914561;0<R;){var j=31-St(R),ee=1<<j,pe=T[j];pe===-1?((ee&b)===0||(ee&C)!==0)&&(T[j]=ge(ee,m)):pe<=m&&(d.expiredLanes|=ee),R&=~ee}if(m=fr,b=An,b=ie(d,d===m?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),C=d.callbackNode,b===0||d===m&&(Xn===2||Xn===9)||d.cancelPendingCommit!==null)return C!==null&&C!==null&&Ve(C),d.callbackNode=null,d.callbackPriority=0;if((b&3)===0||le(d,b)){if(m=b&-b,m===d.callbackPriority)return m;switch(C!==null&&Ve(C),W(b)){case 2:case 8:b=Oe;break;case 32:b=lt;break;case 268435456:b=bt;break;default:b=lt}return C=D$.bind(null,d),b=et(b,C),d.callbackPriority=m,d.callbackNode=b,m}return C!==null&&C!==null&&Ve(C),d.callbackPriority=2,d.callbackNode=null,2}function D$(d,m){if(Bs!==0&&Bs!==5)return d.callbackNode=null,d.callbackPriority=0,null;var b=d.callbackNode;if(Z1()&&d.callbackNode!==b)return null;var C=An;return C=ie(d,d===fr?C:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),C===0?null:(u$(d,C,m),E$(d,ce()),d.callbackNode!=null&&d.callbackNode===b?D$.bind(null,d):null)}function T$(d,m){if(Z1())return null;u$(d,m,!0)}function pX(){_X(function(){(Kn&6)!==0?et(Ge,dX):_$()})}function VS(){return dc===0&&(dc=Xe()),dc}function N$(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:c1(""+d)}function k$(d,m){var b=m.ownerDocument.createElement("input");return b.name=m.name,b.value=m.value,d.id&&b.setAttribute("form",d.id),m.parentNode.insertBefore(b,m),d=new FormData(d),b.parentNode.removeChild(b),d}function mX(d,m,b,C,T){if(m==="submit"&&b&&b.stateNode===T){var R=N$((T[Qe]||null).action),j=C.submitter;j&&(m=(m=j[Qe]||null)?N$(m.formAction):j.getAttribute("formAction"),m!==null&&(R=m,j=null));var ee=new p1("action","action",null,C,T);d.push({event:ee,listeners:[{instance:null,listener:function(){if(C.defaultPrevented){if(dc!==0){var pe=j?k$(T,j):new FormData(T);aS(b,{pending:!0,data:pe,method:T.method,action:R},null,pe)}}else typeof R=="function"&&(ee.preventDefault(),pe=j?k$(T,j):new FormData(T),aS(b,{pending:!0,data:pe,method:T.method,action:R},R,pe))},currentTarget:T}]})}}for(var zS=0;zS<Ew.length;zS++){var US=Ew[zS],gX=US.toLowerCase(),yX=US[0].toUpperCase()+US.slice(1);Ba(gX,"on"+yX)}Ba(oI,"onAnimationEnd"),Ba(uI,"onAnimationIteration"),Ba(lI,"onAnimationStart"),Ba("dblclick","onDoubleClick"),Ba("focusin","onFocus"),Ba("focusout","onBlur"),Ba(RK,"onTransitionRun"),Ba(OK,"onTransitionStart"),Ba(MK,"onTransitionCancel"),Ba(cI,"onTransitionEnd"),Lh("onMouseEnter",["mouseout","mouseover"]),Lh("onMouseLeave",["mouseout","mouseover"]),Lh("onPointerEnter",["pointerout","pointerover"]),Lh("onPointerLeave",["pointerout","pointerover"]),Zl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zl("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xX=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wp));function A$(d,m){m=(m&4)!==0;for(var b=0;b<d.length;b++){var C=d[b],T=C.event;C=C.listeners;e:{var R=void 0;if(m)for(var j=C.length-1;0<=j;j--){var ee=C[j],pe=ee.instance,Be=ee.currentTarget;if(ee=ee.listener,pe!==R&&T.isPropagationStopped())break e;R=ee,T.currentTarget=Be;try{R(T)}catch(tt){V1(tt)}T.currentTarget=null,R=pe}else for(j=0;j<C.length;j++){if(ee=C[j],pe=ee.instance,Be=ee.currentTarget,ee=ee.listener,pe!==R&&T.isPropagationStopped())break e;R=ee,T.currentTarget=Be;try{R(T)}catch(tt){V1(tt)}T.currentTarget=null,R=pe}}}}function Sn(d,m){var b=m[Gt];b===void 0&&(b=m[Gt]=new Set);var C=d+"__bubble";b.has(C)||(I$(m,d,2,!1),b.add(C))}function GS(d,m,b){var C=0;m&&(C|=4),I$(b,d,C,m)}var ey="_reactListening"+Math.random().toString(36).slice(2);function jS(d){if(!d[ey]){d[ey]=!0,CA.forEach(function(b){b!=="selectionchange"&&(xX.has(b)||GS(b,!1,d),GS(b,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[ey]||(m[ey]=!0,GS("selectionchange",!1,m))}}function I$(d,m,b,C){switch(t4(m)){case 2:var T=WX;break;case 8:T=HX;break;default:T=sC}b=T.bind(null,m,b,d),T=void 0,!fw||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(T=!0),C?T!==void 0?d.addEventListener(m,b,{capture:!0,passive:T}):d.addEventListener(m,b,!0):T!==void 0?d.addEventListener(m,b,{passive:T}):d.addEventListener(m,b,!1)}function WS(d,m,b,C,T){var R=C;if((m&1)===0&&(m&2)===0&&C!==null)e:for(;;){if(C===null)return;var j=C.tag;if(j===3||j===4){var ee=C.stateNode.containerInfo;if(ee===T)break;if(j===4)for(j=C.return;j!==null;){var pe=j.tag;if((pe===3||pe===4)&&j.stateNode.containerInfo===T)return;j=j.return}for(;ee!==null;){if(j=Ms(ee),j===null)return;if(pe=j.tag,pe===5||pe===6||pe===26||pe===27){C=R=j;continue e}ee=ee.parentNode}}C=C.return}LA(function(){var Be=R,tt=cw(b),st=[];e:{var ze=hI.get(d);if(ze!==void 0){var je=p1,Xt=d;switch(d){case"keypress":if(f1(b)===0)break e;case"keydown":case"keyup":je=fK;break;case"focusin":Xt="focus",je=gw;break;case"focusout":Xt="blur",je=gw;break;case"beforeblur":case"afterblur":je=gw;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=VA;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=eK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=mK;break;case oI:case uI:case lI:je=rK;break;case cI:je=yK;break;case"scroll":case"scrollend":je=Qq;break;case"wheel":je=bK;break;case"copy":case"cut":case"paste":je=iK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=UA;break;case"toggle":case"beforetoggle":je=wK}var jt=(m&4)!==0,Qn=!jt&&(d==="scroll"||d==="scrollend"),Ae=jt?ze!==null?ze+"Capture":null:ze;jt=[];for(var we=Be,Le;we!==null;){var rt=we;if(Le=rt.stateNode,rt=rt.tag,rt!==5&&rt!==26&&rt!==27||Le===null||Ae===null||(rt=cp(we,Ae),rt!=null&&jt.push(Hp(we,rt,Le))),Qn)break;we=we.return}0<jt.length&&(ze=new je(ze,Xt,null,b,tt),st.push({event:ze,listeners:jt}))}}if((m&7)===0){e:{if(ze=d==="mouseover"||d==="pointerover",je=d==="mouseout"||d==="pointerout",ze&&b!==lw&&(Xt=b.relatedTarget||b.fromElement)&&(Ms(Xt)||Xt[ct]))break e;if((je||ze)&&(ze=tt.window===tt?tt:(ze=tt.ownerDocument)?ze.defaultView||ze.parentWindow:window,je?(Xt=b.relatedTarget||b.toElement,je=Be,Xt=Xt?Ms(Xt):null,Xt!==null&&(Qn=a(Xt),jt=Xt.tag,Xt!==Qn||jt!==5&&jt!==27&&jt!==6)&&(Xt=null)):(je=null,Xt=Be),je!==Xt)){if(jt=VA,rt="onMouseLeave",Ae="onMouseEnter",we="mouse",(d==="pointerout"||d==="pointerover")&&(jt=UA,rt="onPointerLeave",Ae="onPointerEnter",we="pointer"),Qn=je==null?ze:lp(je),Le=Xt==null?ze:lp(Xt),ze=new jt(rt,we+"leave",je,b,tt),ze.target=Qn,ze.relatedTarget=Le,rt=null,Ms(tt)===Be&&(jt=new jt(Ae,we+"enter",Xt,b,tt),jt.target=Le,jt.relatedTarget=Qn,rt=jt),Qn=rt,je&&Xt)t:{for(jt=je,Ae=Xt,we=0,Le=jt;Le;Le=mf(Le))we++;for(Le=0,rt=Ae;rt;rt=mf(rt))Le++;for(;0<we-Le;)jt=mf(jt),we--;for(;0<Le-we;)Ae=mf(Ae),Le--;for(;we--;){if(jt===Ae||Ae!==null&&jt===Ae.alternate)break t;jt=mf(jt),Ae=mf(Ae)}jt=null}else jt=null;je!==null&&$$(st,ze,je,jt,!1),Xt!==null&&Qn!==null&&$$(st,Qn,Xt,jt,!0)}}e:{if(ze=Be?lp(Be):window,je=ze.nodeName&&ze.nodeName.toLowerCase(),je==="select"||je==="input"&&ze.type==="file")var Nt=YA;else if(KA(ze))if(ZA)Nt=IK;else{Nt=kK;var xn=NK}else je=ze.nodeName,!je||je.toLowerCase()!=="input"||ze.type!=="checkbox"&&ze.type!=="radio"?Be&&uw(Be.elementType)&&(Nt=YA):Nt=AK;if(Nt&&(Nt=Nt(d,Be))){XA(st,Nt,b,tt);break e}xn&&xn(d,ze,Be),d==="focusout"&&Be&&ze.type==="number"&&Be.memoizedProps.value!=null&&ow(ze,"number",ze.value)}switch(xn=Be?lp(Be):window,d){case"focusin":(KA(xn)||xn.contentEditable==="true")&&(jh=xn,Sw=Be,xp=null);break;case"focusout":xp=Sw=jh=null;break;case"mousedown":Cw=!0;break;case"contextmenu":case"mouseup":case"dragend":Cw=!1,iI(st,b,tt);break;case"selectionchange":if(FK)break;case"keydown":case"keyup":iI(st,b,tt)}var Lt;if(xw)e:{switch(d){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else Gh?HA(d,b)&&(Wt="onCompositionEnd"):d==="keydown"&&b.keyCode===229&&(Wt="onCompositionStart");Wt&&(GA&&b.locale!=="ko"&&(Gh||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&Gh&&(Lt=BA()):(Ru=tt,dw="value"in Ru?Ru.value:Ru.textContent,Gh=!0)),xn=ty(Be,Wt),0<xn.length&&(Wt=new zA(Wt,d,null,b,tt),st.push({event:Wt,listeners:xn}),Lt?Wt.data=Lt:(Lt=qA(b),Lt!==null&&(Wt.data=Lt)))),(Lt=CK?_K(d,b):EK(d,b))&&(Wt=ty(Be,"onBeforeInput"),0<Wt.length&&(xn=new zA("onBeforeInput","beforeinput",null,b,tt),st.push({event:xn,listeners:Wt}),xn.data=Lt)),mX(st,d,Be,b,tt)}A$(st,m)})}function Hp(d,m,b){return{instance:d,listener:m,currentTarget:b}}function ty(d,m){for(var b=m+"Capture",C=[];d!==null;){var T=d,R=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||R===null||(T=cp(d,b),T!=null&&C.unshift(Hp(d,T,R)),T=cp(d,m),T!=null&&C.push(Hp(d,T,R))),d.tag===3)return C;d=d.return}return[]}function mf(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function $$(d,m,b,C,T){for(var R=m._reactName,j=[];b!==null&&b!==C;){var ee=b,pe=ee.alternate,Be=ee.stateNode;if(ee=ee.tag,pe!==null&&pe===C)break;ee!==5&&ee!==26&&ee!==27||Be===null||(pe=Be,T?(Be=cp(b,R),Be!=null&&j.unshift(Hp(b,Be,pe))):T||(Be=cp(b,R),Be!=null&&j.push(Hp(b,Be,pe)))),b=b.return}j.length!==0&&d.push({event:m,listeners:j})}var bX=/\r\n?/g,vX=/\u0000|\uFFFD/g;function F$(d){return(typeof d=="string"?d:""+d).replace(bX,`
`).replace(vX,"")}function R$(d,m){return m=F$(m),F$(d)===m}function ny(){}function Zn(d,m,b,C,T,R){switch(b){case"children":typeof C=="string"?m==="body"||m==="textarea"&&C===""||Vh(d,C):(typeof C=="number"||typeof C=="bigint")&&m!=="body"&&Vh(d,""+C);break;case"className":o1(d,"class",C);break;case"tabIndex":o1(d,"tabindex",C);break;case"dir":case"role":case"viewBox":case"width":case"height":o1(d,b,C);break;case"style":OA(d,C,R);break;case"data":if(m!=="object"){o1(d,"data",C);break}case"src":case"href":if(C===""&&(m!=="a"||b!=="href")){d.removeAttribute(b);break}if(C==null||typeof C=="function"||typeof C=="symbol"||typeof C=="boolean"){d.removeAttribute(b);break}C=c1(""+C),d.setAttribute(b,C);break;case"action":case"formAction":if(typeof C=="function"){d.setAttribute(b,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(b==="formAction"?(m!=="input"&&Zn(d,m,"name",T.name,T,null),Zn(d,m,"formEncType",T.formEncType,T,null),Zn(d,m,"formMethod",T.formMethod,T,null),Zn(d,m,"formTarget",T.formTarget,T,null)):(Zn(d,m,"encType",T.encType,T,null),Zn(d,m,"method",T.method,T,null),Zn(d,m,"target",T.target,T,null)));if(C==null||typeof C=="symbol"||typeof C=="boolean"){d.removeAttribute(b);break}C=c1(""+C),d.setAttribute(b,C);break;case"onClick":C!=null&&(d.onclick=ny);break;case"onScroll":C!=null&&Sn("scroll",d);break;case"onScrollEnd":C!=null&&Sn("scrollend",d);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(b=C.__html,b!=null){if(T.children!=null)throw Error(s(60));d.innerHTML=b}}break;case"multiple":d.multiple=C&&typeof C!="function"&&typeof C!="symbol";break;case"muted":d.muted=C&&typeof C!="function"&&typeof C!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(C==null||typeof C=="function"||typeof C=="boolean"||typeof C=="symbol"){d.removeAttribute("xlink:href");break}b=c1(""+C),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":C!=null&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(b,""+C):d.removeAttribute(b);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":C&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(b,""):d.removeAttribute(b);break;case"capture":case"download":C===!0?d.setAttribute(b,""):C!==!1&&C!=null&&typeof C!="function"&&typeof C!="symbol"?d.setAttribute(b,C):d.removeAttribute(b);break;case"cols":case"rows":case"size":case"span":C!=null&&typeof C!="function"&&typeof C!="symbol"&&!isNaN(C)&&1<=C?d.setAttribute(b,C):d.removeAttribute(b);break;case"rowSpan":case"start":C==null||typeof C=="function"||typeof C=="symbol"||isNaN(C)?d.removeAttribute(b):d.setAttribute(b,C);break;case"popover":Sn("beforetoggle",d),Sn("toggle",d),a1(d,"popover",C);break;case"xlinkActuate":Go(d,"http://www.w3.org/1999/xlink","xlink:actuate",C);break;case"xlinkArcrole":Go(d,"http://www.w3.org/1999/xlink","xlink:arcrole",C);break;case"xlinkRole":Go(d,"http://www.w3.org/1999/xlink","xlink:role",C);break;case"xlinkShow":Go(d,"http://www.w3.org/1999/xlink","xlink:show",C);break;case"xlinkTitle":Go(d,"http://www.w3.org/1999/xlink","xlink:title",C);break;case"xlinkType":Go(d,"http://www.w3.org/1999/xlink","xlink:type",C);break;case"xmlBase":Go(d,"http://www.w3.org/XML/1998/namespace","xml:base",C);break;case"xmlLang":Go(d,"http://www.w3.org/XML/1998/namespace","xml:lang",C);break;case"xmlSpace":Go(d,"http://www.w3.org/XML/1998/namespace","xml:space",C);break;case"is":a1(d,"is",C);break;case"innerText":case"textContent":break;default:(!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(b=Yq.get(b)||b,a1(d,b,C))}}function HS(d,m,b,C,T,R){switch(b){case"style":OA(d,C,R);break;case"dangerouslySetInnerHTML":if(C!=null){if(typeof C!="object"||!("__html"in C))throw Error(s(61));if(b=C.__html,b!=null){if(T.children!=null)throw Error(s(60));d.innerHTML=b}}break;case"children":typeof C=="string"?Vh(d,C):(typeof C=="number"||typeof C=="bigint")&&Vh(d,""+C);break;case"onScroll":C!=null&&Sn("scroll",d);break;case"onScrollEnd":C!=null&&Sn("scrollend",d);break;case"onClick":C!=null&&(d.onclick=ny);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_A.hasOwnProperty(b))e:{if(b[0]==="o"&&b[1]==="n"&&(T=b.endsWith("Capture"),m=b.slice(2,T?b.length-7:void 0),R=d[Qe]||null,R=R!=null?R[b]:null,typeof R=="function"&&d.removeEventListener(m,R,T),typeof C=="function")){typeof R!="function"&&R!==null&&(b in d?d[b]=null:d.hasAttribute(b)&&d.removeAttribute(b)),d.addEventListener(m,C,T);break e}b in d?d[b]=C:C===!0?d.setAttribute(b,""):a1(d,b,C)}}}function Ps(d,m,b){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Sn("error",d),Sn("load",d);var C=!1,T=!1,R;for(R in b)if(b.hasOwnProperty(R)){var j=b[R];if(j!=null)switch(R){case"src":C=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,m));default:Zn(d,m,R,j,b,null)}}T&&Zn(d,m,"srcSet",b.srcSet,b,null),C&&Zn(d,m,"src",b.src,b,null);return;case"input":Sn("invalid",d);var ee=R=j=T=null,pe=null,Be=null;for(C in b)if(b.hasOwnProperty(C)){var tt=b[C];if(tt!=null)switch(C){case"name":T=tt;break;case"type":j=tt;break;case"checked":pe=tt;break;case"defaultChecked":Be=tt;break;case"value":R=tt;break;case"defaultValue":ee=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(s(137,m));break;default:Zn(d,m,C,tt,b,null)}}IA(d,R,ee,pe,Be,j,T,!1),u1(d);return;case"select":Sn("invalid",d),C=j=R=null;for(T in b)if(b.hasOwnProperty(T)&&(ee=b[T],ee!=null))switch(T){case"value":R=ee;break;case"defaultValue":j=ee;break;case"multiple":C=ee;default:Zn(d,m,T,ee,b,null)}m=R,b=j,d.multiple=!!C,m!=null?Ph(d,!!C,m,!1):b!=null&&Ph(d,!!C,b,!0);return;case"textarea":Sn("invalid",d),R=T=C=null;for(j in b)if(b.hasOwnProperty(j)&&(ee=b[j],ee!=null))switch(j){case"value":C=ee;break;case"defaultValue":T=ee;break;case"children":R=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(s(91));break;default:Zn(d,m,j,ee,b,null)}FA(d,C,T,R),u1(d);return;case"option":for(pe in b)if(b.hasOwnProperty(pe)&&(C=b[pe],C!=null))switch(pe){case"selected":d.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:Zn(d,m,pe,C,b,null)}return;case"dialog":Sn("beforetoggle",d),Sn("toggle",d),Sn("cancel",d),Sn("close",d);break;case"iframe":case"object":Sn("load",d);break;case"video":case"audio":for(C=0;C<Wp.length;C++)Sn(Wp[C],d);break;case"image":Sn("error",d),Sn("load",d);break;case"details":Sn("toggle",d);break;case"embed":case"source":case"link":Sn("error",d),Sn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Be in b)if(b.hasOwnProperty(Be)&&(C=b[Be],C!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,m));default:Zn(d,m,Be,C,b,null)}return;default:if(uw(m)){for(tt in b)b.hasOwnProperty(tt)&&(C=b[tt],C!==void 0&&HS(d,m,tt,C,b,void 0));return}}for(ee in b)b.hasOwnProperty(ee)&&(C=b[ee],C!=null&&Zn(d,m,ee,C,b,null))}function wX(d,m,b,C){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,R=null,j=null,ee=null,pe=null,Be=null,tt=null;for(je in b){var st=b[je];if(b.hasOwnProperty(je)&&st!=null)switch(je){case"checked":break;case"value":break;case"defaultValue":pe=st;default:C.hasOwnProperty(je)||Zn(d,m,je,null,C,st)}}for(var ze in C){var je=C[ze];if(st=b[ze],C.hasOwnProperty(ze)&&(je!=null||st!=null))switch(ze){case"type":R=je;break;case"name":T=je;break;case"checked":Be=je;break;case"defaultChecked":tt=je;break;case"value":j=je;break;case"defaultValue":ee=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(s(137,m));break;default:je!==st&&Zn(d,m,ze,je,C,st)}}aw(d,j,ee,pe,Be,tt,R,T);return;case"select":je=j=ee=ze=null;for(R in b)if(pe=b[R],b.hasOwnProperty(R)&&pe!=null)switch(R){case"value":break;case"multiple":je=pe;default:C.hasOwnProperty(R)||Zn(d,m,R,null,C,pe)}for(T in C)if(R=C[T],pe=b[T],C.hasOwnProperty(T)&&(R!=null||pe!=null))switch(T){case"value":ze=R;break;case"defaultValue":ee=R;break;case"multiple":j=R;default:R!==pe&&Zn(d,m,T,R,C,pe)}m=ee,b=j,C=je,ze!=null?Ph(d,!!b,ze,!1):!!C!=!!b&&(m!=null?Ph(d,!!b,m,!0):Ph(d,!!b,b?[]:"",!1));return;case"textarea":je=ze=null;for(ee in b)if(T=b[ee],b.hasOwnProperty(ee)&&T!=null&&!C.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:Zn(d,m,ee,null,C,T)}for(j in C)if(T=C[j],R=b[j],C.hasOwnProperty(j)&&(T!=null||R!=null))switch(j){case"value":ze=T;break;case"defaultValue":je=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:T!==R&&Zn(d,m,j,T,C,R)}$A(d,ze,je);return;case"option":for(var Xt in b)if(ze=b[Xt],b.hasOwnProperty(Xt)&&ze!=null&&!C.hasOwnProperty(Xt))switch(Xt){case"selected":d.selected=!1;break;default:Zn(d,m,Xt,null,C,ze)}for(pe in C)if(ze=C[pe],je=b[pe],C.hasOwnProperty(pe)&&ze!==je&&(ze!=null||je!=null))switch(pe){case"selected":d.selected=ze&&typeof ze!="function"&&typeof ze!="symbol";break;default:Zn(d,m,pe,ze,C,je)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var jt in b)ze=b[jt],b.hasOwnProperty(jt)&&ze!=null&&!C.hasOwnProperty(jt)&&Zn(d,m,jt,null,C,ze);for(Be in C)if(ze=C[Be],je=b[Be],C.hasOwnProperty(Be)&&ze!==je&&(ze!=null||je!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(s(137,m));break;default:Zn(d,m,Be,ze,C,je)}return;default:if(uw(m)){for(var Qn in b)ze=b[Qn],b.hasOwnProperty(Qn)&&ze!==void 0&&!C.hasOwnProperty(Qn)&&HS(d,m,Qn,void 0,C,ze);for(tt in C)ze=C[tt],je=b[tt],!C.hasOwnProperty(tt)||ze===je||ze===void 0&&je===void 0||HS(d,m,tt,ze,C,je);return}}for(var Ae in b)ze=b[Ae],b.hasOwnProperty(Ae)&&ze!=null&&!C.hasOwnProperty(Ae)&&Zn(d,m,Ae,null,C,ze);for(st in C)ze=C[st],je=b[st],!C.hasOwnProperty(st)||ze===je||ze==null&&je==null||Zn(d,m,st,ze,C,je)}var qS=null,KS=null;function ry(d){return d.nodeType===9?d:d.ownerDocument}function O$(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function M$(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function XS(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var YS=null;function SX(){var d=window.event;return d&&d.type==="popstate"?d===YS?!1:(YS=d,!0):(YS=null,!1)}var L$=typeof setTimeout=="function"?setTimeout:void 0,CX=typeof clearTimeout=="function"?clearTimeout:void 0,B$=typeof Promise=="function"?Promise:void 0,_X=typeof queueMicrotask=="function"?queueMicrotask:typeof B$<"u"?function(d){return B$.resolve(null).then(d).catch(EX)}:L$;function EX(d){setTimeout(function(){throw d})}function Yu(d){return d==="head"}function P$(d,m){var b=m,C=0,T=0;do{var R=b.nextSibling;if(d.removeChild(b),R&&R.nodeType===8)if(b=R.data,b==="/$"){if(0<C&&8>C){b=C;var j=d.ownerDocument;if(b&1&&qp(j.documentElement),b&2&&qp(j.body),b&4)for(b=j.head,qp(b),j=b.firstChild;j;){var ee=j.nextSibling,pe=j.nodeName;j[oo]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&j.rel.toLowerCase()==="stylesheet"||b.removeChild(j),j=ee}}if(T===0){d.removeChild(R),tm(m);return}T--}else b==="$"||b==="$?"||b==="$!"?T++:C=b.charCodeAt(0)-48;else C=0;b=R}while(b);tm(m)}function ZS(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var b=m;switch(m=m.nextSibling,b.nodeName){case"HTML":case"HEAD":case"BODY":ZS(b),Rh(b);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(b.rel.toLowerCase()==="stylesheet")continue}d.removeChild(b)}}function DX(d,m,b,C){for(;d.nodeType===1;){var T=b;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!C&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(C){if(!d[oo])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(R=d.getAttribute("rel"),R==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(R!==T.rel||d.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||d.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||d.getAttribute("title")!==(T.title==null?null:T.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(R=d.getAttribute("src"),(R!==(T.src==null?null:T.src)||d.getAttribute("type")!==(T.type==null?null:T.type)||d.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&R&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var R=T.name==null?null:""+T.name;if(T.type==="hidden"&&d.getAttribute("name")===R)return d}else return d;if(d=Va(d.nextSibling),d===null)break}return null}function TX(d,m,b){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!b||(d=Va(d.nextSibling),d===null))return null;return d}function QS(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function NX(d,m){var b=d.ownerDocument;if(d.data!=="$?"||b.readyState==="complete")m();else{var C=function(){m(),b.removeEventListener("DOMContentLoaded",C)};b.addEventListener("DOMContentLoaded",C),d._reactRetry=C}}function Va(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="F!"||m==="F")break;if(m==="/$")return null}}return d}var JS=null;function V$(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var b=d.data;if(b==="$"||b==="$!"||b==="$?"){if(m===0)return d;m--}else b==="/$"&&m++}d=d.previousSibling}return null}function z$(d,m,b){switch(m=ry(b),d){case"html":if(d=m.documentElement,!d)throw Error(s(452));return d;case"head":if(d=m.head,!d)throw Error(s(453));return d;case"body":if(d=m.body,!d)throw Error(s(454));return d;default:throw Error(s(451))}}function qp(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);Rh(d)}var ha=new Map,U$=new Set;function sy(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var ru=Z.d;Z.d={f:kX,r:AX,D:IX,C:$X,L:FX,m:RX,X:MX,S:OX,M:LX};function kX(){var d=ru.f(),m=X1();return d||m}function AX(d){var m=Oh(d);m!==null&&m.tag===5&&m.type==="form"?o5(m):ru.r(d)}var gf=typeof document>"u"?null:document;function G$(d,m,b){var C=gf;if(C&&typeof m=="string"&&m){var T=sa(m);T='link[rel="'+d+'"][href="'+T+'"]',typeof b=="string"&&(T+='[crossorigin="'+b+'"]'),U$.has(T)||(U$.add(T),d={rel:d,crossOrigin:b,href:m},C.querySelector(T)===null&&(m=C.createElement("link"),Ps(m,"link",d),Ss(m),C.head.appendChild(m)))}}function IX(d){ru.D(d),G$("dns-prefetch",d,null)}function $X(d,m){ru.C(d,m),G$("preconnect",d,m)}function FX(d,m,b){ru.L(d,m,b);var C=gf;if(C&&d&&m){var T='link[rel="preload"][as="'+sa(m)+'"]';m==="image"&&b&&b.imageSrcSet?(T+='[imagesrcset="'+sa(b.imageSrcSet)+'"]',typeof b.imageSizes=="string"&&(T+='[imagesizes="'+sa(b.imageSizes)+'"]')):T+='[href="'+sa(d)+'"]';var R=T;switch(m){case"style":R=yf(d);break;case"script":R=xf(d)}ha.has(R)||(d=h({rel:"preload",href:m==="image"&&b&&b.imageSrcSet?void 0:d,as:m},b),ha.set(R,d),C.querySelector(T)!==null||m==="style"&&C.querySelector(Kp(R))||m==="script"&&C.querySelector(Xp(R))||(m=C.createElement("link"),Ps(m,"link",d),Ss(m),C.head.appendChild(m)))}}function RX(d,m){ru.m(d,m);var b=gf;if(b&&d){var C=m&&typeof m.as=="string"?m.as:"script",T='link[rel="modulepreload"][as="'+sa(C)+'"][href="'+sa(d)+'"]',R=T;switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=xf(d)}if(!ha.has(R)&&(d=h({rel:"modulepreload",href:d},m),ha.set(R,d),b.querySelector(T)===null)){switch(C){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(b.querySelector(Xp(R)))return}C=b.createElement("link"),Ps(C,"link",d),Ss(C),b.head.appendChild(C)}}}function OX(d,m,b){ru.S(d,m,b);var C=gf;if(C&&d){var T=Mh(C).hoistableStyles,R=yf(d);m=m||"default";var j=T.get(R);if(!j){var ee={loading:0,preload:null};if(j=C.querySelector(Kp(R)))ee.loading=5;else{d=h({rel:"stylesheet",href:d,"data-precedence":m},b),(b=ha.get(R))&&eC(d,b);var pe=j=C.createElement("link");Ss(pe),Ps(pe,"link",d),pe._p=new Promise(function(Be,tt){pe.onload=Be,pe.onerror=tt}),pe.addEventListener("load",function(){ee.loading|=1}),pe.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,iy(j,m,C)}j={type:"stylesheet",instance:j,count:1,state:ee},T.set(R,j)}}}function MX(d,m){ru.X(d,m);var b=gf;if(b&&d){var C=Mh(b).hoistableScripts,T=xf(d),R=C.get(T);R||(R=b.querySelector(Xp(T)),R||(d=h({src:d,async:!0},m),(m=ha.get(T))&&tC(d,m),R=b.createElement("script"),Ss(R),Ps(R,"link",d),b.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},C.set(T,R))}}function LX(d,m){ru.M(d,m);var b=gf;if(b&&d){var C=Mh(b).hoistableScripts,T=xf(d),R=C.get(T);R||(R=b.querySelector(Xp(T)),R||(d=h({src:d,async:!0,type:"module"},m),(m=ha.get(T))&&tC(d,m),R=b.createElement("script"),Ss(R),Ps(R,"link",d),b.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},C.set(T,R))}}function j$(d,m,b,C){var T=(T=de.current)?sy(T):null;if(!T)throw Error(s(446));switch(d){case"meta":case"title":return null;case"style":return typeof b.precedence=="string"&&typeof b.href=="string"?(m=yf(b.href),b=Mh(T).hoistableStyles,C=b.get(m),C||(C={type:"style",instance:null,count:0,state:null},b.set(m,C)),C):{type:"void",instance:null,count:0,state:null};case"link":if(b.rel==="stylesheet"&&typeof b.href=="string"&&typeof b.precedence=="string"){d=yf(b.href);var R=Mh(T).hoistableStyles,j=R.get(d);if(j||(T=T.ownerDocument||T,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(d,j),(R=T.querySelector(Kp(d)))&&!R._p&&(j.instance=R,j.state.loading=5),ha.has(d)||(b={rel:"preload",as:"style",href:b.href,crossOrigin:b.crossOrigin,integrity:b.integrity,media:b.media,hrefLang:b.hrefLang,referrerPolicy:b.referrerPolicy},ha.set(d,b),R||BX(T,d,b,j.state))),m&&C===null)throw Error(s(528,""));return j}if(m&&C!==null)throw Error(s(529,""));return null;case"script":return m=b.async,b=b.src,typeof b=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=xf(b),b=Mh(T).hoistableScripts,C=b.get(m),C||(C={type:"script",instance:null,count:0,state:null},b.set(m,C)),C):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,d))}}function yf(d){return'href="'+sa(d)+'"'}function Kp(d){return'link[rel="stylesheet"]['+d+"]"}function W$(d){return h({},d,{"data-precedence":d.precedence,precedence:null})}function BX(d,m,b,C){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?C.loading=1:(m=d.createElement("link"),C.preload=m,m.addEventListener("load",function(){return C.loading|=1}),m.addEventListener("error",function(){return C.loading|=2}),Ps(m,"link",b),Ss(m),d.head.appendChild(m))}function xf(d){return'[src="'+sa(d)+'"]'}function Xp(d){return"script[async]"+d}function H$(d,m,b){if(m.count++,m.instance===null)switch(m.type){case"style":var C=d.querySelector('style[data-href~="'+sa(b.href)+'"]');if(C)return m.instance=C,Ss(C),C;var T=h({},b,{"data-href":b.href,"data-precedence":b.precedence,href:null,precedence:null});return C=(d.ownerDocument||d).createElement("style"),Ss(C),Ps(C,"style",T),iy(C,b.precedence,d),m.instance=C;case"stylesheet":T=yf(b.href);var R=d.querySelector(Kp(T));if(R)return m.state.loading|=4,m.instance=R,Ss(R),R;C=W$(b),(T=ha.get(T))&&eC(C,T),R=(d.ownerDocument||d).createElement("link"),Ss(R);var j=R;return j._p=new Promise(function(ee,pe){j.onload=ee,j.onerror=pe}),Ps(R,"link",C),m.state.loading|=4,iy(R,b.precedence,d),m.instance=R;case"script":return R=xf(b.src),(T=d.querySelector(Xp(R)))?(m.instance=T,Ss(T),T):(C=b,(T=ha.get(R))&&(C=h({},b),tC(C,T)),d=d.ownerDocument||d,T=d.createElement("script"),Ss(T),Ps(T,"link",C),d.head.appendChild(T),m.instance=T);case"void":return null;default:throw Error(s(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(C=m.instance,m.state.loading|=4,iy(C,b.precedence,d));return m.instance}function iy(d,m,b){for(var C=b.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=C.length?C[C.length-1]:null,R=T,j=0;j<C.length;j++){var ee=C[j];if(ee.dataset.precedence===m)R=ee;else if(R!==T)break}R?R.parentNode.insertBefore(d,R.nextSibling):(m=b.nodeType===9?b.head:b,m.insertBefore(d,m.firstChild))}function eC(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function tC(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var ay=null;function q$(d,m,b){if(ay===null){var C=new Map,T=ay=new Map;T.set(b,C)}else T=ay,C=T.get(b),C||(C=new Map,T.set(b,C));if(C.has(d))return C;for(C.set(d,null),b=b.getElementsByTagName(d),T=0;T<b.length;T++){var R=b[T];if(!(R[oo]||R[Ze]||d==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var j=R.getAttribute(m)||"";j=d+j;var ee=C.get(j);ee?ee.push(R):C.set(j,[R])}}return C}function K$(d,m,b){d=d.ownerDocument||d,d.head.insertBefore(b,m==="title"?d.querySelector("head > title"):null)}function PX(d,m,b){if(b===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function X$(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Yp=null;function VX(){}function zX(d,m,b){if(Yp===null)throw Error(s(475));var C=Yp;if(m.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var T=yf(b.href),R=d.querySelector(Kp(T));if(R){d=R._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(C.count++,C=oy.bind(C),d.then(C,C)),m.state.loading|=4,m.instance=R,Ss(R);return}R=d.ownerDocument||d,b=W$(b),(T=ha.get(T))&&eC(b,T),R=R.createElement("link"),Ss(R);var j=R;j._p=new Promise(function(ee,pe){j.onload=ee,j.onerror=pe}),Ps(R,"link",b),m.instance=R}C.stylesheets===null&&(C.stylesheets=new Map),C.stylesheets.set(m,d),(d=m.state.preload)&&(m.state.loading&3)===0&&(C.count++,m=oy.bind(C),d.addEventListener("load",m),d.addEventListener("error",m))}}function UX(){if(Yp===null)throw Error(s(475));var d=Yp;return d.stylesheets&&d.count===0&&nC(d,d.stylesheets),0<d.count?function(m){var b=setTimeout(function(){if(d.stylesheets&&nC(d,d.stylesheets),d.unsuspend){var C=d.unsuspend;d.unsuspend=null,C()}},6e4);return d.unsuspend=m,function(){d.unsuspend=null,clearTimeout(b)}}:null}function oy(){if(this.count--,this.count===0){if(this.stylesheets)nC(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var uy=null;function nC(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,uy=new Map,m.forEach(GX,d),uy=null,oy.call(d))}function GX(d,m){if(!(m.state.loading&4)){var b=uy.get(d);if(b)var C=b.get(null);else{b=new Map,uy.set(d,b);for(var T=d.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<T.length;R++){var j=T[R];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(b.set(j.dataset.precedence,j),C=j)}C&&b.set(null,C)}T=m.instance,j=T.getAttribute("data-precedence"),R=b.get(j)||C,R===C&&b.set(null,T),b.set(j,T),this.count++,C=oy.bind(this),T.addEventListener("load",C),T.addEventListener("error",C),R?R.parentNode.insertBefore(T,R.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(T,d.firstChild)),m.state.loading|=4}}var Zp={$$typeof:E,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function jX(d,m,b,C,T,R,j,ee){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.hiddenUpdates=gt(null),this.identifierPrefix=C,this.onUncaughtError=T,this.onCaughtError=R,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function Y$(d,m,b,C,T,R,j,ee,pe,Be,tt,st){return d=new jX(d,m,b,j,ee,pe,Be,st),m=1,R===!0&&(m|=24),R=Bi(3,null,null,m),d.current=R,R.stateNode=d,m=Lw(),m.refCount++,d.pooledCache=m,m.refCount++,R.memoizedState={element:C,isDehydrated:b,cache:m},zw(R),d}function Z$(d){return d?(d=Kh,d):Kh}function Q$(d,m,b,C,T,R){T=Z$(T),C.context===null?C.context=T:C.pendingContext=T,C=Lu(m),C.payload={element:b},R=R===void 0?null:R,R!==null&&(C.callback=R),b=Bu(d,C,m),b!==null&&(Gi(b,d,m),Tp(b,d,m))}function J$(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var b=d.retryLane;d.retryLane=b!==0&&b<m?b:m}}function rC(d,m){J$(d,m),(d=d.alternate)&&J$(d,m)}function e4(d){if(d.tag===13){var m=qh(d,67108864);m!==null&&Gi(m,d,67108864),rC(d,67108864)}}var ly=!0;function WX(d,m,b,C){var T=V.T;V.T=null;var R=Z.p;try{Z.p=2,sC(d,m,b,C)}finally{Z.p=R,V.T=T}}function HX(d,m,b,C){var T=V.T;V.T=null;var R=Z.p;try{Z.p=8,sC(d,m,b,C)}finally{Z.p=R,V.T=T}}function sC(d,m,b,C){if(ly){var T=iC(C);if(T===null)WS(d,m,C,cy,b),n4(d,C);else if(KX(T,d,m,b,C))C.stopPropagation();else if(n4(d,C),m&4&&-1<qX.indexOf(d)){for(;T!==null;){var R=Oh(T);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var j=K(R.pendingLanes);if(j!==0){var ee=R;for(ee.pendingLanes|=2,ee.entangledLanes|=2;j;){var pe=1<<31-St(j);ee.entanglements[1]|=pe,j&=~pe}fo(R),(Kn&6)===0&&(q1=ce()+500,jp(0))}}break;case 13:ee=qh(R,2),ee!==null&&Gi(ee,R,2),X1(),rC(R,2)}if(R=iC(C),R===null&&WS(d,m,C,cy,b),R===T)break;T=R}T!==null&&C.stopPropagation()}else WS(d,m,C,null,b)}}function iC(d){return d=cw(d),aC(d)}var cy=null;function aC(d){if(cy=null,d=Ms(d),d!==null){var m=a(d);if(m===null)d=null;else{var b=m.tag;if(b===13){if(d=o(m),d!==null)return d;d=null}else if(b===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return cy=d,null}function t4(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xe()){case Ge:return 2;case Oe:return 8;case lt:case ot:return 32;case bt:return 268435456;default:return 32}default:return 32}}var oC=!1,Zu=null,Qu=null,Ju=null,Qp=new Map,Jp=new Map,el=[],qX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function n4(d,m){switch(d){case"focusin":case"focusout":Zu=null;break;case"dragenter":case"dragleave":Qu=null;break;case"mouseover":case"mouseout":Ju=null;break;case"pointerover":case"pointerout":Qp.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jp.delete(m.pointerId)}}function em(d,m,b,C,T,R){return d===null||d.nativeEvent!==R?(d={blockedOn:m,domEventName:b,eventSystemFlags:C,nativeEvent:R,targetContainers:[T]},m!==null&&(m=Oh(m),m!==null&&e4(m)),d):(d.eventSystemFlags|=C,m=d.targetContainers,T!==null&&m.indexOf(T)===-1&&m.push(T),d)}function KX(d,m,b,C,T){switch(m){case"focusin":return Zu=em(Zu,d,m,b,C,T),!0;case"dragenter":return Qu=em(Qu,d,m,b,C,T),!0;case"mouseover":return Ju=em(Ju,d,m,b,C,T),!0;case"pointerover":var R=T.pointerId;return Qp.set(R,em(Qp.get(R)||null,d,m,b,C,T)),!0;case"gotpointercapture":return R=T.pointerId,Jp.set(R,em(Jp.get(R)||null,d,m,b,C,T)),!0}return!1}function r4(d){var m=Ms(d.target);if(m!==null){var b=a(m);if(b!==null){if(m=b.tag,m===13){if(m=o(b),m!==null){d.blockedOn=m,ae(d.priority,function(){if(b.tag===13){var C=Ui();C=q(C);var T=qh(b,C);T!==null&&Gi(T,b,C),rC(b,C)}});return}}else if(m===3&&b.stateNode.current.memoizedState.isDehydrated){d.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}d.blockedOn=null}function hy(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var b=iC(d.nativeEvent);if(b===null){b=d.nativeEvent;var C=new b.constructor(b.type,b);lw=C,b.target.dispatchEvent(C),lw=null}else return m=Oh(b),m!==null&&e4(m),d.blockedOn=b,!1;m.shift()}return!0}function s4(d,m,b){hy(d)&&b.delete(m)}function XX(){oC=!1,Zu!==null&&hy(Zu)&&(Zu=null),Qu!==null&&hy(Qu)&&(Qu=null),Ju!==null&&hy(Ju)&&(Ju=null),Qp.forEach(s4),Jp.forEach(s4)}function fy(d,m){d.blockedOn===m&&(d.blockedOn=null,oC||(oC=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,XX)))}var dy=null;function i4(d){dy!==d&&(dy=d,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){dy===d&&(dy=null);for(var m=0;m<d.length;m+=3){var b=d[m],C=d[m+1],T=d[m+2];if(typeof C!="function"){if(aC(C||b)===null)continue;break}var R=Oh(b);R!==null&&(d.splice(m,3),m-=3,aS(R,{pending:!0,data:T,method:b.method,action:C},C,T))}}))}function tm(d){function m(pe){return fy(pe,d)}Zu!==null&&fy(Zu,d),Qu!==null&&fy(Qu,d),Ju!==null&&fy(Ju,d),Qp.forEach(m),Jp.forEach(m);for(var b=0;b<el.length;b++){var C=el[b];C.blockedOn===d&&(C.blockedOn=null)}for(;0<el.length&&(b=el[0],b.blockedOn===null);)r4(b),b.blockedOn===null&&el.shift();if(b=(d.ownerDocument||d).$$reactFormReplay,b!=null)for(C=0;C<b.length;C+=3){var T=b[C],R=b[C+1],j=T[Qe]||null;if(typeof R=="function")j||i4(b);else if(j){var ee=null;if(R&&R.hasAttribute("formAction")){if(T=R,j=R[Qe]||null)ee=j.formAction;else if(aC(T)!==null)continue}else ee=j.action;typeof ee=="function"?b[C+1]=ee:(b.splice(C,3),C-=3),i4(b)}}}function uC(d){this._internalRoot=d}py.prototype.render=uC.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(s(409));var b=m.current,C=Ui();Q$(b,C,d,m,null,null)},py.prototype.unmount=uC.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;Q$(d.current,2,null,d,null,null),X1(),m[ct]=null}};function py(d){this._internalRoot=d}py.prototype.unstable_scheduleHydration=function(d){if(d){var m=H();d={blockedOn:null,target:d,priority:m};for(var b=0;b<el.length&&m!==0&&m<el[b].priority;b++);el.splice(b,0,d),b===0&&r4(d)}};var a4=t.version;if(a4!=="19.1.0")throw Error(s(527,a4,"19.1.0"));Z.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=l(m),d=d!==null?c(d):null,d=d===null?null:d.stateNode,d};var YX={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var my=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!my.isDisabled&&my.supportsFiber)try{It=my.inject(YX),ut=my}catch{}}return rm.createRoot=function(d,m){if(!i(d))throw Error(s(299));var b=!1,C="",T=S5,R=C5,j=_5,ee=null;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(C=m.identifierPrefix),m.onUncaughtError!==void 0&&(T=m.onUncaughtError),m.onCaughtError!==void 0&&(R=m.onCaughtError),m.onRecoverableError!==void 0&&(j=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(ee=m.unstable_transitionCallbacks)),m=Y$(d,1,!1,null,null,b,C,T,R,j,ee,null),d[ct]=m.current,jS(d),new uC(m)},rm.hydrateRoot=function(d,m,b){if(!i(d))throw Error(s(299));var C=!1,T="",R=S5,j=C5,ee=_5,pe=null,Be=null;return b!=null&&(b.unstable_strictMode===!0&&(C=!0),b.identifierPrefix!==void 0&&(T=b.identifierPrefix),b.onUncaughtError!==void 0&&(R=b.onUncaughtError),b.onCaughtError!==void 0&&(j=b.onCaughtError),b.onRecoverableError!==void 0&&(ee=b.onRecoverableError),b.unstable_transitionCallbacks!==void 0&&(pe=b.unstable_transitionCallbacks),b.formState!==void 0&&(Be=b.formState)),m=Y$(d,1,!0,m,b??null,C,T,R,j,ee,pe,Be),m.context=Z$(null),b=m.current,C=Ui(),C=q(C),T=Lu(C),T.callback=null,Bu(b,T,C),b=C,m.current.lanes=b,Ft(m,b),fo(m),d[ct]=m.current,jS(d),new py(m)},rm.version="19.1.0",rm}var y4;function hY(){if(y4)return fC.exports;y4=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),fC.exports=cY(),fC.exports}var fY=hY();const vh=Math.PI,QL="2.0.2",jc="p2d",dY="p2d-hdr",Nl="webgl",Qr="webgl2",JL="default",F_="simple",R_="full",e6="crosshair",t6="pointer",n6="move",r6="text",s6="wait",bc=vh/2,O_=vh,pY=vh/4,mY=vh*2,ai=vh*2,vc=vh/180,wc=180/vh,Yi="corner",Pm="corners",Vm="radius",Cx="right",i6="left",Ti="center",gY="top",M_="bottom",a6="alphabetic",_x=0,sd=1,yY=3,xY=2,zf=4,Wb=6,zm=5,Nm="quads",Um="quad_strip",bY="tess",Uf=7,Ja=8,Gm="close",Wc="open",Ex="chord",jm="pie",GD="square",jD="butt",vl="round",WD="bevel",HD="miter",o6="auto",vY="Alt",wY="Backspace",SY="Control",CY="Delete",_Y="ArrowDown",EY="Enter",DY="Escape",TY="ArrowLeft",NY="Alt",kY="Enter",AY="ArrowRight",IY="Shift",$Y="Tab",FY="ArrowUp",ci="source-over",Hc="destination-out",Wm="lighter",Hb="darken",qb="lighten",u6="difference",Kb="subtract",Xb="exclusion",Yb="multiply",Zb="screen",Qb="copy",qD="overlay",KD="hard-light",XD="soft-light",YD="color-dodge",ZD="color-burn",Jb="threshold",QD="gray",JD="opaque",eT="invert",ev="posterize",tT="dilate",nT="erode",id="blur",wo="normal",RY="italic",OY="bold",MY="bold italic",LY="CHAR",l6="WORD",BY="#000000",PY=1.25,VY="middle",L_="linear",zY="quadratic",UY="bezier",GY="curve",jY="stroke",Dx="fill",Tx="texture",WY="immediate",tv="image",c6="nearest",B_="repeat",P_="clamp",V_="mirror",h6="flat",f6="smooth",HY="landscape",qY="portrait",d6="#000000",p6="#FFFFFF",m6="grid",g6="axes",KY="label",XY="fallback",y6="contain",x6="cover",ul="unsigned-byte",km="unsigned-int",Ci="float",kf="half-float",Gf=Symbol("include"),Mf=Symbol("exclude"),z_=Symbol("join");var qc=Object.freeze({__proto__:null,ADD:Wm,ALT:vY,ARROW:JL,AUTO:o6,AXES:g6,BACKSPACE:wY,BASELINE:a6,BEVEL:WD,BEZIER:UY,BLEND:ci,BLUR:id,BOLD:OY,BOLDITALIC:MY,BOTTOM:M_,BURN:ZD,CENTER:Ti,CHAR:LY,CHORD:Ex,CLAMP:P_,CLOSE:Gm,CONTAIN:y6,CONTROL:SY,CORNER:Yi,CORNERS:Pm,COVER:x6,CROSS:e6,CURVE:GY,DARKEST:Hb,DEG_TO_RAD:vc,DELETE:CY,DIFFERENCE:u6,DILATE:tT,DODGE:YD,DOWN_ARROW:_Y,EMPTY_PATH:Uf,ENTER:EY,ERODE:nT,ESCAPE:DY,EXCLUDE:Mf,EXCLUSION:Xb,FALLBACK:XY,FILL:Dx,FLAT:h6,FLOAT:Ci,FULL:R_,GRAY:QD,GRID:m6,HALF_FLOAT:kf,HALF_PI:bc,HAND:t6,HARD_LIGHT:KD,IMAGE:tv,IMMEDIATE:WY,INCLUDE:Gf,INVERT:eT,ITALIC:RY,JOIN:z_,LABEL:KY,LANDSCAPE:HY,LEFT:i6,LEFT_ARROW:TY,LIGHTEST:qb,LINEAR:L_,LINES:sd,LINE_LOOP:xY,LINE_STRIP:yY,MIRROR:V_,MITER:HD,MOVE:n6,MULTIPLY:Yb,NEAREST:c6,NORMAL:wo,OPAQUE:JD,OPEN:Wc,OPTION:NY,OVERLAY:qD,P2D:jc,P2DHDR:dY,PATH:Ja,PI:O_,PIE:jm,POINTS:_x,PORTRAIT:qY,POSTERIZE:ev,PROJECT:GD,QUADRATIC:zY,QUADS:Nm,QUAD_STRIP:Um,QUARTER_PI:pY,RADIUS:Vm,RAD_TO_DEG:wc,REMOVE:Hc,REPEAT:B_,REPLACE:Qb,RETURN:kY,RIGHT:Cx,RIGHT_ARROW:AY,ROUND:vl,SCREEN:Zb,SHIFT:IY,SIMPLE:F_,SMOOTH:f6,SOFT_LIGHT:XD,SQUARE:jD,STROKE:jY,SUBTRACT:Kb,TAB:$Y,TAU:mY,TESS:bY,TEXT:r6,TEXTURE:Tx,THRESHOLD:Jb,TOP:gY,TRIANGLES:zf,TRIANGLE_FAN:Wb,TRIANGLE_STRIP:zm,TWO_PI:ai,UNSIGNED_BYTE:ul,UNSIGNED_INT:km,UP_ARROW:FY,VERSION:QL,WAIT:s6,WEBGL:Nl,WEBGL2:Qr,WORD:l6,_CTX_MIDDLE:VY,_DEFAULT_FILL:p6,_DEFAULT_LEADMULT:PY,_DEFAULT_STROKE:d6,_DEFAULT_TEXT_FILL:BY});function rT(r,t){t.applyMatrix=function(...n){let s=n[0]instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(n[0])||s?this._renderer.applyMatrix(...n[0]):this._renderer.applyMatrix(...n),this},t.resetMatrix=function(){return this._renderer.resetMatrix(),this},t.rotate=function(n,s){return this._renderer.rotate(this._toRadians(n),s),this},t.rotateX=function(n){return this._assert3d("rotateX"),this._renderer.rotateX(this._toRadians(n)),this},t.rotateY=function(n){return this._assert3d("rotateY"),this._renderer.rotateY(this._toRadians(n)),this},t.rotateZ=function(n){return this._assert3d("rotateZ"),this._renderer.rotateZ(this._toRadians(n)),this},t.scale=function(n,s,i){if(n instanceof r.Vector){const a=n;n=a.x,s=a.y,i=a.z}else if(Array.isArray(n)){const a=n;n=a[0],s=a[1],i=a[2]||1}return isNaN(s)?s=i=n:isNaN(i)&&(i=1),this._renderer.scale(n,s,i),this},t.shearX=function(n){const s=this._toRadians(n);return this._renderer.applyMatrix(1,0,Math.tan(s),1,0,0),this},t.shearY=function(n){const s=this._toRadians(n);return this._renderer.applyMatrix(1,Math.tan(s),0,1,0,0),this},t.translate=function(n,s,i){return this._renderer.isP3D?this._renderer.translate(n,s,i):this._renderer.translate(n,s),this},t.push=function(){this._renderer.push()},t.pop=function(){this._renderer.pop()}}typeof p5<"u"&&rT(p5,p5.prototype);function b6(r,t){t.noLoop=function(){this._loop=!1},t.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},t.isLooping=function(){return this._loop},t.redraw=async function(n){if(this._inUserDraw||!this._setupDone)return;let s=parseInt(n);(isNaN(s)||s<1)&&(s=1);const i=this._isGlobal?window:this;if(typeof i.draw=="function"){typeof i.setup>"u"&&i.scale(i._pixelDensity,i._pixelDensity);for(let a=0;a<s;a++){i.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),this._renderer.isP3D&&this._renderer._update(),this.frameCount=i.frameCount+1,await this._runLifecycleHook("predraw"),this._inUserDraw=!0;try{await i.draw()}finally{this._inUserDraw=!1}await this._runLifecycleHook("postdraw")}}}}typeof p5<"u"&&b6(p5,p5.prototype);const x4=function(r,t){return r!==0&&(this.x=this.x%r),t!==0&&(this.y=this.y%t),this},gC=function(r,t,n){return r!==0&&(this.x=this.x%r),t!==0&&(this.y=this.y%t),n!==0&&(this.z=this.z%n),this};class Ee{constructor(...t){let n=t.map(i=>i||0);typeof t[0]=="function"&&(this.isPInst=!0,this._fromRadians=t[0],this._toRadians=t[1],n=t.slice(2).map(i=>i||0));let s=n.length;s===0?(this.dimensions=2,this._values=[0,0,0]):(this.dimensions=s,this._values=n)}get values(){return this._values}set values(t){let n=t.length;n===0?(this.dimensions=2,this._values=[0,0,0]):(this.dimensions=n,this._values=t.slice())}get x(){return this._values[0]||0}getValue(t){if(t<this._values.length)return this._values[t];p5._friendlyError("The index parameter is trying to set a value outside the bounds of the vector","p5.Vector.setValue")}setValue(t,n){t<this._values.length?this._values[t]=n:p5._friendlyError("The index parameter is trying to set a value outside the bounds of the vector","p5.Vector.setValue")}get y(){return this._values[1]||0}get z(){return this._values[2]||0}get w(){return this._values[3]||0}set x(t){this._values.length>1&&(this._values[0]=t)}set y(t){this._values.length>1&&(this._values[1]=t)}set z(t){this._values.length>2&&(this._values[2]=t)}set w(t){this._values.length>3&&(this._values[3]=t)}toString(){return`[${this.values.join(", ")}]`}set(...t){return t[0]instanceof Ee?this.values=t[0].values.slice():Array.isArray(t[0])?this.values=t[0].map(n=>n||0):this.values=t.map(n=>n||0),this.dimensions=this.values.length,this}copy(){return this.isPInst?new Ee(this._fromRadians,this._toRadians,...this.values):new Ee(...this.values)}add(...t){return t[0]instanceof Ee?t=t[0].values:Array.isArray(t[0])&&(t=t[0]),t.forEach((n,s)=>{this.values[s]=(this.values[s]||0)+(n||0)}),this}rem(t,n,s){if(t instanceof Ee){if([t.x,t.y,t.z].every(Number.isFinite)){const i=parseFloat(t.x),a=parseFloat(t.y),o=parseFloat(t.z);return gC.call(this,i,a,o)}}else if(Array.isArray(t)){if(t.every(i=>Number.isFinite(i))){if(t.length===2)return x4.call(this,t[0],t[1]);if(t.length===3)return gC.call(this,t[0],t[1],t[2])}}else if(arguments.length===1){if(Number.isFinite(arguments[0])&&arguments[0]!==0)return this.x=this.x%arguments[0],this.y=this.y%arguments[0],this.z=this.z%arguments[0],this}else if(arguments.length===2){const i=[...arguments];if(i.every(a=>Number.isFinite(a))&&i.length===2)return x4.call(this,i[0],i[1])}else if(arguments.length===3){const i=[...arguments];if(i.every(a=>Number.isFinite(a))&&i.length===3)return gC.call(this,i[0],i[1],i[2])}}sub(...t){return t[0]instanceof Ee?t[0].values.forEach((n,s)=>{this.values[s]-=n||0}):Array.isArray(t[0])?t[0].forEach((n,s)=>{this.values[s]-=n||0}):t.forEach((n,s)=>{this.values[s]-=n||0}),this}mult(...t){if(t.length===1&&t[0]instanceof Ee){const n=t[0],s=Math.min(this.values.length,n.values.length);for(let i=0;i<s;i++)if(Number.isFinite(n.values[i])&&typeof n.values[i]=="number")this._values[i]*=n.values[i];else return console.warn("p5.Vector.prototype.mult:","v contains components that are either undefined or not finite numbers"),this}else if(t.length===1&&Array.isArray(t[0])){const n=t[0],s=Math.min(this.values.length,n.length);for(let i=0;i<s;i++)if(Number.isFinite(n[i])&&typeof n[i]=="number")this._values[i]*=n[i];else return console.warn("p5.Vector.prototype.mult:","arr contains elements that are either undefined or not finite numbers"),this}else if(t.length===1&&typeof t[0]=="number"&&Number.isFinite(t[0]))for(let n=0;n<this._values.length;n++)this._values[n]*=t[0];return this}div(...t){if(t.length===0)return this;if(t.length===1&&t[0]instanceof Ee){const n=t[0];if(n._values.every(s=>Number.isFinite(s)&&typeof s=="number")){if(n._values.some(s=>s===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((s,i)=>s/n._values[i])}else console.warn("p5.Vector.prototype.div:","vector contains components that are either undefined or not finite numbers");return this}if(t.length===1&&Array.isArray(t[0])){const n=t[0];if(n.every(s=>Number.isFinite(s)&&typeof s=="number")){if(n.some(s=>s===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((s,i)=>s/n[i])}else console.warn("p5.Vector.prototype.div:","array contains components that are either undefined or not finite numbers");return this}if(t.every(n=>Number.isFinite(n)&&typeof n=="number")){if(t.some(n=>n===0))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this._values=this._values.map((n,s)=>n/t[0])}else console.warn("p5.Vector.prototype.div:","arguments contain components that are either undefined or not finite numbers");return this}mag(){return Math.sqrt(this.magSq())}magSq(){return this._values.reduce((t,n)=>t+n*n,0)}dot(...t){return t[0]instanceof Ee?this.dot(...t[0]._values):this._values.reduce((n,s,i)=>n+s*(t[i]||0),0)}cross(t){const n=this.y*t.z-this.z*t.y,s=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return this.isPInst?new Ee(this._fromRadians,this._toRadians,n,s,i):new Ee(n,s,i)}dist(t){return t.copy().sub(this).mag()}normalize(){const t=this.mag();return t!==0&&this.mult(1/t),this}limit(t){const n=this.magSq();return n>t*t&&this.div(Math.sqrt(n)).mult(t),this}setMag(t){return this.normalize().mult(t)}heading(){const t=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(t):t}setHeading(t){this.isPInst&&(t=this._toRadians(t));let n=this.mag();return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this}rotate(t){let n=this.heading()+t;this.isPInst&&(n=this._toRadians(n));const s=this.mag();return this.x=Math.cos(n)*s,this.y=Math.sin(n)*s,this}angleBetween(t){if(this.magSq()*t.magSq()===0)return NaN;const s=this.cross(t);let i=Math.atan2(s.mag(),this.dot(t))*Math.sign(s.z||1);return this.isPInst&&(i=this._fromRadians(i)),i}lerp(t,n,s,i){return t instanceof Ee?this.lerp(t.x,t.y,t.z,n):(this.x+=(t-this.x)*i||0,this.y+=(n-this.y)*i||0,this.z+=(s-this.z)*i||0,this)}slerp(t,n){if(n===0)return this;if(n===1)return this.set(t);const s=this.mag(),i=t.mag();if(s*i===0)return this.mult(1-n).add(t.x*n,t.y*n,t.z*n),this;const o=this.cross(t),u=o.mag(),l=Math.atan2(u,this.dot(t));if(u>0)o.x/=u,o.y/=u,o.z/=u;else{if(l<Math.PI*.5)return this.mult(1-n).add(t.x*n,t.y*n,t.z*n),this;this.z===0&&t.z===0?o.set(0,0,1):this.x!==0?o.set(this.y,-this.x,0).normalize():o.set(1,0,0)}const c=o.cross(this),h=1-n+n*i/s,f=h*Math.cos(n*l),p=h*Math.sin(n*l);return this.x=this.x*f+c.x*p,this.y=this.y*f+c.y*p,this.z=this.z*f+c.z*p,this}reflect(t){const n=Ee.normalize(t);return this.sub(n.mult(2*this.dot(n)))}array(){return[this.x||0,this.y||0,this.z||0]}equals(...t){let n;t[0]instanceof Ee?n=t[0]._values:Array.isArray(t[0])?n=t[0]:n=t;for(let s=0;s<this._values.length;s++)if(this._values[s]!==(n[s]||0))return!1;return!0}clampToZero(){for(let t=0;t<this._values.length;t++)this._values[t]=this._clampToZero(this._values[t]);return this}_clampToZero(t){return Math.abs((t||0)-0)<=Number.EPSILON?0:t}static fromAngle(t,n){return typeof n>"u"&&(n=1),new Ee(n*Math.cos(t),n*Math.sin(t),0)}static fromAngles(t,n,s){typeof s>"u"&&(s=1);const i=Math.cos(n),a=Math.sin(n),o=Math.cos(t),u=Math.sin(t);return new Ee(s*u*a,-s*o,s*u*i)}static random2D(){return this.fromAngle(Math.random()*ai)}static random3D(){const t=Math.random()*ai,n=Math.random()*2-1,s=Math.sqrt(1-n*n),i=s*Math.cos(t),a=s*Math.sin(t);return new Ee(i,a,n)}static copy(t){return t.copy(t)}static add(t,n,s){return s?s.set(t):(s=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),s.add(n),s}static rem(t,n){if(t instanceof Ee&&n instanceof Ee){let s=t.copy();return s.rem(n),s}}static sub(t,n,s){return s?s.set(t):(s=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),s.sub(n),s}static mult(t,n,s){return s?s.set(t):(s=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),s.mult(n),s}static rotate(t,n,s){return arguments.length===2?s=t.copy():(s instanceof Ee||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),s.set(t)),s.rotate(n),s}static div(t,n,s){return s?s.set(t):(s=t.copy(),arguments.length===3&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),s.div(n),s}static dot(t,n){return t.dot(n)}static cross(t,n){return t.cross(n)}static dist(t,n){return t.dist(n)}static lerp(t,n,s,i){return i?i.set(t):(i=t.copy(),arguments.length===4&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),i.lerp(n,s),i}static slerp(t,n,s,i){return i?i.set(t):(i=t.copy(),arguments.length===4&&p5._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")),i.slerp(n,s),i}static mag(t){return t.mag()}static magSq(t){return t.magSq()}static normalize(t,n){return arguments.length<2?n=t.copy():(n instanceof Ee||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),n.set(t)),n.normalize()}static limit(t,n,s){return arguments.length<3?s=t.copy():(s instanceof Ee||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),s.set(t)),s.limit(n)}static setMag(t,n,s){return arguments.length<3?s=t.copy():(s instanceof Ee||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),s.set(t)),s.setMag(n)}static heading(t){return t.heading()}static angleBetween(t,n){return t.angleBetween(n)}static reflect(t,n,s){return arguments.length<3?s=t.copy():(s instanceof Ee||p5._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),s.set(t)),s.reflect(n)}static array(t){return t.array()}static equals(t,n){let s;return t instanceof Ee?s=t:t instanceof Array?s=new Ee().set(t):p5._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),s.equals(n)}}function v6(r,t){r.Vector=Ee}typeof p5<"u"&&v6(p5,p5.prototype);function w6(r,t){const n=[JL,e6,t6,n6,r6,s6];t._frameRate=0,t._lastFrameTime=window.performance.now(),t._targetFrameRate=60;const s=window.print;let i=!1;t.print=function(...c){c.length?console.log(...c):i||(s(),window.confirm("You just tried to print the webpage. Do you want to prevent this from running again?")&&(i=!0))},t.frameCount=0,t.deltaTime=0,t.focused=document.hasFocus(),t.cursor=function(c,h,f){let p="auto";const g=this._curElement.elt;if(n.includes(c))p=c;else if(typeof c=="string"){let y="";h&&f&&typeof h=="number"&&typeof f=="number"&&(y=`${h} ${f}`),c.substring(0,7)==="http://"||c.substring(0,8)==="https://"?p=`url(${c}) ${y}, auto`:/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(c)?p=`url(${c}) ${y}, auto`:p=c}g.style.cursor=p},t.frameRate=function(c){return typeof c!="number"||c<0?this._frameRate:(this._targetFrameRate=c,c===0&&(this._frameRate=c),this)},t.getFrameRate=function(){return this.frameRate()},t.setFrameRate=function(c){return this.frameRate(c)},t.getTargetFrameRate=function(){return this._targetFrameRate},t.noCursor=function(){this._curElement.elt.style.cursor="none"},t.webglVersion=jc,t.displayWidth=screen.width,t.displayHeight=screen.height,t.windowWidth=0,t.windowHeight=0,t._onresize=function(c){this.windowWidth=a(),this.windowHeight=o();const h=this._isGlobal?window:this;let f;typeof h.windowResized=="function"&&(f=h.windowResized(c),f!==void 0&&!f&&c.preventDefault())};function a(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function o(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}t._updateWindowSize=function(){this.windowWidth=a(),this.windowHeight=o()},Object.defineProperty(t,"width",{get(){return this._renderer.width}}),Object.defineProperty(t,"height",{get(){return this._renderer.height}}),t.fullscreen=function(c){if(typeof c>"u")return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;c?u(document.documentElement):l()},t.pixelDensity=function(c){let h;return typeof c=="number"?(c!==this._renderer._pixelDensity&&(this._renderer._pixelDensity=c),h=this,this.resizeCanvas(this.width,this.height,!0)):h=this._renderer._pixelDensity,h},t.displayDensity=()=>window.devicePixelRatio;function u(c){if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");c.requestFullscreen?c.requestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen?c.webkitRequestFullscreen():c.msRequestFullscreen&&c.msRequestFullscreen()}function l(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}t.getURL=()=>location.href,t.getURLPath=()=>location.pathname.split("/").filter(c=>c!==""),t.getURLParams=function(){const c=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim;let h;const f={};for(;(h=c.exec(location.search))!=null;)h.index===c.lastIndex&&c.lastIndex++,f[h[1]]=h[2];return f},t.worldToScreen=function(c){return typeof c=="number"&&(c=this.createVector(...arguments)),this._renderer.getWorldToScreenMatrix().multiplyAndNormalizePoint(c)},t.screenToWorld=function(c){typeof c=="number"&&(c=this.createVector(...arguments));const h=this._renderer.getWorldToScreenMatrix();if(c.dimensions==2){let g=h.mat4[14]/h.mat4[15];c=this.createVector(c.x,c.y,g)}return h.invert(h).multiplyAndNormalizePoint(c)}}typeof p5<"u"&&w6(p5,p5.prototype);function fs(r,t){let n=r.length;Array.isArray(r[0])||(r=[r]),Array.isArray(t[0])||(t=t.map(o=>[o]));let s=t[0].length,i=t[0].map((o,u)=>t.map(l=>l[u])),a=r.map(o=>i.map(u=>{let l=0;if(!Array.isArray(o)){for(let c of u)l+=o*c;return l}for(let c=0;c<o.length;c++)l+=o[c]*(u[c]||0);return l}));return n===1&&(a=a[0]),s===1?a.map(o=>o[0]):a}function S6(r){return jf(r)==="string"}function jf(r){return(Object.prototype.toString.call(r).match(/^\[object\s+(.*?)\]$/)[1]||"").toLowerCase()}function U_(r,{precision:t,unit:n}){return G_(r)?"none":YY(r,t)+(n??"")}function G_(r){return Number.isNaN(r)||r instanceof Number&&(r==null?void 0:r.none)}function YY(r,t){if(r===0)return 0;let n=~~r,s=0;n&&t&&(s=~~Math.log10(Math.abs(n))+1);const i=10**(t-s);return Math.floor(r*i+.5)/i}const ZY={deg:1,grad:.9,rad:180/Math.PI,turn:360};function QY(r){if(!r)return;r=r.trim();const t=/^([a-z]+)\((.+?)\)$/i,n=/^-?[\d.]+$/,s=/%|deg|g?rad|turn$/,i=/\/?\s*(none|[-\w.]+(?:%|deg|g?rad|turn)?)/g;let a=r.match(t);if(a){let o=[];return a[2].replace(i,(u,l)=>{let c=l.match(s),h=l;if(c){let f=c[0],p=h.slice(0,-f.length);f==="%"?(h=new Number(p/100),h.type="<percentage>"):(h=new Number(p*ZY[f]),h.type="<angle>",h.unit=f)}else n.test(h)?(h=new Number(h),h.type="<number>"):h==="none"&&(h=new Number(NaN),h.none=!0);u.startsWith("/")&&(h=h instanceof Number?h:new Number(h),h.alpha=!0),typeof h=="object"&&h instanceof Number&&(h.raw=l),o.push(h)}),{name:a[1].toLowerCase(),rawName:a[1],rawArgs:a[2],args:o}}}function JY(r){return r[r.length-1]}function Nx(r,t,n){return isNaN(r)?t:isNaN(t)?r:r+(t-r)*n}function eZ(r,t,n){return(n-r)/(t-r)}function C6(r,t,n){return Nx(t[0],t[1],eZ(r[0],r[1],n))}function tZ(r){return r.map(t=>t.split("|").map(n=>{n=n.trim();let s=n.match(/^(<[a-z]+>)\[(-?[.\d]+),\s*(-?[.\d]+)\]?$/);if(s){let i=new String(s[1]);return i.range=[+s[2],+s[3]],i}return n}))}function nZ(r,t,n){return Math.max(Math.min(n,t),r)}function sT(r,t){return Math.sign(r)===Math.sign(t)?r:-r}function du(r,t){return sT(Math.abs(r)**t,r)}function _6(r,t){return t===0?0:r/t}function rZ(r,t,n=0,s=r.length){for(;n<s;){const i=n+s>>1;r[i]<t?n=i+1:s=i}return n}class sZ{add(t,n,s){if(typeof arguments[0]!="string"){for(var t in arguments[0])this.add(t,arguments[0][t],arguments[1]);return}(Array.isArray(t)?t:[t]).forEach(function(i){this[i]=this[i]||[],n&&this[i][s?"unshift":"push"](n)},this)}run(t,n){this[t]=this[t]||[],this[t].forEach(function(s){s.call(n&&n.context?n.context:n,n)})}}const kx=new sZ,pu={D50:[.3457/.3585,1,(1-.3457-.3585)/.3585],D65:[.3127/.329,1,(1-.3127-.329)/.329]};function j_(r){return Array.isArray(r)?r:pu[r]}function Ax(r,t,n,s={}){if(r=j_(r),t=j_(t),!r||!t)throw new TypeError(`Missing white point to convert ${r?"":"from"}${!r&&!t?"/":""}${t?"":"to"}`);if(r===t)return n;let i={W1:r,W2:t,XYZ:n,options:s};if(kx.run("chromatic-adaptation-start",i),i.M||(i.W1===pu.D65&&i.W2===pu.D50?i.M=[[1.0479297925449969,.022946870601609652,-.05019226628920524],[.02962780877005599,.9904344267538799,-.017073799063418826],[-.009243040646204504,.015055191490298152,.7518742814281371]]:i.W1===pu.D50&&i.W2===pu.D65&&(i.M=[[.955473421488075,-.02309845494876471,.06325924320057072],[-.0283697093338637,1.0099953980813041,.021041441191917323],[.012314014864481998,-.020507649298898964,1.330365926242124]])),kx.run("chromatic-adaptation-end",i),i.M)return fs(i.M,i.XYZ);throw new TypeError("Only Bradford CAT with white points D50 and D65 supported for now.")}var XL,YL,ZL;const Kc={gamut_mapping:"css",precision:5,deltaE:"76",verbose:((ZL=(YL=(XL=globalThis==null?void 0:globalThis.process)==null?void 0:XL.env)==null?void 0:YL.NODE_ENV)==null?void 0:ZL.toLowerCase())!=="test",warn:function(t){var n,s;this.verbose&&((s=(n=globalThis==null?void 0:globalThis.console)==null?void 0:n.warn)==null||s.call(n,t))}},iZ=new Set(["<number>","<percentage>","<angle>"]);function b4(r,t,n,s){return Object.entries(r.coords).map(([a,o],u)=>{let l=t.coordGrammar[u],c=s[u],h=c==null?void 0:c.type,f;if(c.none?f=l.find(y=>iZ.has(y)):f=l.find(y=>y==h),!f){let y=o.name||a;throw new TypeError(`${h??c.raw} not allowed for ${y} in ${n}()`)}let p=f.range;h==="<percentage>"&&(p||(p=[0,1]));let g=o.range||o.refRange;return p&&g&&(s[u]=C6(p,g,s[u])),f})}function E6(r,{meta:t}={}){var s,i,a,o;let n={str:(s=String(r))==null?void 0:s.trim()};if(kx.run("parse-start",n),n.color)return n.color;if(n.parsed=QY(n.str),n.parsed){let u=n.parsed.name;if(u==="color"){let l=n.parsed.args.shift(),c=l.startsWith("--")?l.substring(2):`--${l}`,h=[l,c],f=n.parsed.rawArgs.indexOf("/")>0?n.parsed.args.pop():1;for(let y of tn.all){let x=y.getFormat("color");if(x&&(h.includes(x.id)||(i=x.ids)!=null&&i.filter(v=>h.includes(v)).length)){const v=Object.keys(y.coords).map((w,E)=>n.parsed.args[E]||0);let S;return x.coordGrammar&&(S=b4(y,x,"color",v)),t&&Object.assign(t,{formatId:"color",types:S}),x.id.startsWith("--")&&!l.startsWith("--")&&Kc.warn(`${y.name} is a non-standard space and not currently supported in the CSS spec. Use prefixed color(${x.id}) instead of color(${l}).`),l.startsWith("--")&&!x.id.startsWith("--")&&Kc.warn(`${y.name} is a standard space and supported in the CSS spec. Use color(${x.id}) instead of prefixed color(${l}).`),{spaceId:y.id,coords:v,alpha:f}}}let p="",g=l in tn.registry?l:c;if(g in tn.registry){let y=(o=(a=tn.registry[g].formats)==null?void 0:a.color)==null?void 0:o.id;y&&(p=`Did you mean color(${y})?`)}throw new TypeError(`Cannot parse color(${l}). `+(p||"Missing a plugin?"))}else for(let l of tn.all){let c=l.getFormat(u);if(c&&c.type==="function"){let h=1;(c.lastAlpha||JY(n.parsed.args).alpha)&&(h=n.parsed.args.pop());let f=n.parsed.args,p;return c.coordGrammar&&(p=b4(l,c,u,f)),t&&Object.assign(t,{formatId:c.name,types:p}),{spaceId:l.id,coords:f,alpha:h}}}}else for(let u of tn.all)for(let l in u.formats){let c=u.formats[l];if(c.type!=="custom"||c.test&&!c.test(n.str))continue;let h=c.parse(n.str);if(h)return h.alpha??(h.alpha=1),t&&(t.formatId=l),h}throw new TypeError(`Could not parse ${r} as a color. Missing a plugin?`)}function rs(r){if(Array.isArray(r))return r.map(rs);if(!r)throw new TypeError("Empty color reference");S6(r)&&(r=E6(r));let t=r.space||r.spaceId;return t instanceof tn||(r.space=tn.get(t)),r.alpha===void 0&&(r.alpha=1),r}const aZ=75e-6,Ei=class Ei{constructor(t){var i;this.id=t.id,this.name=t.name,this.base=t.base?Ei.get(t.base):null,this.aliases=t.aliases,this.base&&(this.fromBase=t.fromBase,this.toBase=t.toBase);let n=t.coords??this.base.coords;for(let a in n)"name"in n[a]||(n[a].name=a);this.coords=n;let s=t.white??this.base.white??"D65";this.white=j_(s),this.formats=t.formats??{};for(let a in this.formats){let o=this.formats[a];o.type||(o.type="function"),o.name||(o.name=a)}(i=this.formats.color)!=null&&i.id||(this.formats.color={...this.formats.color??{},id:t.cssId||this.id}),t.gamutSpace?this.gamutSpace=t.gamutSpace==="self"?this:Ei.get(t.gamutSpace):this.isPolar?this.gamutSpace=this.base:this.gamutSpace=this,this.gamutSpace.isUnbounded&&(this.inGamut=(a,o)=>!0),this.referred=t.referred,Object.defineProperty(this,"path",{value:oZ(this).reverse(),writable:!1,enumerable:!0,configurable:!0}),kx.run("colorspace-init-end",this)}inGamut(t,{epsilon:n=aZ}={}){if(!this.equals(this.gamutSpace))return t=this.to(this.gamutSpace,t),this.gamutSpace.inGamut(t,{epsilon:n});let s=Object.values(this.coords);return t.every((i,a)=>{let o=s[a];if(o.type!=="angle"&&o.range){if(Number.isNaN(i))return!0;let[u,l]=o.range;return(u===void 0||i>=u-n)&&(l===void 0||i<=l+n)}return!0})}get isUnbounded(){return Object.values(this.coords).every(t=>!("range"in t))}get cssId(){var t,n;return((n=(t=this.formats)==null?void 0:t.color)==null?void 0:n.id)||this.id}get isPolar(){for(let t in this.coords)if(this.coords[t].type==="angle")return!0;return!1}getFormat(t){if(typeof t=="object")return t=v4(t,this),t;let n;return t==="default"?n=Object.values(this.formats)[0]:n=this.formats[t],n?(n=v4(n,this),n):null}equals(t){return t?this===t||this.id===t||this.id===t.id:!1}to(t,n){if(arguments.length===1){const u=rs(t);[t,n]=[u.space,u.coords]}if(t=Ei.get(t),this.equals(t))return n;n=n.map(u=>Number.isNaN(u)?0:u);let s=this.path,i=t.path,a,o;for(let u=0;u<s.length&&s[u].equals(i[u]);u++)a=s[u],o=u;if(!a)throw new Error(`Cannot convert between color spaces ${this} and ${t}: no connection space was found`);for(let u=s.length-1;u>o;u--)n=s[u].toBase(n);for(let u=o+1;u<i.length;u++)n=i[u].fromBase(n);return n}from(t,n){if(arguments.length===1){const s=rs(t);[t,n]=[s.space,s.coords]}return t=Ei.get(t),t.to(this,n)}toString(){return`${this.name} (${this.id})`}getMinCoords(){let t=[];for(let n in this.coords){let s=this.coords[n],i=s.range||s.refRange;t.push((i==null?void 0:i.min)??0)}return t}static get all(){return[...new Set(Object.values(Ei.registry))]}static register(t,n){if(arguments.length===1&&(n=arguments[0],t=n.id),n=this.get(n),this.registry[t]&&this.registry[t]!==n)throw new Error(`Duplicate color space registration: '${t}'`);if(this.registry[t]=n,arguments.length===1&&n.aliases)for(let s of n.aliases)this.register(s,n);return n}static get(t,...n){if(!t||t instanceof Ei)return t;if(jf(t)==="string"){let i=Ei.registry[t.toLowerCase()];if(!i)throw new TypeError(`No color space found with id = "${t}"`);return i}if(n.length)return Ei.get(...n);throw new TypeError(`${t} is not a valid color space`)}static resolveCoord(t,n){var l;let s=jf(t),i,a;if(s==="string"?t.includes(".")?[i,a]=t.split("."):[i,a]=[,t]:Array.isArray(t)?[i,a]=t:(i=t.space,a=t.coordId),i=Ei.get(i),i||(i=n),!i)throw new TypeError(`Cannot resolve coordinate reference ${t}: No color space specified and relative references are not allowed here`);if(s=jf(a),s==="number"||s==="string"&&a>=0){let c=Object.entries(i.coords)[a];if(c)return{space:i,id:c[0],index:a,...c[1]}}i=Ei.get(i);let o=a.toLowerCase(),u=0;for(let c in i.coords){let h=i.coords[c];if(c.toLowerCase()===o||((l=h.name)==null?void 0:l.toLowerCase())===o)return{space:i,id:c,index:u,...h};u++}throw new TypeError(`No "${a}" coordinate found in ${i.name}. Its coordinates are: ${Object.keys(i.coords).join(", ")}`)}};Bt(Ei,"registry",{}),Bt(Ei,"DEFAULT_FORMAT",{type:"functions",name:"color"});let tn=Ei;function oZ(r){let t=[r];for(let n=r;n=n.base;)t.push(n);return t}function v4(r,{coords:t}={}){if(r.coords&&!r.coordGrammar){r.type||(r.type="function"),r.name||(r.name="color"),r.coordGrammar=tZ(r.coords);let n=Object.entries(t).map(([s,i],a)=>{let o=r.coordGrammar[a][0],u=i.range||i.refRange,l=o.range,c="";return o=="<percentage>"?(l=[0,100],c="%"):o=="<angle>"&&(c="deg"),{fromRange:u,toRange:l,suffix:c}});r.serializeCoords=(s,i)=>s.map((a,o)=>{let{fromRange:u,toRange:l,suffix:c}=n[o];return u&&l&&(a=C6(u,l,a)),a=U_(a,{precision:i,unit:c}),a})}return r}const wl=new tn({id:"xyz-d65",name:"XYZ D65",coords:{x:{name:"X"},y:{name:"Y"},z:{name:"Z"}},white:"D65",formats:{color:{ids:["xyz-d65","xyz"]}},aliases:["xyz"]});class nv extends tn{constructor(t){t.coords||(t.coords={r:{range:[0,1],name:"Red"},g:{range:[0,1],name:"Green"},b:{range:[0,1],name:"Blue"}}),t.base||(t.base=wl),t.toXYZ_M&&t.fromXYZ_M&&(t.toBase??(t.toBase=n=>{let s=fs(t.toXYZ_M,n);return this.white!==this.base.white&&(s=Ax(this.white,this.base.white,s)),s}),t.fromBase??(t.fromBase=n=>(n=Ax(this.base.white,this.white,n),fs(t.fromXYZ_M,n)))),t.referred??(t.referred="display"),super(t)}}function D6(r,t){return r=rs(r),!t||r.space.equals(t)?r.coords.slice():(t=tn.get(t),t.from(r))}function Ic(r,t){r=rs(r);let{space:n,index:s}=tn.resolveCoord(t,r.space);return D6(r,n)[s]}function T6(r,t,n){return r=rs(r),t=tn.get(t),r.coords=t.to(r.space,n),r}T6.returns="color";function Hm(r,t,n){if(r=rs(r),arguments.length===2&&jf(arguments[1])==="object"){let s=arguments[1];for(let i in s)Hm(r,i,s[i])}else{typeof n=="function"&&(n=n(Ic(r,t)));let{space:s,index:i}=tn.resolveCoord(t,r.space),a=D6(r,s);a[i]=n,T6(r,s,a)}return r}Hm.returns="color";const uZ=new tn({id:"xyz-d50",name:"XYZ D50",white:"D50",base:wl,fromBase:r=>Ax(wl.white,"D50",r),toBase:r=>Ax("D50",wl.white,r)}),lZ=216/24389,w4=24/116,gy=24389/27;let yC=pu.D50;const Ya=new tn({id:"lab",name:"Lab",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:yC,base:uZ,fromBase(r){let n=r.map((s,i)=>s/yC[i]).map(s=>s>lZ?Math.cbrt(s):(gy*s+16)/116);return[116*n[1]-16,500*(n[0]-n[1]),200*(n[1]-n[2])]},toBase(r){let t=[];return t[1]=(r[0]+16)/116,t[0]=r[1]/500+t[1],t[2]=t[1]-r[2]/200,[t[0]>w4?Math.pow(t[0],3):(116*t[0]-16)/gy,r[0]>8?Math.pow((r[0]+16)/116,3):r[0]/gy,t[2]>w4?Math.pow(t[2],3):(116*t[2]-16)/gy].map((s,i)=>s*yC[i])},formats:{lab:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function Nu(r){return(r%360+360)%360}function cZ(r,t){if(r==="raw")return t;let[n,s]=t.map(Nu),i=s-n;return r==="increasing"?i<0&&(s+=360):r==="decreasing"?i>0&&(n+=360):r==="longer"?-180<i&&i<180&&(i>0?n+=360:s+=360):r==="shorter"&&(i>180?n+=360:i<-180&&(s+=360)),[n,s]}const ad=new tn({id:"lch",name:"LCH",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,150],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:Ya,fromBase(r){let[t,n,s]=r,i;const a=.02;return Math.abs(n)<a&&Math.abs(s)<a?i=NaN:i=Math.atan2(s,n)*180/Math.PI,[t,Math.sqrt(n**2+s**2),Nu(i)]},toBase(r){let[t,n,s]=r;return n<0&&(n=0),isNaN(s)&&(s=0),[t,n*Math.cos(s*Math.PI/180),n*Math.sin(s*Math.PI/180)]},formats:{lch:{coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}}),S4=25**7,Ix=Math.PI,C4=180/Ix,bf=Ix/180;function _4(r){const t=r*r;return t*t*t*r}function N6(r,t,{kL:n=1,kC:s=1,kH:i=1}={}){[r,t]=rs([r,t]);let[a,o,u]=Ya.from(r),l=ad.from(Ya,[a,o,u])[1],[c,h,f]=Ya.from(t),p=ad.from(Ya,[c,h,f])[1];l<0&&(l=0),p<0&&(p=0);let g=(l+p)/2,y=_4(g),x=.5*(1-Math.sqrt(y/(y+S4))),v=(1+x)*o,S=(1+x)*h,w=Math.sqrt(v**2+u**2),E=Math.sqrt(S**2+f**2),_=v===0&&u===0?0:Math.atan2(u,v),D=S===0&&f===0?0:Math.atan2(f,S);_<0&&(_+=2*Ix),D<0&&(D+=2*Ix),_*=C4,D*=C4;let I=c-a,k=E-w,A=D-_,N=_+D,F=Math.abs(A),$;w*E===0?$=0:F<=180?$=A:A>180?$=A-360:A<-180?$=A+360:Kc.warn("the unthinkable has happened");let O=2*Math.sqrt(E*w)*Math.sin($*bf/2),M=(a+c)/2,B=(w+E)/2,U=_4(B),V;w*E===0?V=N:F<=180?V=N/2:N<360?V=(N+360)/2:V=(N-360)/2;let Z=(M-50)**2,J=1+.015*Z/Math.sqrt(20+Z),ne=1+.045*B,z=1;z-=.17*Math.cos((V-30)*bf),z+=.24*Math.cos(2*V*bf),z+=.32*Math.cos((3*V+6)*bf),z-=.2*Math.cos((4*V-63)*bf);let X=1+.015*B*z,Y=30*Math.exp(-1*((V-275)/25)**2),se=2*Math.sqrt(U/(U+S4)),ue=-1*Math.sin(2*Y*bf)*se,fe=(I/(n*J))**2;return fe+=(k/(s*ne))**2,fe+=(O/(i*X))**2,fe+=ue*(k/(s*ne))*(O/(i*X)),Math.sqrt(fe)}const hZ=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],fZ=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],dZ=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],pZ=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],Xc=new tn({id:"oklab",name:"Oklab",coords:{l:{refRange:[0,1],name:"Lightness"},a:{refRange:[-.4,.4]},b:{refRange:[-.4,.4]}},white:"D65",base:wl,fromBase(r){let n=fs(hZ,r).map(s=>Math.cbrt(s));return fs(dZ,n)},toBase(r){let n=fs(pZ,r).map(s=>s**3);return fs(fZ,n)},formats:{oklab:{coords:["<percentage> | <number>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function W_(r,t){[r,t]=rs([r,t]);let[n,s,i]=Xc.from(r),[a,o,u]=Xc.from(t),l=n-a,c=s-o,h=i-u;return Math.sqrt(l**2+c**2+h**2)}const mZ=75e-6;function Wf(r,t,{epsilon:n=mZ}={}){r=rs(r),t||(t=r.space),t=tn.get(t);let s=r.coords;return t!==r.space&&(s=t.from(r)),t.inGamut(s,{epsilon:n})}function qm(r){return{space:r.space,coords:r.coords.slice(),alpha:r.alpha}}function gZ(r,t,n="lab"){n=tn.get(n);let s=n.from(r),i=n.from(t);return Math.sqrt(s.reduce((a,o,u)=>{let l=i[u];return isNaN(o)||isNaN(l)?a:a+(l-o)**2},0))}function yZ(r,t){return gZ(r,t,"lab")}const xZ=Math.PI,E4=xZ/180;function bZ(r,t,{l:n=2,c:s=1}={}){[r,t]=rs([r,t]);let[i,a,o]=Ya.from(r),[,u,l]=ad.from(Ya,[i,a,o]),[c,h,f]=Ya.from(t),p=ad.from(Ya,[c,h,f])[1];u<0&&(u=0),p<0&&(p=0);let g=i-c,y=u-p,x=a-h,v=o-f,S=x**2+v**2-y**2,w=.511;i>=16&&(w=.040975*i/(1+.01765*i));let E=.0638*u/(1+.0131*u)+.638,_;Number.isNaN(l)&&(l=0),l>=164&&l<=345?_=.56+Math.abs(.2*Math.cos((l+168)*E4)):_=.36+Math.abs(.4*Math.cos((l+35)*E4));let D=Math.pow(u,4),I=Math.sqrt(D/(D+1900)),k=E*(I*_+1-I),A=(g/(n*w))**2;return A+=(y/(s*E))**2,A+=S/k**2,Math.sqrt(A)}const D4=203,k6=new tn({id:"xyz-abs-d65",cssId:"--xyz-abs-d65",name:"Absolute XYZ D65",coords:{x:{refRange:[0,9504.7],name:"Xa"},y:{refRange:[0,1e4],name:"Ya"},z:{refRange:[0,10888.3],name:"Za"}},base:wl,fromBase(r){return r.map(t=>Math.max(t*D4,0))},toBase(r){return r.map(t=>Math.max(t/D4,0))}}),yy=1.15,xy=.66,T4=2610/2**14,vZ=2**14/2610,N4=3424/2**12,k4=2413/2**7,A4=2392/2**7,wZ=1.7*2523/2**5,I4=2**5/(1.7*2523),by=-.56,xC=16295499532821565e-27,SZ=[[.41478972,.579999,.014648],[-.20151,1.120649,.0531008],[-.0166008,.2648,.6684799]],CZ=[[1.9242264357876067,-1.0047923125953657,.037651404030618],[.35031676209499907,.7264811939316552,-.06538442294808501],[-.09098281098284752,-.3127282905230739,1.5227665613052603]],_Z=[[.5,.5,0],[3.524,-4.066708,.542708],[.199076,1.096799,-1.295875]],EZ=[[1,.1386050432715393,.05804731615611886],[.9999999999999999,-.1386050432715393,-.05804731615611886],[.9999999999999998,-.09601924202631895,-.8118918960560388]],DZ=new tn({id:"jzazbz",name:"Jzazbz",coords:{jz:{refRange:[0,1],name:"Jz"},az:{refRange:[-.5,.5]},bz:{refRange:[-.5,.5]}},base:k6,fromBase(r){let[t,n,s]=r,i=yy*t-(yy-1)*s,a=xy*n-(xy-1)*t,u=fs(SZ,[i,a,s]).map(function(p){let g=N4+k4*(p/1e4)**T4,y=1+A4*(p/1e4)**T4;return(g/y)**wZ}),[l,c,h]=fs(_Z,u);return[(1+by)*l/(1+by*l)-xC,c,h]},toBase(r){let[t,n,s]=r,i=(t+xC)/(1+by-by*(t+xC)),o=fs(EZ,[i,n,s]).map(function(p){let g=N4-p**I4,y=A4*p**I4-k4;return 1e4*(g/y)**vZ}),[u,l,c]=fs(CZ,o),h=(u+(yy-1)*c)/yy,f=(l+(xy-1)*h)/xy;return[h,f,c]},formats:{color:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),$4=new tn({id:"jzczhz",name:"JzCzHz",coords:{jz:{refRange:[0,1],name:"Jz"},cz:{refRange:[0,1],name:"Chroma"},hz:{refRange:[0,360],type:"angle",name:"Hue"}},base:DZ,fromBase(r){let[t,n,s]=r,i;const a=2e-4;return Math.abs(n)<a&&Math.abs(s)<a?i=NaN:i=Math.atan2(s,n)*180/Math.PI,[t,Math.sqrt(n**2+s**2),Nu(i)]},toBase(r){return[r[0],r[1]*Math.cos(r[2]*Math.PI/180),r[1]*Math.sin(r[2]*Math.PI/180)]}});function TZ(r,t){[r,t]=rs([r,t]);let[n,s,i]=$4.from(r),[a,o,u]=$4.from(t),l=n-a,c=s-o;Number.isNaN(i)&&Number.isNaN(u)?(i=0,u=0):Number.isNaN(i)?i=u:Number.isNaN(u)&&(u=i);let h=i-u,f=2*Math.sqrt(s*o)*Math.sin(h/2*(Math.PI/180));return Math.sqrt(l**2+c**2+f**2)}const A6=3424/4096,I6=2413/128,$6=2392/128,F4=2610/16384,NZ=2523/32,kZ=16384/2610,R4=32/2523,AZ=[[.3592832590121217,.6976051147779502,-.035891593232029],[-.1920808463704993,1.100476797037432,.0753748658519118],[.0070797844607479,.0748396662186362,.8433265453898765]],IZ=[[2048/4096,2048/4096,0],[6610/4096,-13613/4096,7003/4096],[17933/4096,-17390/4096,-543/4096]],$Z=[[.9999999999999998,.0086090370379328,.111029625003026],[.9999999999999998,-.0086090370379328,-.1110296250030259],[.9999999999999998,.5600313357106791,-.3206271749873188]],FZ=[[2.0701522183894223,-1.3263473389671563,.2066510476294053],[.3647385209748072,.6805660249472273,-.0453045459220347],[-.0497472075358123,-.0492609666966131,1.1880659249923042]],O4=new tn({id:"ictcp",name:"ICTCP",coords:{i:{refRange:[0,1],name:"I"},ct:{refRange:[-.5,.5],name:"CT"},cp:{refRange:[-.5,.5],name:"CP"}},base:k6,fromBase(r){let t=fs(AZ,r);return RZ(t)},toBase(r){let t=OZ(r);return fs(FZ,t)}});function RZ(r){let t=r.map(function(n){let s=A6+I6*(n/1e4)**F4,i=1+$6*(n/1e4)**F4;return(s/i)**NZ});return fs(IZ,t)}function OZ(r){return fs($Z,r).map(function(s){let i=Math.max(s**R4-A6,0),a=I6-$6*s**R4;return 1e4*(i/a)**kZ})}function MZ(r,t){[r,t]=rs([r,t]);let[n,s,i]=O4.from(r),[a,o,u]=O4.from(t);return 720*Math.sqrt((n-a)**2+.25*(s-o)**2+(i-u)**2)}const LZ=pu.D65,F6=.42,M4=1/F6,bC=2*Math.PI,R6=[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],BZ=[[1.8620678550872327,-1.0112546305316843,.14918677544445175],[.38752654323613717,.6214474419314753,-.008973985167612518],[-.015841498849333856,-.03412293802851557,1.0499644368778496]],PZ=[[460,451,288],[460,-891,-261],[460,-220,-6300]],VZ={dark:[.8,.525,.8],dim:[.9,.59,.9],average:[1,.69,1]},Ec={h:[20.14,90,164.25,237.53,380.14],e:[.8,.7,1,1.2,.8],H:[0,100,200,300,400]},zZ=180/Math.PI,L4=Math.PI/180;function O6(r,t){return r.map(s=>{const i=du(t*Math.abs(s)*.01,F6);return 400*sT(i,s)/(i+27.13)})}function UZ(r,t){const n=100/t*27.13**M4;return r.map(s=>{const i=Math.abs(s);return sT(n*du(i/(400-i),M4),s)})}function GZ(r){let t=Nu(r);t<=Ec.h[0]&&(t+=360);const n=rZ(Ec.h,t)-1,[s,i]=Ec.h.slice(n,n+2),[a,o]=Ec.e.slice(n,n+2),u=Ec.H[n],l=(t-s)/a;return u+100*l/(l+(i-t)/o)}function jZ(r){let t=(r%400+400)%400;const n=Math.floor(.01*t);t=t%100;const[s,i]=Ec.h.slice(n,n+2),[a,o]=Ec.e.slice(n,n+2);return Nu((t*(o*s-a*i)-100*s*o)/(t*(o-a)-100*o))}function M6(r,t,n,s,i){const a={};a.discounting=i,a.refWhite=r,a.surround=s;const o=r.map(x=>x*100);a.la=t,a.yb=n;const u=o[1],l=fs(R6,o);s=VZ[a.surround];const c=s[0];a.c=s[1],a.nc=s[2];const f=(1/(5*a.la+1))**4;a.fl=f*a.la+.1*(1-f)*(1-f)*Math.cbrt(5*a.la),a.flRoot=a.fl**.25,a.n=a.yb/u,a.z=1.48+Math.sqrt(a.n),a.nbb=.725*a.n**-.2,a.ncb=a.nbb;const p=Math.max(Math.min(c*(1-1/3.6*Math.exp((-a.la-42)/92)),1),0);a.dRgb=l.map(x=>Nx(1,u/x,p)),a.dRgbInv=a.dRgb.map(x=>1/x);const g=l.map((x,v)=>x*a.dRgb[v]),y=O6(g,a.fl);return a.aW=a.nbb*(2*y[0]+y[1]+.05*y[2]),a}const B4=M6(LZ,64/Math.PI*.2,20,"average",!1);function H_(r,t){if(!(r.J!==void 0^r.Q!==void 0))throw new Error("Conversion requires one and only one: 'J' or 'Q'");if(!(r.C!==void 0^r.M!==void 0^r.s!==void 0))throw new Error("Conversion requires one and only one: 'C', 'M' or 's'");if(!(r.h!==void 0^r.H!==void 0))throw new Error("Conversion requires one and only one: 'h' or 'H'");if(r.J===0||r.Q===0)return[0,0,0];let n=0;r.h!==void 0?n=Nu(r.h)*L4:n=jZ(r.H)*L4;const s=Math.cos(n),i=Math.sin(n);let a=0;r.J!==void 0?a=du(r.J,1/2)*.1:r.Q!==void 0&&(a=.25*t.c*r.Q/((t.aW+4)*t.flRoot));let o=0;r.C!==void 0?o=r.C/a:r.M!==void 0?o=r.M/t.flRoot/a:r.s!==void 0&&(o=4e-4*r.s**2*(t.aW+4)/t.c);const u=du(o*Math.pow(1.64-Math.pow(.29,t.n),-.73),10/9),l=.25*(Math.cos(n+2)+3.8),c=t.aW*du(a,2/t.c/t.z),h=5e4/13*t.nc*t.ncb*l,f=c/t.nbb,p=23*(f+.305)*_6(u,23*h+u*(11*s+108*i)),g=p*s,y=p*i,x=UZ(fs(PZ,[f,g,y]).map(v=>v*1/1403),t.fl);return fs(BZ,x.map((v,S)=>v*t.dRgbInv[S])).map(v=>v/100)}function L6(r,t){const n=r.map(E=>E*100),s=O6(fs(R6,n).map((E,_)=>E*t.dRgb[_]),t.fl),i=s[0]+(-12*s[1]+s[2])/11,a=(s[0]+s[1]-2*s[2])/9,o=(Math.atan2(a,i)%bC+bC)%bC,u=.25*(Math.cos(o+2)+3.8),l=5e4/13*t.nc*t.ncb*_6(u*Math.sqrt(i**2+a**2),s[0]+s[1]+1.05*s[2]+.305),c=du(l,.9)*Math.pow(1.64-Math.pow(.29,t.n),.73),h=t.nbb*(2*s[0]+s[1]+.05*s[2]),f=du(h/t.aW,.5*t.c*t.z),p=100*du(f,2),g=4/t.c*f*(t.aW+4)*t.flRoot,y=c*f,x=y*t.flRoot,v=Nu(o*zZ),S=GZ(v),w=50*du(t.c*c/(t.aW+4),1/2);return{J:p,C:y,h:v,s:w,Q:g,M:x,H:S}}new tn({id:"cam16-jmh",cssId:"--cam16-jmh",name:"CAM16-JMh",coords:{j:{refRange:[0,100],name:"J"},m:{refRange:[0,105],name:"Colorfulness"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:wl,fromBase(r){const t=L6(r,B4);return[t.J,t.M,t.h]},toBase(r){return H_({J:r[0],M:r[1],h:r[2]},B4)}});const WZ=pu.D65,HZ=216/24389,B6=24389/27;function qZ(r){return 116*(r>HZ?Math.cbrt(r):(B6*r+16)/116)-16}function q_(r){return r>8?Math.pow((r+16)/116,3):r/B6}function KZ(r,t){let[n,s,i]=r,a=[],o=0;if(i===0)return[0,0,0];let u=q_(i);i>0?o=.00379058511492914*i**2+.608983189401032*i+.9155088574762233:o=9514440756550361e-21*i**2+.08693057439788597*i-21.928975842194614;const l=2e-12,c=15;let h=0,f=1/0;for(;h<=c;){a=H_({J:o,C:s,h:n},t);const p=Math.abs(a[1]-u);if(p<f){if(p<=l)return a;f=p}o=o-(a[1]-u)*o/(2*a[1]),h+=1}return H_({J:o,C:s,h:n},t)}function XZ(r,t){const n=qZ(r[1]);if(n===0)return[0,0,0];const s=L6(r,iT);return[Nu(s.h),s.C,n]}const iT=M6(WZ,200/Math.PI*q_(50),q_(50)*100,"average",!1),$x=new tn({id:"hct",name:"HCT",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},c:{refRange:[0,145],name:"Colorfulness"},t:{refRange:[0,100],name:"Tone"}},base:wl,fromBase(r){return XZ(r)},toBase(r){return KZ(r,iT)},formats:{color:{id:"--hct",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),YZ=Math.PI/180,P4=[1,.007,.0228];function V4(r){r[1]<0&&(r=$x.fromBase($x.toBase(r)));const t=Math.log(Math.max(1+P4[2]*r[1]*iT.flRoot,1))/P4[2],n=r[0]*YZ,s=t*Math.cos(n),i=t*Math.sin(n);return[r[2],s,i]}function ZZ(r,t){[r,t]=rs([r,t]);let[n,s,i]=V4($x.from(r)),[a,o,u]=V4($x.from(t));return Math.sqrt((n-a)**2+(s-o)**2+(i-u)**2)}const z4={deltaE76:yZ,deltaECMC:bZ,deltaE2000:N6,deltaEJz:TZ,deltaEITP:MZ,deltaEOK:W_,deltaEHCT:ZZ};function QZ(r){const t=r?Math.floor(Math.log10(Math.abs(r))):0;return Math.max(parseFloat(`1e${t-2}`),1e-6)}const U4={hct:{method:"hct.c",jnd:2,deltaEMethod:"hct",blackWhiteClamp:{}},"hct-tonal":{method:"hct.c",jnd:0,deltaEMethod:"hct",blackWhiteClamp:{channel:"hct.t",min:0,max:100}}};function Yc(r,{method:t=Kc.gamut_mapping,space:n=void 0,deltaEMethod:s="",jnd:i=2,blackWhiteClamp:a={}}={}){if(r=rs(r),S6(arguments[1])?n=arguments[1]:n||(n=r.space),n=tn.get(n),Wf(r,n,{epsilon:0}))return r;let o;if(t==="css")o=JZ(r,{space:n});else{if(t!=="clip"&&!Wf(r,n)){Object.prototype.hasOwnProperty.call(U4,t)&&({method:t,jnd:i,deltaEMethod:s,blackWhiteClamp:a}=U4[t]);let u=N6;if(s!==""){for(let c in z4)if("deltae"+s.toLowerCase()===c.toLowerCase()){u=z4[c];break}}let l=Yc(bn(r,n),{method:"clip",space:n});if(u(r,l)>i){if(Object.keys(a).length===3){let w=tn.resolveCoord(a.channel),E=Ic(bn(r,w.space),w.id);if(G_(E)&&(E=0),E>=a.max)return bn({space:"xyz-d65",coords:pu.D65},r.space);if(E<=a.min)return bn({space:"xyz-d65",coords:[0,0,0]},r.space)}let c=tn.resolveCoord(t),h=c.space,f=c.id,p=bn(r,h);p.coords.forEach((w,E)=>{G_(w)&&(p.coords[E]=0)});let y=(c.range||c.refRange)[0],x=QZ(i),v=y,S=Ic(p,f);for(;S-v>x;){let w=qm(p);w=Yc(w,{space:n,method:"clip"}),u(p,w)-i<x?v=Ic(p,f):S=Ic(p,f),Hm(p,f,(v+S)/2)}o=bn(p,n)}else o=l}else o=bn(r,n);if(t==="clip"||!Wf(o,n,{epsilon:0})){let u=Object.values(n.coords).map(l=>l.range||[]);o.coords=o.coords.map((l,c)=>{let[h,f]=u[c];return h!==void 0&&(l=Math.max(h,l)),f!==void 0&&(l=Math.min(l,f)),l})}}return n!==r.space&&(o=bn(o,r.space)),r.coords=o.coords,r}Yc.returns="color";const G4={WHITE:{space:Xc,coords:[1,0,0]},BLACK:{space:Xc,coords:[0,0,0]}};function JZ(r,{space:t}={}){r=rs(r),t||(t=r.space),t=tn.get(t);const i=tn.get("oklch");if(t.isUnbounded)return bn(r,t);const a=bn(r,i);let o=a.coords[0];if(o>=1){const y=bn(G4.WHITE,t);return y.alpha=r.alpha,bn(y,t)}if(o<=0){const y=bn(G4.BLACK,t);return y.alpha=r.alpha,bn(y,t)}if(Wf(a,t,{epsilon:0}))return bn(a,t);function u(y){const x=bn(y,t),v=Object.values(t.coords);return x.coords=x.coords.map((S,w)=>{if("range"in v[w]){const[E,_]=v[w].range;return nZ(E,S,_)}return S}),x}let l=0,c=a.coords[1],h=!0,f=qm(a),p=u(f),g=W_(p,f);if(g<.02)return p;for(;c-l>1e-4;){const y=(l+c)/2;if(f.coords[1]=y,h&&Wf(f,t,{epsilon:0}))l=y;else if(p=u(f),g=W_(p,f),g<.02){if(.02-g<1e-4)break;h=!1,l=y}else c=y}return p}function bn(r,t,{inGamut:n}={}){r=rs(r),t=tn.get(t);let s=t.from(r),i={space:t,coords:s,alpha:r.alpha};return n&&(i=Yc(i,n===!0?void 0:n)),i}bn.returns="color";function eQ(r,{precision:t=Kc.precision,format:n="default",inGamut:s=!0,...i}={}){var l;let a;r=rs(r);let o=n;n=r.space.getFormat(n)??r.space.getFormat("default")??tn.DEFAULT_FORMAT;let u=r.coords.slice();if(s||(s=n.toGamut),s&&!Wf(r)&&(u=Yc(qm(r),s===!0?void 0:s).coords),n.type==="custom")if(i.precision=t,n.serialize)a=n.serialize(u,r.alpha,i);else throw new TypeError(`format ${o} can only be used to parse colors, not for serialization`);else{let c=n.name||"color";n.serializeCoords?u=n.serializeCoords(u,t):t!==null&&(u=u.map(g=>U_(g,{precision:t})));let h=[...u];if(c==="color"){let g=n.id||((l=n.ids)==null?void 0:l[0])||r.space.id;h.unshift(g)}let f=r.alpha;t!==null&&(f=U_(f,{precision:t}));let p=r.alpha>=1||n.noAlpha?"":`${n.commas?",":" /"} ${f}`;a=`${c}(${h.join(n.commas?", ":" ")}${p})`}return a}const tQ=[[.4865709486482162,.26566769316909306,.1982172852343625],[.2289745640697488,.6917385218365064,.079286914093745],[0,.04511338185890264,1.043944368900976]],nQ=[[2.493496911941425,-.9313836179191239,-.40271078445071684],[-.8294889695615747,1.7626640603183463,.023624685841943577],[.03584583024378447,-.07617238926804182,.9568845240076872]],rQ=new nv({id:"p3-linear",cssId:"--display-p3-linear",name:"Linear P3",white:"D65",toXYZ_M:tQ,fromXYZ_M:nQ}),sQ=[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],iQ=[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]],aQ=new nv({id:"srgb-linear",name:"Linear sRGB",white:"D65",toXYZ_M:sQ,fromXYZ_M:iQ}),j4={aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aqua:[0,1,1],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],black:[0,0,0],blanchedalmond:[1,235/255,205/255],blue:[0,0,1],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],fuchsia:[1,0,1],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],gray:[128/255,128/255,128/255],green:[0,128/255,0],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],lime:[0,1,0],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],maroon:[128/255,0,0],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],navy:[0,0,128/255],oldlace:[253/255,245/255,230/255],olive:[128/255,128/255,0],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],purple:[128/255,0,128/255],rebeccapurple:[102/255,51/255,153/255],red:[1,0,0],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],silver:[192/255,192/255,192/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],teal:[0,128/255,128/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],white:[1,1,1],whitesmoke:[245/255,245/255,245/255],yellow:[1,1,0],yellowgreen:[154/255,205/255,50/255]};let W4=Array(3).fill("<percentage> | <number>[0, 255]"),H4=Array(3).fill("<number>[0, 255]");const od=new nv({id:"srgb",name:"sRGB",base:aQ,fromBase:r=>r.map(t=>{let n=t<0?-1:1,s=t*n;return s>.0031308?n*(1.055*s**(1/2.4)-.055):12.92*t}),toBase:r=>r.map(t=>{let n=t<0?-1:1,s=t*n;return s<=.04045?t/12.92:n*((s+.055)/1.055)**2.4}),formats:{rgb:{coords:W4},rgb_number:{name:"rgb",commas:!0,coords:H4,noAlpha:!0},color:{},rgba:{coords:W4,commas:!0,lastAlpha:!0},rgba_number:{name:"rgba",commas:!0,coords:H4},hex:{type:"custom",toGamut:!0,test:r=>/^#([a-f0-9]{3,4}){1,2}$/i.test(r),parse(r){r.length<=5&&(r=r.replace(/[a-f0-9]/gi,"$&$&"));let t=[];return r.replace(/[a-f0-9]{2}/gi,n=>{t.push(parseInt(n,16)/255)}),{spaceId:"srgb",coords:t.slice(0,3),alpha:t.slice(3)[0]}},serialize:(r,t,{collapse:n=!0}={})=>{t<1&&r.push(t),r=r.map(a=>Math.round(a*255));let s=n&&r.every(a=>a%17===0);return"#"+r.map(a=>s?(a/17).toString(16):a.toString(16).padStart(2,"0")).join("")}},keyword:{type:"custom",test:r=>/^[a-z]+$/i.test(r),parse(r){r=r.toLowerCase();let t={spaceId:"srgb",coords:null,alpha:1};if(r==="transparent"?(t.coords=j4.black,t.alpha=0):t.coords=j4[r],t.coords)return t}}}}),q4=new nv({id:"p3",cssId:"display-p3",name:"P3",base:rQ,fromBase:od.fromBase,toBase:od.toBase});function P6(r,t,n={}){if(oQ(r)){let[l,c]=[r,t];return P6(...l.rangeArgs.colors,{...l.rangeArgs.options,...c})}let{space:s,outputSpace:i,progression:a,premultiplied:o}=n;r=rs(r),t=rs(t),r=qm(r),t=qm(t);let u={colors:[r,t],options:n};if(s?s=tn.get(s):s=tn.registry[Kc.interpolationSpace]||r.space,i=i?tn.get(i):s,r=bn(r,s),t=bn(t,s),r=Yc(r),t=Yc(t),s.coords.h&&s.coords.h.type==="angle"){let l=n.hue=n.hue||"shorter",c=[s,"h"],[h,f]=[Ic(r,c),Ic(t,c)];isNaN(h)&&!isNaN(f)?h=f:isNaN(f)&&!isNaN(h)&&(f=h),[h,f]=cZ(l,[h,f]),Hm(r,c,h),Hm(t,c,f)}return o&&(r.coords=r.coords.map(l=>l*r.alpha),t.coords=t.coords.map(l=>l*t.alpha)),Object.assign(l=>{l=a?a(l):l;let c=r.coords.map((p,g)=>{let y=t.coords[g];return Nx(p,y,l)}),h=Nx(r.alpha,t.alpha,l),f={space:s,coords:c,alpha:h};return o&&(f.coords=f.coords.map(p=>p/h)),i!==s&&(f=bn(f,i)),f},{rangeArgs:u})}function oQ(r){return jf(r)==="function"&&!!r.rangeArgs}Kc.interpolationSpace="lab";const K_=new tn({id:"hsl",name:"HSL",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:od,fromBase:r=>{let t=Math.max(...r),n=Math.min(...r),[s,i,a]=r,[o,u,l]=[NaN,0,(n+t)/2],c=t-n;if(c!==0){switch(u=l===0||l===1?0:(t-l)/Math.min(l,1-l),t){case s:o=(i-a)/c+(i<a?6:0);break;case i:o=(a-s)/c+2;break;case a:o=(s-i)/c+4}o=o*60}return u<0&&(o+=180,u=Math.abs(u)),o>=360&&(o-=360),[o,u*100,l*100]},toBase:r=>{let[t,n,s]=r;t=t%360,t<0&&(t+=360),n/=100,s/=100;function i(a){let o=(a+t/30)%12,u=n*Math.min(s,1-s);return s-u*Math.max(-1,Math.min(o-3,9-o,1))}return[i(0),i(8),i(4)]},formats:{hsl:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsla:{coords:["<number> | <angle>","<percentage>","<percentage>"],commas:!0,lastAlpha:!0}}}),uQ=new tn({id:"hsv",name:"HSV",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},v:{range:[0,100],name:"Value"}},base:K_,fromBase(r){let[t,n,s]=r;n/=100,s/=100;let i=s+n*Math.min(s,1-s);return[t,i===0?0:200*(1-s/i),100*i]},toBase(r){let[t,n,s]=r;n/=100,s/=100;let i=s*(1-n/2);return[t,i===0||i===1?0:(s-i)/Math.min(i,1-i)*100,i*100]},formats:{color:{id:"--hsv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),K4=new tn({id:"hwb",name:"HWB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},w:{range:[0,100],name:"Whiteness"},b:{range:[0,100],name:"Blackness"}},base:uQ,fromBase(r){let[t,n,s]=r;return[t,s*(100-n)/100,100-s]},toBase(r){let[t,n,s]=r;n/=100,s/=100;let i=n+s;if(i>=1){let u=n/i;return[t,0,u*100]}let a=1-s,o=a===0?0:1-n/a;return[t,o*100,a*100]},formats:{hwb:{coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),X4=new tn({id:"oklch",name:"Oklch",coords:{l:{refRange:[0,1],name:"Lightness"},c:{refRange:[0,.4],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},white:"D65",base:Xc,fromBase(r){let[t,n,s]=r,i;const a=2e-4;return Math.abs(n)<a&&Math.abs(s)<a?i=NaN:i=Math.atan2(s,n)*180/Math.PI,[t,Math.sqrt(n**2+s**2),Nu(i)]},toBase(r){let[t,n,s]=r,i,a;return isNaN(s)?(i=0,a=0):(i=n*Math.cos(s*Math.PI/180),a=n*Math.sin(s*Math.PI/180)),[t,i,a]},formats:{oklch:{coords:["<percentage> | <number>","<number> | <percentage>[0,1]","<number> | <angle>"]}}});var Y4=new tn({id:"hsb",name:"HSB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},b:{range:[0,100],name:"Brightness"}},base:od,fromBase:r=>{const t=Math.max(...r),n=t-Math.min(...r);let[s,i,a]=r,o,u;return n===0?(o=0,u=0):(u=n/t,s===t?o=(i-a)/n:i===t?o=2+(a-s)/n:a===t&&(o=4+(s-i)/n),o<0?o+=6:o>=6&&(o-=6)),[o/6*360,u*100,t*100]},toBase:Z4,formats:{default:{type:"custom",serialize:(r,t)=>{const n=Z4(r);let s=`rgb(${Math.round(n[0]*100*100)/100}% ${Math.round(n[1]*100*100)/100}% ${Math.round(n[2]*100*100)/100}%`;return t<1&&(s+=` / ${t}`),s+=")",s}},hsb:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsba:{coords:["<number> | <angle>","<percentage>","<percentage>"],commans:!0,lastAlpha:!0}}});function Z4(r){const t=r[0]/360*6,n=r[1]/100,s=r[2]/100;let i=[];if(n===0)i=[s,s,s];else{const a=Math.floor(t),o=s*(1-n),u=s*(1-n*(t-a)),l=s*(1-n*(1+a-t));let c,h,f;a===1?(c=u,h=s,f=o):a===2?(c=o,h=s,f=l):a===3?(c=o,h=u,f=s):a===4?(c=l,h=o,f=s):a===5?(c=s,h=o,f=u):(c=s,h=l,f=o),i=[c,h,f]}return i}const ir=(r,t,n,s,i,a)=>{let o=(r-t)/(n-t)*(i-s)+s;return a&&(o=Math.max(o,Math.min(s,i)),o=Math.min(o,Math.max(s,i))),o},Q4={};var sr,cl,PD,lQ;const Yt=class Yt{constructor(t,n,s,{clamp:i=!1}={}){Jn(this,PD);Bt(this,"_color");Bt(this,"mode");if(this.mode=n||dr,t instanceof Yt){const a=n?Yt.colorMap[n]:Yt.colorMap[t.mode];this._color=bn(t._color,a),this.mode=a}else if(typeof t=="object"&&!Array.isArray(t)&&t!==null){const a=n?Yt.colorMap[n]:t.spaceId;this._color=bn(t,a),this.mode=n||Object.entries(Yt.colorMap).find(([o,u])=>u===this._color.spaceId)}else if(typeof t[0]=="string")try{this._color=E6(t[0]);const[a]=Object.entries(Yt.colorMap).find(([o,u])=>u===this._color.spaceId);this.mode=a,this._color=bn(this._color,this._color.spaceId)}catch{throw new Error("Invalid color string")}else{let a;if(s)if(t.length===4)a=Yt.mapColorRange(t,this.mode,s,i);else if(t.length===3)a=Yt.mapColorRange([t[0],t[1],t[2]],this.mode,s,i),a.push(1);else if(t.length===2){dt(Yt,cl)[this.mode]?a=dt(Yt,cl)[this.mode](t[0],s,i):a=Yt.mapColorRange([t[0],t[0],t[0]],this.mode,s,i);const c=Array.isArray(s[s.length-1])?s[s.length-1]:[0,s[s.length-1]];a.push(ir(t[1],c[0],c[1],0,1,i))}else if(t.length===1)dt(Yt,cl)[this.mode]?a=dt(Yt,cl)[this.mode](t[0],s,i):a=Yt.mapColorRange([t[0],t[0],t[0]],this.mode,s,i),a.push(1);else throw new Error("Invalid color");else a=t;const o=Yt.colorMap[this.mode]||console.error("Invalid color mode"),u=a.slice(0,3),l={space:o,coords:u,alpha:a[3]};this._color=bn(l,o)}}static addColorMode(t,n){tn.register(n),Yt.colorMap[t]=n.id,dt(Yt,sr)[t]=Object.values(n.coords).reduce((s,i)=>(s.push(i.refRange||i.range),s),[]),dt(Yt,sr)[t].push([0,1]),dt(Yt,cl)[t]=n.fromGray}static mapColorRange(t,n,s,i){const a=s.map(u=>Array.isArray(u)?u:[0,u]),o=dt(Yt,sr)[n];return t.map((u,l)=>ir(u,a[l][0],a[l][1],o[l][0],o[l][1],i))}static unmapColorRange(t,n,s){const i=s.map(o=>Array.isArray(o)?o:[0,o]),a=dt(Yt,sr)[n];return t.map((o,u)=>ir(o,a[u][0],a[u][1],i[u][0],i[u][1]))}get _array(){return this._getRGBA()}array(){return this._array}lerp(t,n,s){let i=-1;for(;(i+1<this._color.space.path.length||i+1<t._color.space.path.length)&&this._color.space.path[i+1]===t._color.space.path[i+1];)i+=1;if(i===-1)throw new Error("Cannot lerp colors. No common color space found");const a=P6(this._color,t._color,{space:this._color.space.path[i].id})(n);return new Yt(a,s||this.mode)}toString(t){const n=`${this._color.space.id}-${this._color.coords.join(",")}-${this._color.alpha}-${t}`;let s=Q4[n];return s||(s=eQ(this._color,{format:t}),Q4[n]=s),s}setRed(t,n=[0,1]){Array.isArray(n)||(n=[0,n]);const s=dt(Yt,sr)[dr][0],i=ir(t,n[0],n[1],s[0],s[1]);if(this.mode===dr||this.mode===ui)this._color.coords[0]=i;else{const a=this._color.space.id,o=bn(this._color,"srgb");o.coords[0]=i,this._color=bn(o,a)}}setGreen(t,n=[0,1]){Array.isArray(n)||(n=[0,n]);const s=dt(Yt,sr)[dr][1],i=ir(t,n[0],n[1],s[0],s[1]);if(this.mode===dr||this.mode===ui)this._color.coords[1]=i;else{const a=this._color.space.id,o=bn(this._color,"srgb");o.coords[1]=i,this._color=bn(o,a)}}setBlue(t,n=[0,1]){Array.isArray(n)||(n=[0,n]);const s=dt(Yt,sr)[dr][2],i=ir(t,n[0],n[1],s[0],s[1]);if(this.mode===dr||this.mode===ui)this._color.coords[2]=i;else{const a=this._color.space.id,o=bn(this._color,"srgb");o.coords[2]=i,this._color=bn(o,a)}}setAlpha(t,n=[0,1]){Array.isArray(n)||(n=[0,n]);const s=dt(Yt,sr)[this.mode][3],i=ir(t,n[0],n[1],s[0],s[1]);this._color.alpha=i}_getRGBA(t=[1,1,1,1]){const n=dt(Yt,sr)[dr];let s=structuredClone(bn(this._color,"srgb").coords);s.push(this._color.alpha);const i=t.map(a=>Array.isArray(a)?a:[0,a]);return s=s.map((a,o)=>ir(a,n[o][0],n[o][1],i[o][0],i[o][1])),s}_getMode(){return this.mode}_getRed(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===dr||this.mode===ui){const n=dt(Yt,sr)[this.mode][0];return ir(this._color.coords[0],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[dr][0];return ir(bn(this._color,"srgb").coords[0],n[0],n[1],t[0],t[1])}}_getGreen(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===dr||this.mode===ui){const n=dt(Yt,sr)[this.mode][1];return ir(this._color.coords[1],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[dr][1];return ir(bn(this._color,"srgb").coords[1],n[0],n[1],t[0],t[1])}}_getBlue(t=[0,1]){if(Array.isArray(t)||(t=[0,t]),this.mode===dr||this.mode===ui){const n=dt(Yt,sr)[this.mode][2];return ir(this._color.coords[2],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[dr][2];return ir(bn(this._color,"srgb").coords[2],n[0],n[1],t[0],t[1])}}_getAlpha(t=[0,1]){Array.isArray(t)||(t=[0,t]);const n=dt(Yt,sr)[this.mode][3];return ir(this._color.alpha,n[0],n[1],t[0],t[1])}_getHue(t=[0,360]){if(Array.isArray(t)||(t=[0,t]),this.mode===Ca||this.mode===Ni){const n=dt(Yt,sr)[this.mode][0];return ir(this._color.coords[0],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[Ni][0];return ir(bn(this._color,"hsl").coords[0],n[0],n[1],t[0],t[1])}}_getSaturation(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===Ca||this.mode===Ni){const n=dt(Yt,sr)[this.mode][1];return ir(this._color.coords[1],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[Ni][1];return ir(bn(this._color,"hsl").coords[1],n[0],n[1],t[0],t[1])}}_getBrightness(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===Ca){const n=dt(Yt,sr)[this.mode][2];return ir(this._color.coords[2],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[Ca][2];return ir(bn(this._color,"hsb").coords[2],n[0],n[1],t[0],t[1])}}_getLightness(t=[0,100]){if(Array.isArray(t)||(t=[0,t]),this.mode===Ni){const n=dt(Yt,sr)[this.mode][2];return ir(this._color.coords[2],n[0],n[1],t[0],t[1])}else{const n=dt(Yt,sr)[Ni][2];return ir(bn(this._color,"hsl").coords[2],n[0],n[1],t[0],t[1])}}};sr=new WeakMap,cl=new WeakMap,PD=new WeakSet,lQ=function(t){return new Yt(this._color,t)},Bt(Yt,"colorMap",{}),Jn(Yt,sr,{}),Jn(Yt,cl,{});let pr=Yt;function V6(r,t,n){r.Color=pr,od.fromGray=q4.fromGray=function(s,i,a){const o=i.map(l=>Array.isArray(l)?l:[0,l]),u=ir(s,o[2][0],o[2][1],0,1,a);return[u,u,u]},Y4.fromGray=K_.fromGray=function(s,i,a){const o=i.map(l=>Array.isArray(l)?l:[0,l]);return[0,0,ir(s,o[2][0],o[2][1],0,100,a)]},K4.fromGray=function(s,i,a){const o=i.map(f=>Array.isArray(f)?f:[0,f]),u=Math.abs(o[1][0]-o[1][1])/2+Math.abs(o[2][0]-o[2][1])/2,l=ir(s,0,u,0,100);let c,h;return l<50?(h=l,c=100-l):l>=50&&(c=l,h=100-l),[0,c,h]},Ya.fromGray=ad.fromGray=Xc.fromGray=X4.fromGray=function(s,i,a){const o=i.map(l=>Array.isArray(l)?l:[0,l]);return[ir(s,o[0][0],o[0][1],0,100,a),0,0]},r.Color.addColorMode(dr,od),r.Color.addColorMode(ui,q4),r.Color.addColorMode(Ca,Y4),r.Color.addColorMode(Ni,K_),r.Color.addColorMode(Hf,K4),r.Color.addColorMode(Km,Ya),r.Color.addColorMode(qf,ad),r.Color.addColorMode(Xm,Xc),r.Color.addColorMode(Kf,X4),n.presetup=function(){const s=this,i=["Red","Green","Blue","Alpha"];for(let o in i){const u=i[o],l=r.Color.prototype["set"+u];r.Color.prototype["set"+u]=function(c,h){var f,p,g;return h=h||((g=(p=(f=s==null?void 0:s._renderer)==null?void 0:f.states)==null?void 0:p.colorMaxes)==null?void 0:g[dr][o]),l.call(this,c,h)}}function a(o,u){const l=r.Color.prototype["_get"+o];r.Color.prototype["_get"+o]=function(c){var h,f,p,g,y,x;if(Object.keys(u).includes(this.mode))c=c||((p=(f=(h=s==null?void 0:s._renderer)==null?void 0:h.states)==null?void 0:f.colorMaxes)==null?void 0:p[this.mode][u[this.mode]]);else{const v=Object.keys(u)[0];c=c||((x=(y=(g=s==null?void 0:s._renderer)==null?void 0:g.states)==null?void 0:y.colorMaxes)==null?void 0:x[v][u[v]])}return l.call(this,c)}}a("Red",{[dr]:0,[ui]:0}),a("Green",{[dr]:1,[ui]:1}),a("Blue",{[dr]:2,[ui]:2}),a("Alpha",{[dr]:3,[ui]:3,[Ca]:3,[Ni]:3,[Hf]:3,[Km]:3,[qf]:3,[Xm]:3,[Kf]:3}),a("Hue",{[Ni]:0,[Ca]:0,[Hf]:0,[qf]:2,[Kf]:2}),a("Saturation",{[Ni]:1,[Ca]:1}),a("Brightness",{[Ca]:2}),a("Lightness",{[Ni]:2})}}typeof p5<"u"&&V6(p5,p5.prototype);const dr="rgb",ui="rgbhdr",Ca="hsb",Ni="hsl",Hf="hwb",Km="lab",qf="lch",Xm="oklab",Kf="oklch",Xy="rgba";function aT(r,t){t.RGB=dr,t.RGBHDR=ui,t.HSB=Ca,t.HSL=Ni,t.HWB=Hf,t.LAB=Km,t.LCH=qf,t.OKLAB=Xm,t.OKLCH=Kf,t.RGBA=Xy,r.Renderer.states.colorMode=dr,r.Renderer.states.colorMaxes={[dr]:[255,255,255,255],[ui]:[255,255,255,255],[Ca]:[360,100,100,1],[Ni]:[360,100,100,1],[Hf]:[360,100,100,1],[Km]:[100,[-125,125],[-125,125],1],[qf]:[100,150,360,1],[Xm]:[100,[-125,125],[-125,125],1],[Kf]:[100,150,360,1],clone:function(){const n={...this};for(const s in n)n[s]instanceof Array&&(n[s]=[...n[s]]);return n}},t.color=function(...n){if(n[0]instanceof pr)return n[0];const s=Array.isArray(n[0])?n[0]:n;return new pr(s,this._renderer.states.colorMode,this._renderer.states.colorMaxes[this._renderer.states.colorMode],{clamp:!0})},t.red=function(n){return this.color(n)._getRed()},t.green=function(n){return this.color(n)._getGreen()},t.blue=function(n){return this.color(n)._getBlue()},t.alpha=function(n){return this.color(n)._getAlpha()},t.hue=function(n){return this.color(n)._getHue()},t.saturation=function(n){return this.color(n)._getSaturation()},t.brightness=function(n){return this.color(n)._getBrightness()},t.lightness=function(n){return this.color(n)._getLightness()},t.lerpColor=function(n,s,i){return n.lerp(s,i,this._renderer.states.colorMode)},t.paletteLerp=function(n,s){const i=n[0];if(s<i[1])return this.color(i[0]);for(let a=1;a<n.length;a++){const o=n[a];if(s<o[1]){const u=n[a-1];return this.lerpColor(this.color(u[0]),this.color(o[0]),(s-u[1])/(o[1]-u[1]))}}return this.color(n[n.length-1][0])}}typeof p5<"u"&&aT(p5,p5.prototype);class hl{constructor(t){if(t)this.DOM=t;else{const n=document.implementation.createDocument(null,"doc");this.DOM=n.createElement("root")}}getParent(){return new hl(this.DOM.parentElement)}getName(){return this.DOM.tagName}setName(t){const n=this.DOM.innerHTML,s=this.DOM.attributes,a=document.implementation.createDocument(null,"default").createElement(t);a.innerHTML=n;for(let o=0;o<s.length;o++)a.setAttribute(s[o].nodeName,s[o].nodeValue);this.DOM=a}hasChildren(){return this.DOM.children.length>0}listChildren(){const t=[];for(let n=0;n<this.DOM.childNodes.length;n++)t.push(this.DOM.childNodes[n].nodeName);return t}getChildren(t){return J4(t?this.DOM.getElementsByTagName(t):this.DOM.children)}getChild(t){if(typeof t=="string"){for(const n of this.DOM.children)if(n.tagName===t)return new hl(n)}else return new hl(this.DOM.children[t])}addChild(t){t instanceof hl&&this.DOM.appendChild(t.DOM)}removeChild(t){let n=-1;if(typeof t=="string"){for(let s=0;s<this.DOM.children.length;s++)if(this.DOM.children[s].tagName===t){n=s;break}}else n=t;n!==-1&&this.DOM.removeChild(this.DOM.children[n])}getAttributeCount(){return this.DOM.attributes.length}listAttributes(){const t=[];for(const n of this.DOM.attributes)t.push(n.nodeName);return t}hasAttribute(t){const n={};for(const s of this.DOM.attributes)n[s.nodeName]=s.nodeValue;return!!n[t]}getNum(t,n){const s={};for(const i of this.DOM.attributes)s[i.nodeName]=i.nodeValue;return Number(s[t])||n||0}getString(t,n){const s={};for(const i of this.DOM.attributes)s[i.nodeName]=i.nodeValue;return s[t]?String(s[t]):n||null}setAttribute(t,n){this.DOM.setAttribute(t,n)}getContent(t){let n;return n=this.DOM.textContent,n=n.replace(/\s\s+/g,","),n||t||null}setContent(t){this.DOM.children.length||(this.DOM.textContent=t)}serialize(){return new XMLSerializer().serializeToString(this.DOM)}}function J4(r){const t=[];for(let n=0;n<r.length;n++)t.push(new hl(r[n]));return t}function z6(r,t){r.XML=hl}typeof p5<"u"&&z6(p5,p5.prototype);class fl{constructor(t,n){this.file=t,this._pInst=n;const s=t.type.split("/");this.type=s[0],this.subtype=s[1],this.name=t.name,this.size=t.size,this.data=void 0}static _createLoader(t,n){const s=new FileReader;return s.onload=function(i){const a=new fl(t);if(a.file.type==="application/json")a.data=JSON.parse(i.target.result);else if(a.file.type==="text/xml"){const u=new DOMParser().parseFromString(i.target.result,"text/xml");a.data=new hl(u.documentElement)}else a.data=i.target.result;n(a)},s}static _load(t,n){if(/^text\//.test(t.type)||t.type==="application/json")fl._createLoader(t,n).readAsText(t);else if(!/^(video|audio)\//.test(t.type))fl._createLoader(t,n).readAsDataURL(t);else{const s=new fl(t);s.data=URL.createObjectURL(t),n(s)}}}function U6(r,t){r.File=fl}typeof p5<"u"&&U6(p5,p5.prototype);class vn{constructor(t,n){Bt(this,"width");Bt(this,"height");Bt(this,"elt");this.elt=t,this._pInst=this._pixelsState=n,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight}remove(){if(this.stop){this.stop();const n=this.elt.srcObject;n!==null&&n.getTracks().forEach(i=>{i.stop()})}const t=this._pInst._elements.indexOf(this);t!==-1&&this._pInst._elements.splice(t,1);for(let n in this._events)this.elt.removeEventListener(n,this._events[n]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)}parent(t){return typeof t>"u"?this.elt.parentNode:(typeof t=="string"?(t[0]==="#"&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof vn&&(t=t.elt),t.appendChild(this.elt),this)}child(t){return typeof t>"u"?this.elt.childNodes:(typeof t=="string"?(t[0]==="#"&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof vn&&(t=t.elt),t instanceof HTMLElement&&this.elt.appendChild(t),this)}html(...t){return t.length===0?this.elt.innerHTML:t[1]?(this.elt.insertAdjacentHTML("beforeend",t[0]),this):(this.elt.innerHTML=t[0],this)}id(t){return typeof t>"u"?this.elt.id:(this.elt.id=t,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)}class(t){return typeof t>"u"?this.elt.className:(this.elt.className=t,this)}addClass(t){return this.elt.className?this.hasClass(t)||(this.elt.className=this.elt.className+" "+t):this.elt.className=t,this}removeClass(t){return this.elt.classList.remove(t),this}hasClass(t){return this.elt.classList.contains(t)}toggleClass(t){return this.elt.classList.contains(t)?this.elt.classList.remove(t):this.elt.classList.add(t),this}center(t){const n=this.elt.style.display,s=this.elt.style.display==="none",i=this.parent().style.display==="none",a={x:this.elt.offsetLeft,y:this.elt.offsetTop};s&&this.show(),i&&this.parent().show(),this.elt.style.display="block",this.position(0,0);const o=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth),u=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return t==="both"||t===void 0?this.position(o/2+this.parent().offsetLeft,u/2+this.parent().offsetTop):t==="horizontal"?this.position(o/2+this.parent().offsetLeft,a.y):t==="vertical"&&this.position(a.x,u/2+this.parent().offsetTop),this.style("display",n),s&&this.hide(),i&&this.parent().hide(),this}position(...t){if(t.length===0)return{x:this.elt.offsetLeft,y:this.elt.offsetTop};{let n="absolute";return(t[2]==="static"||t[2]==="fixed"||t[2]==="relative"||t[2]==="sticky"||t[2]==="initial"||t[2]==="inherit")&&(n=t[2]),this.elt.style.position=n,this.elt.style.left=t[0]+"px",this.elt.style.top=t[1]+"px",this.x=t[0],this.y=t[1],this}}show(){return this.elt.style.display="block",this}hide(){return this.elt.style.display="none",this}size(t,n){if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};{let s=t,i=n;const a=o6;if(s!==a||i!==a){if(s===a?s=n*this.width/this.height:i===a&&(i=t*this.height/this.width),this.elt instanceof HTMLCanvasElement){const o={},u=this.elt.getContext("2d");let l;for(l in u)o[l]=u[l];this.elt.setAttribute("width",s*this._pInst._pixelDensity),this.elt.setAttribute("height",i*this._pInst._pixelDensity),this.elt.style.width=s+"px",this.elt.style.height=i+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(l in o)this.elt.getContext("2d")[l]=o[l]}else this.elt.style.width=s+"px",this.elt.style.height=i+"px",this.elt.width=s,this.elt.height=i;this.width=s,this.height=i,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst.width=s,this._pInst.height=i)}return this}}style(t,n){const s=this;if(n instanceof pr&&(n=n.toString()),typeof n>"u"){if(t.indexOf(":")===-1)return window.getComputedStyle(s.elt).getPropertyValue(t);{const i=t.split(";");for(let a=0;a<i.length;a++){const o=i[a].split(":");o[0]&&o[1]&&(this.elt.style[o[0].trim()]=o[1].trim())}}}else if(this.elt.style[t]=n,t==="width"||t==="height"||t==="left"||t==="top"){let o=window.getComputedStyle(s.elt).getPropertyValue(t).replace(/[^\d.]/g,"");this[t]=Math.round(parseFloat(o,10))}return this}_translate(...t){this.elt.style.position="absolute";let n="";return this.elt.style.transform&&(n=this.elt.style.transform.replace(/translate3d\(.*\)/g,""),n=n.replace(/translate[X-Z]?\(.*\)/g,"")),t.length===2?this.elt.style.transform="translate("+t[0]+"px, "+t[1]+"px)":t.length>2&&(this.elt.style.transform="translate3d("+t[0]+"px,"+t[1]+"px,"+t[2]+"px)",t.length===3?this.elt.parentElement.style.perspective="1000px":this.elt.parentElement.style.perspective=t[3]+"px"),this.elt.style.transform+=n,this}_rotate(...t){let n="";return this.elt.style.transform&&(n=this.elt.style.transform.replace(/rotate3d\(.*\)/g,""),n=n.replace(/rotate[X-Z]?\(.*\)/g,"")),t.length===1?this.elt.style.transform="rotate("+t[0]+"deg)":t.length===2?this.elt.style.transform="rotate("+t[0]+"deg, "+t[1]+"deg)":t.length===3&&(this.elt.style.transform="rotateX("+t[0]+"deg)",this.elt.style.transform+="rotateY("+t[1]+"deg)",this.elt.style.transform+="rotateZ("+t[2]+"deg)"),this.elt.style.transform+=n,this}attribute(t,n){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio")){if(typeof n>"u")return this.elt.firstChild.getAttribute(t);for(let s=0;s<this.elt.childNodes.length;s++)this.elt.childNodes[s].setAttribute(t,n)}else return typeof n>"u"?this.elt.getAttribute(t):(this.elt.setAttribute(t,n),this)}removeAttribute(t){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(let n=0;n<this.elt.childNodes.length;n++)this.elt.childNodes[n].removeAttribute(t);return this.elt.removeAttribute(t),this}value(...t){return t.length>0?(this.elt.value=t[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value}mousePressed(t){const n=function(s){return this._pInst.mouseIsPressed=!0,this._pInst._activePointers.set(s.pointerId,s),this._pInst._setMouseButton(s),this._pInst._updatePointerCoords(s),t.call(this,s)};return vn._adjustListener("pointerdown",n,this),this}doubleClicked(t){return vn._adjustListener("dblclick",t,this),this}mouseWheel(t){return vn._adjustListener("wheel",t,this),this}mouseReleased(t){return vn._adjustListener("pointerup",t,this),this}mouseClicked(t){return vn._adjustListener("click",t,this),this}mouseMoved(t){return vn._adjustListener("pointermove",t,this),this}mouseOver(t){return vn._adjustListener("pointerover",t,this),this}mouseOut(t){return vn._adjustListener("pointerout",t,this),this}dragOver(t){return vn._adjustListener("dragover",t,this),this}dragLeave(t){return vn._adjustListener("dragleave",t,this),this}changed(t){return vn._adjustListener("change",t,this),this}input(t){return vn._adjustListener("input",t,this),this}drop(t,n){if(window.File&&window.FileReader&&window.FileList&&window.Blob){if(!this._dragDisabled){this._dragDisabled=!0;const s=function(i){i.preventDefault()};this.elt.addEventListener("dragover",s),this.elt.addEventListener("dragleave",s)}vn._attachListener("drop",function(s){s.preventDefault(),typeof n=="function"&&n.call(this,s);const i=s.dataTransfer.files;for(const a of i)fl._load(a,t)},this)}else console.log("The File APIs are not fully supported in this browser.");return this}draggable(t){let n="ontouchstart"in window,s=0,i=0,a=0,o=0,u,l=n?"touchstart":"mousedown",c=n?"touchend":"mouseup",h=n?"touchmove":"mousemove";t===void 0?(t=this.elt,u=t):t!==this.elt&&t.elt!==this.elt&&(t=t.elt,u=this.elt),u.addEventListener(l,f,!1),u.style.cursor="move";function f(y){if(y=y||window.event,n){const x=y.changedTouches;a=parseInt(x[0].clientX),o=parseInt(x[0].clientY)}else a=parseInt(y.clientX),o=parseInt(y.clientY);return document.addEventListener(c,g,!1),document.addEventListener(h,p,!1),!1}function p(y){if(y=y||window.event,n){const x=y.changedTouches;s=a-parseInt(x[0].clientX),i=o-parseInt(x[0].clientY),a=parseInt(x[0].clientX),o=parseInt(x[0].clientY)}else s=a-parseInt(y.clientX),i=o-parseInt(y.clientY),a=parseInt(y.clientX),o=parseInt(y.clientY);t.style.left=t.offsetLeft-s+"px",t.style.top=t.offsetTop-i+"px"}function g(){document.removeEventListener(c,g,!1),document.removeEventListener(h,p,!1)}return this}static _adjustListener(t,n,s){return n===!1?vn._detachListener(t,s):vn._attachListener(t,n,s),this}static _attachListener(t,n,s){s._events[t]&&vn._detachListener(t,s);const i=n.bind(s);s.elt.addEventListener(t,i,!1),s._events[t]=i}static _detachListener(t,n){const s=n._events[t];n.elt.removeEventListener(t,s,!1),n._events[t]=null}}function G6(r,t){r.Element=vn}typeof p5<"u"&&G6(p5,p5.prototype);const Gn={_toPixels(r){if(r instanceof ImageData)return r.data;if(r.getContext("2d"))return r.getContext("2d").getImageData(0,0,r.width,r.height).data;if(r.getContext("webgl")){const t=r.getContext("webgl"),n=t.drawingBufferWidth*t.drawingBufferHeight*4,s=new Uint8Array(n);return t.readPixels(0,0,r.width,r.height,t.RGBA,t.UNSIGNED_BYTE,s),s}},_getARGB(r,t){const n=t*4;return r[n+3]<<24&4278190080|r[n]<<16&16711680|r[n+1]<<8&65280|r[n+2]&255},_setPixels(r,t){let n=0;for(let s=0,i=r.length;s<i;s++)n=s*4,r[n+0]=(t[s]&16711680)>>>16,r[n+1]=(t[s]&65280)>>>8,r[n+2]=t[s]&255,r[n+3]=(t[s]&4278190080)>>>24},_toImageData(r){return r instanceof ImageData?r:r.getContext("2d").getImageData(0,0,r.width,r.height)},_createImageData(r,t){return Gn._tmpCanvas=document.createElement("canvas"),Gn._tmpCtx=Gn._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(r,t)},apply(r,t,n){const s=r.getContext("2d"),i=s.getImageData(0,0,r.width,r.height),a=t(i,n);a instanceof ImageData?s.putImageData(a,0,0,0,0,r.width,r.height):s.putImageData(i,0,0,0,0,r.width,r.height)},threshold(r,t=.5){const n=Gn._toPixels(r),s=Math.floor(t*255);for(let i=0;i<n.length;i+=4){const a=n[i],o=n[i+1],u=n[i+2],l=.2126*a+.7152*o+.0722*u;let c;l>=s?c=255:c=0,n[i]=n[i+1]=n[i+2]=c}},gray(r){const t=Gn._toPixels(r);for(let n=0;n<t.length;n+=4){const s=t[n],i=t[n+1],a=t[n+2],o=.2126*s+.7152*i+.0722*a;t[n]=t[n+1]=t[n+2]=o}},opaque(r){const t=Gn._toPixels(r);for(let n=0;n<t.length;n+=4)t[n+3]=255;return t},invert(r){const t=Gn._toPixels(r);for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]},posterize(r,t=4){const n=Gn._toPixels(r);if(t<2||t>255)throw new Error("Level must be greater than 2 and less than 255 for posterize");const s=t-1;for(let i=0;i<n.length;i+=4){const a=n[i],o=n[i+1],u=n[i+2];n[i]=(a*t>>8)*255/s,n[i+1]=(o*t>>8)*255/s,n[i+2]=(u*t>>8)*255/s}},dilate(r){const t=Gn._toPixels(r);let n=0;const s=t.length?t.length/4:0,i=new Int32Array(s);let a,o,u,l,c,h,f,p,g,y,x,v,S,w,E,_,D;for(;n<s;)for(a=n,o=n+r.width;n<o;)u=l=Gn._getARGB(t,n),f=n-1,h=n+1,p=n-r.width,g=n+r.width,f<a&&(f=n),h>=o&&(h=n),p<0&&(p=0),g>=s&&(g=n),v=Gn._getARGB(t,p),x=Gn._getARGB(t,f),S=Gn._getARGB(t,g),y=Gn._getARGB(t,h),c=77*(u>>16&255)+151*(u>>8&255)+28*(u&255),E=77*(x>>16&255)+151*(x>>8&255)+28*(x&255),w=77*(y>>16&255)+151*(y>>8&255)+28*(y&255),_=77*(v>>16&255)+151*(v>>8&255)+28*(v&255),D=77*(S>>16&255)+151*(S>>8&255)+28*(S&255),E>c&&(l=x,c=E),w>c&&(l=y,c=w),_>c&&(l=v,c=_),D>c&&(l=S,c=D),i[n++]=l;Gn._setPixels(t,i)},erode(r){const t=Gn._toPixels(r);let n=0;const s=t.length?t.length/4:0,i=new Int32Array(s);let a,o,u,l,c,h,f,p,g,y,x,v,S,w,E,_,D;for(;n<s;)for(a=n,o=n+r.width;n<o;)u=l=Gn._getARGB(t,n),f=n-1,h=n+1,p=n-r.width,g=n+r.width,f<a&&(f=n),h>=o&&(h=n),p<0&&(p=0),g>=s&&(g=n),v=Gn._getARGB(t,p),x=Gn._getARGB(t,f),S=Gn._getARGB(t,g),y=Gn._getARGB(t,h),c=77*(u>>16&255)+151*(u>>8&255)+28*(u&255),E=77*(x>>16&255)+151*(x>>8&255)+28*(x&255),w=77*(y>>16&255)+151*(y>>8&255)+28*(y&255),_=77*(v>>16&255)+151*(v>>8&255)+28*(v&255),D=77*(S>>16&255)+151*(S>>8&255)+28*(S&255),E<c&&(l=x,c=E),w<c&&(l=y,c=w),_<c&&(l=v,c=_),D<c&&(l=S,c=D),i[n++]=l;Gn._setPixels(t,i)},blur(r,t){hQ(r,t)}};let Am,Lf,Bf,Dc;function cQ(r){let t=r*3.5|0;if(t=t<1?1:t<248?t:248,Am!==t){Am=t,Lf=1+Am<<1,Bf=new Int32Array(Lf),Dc=new Array(Lf);for(let o=0;o<Lf;o++)Dc[o]=new Int32Array(256);let n,s,i,a;for(let o=1,u=t-1;o<t;o++){Bf[t+o]=Bf[u]=s=u*u,i=Dc[t+o],a=Dc[u--];for(let l=0;l<256;l++)i[l]=a[l]=s*l}n=Bf[t]=t*t,i=Dc[t];for(let o=0;o<256;o++)i[o]=n*o}}function hQ(r,t){const n=Gn._toPixels(r),s=r.width,i=r.height,a=s*i,o=new Int32Array(a);for(let F=0;F<a;F++)o[F]=Gn._getARGB(n,F);let u,l,c,h,f,p,g,y,x,v;const S=new Int32Array(a),w=new Int32Array(a),E=new Int32Array(a),_=new Int32Array(a);let D=0;cQ(t);let I,k,A,N;for(k=0;k<i;k++){for(I=0;I<s;I++){if(h=c=l=f=u=0,p=I-Am,p<0)v=-p,p=0;else{if(p>=s)break;v=0}for(A=v;A<Lf&&!(p>=s);A++){const F=o[p+D];N=Dc[A],f+=N[(F&-16777216)>>>24],l+=N[(F&16711680)>>16],c+=N[(F&65280)>>8],h+=N[F&255],u+=Bf[A],p++}g=D+I,S[g]=f/u,w[g]=l/u,E[g]=c/u,_[g]=h/u}D+=s}for(D=0,y=-Am,x=y*s,k=0;k<i;k++){for(I=0;I<s;I++){if(h=c=l=f=u=0,y<0)v=g=-y,p=I;else{if(y>=i)break;v=0,g=y,p=I+x}for(A=v;A<Lf&&!(g>=i);A++)N=Dc[A],f+=N[S[p]],l+=N[w[p]],c+=N[E[p]],h+=N[_[p]],u+=Bf[A],g++,p+=s;o[I+D]=f/u<<24|l/u<<16|c/u<<8|h/u}D+=s,x+=s,y++}Gn._setPixels(n,o)}function j6(r){let t=0;for(let n=1;n<r.length;n++)t+=r[n-1].position.dist(r[n].position);return t}class W6{constructor(t){for(const[n,s]of Object.entries(t))this[n]=s}}class Ia{constructor(...t){Bt(this,"vertices");Bt(this,"_shape",null);Bt(this,"_primitivesIndex",null);Bt(this,"_contoursIndex",null);Bt(this,"isClosing",!1);if(this.constructor===Ia)throw new Error("ShapePrimitive is an abstract class: it cannot be instantiated.");if(t.length>0)this.vertices=t;else throw new Error("At least one vertex must be passed to the constructor.")}get vertexCount(){return this.vertices.length}get vertexCapacity(){throw new Error("Getter vertexCapacity must be implemented.")}get _firstInterpolatedVertex(){return this.startVertex()}get canOverrideAnchor(){return!1}accept(t){throw new Error("Method accept() must be implemented.")}addToShape(t){let n=t.at(-1);if(n.primitives.length===0)n.primitives.push(this);else{let i=t.at(-1,-1),a=i instanceof this.constructor,o=i.vertexCapacity-i.vertexCount,u,l;a&&o>0?(u=this.vertices.splice(0,o),l=this.vertices,i.vertices.push(...u),l.length>0&&n.primitives.push(this)):n.primitives.push(this)}if(this.vertices.length>0){let i=t.at(-1);this._primitivesIndex=i.primitives.length-1,this._contoursIndex=t.contours.length-1,this._shape=t}return t.at(-1,-1)}get _nextPrimitive(){return this._belongsToShape?this._shape.at(this._contoursIndex,this._primitivesIndex+1):null}get _belongsToShape(){return this._shape!==null}handlesClose(){return!1}close(t){throw new Error("Unimplemented!")}}var nd;class H6{constructor(t=Ja){Jn(this,nd);Bt(this,"primitives");Hs(this,nd,t),this.primitives=[]}get kind(){const t=this.primitives.length===0,n=dt(this,nd)===Ja;return t&&n?Uf:dt(this,nd)}accept(t){for(const n of this.primitives)n.accept(t)}}nd=new WeakMap;var Rb;class Yy extends Ia{constructor(){super(...arguments);Jn(this,Rb,1)}get vertexCapacity(){return dt(this,Rb)}accept(n){n.visitAnchor(this)}getEndVertex(){return this.vertices[0]}}Rb=new WeakMap;class Zc extends Ia{constructor(...t){if(super(...t),this.constructor===Zc)throw new Error("Segment is an abstract class: it cannot be instantiated.")}get _previousPrimitive(){return this._belongsToShape?this._shape.at(this._contoursIndex,this._primitivesIndex-1):null}getStartVertex(){return this._previousPrimitive.getEndVertex()}getEndVertex(){return this.vertices.at(-1)}}var Ob;class q6 extends Zc{constructor(){super(...arguments);Jn(this,Ob,1)}get vertexCapacity(){return dt(this,Ob)}accept(n){n.visitLineSegment(this)}}Ob=new WeakMap;var Cg,_g,rd;class K6 extends Zc{constructor(n,...s){super(...s);Jn(this,Cg);Jn(this,_g);Jn(this,rd);let i=Array.isArray(n)?n[0]:n;Hs(this,Cg,i),Hs(this,_g,i)}get order(){return dt(this,Cg)}get vertexCapacity(){return dt(this,_g)}hullLength(){return dt(this,rd)===void 0&&Hs(this,rd,j6([this.getStartVertex(),...this.vertices])),dt(this,rd)}accept(n){n.visitBezierSegment(this)}}Cg=new WeakMap,_g=new WeakMap,rd=new WeakMap;var Mb;class X6 extends Zc{constructor(){super(...arguments);Jn(this,Mb,1/0);Bt(this,"_splineProperties",{ends:Gf,tightness:0})}get vertexCapacity(){return dt(this,Mb)}accept(n){n.visitSplineSegment(this)}get _comesAfterSegment(){return this._previousPrimitive instanceof Zc}get canOverrideAnchor(){return this._splineProperties.ends===Mf}get _firstInterpolatedVertex(){return this._splineProperties.ends===Mf?this._comesAfterSegment?this.vertices[1]:this.vertices[0]:this.getStartVertex()}get _chainedToSegment(){if(this._belongsToShape&&this._comesAfterSegment){let n=this._firstInterpolatedVertex.position;return this.getStartVertex().position.equals(n)}else return!1}addToShape(n){const s=super.addToShape(n);if(this._splineProperties.ends=n._splineProperties.ends,this._splineProperties.tightness=n._splineProperties.tightness,this._splineProperties.ends!==Mf)return s;let i=!this._belongsToShape,a=n.at(-1,-1),o=(u,l)=>`Spline does not start where previous path segment ends:
      second spline vertex at (${u})
      expected to be at (${l}).`;if(i&&a.vertices.length===2&&a._comesAfterSegment&&!a._chainedToSegment){let u=a._firstInterpolatedVertex.position,l=a.getStartVertex().position;console.warn(o(u.array(),l.array()))}return s}getEndVertex(){return this._splineProperties.ends===Gf?super.getEndVertex():this._splineProperties.ends===Mf?this.vertices.at(-2):this.getStartVertex()}getControlPoints(){let n=[];this._comesAfterSegment&&n.push(this.getStartVertex()),n.push(this.getStartVertex());for(const i of this.vertices)n.push(i);const s=this.getStartVertex();return this._splineProperties.ends===Gf?(n.unshift(s),n.push(this.vertices.at(-1))):this._splineProperties.ends===z_&&(n.unshift(this.vertices.at(-1)),n.push(s,this.vertices.at(0))),n}handlesClose(){return this._belongsToShape?this._shape.at(this._contoursIndex).primitives.length===2&&this._primitivesIndex===1:!1}close(){this._splineProperties.ends=z_}}Mb=new WeakMap;var Lb;class Y6 extends Ia{constructor(){super(...arguments);Jn(this,Lb,1)}get vertexCapacity(){return dt(this,Lb)}accept(n){n.visitPoint(this)}}Lb=new WeakMap;var Bb;class Z6 extends Ia{constructor(){super(...arguments);Jn(this,Bb,2)}get vertexCapacity(){return dt(this,Bb)}accept(n){n.visitLine(this)}}Bb=new WeakMap;var Pb;class Q6 extends Ia{constructor(){super(...arguments);Jn(this,Pb,3)}get vertexCapacity(){return dt(this,Pb)}accept(n){n.visitTriangle(this)}}Pb=new WeakMap;var Vb;class J6 extends Ia{constructor(){super(...arguments);Jn(this,Vb,4)}get vertexCapacity(){return dt(this,Vb)}accept(n){n.visitQuad(this)}}Vb=new WeakMap;var zb;class e8 extends Ia{constructor(){super(...arguments);Jn(this,zb,1/0)}get vertexCapacity(){return dt(this,zb)}accept(n){n.visitTriangleFan(this)}}zb=new WeakMap;var Ub;class t8 extends Ia{constructor(){super(...arguments);Jn(this,Ub,1/0)}get vertexCapacity(){return dt(this,Ub)}accept(n){n.visitTriangleStrip(this)}}Ub=new WeakMap;var Gb;class n8 extends Ia{constructor(){super(...arguments);Jn(this,Gb,1/0)}get vertexCapacity(){return dt(this,Gb)}accept(n){n.visitQuadStrip(this)}}Gb=new WeakMap;class fQ{constructor(){Bt(this,"creators");let t=new Map;t.set(`vertex-${Uf}`,(...n)=>new Yy(...n)),t.set(`vertex-${Ja}`,(...n)=>new q6(...n)),t.set(`vertex-${_x}`,(...n)=>new Y6(...n)),t.set(`vertex-${sd}`,(...n)=>new Z6(...n)),t.set(`vertex-${zf}`,(...n)=>new Q6(...n)),t.set(`vertex-${Nm}`,(...n)=>new J6(...n)),t.set(`vertex-${Wb}`,(...n)=>new e8(...n)),t.set(`vertex-${zm}`,(...n)=>new t8(...n)),t.set(`vertex-${Um}`,(...n)=>new n8(...n)),t.set(`bezierVertex-${Uf}`,(n,...s)=>new Yy(...s)),t.set(`bezierVertex-${Ja}`,(n,...s)=>new K6(n,...s)),t.set(`splineVertex-${Uf}`,(...n)=>new Yy(...n)),t.set(`splineVertex-${Ja}`,(...n)=>new X6(...n)),this.creators=t}get(t,n){const s=`${t}-${n}`;return this.creators.get(s)}set(t,n,s){const i=`${t}-${n}`;this.creators.set(i,s)}clear(){this.creators.clear()}}var us,Eg,Dg,Tg,Qa,s8,i8,dm;class r8{constructor(t,n=new fQ){Jn(this,Qa);Jn(this,us);Jn(this,Eg);Jn(this,Dg);Jn(this,Tg,3);Bt(this,"kind",null);Bt(this,"contours",[]);Bt(this,"_splineProperties",{tightness:0,ends:Gf});Bt(this,"userVertexProperties",null);Hs(this,Eg,t),Hs(this,us,t),Hs(this,Dg,n);for(const s in dt(this,us))s!=="position"&&s!=="textureCoordinates"&&(this[s]=function(i){dt(this,us)[s]=i})}serializeToArray(t){if(t==null)return[];if(t instanceof Number)return[t];if(t instanceof Array)return t;if(t.array instanceof Function)return t.array();throw new Error(`Can't convert ${t} to array!`)}vertexToArray(t){const n=[];for(const s in dt(this,us)){if(this.userVertexProperties&&s in this.userVertexProperties)continue;const i=t[s];n.push(...this.serializeToArray(i))}for(const s in this.userVertexProperties)s in t?n.push(...this.serializeToArray(t[s])):n.push(...new Array(this.userVertexProperties[s]).fill(0));return n}hydrateValue(t,n){if(n===null)return null;if(n instanceof Number)return t.shift();if(n instanceof Array){const s=[];for(let i=0;i<n.length;i++)s.push(t.shift());return s}else{if(n instanceof Ee)return new Ee(t.shift(),t.shift(),t.shift());if(n instanceof pr){const s=[t.shift(),t.shift(),t.shift(),t.shift()];return new pr(s)}}}arrayToVertex(t){const n={},s=[...t];for(const i in dt(this,us)){if(this.userVertexProperties&&i in this.userVertexProperties)continue;const a=dt(this,us)[i];n[i]=this.hydrateValue(s,a)}for(const i in this.userVertexProperties){const a=dt(this,us)[i];n[i]=this.hydrateValue(s,a)}return n}arrayScale(t,n){return t.map(s=>s*n)}arraySum(t,...n){return t.map((s,i)=>{let a=s;for(let o=0;o<n.length;o++)a+=n[o][i];return a})}arrayMinus(t,n){return t.map((s,i)=>s-n[i])}evaluateCubicBezier([t,n,s,i],a){return this.arraySum(this.arrayScale(t,Math.pow(1-a,3)),this.arrayScale(n,3*Math.pow(1-a,2)*a),this.arrayScale(s,3*(1-a)*Math.pow(a,2)),this.arrayScale(i,Math.pow(a,3)))}evaluateQuadraticBezier([t,n,s],i){return this.arraySum(this.arrayScale(t,Math.pow(1-i,2)),this.arrayScale(n,2*(1-i)*i),this.arrayScale(s,i*i))}catmullRomToBezier(t,n){let s=1-n,i=[];for(let a=0;a+3<t.length;a++){const[o,u,l,c]=t.slice(a,a+4),h=this.arraySum(u,this.arrayScale(this.arrayMinus(l,o),s/6)),f=this.arraySum(l,this.arrayScale(this.arrayMinus(u,c),s/6)),p=l;i.push([h,f,p])}return i}at(t,n,s){let i,a;switch(i=this.contours.at(t),arguments.length){case 1:return i;case 2:return i.primitives.at(n);case 3:return a=i.primitives.at(n),a.vertices.at(s)}}reset(){Hs(this,us,{...dt(this,Eg)}),this.kind=null,this.contours=[],this.userVertexProperties=null}vertexProperty(t,n){this.userVertexProperties=this.userVertexProperties||{};const s=this.vertexPropertyKey(t),i=Array.isArray(n)?n:[n];this.userVertexProperties[s]||(this.userVertexProperties[s]=i.length),dt(this,us)[s]=i}vertexPropertyName(t){return t.replace(/Src$/,"")}vertexPropertyKey(t){return t+"Src"}bezierOrder(...t){Hs(this,Tg,t)}splineProperty(t,n){this._splineProperties[t]=n}splineProperties(t){if(t)for(const n in t)this.splineProperty(n,t[n]);else return this._splineProperties}vertex(t,n,{isClosing:s=!1}={}){const i=Yr(this,Qa,dm).call(this,"vertex",t,n);i.isClosing=s}bezierVertex(t,n){Yr(this,Qa,dm).call(this,"bezierVertex",t,n)}splineVertex(t,n){Yr(this,Qa,dm).call(this,"splineVertex",t,n)}arcVertex(t,n){Yr(this,Qa,dm).call(this,"arcVertex",t,n)}beginContour(t=Ja){var n;((n=this.at(-1))==null?void 0:n.kind)===Uf&&this.contours.pop(),this.contours.push(new H6(t))}endContour(t=Wc,n=this.contours.length-1){const s=this.at(n);if(t===Gm){const i=s.kind===Ja,a=this.at(n,0,0),o=Object.hasOwn(a,"position"),u=this.at(n,-1);if(i&&o)if(u.handlesClose())u.close(a);else{const l=this.contours.splice(n+1,this.contours.length-n-1),c=dt(this,us);Hs(this,us,{...c});for(const h in a)["position","textureCoordinates"].includes(h)||(dt(this,us)[h]=a[h]);this.vertex(a.position,a.textureCoordinates,{isClosing:!0}),Hs(this,us,c),this.contours.push(...l)}}}beginShape(t=Ja){this.kind=t,this.beginContour(t)}endShape(t=Wc){t===Gm&&this.endContour(t,0)}accept(t){for(const n of this.contours)n.accept(t)}}us=new WeakMap,Eg=new WeakMap,Dg=new WeakMap,Tg=new WeakMap,Qa=new WeakSet,s8=function(t,n){return dt(this,us).position=t,n!==void 0&&(dt(this,us).textureCoordinates=n),new W6(dt(this,us))},i8=function(t,n,...s){let i=dt(this,Dg).get(t,n);return t==="bezierVertex"?i(dt(this,Tg),...s):i(...s)},dm=function(t,n,s){let i=t,a=this.at(-1).kind,o=Yr(this,Qa,s8).call(this,n,s);return Yr(this,Qa,i8).call(this,i,a,o).addToShape(this)};class Od{constructor(){if(this.constructor===Od)throw new Error("PrimitiveVisitor is an abstract class: it cannot be instantiated.")}visitAnchor(t){throw new Error("Method visitAnchor() has not been implemented.")}visitLineSegment(t){throw new Error("Method visitLineSegment() has not been implemented.")}visitBezierSegment(t){throw new Error("Method visitBezierSegment() has not been implemented.")}visitSplineSegment(t){throw new Error("Method visitSplineSegment() has not been implemented.")}visitArcSegment(t){throw new Error("Method visitArcSegment() has not been implemented.")}visitPoint(t){throw new Error("Method visitPoint() has not been implemented.")}visitLine(t){throw new Error("Method visitLine() has not been implemented.")}visitTriangle(t){throw new Error("Method visitTriangle() has not been implemented.")}visitQuad(t){throw new Error("Method visitQuad() has not been implemented.")}visitTriangleFan(t){throw new Error("Method visitTriangleFan() has not been implemented.")}visitTriangleStrip(t){throw new Error("Method visitTriangleStrip() has not been implemented.")}visitQuadStrip(t){throw new Error("Method visitQuadStrip() has not been implemented.")}}class a8 extends Od{constructor({strokeWeight:n}){super();Bt(this,"path",new Path2D);Bt(this,"strokeWeight");this.strokeWeight=n}visitAnchor(n){let s=n.getEndVertex();this.path.moveTo(s.position.x,s.position.y)}visitLineSegment(n){if(n.isClosing)this.path.closePath();else{let s=n.getEndVertex();this.path.lineTo(s.position.x,s.position.y)}}visitBezierSegment(n){let[s,i,a]=n.vertices;switch(n.order){case 2:this.path.quadraticCurveTo(s.position.x,s.position.y,i.position.x,i.position.y);break;case 3:this.path.bezierCurveTo(s.position.x,s.position.y,i.position.x,i.position.y,a.position.x,a.position.y);break}}visitSplineSegment(n){const s=n._shape;if(n._splineProperties.ends===Mf&&!n._comesAfterSegment){let o=n._firstInterpolatedVertex;this.path.moveTo(o.position.x,o.position.y)}const i=n.getControlPoints().map(o=>s.vertexToArray(o));let a=s.catmullRomToBezier(i,n._splineProperties.tightness).map(o=>o.map(u=>s.arrayToVertex(u)));for(const o of a){const u=o.flatMap(l=>[l.position.x,l.position.y]);this.path.bezierCurveTo(...u)}}visitPoint(n){const{x:s,y:i}=n.vertices[0].position;this.path.moveTo(s,i),this.path.lineTo(s+1e-5,i)}visitLine(n){const{x:s,y:i}=n.vertices[0].position,{x:a,y:o}=n.vertices[1].position;this.path.moveTo(s,i),this.path.lineTo(a,o)}visitTriangle(n){const[s,i,a]=n.vertices;this.path.moveTo(s.position.x,s.position.y),this.path.lineTo(i.position.x,i.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.closePath()}visitQuad(n){const[s,i,a,o]=n.vertices;this.path.moveTo(s.position.x,s.position.y),this.path.lineTo(i.position.x,i.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.closePath()}visitTriangleFan(n){const[s,...i]=n.vertices;for(let a=0;a<i.length-1;a++){const o=i[a],u=i[a+1];this.path.moveTo(s.position.x,s.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.lineTo(u.position.x,u.position.y),this.path.closePath()}}visitTriangleStrip(n){for(let s=0;s<n.vertices.length-2;s++){const i=n.vertices[s],a=n.vertices[s+1],o=n.vertices[s+2];this.path.moveTo(i.position.x,i.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.closePath()}}visitQuadStrip(n){for(let s=0;s<n.vertices.length-3;s+=2){const i=n.vertices[s],a=n.vertices[s+1],o=n.vertices[s+2],u=n.vertices[s+3];this.path.moveTo(i.position.x,i.position.y),this.path.lineTo(a.position.x,a.position.y),this.path.lineTo(u.position.x,u.position.y),this.path.lineTo(o.position.x,o.position.y),this.path.closePath()}}}class o8 extends Od{constructor({curveDetail:n=1}={}){super();Bt(this,"contours",[]);Bt(this,"curveDetail");this.curveDetail=n}lastContour(){return this.contours[this.contours.length-1]}visitAnchor(n){this.contours.push([]);const s=n._nextPrimitive;s!=null&&s.canOverrideAnchor?this.lastContour().push(s._firstInterpolatedVertex):this.lastContour().push(n.getEndVertex())}visitLineSegment(n){this.lastContour().push(n.getEndVertex())}visitBezierSegment(n){const s=this.lastContour(),i=Math.max(1,Math.ceil(n.hullLength()*this.curveDetail)),a=[n.getStartVertex(),...n.vertices].map(o=>n._shape.vertexToArray(o));for(let o=0;o<i;o++){const u=(o+1)/i;s.push(n._shape.arrayToVertex(n.order===3?n._shape.evaluateCubicBezier(a,u):n._shape.evaluateQuadraticBezier(a,u)))}}visitSplineSegment(n){const s=n._shape,i=this.lastContour(),a=n.getControlPoints().map(l=>s.vertexToArray(l));let o=s.catmullRomToBezier(a,n._splineProperties.tightness),u=s.vertexToArray(n._firstInterpolatedVertex);for(const l of o){const c=[u,...l],h=Math.max(1,Math.ceil(j6(c.map(f=>s.arrayToVertex(f)))*this.curveDetail));for(let f=0;f<h;f++){const p=(f+1)/h;i.push(s.arrayToVertex(s.evaluateCubicBezier(c,p)))}u=l[2]}}visitPoint(n){this.contours.push(n.vertices.slice())}visitLine(n){this.contours.push(n.vertices.slice())}visitTriangle(n){this.contours.push(n.vertices.slice())}visitQuad(n){this.contours.push(n.vertices.slice())}visitTriangleFan(n){this.contours.push(n.vertices.slice())}visitTriangleStrip(n){this.contours.push(n.vertices.slice())}visitQuadStrip(n){this.contours.push(n.vertices.slice())}}class dQ extends Od{constructor(){super()}}function oT(r,t){r.Shape=r8,r.Contour=H6,r.ShapePrimitive=Ia,r.Vertex=W6,r.Anchor=Yy,r.Segment=Zc,r.LineSegment=q6,r.BezierSegment=K6,r.SplineSegment=X6,r.Point=Y6,r.Line=Z6,r.Triangle=Q6,r.Quad=J6,r.TriangleFan=e8,r.TriangleStrip=t8,r.QuadStrip=n8,r.PrimitiveVisitor=Od,r.PrimitiveToPath2DConverter=a8,r.PrimitiveToVerticesConverter=o8,r.PointAtLengthGetter=dQ,t.bezierOrder=function(n){return this._renderer.bezierOrder(n)},t.splineVertex=function(...n){let s=0,i=0,a=0,o=0,u=0;n.length===2?[s,i]=n:n.length===4?[s,i,o,u]=n:n.length===3?[s,i,a]=n:n.length===5&&([s,i,a,o,u]=n),this._renderer.splineVertex(s,i,a,o,u)},t.splineProperty=function(n,s){return this._renderer.splineProperty(n,s)},t.splineProperties=function(n){return this._renderer.splineProperties(n)},t.vertex=function(n,s){let i,a,o;i=a=o=0,arguments.length===3?i=arguments[2]:arguments.length===4?(a=arguments[2],o=arguments[3]):arguments.length===5&&(i=arguments[2],a=arguments[3],o=arguments[4]),this._renderer.vertex(n,s,i,a,o)},t.beginContour=function(n){this._renderer.beginContour(n)},t.endContour=function(n=Wc){this._renderer.endContour(n)}}typeof p5<"u"&&oT(p5,p5.prototype);var Wa;class pQ{constructor(t){Jn(this,Wa,{});for(const n in t)this[n]=t[n]}setValue(t,n){t in dt(this,Wa)||(dt(this,Wa)[t]=this[t]),this[t]=n}getDiff(){const t=dt(this,Wa);return Hs(this,Wa,{}),t}getModified(){return dt(this,Wa)}applyDiff(t){for(const n in dt(this,Wa))this[n]=dt(this,Wa)[n];Hs(this,Wa,t)}}Wa=new WeakMap;var Zy={exports:{}},mQ=Zy.exports,eF;function gQ(){return eF||(eF=1,function(r){/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */var t=t||function(n){if(!(typeof n>"u"||typeof navigator<"u"&&/MSIE [1-9]\./.test(navigator.userAgent))){var s=n.document,i=function(){return n.URL||n.webkitURL||n},a=s.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in a,u=function(E){var _=new MouseEvent("click");E.dispatchEvent(_)},l=/constructor/i.test(n.HTMLElement)||n.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent),h=function(E){(n.setImmediate||n.setTimeout)(function(){throw E},0)},f="application/octet-stream",p=1e3*40,g=function(E){var _=function(){typeof E=="string"?i().revokeObjectURL(E):E.remove()};setTimeout(_,p)},y=function(E,_,D){_=[].concat(_);for(var I=_.length;I--;){var k=E["on"+_[I]];if(typeof k=="function")try{k.call(E,D||E)}catch(A){h(A)}}},x=function(E){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(E.type)?new Blob(["\uFEFF",E],{type:E.type}):E},v=function(E,_,D){D||(E=x(E));var I=this,k=E.type,A=k===f,N,F=function(){y(I,"writestart progress write writeend".split(" "))},$=function(){if((c||A&&l)&&n.FileReader){var O=new FileReader;O.onloadend=function(){var B=c?O.result:O.result.replace(/^data:[^;]*;/,"data:attachment/file;"),U=n.open(B,"_blank");U||(n.location.href=B),B=void 0,I.readyState=I.DONE,F()},O.readAsDataURL(E),I.readyState=I.INIT;return}if(N||(N=i().createObjectURL(E)),A)n.location.href=N;else{var M=n.open(N,"_blank");M||(n.location.href=N)}I.readyState=I.DONE,F(),g(N)};if(I.readyState=I.INIT,o){N=i().createObjectURL(E),setTimeout(function(){a.href=N,a.download=_,u(a),F(),g(N),I.readyState=I.DONE});return}$()},S=v.prototype,w=function(E,_,D){return new v(E,_||E.name||"download",D)};return typeof navigator<"u"&&navigator.msSaveOrOpenBlob?function(E,_,D){return _=_||E.name||"download",D||(E=x(E)),navigator.msSaveOrOpenBlob(E,_)}:(S.abort=function(){},S.readyState=S.INIT=0,S.WRITING=1,S.DONE=2,S.error=S.onwritestart=S.onprogress=S.onwrite=S.onabort=S.onerror=S.onwriteend=null,w)}}(typeof self<"u"&&self||typeof window<"u"&&window||mQ.content);r.exports&&(r.exports.saveAs=t)}(Zy)),Zy.exports}var yQ=gQ();function uT(r,t,n){const i=Fx(t,n)[0];let a=r;a instanceof Blob||(a=new Blob([r])),yQ.saveAs(a,i)}function Fx(r,t){(!t||t===!0||t==="true")&&(t=""),r||(r="untitled");let n="";return r&&r.includes(".")&&(n=r.split(".").pop()),t&&n!==t&&(n=t,r=`${r}.${n}`),[r,n]}let kl=class X_{constructor(t,n){this.width=t,this.height=n,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),this._pixelsState=this,this._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]}pixelDensity(t){return typeof t<"u"?(t<=0&&(t=1),this._pixelDensity=t,this.width/=t,this.height/=t,this):this._pixelDensity}_animateGif(t){const n=this.gifProperties,s=t._lastRealFrameTime||window.performance.now();if(n.lastChangeTime===0&&(n.lastChangeTime=s),n.playing){n.timeDisplayed=s-n.lastChangeTime;const i=n.frames[n.displayIndex].delay;if(n.timeDisplayed>=i){const a=Math.floor(n.timeDisplayed/i);if(n.timeDisplayed=0,n.lastChangeTime=s,n.displayIndex+=a,n.loopCount=Math.floor(n.displayIndex/n.numFrames),n.loopLimit!==null&&n.loopCount>=n.loopLimit)n.playing=!1;else{const o=n.displayIndex%n.numFrames;this.drawingContext.putImageData(n.frames[o].image,0,0),n.displayIndex=o,this.setModified(!0)}}}}loadPixels(){const t=this._pixelsState,n=this._pixelDensity,s=this.width*n,i=this.height*n,a=this.drawingContext.getImageData(0,0,s,i);t.imageData=a,this.pixels=t.pixels=a.data,this.setModified(!0)}updatePixels(t,n,s,i){const a=this._pixelsState,o=this._pixelDensity;t===void 0&&n===void 0&&s===void 0&&i===void 0&&(t=0,n=0,s=this.width,i=this.height),t*=o,n*=o,s*=o,i*=o,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=a.imageData),this.drawingContext.putImageData(a.imageData,t,n,0,0,s,i),this.setModified(!0)}get(t,n,s,i){const a=this._pixelsState,o=this._pixelDensity,u=this.canvas;if(typeof t>"u"&&typeof n>"u")t=n=0,s=a.width,i=a.height;else if(t*=o,n*=o,typeof s>"u"&&typeof i>"u")return t<0||n<0||t>=u.width||n>=u.height?[0,0,0,0]:this._getPixel(t,n);const l=new X_(s*o,i*o);return l.pixelDensity(o),l.canvas.getContext("2d").drawImage(u,t,n,s*o,i*o,0,0,s*o,i*o),l}_getPixel(t,n){let s,i;return s=this.drawingContext.getImageData(t,n,1,1).data,i=0,[s[i+0],s[i+1],s[i+2],s[i+3]]}set(t,n,s){t=Math.floor(t),n=Math.floor(n);const i=this._pixelsState;if(s instanceof X_)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this.drawingContext.clearRect(t,n,s.width,s.height),this.drawingContext.drawImage(s.canvas,t,n),this.drawingContext.restore();else{let a=0,o=0,u=0,l=0,c=4*(n*this._pixelDensity*(this.width*this._pixelDensity)+t*this._pixelDensity);if(i.imageData||i.loadPixels(),typeof s=="number")c<i.pixels.length&&(a=s,o=s,u=s,l=255);else if(Array.isArray(s)){if(s.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");c<i.pixels.length&&(a=s[0],o=s[1],u=s[2],l=s[3])}else s instanceof p5.Color&&c<i.pixels.length&&([a,o,u,l]=s._getRGBA([255,255,255,255]));for(let h=0;h<this._pixelDensity;h++)for(let f=0;f<this._pixelDensity;f++)c=4*((n*this._pixelDensity+f)*this.width*this._pixelDensity+(t*this._pixelDensity+h)),i.pixels[c]=a,i.pixels[c+1]=o,i.pixels[c+2]=u,i.pixels[c+3]=l}this.setModified(!0)}resize(t,n){t===0&&n===0?(t=this.canvas.width,n=this.canvas.height):t===0?t=this.canvas.width*n/this.canvas.height:n===0&&(n=this.canvas.height*t/this.canvas.width),t=Math.floor(t),n=Math.floor(n);const s=document.createElement("canvas");if(s.width=t,s.height=n,this.gifProperties){const i=this.gifProperties,a=(o,u)=>{let l=0;for(let c=0;c<u.height;c++)for(let h=0;h<u.width;h++){const f=Math.floor(h*o.width/u.width);let g=(Math.floor(c*o.height/u.height)*o.width+f)*4;u.data[l++]=o.data[g++],u.data[l++]=o.data[g++],u.data[l++]=o.data[g++],u.data[l++]=o.data[g++]}};for(let o=0;o<i.numFrames;o++){const u=this.drawingContext.createImageData(t,n);a(i.frames[o].image,u),i.frames[o].image=u}}s.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,s.width,s.height),this.canvas.width=this.width=t,this.canvas.height=this.height=n,this.drawingContext.drawImage(s,0,0,t,n,0,0,t,n),this.pixels.length>0&&this.loadPixels(),this.setModified(!0)}copy(...t){let n,s,i,a,o,u,l,c,h;if(t.length===9)n=t[0],s=t[1],i=t[2],a=t[3],o=t[4],u=t[5],l=t[6],c=t[7],h=t[8];else if(t.length===8)n=this,s=t[0],i=t[1],a=t[2],o=t[3],u=t[4],l=t[5],c=t[6],h=t[7];else throw new Error("Signature not supported");this._copyHelper(this,n,s,i,a,o,u,l,c,h)}_copyHelper(t,n,s,i,a,o,u,l,c,h){const f=n.canvas.width/n.width;let p=0,g=0;n._renderer&&n._renderer.isP3D&&(p=n.width/2,g=n.height/2),t._renderer&&t._renderer.isP3D?(t.push(),t.resetMatrix(),t.noLights(),t.blendMode(t.BLEND),t.imageMode(t.CORNER),t._renderer.image(n,s+p,i+g,a,o,u,l,c,h),t.pop()):t.drawingContext.drawImage(n.canvas,f*(s+p),f*(i+g),f*a,f*o,u,l,c,h)}mask(t){t===void 0&&(t=this);const n=this.drawingContext.globalCompositeOperation;let s=this._pixelDensity,i=1;t instanceof Pt&&(i=t._pInst._renderer._pixelDensity);const a=[t,0,0,i*t.width,i*t.height,0,0,s*this.width,s*this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(let o=0;o<this.gifProperties.frames.length;o++)this.drawingContext.putImageData(this.gifProperties.frames[o].image,0,0),this.copy(...a),this.gifProperties.frames[o].image=this.drawingContext.getImageData(0,0,s*this.width,s*this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else this.copy(...a);this.drawingContext.globalCompositeOperation=n,this.setModified(!0)}filter(t,n){Gn.apply(this.canvas,Gn[t],n),this.setModified(!0)}blend(...t){const n=this.drawingContext.globalCompositeOperation,s=t[t.length-1],i=Array.prototype.slice.call(t,0,t.length-1);this.drawingContext.globalCompositeOperation=s,this.copy(...i),this.drawingContext.globalCompositeOperation=n,this.setModified(!0)}setModified(t){this._modified=t}isModified(){return this._modified}save(t,n){if(this.gifProperties)xQ(this,t);else{let s=this.canvas;n=n||Fx(t,n)[1]||"png";let i;switch(n){default:i="image/png";break;case"webp":i="image/webp";break;case"jpeg":case"jpg":i="image/jpeg";break}s.toBlob(a=>{uT(a,t,n)},i)}}async toBlob(){return new Promise(t=>{this.canvas.toBlob(t)})}reset(){if(this.gifProperties){const t=this.gifProperties;t.playing=!0,t.timeSinceStart=0,t.timeDisplayed=0,t.lastChangeTime=0,t.loopCount=0,t.displayIndex=0,this.drawingContext.putImageData(t.frames[0].image,0,0)}}getCurrentFrame(){if(this.gifProperties){const t=this.gifProperties;return t.displayIndex%t.numFrames}}setFrame(t){if(this.gifProperties){const n=this.gifProperties;t<n.numFrames&&t>=0?(n.timeDisplayed=0,n.lastChangeTime=0,n.displayIndex=t,this.drawingContext.putImageData(n.frames[t].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero.")}}numFrames(){if(this.gifProperties)return this.gifProperties.numFrames}play(){this.gifProperties&&(this.gifProperties.playing=!0)}pause(){this.gifProperties&&(this.gifProperties.playing=!1)}delay(t,n){if(this.gifProperties){const s=this.gifProperties;if(n<s.numFrames&&n>=0)s.frames[n].delay=t;else for(const i of s.frames)i.delay=t}}};function xQ(r,t){const n=r.gifProperties;let s=n.loopLimit;s===1?s=null:s===null&&(s=0);const i=new Uint8Array(r.width*r.height*n.numFrames),a=[],o={};for(let w=0;w<n.numFrames;w++){const E=new Set,_=n.frames[w].image.data,D=_.length,I=new Uint32Array(r.width*r.height);for(let A=0,N=0;A<D;A+=4,N++){const F=_[A+0],$=_[A+1],O=_[A+2],M=F<<16|$<<8|O<<0;E.add(M),I[N]=M}const k=[...E].sort().toString();o[k]===void 0?o[k]={freq:1,frames:[w]}:(o[k].freq+=1,o[k].frames.push(w)),a.push(I)}let u=[];const l=Object.keys(o).sort(function(w,E){return o[E].freq-o[w].freq}),c=l[0].split(",").map(w=>parseInt(w));u=u.concat(o[c].frames);const h=new Set(c);for(let w=1;w<l.length;w++){const _=l[w].split(",").map(D=>parseInt(D)).filter(D=>!h.has(D));if(c.length+_.length<=256){for(let D=0;D<_.length;D++)c.push(_[D]),h.add(_[D]);u=u.concat(o[l[w]].frames)}}u=new Set(u);const f={};for(let w=0;w<c.length;w++)f[c[w]]||(f[c[w]]=w);let p=1;for(;p<c.length;)p<<=1;c.length=p;const g={loop:s,palette:new Uint32Array(c)},y=new omggif.GifWriter(i,r.width,r.height,g);let x={};for(let w=0;w<n.numFrames;w++){const E=!u.has(w),_=E?[]:c,D=new Uint8Array(r.width*r.height),I={},k=new Set;a[w].forEach((F,$)=>{E?(I[F]===void 0&&(I[F]=_.length,_.push(F)),D[$]=I[F]):D[$]=f[F],w>0&&a[w-1][$]!==F&&k.add(F)});const A={},N=_.filter(F=>!k.has(F));if(N.length>0){const F=N[0],$=E?I[F]:f[F];if(w>0){for(let O=0;O<a[w].length;O++)a[w-1][O]===a[w][O]&&(D[O]=$);A.transparent=$,x.frameOpts.disposal=1}}if(A.delay=n.frames[w].delay/10,E){let F=1;for(;F<_.length;)F<<=1;_.length=F,A.palette=new Uint32Array(_)}w>0&&y.addFrame(0,0,r.width,r.height,x.pixelPaletteIndex,x.frameOpts),x={pixelPaletteIndex:D,frameOpts:A}}x.frameOpts.disposal=1,y.addFrame(0,0,r.width,r.height,x.pixelPaletteIndex,x.frameOpts);const v="gif",S=new Blob([i.slice(0,y.end())],{type:"image/gif"});uT(S,t,v)}function u8(r,t){r.Image=kl}typeof p5<"u"&&u8(p5,p5.prototype);class lT{constructor(t={}){for(const n in t)this[n]=t[n]}clone(){return new lT(this)}}const jb=class jb{constructor(t,n,s,i){this._pInst=t,this._isMainCanvas=i,this.pixels=[],this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this.width=n,this.height=s,this._events={},i&&(this._isMainCanvas=!0),this.states=new pQ(jb.states),this.states.strokeColor=new pr([0,0,0]),this.states.fillColor=new pr([1,1,1]),this._pushPopStack=[],this._pushPopDepth=0,this._clipping=!1,this._clipInvert=!1,this._currentShape=void 0}get currentShape(){return this._currentShape||(this._currentShape=new r8(this.getCommonVertexProperties())),this._currentShape}remove(){}pixelDensity(t){let n;return typeof t=="number"?(t!==this._pixelDensity&&(this._pixelDensity=t),n=this,this.resize(this.width,this.height)):n=this._pixelDensity,n}push(){this._pushPopDepth++,this._pushPopStack.push(this.states.getDiff())}pop(){this._pushPopDepth--;const t=this._pushPopStack.pop()||{},n=this.states.getModified();this.states.applyDiff(t),this.updateShapeVertexProperties(n),this.updateShapeProperties(n)}bezierOrder(t){if(t===void 0)return this.states.bezierOrder;this.states.setValue("bezierOrder",t),this.updateShapeProperties()}bezierVertex(t,n,s=0,i=0,a=0){const o=new Ee(t,n,s),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new Ee(i,a):void 0;this.currentShape.bezierVertex(o,u)}splineProperty(t,n){if(n===void 0)return this.states.splineProperties[t];this.states.setValue("splineProperties",this.states.splineProperties.clone()),this.states.splineProperties[t]=n,this.updateShapeProperties()}splineProperties(t){if(t)for(const n in t)this.splineProperty(n,t[n]);else return{...this.states.splineProperties}}splineVertex(t,n,s=0,i=0,a=0){const o=new Ee(t,n,s),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new Ee(i,a):void 0;this.currentShape.splineVertex(o,u)}curveDetail(t){if(t===void 0)return this.states.curveDetail;this.states.setValue("curveDetail",t)}beginShape(...t){this.currentShape.reset(),this.updateShapeVertexProperties(),this.currentShape.beginShape(...t)}endShape(...t){this.currentShape.endShape(...t),this.drawShape(this.currentShape)}beginContour(t){this.currentShape.beginContour(t)}endContour(t){this.currentShape.endContour(t)}drawShape(t,n){throw new Error("Unimplemented")}vertex(t,n,s=0,i=0,a=0){const o=new Ee(t,n,s),u=this.getSupportedIndividualVertexProperties().textureCoordinates?new Ee(i,a):void 0;this.currentShape.vertex(o,u)}bezier(t,n,s,i,a,o,u,l){const c=this._pInst.bezierOrder();return this._pInst.bezierOrder(c),this._pInst.beginShape(),this._pInst.bezierVertex(t,n),this._pInst.bezierVertex(s,i),this._pInst.bezierVertex(a,o),this._pInst.bezierVertex(u,l),this._pInst.endShape(),this}spline(...t){if(t.length===2*4){const[n,s,i,a,o,u,l,c]=t;this._pInst.beginShape(),this._pInst.splineVertex(n,s),this._pInst.splineVertex(i,a),this._pInst.splineVertex(o,u),this._pInst.splineVertex(l,c),this._pInst.endShape()}else if(t.length===3*4){const[n,s,i,a,o,u,l,c,h,f,p,g]=t;this._pInst.beginShape(),this._pInst.splineVertex(n,s,i),this._pInst.splineVertex(a,o,u),this._pInst.splineVertex(l,c,h),this._pInst.splineVertex(f,p,g),this._pInst.endShape()}return this}beginClip(t={}){if(this._clipping)throw new Error("It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?");this._clipping=!0,this._clipInvert=t.invert}endClip(){if(!this._clipping)throw new Error("It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?");this._clipping=!1}resize(t,n){this.width=t,this.height=n}get(t,n,s,i){const a=this._pixelDensity,o=this.canvas;if(typeof t>"u"&&typeof n>"u")t=n=0,s=this.width,i=this.height;else if(t*=a,n*=a,typeof s>"u"&&typeof i>"u")return t<0||n<0||t>=o.width||n>=o.height?[0,0,0,0]:this._getPixel(t,n);const u=new kl(s*a,i*a);return u.pixelDensity(a),u.canvas.getContext("2d").drawImage(o,t,n,s*a,i*a,0,0,s*a,i*a),u}scale(t,n){}fill(...t){this.states.setValue("fillSet",!0),this.states.setValue("fillColor",this._pInst.color(...t)),this.updateShapeVertexProperties()}noFill(){this.states.setValue("fillColor",null)}strokeWeight(t){if(t===void 0)return this.states.strokeWeight;this.states.setValue("strokeWeight",t)}stroke(...t){this.states.setValue("strokeSet",!0),this.states.setValue("strokeColor",this._pInst.color(...t)),this.updateShapeVertexProperties()}noStroke(){this.states.setValue("strokeColor",null)}getCommonVertexProperties(){return{}}getSupportedIndividualVertexProperties(){return{textureCoordinates:!1}}updateShapeProperties(t){if(!t||t.bezierOrder||t.splineProperties){const n=this.currentShape;n.bezierOrder(this.states.bezierOrder),n.splineProperty("ends",this.states.splineProperties.ends),n.splineProperty("tightness",this.states.splineProperties.tightness)}}updateShapeVertexProperties(t){const n=this.getCommonVertexProperties();if(!t||Object.keys(t).some(s=>s in n)){const s=this.currentShape;for(const i in n)s[i](n[i])}}_applyDefaults(){return this}};Bt(jb,"states",{strokeColor:null,strokeSet:!1,fillColor:null,fillSet:!1,tint:null,imageMode:Yi,rectMode:Yi,ellipseMode:Ti,strokeWeight:1,textFont:{family:"sans-serif"},textLeading:15,leadingSet:!1,textSize:12,textAlign:i6,textBaseline:a6,bezierOrder:3,splineProperties:new lT({ends:Gf,tightness:0}),textWrap:l6,fontStyle:wo,fontStretch:wo,fontWeight:wo,lineHeight:wo,fontVariant:wo,direction:"inherit"});let Pt=jb;function bQ(r,t){r.Renderer=Pt}class Ym extends vn{constructor(t,n){super(t,n);const s=this;this.elt.crossOrigin="anonymous",this._prevTime=0,this._cueIDCounter=0,this._cues=[],this.pixels=[],this._pixelsState=this,this._pixelDensity=1,this._modified=!1,this._frameOnCanvas=-1,Object.defineProperty(s,"src",{get(){const i=s.elt.children[0].src,a=s.elt.src===window.location.href?"":s.elt.src;return i===window.location.href?a:i},set(i){for(let o=0;o<s.elt.children.length;o++)s.elt.removeChild(s.elt.children[o]);const a=document.createElement("source");a.src=i,t.appendChild(a),s.elt.src=i,s.modified=!0}}),s._onended=function(){},s.elt.onended=function(){s._onended(s)}}play(){this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0);let t;return this.elt.readyState>1?t=this.elt.play():(this.elt.load(),t=this.elt.play()),t&&t.catch&&t.catch(n=>{n.name==="NotAllowedError"?typeof IS_MINIFIED>"u"?p5._friendlyAutoplayError(this.src):console.error(n):console.error("Media play method encountered an unexpected error",n)}),this}stop(){return this.elt.pause(),this.elt.currentTime=0,this}pause(){return this.elt.pause(),this}loop(){return this.elt.setAttribute("loop",!0),this.play(),this}noLoop(){return this.elt.removeAttribute("loop"),this}_setupAutoplayFailDetection(){const t=setTimeout(()=>{typeof IS_MINIFIED>"u"?p5._friendlyAutoplayError(this.src):console.error(e)},500);this.elt.addEventListener("play",()=>clearTimeout(t),{passive:!0,once:!0})}autoplay(t){const n=this.elt.getAttribute("autoplay");if(this.elt.setAttribute("autoplay",t),t&&!n){const s=()=>this._setupAutoplayFailDetection();this.elt.readyState===4?s():this.elt.addEventListener("canplay",s,{passive:!0,once:!0})}return this}volume(t){if(typeof t>"u")return this.elt.volume;this.elt.volume=t}speed(t){if(typeof t>"u")return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=t:this.presetPlaybackRate=t}time(t){return typeof t>"u"?this.elt.currentTime:(this.elt.currentTime=t,this)}duration(){return this.elt.duration}_ensureCanvas(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0));const t=this._frameOnCanvas!==this._pInst.frameCount;this.loadedmetadata&&t&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&(this.drawingContext.save(),this.drawingContext.scale(-1,1),this.drawingContext.translate(-this.canvas.width,0)),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.flipped===!0&&this.drawingContext.restore(),this.setModified(!0),this._frameOnCanvas=this._pInst.frameCount)}loadPixels(...t){return this._ensureCanvas(),p5.Renderer2D.prototype.loadPixels.apply(this,t)}updatePixels(t,n,s,i){return this.loadedmetadata&&(this._ensureCanvas(),p5.Renderer2D.prototype.updatePixels.call(this,t,n,s,i)),this.setModified(!0),this}get(...t){return this._ensureCanvas(),p5.Renderer2D.prototype.get.apply(this,t)}_getPixel(...t){return this.loadPixels(),p5.Renderer2D.prototype._getPixel.apply(this,t)}set(t,n,s){this.loadedmetadata&&(this._ensureCanvas(),p5.Renderer2D.prototype.set.call(this,t,n,s),this.setModified(!0))}copy(...t){this._ensureCanvas(),fn.copy.apply(this,t)}mask(...t){this.loadPixels(),this.setModified(!0),p5.Image.prototype.mask.apply(this,t)}isModified(){return this._modified}setModified(t){this._modified=t}onended(t){return this._onended=t,this}connect(t){let n,s;if(typeof fn.getAudioContext=="function")n=fn.getAudioContext(),s=p5.soundOut.input;else try{n=t.context,s=n.destination}catch{throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=n.createMediaElementSource(this.elt),this.audioSourceNode.connect(s)),t?t.input?this.audioSourceNode.connect(t.input):this.audioSourceNode.connect(t):this.audioSourceNode.connect(s)}disconnect(){if(this.audioSourceNode)this.audioSourceNode.disconnect();else throw"nothing to disconnect"}showControls(){this.elt.style["text-align"]="inherit",this.elt.controls=!0}hideControls(){this.elt.controls=!1}addCue(t,n,s){const i=this._cueIDCounter++,a=new vQ(n,t,i,s);return this._cues.push(a),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),i}removeCue(t){for(let n=0;n<this._cues.length;n++)this._cues[n].id===t&&(console.log(t),this._cues.splice(n,1));this._cues.length===0&&(this.elt.ontimeupdate=null)}clearCues(){this._cues=[],this.elt.ontimeupdate=null}_onTimeUpdate(){const t=this.time();for(let n=0;n<this._cues.length;n++){const s=this._cues[n].time,i=this._cues[n].val;this._prevTime<s&&s<=t&&this._cues[n].callback(i)}this._prevTime=t}}class vQ{constructor(t,n,s,i){this.callback=t,this.time=n,this.id=s,this.val=i}}function l8(r,t){function n(i,a,o){(a._userNode?a._userNode:document.body).appendChild(i);const l=o?new Ym(i,a):new vn(i,a);return a._elements.push(l),l}function s(i,a,o,u){const l=document.createElement(a);o=o||"",typeof o=="string"&&(o=[o]);for(const h of o){const f=document.createElement("source");f.setAttribute("src",h),l.appendChild(f)}if(typeof u=="function"){const h=()=>{u(),l.removeEventListener("canplaythrough",h)};l.addEventListener("canplaythrough",h)}const c=n(l,i,!0);return c.loadedmetadata=!1,l.addEventListener("loadedmetadata",()=>{c.width=l.videoWidth,c.height=l.videoHeight,c.elt.width===0&&(c.elt.width=l.videoWidth),c.elt.height===0&&(c.elt.height=l.videoHeight),c.presetPlaybackRate&&(c.elt.playbackRate=c.presetPlaybackRate,delete c.presetPlaybackRate),c.loadedmetadata=!0}),c}t.createVideo=function(i,a){return s(this,"video",i,a)},t.createAudio=function(i,a){return s(this,"audio",i,a)},t.VIDEO="video",t.AUDIO="audio",navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(i){const a=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return a?new Promise(function(o,u){a.call(navigator,i,o,u)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),t.createCapture=function(...i){if(!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))throw new DOMException("getUserMedia not supported in this browser");let a=!0,o=!0,u,l,c=!1;for(const g of i)g===t.VIDEO?o=!1:g===t.AUDIO?a=!1:typeof g=="object"?(g.flipped!==void 0&&(c=g.flipped,delete g.flipped),u=Object.assign({},u,g)):typeof g=="function"&&(l=g);u=Object.assign({},{video:a,audio:o},u);const f=document.createElement("video");f.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(u).then(function(g){try{"srcObject"in f?f.srcObject=g:f.src=window.URL.createObjectURL(g)}catch{f.src=g}}).catch(g=>{g.name==="NotFoundError"&&r._friendlyError("No webcam found on this device","createCapture"),g.name==="NotAllowedError"&&r._friendlyError("Access to the camera was denied","createCapture"),console.error(g)});const p=n(f,this,!0);return p.loadedmetadata=!1,f.addEventListener("loadedmetadata",function(){f.play(),f.width?(p.width=f.width,p.height=f.height,c&&(p.elt.style.transform="scaleX(-1)")):(p.width=p.elt.width=f.videoWidth,p.height=p.elt.height=f.videoHeight),p.loadedmetadata=!0,l&&l(f.srcObject)}),p.flipped=c,p},r.MediaElement=Ym}typeof p5<"u"&&l8(p5,p5.prototype);function wQ(r,t,n,s,i){let a;return i===Yi?a={x:r,y:t,w:Math.abs(n),h:Math.abs(s)}:i===Pm?a={x:Math.min(r,n),y:Math.min(t,s),w:Math.abs(n-r),h:Math.abs(s-t)}:i===Vm?(n=Math.abs(n),s=Math.abs(s),a={x:r-n,y:t-s,w:2*n,h:2*s}):i===Ti&&(n=Math.abs(n),s=Math.abs(s),a={x:r-n*.5,y:t-s*.5,w:n,h:s}),a}var Qy={modeAdjust:wQ};function cT(r,t){t._normalizeArcAngles=(n,s,i,a,o)=>{let l;return n=n-ai*Math.floor(n/ai),s=s-ai*Math.floor(s/ai),l=Math.min(Math.abs(n-s),ai-Math.abs(n-s)),o&&(n<=bc?n=Math.atan(i/a*Math.tan(n)):n>bc&&n<=3*bc?n=Math.atan(i/a*Math.tan(n))+O_:n=Math.atan(i/a*Math.tan(n))+ai,s<=bc?s=Math.atan(i/a*Math.tan(s)):s>bc&&s<=3*bc?s=Math.atan(i/a*Math.tan(s))+O_:s=Math.atan(i/a*Math.tan(s))+ai),n>s&&(s+=ai),{start:n,stop:s,correspondToSamePoint:l<1e-5}},t.arc=function(n,s,i,a,o,u,l,c){if(!this._renderer.states.strokeColor&&!this._renderer.states.fillColor)return this;if(o===u)return this;o=this._toRadians(o),u=this._toRadians(u);const h=Qy.modeAdjust(n,s,i,a,this._renderer.states.ellipseMode),f=this._normalizeArcAngles(o,u,h.w,h.h,!0);return f.correspondToSamePoint?this._renderer.ellipse([h.x,h.y,h.w,h.h,c]):(this._renderer.arc(h.x,h.y,h.w,h.h,f.start,f.stop,l,c),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[h.x,h.y,h.w,h.h,f.start,f.stop,l])),this},t.ellipse=function(n,s,i,a,o){return this._renderEllipse(...arguments)},t.circle=function(...n){const s=n.slice(0,2);return s.push(n[2],n[2]),this._renderEllipse(...s)},t._renderEllipse=function(n,s,i,a,o){if(!this._renderer.states.strokeColor&&!this._renderer.states.fillColor)return this;typeof a>"u"&&(a=i);const u=Qy.modeAdjust(n,s,i,a,this._renderer.states.ellipseMode);return this._renderer.ellipse([u.x,u.y,u.w,u.h,o]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[u.x,u.y,u.w,u.h]),this},t.line=function(...n){return this._renderer.states.strokeColor&&this._renderer.line(...n),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",n),this},t.point=function(...n){return this._renderer.states.strokeColor&&(n.length===1&&n[0]instanceof r.Vector?this._renderer.point.call(this._renderer,n[0].x,n[0].y,n[0].z):(this._renderer.point(...n),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",n))),this},t.quad=function(...n){return(this._renderer.states.strokeColor||this._renderer.states.fillColor)&&(this._renderer.isP3D&&n.length<12?this._renderer.quad.call(this._renderer,n[0],n[1],0,n[2],n[3],0,n[4],n[5],0,n[6],n[7],0,n[8],n[9]):(this._renderer.quad(...n),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",n))),this},t.rect=function(...n){return this._renderRect(...n)},t.square=function(n,s,i,a,o,u,l){return this._renderRect.call(this,n,s,i,i,a,o,u,l)},t._renderRect=function(){if(this._renderer.states.strokeColor||this._renderer.states.fillColor){arguments.length===3&&(arguments[3]=arguments[2]);const n=Qy.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer.states.rectMode);this._renderer.states.rectMode===Yi&&(n.w=arguments[2],n.h=arguments[3]);const s=[n.x,n.y,n.w,n.h];for(let i=4;i<arguments.length;i++)s[i]=arguments[i];this._renderer.rect(s),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[n.x,n.y,n.w,n.h])}return this},t.triangle=function(...n){return(this._renderer.states.strokeColor||this._renderer.states.fillColor)&&this._renderer.triangle(n),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",n),this}}typeof p5<"u"&&cT(p5,p5.prototype);function hT(r,t){t.ellipseMode=function(n){return(n===Yi||n===Pm||n===Vm||n===Ti)&&this._renderer.states.setValue("ellipseMode",n),this},t.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},t.rectMode=function(n){return(n===Yi||n===Pm||n===Vm||n===Ti)&&this._renderer.states.setValue("rectMode",n),this},t.smooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!0):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},t.strokeCap=function(n){return(n===vl||n===jD||n===GD)&&this._renderer.strokeCap(n),this},t.strokeJoin=function(n){return(n===vl||n===WD||n===HD)&&this._renderer.strokeJoin(n),this},t.strokeWeight=function(n){return this._renderer.strokeWeight(n),this}}typeof p5<"u"&&hT(p5,p5.prototype);function fT(r,t){t.bezier=function(...n){return!this._renderer.states.strokeColor&&!this._renderer.states.fillColor?this:(this._renderer.bezier(...n),this)},t.bezierPoint=function(n,s,i,a,o){const u=1-o;return Math.pow(u,3)*n+3*Math.pow(u,2)*o*s+3*u*Math.pow(o,2)*i+Math.pow(o,3)*a},t.bezierTangent=function(n,s,i,a,o){const u=1-o;return 3*a*Math.pow(o,2)-3*i*Math.pow(o,2)+6*i*u*o-6*s*u*o+3*s*Math.pow(u,2)-3*n*Math.pow(u,2)},t.spline=function(...n){return!this._renderer.states.strokeColor&&!this._renderer.states.fillColor?this:(this._renderer.spline(...n),this)},t.splinePoint=function(n,s,i,a,o){const u=this._renderer.states.splineProperties.tightness,l=o*o*o,c=o*o,h=(u-1)/2*l+(1-u)*c+(u-1)/2*o,f=(u+3)/2*l+(-5-u)/2*c+1,p=(-3-u)/2*l+(u+2)*c+(1-u)/2*o,g=(1-u)/2*l+(u-1)/2*c;return n*h+s*f+i*p+a*g},t.splineTangent=function(n,s,i,a,o){const u=this._renderer.states.splineProperties.tightness,l=o*o*3,c=o*2,h=(u-1)/2*l+(1-u)*c+(u-1)/2,f=(u+3)/2*l+(-5-u)/2*c,p=(-3-u)/2*l+(u+2)*c+(1-u)/2,g=(1-u)/2*l+(u-1)/2*c;return n*h+s*f+i*p+a*g}}typeof p5<"u"&&fT(p5,p5.prototype);function dT(r,t){t.beginShape=function(n){this._renderer.beginShape(...arguments)},t.bezierVertex=function(...n){this._renderer.bezierVertex(...n)},t.endShape=function(n,s=1){s<1&&(console.log(" p5.js says: You can not have less than one instance"),s=1),this._renderer.endShape(n,s)},t.normal=function(n,s,i){return this._assert3d("normal"),this._renderer.normal(...arguments),this},t.vertexProperty=function(n,s){this._renderer.vertexProperty(n,s)}}typeof p5<"u"&&dT(p5,p5.prototype);function pT(r,t){t.beginClip=function(n={}){this._renderer.beginClip(n)},t.endClip=function(){this._renderer.endClip()},t.clip=function(n,s){this._renderer.beginClip(s),n(),this._renderer.endClip(s)},t.background=function(...n){return this._renderer.background(...n),this},t.clear=function(...n){const s=n[0]||0,i=n[1]||0,a=n[2]||0,o=n[3]||0;return this._renderer.clear(s,i,a,o),this},t.colorMode=function(n,s,i,a,o){if([dr,ui,Ca,Ni,Hf,Km,qf,Xm,Kf].includes(n)){this._renderer.states.setValue("colorMode",n),this._renderer.states.setValue("colorMaxes",this._renderer.states.colorMaxes.clone());const u=this._renderer.states.colorMaxes[n];arguments.length===2?(u[0]=s,u[1]=s,u[2]=s,u[3]=s):arguments.length===4?(u[0]=s,u[1]=i,u[2]=a):arguments.length===5&&(u[0]=s,u[1]=i,u[2]=a,u[3]=o)}return this._renderer.states.colorMode},t.fill=function(...n){return this._renderer.fill(...n),this},t.noFill=function(){return this._renderer.noFill(),this},t.noStroke=function(){return this._renderer.states.setValue("strokeColor",null),this},t.stroke=function(...n){return this._renderer.stroke(...n),this},t.erase=function(n=255,s=255){return this._renderer.erase(n,s),this},t.noErase=function(){return this._renderer.noErase(),this},t.blendMode=function(n){n===wo&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),n=ci),this._renderer.blendMode(n)}}typeof p5<"u"&&pT(p5,p5.prototype);var vy={},tF;function SQ(){if(tF)return vy;tF=1;function r(i,a,o,c){var l=0,c=c===void 0?{}:c,h=c.loop===void 0?null:c.loop,f=c.palette===void 0?null:c.palette;if(a<=0||o<=0||a>65535||o>65535)throw new Error("Width/Height invalid.");function p(_){var D=_.length;if(D<2||D>256||D&D-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return D}i[l++]=71,i[l++]=73,i[l++]=70,i[l++]=56,i[l++]=57,i[l++]=97;var g=0,y=0;if(f!==null){for(var x=p(f);x>>=1;)++g;if(x=1<<g,--g,c.background!==void 0){if(y=c.background,y>=x)throw new Error("Background index out of range.");if(y===0)throw new Error("Background index explicitly passed as 0.")}}if(i[l++]=a&255,i[l++]=a>>8&255,i[l++]=o&255,i[l++]=o>>8&255,i[l++]=(f!==null?128:0)|g,i[l++]=y,i[l++]=0,f!==null)for(var v=0,S=f.length;v<S;++v){var w=f[v];i[l++]=w>>16&255,i[l++]=w>>8&255,i[l++]=w&255}if(h!==null){if(h<0||h>65535)throw new Error("Loop count invalid.");i[l++]=33,i[l++]=255,i[l++]=11,i[l++]=78,i[l++]=69,i[l++]=84,i[l++]=83,i[l++]=67,i[l++]=65,i[l++]=80,i[l++]=69,i[l++]=50,i[l++]=46,i[l++]=48,i[l++]=3,i[l++]=1,i[l++]=h&255,i[l++]=h>>8&255,i[l++]=0}var E=!1;this.addFrame=function(_,D,I,k,A,N){if(E===!0&&(--l,E=!1),N=N===void 0?{}:N,_<0||D<0||_>65535||D>65535)throw new Error("x/y invalid.");if(I<=0||k<=0||I>65535||k>65535)throw new Error("Width/Height invalid.");if(A.length<I*k)throw new Error("Not enough pixels for the frame size.");var F=!0,$=N.palette;if($==null&&(F=!1,$=f),$==null)throw new Error("Must supply either a local or global palette.");for(var O=p($),M=0;O>>=1;)++M;O=1<<M;var B=N.delay===void 0?0:N.delay,U=N.disposal===void 0?0:N.disposal;if(U<0||U>3)throw new Error("Disposal out of range.");var V=!1,Z=0;if(N.transparent!==void 0&&N.transparent!==null&&(V=!0,Z=N.transparent,Z<0||Z>=O))throw new Error("Transparent color index.");if((U!==0||V||B!==0)&&(i[l++]=33,i[l++]=249,i[l++]=4,i[l++]=U<<2|(V===!0?1:0),i[l++]=B&255,i[l++]=B>>8&255,i[l++]=Z,i[l++]=0),i[l++]=44,i[l++]=_&255,i[l++]=_>>8&255,i[l++]=D&255,i[l++]=D>>8&255,i[l++]=I&255,i[l++]=I>>8&255,i[l++]=k&255,i[l++]=k>>8&255,i[l++]=F===!0?128|M-1:0,F===!0)for(var J=0,ne=$.length;J<ne;++J){var z=$[J];i[l++]=z>>16&255,i[l++]=z>>8&255,i[l++]=z&255}return l=t(i,l,M<2?2:M,A),l},this.end=function(){return E===!1&&(i[l++]=59,E=!0),l},this.getOutputBuffer=function(){return i},this.setOutputBuffer=function(_){i=_},this.getOutputBufferPosition=function(){return l},this.setOutputBufferPosition=function(_){l=_}}function t(i,a,o,u){i[a++]=o;var l=a++,c=1<<o,h=c-1,f=c+1,p=f+1,g=o+1,y=0,x=0;function v(N){for(;y>=N;)i[a++]=x&255,x>>=8,y-=8,a===l+256&&(i[l]=255,l=a++)}function S(N){x|=N<<y,y+=g,v(8)}var w=u[0]&h,E={};S(c);for(var _=1,D=u.length;_<D;++_){var I=u[_]&h,k=w<<8|I,A=E[k];if(A===void 0){for(x|=w<<y,y+=g;y>=8;)i[a++]=x&255,x>>=8,y-=8,a===l+256&&(i[l]=255,l=a++);p===4096?(S(c),p=f+1,g=o+1,E={}):(p>=1<<g&&++g,E[k]=p++),w=I}else w=A}return S(w),S(f),v(1),l+1===a?i[l]=0:(i[l]=a-l-1,i[a++]=0),a}function n(i){var a=0;if(i[a++]!==71||i[a++]!==73||i[a++]!==70||i[a++]!==56||(i[a++]+1&253)!==56||i[a++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=i[a++]|i[a++]<<8,u=i[a++]|i[a++]<<8,l=i[a++],c=l>>7,h=l&7,f=1<<h+1;i[a++],i[a++];var p=null,g=null;c&&(p=a,g=f,a+=f*3);var y=!0,x=[],v=0,S=null,w=0,E=null;for(this.width=o,this.height=u;y&&a<i.length;)switch(i[a++]){case 33:switch(i[a++]){case 255:if(i[a]!==11||i[a+1]==78&&i[a+2]==69&&i[a+3]==84&&i[a+4]==83&&i[a+5]==67&&i[a+6]==65&&i[a+7]==80&&i[a+8]==69&&i[a+9]==50&&i[a+10]==46&&i[a+11]==48&&i[a+12]==3&&i[a+13]==1&&i[a+16]==0)a+=14,E=i[a++]|i[a++]<<8,a++;else for(a+=12;;){var _=i[a++];if(!(_>=0))throw Error("Invalid block size");if(_===0)break;a+=_}break;case 249:if(i[a++]!==4||i[a+4]!==0)throw new Error("Invalid graphics extension block.");var D=i[a++];v=i[a++]|i[a++]<<8,S=i[a++],(D&1)===0&&(S=null),w=D>>2&7,a++;break;case 254:for(;;){var _=i[a++];if(!(_>=0))throw Error("Invalid block size");if(_===0)break;a+=_}break;default:throw new Error("Unknown graphic control label: 0x"+i[a-1].toString(16))}break;case 44:var I=i[a++]|i[a++]<<8,k=i[a++]|i[a++]<<8,A=i[a++]|i[a++]<<8,N=i[a++]|i[a++]<<8,F=i[a++],$=F>>7,O=F>>6&1,M=F&7,B=1<<M+1,U=p,V=g,Z=!1;if($){var Z=!0;U=a,V=B,a+=B*3}var J=a;for(a++;;){var _=i[a++];if(!(_>=0))throw Error("Invalid block size");if(_===0)break;a+=_}x.push({x:I,y:k,width:A,height:N,has_local_palette:Z,palette_offset:U,palette_size:V,data_offset:J,data_length:a-J,transparent_index:S,interlaced:!!O,delay:v,disposal:w});break;case 59:y=!1;break;default:throw new Error("Unknown gif block: 0x"+i[a-1].toString(16))}this.numFrames=function(){return x.length},this.loopCount=function(){return E},this.frameInfo=function(ne){if(ne<0||ne>=x.length)throw new Error("Frame index out of range.");return x[ne]},this.decodeAndBlitFrameBGRA=function(ne,z){var X=this.frameInfo(ne),Y=X.width*X.height,se=new Uint8Array(Y);s(i,X.data_offset,se,Y);var ue=X.palette_offset,fe=X.transparent_index;fe===null&&(fe=256);var de=X.width,be=o-de,Me=de,_e=(X.y*o+X.x)*4,Ne=((X.y+X.height)*o+X.x)*4,ve=_e,Pe=be*4;X.interlaced===!0&&(Pe+=o*4*7);for(var et=8,Ve=0,re=se.length;Ve<re;++Ve){var Q=se[Ve];if(Me===0&&(ve+=Pe,Me=de,ve>=Ne&&(Pe=be*4+o*4*(et-1),ve=_e+(de+be)*(et<<1),et>>=1)),Q===fe)ve+=4;else{var ce=i[ue+Q*3],xe=i[ue+Q*3+1],Ge=i[ue+Q*3+2];z[ve++]=Ge,z[ve++]=xe,z[ve++]=ce,z[ve++]=255}--Me}},this.decodeAndBlitFrameRGBA=function(ne,z){var X=this.frameInfo(ne),Y=X.width*X.height,se=new Uint8Array(Y);s(i,X.data_offset,se,Y);var ue=X.palette_offset,fe=X.transparent_index;fe===null&&(fe=256);var de=X.width,be=o-de,Me=de,_e=(X.y*o+X.x)*4,Ne=((X.y+X.height)*o+X.x)*4,ve=_e,Pe=be*4;X.interlaced===!0&&(Pe+=o*4*7);for(var et=8,Ve=0,re=se.length;Ve<re;++Ve){var Q=se[Ve];if(Me===0&&(ve+=Pe,Me=de,ve>=Ne&&(Pe=be*4+o*4*(et-1),ve=_e+(de+be)*(et<<1),et>>=1)),Q===fe)ve+=4;else{var ce=i[ue+Q*3],xe=i[ue+Q*3+1],Ge=i[ue+Q*3+2];z[ve++]=ce,z[ve++]=xe,z[ve++]=Ge,z[ve++]=255}--Me}}}function s(i,a,o,u){for(var l=i[a++],c=1<<l,h=c+1,f=h+1,p=l+1,g=(1<<p)-1,y=0,x=0,v=0,S=i[a++],w=new Int32Array(4096),E=null;;){for(;y<16&&S!==0;)x|=i[a++]<<y,y+=8,S===1?S=i[a++]:--S;if(y<p)break;var _=x&g;if(x>>=p,y-=p,_===c){f=h+1,p=l+1,g=(1<<p)-1,E=null;continue}else if(_===h)break;for(var D=_<f?_:E,I=0,k=D;k>c;)k=w[k]>>8,++I;var A=k,N=v+I+(D!==_?1:0);if(N>u){console.log("Warning, gif stream longer than expected.");return}o[v++]=A,v+=I;var F=v;for(D!==_&&(o[v++]=A),k=D;I--;)k=w[k],o[--F]=k&255,k>>=8;E!==null&&f<4096&&(w[f++]=E<<8|A,f>=g+1&&p<12&&(++p,g=g<<1|1)),E=_}return v!==u&&console.log("Warning, gif stream shorter than expected."),o}try{vy.GifWriter=r,vy.GifReader=n}catch{}return vy}var c8=SQ();function CQ(r,t,n=s=>s){const s=Object.create(null);if(s.options=t||{},s.reviver=n,s.value="",s.entry=[],s.output=[],s.col=1,s.row=1,s.options.delimiter=s.options.delimiter===void 0?'"':t.delimiter,s.options.delimiter.length>1||s.options.delimiter.length===0)throw Error(`CSVError: delimiter must be one character [${s.options.separator}]`);if(s.options.separator=s.options.separator===void 0?",":t.separator,s.options.separator.length>1||s.options.separator.length===0)throw Error(`CSVError: separator must be one character [${s.options.separator}]`);const i=new RegExp(`${Pf(s.options.delimiter)}|${Pf(s.options.separator)}|\r
|
|\r|[^${Pf(s.options.delimiter)}${Pf(s.options.separator)}\r
]+`,"y"),a=/^(\r\n|\n|\r)$/;let o=[],u="",l=0;for(;(o=i.exec(r))!==null;)switch(u=o[0],l){case 0:switch(!0){case u===s.options.delimiter:l=3;break;case u===s.options.separator:l=0,pc(s);break;case a.test(u):l=0,pc(s),wy(s);break;default:s.value+=u,l=2;break}break;case 2:switch(!0){case u===s.options.separator:l=0,pc(s);break;case a.test(u):l=0,pc(s),wy(s);break;default:throw l=4,Error(`CSVError: Illegal state [row:${s.row}, col:${s.col}]`)}break;case 3:switch(!0){case u===s.options.delimiter:l=4;break;default:l=3,s.value+=u;break}break;case 4:switch(!0){case u===s.options.delimiter:l=3,s.value+=u;break;case u===s.options.separator:l=0,pc(s);break;case a.test(u):l=0,pc(s),wy(s);break;default:throw Error(`CSVError: Illegal state [row:${s.row}, col:${s.col}]`)}break}return s.entry.length!==0&&(pc(s),wy(s)),s.output}function _Q(r,t={},n=s=>s){const s=Object.create(null);if(s.options=t,s.options.eof=s.options.eof!==void 0?s.options.eof:!0,s.row=1,s.col=1,s.output="",s.options.delimiter=s.options.delimiter===void 0?'"':t.delimiter,s.options.delimiter.length>1||s.options.delimiter.length===0)throw Error(`CSVError: delimiter must be one character [${s.options.separator}]`);if(s.options.separator=s.options.separator===void 0?",":t.separator,s.options.separator.length>1||s.options.separator.length===0)throw Error(`CSVError: separator must be one character [${s.options.separator}]`);const i=new RegExp(`${Pf(s.options.delimiter)}|${Pf(s.options.separator)}|\r
|
|\r`);return r.forEach((a,o)=>{let u="";switch(s.col=1,a.forEach((l,c)=>{typeof l=="string"&&(l=l.replace(new RegExp(s.options.delimiter,"g"),`${s.options.delimiter}${s.options.delimiter}`),l=i.test(l)?`${s.options.delimiter}${l}${s.options.delimiter}`:l),u+=n(l,s.row,s.col),c!==a.length-1&&(u+=s.options.separator),s.col++}),!0){case s.options.eof:case(!s.options.eof&&o!==r.length-1):s.output+=`${u}
`;break;default:s.output+=`${u}`;break}s.row++}),s.output}function pc(r){const t=r.options.typed?EQ(r.value):r.value;r.entry.push(r.reviver(t,r.row,r.col)),r.value="",r.col++}function wy(r){r.output.push(r.entry),r.entry=[],r.row++,r.col=1}function EQ(r){const t=/.\./;switch(!0){case r==="true":case r==="false":return r==="true";case t.test(r):return parseFloat(r);case isFinite(r):return parseInt(r);default:return r}}function Pf(r){return r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var DQ={trailer:59};function h8(r=256){let t=0,n=new Uint8Array(r);return{get buffer(){return n.buffer},reset(){t=0},bytesView(){return n.subarray(0,t)},bytes(){return n.slice(0,t)},writeByte(i){s(t+1),n[t]=i,t++},writeBytes(i,a=0,o=i.length){s(t+o);for(let u=0;u<o;u++)n[t++]=i[u+a]},writeBytesView(i,a=0,o=i.byteLength){s(t+o),n.set(i.subarray(a,a+o),t),t+=o}};function s(i){var a=n.length;if(a>=i)return;var o=1024*1024;i=Math.max(i,a*(a<o?2:1.125)>>>0),a!=0&&(i=Math.max(i,256));let u=n;n=new Uint8Array(i),t>0&&n.set(u.subarray(0,t),0)}}var vC=12,nF=5003,TQ=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function NQ(r,t,n,s,i=h8(512),a=new Uint8Array(256),o=new Int32Array(nF),u=new Int32Array(nF)){let l=o.length,c=Math.max(2,s);a.fill(0),u.fill(0),o.fill(-1);let h=0,f=0,p=c+1,g=p,y=!1,x=g,v=(1<<x)-1,S=1<<p-1,w=S+1,E=S+2,_=0,D=n[0],I=0;for(let N=l;N<65536;N*=2)++I;I=8-I,i.writeByte(c),A(S);let k=n.length;for(let N=1;N<k;N++)e:{let F=n[N],$=(F<<vC)+D,O=F<<I^D;if(o[O]===$){D=u[O];break e}let M=O===0?1:l-O;for(;o[O]>=0;)if(O-=M,O<0&&(O+=l),o[O]===$){D=u[O];break e}A(D),D=F,E<1<<vC?(u[O]=E++,o[O]=$):(o.fill(-1),E=S+2,y=!0,A(S))}return A(D),A(w),i.writeByte(0),i.bytesView();function A(N){for(h&=TQ[f],f>0?h|=N<<f:h=N,f+=x;f>=8;)a[_++]=h&255,_>=254&&(i.writeByte(_),i.writeBytesView(a,0,_),_=0),h>>=8,f-=8;if((E>v||y)&&(y?(x=g,v=(1<<x)-1,y=!1):(++x,v=x===vC?1<<x:(1<<x)-1)),N==w){for(;f>0;)a[_++]=h&255,_>=254&&(i.writeByte(_),i.writeBytesView(a,0,_),_=0),h>>=8,f-=8;_>0&&(i.writeByte(_),i.writeBytesView(a,0,_),_=0)}}}var kQ=NQ;function AQ(r,t,n){return r<<8&63488|t<<2&992|n>>3}function IQ(r,t,n,s){return r>>4|t&240|(n&240)<<4|(s&240)<<8}function $Q(r,t,n){return r>>4<<8|t&240|n>>4}function Sy(r,t,n){return r<t?t:r>n?n:r}function Jy(r){return r*r}function rF(r,t,n){var s=0,i=1e100;let a=r[t],o=a.cnt;a.ac;let u=a.rc,l=a.gc,c=a.bc;for(var h=a.fw;h!=0;h=r[h].fw){let p=r[h],g=p.cnt,y=o*g/(o+g);if(!(y>=i)){var f=0;f+=y*Jy(p.rc-u),!(f>=i)&&(f+=y*Jy(p.gc-l),!(f>=i)&&(f+=y*Jy(p.bc-c),!(f>=i)&&(i=f,s=h)))}}a.err=i,a.nn=s}function wC(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function FQ(r,t){let n=t==="rgb444"?4096:65536,s=new Array(n),i=r.length;if(t==="rgba4444")for(let a=0;a<i;++a){let o=r[a],u=o>>24&255,l=o>>16&255,c=o>>8&255,h=o&255,f=IQ(h,c,l,u),p=f in s?s[f]:s[f]=wC();p.rc+=h,p.gc+=c,p.bc+=l,p.ac+=u,p.cnt++}else if(t==="rgb444")for(let a=0;a<i;++a){let o=r[a],u=o>>16&255,l=o>>8&255,c=o&255,h=$Q(c,l,u),f=h in s?s[h]:s[h]=wC();f.rc+=c,f.gc+=l,f.bc+=u,f.cnt++}else for(let a=0;a<i;++a){let o=r[a],u=o>>16&255,l=o>>8&255,c=o&255,h=AQ(c,l,u),f=h in s?s[h]:s[h]=wC();f.rc+=c,f.gc+=l,f.bc+=u,f.cnt++}return s}function RQ(r,t,n={}){let{format:s="rgb565",clearAlpha:i=!0,clearAlphaColor:a=0,clearAlphaThreshold:o=0,oneBitAlpha:u=!1}=n;if(!r||!r.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(r instanceof Uint8Array)&&!(r instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");let l=new Uint32Array(r.buffer),c=n.useSqrt!==!1,h=s==="rgba4444",f=FQ(l,s),p=f.length,g=p-1,y=new Uint32Array(p+1);for(var x=0,v=0;v<p;++v){let B=f[v];if(B!=null){var S=1/B.cnt;h&&(B.ac*=S),B.rc*=S,B.gc*=S,B.bc*=S,f[x++]=B}}Jy(t)/x<.022&&(c=!1);for(var v=0;v<x-1;++v)f[v].fw=v+1,f[v+1].bk=v,c&&(f[v].cnt=Math.sqrt(f[v].cnt));c&&(f[v].cnt=Math.sqrt(f[v].cnt));var w,E,_;for(v=0;v<x;++v){rF(f,v);var D=f[v].err;for(E=++y[0];E>1&&(_=E>>1,!(f[w=y[_]].err<=D));E=_)y[E]=w;y[E]=v}var I=x-t;for(v=0;v<I;){for(var k;;){var A=y[1];if(k=f[A],k.tm>=k.mtm&&f[k.nn].mtm<=k.tm)break;k.mtm==g?A=y[1]=y[y[0]--]:(rF(f,A),k.tm=v);var D=f[A].err;for(E=1;(_=E+E)<=y[0]&&(_<y[0]&&f[y[_]].err>f[y[_+1]].err&&_++,!(D<=f[w=y[_]].err));E=_)y[E]=w;y[E]=A}var N=f[k.nn],F=k.cnt,$=N.cnt,S=1/(F+$);h&&(k.ac=S*(F*k.ac+$*N.ac)),k.rc=S*(F*k.rc+$*N.rc),k.gc=S*(F*k.gc+$*N.gc),k.bc=S*(F*k.bc+$*N.bc),k.cnt+=N.cnt,k.mtm=++v,f[N.bk].fw=N.fw,f[N.fw].bk=N.bk,N.mtm=g}let O=[];var M=0;for(v=0;;++M){let B=Sy(Math.round(f[v].rc),0,255),U=Sy(Math.round(f[v].gc),0,255),V=Sy(Math.round(f[v].bc),0,255),Z=255;h&&(Z=Sy(Math.round(f[v].ac),0,255),u&&(Z=Z<=(typeof u=="number"?u:127)?0:255),i&&Z<=o&&(B=U=V=a,Z=0));let J=h?[B,U,V,Z]:[B,U,V];if(OQ(O,J)||O.push(J),(v=f[v].fw)==0)break}return O}function OQ(r,t){for(let n=0;n<r.length;n++){let s=r[n],i=s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2],a=s.length>=4&&t.length>=4?s[3]===t[3]:!0;if(i&&a)return!0}return!1}function MQ(r,t){var n=0,s;for(s=0;s<r.length;s++){let i=r[s]-t[s];n+=i*i}return n}function LQ(r,t,n=MQ){let s=1/0,i=-1;for(let a=0;a<r.length;a++){let o=r[a],u=n(t,o);u<s&&(s=u,i=a)}return i}function BQ(r={}){let{initialCapacity:t=4096,auto:n=!0}=r,s=h8(t),i=5003,a=new Uint8Array(256),o=new Int32Array(i),u=new Int32Array(i),l=!1;return{reset(){s.reset(),l=!1},finish(){s.writeByte(DQ.trailer)},bytes(){return s.bytes()},bytesView(){return s.bytesView()},get buffer(){return s.buffer},get stream(){return s},writeHeader:c,writeFrame(h,f,p,g={}){let{transparent:y=!1,transparentIndex:x=0,delay:v=0,palette:S=null,repeat:w=0,colorDepth:E=8,dispose:_=-1}=g,D=!1;if(n?l||(D=!0,c(),l=!0):D=!!g.first,f=Math.max(0,Math.floor(f)),p=Math.max(0,Math.floor(p)),D){if(!S)throw new Error("First frame must include a { palette } option");VQ(s,f,p,S,E),sF(s,S),w>=0&&zQ(s,w)}let I=Math.round(v/10);PQ(s,_,I,y,x);let k=!!S&&!D;UQ(s,f,p,k?S:null),k&&sF(s,S),GQ(s,h,f,p,E,a,o,u)}};function c(){f8(s,"GIF89a")}}function PQ(r,t,n,s,i){r.writeByte(33),r.writeByte(249),r.writeByte(4),i<0&&(i=0,s=!1);var a,o;s?(a=1,o=2):(a=0,o=0),t>=0&&(o=t&7),o<<=2,r.writeByte(0|o|0|a),dl(r,n),r.writeByte(i||0),r.writeByte(0)}function VQ(r,t,n,s,i=8){let a=1,o=0,u=mT(s.length)-1,l=a<<7|i-1<<4|o<<3|u;dl(r,t),dl(r,n),r.writeBytes([l,0,0])}function zQ(r,t){r.writeByte(33),r.writeByte(255),r.writeByte(11),f8(r,"NETSCAPE2.0"),r.writeByte(3),r.writeByte(1),dl(r,t),r.writeByte(0)}function sF(r,t){let n=1<<mT(t.length);for(let s=0;s<n;s++){let i=[0,0,0];s<t.length&&(i=t[s]),r.writeByte(i[0]),r.writeByte(i[1]),r.writeByte(i[2])}}function UQ(r,t,n,s){if(r.writeByte(44),dl(r,0),dl(r,0),dl(r,t),dl(r,n),s){let i=0,a=0,o=mT(s.length)-1;r.writeByte(128|i|a|0|o)}else r.writeByte(0)}function GQ(r,t,n,s,i=8,a,o,u){kQ(n,s,t,i,r,a,o,u)}function dl(r,t){r.writeByte(t&255),r.writeByte(t>>8&255)}function f8(r,t){for(var n=0;n<t.length;n++)r.writeByte(t.charCodeAt(n))}function mT(r){return Math.max(Math.ceil(Math.log2(r)),1)}function gT(r,t){t.blend=function(...s){this._renderer?this._renderer.blend(...s):r.Renderer2D.prototype.blend.apply(this,s)},t.copy=function(...s){let i,a,o,u,l,c,h,f,p;if(s.length===9)i=s[0],a=s[1],o=s[2],u=s[3],l=s[4],c=s[5],h=s[6],f=s[7],p=s[8];else if(s.length===8)i=this,a=s[0],o=s[1],u=s[2],l=s[3],c=s[4],h=s[5],f=s[6],p=s[7];else throw new Error("Signature not supported");t._copyHelper(this,i,a,o,u,l,c,h,f,p)},t._copyHelper=(s,i,a,o,u,l,c,h,f,p)=>{const g=i.canvas.width/i.width;let y=0,x=0;i._renderer&&i._renderer.isP3D&&(y=i.width/2,x=i.height/2),s._renderer&&s._renderer.isP3D?(s.push(),s.resetMatrix(),s.noLights(),s.blendMode(s.BLEND),s.imageMode(s.CORNER),s._renderer.image(i,a+y,o+x,u,l,c,h,f,p),s.pop()):s.drawingContext.drawImage(i.canvas,g*(a+y),g*(o+x),g*u,g*l,c,h,f,p)},t.getFilterGraphicsLayer=function(){return this._renderer.getFilterGraphicsLayer()},t.filter=function(...s){let{shader:i,operation:a,value:o,useWebGL:u}=n(...s);if(this._renderer.isP3D&&i){this._renderer.filter(i);return}if(!u&&!this._renderer.isP3D){this.canvas!==void 0?Gn.apply(this.canvas,Gn[a],o):Gn.apply(this.elt,Gn[a],o);return}!u&&this._renderer.isP3D&&console.warn("filter() with useWebGL=false is not supported in WEBGL"),this._renderer.isP3D?this._renderer.filter(a,o):(i?this._renderer.filterRenderer.setOperation(a,o,i):this._renderer.filterRenderer.setOperation(a,o),this._renderer.filterRenderer.applyFilter())};function n(...s){let i={shader:void 0,operation:void 0,value:void 0,useWebGL:!0};return s[0]instanceof r.Shader?(i.shader=s[0],i):(i.operation=s[0],s.length>1&&typeof s[1]=="number"&&(i.value=s[1]),s[s.length-1]===!1&&(i.useWebGL=!1),i)}t.get=function(s,i,a,o){return this._renderer.get(...arguments)},t.loadPixels=function(...s){this._renderer.loadPixels()},t.set=function(s,i,a){this._renderer.set(s,i,a)},t.updatePixels=function(s,i,a,o){this.pixels.length!==0&&this._renderer.updatePixels(s,i,a,o)}}typeof p5<"u"&&gT(p5,p5.prototype);var VD;const SA=class SA{constructor(...t){Jn(this,VD,null);if(this.constructor===SA)throw new Error("Class is of abstract type and can't be instantiated");["add","setElement","reset","set","get","copy","clone","diagonal","row","column","transpose","mult","multiplyVec","invert","createSubMatrix3x3","inverseTranspose4x4","apply","scale","rotate4x4","translate","rotateX","rotateY","rotateZ","perspective","ortho","multiplyVec4","multiplyPoint","multiplyAndNormalizePoint","multiplyDirection","multiplyVec3"].forEach(s=>{if(this[s]===void 0)throw new Error(`${s}() method must be implemented`)})}};VD=new WeakMap;let Y_=SA;const SC=r=>{if(Math.sqrt(Array.from(r).length)%1!==0)throw new Error("Array length must be a perfect square.");return!0};let au=Array,Sc=r=>Array.isArray(r);typeof Float32Array<"u"&&(au=Float32Array,Sc=r=>Array.isArray(r)||r instanceof Float32Array);var Un,Or,Z_,d8,p8,m8,g8,y8,x8,b8,v8,jQ;const yo=class yo extends Y_{constructor(...n){super(...n);Jn(this,Or);Bt(this,"matrix");Jn(this,Un);if(Sc(n[0])&&SC(n[0])){const s=Math.sqrt(Array.from(n[0]).length);Hs(this,Un,s),this.matrix=au.from(n[0])}else typeof n[0]=="number"&&(Hs(this,Un,Number(n[0])),this.matrix=Yr(this,Or,Z_).call(this,n[0]));return this}get mat3(){if(dt(this,Un)===3)return this.matrix}get mat4(){if(dt(this,Un)===4)return this.matrix}add(n){if(this.matrix.length!==n.matrix.length)throw new Error("Matrices must be of the same dimension to add.");for(let s=0;s<this.matrix.length;s++)this.matrix[s]+=n.matrix[s];return this}setElement(n,s){return n>=0&&n<this.matrix.length&&(this.matrix[n]=s),this}reset(){return this.matrix=Yr(this,Or,Z_).call(this,dt(this,Un)),this}set(n){let s=au.from([...arguments]);return n instanceof yo?s=au.from(n.matrix):Sc(n)&&(s=au.from(n)),s.length!==this.matrix.length?(p5._friendlyError(`Expected same dimensions values but received different ${s.length}.`,"p5.Matrix.set"),this):(this.matrix=s,this)}get(){return new yo(this.matrix)}copy(){return new yo(this.matrix)}clone(){return this.copy()}diagonal(){const n=[];for(let s=0;s<dt(this,Un);s++)n.push(this.matrix[s*(dt(this,Un)+1)]);return n}row(n){const s=[];for(let i=0;i<dt(this,Un);i++)s.push(this.matrix[i*dt(this,Un)+n]);return new Ee(...s)}column(n){const s=[];for(let i=0;i<dt(this,Un);i++)s.push(this.matrix[n*dt(this,Un)+i]);return new Ee(...s)}transpose(n){return dt(this,Un)===4?Yr(this,Or,y8).call(this,n):dt(this,Un)===3?Yr(this,Or,x8).call(this,n):Yr(this,Or,g8).call(this,n)}mult(n){let s;return n===this||n===this.matrix?s=this.copy().matrix:n instanceof yo?s=n.matrix:Sc(n)&&SC(n)?s=n:SC(arguments)&&(s=Array.from(arguments)),dt(this,Un)===4&&s.length===16?Yr(this,Or,d8).call(this,s):dt(this,Un)===3&&s.length===9?Yr(this,Or,m8).call(this,s):Yr(this,Or,p8).call(this,s)}multiplyVec(n,s){s===void 0&&(s=n.copy());for(let i=0;i<dt(this,Un);i++)s.values[i]=this.row(i).dot(n);return s}invert(n){if(dt(this,Un)===4)return Yr(this,Or,b8).call(this,n);if(dt(this,Un)===3)return Yr(this,Or,v8).call(this,n);throw new Error("Invert is not implemented for N>4 at the moment, we are working on it")}createSubMatrix3x3(){if(dt(this,Un)===4){const n=new yo(3);return n.mat3[0]=this.matrix[0],n.mat3[1]=this.matrix[1],n.mat3[2]=this.matrix[2],n.mat3[3]=this.matrix[4],n.mat3[4]=this.matrix[5],n.mat3[5]=this.matrix[6],n.mat3[6]=this.matrix[8],n.mat3[7]=this.matrix[9],n.mat3[8]=this.matrix[10],n}else throw new Error("Matrix dimension must be 4 to create a 3x3 submatrix.")}inverseTranspose4x4({mat4:n}){if(dt(this,Un)!==3)throw new Error("This function only works with 33 matrices.");this.matrix[0]=n[0],this.matrix[1]=n[1],this.matrix[2]=n[2],this.matrix[3]=n[4],this.matrix[4]=n[5],this.matrix[5]=n[6],this.matrix[6]=n[8],this.matrix[7]=n[9],this.matrix[8]=n[10];const s=this.invert();if(s)s.transpose(this.matrix);else for(let i=0;i<9;i++)this.matrix[i]=0;return this}apply(n){let s;if(n===this||n===this.matrix)s=this.copy().matrix;else if(n instanceof yo)s=n.matrix;else if(Sc(n))s=n;else if(arguments.length===16)s=arguments;else return;const i=this.matrix,a=i[0],o=i[4],u=i[8],l=i[12];i[0]=s[0]*a+s[1]*o+s[2]*u+s[3]*l,i[4]=s[4]*a+s[5]*o+s[6]*u+s[7]*l,i[8]=s[8]*a+s[9]*o+s[10]*u+s[11]*l,i[12]=s[12]*a+s[13]*o+s[14]*u+s[15]*l;const c=i[1],h=i[5],f=i[9],p=i[13];i[1]=s[0]*c+s[1]*h+s[2]*f+s[3]*p,i[5]=s[4]*c+s[5]*h+s[6]*f+s[7]*p,i[9]=s[8]*c+s[9]*h+s[10]*f+s[11]*p,i[13]=s[12]*c+s[13]*h+s[14]*f+s[15]*p;const g=i[2],y=i[6],x=i[10],v=i[14];i[2]=s[0]*g+s[1]*y+s[2]*x+s[3]*v,i[6]=s[4]*g+s[5]*y+s[6]*x+s[7]*v,i[10]=s[8]*g+s[9]*y+s[10]*x+s[11]*v,i[14]=s[12]*g+s[13]*y+s[14]*x+s[15]*v;const S=i[3],w=i[7],E=i[11],_=i[15];return i[3]=s[0]*S+s[1]*w+s[2]*E+s[3]*_,i[7]=s[4]*S+s[5]*w+s[6]*E+s[7]*_,i[11]=s[8]*S+s[9]*w+s[10]*E+s[11]*_,i[15]=s[12]*S+s[13]*w+s[14]*E+s[15]*_,this}scale(n,s,i){return n instanceof Ee?(s=n.y,i=n.z,n=n.x):n instanceof Array&&(s=n[1],i=n[2],n=n[0]),this.matrix[0]*=n,this.matrix[1]*=n,this.matrix[2]*=n,this.matrix[3]*=n,this.matrix[4]*=s,this.matrix[5]*=s,this.matrix[6]*=s,this.matrix[7]*=s,this.matrix[8]*=i,this.matrix[9]*=i,this.matrix[10]*=i,this.matrix[11]*=i,this}rotate4x4(n,s,i,a){s instanceof Ee?(i=s.y,a=s.z,s=s.x):s instanceof Array&&(i=s[1],a=s[2],s=s[0]);const o=Math.sqrt(s*s+i*i+a*a);s*=1/o,i*=1/o,a*=1/o;const u=this.matrix[0],l=this.matrix[1],c=this.matrix[2],h=this.matrix[3],f=this.matrix[4],p=this.matrix[5],g=this.matrix[6],y=this.matrix[7],x=this.matrix[8],v=this.matrix[9],S=this.matrix[10],w=this.matrix[11],E=Math.sin(n),_=Math.cos(n),D=1-_,I=s*s*D+_,k=i*s*D+a*E,A=a*s*D-i*E,N=s*i*D-a*E,F=i*i*D+_,$=a*i*D+s*E,O=s*a*D+i*E,M=i*a*D-s*E,B=a*a*D+_;return this.matrix[0]=u*I+f*k+x*A,this.matrix[1]=l*I+p*k+v*A,this.matrix[2]=c*I+g*k+S*A,this.matrix[3]=h*I+y*k+w*A,this.matrix[4]=u*N+f*F+x*$,this.matrix[5]=l*N+p*F+v*$,this.matrix[6]=c*N+g*F+S*$,this.matrix[7]=h*N+y*F+w*$,this.matrix[8]=u*O+f*M+x*B,this.matrix[9]=l*O+p*M+v*B,this.matrix[10]=c*O+g*M+S*B,this.matrix[11]=h*O+y*M+w*B,this}translate(n){const s=n[0],i=n[1],a=n[2]||0;return this.matrix[12]+=this.matrix[0]*s+this.matrix[4]*i+this.matrix[8]*a,this.matrix[13]+=this.matrix[1]*s+this.matrix[5]*i+this.matrix[9]*a,this.matrix[14]+=this.matrix[2]*s+this.matrix[6]*i+this.matrix[10]*a,this.matrix[15]+=this.matrix[3]*s+this.matrix[7]*i+this.matrix[11]*a,this}rotateX(n){this.rotate4x4(n,1,0,0)}rotateY(n){this.rotate4x4(n,0,1,0)}rotateZ(n){this.rotate4x4(n,0,0,1)}perspective(n,s,i,a){const o=1/Math.tan(n/2),u=1/(i-a);return this.matrix[0]=o/s,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=o,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=(a+i)*u,this.matrix[11]=-1,this.matrix[12]=0,this.matrix[13]=0,this.matrix[14]=2*a*i*u,this.matrix[15]=0,this}ortho(n,s,i,a,o,u){const l=1/(n-s),c=1/(i-a),h=1/(o-u);return this.matrix[0]=-2*l,this.matrix[1]=0,this.matrix[2]=0,this.matrix[3]=0,this.matrix[4]=0,this.matrix[5]=-2*c,this.matrix[6]=0,this.matrix[7]=0,this.matrix[8]=0,this.matrix[9]=0,this.matrix[10]=2*h,this.matrix[11]=0,this.matrix[12]=(n+s)*l,this.matrix[13]=(a+i)*c,this.matrix[14]=(u+o)*h,this.matrix[15]=1,this}multiplyVec4(n,s,i,a){const o=new Array(4),u=this.matrix;return o[0]=u[0]*n+u[4]*s+u[8]*i+u[12]*a,o[1]=u[1]*n+u[5]*s+u[9]*i+u[13]*a,o[2]=u[2]*n+u[6]*s+u[10]*i+u[14]*a,o[3]=u[3]*n+u[7]*s+u[11]*i+u[15]*a,o}multiplyPoint({x:n,y:s,z:i}){const a=this.multiplyVec4(n,s,i,1);return new Ee(a[0],a[1],a[2])}multiplyAndNormalizePoint({x:n,y:s,z:i}){const a=this.multiplyVec4(n,s,i,1);return a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],new Ee(a[0],a[1],a[2])}multiplyDirection({x:n,y:s,z:i}){const a=this.multiplyVec4(n,s,i,0);return new Ee(a[0],a[1],a[2])}multiplyVec3(n,s){return s===void 0&&(s=n.copy()),s.x=this.row(0).dot(n),s.y=this.row(1).dot(n),s.z=this.row(2).dot(n),s}};Un=new WeakMap,Or=new WeakSet,Z_=function(n){if(n===3)return new au([1,0,0,0,1,0,0,0,1]);if(n===4)return new au([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);const s=new au(n*n).fill(0);for(let i=0;i<n;i++)s[i*n+i]=1;return s},d8=function(n){let s=this.matrix[0],i=this.matrix[1],a=this.matrix[2],o=this.matrix[3];return this.matrix[0]=s*n[0]+i*n[4]+a*n[8]+o*n[12],this.matrix[1]=s*n[1]+i*n[5]+a*n[9]+o*n[13],this.matrix[2]=s*n[2]+i*n[6]+a*n[10]+o*n[14],this.matrix[3]=s*n[3]+i*n[7]+a*n[11]+o*n[15],s=this.matrix[4],i=this.matrix[5],a=this.matrix[6],o=this.matrix[7],this.matrix[4]=s*n[0]+i*n[4]+a*n[8]+o*n[12],this.matrix[5]=s*n[1]+i*n[5]+a*n[9]+o*n[13],this.matrix[6]=s*n[2]+i*n[6]+a*n[10]+o*n[14],this.matrix[7]=s*n[3]+i*n[7]+a*n[11]+o*n[15],s=this.matrix[8],i=this.matrix[9],a=this.matrix[10],o=this.matrix[11],this.matrix[8]=s*n[0]+i*n[4]+a*n[8]+o*n[12],this.matrix[9]=s*n[1]+i*n[5]+a*n[9]+o*n[13],this.matrix[10]=s*n[2]+i*n[6]+a*n[10]+o*n[14],this.matrix[11]=s*n[3]+i*n[7]+a*n[11]+o*n[15],s=this.matrix[12],i=this.matrix[13],a=this.matrix[14],o=this.matrix[15],this.matrix[12]=s*n[0]+i*n[4]+a*n[8]+o*n[12],this.matrix[13]=s*n[1]+i*n[5]+a*n[9]+o*n[13],this.matrix[14]=s*n[2]+i*n[6]+a*n[10]+o*n[14],this.matrix[15]=s*n[3]+i*n[7]+a*n[11]+o*n[15],this},p8=function(n){if(n.length!==this.matrix.length)throw new Error("Matrices must be of the same dimension to multiply.");const s=new au(this.matrix.length).fill(0);for(let i=0;i<dt(this,Un);i++)for(let a=0;a<dt(this,Un);a++)for(let o=0;o<dt(this,Un);o++)s[i*dt(this,Un)+a]+=this.matrix[i*dt(this,Un)+o]*n[o*dt(this,Un)+a];return this.matrix=s,this},m8=function(n){let s=this.mat3[0],i=this.mat3[1],a=this.mat3[2];return this.mat3[0]=s*n[0]+i*n[3]+a*n[6],this.mat3[1]=s*n[1]+i*n[4]+a*n[7],this.mat3[2]=s*n[2]+i*n[5]+a*n[8],s=this.mat3[3],i=this.mat3[4],a=this.mat3[5],this.mat3[3]=s*n[0]+i*n[3]+a*n[6],this.mat3[4]=s*n[1]+i*n[4]+a*n[7],this.mat3[5]=s*n[2]+i*n[5]+a*n[8],s=this.mat3[6],i=this.mat3[7],a=this.mat3[8],this.mat3[6]=s*n[0]+i*n[3]+a*n[6],this.mat3[7]=s*n[1]+i*n[4]+a*n[7],this.mat3[8]=s*n[2]+i*n[5]+a*n[8],this},g8=function(){const n=dt(this,Un);for(let s=0;s<n;s++)for(let i=0;i<n;i++)this.matrix[s*n+i]=this.matrix[i*n+s];return this},y8=function(n){console.log("====> 4x4");let s,i,a,o,u,l;return n instanceof yo?(s=n.matrix[1],i=n.matrix[2],a=n.matrix[3],o=n.matrix[6],u=n.matrix[7],l=n.matrix[11],this.matrix[0]=n.matrix[0],this.matrix[1]=n.matrix[4],this.matrix[2]=n.matrix[8],this.matrix[3]=n.matrix[12],this.matrix[4]=s,this.matrix[5]=n.matrix[5],this.matrix[6]=n.matrix[9],this.matrix[7]=n.matrix[13],this.matrix[8]=i,this.matrix[9]=o,this.matrix[10]=n.matrix[10],this.matrix[11]=n.matrix[14],this.matrix[12]=a,this.matrix[13]=u,this.matrix[14]=l,this.matrix[15]=n.matrix[15]):Sc(n)&&(s=n[1],i=n[2],a=n[3],o=n[6],u=n[7],l=n[11],this.matrix[0]=n[0],this.matrix[1]=n[4],this.matrix[2]=n[8],this.matrix[3]=n[12],this.matrix[4]=s,this.matrix[5]=n[5],this.matrix[6]=n[9],this.matrix[7]=n[13],this.matrix[8]=i,this.matrix[9]=o,this.matrix[10]=n[10],this.matrix[11]=n[14],this.matrix[12]=a,this.matrix[13]=u,this.matrix[14]=l,this.matrix[15]=n[15]),this},x8=function(n){n===void 0&&(n=this.mat3);const s=n[1],i=n[2],a=n[5];return this.mat3[0]=n[0],this.mat3[1]=n[3],this.mat3[2]=n[6],this.mat3[3]=s,this.mat3[4]=n[4],this.mat3[5]=n[7],this.mat3[6]=i,this.mat3[7]=a,this.mat3[8]=n[8],this},b8=function(n){let s,i,a,o,u,l,c,h,f,p,g,y,x,v,S,w;n instanceof yo?(s=n.matrix[0],i=n.matrix[1],a=n.matrix[2],o=n.matrix[3],u=n.matrix[4],l=n.matrix[5],c=n.matrix[6],h=n.matrix[7],f=n.matrix[8],p=n.matrix[9],g=n.matrix[10],y=n.matrix[11],x=n.matrix[12],v=n.matrix[13],S=n.matrix[14],w=n.matrix[15]):Sc(n)&&(s=n[0],i=n[1],a=n[2],o=n[3],u=n[4],l=n[5],c=n[6],h=n[7],f=n[8],p=n[9],g=n[10],y=n[11],x=n[12],v=n[13],S=n[14],w=n[15]);const E=s*l-i*u,_=s*c-a*u,D=s*h-o*u,I=i*c-a*l,k=i*h-o*l,A=a*h-o*c,N=f*v-p*x,F=f*S-g*x,$=f*w-y*x,O=p*S-g*v,M=p*w-y*v,B=g*w-y*S;let U=E*B-_*M+D*O+I*$-k*F+A*N;return U?(U=1/U,this.matrix[0]=(l*B-c*M+h*O)*U,this.matrix[1]=(a*M-i*B-o*O)*U,this.matrix[2]=(v*A-S*k+w*I)*U,this.matrix[3]=(g*k-p*A-y*I)*U,this.matrix[4]=(c*$-u*B-h*F)*U,this.matrix[5]=(s*B-a*$+o*F)*U,this.matrix[6]=(S*D-x*A-w*_)*U,this.matrix[7]=(f*A-g*D+y*_)*U,this.matrix[8]=(u*M-l*$+h*N)*U,this.matrix[9]=(i*$-s*M-o*N)*U,this.matrix[10]=(x*k-v*D+w*E)*U,this.matrix[11]=(p*D-f*k-y*E)*U,this.matrix[12]=(l*F-u*O-c*N)*U,this.matrix[13]=(s*O-i*F+a*N)*U,this.matrix[14]=(v*_-x*I-S*E)*U,this.matrix[15]=(f*I-p*_+g*E)*U,this):null},v8=function(){const n=this.mat3[0],s=this.mat3[1],i=this.mat3[2],a=this.mat3[3],o=this.mat3[4],u=this.mat3[5],l=this.mat3[6],c=this.mat3[7],h=this.mat3[8],f=h*o-u*c,p=-h*a+u*l,g=c*a-o*l;let y=n*f+s*p+i*g;return y?(y=1/y,this.mat3[0]=f*y,this.mat3[1]=(-h*s+i*c)*y,this.mat3[2]=(u*s-i*o)*y,this.mat3[3]=p*y,this.mat3[4]=(h*n-i*l)*y,this.mat3[5]=(-u*n+i*a)*y,this.mat3[6]=g*y,this.mat3[7]=(-c*n+s*l)*y,this.mat3[8]=(o*n-s*a)*y,this):null},jQ=function(){if(dt(this,Un)!==4)throw new Error("Determinant is only implemented for 4x4 matrices. We are working on it.");const n=this.matrix[0]*this.matrix[5]-this.matrix[1]*this.matrix[4],s=this.matrix[0]*this.matrix[6]-this.matrix[2]*this.matrix[4],i=this.matrix[0]*this.matrix[7]-this.matrix[3]*this.matrix[4],a=this.matrix[1]*this.matrix[6]-this.matrix[2]*this.matrix[5],o=this.matrix[1]*this.matrix[7]-this.matrix[3]*this.matrix[5],u=this.matrix[2]*this.matrix[7]-this.matrix[3]*this.matrix[6],l=this.matrix[8]*this.matrix[13]-this.matrix[9]*this.matrix[12],c=this.matrix[8]*this.matrix[14]-this.matrix[10]*this.matrix[12],h=this.matrix[8]*this.matrix[15]-this.matrix[11]*this.matrix[12],f=this.matrix[9]*this.matrix[14]-this.matrix[10]*this.matrix[13],p=this.matrix[9]*this.matrix[15]-this.matrix[11]*this.matrix[13],g=this.matrix[10]*this.matrix[15]-this.matrix[11]*this.matrix[14];return n*g-s*p+i*f+a*h-o*c+u*l};let zr=yo;function w8(r,t){r.Matrix=zr}typeof p5<"u"&&w8(p5,p5.prototype);class Tc{constructor(t=128){this.length=0,this.data=new Float32Array(t),this.initialLength=t}dataArray(){return this.subArray(0,this.length)}clear(){this.length=0}rescale(){if(this.length<this.data.length/2){const t=1<<Math.ceil(Math.log2(this.length)),n=new Float32Array(t);n.set(this.data.subarray(0,this.length),0),this.data=n}}reset(){this.clear(),this.data=new Float32Array(this.initialLength)}push(...t){this.ensureLength(this.length+t.length),this.data.set(t,this.length),this.length+=t.length}slice(t,n){return this.data.slice(t,Math.min(n,this.length))}subArray(t,n){return this.data.subarray(t,Math.min(n,this.length))}ensureLength(t){for(;this.data.length<t;){const n=new Float32Array(this.data.length*2);n.set(this.data,0),this.data=n}}}function S8(r,t){r.DataArray=Tc}typeof p5<"u"&&S8(p5,p5.prototype);class Ts{constructor(t,n,s,i){this.renderer=i,this.vertices=[],this.boundingBoxCache=null,this.lineVertices=new Tc,this.lineTangentsIn=new Tc,this.lineTangentsOut=new Tc,this.lineSides=new Tc,this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.userVertexProperties={},this.lineVertexColors=new Tc,this.detailX=t!==void 0?t:1,this.detailY=n!==void 0?n:1,this.dirtyFlags={},this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.gid=`_p5_Geometry_${Ts.nextId}`,Ts.nextId++,s instanceof Function&&s.call(this)}calculateBoundingBox(){if(this.boundingBoxCache)return this.boundingBoxCache;let t=new Ee(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new Ee(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);for(let a=0;a<this.vertices.length;a++){let o=this.vertices[a];t.x=Math.min(t.x,o.x),t.y=Math.min(t.y,o.y),t.z=Math.min(t.z,o.z),n.x=Math.max(n.x,o.x),n.y=Math.max(n.y,o.y),n.z=Math.max(n.z,o.z)}let s=new Ee(n.x-t.x,n.y-t.y,n.z-t.z),i=new Ee((t.x+n.x)/2,(t.y+n.y)/2,(t.z+n.z)/2);return this.boundingBoxCache={min:t,max:n,size:s,offset:i},this.boundingBoxCache}reset(){this._hasFillTransparency=void 0,this._hasStrokeTransparency=void 0,this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear(),this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.clear(),this.vertexNormals.length=0,this.uvs.length=0;for(const t in this.userVertexProperties)this.userVertexProperties[t].delete();this.userVertexProperties={},this.dirtyFlags={}}hasFillTransparency(){if(this._hasFillTransparency===void 0){this._hasFillTransparency=!1;for(let t=0;t<this.vertexColors.length;t+=4)if(this.vertexColors[t+3]<1){this._hasFillTransparency=!0;break}}return this._hasFillTransparency}hasStrokeTransparency(){if(this._hasStrokeTransparency===void 0){this._hasStrokeTransparency=!1;for(let t=0;t<this.lineVertexColors.length;t+=4)if(this.lineVertexColors[t+3]<1){this._hasStrokeTransparency=!0;break}}return this._hasStrokeTransparency}clearColors(){return this.vertexColors=[],this}saveObj(t="model.obj"){let n="";if(this.vertices.forEach(i=>{n+=`v ${i.x} ${i.y} ${i.z}
`}),this.uvs&&this.uvs.length>0)for(let i=0;i<this.uvs.length;i+=2)n+=`vt ${this.uvs[i]} ${this.uvs[i+1]}
`;this.vertexNormals&&this.vertexNormals.length>0&&this.vertexNormals.forEach(i=>{n+=`vn ${i.x} ${i.y} ${i.z}
`}),this.faces.forEach(i=>{let a="f";i.forEach(o=>{a+=" ",a+=o+1,(this.vertexNormals.length>0||this.uvs.length>0)&&(a+="/",this.uvs.length>0&&(a+=o+1),a+="/",this.vertexNormals.length>0&&(a+=o+1))}),n+=a+`
`});const s=new Blob([n],{type:"text/plain"});fn.downloadFile(s,t,"obj")}saveStl(t="model.stl",{binary:n=!1}={}){let s,i=t.substring(0,t.lastIndexOf(".")),a=[];for(let u of this.faces){const l=Ee.sub(this.vertices[u[1]],this.vertices[u[0]]),c=Ee.sub(this.vertices[u[2]],this.vertices[u[0]]),h=l.y*c.z-l.z*c.y,f=l.z*c.x-l.x*c.z,p=l.x*c.y-l.y*c.x;a.push(new Ee(h,f,p).normalize())}if(n){let u=80;const l=this.faces.length*2+this.faces.length*3*4*4+80+4,c=new ArrayBuffer(l);s=new DataView(c),s.setUint32(u,this.faces.length,!0),u+=4;for(const[h,f]of Object.entries(this.faces)){const p=a[h];s.setFloat32(u,p.x,!0),u+=4,s.setFloat32(u,p.y,!0),u+=4,s.setFloat32(u,p.z,!0),u+=4;for(let g of f){const y=this.vertices[g];s.setFloat32(u,y.x,!0),u+=4,s.setFloat32(u,y.y,!0),u+=4,s.setFloat32(u,y.z,!0),u+=4}s.setUint16(u,0,!0),u+=2}}else{s="solid "+i+`
`;for(const[u,l]of Object.entries(this.faces)){const c=a[u];s+=" facet norm "+c.x+" "+c.y+" "+c.z+`
`,s+=`  outer loop
`;for(let h of l){const f=this.vertices[h];s+="   vertex "+f.x+" "+f.y+" "+f.z+`
`}s+=`  endloop
`,s+=` endfacet
`}s+="endsolid "+i+`
`}const o=new Blob([s],{type:"text/plain"});fn.downloadFile(o,t,"stl")}flipU(){this.uvs=this.uvs.flat().map((t,n)=>n%2===0?1-t:t)}flipV(){this.uvs=this.uvs.flat().map((t,n)=>n%2===0?t:1-t)}computeFaces(){this.faces.length=0;const t=this.detailX+1;let n,s,i,a;for(let o=0;o<this.detailY;o++)for(let u=0;u<this.detailX;u++)n=o*t+u,s=o*t+u+1,i=(o+1)*t+u+1,a=(o+1)*t+u,this.faces.push([n,s,a]),this.faces.push([a,s,i]);return this}_getFaceNormal(t){const n=this.faces[t],s=this.vertices[n[0]],i=this.vertices[n[1]],a=this.vertices[n[2]],o=Ee.sub(i,s),u=Ee.sub(a,s),l=Ee.cross(o,u),c=Ee.mag(l);let h=c/(Ee.mag(o)*Ee.mag(u));return h===0||isNaN(h)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),l):(h>1&&(h=1),l.mult(Math.asin(h)/c))}computeNormals(t=h6,{roundToPrecision:n=3}={}){const s=this.vertexNormals;let i=this.vertices;const a=this.faces;let o;if(t===f6){const u={},l=[],c=Math.pow(10,n),h=p=>Math.round(p*c)/c,f=p=>`${h(p.x)},${h(p.y)},${h(p.z)}`;for(let p=0;p<i.length;p++){const g=i[p],y=f(g);u[y]===void 0&&(u[y]=l.length,l.push(g))}a.forEach(p=>{for(let g=0;g<3;++g){const y=p[g],x=i[y],v=f(x);p[g]=u[v]}}),this.edges.forEach(p=>{for(let g=0;g<2;++g){const y=p[g],x=i[y],v=f(x);p[g]=u[v]}}),this.vertices=i=l}for(s.length=0,o=0;o<i.length;++o)s.push(new Ee);for(a.forEach((u,l)=>{const c=this._getFaceNormal(l);for(let h=0;h<3;++h){const f=u[h];s[f].add(c)}}),o=0;o<i.length;++o)s[o].normalize();return this}averageNormals(){for(let t=0;t<=this.detailY;t++){const n=this.detailX+1;let s=Ee.add(this.vertexNormals[t*n],this.vertexNormals[t*n+this.detailX]);s=Ee.div(s,2),this.vertexNormals[t*n]=s,this.vertexNormals[t*n+this.detailX]=s}return this}averagePoleNormals(){let t=new Ee(0,0,0);for(let n=0;n<this.detailX;n++)t.add(this.vertexNormals[n]);t=Ee.div(t,this.detailX);for(let n=0;n<this.detailX;n++)this.vertexNormals[n]=t;t=new Ee(0,0,0);for(let n=this.vertices.length-1;n>this.vertices.length-1-this.detailX;n--)t.add(this.vertexNormals[n]);t=Ee.div(t,this.detailX);for(let n=this.vertices.length-1;n>this.vertices.length-1-this.detailX;n--)this.vertexNormals[n]=t;return this}_makeTriangleEdges(){this.edges.length=0;for(let t=0;t<this.faces.length;t++)this.edges.push([this.faces[t][0],this.faces[t][1]]),this.edges.push([this.faces[t][1],this.faces[t][2]]),this.edges.push([this.faces[t][2],this.faces[t][0]]);return this}makeEdgesFromFaces(){this._makeTriangleEdges()}_edgesToVertices(){var i;this.lineVertices.clear(),this.lineTangentsIn.clear(),this.lineTangentsOut.clear(),this.lineSides.clear();const t=new Map,n=new Set;let s;for(let a=0;a<this.edges.length;a++){const o=this.edges[a-1],u=this.edges[a],l=this.vertices[u[0]],c=this.vertices[u[1]],h=this.vertexStrokeColors.length>0&&o?this.vertexStrokeColors.slice(o[1]*4,(o[1]+1)*4):[0,0,0,0],f=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(u[0]*4,(u[0]+1)*4):[0,0,0,0],p=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(u[1]*4,(u[1]+1)*4):[0,0,0,0],g=c.copy().sub(l).normalize(),y=g.magSq()>0;if(y&&this._addSegment(l,c,f,p,g),!((i=this.renderer)!=null&&i._simpleLines)){if(a>0&&o[1]===u[0])n.has(u[0])||(n.add(u[0]),t.delete(u[0]),s&&y&&g.dot(s)<1-1e-8&&this._addJoin(l,s,g,f));else{if(y&&!n.has(u[0])){const x=t.get(u[0]);x?(this._addJoin(l,x.dir,g,f),t.delete(u[0]),n.add(u[0])):t.set(u[0],{point:l,dir:g.copy().mult(-1),color:f})}if(s&&!n.has(o[1])){const x=t.get(o[1]);x?(this._addJoin(this.vertices[o[1]],s,x.dir.copy().mult(-1),h),t.delete(o[1]),n.add(o[1])):t.set(o[1],{point:this.vertices[o[1]],dir:s,color:h}),s=void 0}}if(a===this.edges.length-1&&!n.has(u[1])){const x=t.get(u[1]);x?(this._addJoin(c,g,x.dir.copy().mult(-1),p),t.delete(u[1]),n.add(u[1])):t.set(u[1],{point:c,dir:g,color:p})}y&&(s=g)}}for(const{point:a,dir:o,color:u}of t.values())this._addCap(a,o,u);return this}_addSegment(t,n,s,i,a){var c;const o=t.array(),u=n.array(),l=a.array();this.lineSides.push(1,1,-1,1,-1,-1);for(const h of[this.lineTangentsIn,this.lineTangentsOut])for(let f=0;f<6;f++)h.push(...l);return this.lineVertices.push(...o,...u,...o,...u,...u,...o),(c=this.renderer)!=null&&c._simpleLines||this.lineVertexColors.push(...s,...i,...s,...i,...i,...s),this}_addCap(t,n,s){const i=t.array(),a=n.array(),o=[0,0,0];for(let u=0;u<6;u++)this.lineVertices.push(...i),this.lineTangentsIn.push(...a),this.lineTangentsOut.push(...o),this.lineVertexColors.push(...s);return this.lineSides.push(-1,2,-2,1,2,-1),this}_addJoin(t,n,s,i){const a=t.array(),o=n.array(),u=s.array();for(let l=0;l<12;l++)this.lineVertices.push(...a),this.lineTangentsIn.push(...o),this.lineTangentsOut.push(...u),this.lineVertexColors.push(...i);return this.lineSides.push(-1,-3,-2,-1,0,-3),this.lineSides.push(3,1,2,3,0,1),this}normalize(){if(this.vertices.length>0){const t=this.vertices[0].copy(),n=this.vertices[0].copy();for(let u=0;u<this.vertices.length;u++)t.x=Math.max(t.x,this.vertices[u].x),n.x=Math.min(n.x,this.vertices[u].x),t.y=Math.max(t.y,this.vertices[u].y),n.y=Math.min(n.y,this.vertices[u].y),t.z=Math.max(t.z,this.vertices[u].z),n.z=Math.min(n.z,this.vertices[u].z);const s=Ee.lerp(t,n,.5),i=Ee.sub(t,n),o=200/Math.max(Math.max(i.x,i.y),i.z);for(let u=0;u<this.vertices.length;u++)this.vertices[u].sub(s),this.vertices[u].mult(o)}return this}vertexProperty(t,n,s){let i;this.userVertexProperties[t]||(i=this.userVertexProperties[t]=this._userVertexPropertyHelper(t,n,s)),i=this.userVertexProperties[t],s?i.pushDirect(n):(i.setCurrentData(n),i.pushCurrentData())}_userVertexPropertyHelper(t,n,s){const i=this,a=this.userVertexProperties[t]={name:t,dataSize:s||(n.length?n.length:1),geometry:i,getName(){return this.name},getCurrentData(){return this.currentData===void 0&&(this.currentData=new Array(this.getDataSize()).fill(0)),this.currentData},getDataSize(){return this.dataSize},getSrcName(){return this.name.concat("Src")},getDstName(){return this.name.concat("Buffer")},getSrcArray(){const o=this.getSrcName();return this.geometry[o]},setCurrentData(o){o.length&&o.length,this.currentData=o},pushCurrentData(){const o=this.getCurrentData();this.pushDirect(o)},pushDirect(o){o.length?this.getSrcArray().push(...o):this.getSrcArray().push(o)},resetSrcArray(){this.geometry[this.getSrcName()]=[]},delete(){const o=this.getSrcName();delete this.geometry[o],delete this}};return this[a.getSrcName()]=[],this.userVertexProperties[t]}}Ts.nextId=0;function C8(r,t){r.Geometry=Ts}typeof p5<"u"&&C8(p5,p5.prototype);class Zm{constructor(t){this.renderer=t,t._pInst.push(),this.identityMatrix=new zr(4),t.states.setValue("uModelMatrix",new zr(4)),this.geometry=new Ts(void 0,void 0,void 0,this.renderer),this.geometry.gid=`_p5_GeometryBuilder_${Zm.nextGeometryId}`,Zm.nextGeometryId++,this.hasTransform=!1}transformVertices(t){return this.hasTransform?t.map(n=>this.renderer.states.uModelMatrix.multiplyPoint(n)):t}transformNormals(t){return this.hasTransform?t.map(n=>this.renderer.scratchMat3.multiplyVec(n)):t}addGeometry(t){this.hasTransform=!this.renderer.states.uModelMatrix.mat4.every((u,l)=>u===this.identityMatrix.mat4[l]),this.hasTransform&&this.renderer.scratchMat3.inverseTranspose4x4(this.renderer.states.uModelMatrix);let n=this.geometry.vertices.length;this.geometry.vertices.push(...this.transformVertices(t.vertices)),this.geometry.vertexNormals.push(...this.transformNormals(t.vertexNormals)),this.geometry.uvs.push(...t.uvs);const s=t.userVertexProperties,i=this.geometry.userVertexProperties,a=this.geometry.vertices.length-t.vertices.length;for(const u in i){if(u in s)continue;const l=i[u],h=l.getDataSize()*t.vertices.length,f=Array(h).fill(0);l.pushDirect(f)}for(const u in s){const l=s[u],c=l.getSrcArray(),h=l.getDataSize();if(a>0&&!(u in i)){const f=h*a,p=Array(f).fill(0);this.geometry.vertexProperty(u,p,h)}this.geometry.vertexProperty(u,c,h)}this.renderer.states.fillColor&&this.geometry.faces.push(...t.faces.map(u=>u.map(l=>l+n))),this.renderer.states.strokeColor&&this.geometry.edges.push(...t.edges.map(u=>u.map(l=>l+n)));const o=[...t.vertexColors];for(;o.length<t.vertices.length*4;)o.push(...this.renderer.states.curFillColor);this.geometry.vertexColors.push(...o)}addImmediate(t,n){const s=[];if(this.renderer.states.fillColor)if(n===zm||n===Um)for(let i=2;i<t.vertices.length;i++)i%2===0?s.push([i,i-1,i-2]):s.push([i,i-2,i-1]);else if(n===Wb)for(let i=2;i<t.vertices.length;i++)s.push([0,i-1,i]);else for(let i=0;i<t.vertices.length;i+=3)s.push([i,i+1,i+2]);this.addGeometry(Object.assign({},t,{faces:s}))}addRetained(t){this.addGeometry(t)}finish(){return this.renderer._pInst.pop(),this.geometry}}Zm.nextGeometryId=0;class Xf{constructor(t,n,s,i){this.w=t,this.vec=new Ee(n,s,i)}static fromAxisAngle(t,n,s,i){const a=Math.cos(t/2),o=new Ee(n,s,i).normalize().mult(Math.sin(t/2));return new Xf(a,o.x,o.y,o.z)}conjugate(){return new Xf(this.w,-this.vec.x,-this.vec.y,-this.vec.z)}multiply(t){return new Xf(this.w*t.w-this.vec.x*t.vec.x-this.vec.y*t.vec.y-this.vec.z-t.vec.z,this.w*t.vec.x+this.vec.x*t.w+this.vec.y*t.vec.z-this.vec.z*t.vec.y,this.w*t.vec.y-this.vec.x*t.vec.z+this.vec.y*t.w+this.vec.z*t.vec.x,this.w*t.vec.z+this.vec.x*t.vec.y-this.vec.y*t.vec.x+this.vec.z*t.w)}rotateVector(t){return Ee.mult(t,this.w*this.w-this.vec.dot(this.vec)).add(Ee.mult(this.vec,2*t.dot(this.vec))).add(Ee.mult(this.vec,2*this.w).cross(t)).clampToZero()}rotateBy(t){return t.multiply(this).multiply(t.conjugate()).vec.clampToZero()}}function _8(r,t){r.Quat=Xf}typeof p5<"u"&&_8(p5,p5.prototype);class ii{constructor(t,n,s,i,a,o){this.size=t,this.src=n,this.dst=s,this.attr=i,this._renderer=a,this.map=o}_prepareBuffer(t,n){const s=n.attributes,i=this._renderer.GL,a=this._renderer._getOrMakeCachedBuffers(t),o=s[this.attr];if(!o)return;let u=a[this.dst];const l=t[this.src];if(l&&l.length>0){const c=!u;if(c&&(a[this.dst]=u=i.createBuffer()),i.bindBuffer(i.ARRAY_BUFFER,u),c||t.dirtyFlags[this.src]!==!1){const h=this.map,f=h?h(l):l;this._renderer._bindBuffer(u,i.ARRAY_BUFFER,f),t.dirtyFlags[this.src]=!1}n.enableAttrib(o,this.size)}else{const c=o.location;if(c===-1||!this._renderer.registerEnabled.has(c))return;i.disableVertexAttribArray(c),this._renderer.registerEnabled.delete(c)}}}function E8(r,t){r.RenderBuffer=ii}typeof p5<"u"&&E8(p5,p5.prototype);var ex={exports:{}},iF=ex.exports,aF;function WQ(){return aF||(aF=1,function(r){var t;function n(P,K){return P.b===K.b&&P.a===K.a}function s(P,K){return P.b<K.b||P.b===K.b&&P.a<=K.a}function i(P,K,ie){var le=K.b-P.b,ge=ie.b-K.b;return 0<le+ge?le<ge?K.a-P.a+le/(le+ge)*(P.a-ie.a):K.a-ie.a+ge/(le+ge)*(ie.a-P.a):0}function a(P,K,ie){var le=K.b-P.b,ge=ie.b-K.b;return 0<le+ge?(K.a-ie.a)*le+(K.a-P.a)*ge:0}function o(P,K){return P.a<K.a||P.a===K.a&&P.b<=K.b}function u(P,K,ie){var le=K.a-P.a,ge=ie.a-K.a;return 0<le+ge?le<ge?K.b-P.b+le/(le+ge)*(P.b-ie.b):K.b-ie.b+ge/(le+ge)*(ie.b-P.b):0}function l(P,K,ie){var le=K.a-P.a,ge=ie.a-K.a;return 0<le+ge?(K.b-ie.b)*le+(K.b-P.b)*ge:0}function c(P){return s(P.b.a,P.a)}function h(P){return s(P.a,P.b.a)}function f(P,K,ie,le){return P=0>P?0:P,ie=0>ie?0:ie,P<=ie?ie===0?(K+le)/2:K+P/(P+ie)*(le-K):le+ie/(P+ie)*(K-le)}function p(P){var K=S(P.b);return E(K,P.c),E(K.b,P.c),_(K,P.a),K}function g(P,K){var ie=!1,le=!1;P!==K&&(K.a!==P.a&&(le=!0,I(K.a,P.a)),K.d!==P.d&&(ie=!0,k(K.d,P.d)),w(K,P),le||(E(K,P.a),P.a.c=P),ie||(_(K,P.d),P.d.a=P))}function y(P){var K=P.b,ie=!1;P.d!==P.b.d&&(ie=!0,k(P.d,P.b.d)),P.c===P?I(P.a,null):(P.b.d.a=ce(P),P.a.c=P.c,w(P,ce(P)),ie||_(P,P.d)),K.c===K?(I(K.a,null),k(K.d,null)):(P.d.a=ce(K),K.a.c=K.c,w(K,ce(K))),D(P)}function x(P){var K=S(P),ie=K.b;return w(K,P.e),K.a=P.b.a,E(ie,K.a),K.d=ie.d=P.d,K=K.b,w(P.b,ce(P.b)),w(P.b,K),P.b.a=K.a,K.b.a.c=K.b,K.b.d=P.b.d,K.f=P.f,K.b.f=P.b.f,K}function v(P,K){var ie=!1,le=S(P),ge=le.b;return K.d!==P.d&&(ie=!0,k(K.d,P.d)),w(le,P.e),w(ge,K),le.a=P.b.a,ge.a=K.a,le.d=ge.d=P.d,P.d.a=ge,ie||_(le,P.d),le}function S(P){var K=new Q,ie=new Q,le=P.b.h;return ie.h=le,le.b.h=K,K.h=P,P.b.h=ie,K.b=ie,K.c=K,K.e=ie,ie.b=K,ie.c=ie,ie.e=K}function w(P,K){var ie=P.c,le=K.c;ie.b.e=K,le.b.e=P,P.c=le,K.c=ie}function E(P,K){var ie=K.f,le=new Ge(K,ie);ie.e=le,K.f=le,ie=le.c=P;do ie.a=le,ie=ie.c;while(ie!==P)}function _(P,K){var ie=K.d,le=new re(K,ie);ie.b=le,K.d=le,le.a=P,le.c=K.c,ie=P;do ie.d=le,ie=ie.e;while(ie!==P)}function D(P){var K=P.h;P=P.b.h,K.b.h=P,P.b.h=K}function I(P,K){var ie=P.c,le=ie;do le.a=K,le=le.c;while(le!==ie);ie=P.f,le=P.e,le.f=ie,ie.e=le}function k(P,K){var ie=P.a,le=ie;do le.d=K,le=le.e;while(le!==ie);ie=P.d,le=P.b,le.d=ie,ie.b=le}function A(P){var K=0;return Math.abs(P[1])>Math.abs(P[0])&&(K=1),Math.abs(P[2])>Math.abs(P[K])&&(K=2),K}var N=4*1e150;function F(P,K){P.f+=K.f,P.b.f+=K.b.f}function $(P,K,ie){return P=P.a,K=K.a,ie=ie.a,K.b.a===P?ie.b.a===P?s(K.a,ie.a)?0>=a(ie.b.a,K.a,ie.a):0<=a(K.b.a,ie.a,K.a):0>=a(ie.b.a,P,ie.a):ie.b.a===P?0<=a(K.b.a,P,K.a):(K=i(K.b.a,P,K.a),P=i(ie.b.a,P,ie.a),K>=P)}function O(P){P.a.i=null;var K=P.e;K.a.c=K.c,K.c.a=K.a,P.e=null}function M(P,K){y(P.a),P.c=!1,P.a=K,K.i=P}function B(P){var K=P.a.a;do P=Pn(P);while(P.a.a===K);return P.c&&(K=v(sn(P).a.b,P.a.e),M(P,K),P=Pn(P)),P}function U(P,K,ie){var le=new qn;return le.a=ie,le.e=_e(P.f,K.e,le),ie.i=le}function V(P,K){switch(P.s){case 100130:return(K&1)!==0;case 100131:return K!==0;case 100132:return 0<K;case 100133:return 0>K;case 100134:return 2<=K||-2>=K}return!1}function Z(P){var K=P.a,ie=K.d;ie.c=P.d,ie.a=K,O(P)}function J(P,K,ie){for(P=K,K=K.a;P!==ie;){P.c=!1;var le=sn(P),ge=le.a;if(ge.a!==K.a){if(!le.c){Z(P);break}ge=v(K.c.b,ge.b),M(le,ge)}K.c!==ge&&(g(ce(ge),ge),g(K,ge)),Z(P),K=le.a,P=le}return K}function ne(P,K,ie,le,ge,Xe){var nt=!0;do U(P,K,ie.b),ie=ie.c;while(ie!==le);for(ge===null&&(ge=sn(K).a.b.c);le=sn(K),ie=le.a.b,ie.a===ge.a;)ie.c!==ge&&(g(ce(ie),ie),g(ce(ge),ie)),le.f=K.f-ie.f,le.d=V(P,le.f),K.b=!0,!nt&&se(P,K)&&(F(ie,ge),O(K),y(ge)),nt=!1,K=le,ge=ie;K.b=!0,Xe&&fe(P,K)}function z(P,K,ie,le,ge){var Xe=[K.g[0],K.g[1],K.g[2]];K.d=null,K.d=P.o&&P.o(Xe,ie,le,P.c)||null,K.d===null&&(ge?P.n||(Ve(P,100156),P.n=!0):K.d=ie[0])}function X(P,K,ie){var le=[null,null,null,null];le[0]=K.a.d,le[1]=ie.a.d,z(P,K.a,le,[.5,.5,0,0],!1),g(K,ie)}function Y(P,K,ie,le,ge){var Xe=Math.abs(K.b-P.b)+Math.abs(K.a-P.a),nt=Math.abs(ie.b-P.b)+Math.abs(ie.a-P.a),gt=ge+1;le[ge]=.5*nt/(Xe+nt),le[gt]=.5*Xe/(Xe+nt),P.g[0]+=le[ge]*K.g[0]+le[gt]*ie.g[0],P.g[1]+=le[ge]*K.g[1]+le[gt]*ie.g[1],P.g[2]+=le[ge]*K.g[2]+le[gt]*ie.g[2]}function se(P,K){var ie=sn(K),le=K.a,ge=ie.a;if(s(le.a,ge.a)){if(0<a(ge.b.a,le.a,ge.a))return!1;if(!n(le.a,ge.a))x(ge.b),g(le,ce(ge)),K.b=ie.b=!0;else if(le.a!==ge.a){var ie=P.e,Xe=le.a.h;if(0<=Xe){var ie=ie.b,nt=ie.d,gt=ie.e,Ft=ie.c,qt=Ft[Xe];nt[qt]=nt[ie.a],Ft[nt[qt]]=qt,qt<=--ie.a&&(1>=qt||s(gt[nt[qt>>1]],gt[nt[qt]])?St(ie,qt):hr(ie,qt)),gt[Xe]=null,Ft[Xe]=ie.b,ie.b=Xe}else for(ie.c[-(Xe+1)]=null;0<ie.a&&ie.c[ie.d[ie.a-1]]===null;)--ie.a;X(P,ce(ge),le)}}else{if(0>a(le.b.a,ge.a,le.a))return!1;Pn(K).b=K.b=!0,x(le.b),g(ce(ge),le)}return!0}function ue(P,K){var ie=sn(K),le=K.a,ge=ie.a,Xe=le.a,nt=ge.a,gt=le.b.a,Ft=ge.b.a,qt=new Ge;if(a(gt,P.a,Xe),a(Ft,P.a,nt),Xe===nt||Math.min(Xe.a,gt.a)>Math.max(nt.a,Ft.a))return!1;if(s(Xe,nt)){if(0<a(Ft,Xe,nt))return!1}else if(0>a(gt,nt,Xe))return!1;var Vn=gt,L=Xe,q=Ft,W=nt,H,ae;if(s(Vn,L)||(H=Vn,Vn=L,L=H),s(q,W)||(H=q,q=W,W=H),s(Vn,q)||(H=Vn,Vn=q,q=H,H=L,L=W,W=H),s(q,L)?s(L,W)?(H=i(Vn,q,L),ae=i(q,L,W),0>H+ae&&(H=-H,ae=-ae),qt.b=f(H,q.b,ae,L.b)):(H=a(Vn,q,L),ae=-a(Vn,W,L),0>H+ae&&(H=-H,ae=-ae),qt.b=f(H,q.b,ae,W.b)):qt.b=(q.b+L.b)/2,o(Vn,L)||(H=Vn,Vn=L,L=H),o(q,W)||(H=q,q=W,W=H),o(Vn,q)||(H=Vn,Vn=q,q=H,H=L,L=W,W=H),o(q,L)?o(L,W)?(H=u(Vn,q,L),ae=u(q,L,W),0>H+ae&&(H=-H,ae=-ae),qt.a=f(H,q.a,ae,L.a)):(H=l(Vn,q,L),ae=-l(Vn,W,L),0>H+ae&&(H=-H,ae=-ae),qt.a=f(H,q.a,ae,W.a)):qt.a=(q.a+L.a)/2,s(qt,P.a)&&(qt.b=P.a.b,qt.a=P.a.a),Vn=s(Xe,nt)?Xe:nt,s(Vn,qt)&&(qt.b=Vn.b,qt.a=Vn.a),n(qt,Xe)||n(qt,nt))return se(P,K),!1;if(!n(gt,P.a)&&0<=a(gt,P.a,qt)||!n(Ft,P.a)&&0>=a(Ft,P.a,qt)){if(Ft===P.a)return x(le.b),g(ge.b,le),K=B(K),le=sn(K).a,J(P,sn(K),ie),ne(P,K,ce(le),le,le,!0),!0;if(gt===P.a){x(ge.b),g(le.e,ce(ge)),Xe=ie=K,nt=Xe.a.b.a;do Xe=Pn(Xe);while(Xe.a.b.a===nt);return K=Xe,Xe=sn(K).a.b.c,ie.a=ce(ge),ge=J(P,ie,null),ne(P,K,ge.c,le.b.c,Xe,!0),!0}return 0<=a(gt,P.a,qt)&&(Pn(K).b=K.b=!0,x(le.b),le.a.b=P.a.b,le.a.a=P.a.a),0>=a(Ft,P.a,qt)&&(K.b=ie.b=!0,x(ge.b),ge.a.b=P.a.b,ge.a.a=P.a.a),!1}return x(le.b),x(ge.b),g(ce(ge),le),le.a.b=qt.b,le.a.a=qt.a,le.a.h=ot(P.e,le.a),le=le.a,ge=[0,0,0,0],qt=[Xe.d,gt.d,nt.d,Ft.d],le.g[0]=le.g[1]=le.g[2]=0,Y(le,Xe,gt,ge,0),Y(le,nt,Ft,ge,2),z(P,le,qt,ge,!0),Pn(K).b=K.b=ie.b=!0,!1}function fe(P,K){for(var ie=sn(K);;){for(;ie.b;)K=ie,ie=sn(ie);if(!K.b&&(ie=K,K=Pn(K),K===null||!K.b))break;K.b=!1;var le=K.a,ge=ie.a,Xe;if(Xe=le.b.a!==ge.b.a)e:{Xe=K;var nt=sn(Xe),gt=Xe.a,Ft=nt.a,qt=void 0;if(s(gt.b.a,Ft.b.a)){if(0>a(gt.b.a,Ft.b.a,gt.a)){Xe=!1;break e}Pn(Xe).b=Xe.b=!0,qt=x(gt),g(Ft.b,qt),qt.d.c=Xe.d}else{if(0<a(Ft.b.a,gt.b.a,Ft.a)){Xe=!1;break e}Xe.b=nt.b=!0,qt=x(Ft),g(gt.e,Ft.b),qt.b.d.c=Xe.d}Xe=!0}if(Xe&&(ie.c?(O(ie),y(ge),ie=sn(K),ge=ie.a):K.c&&(O(K),y(le),K=Pn(ie),le=K.a)),le.a!==ge.a){if(le.b.a===ge.b.a||K.c||ie.c||le.b.a!==P.a&&ge.b.a!==P.a)se(P,K);else if(ue(P,K))break}le.a===ge.a&&le.b.a===ge.b.a&&(F(ge,le),O(K),y(le),K=Pn(ie))}}function de(P,K){P.a=K;for(var ie=K.c;ie.i===null;)if(ie=ie.c,ie===K.c){var ie=P,le=K,nt=new qn;nt.a=le.c.b;var ge=ie.f,gt=ge.a;do gt=gt.a;while(gt.b!==null&&!ge.c(ge.b,nt,gt.b));var ge=gt.b,Xe=sn(ge),nt=ge.a,gt=Xe.a;if(a(nt.b.a,le,nt.a)===0)nt=ge.a,n(nt.a,le)||n(nt.b.a,le)||(x(nt.b),ge.c&&(y(nt.c),ge.c=!1),g(le.c,nt),de(ie,le));else{var Ft=s(gt.b.a,nt.b.a)?ge:Xe,Xe=void 0;ge.d||Ft.c?(Ft===ge?Xe=v(le.c.b,nt.e):Xe=v(gt.b.c.b,le.c).b,Ft.c?M(Ft,Xe):(nt=ie,ge=U(ie,ge,Xe),ge.f=Pn(ge).f+ge.a.f,ge.d=V(nt,ge.f)),de(ie,le)):ne(ie,ge,le.c,le.c,null,!0)}return}if(ie=B(ie.i),nt=sn(ie),ge=nt.a,nt=J(P,nt,null),nt.c===ge){var ge=nt,nt=ge.c,gt=sn(ie),Xe=ie.a,Ft=gt.a,qt=!1;Xe.b.a!==Ft.b.a&&ue(P,ie),n(Xe.a,P.a)&&(g(ce(nt),Xe),ie=B(ie),nt=sn(ie).a,J(P,sn(ie),gt),qt=!0),n(Ft.a,P.a)&&(g(ge,ce(Ft)),ge=J(P,gt,null),qt=!0),qt?ne(P,ie,ge.c,nt,nt,!0):(s(Ft.a,Xe.a)?le=ce(Ft):le=Xe,le=v(ge.c.b,le),ne(P,ie,le,le.c,le.c,!1),le.b.i.c=!0,fe(P,ie))}else ne(P,ie,nt.c,ge,ge,!0)}function be(P,K){var ie=new qn,le=p(P.b);le.a.b=N,le.a.a=K,le.b.a.b=-4e150,le.b.a.a=K,P.a=le.b.a,ie.a=le,ie.f=0,ie.d=!1,ie.c=!1,ie.h=!0,ie.b=!1,le=P.f,le=_e(le,le.a,ie),ie.e=le}function Me(P){this.a=new Ne,this.b=P,this.c=$}function _e(P,K,ie){do K=K.c;while(K.b!==null&&!P.c(P.b,K.b,ie));return P=new Ne(ie,K.a,K),K.a.c=P,K.a=P}function Ne(P,K,ie){this.b=P||null,this.a=K||this,this.c=ie||this}function ve(){this.d=Pe,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}var Pe=0;t=ve.prototype,t.x=function(){et(this,Pe)},t.B=function(P,K){switch(P){case 100142:return;case 100140:switch(K){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=K;return}break;case 100141:this.m=!!K;return;default:Ve(this,100900);return}Ve(this,100901)},t.y=function(P){switch(P){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:Ve(this,100900)}return!1},t.A=function(P,K,ie){this.j[0]=P,this.j[1]=K,this.j[2]=ie},t.z=function(P,K){var ie=K||null;switch(P){case 100100:case 100106:this.h=ie;break;case 100104:case 100110:this.l=ie;break;case 100101:case 100107:this.k=ie;break;case 100102:case 100108:this.i=ie;break;case 100103:case 100109:this.p=ie;break;case 100105:case 100111:this.o=ie;break;case 100112:this.r=ie;break;default:Ve(this,100900)}},t.C=function(P,K){var ie=!1,le=[0,0,0];et(this,2);for(var ge=0;3>ge;++ge){var Xe=P[ge];-1e150>Xe&&(Xe=-1e150,ie=!0),1e150<Xe&&(Xe=1e150,ie=!0),le[ge]=Xe}ie&&Ve(this,100155),ie=this.q,ie===null?(ie=p(this.b),g(ie,ie.b)):(x(ie),ie=ie.e),ie.a.d=K,ie.a.g[0]=le[0],ie.a.g[1]=le[1],ie.a.g[2]=le[2],ie.f=1,ie.b.f=-1,this.q=ie},t.u=function(P){et(this,Pe),this.d=1,this.b=new xe,this.c=P},t.t=function(){et(this,1),this.d=2,this.q=null},t.v=function(){et(this,2),this.d=1},t.w=function(){et(this,1),this.d=Pe;var P=this.j[0],K=this.j[1],ie=this.j[2],le=!1,ge=[P,K,ie];if(P===0&&K===0&&ie===0){for(var K=[-2*1e150,-2*1e150,-2*1e150],Xe=[2*1e150,2*1e150,2*1e150],ie=[],nt=[],le=this.b.c,P=le.e;P!==le;P=P.e)for(var gt=0;3>gt;++gt){var Ft=P.g[gt];Ft<Xe[gt]&&(Xe[gt]=Ft,nt[gt]=P),Ft>K[gt]&&(K[gt]=Ft,ie[gt]=P)}if(P=0,K[1]-Xe[1]>K[0]-Xe[0]&&(P=1),K[2]-Xe[2]>K[P]-Xe[P]&&(P=2),Xe[P]>=K[P])ge[0]=0,ge[1]=0,ge[2]=1;else{for(K=0,Xe=nt[P],ie=ie[P],nt=[0,0,0],Xe=[Xe.g[0]-ie.g[0],Xe.g[1]-ie.g[1],Xe.g[2]-ie.g[2]],gt=[0,0,0],P=le.e;P!==le;P=P.e)gt[0]=P.g[0]-ie.g[0],gt[1]=P.g[1]-ie.g[1],gt[2]=P.g[2]-ie.g[2],nt[0]=Xe[1]*gt[2]-Xe[2]*gt[1],nt[1]=Xe[2]*gt[0]-Xe[0]*gt[2],nt[2]=Xe[0]*gt[1]-Xe[1]*gt[0],Ft=nt[0]*nt[0]+nt[1]*nt[1]+nt[2]*nt[2],Ft>K&&(K=Ft,ge[0]=nt[0],ge[1]=nt[1],ge[2]=nt[2]);0>=K&&(ge[0]=ge[1]=ge[2]=0,ge[A(Xe)]=1)}le=!0}for(nt=A(ge),P=this.b.c,K=(nt+1)%3,ie=(nt+2)%3,nt=0<ge[nt]?1:-1,ge=P.e;ge!==P;ge=ge.e)ge.b=ge.g[K],ge.a=nt*ge.g[ie];if(le){for(ge=0,le=this.b.a,P=le.b;P!==le;P=P.b)if(K=P.a,!(0>=K.f))do ge+=(K.a.b-K.b.a.b)*(K.a.a+K.b.a.a),K=K.e;while(K!==P.a);if(0>ge)for(ge=this.b.c,le=ge.e;le!==ge;le=le.e)le.a=-le.a}for(this.n=!1,ge=this.b.b,P=ge.h;P!==ge;P=le)le=P.h,K=P.e,n(P.a,P.b.a)&&P.e.e!==P&&(X(this,K,P),y(P),P=K,K=P.e),K.e===P&&(K!==P&&((K===le||K===le.b)&&(le=le.h),y(K)),(P===le||P===le.b)&&(le=le.h),y(P));for(this.e=ge=new Oe,le=this.b.c,P=le.e;P!==le;P=P.e)P.h=ot(ge,P);for(lt(ge),this.f=new Me(this),be(this,-4e150),be(this,N);(ge=bt(this.e))!==null;){for(;;){e:if(P=this.e,P.a===0)le=ut(P.b);else if(le=P.c[P.d[P.a-1]],P.b.a!==0&&(P=ut(P.b),s(P,le))){le=P;break e}if(le===null||!n(le,ge))break;le=bt(this.e),X(this,ge.c,le.c)}de(this,ge)}for(this.a=this.f.a.a.b.a.a,ge=0;(le=this.f.a.a.b)!==null;)le.h||++ge,O(le);for(this.f=null,ge=this.e,ge.b=null,ge.d=null,this.e=ge.c=null,ge=this.b,P=ge.a.b;P!==ge.a;P=le)le=P.b,P=P.a,P.e.e===P&&(F(P.c,P),y(P));if(!this.n){if(ge=this.b,this.m)for(P=ge.b.h;P!==ge.b;P=le)le=P.h,P.b.d.c!==P.d.c?P.f=P.d.c?1:-1:y(P);else for(P=ge.a.b;P!==ge.a;P=le)if(le=P.b,P.c){for(P=P.a;s(P.b.a,P.a);P=P.c.b);for(;s(P.a,P.b.a);P=P.e);for(K=P.c.b,ie=void 0;P.e!==K;)if(s(P.b.a,K.a)){for(;K.e!==P&&(c(K.e)||0>=a(K.a,K.b.a,K.e.b.a));)ie=v(K.e,K),K=ie.b;K=K.c.b}else{for(;K.e!==P&&(h(P.c.b)||0<=a(P.b.a,P.a,P.c.b.a));)ie=v(P,P.c.b),P=ie.b;P=P.e}for(;K.e.e!==P;)ie=v(K.e,K),K=ie.b}if(this.h||this.i||this.k||this.l)if(this.m){for(ge=this.b,le=ge.a.b;le!==ge.a;le=le.b)if(le.c){this.h&&this.h(2,this.c),P=le.a;do this.k&&this.k(P.a.d,this.c),P=P.e;while(P!==le.a);this.i&&this.i(this.c)}}else{for(ge=this.b,le=!!this.l,P=!1,K=-1,ie=ge.a.d;ie!==ge.a;ie=ie.d)if(ie.c){P||(this.h&&this.h(4,this.c),P=!0),nt=ie.a;do le&&(Xe=nt.b.d.c?0:1,K!==Xe&&(K=Xe,this.l&&this.l(!!K,this.c))),this.k&&this.k(nt.a.d,this.c),nt=nt.e;while(nt!==ie.a)}P&&this.i&&this.i(this.c)}if(this.r){for(ge=this.b,P=ge.a.b;P!==ge.a;P=le)if(le=P.b,!P.c){K=P.a,ie=K.e,nt=void 0;do nt=ie,ie=nt.e,nt.d=null,nt.b.d===null&&(nt.c===nt?I(nt.a,null):(nt.a.c=nt.c,w(nt,ce(nt))),Xe=nt.b,Xe.c===Xe?I(Xe.a,null):(Xe.a.c=Xe.c,w(Xe,ce(Xe))),D(nt));while(nt!==K);K=P.d,P=P.b,P.d=K,K.b=P}this.r(this.b),this.c=this.b=null;return}}this.b=this.c=null};function et(P,K){if(P.d!==K)for(;P.d!==K;)if(P.d<K)switch(P.d){case Pe:Ve(P,100151),P.u(null);break;case 1:Ve(P,100152),P.t()}else switch(P.d){case 2:Ve(P,100154),P.v();break;case 1:Ve(P,100153),P.w()}}function Ve(P,K){P.p&&P.p(K,P.c)}function re(P,K){this.b=P||this,this.d=K||this,this.a=null,this.c=!1}function Q(){this.h=this,this.i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function ce(P){return P.b.e}function xe(){this.c=new Ge,this.a=new re,this.b=new Q,this.d=new Q,this.b.b=this.d,this.d.b=this.b}function Ge(P,K){this.e=P||this,this.f=K||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Oe(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new Et}function lt(P){P.d=[];for(var K=0;K<P.a;K++)P.d[K]=K;P.d.sort(function(ie){return function(le,ge){return s(ie[le],ie[ge])?1:-1}}(P.c)),P.e=!0,It(P.b)}function ot(P,K){if(P.e){var ie=P.b,le=++ie.a;2*le>ie.f&&(ie.f*=2,ie.c=ft(ie.c,ie.f+1));var ge;return ie.b===0?ge=le:(ge=ie.b,ie.b=ie.c[ie.b]),ie.e[ge]=K,ie.c[ge]=le,ie.d[le]=ge,ie.h&&hr(ie,le),ge}return ie=P.a++,P.c[ie]=K,-(ie+1)}function bt(P){if(P.a===0)return wt(P.b);var K=P.c[P.d[P.a-1]];if(P.b.a!==0&&s(ut(P.b),K))return wt(P.b);do--P.a;while(0<P.a&&P.c[P.d[P.a-1]]===null);return K}function Et(){this.d=ft([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function ft(P,K){for(var ie=Array(K),le=0;le<P.length;le++)ie[le]=P[le];for(;le<K;le++)ie[le]=0;return ie}function It(P){for(var K=P.a;1<=K;--K)St(P,K);P.h=!0}function ut(P){return P.e[P.d[1]]}function wt(P){var K=P.d,ie=P.e,le=P.c,ge=K[1],Xe=ie[ge];return 0<P.a&&(K[1]=K[P.a],le[K[1]]=1,ie[ge]=null,le[ge]=P.b,P.b=ge,0<--P.a&&St(P,1)),Xe}function St(P,K){for(var ie=P.d,le=P.e,ge=P.c,Xe=K,nt=ie[Xe];;){var gt=Xe<<1;gt<P.a&&s(le[ie[gt+1]],le[ie[gt]])&&(gt+=1);var Ft=ie[gt];if(gt>P.a||s(le[nt],le[Ft])){ie[Xe]=nt,ge[nt]=Xe;break}ie[Xe]=Ft,ge[Ft]=Xe,Xe=gt}}function hr(P,K){for(var ie=P.d,le=P.e,ge=P.c,Xe=K,nt=ie[Xe];;){var gt=Xe>>1,Ft=ie[gt];if(gt===0||s(le[Ft],le[nt])){ie[Xe]=nt,ge[nt]=Xe;break}ie[Xe]=Ft,ge[Ft]=Xe,Xe=gt}}function qn(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function sn(P){return P.e.c.b}function Pn(P){return P.e.a.b}iF.libtess={GluTesselator:ve,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},ve.prototype.gluDeleteTess=ve.prototype.x,ve.prototype.gluTessProperty=ve.prototype.B,ve.prototype.gluGetTessProperty=ve.prototype.y,ve.prototype.gluTessNormal=ve.prototype.A,ve.prototype.gluTessCallback=ve.prototype.z,ve.prototype.gluTessVertex=ve.prototype.C,ve.prototype.gluTessBeginPolygon=ve.prototype.u,ve.prototype.gluTessBeginContour=ve.prototype.t,ve.prototype.gluTessEndContour=ve.prototype.v,ve.prototype.gluTessEndPolygon=ve.prototype.w,r.exports=iF.libtess}(ex)),ex.exports}var HQ=WQ();const su=zD(HQ),D8={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},oF=Object.values(D8).reduce((r,t)=>r+t);class qQ{constructor(t){this.renderer=t,this.shapeMode=Ja,this.geometry=new Ts(void 0,void 0,void 0,this.renderer),this.geometry.gid="__IMMEDIATE_MODE_GEOMETRY__",this.contourIndices=[],this._useUserVertexProperties=void 0,this._bezierVertex=[],this._quadraticVertex=[],this._curveVertex=[],this.isProcessingVertices=!1,this._tessy=this._initTessy(),this.tessyVertexSize=oF,this.bufferStrides={...D8}}constructFromContours(t,n){this._useUserVertexProperties&&this._resetUserVertexProperties(),this.geometry.reset(),this.contourIndices=[],this.shapeMode=t.contours[0].kind;const s=!!this.renderer.states.strokeColor,i={};if(t.userVertexProperties){this._useUserVertexProperties=!0;for(const a in t.userVertexProperties){const o=t.vertexPropertyName(a),u=this.geometry._userVertexPropertyHelper(o,[],t.userVertexProperties[a]);i[a]=u,this.tessyVertexSize+=u.getDataSize(),this.bufferStrides[u.getSrcName()]=u.getDataSize(),this.renderer.buffers.user.push(new ii(u.getDataSize(),u.getSrcName(),u.getDstName(),o,this.renderer))}}else this._useUserVertexProperties=!1;for(const a of n){this.contourIndices.push(this.geometry.vertices.length);for(const o of a){if(this.shapeMode===Nm&&this.geometry.vertices.length%6===3)for(const u in this.bufferStrides){const l=this.bufferStrides[u],c=this.geometry[u];c.push(...c.slice(c.length-3*l,c.length-2*l),...c.slice(c.length-l,c.length))}this.geometry.vertices.push(o.position),this.geometry.vertexNormals.push(o.normal||new Ee(0,0,0)),this.geometry.uvs.push(o.textureCoordinates.x,o.textureCoordinates.y),this.renderer.states.fillColor?this.geometry.vertexColors.push(...o.fill.array()):this.geometry.vertexColors.push(0,0,0,0),this.renderer.states.strokeColor?this.geometry.vertexStrokeColors.push(...o.stroke.array()):this.geometry.vertexStrokeColors.push(0,0,0,0);for(const u in i){const l=i[u];u in o&&l.setCurrentData(o[u]),l.pushCurrentData()}}}s&&(this.geometry.edges=this._calculateEdges(this.shapeMode,this.geometry.vertices)),s&&!this.renderer.geometryBuilder&&this.geometry._edgesToVertices(),this.shapeMode===Ja?(this.isProcessingVertices=!0,this._tesselateShape(),this.isProcessingVertices=!1):this.shapeMode===Um?this.shapeMode=zm:this.shapeMode===Nm&&(this.shapeMode=zf),this.renderer.states.textureMode===tv&&this.renderer.states._tex!==null&&this.renderer.states._tex.width>0&&this.renderer.states._tex.height>0&&(this.geometry.uvs=this.geometry.uvs.map((a,o)=>o%2===0?a/this.renderer.states._tex.width:a/this.renderer.states._tex.height))}_resetUserVertexProperties(){const t=this.geometry.userVertexProperties;for(const n in t){const s=t[n];delete this.bufferStrides[n],s.delete()}this._useUserVertexProperties=!1,this.tessyVertexSize=oF,this.geometry.userVertexProperties={}}_calculateEdges(t,n){const s=[];let i=0;const a=this.contourIndices.slice();let o=-1;switch(t){case zm:for(i=0;i<n.length-2;i++)s.push([i,i+1]),s.push([i,i+2]);s.push([i,i+1]);break;case Wb:for(i=1;i<n.length-1;i++)s.push([0,i]),s.push([i,i+1]);s.push([0,n.length-1]);break;case zf:for(i=0;i<n.length-2;i=i+3)s.push([i,i+1]),s.push([i+1,i+2]),s.push([i+2,i]);break;case sd:for(i=0;i<n.length-1;i=i+2)s.push([i,i+1]);break;case Nm:for(i=0;i<n.length-5;i+=6)s.push([i,i+1]),s.push([i+1,i+2]),s.push([i+2,i+5]),s.push([i+5,i]);break;case Um:for(i=0;i<n.length-2;i+=2)s.push([i,i+1]),s.push([i+1,i+3]),s.push([i,i+2]);s.push([i,i+1]);break;default:for(i=0;i<n.length;i++)i===a[0]?o=a.shift():n[o]&&n[i].equals(n[o])?s.push([i-1,o]):s.push([i-1,i]);break}return s}_tesselateShape(){this.shapeMode=zf;const t=[];for(let a=0;a<this.geometry.vertices.length;a++){this.contourIndices.length>0&&this.contourIndices[0]===a&&(this.contourIndices.shift(),t.push([])),t[t.length-1].push(this.geometry.vertices[a].x,this.geometry.vertices[a].y,this.geometry.vertices[a].z,this.geometry.uvs[a*2],this.geometry.uvs[a*2+1],this.geometry.vertexColors[a*4],this.geometry.vertexColors[a*4+1],this.geometry.vertexColors[a*4+2],this.geometry.vertexColors[a*4+3],this.geometry.vertexNormals[a].x,this.geometry.vertexNormals[a].y,this.geometry.vertexNormals[a].z);for(const o in this.geometry.userVertexProperties){const u=this.geometry.userVertexProperties[o],l=a*u.getDataSize(),c=l+u.getDataSize(),h=u.getSrcArray().slice(l,c);t[t.length-1].push(...h)}}const n=this._triangulate(t),s=this.geometry.vertices;this.geometry.vertices=[],this.geometry.vertexNormals=[],this.geometry.uvs=[];for(const a in this.geometry.userVertexProperties)this.geometry.userVertexProperties[a].resetSrcArray();const i=[];for(let a=0,o=n.length;a<o;a=a+this.tessyVertexSize){i.push(...n.slice(a+5,a+9)),this.geometry.vertexNormals.push(new Ee(...n.slice(a+9,a+12)));{let u=12;for(const l in this.geometry.userVertexProperties){const c=this.geometry.userVertexProperties[l],h=c.getDataSize(),f=a+u,p=f+h;c.setCurrentData(n.slice(f,p)),c.pushCurrentData(),u+=h}}this.geometry.vertices.push(new Ee(...n.slice(a,a+3))),this.geometry.uvs.push(...n.slice(a+3,a+5))}if(this.renderer.geometryBuilder){const a=new Map;this.geometry.edges=this.geometry.edges.map(o=>o.map(u=>{if(!a.has(u)){const l=s[u];let c=this.geometry.vertices.findIndex(h=>l.x===h.x&&l.y===h.y&&l.z===h.z);if(c===-1){let h=1/0,f=0;for(let p=0;p<this.geometry.vertices.length;p++){const g=this.geometry.vertices[p],y=l.x-g.x,x=l.y-g.y,v=l.z-g.z,S=y*y+x*x+v*v;S<h&&(h=S,f=p)}c=f}a.set(u,c)}return a.get(u)}))}this.geometry.vertexColors=i}_initTessy(){function t(u,l){for(const c of u)l.push(c)}function n(u){u!==su.primitiveType.GL_TRIANGLES&&console.log(`expected TRIANGLES but got type: ${u}`)}function s(u){console.log("error callback"),console.log(`error number: ${u}`)}const i=(u,l,c)=>{const h=new Array(this.tessyVertexSize).fill(0);for(let f=0;f<c.length;f++)for(let p=0;p<h.length;p++)c[f]===0||!l[f]||(h[p]+=l[f][p]*c[f]);return h};function a(u){}const o=new su.GluTesselator;return o.gluTessCallback(su.gluEnum.GLU_TESS_VERTEX_DATA,t),o.gluTessCallback(su.gluEnum.GLU_TESS_BEGIN,n),o.gluTessCallback(su.gluEnum.GLU_TESS_ERROR,s),o.gluTessCallback(su.gluEnum.GLU_TESS_COMBINE,i),o.gluTessCallback(su.gluEnum.GLU_TESS_EDGE_FLAG,a),o.gluTessProperty(su.gluEnum.GLU_TESS_WINDING_RULE,su.windingRule.GLU_TESS_WINDING_NONZERO),o}_triangulate(t){const n=t[0]?t[0][2]:void 0;let s=!0;for(const a of t)for(let o=0;o<a.length;o+=this.tessyVertexSize)if(a[o+2]!==n){s=!1;break}s?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0);const i=[];this._tessy.gluTessBeginPolygon(i);for(const a of t){this._tessy.gluTessBeginContour();for(let o=0;o<a.length;o+=this.tessyVertexSize){const u=a.slice(o,o+this.tessyVertexSize);this._tessy.gluTessVertex(u,u)}this._tessy.gluTessEndContour()}return this._tessy.gluTessEndPolygon(),i}}class KQ{constructor(t){this.renderer=t,this.cache={}}numCached(){return Object.keys(this.cache).length}isCached(t){return this.cache[t]!==void 0}getGeometryByID(t){var n;return(n=this.cache[t])==null?void 0:n.geometry}getCached(t){return this.getCachedID(t.gid)}getCachedID(t){return this.cache[t]}ensureCached(t){const n=t.gid;if(!n)throw new Error("The p5.Geometry you passed in has no gid property!");if(this.isCached(t.gid))return this.getCached(t);const s=this.renderer.GL;if(this.freeBuffers(n),Object.keys(this.cache).length>1e3){const o=Object.keys(this.cache)[0];this.freeBuffers(o)}const i={};this.cache[n]=i,i.geometry=t;let a=i.indexBuffer;if(t.faces.length){a||(a=i.indexBuffer=s.createBuffer());const o=t.faces.flat(),u=o.some(c=>c>65535);let l=u?Uint32Array:Uint16Array;this.renderer._bindBuffer(a,s.ELEMENT_ARRAY_BUFFER,o,l),i.indexBufferType=u?s.UNSIGNED_INT:s.UNSIGNED_SHORT}else a&&(s.deleteBuffer(a),i.indexBuffer=null);return i}freeBuffers(t){const n=this.cache[t];if(!n)return;delete this.cache[t];const s=this.renderer.GL;n.indexBuffer&&s.deleteBuffer(n.indexBuffer);function i(a){for(const o of a)n[o.dst]&&(s.deleteBuffer(n[o.dst]),n[o.dst]=null)}i(this.renderer.buffers.stroke),i(this.renderer.buffers.fill),i(this.renderer.buffers.user)}}const Rx={[id]:3,[ev]:4,[Jb]:.5};function yT(r,t){const n=t.DEGREES="degrees",s=t.RADIANS="radians";t._angleMode=s,t.acos=function(i){return this._fromRadians(Math.acos(i))},t.asin=function(i){return this._fromRadians(Math.asin(i))},t.atan=function(i){return this._fromRadians(Math.atan(i))},t.atan2=function(i,a){return this._fromRadians(Math.atan2(i,a))},t.cos=function(i){return Math.cos(this._toRadians(i))},t.sin=function(i){return Math.sin(this._toRadians(i))},t.tan=function(i){return Math.tan(this._toRadians(i))},t.degrees=i=>i*wc,t.radians=i=>i*vc,t.angleMode=function(i){if(typeof i>"u")return this._angleMode;if(i===n||i===s){const a=this._angleMode;if(i===a)return;i===s?(this.pRotationX=this.pRotationX*vc,this.pRotationY=this.pRotationY*vc,this.pRotationZ=this.pRotationZ*vc):(this.pRotationX=this.pRotationX*wc,this.pRotationY=this.pRotationY*wc,this.pRotationZ=this.pRotationZ*wc),this._angleMode=i}},t._toRadians=function(i){return this._angleMode===n?i*vc:i},t._toDegrees=function(i){return this._angleMode===s?i*wc:i},t._fromRadians=function(i){return this._angleMode===n?i*wc:i},t._fromDegrees=function(i){return this._angleMode===s?i*vc:i}}typeof p5<"u"&&yT(p5,p5.prototype);function xT(r,t){t.createImage=function(n,s){return new r.Image(n,s)},t.saveCanvas=function(...n){let s,i,a,o;if(n[0]instanceof HTMLCanvasElement)s=n[0],n.shift();else if(n[0]instanceof vn)s=n[0].elt,n.shift();else if(n[0]instanceof Ha){const l=n[0];o=this.createGraphics(l.width,l.height),o.pixelDensity(l.pixelDensity()),l.loadPixels(),o.loadPixels(),o.pixels.set(l.pixels),o.updatePixels(),s=o._renderer.canvas,n.shift()}else s=this._curElement&&this._curElement.elt;n.length>=1&&(i=n[0]),n.length>=2&&(a=n[1]),a=a||t._checkFileExtension(i,a)[1]||"png";let u;switch(a){default:u="image/png";break;case"webp":u="image/webp";break;case"jpeg":case"jpg":u="image/jpeg";break}s.toBlob(l=>{t.downloadFile(l,i,a),o&&o.remove()},u)},t.encodeAndDownloadGif=function(n,s){const i=n.gifProperties;let a=i.loopLimit;a===1?a=null:a===null&&(a=0);const o=new Uint8Array(n.width*n.height*i.numFrames),u=[],l={};for(let _=0;_<i.numFrames;_++){const D=new Set,I=i.frames[_].image.data,k=I.length,A=new Uint32Array(n.width*n.height);for(let F=0,$=0;F<k;F+=4,$++){const O=I[F+0],M=I[F+1],B=I[F+2],U=O<<16|M<<8|B<<0;D.add(U),A[$]=U}const N=[...D].sort().toString();l[N]===void 0?l[N]={freq:1,frames:[_]}:(l[N].freq+=1,l[N].frames.push(_)),u.push(A)}let c=[];const h=Object.keys(l).sort(function(_,D){return l[D].freq-l[_].freq}),f=h[0].split(",").map(_=>parseInt(_));c=c.concat(l[f].frames);const p=new Set(f);for(let _=1;_<h.length;_++){const I=h[_].split(",").map(k=>parseInt(k)).filter(k=>!p.has(k));if(f.length+I.length<=256){for(let k=0;k<I.length;k++)f.push(I[k]),p.add(I[k]);c=c.concat(l[h[_]].frames)}}c=new Set(c);const g={};for(let _=0;_<f.length;_++)g[f[_]]||(g[f[_]]=_);let y=1;for(;y<f.length;)y<<=1;f.length=y;const x={loop:a,palette:new Uint32Array(f)},v=new c8.GifWriter(o,n.width,n.height,x);let S={};for(let _=0;_<i.numFrames;_++){const D=!c.has(_),I=D?[]:f,k=new Uint8Array(n.width*n.height),A={},N=new Set;u[_].forEach((O,M)=>{D?(A[O]===void 0&&(A[O]=I.length,I.push(O)),k[M]=A[O]):k[M]=g[O],_>0&&u[_-1][M]!==O&&N.add(O)});const F={},$=I.filter(O=>!N.has(O));if($.length>0){const O=$[0],M=D?A[O]:g[O];if(_>0){for(let B=0;B<u[_].length;B++)u[_-1][B]===u[_][B]&&(k[B]=M);F.transparent=M,S.frameOpts.disposal=1}}if(F.delay=i.frames[_].delay/10,D){let O=1;for(;O<I.length;)O<<=1;I.length=O,F.palette=new Uint32Array(I)}_>0&&v.addFrame(0,0,n.width,n.height,S.pixelPaletteIndex,S.frameOpts),S={pixelPaletteIndex:k,frameOpts:F}}S.frameOpts.disposal=1,v.addFrame(0,0,n.width,n.height,S.pixelPaletteIndex,S.frameOpts);const w="gif",E=new Blob([o.slice(0,v.end())],{type:"image/gif"});t.downloadFile(E,s,w)},t.saveFrames=function(n,s,i,a,o){let u=i||3;u=Math.max(Math.min(u,15),0),u=u*1e3;let l=a||15;l=Math.max(Math.min(l,22),0);let c=0;const h=t._makeFrame,f=this._curElement.elt;let p=[];const g=setInterval(()=>{p.push(h(n+c,s,f)),c++},1e3/l);setTimeout(()=>{if(clearInterval(g),o)o(p);else for(const y of p)t.downloadFile(y.imageData,y.filename,y.ext);p=[]},u+.01)},t._makeFrame=function(n,s,i){let a;this?a=this._curElement.elt:a=i;let o;if(!s)s="png",o="image/png";else switch(s.toLowerCase()){case"png":o="image/png";break;case"jpeg":o="image/jpeg";break;case"jpg":o="image/jpeg";break;default:o="image/png";break}const u="image/octet-stream";let l=a.toDataURL(o);l=l.replace(o,u);const c={};return c.imageData=l,c.filename=n,c.ext=s,c}}typeof p5<"u"&&xT(p5,p5.prototype);class uF extends Error{constructor(){super(...arguments);Bt(this,"status");Bt(this,"response");Bt(this,"ok")}}async function Wi(r,t){try{const n=await fetch(r);if(n.ok){let s;switch(t){case"json":s=await n.json();break;case"text":s=await n.text();break;case"arrayBuffer":s=await n.arrayBuffer();break;case"blob":s=await n.blob();break;case"bytes":if(n.bytes)s=await n.bytes();else{const i=await n.arrayBuffer();s=new Uint8Array(i)}break;default:throw new Error("Unsupported response type")}return{data:s,headers:n.headers}}else{const s=new uF(n.statusText);throw s.status=n.status,s.response=n,s.ok=!1,s}}catch(n){throw n instanceof TypeError?console.log("You may have encountered a CORS error"):n instanceof uF?console.log("You have encountered a HTTP error"):n instanceof SyntaxError&&console.log("There is an error parsing the response to requested data structure"),n}}function T8(r,t){t.loadJSON=async function(s,i,a){try{const{data:o}=await Wi(s,"json");return i?i(o):o}catch(o){if(r._friendlyFileLoadError(5,s),a)return a(o);throw o}},t.loadStrings=async function(s,i,a){try{let{data:o}=await Wi(s,"text");return o=o.split(/\r?\n/),i?i(o):o}catch(o){if(r._friendlyFileLoadError(3,s),a)return a(o);throw o}},t.loadTable=async function(s,i,a,o,u){typeof arguments[arguments.length-1]=="function"&&(typeof arguments[arguments.length-2]=="function"?(o=arguments[arguments.length-2],u=arguments[arguments.length-1]):o=arguments[arguments.length-1]),typeof i!="string"&&(i=","),typeof a=="function"&&(a=!1);try{let{data:l}=await Wi(s,"text"),c=new r.Table;return l=CQ(l,{separator:i}),a?c.columns=l.shift():c.columns=Array(l[0].length).fill(null),l.forEach(h=>{const f=new r.TableRow(h);c.addRow(f)}),o?o(c):c}catch(l){if(r._friendlyFileLoadError(2,s),u)return u(l);throw l}},t.loadXML=async function(s,i,a){try{const o=new DOMParser;let{data:u}=await Wi(s,"text");const l=o.parseFromString(u,"application/xml");return u=new r.XML(l),i?i(u):u}catch(o){if(r._friendlyFileLoadError(1,s),a)return a(o);throw o}},t.loadBytes=async function(s,i,a){try{let{data:o}=await Wi(s,"arrayBuffer");return o=new Uint8Array(o),i?i(o):o}catch(o){if(r._friendlyFileLoadError(6,s),a)return a(o);throw o}},t.loadBlob=async function(s,i,a){try{const{data:o}=await Wi(s,"blob");return i?i(o):o}catch(o){if(a)return a(o);throw o}},t.httpGet=async function(s,i="text",a,o){return typeof i=="function"&&(o=a,a=i,i="text"),this.httpDo(s,"GET",i,a,o)},t.httpPost=async function(s,i,a="text",o,u){typeof i=="function"?(o=i,u=a,i=void 0,a="text"):typeof a=="function"&&(u=o,o=a,a="text");let l=i,c="text/plain";i instanceof r.XML?(l=i.serialize(),c="application/xml"):i instanceof r.Image?(l=await i.toBlob(),c="image/png"):typeof i=="object"&&(l=JSON.stringify(i),c="application/json");const h={method:"POST",body:l,headers:{"Content-Type":c}};l&&(h.body=l);const f=new Request(s,h);return this.httpDo(f,"POST",a,o,u)},t.httpDo=async function(s,i,a,o,u){if(typeof a=="function"&&(u=o,o=a,a=void 0),!a)switch(typeof s=="string"?s.split(".").pop():s.url.split(".").pop()){case"json":a="json";break;case"jpg":case"jpeg":case"png":case"webp":case"gif":a="blob";break;case"xml":case"txt":default:a="text"}const l=new Request(s,{method:i});try{const{data:c}=await Wi(l,a);return o?o(c):c}catch(c){if(u)return u(c);throw c}},t._pWriters=[],t.createWriter=function(s,i){let a;for(const o in t._pWriters)if(t._pWriters[o].name===s)return a=new r.PrintWriter(s+this.millis(),i),t._pWriters.push(a),a;return a=new r.PrintWriter(s,i),t._pWriters.push(a),a},r.PrintWriter=function(s,i){let a=this;this.name=s,this.content="",this.write=function(o){this.content+=o},this.print=function(o){this.content+=`${o}
`},this.clear=function(){this.content=""},this.close=function(){const o=[];o.push(this.content),t.writeFile(o,s,i);for(const u in t._pWriters)t._pWriters[u].name===this.name&&t._pWriters.splice(u,1);a.clear(),a={}}},t.save=function(s,i,a){const o=arguments,u=this._curElement?this._curElement.elt:this.elt;if(o.length===0){t.saveCanvas(u);return}else if(o[0]instanceof Pt||o[0]instanceof ud){t.saveCanvas(o[0].canvas,o[1],o[2]);return}else if(o.length===1&&typeof o[0]=="string")t.saveCanvas(u,o[0]);else switch(Fx(o[1],o[2])[1]){case"json":t.saveJSON(o[0],o[1],o[2]);return;case"txt":t.saveStrings(o[0],o[1],o[2]);return;default:o[0]instanceof Array?t.saveStrings(o[0],o[1],o[2]):o[0]instanceof r.Table?t.saveTable(o[0],o[1],o[2]):o[0]instanceof r.Image?t.saveCanvas(o[0].canvas,o[1]):o[0]instanceof r.SoundFile&&t.saveSound(o[0],o[1],o[2],o[3])}},t.saveJSON=function(s,i,a){let o;a?o=JSON.stringify(s):o=JSON.stringify(s,void 0,2),this.saveStrings(o.split(`
`),i,"json")},t.saveStrings=function(s,i,a,o){const u=a||"txt",l=new r.PrintWriter(i,u);for(let c of s)o?l.write(c+`\r
`):l.write(c+`
`);l.close(),l.clear()};function n(s){return s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}t.saveTable=function(s,i,a){let o;a===void 0?(o=i.substring(i.lastIndexOf(".")+1,i.length),o===i&&(o="csv")):o=a;const u=this.createWriter(i,o),l=s.columns;let c=",";if(o==="tsv"&&(c="	"),o!=="html"){const h=s.toString(c);u.write(h)}else{u.print("<html>"),u.print("<head>");let h='  <meta http-equiv="content-type" content';if(h+='="text/html;charset=utf-8" />',u.print(h),u.print("</head>"),u.print("<body>"),u.print("  <table>"),l[0]!=="0"){u.print("    <tr>");for(let f=0;f<l.length;f++){const p=n(l[f]);u.print(`      <td>${p}`),u.print("      </td>")}u.print("    </tr>")}for(let f=0;f<s.rows.length;f++){u.print("    <tr>");for(let p=0;p<s.columns.length;p++){const g=s.rows[f].getString(p),y=n(g);u.print(`      <td>${y}`),u.print("      </td>")}u.print("    </tr>")}u.print("  </table>"),u.print("</body>"),u.print("</html>")}u.close(),u.clear()},t.writeFile=function(s,i,a){let o="application/octet-stream";t._isSafari()&&(o="text/plain");const u=new Blob(s,{type:o});t.downloadFile(u,i,a)},t.downloadFile=uT,t._checkFileExtension=Fx,t._isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}typeof p5<"u"&&T8(p5,p5.prototype);function bT(r,t){t.loadImage=async function(c,h,f){try{let p=new r.Image(1,1,this);const g=new Request(c,{method:"GET",mode:"cors"}),{data:y,headers:x}=await Wi(g,"bytes"),v=x.get("content-type");if(v===null&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),v&&v.includes("image/gif"))await i(y,p);else{const S=new Blob([y]),w=await createImageBitmap(S);p.width=p.canvas.width=w.width,p.height=p.canvas.height=w.height,p.drawingContext.drawImage(w,0,0)}return p.modified=!0,h?h(p):p}catch(p){if(r._friendlyFileLoadError(0,c),typeof f=="function")return f(p);throw p}},t.saveGif=async function(c,h,f={delay:0,units:"seconds",silent:!1,notificationDuration:0,notificationID:"progressBar"}){if(typeof c!="string")throw TypeError("fileName parameter must be a string");if(typeof h!="number")throw TypeError("Duration parameter must be a number");const p=f&&f.delay||0,g=f&&f.units||"seconds",y=f&&f.silent||!1,x=f&&f.notificationDuration||0,v=f&&f.notificationID||"progressBar";if(typeof p!="number")throw TypeError("Delay parameter must be a number");if(g!=="seconds"&&g!=="frames")throw TypeError('Units parameter must be either "frames" or "seconds"');if(typeof y!="boolean")throw TypeError("Silent parameter must be a boolean");if(typeof x!="number")throw TypeError("Notification duration parameter must be a number");if(typeof v!="string")throw TypeError("Notification ID parameter must be a string");this._recording=!0;let S=this._targetFrameRate;(S===1/0||S===void 0||S===0)&&(S=60);let w=1/S*1e3;w=w<20?20:w;const E=g==="seconds"?h*S:h,_=g==="seconds"?p*S:p,D=E+_;let I=_;this.frameCount=I;const k=this._renderer._pixelDensity;this.pixelDensity(1);let A=[];document.getElementById(v)!==null&&document.getElementById(v).remove();let N;y||(N=this.createP(""),N.id(v),N.style("font-size","16px"),N.style("font-family","Montserrat"),N.style("background-color","#ffffffa0"),N.style("padding","8px"),N.style("border-radius","10px"),N.position(0,0));let F,$;for(this._renderer instanceof r.RendererGL&&($=this.drawingContext,F=new Uint8Array($.drawingBufferWidth*$.drawingBufferHeight*4)),this.noLoop(),await Promise.resolve();I<D;){this.redraw();let X;this._renderer instanceof r.RendererGL?(F=new Uint8Array($.drawingBufferWidth*$.drawingBufferHeight*4),$.readPixels(0,0,$.drawingBufferWidth,$.drawingBufferHeight,$.RGBA,$.UNSIGNED_BYTE,F),X=n(F,this.width,this.height)):X=this.drawingContext.getImageData(0,0,this.width,this.height).data,A.push(X),I++,y||N.html("Saved frame <b>"+A.length.toString()+"</b> out of "+E.toString()),await new Promise(Y=>setTimeout(Y,0))}y||N.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(k);const O=BQ(),M=s(A),B={},U=X=>{const Y=X.length/4,se=new Uint8Array(Y);for(let ue=0;ue<Y;ue++){const fe=X[ue*4]<<24|X[ue*4+1]<<16|X[ue*4+2]<<8|X[ue*4+3];B[fe]===void 0&&(B[fe]=LQ(M,X.slice(ue*4,(ue+1)*4))),se[ue]=B[fe]}return se},V=M.length-1;let Z=[];for(let X=0;X<A.length;X++){const Y=U(A[X]),se=Y.slice();if(X===0)O.writeFrame(Y,this.width,this.height,{palette:M,delay:w,dispose:1});else{for(let ue=0;ue<Y.length;ue++)Y[ue]===Z[ue]&&(Y[ue]=V);O.writeFrame(Y,this.width,this.height,{delay:w,transparent:!0,transparentIndex:V,dispose:1})}Z=se,y||N.html("Rendered frame <b>"+X.toString()+"</b> out of "+E.toString()),await new Promise(ue=>setTimeout(ue,0))}O.finish();const J=O.bytesView(),ne="gif",z=new Blob([J],{type:"image/gif"});A=[],this._recording=!1,this.loop(),y||(N.html("Done. Downloading your gif!"),x>0&&setTimeout(()=>N.remove(),x*1e3)),t.downloadFile(z,c,ne)};function n(c,h,f){const p=parseInt(f/2),g=h*4,y=new Uint8Array(h*4);for(let x=0;x<p;++x){const v=x*g,S=(f-x-1)*g;y.set(c.subarray(v,v+g)),c.copyWithin(v,S,S+g),c.set(y,S)}return c}function s(c){let h=new Uint8Array(c.length*c[0].length);for(let p=0;p<c.length;p++)h.set(c[p],p*c[0].length);let f=RQ(h,256,{format:"rgba4444",oneBitAlpha:!0});return f.length===256?f[f.length-1]=[Math.random()*255,Math.random()*255,Math.random()*255,0]:f.push([Math.random()*255,Math.random()*255,Math.random()*255,0]),f}async function i(c,h){const f=new c8.GifReader(c);h.width=h.canvas.width=f.width,h.height=h.canvas.height=f.height;const p=[],g=f.numFrames();let y=new Uint8ClampedArray(h.width*h.height*4);const x=(S,w)=>{try{w.decodeAndBlitFrameRGBA(S,y)}catch(E){throw r._friendlyFileLoadError(8,h.src),E}};for(let S=0;S<g;S++){const w=f.frameInfo(S),E=h.drawingContext.getImageData(0,0,h.width,h.height);y=E.data.slice(),x(S,f);const _=new ImageData(y,h.width,h.height);h.drawingContext.putImageData(_,0,0);let D=w.delay;D===0&&(D=10),p.push({image:h.drawingContext.getImageData(0,0,h.width,h.height),delay:D*10}),w.disposal===2?h.drawingContext.clearRect(w.x,w.y,w.width,w.height):w.disposal===3&&h.drawingContext.putImageData(E,0,0,w.x,w.y,w.width,w.height)}let v=f.loopCount();return v===null?v=1:v===0&&(v=null),h.drawingContext.putImageData(p[0].image,0,0),p.length>1&&(h.gifProperties={displayIndex:0,loopLimit:v,loopCount:0,frames:p,numFrames:g,playing:!0,timeDisplayed:0,lastChangeTime:0}),h}function a(c,h,f,p,g,y,x,v){const S=Math.max(x/g,v/y),[w,E]=[x/S,v/S];let _=f,D=p;return c===Ti?_+=(g-w)/2:c===Cx&&(_+=g-w),h===Ti?D+=(y-E)/2:h===M_&&(D+=y-E),{x:_,y:D,w,h:E}}function o(c,h,f,p,g,y,x,v){const S=Math.max(f/x,p/v),[w,E]=[f/S,p/S];let _=g,D=y;return c===Ti?_+=(x-w)/2:c===Cx&&(_+=x-w),h===Ti?D+=(v-E)/2:h===M_&&(D+=v-E),{x:_,y:D,w,h:E}}function u(c,h,f,p,g,y,x,v,S,w,E){if(c===x6){const{x:_,y:D,w:I,h:k}=o(h,f,y,x,v,S,w,E);v=_,S=D,w=I,E=k}if(c===y6){const{x:_,y:D,w:I,h:k}=a(h,f,p,g,y,x,w,E);p=_,g=D,y=I,x=k}return{sx:v,sy:S,sw:w,sh:E,dx:p,dy:g,dw:y,dh:x}}function l(c,h){return c>0&&c<h?c:h}t.image=function(c,h,f,p,g,y,x,v,S,w,E,_){let D=c.width,I=c.height;_=_||Ti,E=E||Ti,c.elt&&(D=D!==void 0?D:c.elt.width,I=I!==void 0?I:c.elt.height),c.elt&&c.elt.videoWidth&&!c.canvas&&(D=D!==void 0?D:c.elt.videoWidth,I=I!==void 0?I:c.elt.videoHeight);let k=h,A=f,N=p||D,F=g||I,$=y||0,O=x||0,M=v!==void 0?v:D,B=S!==void 0?S:I;M=l(M,D),B=l(B,I);let U=1;c.elt&&!c.canvas&&c.elt.style.width&&(c.elt.videoWidth&&!p?U=c.elt.videoWidth:U=c.elt.width,U/=parseInt(c.elt.style.width,10)),$*=U,O*=U,B*=U,M*=U;let V=Qy.modeAdjust(k,A,N,F,this._renderer.states.imageMode);V=u(w,E,_,V.x,V.y,V.w,V.h,$,O,M,B),this._renderer.image(c,V.sx,V.sy,V.sw,V.sh,V.dx,V.dy,V.dw,V.dh)},t.tint=function(...c){const h=this.color(...c);this._renderer.states.setValue("tint",h._getRGBA([255,255,255,255]))},t.noTint=function(){this._renderer.states.setValue("tint",null)},t.imageMode=function(c){(c===Yi||c===Pm||c===Ti)&&this._renderer.states.setValue("imageMode",c)}}typeof p5<"u"&&bT(p5,p5.prototype);class Qc{constructor(t){this._renderer=t,this.cameraType="default",this.useLinePerspective=!0,this.cameraMatrix=new zr(4),this.projMatrix=new zr(4),this.yScale=1}perspective(t,n,s,i){this.cameraType=arguments.length>0?"custom":"default",typeof t>"u"?(t=this.defaultCameraFOV,this.cameraFOV=t):this.cameraFOV=this._renderer._pInst._toRadians(t),typeof n>"u"&&(n=this.defaultAspectRatio),typeof s>"u"&&(s=this.defaultCameraNear),typeof i>"u"&&(i=this.defaultCameraFar),s<=1e-4&&(s=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),i<s&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=n,this.cameraNear=s,this.cameraFar=i,this.projMatrix=new zr(4);const a=1/Math.tan(this.cameraFOV/2),o=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(a/n,0,0,0,0,-a*this.yScale,0,0,0,0,(i+s)*o,-1,0,0,2*i*s*o,0),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix))}ortho(t,n,s,i,a,o){const u=this.fbo||this._renderer;t===void 0&&(t=-u.width/2),n===void 0&&(n=+u.width/2),s===void 0&&(s=-u.height/2),i===void 0&&(i=+u.height/2),a===void 0&&(a=0),o===void 0&&(o=Math.max(u.width,u.height)+800),this.cameraNear=a,this.cameraFar=o;const l=n-t,c=i-s,h=o-a,f=2/l,p=2/c*this.yScale,g=-2/h,y=-(n+t)/l,x=-(i+s)/c,v=-(o+a)/h;this.projMatrix=new zr(4),this.projMatrix.set(f,0,0,0,0,-p,0,0,0,0,g,0,y,x,v,1),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix)),this.cameraType="custom"}frustum(t,n,s,i,a,o){t===void 0&&(t=-this._renderer.width*.05),n===void 0&&(n=+this._renderer.width*.05),s===void 0&&(s=+this._renderer.height*.05),i===void 0&&(i=-this._renderer.height*.05),a===void 0&&(a=this.defaultCameraNear),o===void 0&&(o=this.defaultCameraFar),this.cameraNear=a,this.cameraFar=o;const u=n-t,l=i-s,c=o-a,h=+(2*a)/u,f=+(2*a)/l*this.yScale,p=-(2*o*a)/c,g=(n+t)/u,y=(i+s)/l,x=-(o+a)/c;this.projMatrix=new zr(4),this.projMatrix.set(h,0,0,0,0,-f,0,0,g,y,x,-1,0,0,p,0),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.set(this.projMatrix)),this.cameraType="custom"}_rotateView(t,n,s,i){let a=this.centerX,o=this.centerY,u=this.centerZ;a-=this.eyeX,o-=this.eyeY,u-=this.eyeZ;const l=new zr(4);l.rotate4x4(this._renderer._pInst._toRadians(t),n,s,i);const c=[a*l.mat4[0]+o*l.mat4[4]+u*l.mat4[8],a*l.mat4[1]+o*l.mat4[5]+u*l.mat4[9],a*l.mat4[2]+o*l.mat4[6]+u*l.mat4[10]];c[0]+=this.eyeX,c[1]+=this.eyeY,c[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,c[0],c[1],c[2],this.upX,this.upY,this.upZ)}roll(t){const n=this._getLocalAxes(),i=Xf.fromAxisAngle(this._renderer._pInst._toRadians(t),n.z[0],n.z[1],n.z[2]).rotateVector(new Ee(this.upX,this.upY,this.upZ));this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,i.x,i.y,i.z)}pan(t){const n=this._getLocalAxes();this._rotateView(t,n.y[0],n.y[1],n.y[2])}tilt(t){const n=this._getLocalAxes();this._rotateView(t,n.x[0],n.x[1],n.x[2])}lookAt(t,n,s){this.camera(this.eyeX,this.eyeY,this.eyeZ,t,n,s,this.upX,this.upY,this.upZ)}camera(t,n,s,i,a,o,u,l,c){typeof t>"u"&&(t=this.defaultEyeX,n=this.defaultEyeY,s=this.defaultEyeZ,i=t,a=n,o=0,u=0,l=1,c=0),this.eyeX=t,this.eyeY=n,this.eyeZ=s,typeof i<"u"&&(this.centerX=i,this.centerY=a,this.centerZ=o),typeof u<"u"&&(this.upX=u,this.upY=l,this.upZ=c);const h=this._getLocalAxes();this.cameraMatrix.set(h.x[0],h.y[0],h.z[0],0,h.x[1],h.y[1],h.z[1],0,h.x[2],h.y[2],h.z[2],0,0,0,0,1);const f=-t,p=-n,g=-s;return this.cameraMatrix.translate([f,p,g]),this._isActive()&&(this._renderer.states.setValue("uViewMatrix",this._renderer.states.uViewMatrix.clone()),this._renderer.states.uViewMatrix.set(this.cameraMatrix)),this}move(t,n,s){const i=this._getLocalAxes(),a=[i.x[0]*t,i.x[1]*t,i.x[2]*t],o=[i.y[0]*n,i.y[1]*n,i.y[2]*n],u=[i.z[0]*s,i.z[1]*s,i.z[2]*s];this.camera(this.eyeX+a[0]+o[0]+u[0],this.eyeY+a[1]+o[1]+u[1],this.eyeZ+a[2]+o[2]+u[2],this.centerX+a[0]+o[0]+u[0],this.centerY+a[1]+o[1]+u[1],this.centerZ+a[2]+o[2]+u[2],this.upX,this.upY,this.upZ)}setPosition(t,n,s){const i=t-this.eyeX,a=n-this.eyeY,o=s-this.eyeZ;this.camera(t,n,s,this.centerX+i,this.centerY+a,this.centerZ+o,this.upX,this.upY,this.upZ)}set(t){const n=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType","yScale","useLinePerspective"];for(const s of n)this[s]=t[s];this.cameraMatrix=t.cameraMatrix.copy(),this.projMatrix=t.projMatrix.copy(),this._isActive()&&(this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.setValue("uViewMatrix",this._renderer.states.uViewMatrix.clone()),this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uModelMatrix.reset(),this._renderer.states.uViewMatrix.set(this.cameraMatrix),this._renderer.states.uPMatrix.set(this.projMatrix))}slerp(t,n,s){if(s===0){this.set(t);return}else if(s===1){this.set(n);return}this.projMatrix.mat4[15]!==0&&(this.projMatrix.setElement(0,t.projMatrix.mat4[0]*Math.pow(n.projMatrix.mat4[0]/t.projMatrix.mat4[0],s)),this.projMatrix.setElement(5,t.projMatrix.mat4[5]*Math.pow(n.projMatrix.mat4[5]/t.projMatrix.mat4[5],s)),this._isActive()&&(this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.mat4=this.projMatrix.mat4.slice()));const i=new Ee(t.eyeX,t.eyeY,t.eyeZ),a=new Ee(n.eyeX,n.eyeY,n.eyeZ),o=new Ee(t.centerX,t.centerY,t.centerZ),u=new Ee(n.centerX,n.centerY,n.centerZ),l=Ee.dist(i,o),c=Ee.dist(a,u),h=l*Math.pow(c/l,s),f=Ee.sub(i,a),p=i.copy().sub(a).sub(o).add(u),g=p.magSq();let y=1;g>1e-6&&(y=Ee.dot(f,p)/g,y=Math.max(0,Math.min(y,1)));const x=Ee.lerp(Ee.lerp(i,o,y),Ee.lerp(a,u,y),s),v=t.cameraMatrix.createSubMatrix3x3(),S=n.cameraMatrix.createSubMatrix3x3(),w=v.row(2),E=S.row(2),_=v.row(1),D=S.row(1),I=new Ee,k=new Ee,A=new Ee,N=new Ee,F=S.mult(v.copy().transpose()),$=F.diagonal();let O=.5*($[0]+$[1]+$[2]-1);if(1-O<1e-7){I.set(Ee.lerp(w,E,s)).normalize(),A.set(I).mult(y*h).add(x),N.set(I).mult((y-1)*h).add(x),k.set(Ee.lerp(_,D,s)).normalize(),this.camera(A.x,A.y,A.z,N.x,N.y,N.z,k.x,k.y,k.z);return}let M,B,U,V,Z=1/(1-O);const J=Math.max($[0],$[1],$[2]),ne=F.mat3[1]+F.mat3[3],z=F.mat3[2]+F.mat3[6],X=F.mat3[5]+F.mat3[7];J===$[0]?(M=Math.sqrt(($[0]-O)*Z),Z/=M,B=.5*ne*Z,U=.5*z*Z,V=.5*(F.mat3[7]-F.mat3[5])/M):J===$[1]?(B=Math.sqrt(($[1]-O)*Z),Z/=B,U=.5*X*Z,M=.5*ne*Z,V=.5*(F.mat3[2]-F.mat3[6])/B):(U=Math.sqrt(($[2]-O)*Z),Z/=U,M=.5*z*Z,B=.5*X*Z,V=.5*(F.mat3[3]-F.mat3[1])/U);const Y=s*Math.atan2(V,O),se=Math.cos(Y),ue=Math.sin(Y),fe=1-se,de=M*B,be=B*U,Me=U*M,_e=new zr([se+fe*M*M,fe*de+ue*U,fe*Me-ue*B,fe*de-ue*U,se+fe*B*B,fe*be+ue*M,fe*Me+ue*B,fe*be-ue*M,se+fe*U*U]);_e.multiplyVec(w,I),A.set(I).mult(y*h).add(x),N.set(I).mult((y-1)*h).add(x),_e.multiplyVec(_,k),this.camera(A.x,A.y,A.z,N.x,N.y,N.z,k.x,k.y,k.z)}_computeCameraDefaultSettings(){this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=800,this.defaultCameraFOV=2*Math.atan(this._renderer.height/2/this.defaultEyeZ),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=this.defaultEyeZ*.1,this.defaultCameraFar=this.defaultEyeZ*10}_setDefaultCamera(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"}_resize(){this.cameraType==="default"&&(this._computeCameraDefaultSettings(),this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.perspective())}copy(){const t=new Qc(this._renderer);return t.cameraFOV=this.cameraFOV,t.aspectRatio=this.aspectRatio,t.eyeX=this.eyeX,t.eyeY=this.eyeY,t.eyeZ=this.eyeZ,t.centerX=this.centerX,t.centerY=this.centerY,t.centerZ=this.centerZ,t.upX=this.upX,t.upY=this.upY,t.upZ=this.upZ,t.cameraNear=this.cameraNear,t.cameraFar=this.cameraFar,t.cameraType=this.cameraType,t.useLinePerspective=this.useLinePerspective,t.cameraMatrix=this.cameraMatrix.copy(),t.projMatrix=this.projMatrix.copy(),t.yScale=this.yScale,t}clone(){return this.copy()}_getLocalAxes(){let t=this.eyeX-this.centerX,n=this.eyeY-this.centerY,s=this.eyeZ-this.centerZ;const i=Math.sqrt(t*t+n*n+s*s);i!==0&&(t/=i,n/=i,s/=i);let a=this.upX,o=this.upY,u=this.upZ,l=o*s-u*n,c=-a*s+u*t,h=a*n-o*t;a=n*h-s*c,o=-t*h+s*l,u=t*c-n*l;const f=Math.sqrt(l*l+c*c+h*h);f!==0&&(l/=f,c/=f,h/=f);const p=Math.sqrt(a*a+o*o+u*u);return p!==0&&(a/=p,o/=p,u/=p),{x:[l,c,h],y:[a,o,u],z:[t,n,s]}}_orbit(t,n,s){const i=this.eyeX-this.centerX,a=this.eyeY-this.centerY,o=this.eyeZ-this.centerZ;let u=Math.hypot(i,a,o);const l=new Ee(i,a,o).normalize(),c=new Ee(this.upX,this.upY,this.upZ).normalize(),h=Ee.cross(c,l).normalize(),f=Ee.cross(h,c);u*=Math.pow(10,s),u<this.cameraNear&&(u=this.cameraNear),u>this.cameraFar&&(u=this.cameraFar);const p=Math.acos(Math.max(-1,Math.min(1,Ee.dot(l,c))))+n,g=t;(p<=0||p>=Math.PI)&&(this.upX*=-1,this.upY*=-1,this.upZ*=-1),c.mult(Math.cos(p)),f.mult(Math.cos(g)*Math.sin(p)),h.mult(Math.sin(g)*Math.sin(p)),l.set(c).add(f).add(h),this.eyeX=u*l.x+this.centerX,this.eyeY=u*l.y+this.centerY,this.eyeZ=u*l.z+this.centerZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}_orbitFree(t,n,s){const i=this.eyeX-this.centerX,a=this.eyeY-this.centerY,o=this.eyeZ-this.centerZ;let u=Math.hypot(i,a,o);const l=new Ee(i,a,o).normalize(),c=new Ee(this.upX,this.upY,this.upZ),h=Ee.cross(c,l).normalize(),f=Ee.cross(l,h),p=Math.atan2(n,t);f.mult(Math.sin(p)),h.mult(Math.cos(p)).add(f);const g=Math.sqrt(t*t+n*n),y=Ee.cross(l,h);u*=Math.pow(10,s),u<this.cameraNear&&(u=this.cameraNear),u>this.cameraFar&&(u=this.cameraFar);const x=Math.cos(g),v=Math.sin(g),S=c.dot(l),w=c.dot(h),E=S*x+w*v,_=-S*v+w*x,D=c.dot(y);c.x=E*l.x+_*h.x+D*y.x,c.y=E*l.y+_*h.y+D*y.y,c.z=E*l.z+_*h.z+D*y.z,h.mult(-v),l.mult(x).add(h).mult(u),this.camera(l.x+this.centerX,l.y+this.centerY,l.z+this.centerZ,this.centerX,this.centerY,this.centerZ,c.x,c.y,c.z)}_isActive(){return this===this._renderer.states.curCamera}}function N8(r,t){t.camera=function(...n){return this._assert3d("camera"),this._renderer.camera(...n),this},t.perspective=function(...n){return this._assert3d("perspective"),this._renderer.perspective(...n),this},t.linePerspective=function(n){if(!(this._renderer instanceof Ht))throw new Error("linePerspective() must be called in WebGL mode.");return this._renderer.linePerspective(n)},t.ortho=function(...n){return this._assert3d("ortho"),this._renderer.ortho(...n),this},t.frustum=function(...n){return this._assert3d("frustum"),this._renderer.frustum(...n),this},t.createCamera=function(){return this._assert3d("createCamera"),this._renderer.createCamera()},t.setCamera=function(n){this._renderer.setCamera(n)},r.Camera=Qc,Ht.prototype.camera=function(...n){this.states.curCamera.camera(...n)},Ht.prototype.perspective=function(...n){this.states.curCamera.perspective(...n)},Ht.prototype.linePerspective=function(n){if(n!==void 0)this.states.curCamera.useLinePerspective=n;else return this.states.curCamera.useLinePerspective},Ht.prototype.ortho=function(...n){this.states.curCamera.ortho(...n)},Ht.prototype.frustum=function(...n){this.states.curCamera.frustum(...n)},Ht.prototype.createCamera=function(){const n=new Qc(this);return n._computeCameraDefaultSettings(),n._setDefaultCamera(),n},Ht.prototype.setCamera=function(n){this.states.setValue("curCamera",n),this.states.setValue("uPMatrix",this.states.uPMatrix.clone()),this.states.uPMatrix.set(n.projMatrix),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(n.cameraMatrix)}}typeof p5<"u"&&N8(p5,p5.prototype);class Ns{constructor(t,n,s,i={}){this._renderer=t,this._vertSrc=n,this._fragSrc=s,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[],this.hooks={uniforms:i.uniforms||{},declarations:i.declarations,helpers:i.helpers||{},vertex:i.vertex||{},fragment:i.fragment||{},modified:{vertex:i.modified&&i.modified.vertex||{},fragment:i.modified&&i.modified.fragment||{}}}}hookTypes(t){let n=this._vertSrc,s=this.hooks.vertex[t];if(s||(s=this.hooks.fragment[t],n=this._fragSrc),!s)throw new Error(`Can't find hook ${t}!`);const i=t.split(/\s+/g),a=i.pop(),o=i.pop(),u=[...i],l=/\(([^\)]*)\)/.exec(s);if(!l)throw new Error(`Couldn't find function parameters in hook body:
${s}`);const c=f=>{const p=new RegExp(`struct\\s+${f}\\s*{([^}]*)}`).exec(n);if(!p)return;const g=[];for(const y of p[1].split(";")){const x=y.trim().split(/\s+|,/g),v=x.shift(),S=[...x],w=c(v);for(const E of S)g.push({name:E,type:{typeName:v,qualifiers:[],properties:w}})}return g},h=l[1].split(",").map(f=>{const p=f.trim().split(/\s+/g),g=p.pop(),y=p.pop(),x=[...p],v=c(y);return{name:g,type:{typeName:y,qualifiers:x,properties:v}}});return{name:a,returnType:{typeName:o,qualifiers:u,properties:c(o)},parameters:h}}shaderSrc(t,n){const s="void main";let[i,a]=t.split(s),o="",u="";for(const l in this.hooks.uniforms)o+=`uniform ${l};
`;this.hooks.declarations&&(o+=this.hooks.declarations+`
`),this.hooks[n].declarations&&(o+=this.hooks[n].declarations+`
`);for(const l in this.hooks.helpers)o+=`${l}${this.hooks.helpers[l]}
`;for(const l in this.hooks[n]){if(l==="declarations")continue;const[c,h]=l.split(" ");this.hooks.modified[n][l]&&(u+="#define AUGMENTED_HOOK_"+h+`
`),o+=c+" HOOK_"+h+this.hooks[n][l]+`
`}return i.indexOf("#define HOOK_DEFINES")!==-1&&(i=i.replace("#define HOOK_DEFINES",`
`+u+`
`),u=""),i+`
`+u+o+s+a}version(){const t=/#version (.+)$/.exec(this.vertSrc());return t?t[1]:"100 es"}vertSrc(){return this.shaderSrc(this._vertSrc,"vertex")}fragSrc(){return this.shaderSrc(this._fragSrc,"fragment")}inspectHooks(){console.log("==== Vertex shader hooks: ====");for(const t in this.hooks.vertex)console.log((this.hooks.modified.vertex[t]?"[MODIFIED] ":"")+t+this.hooks.vertex[t]);console.log(""),console.log("==== Fragment shader hooks: ====");for(const t in this.hooks.fragment)console.log((this.hooks.modified.fragment[t]?"[MODIFIED] ":"")+t+this.hooks.fragment[t]);console.log(""),console.log("==== Helper functions: ====");for(const t in this.hooks.helpers)console.log(t+this.hooks.helpers[t])}modify(t){const n={vertex:{},fragment:{},helpers:{}};for(const a in t)a!=="declarations"&&a!=="uniforms"&&(a==="vertexDeclarations"?n.vertex.declarations=(n.vertex.declarations||"")+`
`+t[a]:a==="fragmentDeclarations"?n.fragment.declarations=(n.fragment.declarations||"")+`
`+t[a]:this.hooks.vertex[a]?n.vertex[a]=t[a]:this.hooks.fragment[a]?n.fragment[a]=t[a]:n.helpers[a]=t[a]);const s=Object.assign({},this.hooks.modified.vertex),i=Object.assign({},this.hooks.modified.fragment);for(const a in n.vertex||{})a!=="declarations"&&(s[a]=!0);for(const a in n.fragment||{})a!=="declarations"&&(i[a]=!0);return new Ns(this._renderer,this._vertSrc,this._fragSrc,{declarations:(this.hooks.declarations||"")+`
`+(t.declarations||""),uniforms:Object.assign({},this.hooks.uniforms,t.uniforms||{}),fragment:Object.assign({},this.hooks.fragment,n.fragment||{}),vertex:Object.assign({},this.hooks.vertex,n.vertex||{}),helpers:Object.assign({},this.hooks.helpers,n.helpers||{}),modified:{vertex:s,fragment:i}})}init(){if(this._glProgram===0){const t=this._renderer.GL;if(this._vertShader=t.createShader(t.VERTEX_SHADER),t.shaderSource(this._vertShader,this.vertSrc()),t.compileShader(this._vertShader),!t.getShaderParameter(this._vertShader,t.COMPILE_STATUS)){const n=t.getShaderInfoLog(this._vertShader);if(typeof IS_MINIFIED<"u")console.error(n);else throw n;return null}if(this._fragShader=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(this._fragShader,this.fragSrc()),t.compileShader(this._fragShader),!t.getShaderParameter(this._fragShader,t.COMPILE_STATUS)){const n=t.getShaderInfoLog(this._fragShader);if(typeof IS_MINIFIED<"u")console.error(n);else throw n;return null}this._glProgram=t.createProgram(),t.attachShader(this._glProgram,this._vertShader),t.attachShader(this._glProgram,this._fragShader),t.linkProgram(this._glProgram),t.getProgramParameter(this._glProgram,t.LINK_STATUS)||p5._friendlyError(`Snap! Error linking shader program: ${t.getProgramInfoLog(this._glProgram)}`),this._loadAttributes(),this._loadUniforms()}return this}setDefaultUniforms(){for(const t in this.hooks.uniforms){const[,n]=t.split(" "),s=this.hooks.uniforms[t];let i;s instanceof Function?i=s():i=s,i!=null&&this.setUniform(n,i)}}copyToContext(t){const n=new Ns(t._renderer,this._vertSrc,this._fragSrc);return n.ensureCompiledOnContext(t._renderer),n}ensureCompiledOnContext(t){var n,s;if(this._glProgram!==0&&this._renderer!==t)throw new Error("The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?");this._glProgram===0&&(this._renderer=((s=(n=t==null?void 0:t._renderer)==null?void 0:n.filterRenderer)==null?void 0:s._renderer)||t,this.init())}_loadAttributes(){if(this._loadedAttributes)return;this.attributes={};const t=this._renderer.GL,n=t.getProgramParameter(this._glProgram,t.ACTIVE_ATTRIBUTES);for(let s=0;s<n;++s){const i=t.getActiveAttrib(this._glProgram,s),a=i.name,o=t.getAttribLocation(this._glProgram,a),u={};u.name=a,u.location=o,u.index=s,u.type=i.type,u.size=i.size,this.attributes[a]=u}this._loadedAttributes=!0}_loadUniforms(){if(this._loadedUniforms)return;const t=this._renderer.GL,n=t.getProgramParameter(this._glProgram,t.ACTIVE_UNIFORMS);let s=0;for(let i=0;i<n;++i){const a=t.getActiveUniform(this._glProgram,i),o={};o.location=t.getUniformLocation(this._glProgram,a.name),o.size=a.size;let u=a.name;a.size>1&&(u=u.substring(0,u.indexOf("[0]"))),o.name=u,o.type=a.type,o._cachedData=void 0,o.type===t.SAMPLER_2D&&(o.samplerIndex=s,s++,this.samplers.push(o)),o.isArray=a.size>1||o.type===t.FLOAT_MAT3||o.type===t.FLOAT_MAT4||o.type===t.FLOAT_VEC2||o.type===t.FLOAT_VEC3||o.type===t.FLOAT_VEC4||o.type===t.INT_VEC2||o.type===t.INT_VEC4||o.type===t.INT_VEC3,this.uniforms[u]=o}this._loadedUniforms=!0}compile(){}bindShader(){this.init(),this._bound||(this.useProgram(),this._bound=!0)}unbindShader(){return this._bound&&(this.unbindTextures(),this._bound=!1),this}bindTextures(){const t=this._renderer.GL,n=this._renderer._getEmptyTexture();for(const s of this.samplers){let i=s.texture;i===void 0&&(s.texture=i=n),t.activeTexture(t.TEXTURE0+s.samplerIndex),i.bindTexture(),i.update(),t.uniform1i(s.location,s.samplerIndex)}}updateTextures(){for(const t of this.samplers){const n=t.texture;n&&n.update()}}unbindTextures(){var s;const t=this._renderer.GL,n=this._renderer._getEmptyTexture();for(const i of this.samplers)(s=i.texture)!=null&&s.isFramebufferTexture&&(t.activeTexture(t.TEXTURE0+i.samplerIndex),n.bindTexture(),t.uniform1i(i.location,i.samplerIndex))}useProgram(){const t=this._renderer.GL;return this._renderer._curShader!==this&&(t.useProgram(this._glProgram),this._renderer._curShader=this),this}setUniform(t,n){this.init();const s=this.uniforms[t];if(!s)return;const i=this._renderer.GL;if(s.isArray){if(s._cachedData&&this._renderer._arraysEqual(s._cachedData,n))return;s._cachedData=n.slice(0)}else{if(s._cachedData&&s._cachedData===n)return;Array.isArray(n)?s._cachedData=n.slice(0):s._cachedData=n}const a=s.location;switch(this.useProgram(),s.type){case i.BOOL:n===!0?i.uniform1i(a,1):i.uniform1i(a,0);break;case i.INT:s.size>1?n.length&&i.uniform1iv(a,n):i.uniform1i(a,n);break;case i.FLOAT:s.size>1?n.length&&i.uniform1fv(a,n):i.uniform1f(a,n);break;case i.FLOAT_MAT3:i.uniformMatrix3fv(a,!1,n);break;case i.FLOAT_MAT4:i.uniformMatrix4fv(a,!1,n);break;case i.FLOAT_VEC2:s.size>1?n.length&&i.uniform2fv(a,n):i.uniform2f(a,n[0],n[1]);break;case i.FLOAT_VEC3:s.size>1?n.length&&i.uniform3fv(a,n):i.uniform3f(a,n[0],n[1],n[2]);break;case i.FLOAT_VEC4:s.size>1?n.length&&i.uniform4fv(a,n):i.uniform4f(a,n[0],n[1],n[2],n[3]);break;case i.INT_VEC2:s.size>1?n.length&&i.uniform2iv(a,n):i.uniform2i(a,n[0],n[1]);break;case i.INT_VEC3:s.size>1?n.length&&i.uniform3iv(a,n):i.uniform3i(a,n[0],n[1],n[2]);break;case i.INT_VEC4:s.size>1?n.length&&i.uniform4iv(a,n):i.uniform4i(a,n[0],n[1],n[2],n[3]);break;case i.SAMPLER_2D:if(typeof n=="number"){if(n<i.TEXTURE0||n>i.TEXTURE31||n!==Math.ceil(n))return console.log(" p5.js says: You're trying to use a number as the data for a texture.Please use a texture."),this;i.activeTexture(n),i.uniform1i(a,n)}else i.activeTexture(i.TEXTURE0+s.samplerIndex),s.texture=n instanceof bu?n:this._renderer.getTexture(n),i.uniform1i(a,s.samplerIndex),s.texture.src.gifProperties&&s.texture.src._animateGif(this._renderer._pInst);break;case i.SAMPLER_CUBE:case i.SAMPLER_3D:case i.SAMPLER_2D_SHADOW:case i.SAMPLER_2D_ARRAY:case i.SAMPLER_2D_ARRAY_SHADOW:case i.SAMPLER_CUBE_SHADOW:case i.INT_SAMPLER_2D:case i.INT_SAMPLER_3D:case i.INT_SAMPLER_CUBE:case i.INT_SAMPLER_2D_ARRAY:case i.UNSIGNED_INT_SAMPLER_2D:case i.UNSIGNED_INT_SAMPLER_3D:case i.UNSIGNED_INT_SAMPLER_CUBE:case i.UNSIGNED_INT_SAMPLER_2D_ARRAY:if(typeof n!="number")break;if(n<i.TEXTURE0||n>i.TEXTURE31||n!==Math.ceil(n)){console.log(" p5.js says: You're trying to use a number as the data for a texture.Please use a texture.");break}i.activeTexture(n),i.uniform1i(a,n);break}return this}enableAttrib(t,n,s,i,a,o){if(t){typeof IS_MINIFIED>"u"&&this.attributes[t.name]!==t&&console.warn(`The attribute "${t.name}"passed to enableAttrib does not belong to this shader.`);const u=t.location;if(u!==-1){const l=this._renderer.GL;this._renderer.registerEnabled.has(u)||(l.enableVertexAttribArray(u),this._renderer.registerEnabled.add(u)),this._renderer.GL.vertexAttribPointer(u,n,s||l.FLOAT,i||!1,a||0,o||0)}}return this}disableRemainingAttributes(){for(const t of this._renderer.registerEnabled.values())Object.keys(this.attributes).some(n=>this.attributes[n].location===t)||(this._renderer.GL.disableVertexAttribArray(t),this._renderer.registerEnabled.delete(t))}}function vT(r,t){r.Shader=Ns}typeof p5<"u"&&vT(p5,p5.prototype);var k8=`precision highp int;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

IN vec3 aPosition;
IN vec2 aTexCoord;
OUT vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // project to 3D space
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`,lF=`#define PI 3.141592

precision highp float;
precision highp int;

uniform mat4 uViewMatrix;

uniform bool uUseLighting;

uniform int uAmbientLightCount;
uniform vec3 uAmbientColor[5];
uniform mat3 uCameraRotation;
uniform int uDirectionalLightCount;
uniform vec3 uLightingDirection[5];
uniform vec3 uDirectionalDiffuseColors[5];
uniform vec3 uDirectionalSpecularColors[5];

uniform int uPointLightCount;
uniform vec3 uPointLightLocation[5];
uniform vec3 uPointLightDiffuseColors[5];	
uniform vec3 uPointLightSpecularColors[5];

uniform int uSpotLightCount;
uniform float uSpotLightAngle[5];
uniform float uSpotLightConc[5];
uniform vec3 uSpotLightDiffuseColors[5];
uniform vec3 uSpotLightSpecularColors[5];
uniform vec3 uSpotLightLocation[5];
uniform vec3 uSpotLightDirection[5];

uniform bool uSpecular;
uniform float uShininess;
uniform float uMetallic;

uniform float uConstantAttenuation;
uniform float uLinearAttenuation;
uniform float uQuadraticAttenuation;

// setting from  _setImageLightUniforms()
// boolean to initiate the calculateImageDiffuse and calculateImageSpecular
uniform bool uUseImageLight;
// texture for use in calculateImageDiffuse
uniform sampler2D environmentMapDiffused;
// texture for use in calculateImageSpecular
uniform sampler2D environmentMapSpecular;

const float specularFactor = 2.0;
const float diffuseFactor = 0.73;

struct LightResult {
  float specular;
  float diffuse;
};

float _phongSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float shininess) {

  vec3 R = reflect(lightDirection, surfaceNormal);
  return pow(max(0.0, dot(R, viewDirection)), shininess);
}

float _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {
  return max(0.0, dot(-lightDirection, surfaceNormal));
}

LightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector, float shininess, float metallic) {

  vec3 lightDir = normalize(lightVector);

  //compute our diffuse & specular terms
  LightResult lr;
  float specularIntensity = mix(1.0, 0.4, metallic);
  float diffuseIntensity = mix(1.0, 0.1, metallic);
  if (uSpecular)
    lr.specular = (_phongSpecular(lightDir, viewDirection, normal, shininess)) * specularIntensity;
    lr.diffuse = _lambertDiffuse(lightDir, normal) * diffuseIntensity;
  return lr;
}

// converts the range of "value" from [min1 to max1] to [min2 to max2]
float map(float value, float min1, float max1, float min2, float max2) {
  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);
}

vec2 mapTextureToNormal( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );
  return angles;
}


vec3 calculateImageDiffuse(vec3 vNormal, vec3 vViewPosition, float metallic){
  // make 2 seperate builds 
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position
  vec3 worldNormal = normalize(vNormal * uCameraRotation);
  vec2 newTexCoor = mapTextureToNormal( worldNormal );
  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(smoothstep(vec3(0.0), vec3(1.0), texture.xyz), vec3(0.0), metallic);
}

vec3 calculateImageSpecular(vec3 vNormal, vec3 vViewPosition, float shininess, float metallic){
  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);
  vec3 worldNormal = normalize(vNormal);
  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );
  vec3 R = reflect(lightDirection, worldNormal) * uCameraRotation;
  vec2 newTexCoor = mapTextureToNormal( R );
#ifdef WEBGL2
  // In p5js the range of shininess is >= 1,
  // Therefore roughness range will be ([0,1]*8)*20 or [0, 160]
  // The factor of 8 is because currently the getSpecularTexture
  // only calculated 8 different levels of roughness
  // The factor of 20 is just to spread up this range so that,
  // [1, max] of shininess is converted to [0,160] of roughness
  float roughness = 20. / shininess;
  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, roughness * 8.);
#else
  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);
#endif
  // this is to make the darker sections more dark
  // png and jpg usually flatten the brightness so it is to reverse that
  return mix(
    pow(outColor.xyz, vec3(10)),
    pow(outColor.xyz, vec3(1.2)),
    metallic 
  );
}

void totalLight(
  vec3 modelPosition,
  vec3 normal,
  float shininess,
  float metallic,
  out vec3 totalDiffuse,
  out vec3 totalSpecular
) {

  totalSpecular = vec3(0.0);

  if (!uUseLighting) {
    totalDiffuse = vec3(1.0);
    return;
  }

  totalDiffuse = vec3(0.0);

  vec3 viewDirection = normalize(-modelPosition);

  for (int j = 0; j < 5; j++) {
    if (j < uDirectionalLightCount) {
      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;
      vec3 lightColor = uDirectionalDiffuseColors[j];
      vec3 specularColor = uDirectionalSpecularColors[j];
      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if (j < uPointLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
      //calculate attenuation
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);
      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];
      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];

      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      totalDiffuse += result.diffuse * lightColor;
      totalSpecular += result.specular * lightColor * specularColor;
    }

    if(j < uSpotLightCount) {
      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;
      vec3 lightVector = modelPosition - lightPosition;
    
      float lightDistance = length(lightVector);
      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);

      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;
      float spotDot = dot(normalize(lightVector), normalize(lightDirection));
      float spotFalloff;
      if(spotDot < uSpotLightAngle[j]) {
        spotFalloff = 0.0;
      }
      else {
        spotFalloff = pow(spotDot, uSpotLightConc[j]);
      }
      lightFalloff *= spotFalloff;

      vec3 lightColor = uSpotLightDiffuseColors[j];
      vec3 specularColor = uSpotLightSpecularColors[j];
     
      LightResult result = _light(viewDirection, normal, lightVector, shininess, metallic);
      
      totalDiffuse += result.diffuse * lightColor * lightFalloff;
      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;
    }
  }

  if( uUseImageLight ){
    totalDiffuse += calculateImageDiffuse(normal, modelPosition, metallic);
    totalSpecular += calculateImageSpecular(normal, modelPosition, shininess, metallic);
  }

  totalDiffuse *= diffuseFactor;
  totalSpecular *= specularFactor;
}
`,Q_=`#ifdef WEBGL2

#define IN in
#define OUT out

#ifdef FRAGMENT_SHADER
out vec4 outColor;
#define OUT_COLOR outColor
#endif
#define TEXTURE texture

#else

#ifdef FRAGMENT_SHADER
#define IN varying
#else
#define IN attribute
#endif
#define OUT varying
#define TEXTURE texture2D

#ifdef FRAGMENT_SHADER
#define OUT_COLOR gl_FragColor
#endif

#endif

#ifdef FRAGMENT_SHADER
vec4 getTexture(in sampler2D content, vec2 coord) {
  vec4 color = TEXTURE(content, coord);
  color.rgb /= color.a;
  return color;
}
#endif
`,XQ=`IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

#define HOOK_DEFINES

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
uniform mat3 uModelNormalMatrix;
uniform mat3 uCameraNormalMatrix;
#else
uniform mat4 uModelViewMatrix;
uniform mat3 uNormalMatrix;
#endif
uniform mat4 uProjectionMatrix;

uniform vec4 uMaterialColor;
uniform bool uUseVertexColor;

OUT vec3 vVertexNormal;
OUT highp vec2 vVertTexCoord;
OUT vec4 vColor;

struct Vertex {
  vec3 position;
  vec3 normal;
  vec2 texCoord;
  vec4 color;
};

void main(void) {
  HOOK_beforeVertex();

  Vertex inputs;
  inputs.position = aPosition;
  inputs.normal = aNormal;
  inputs.texCoord = aTexCoord;
  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;
#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uModelNormalMatrix * inputs.normal;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uCameraNormalMatrix * inputs.normal;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uNormalMatrix * inputs.normal;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = HOOK_getCameraInputs(inputs);
#endif

  // Pass varyings to fragment shader
  vVertTexCoord = inputs.texCoord;
  vVertexNormal = normalize(inputs.normal);
  vColor = inputs.color;

  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);

  HOOK_afterVertex();
}
`,YQ=`IN vec3 vVertexNormal;
void main(void) {
  HOOK_beforeFragment();
  OUT_COLOR = HOOK_getFinalColor(vec4(vVertexNormal, 1.0));
  HOOK_afterFragment();
}
`,ZQ=`IN vec4 vColor;
void main(void) {
  HOOK_beforeFragment();
  OUT_COLOR = HOOK_getFinalColor(vec4(vColor.rgb, 1.) * vColor.a);
  HOOK_afterFragment();
}
`,QQ=`#define PI 3.141592

precision highp float;
  
uniform sampler2D uEnvMap;
uniform mat3 uNewNormalMatrix;
uniform float uFovY;
uniform float uAspect;

varying vec2 vTexCoord;
  
void main() {
    float uFovX = uFovY * uAspect; 
    float angleY = mix(uFovY/2.0,  -uFovY/2.0, vTexCoord.y);
    float angleX = mix(uFovX/2.0, -uFovX/2.0, vTexCoord.x);
    vec3 rotatedNormal = vec3( angleX, angleY, 1.0 );
    rotatedNormal = uNewNormalMatrix * normalize(rotatedNormal);
    float temp = rotatedNormal.z;
    rotatedNormal.z = rotatedNormal.x;
    rotatedNormal.x = -temp;
    vec2 suv;
    suv.y = 0.5 + 0.5 * (-rotatedNormal.y);
    suv.x = atan(rotatedNormal.z, rotatedNormal.x) / (2.0 * PI) + 0.5;
    vec4 newTexColor = texture2D(uEnvMap, suv.xy);
    gl_FragColor = newTexColor;
}
`,JQ=`// include lighting.glgl

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT highp vec2 vVertTexCoord;
OUT vec3 vDiffuseColor;
OUT vec3 vSpecularColor;
OUT vec4 vColor;

void main(void) {

  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;

  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);
  vVertTexCoord = aTexCoord;

  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);

  for (int i = 0; i < 8; i++) {
    if (i < uAmbientLightCount) {
      vDiffuseColor += uAmbientColor[i];
    }
  }
  
  vColor = ((uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor);
}
`,eJ=`uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;
uniform bool uEmissive;

IN highp vec2 vVertTexCoord;
IN vec3 vDiffuseColor;
IN vec3 vSpecularColor;
IN vec4 vColor;

void main(void) {
  if(uEmissive && !isTexture) {
    OUT_COLOR = vColor;
  }
  else {
    vec4 baseColor = isTexture
      // Textures come in with premultiplied alpha. To apply tint and still have
      // premultiplied alpha output, we need to multiply the RGB channels by the
      // tint RGB, and all channels by the tint alpha.
      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)
      // Colors come in with unmultiplied alpha, so we need to multiply the RGB
      // channels by alpha to convert it to premultiplied alpha.
      : vec4(vColor.rgb * vColor.a, vColor.a);
    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);
  }
}
`,tJ=`precision highp int;

#define HOOK_DEFINES

IN vec3 aPosition;
IN vec3 aNormal;
IN vec2 aTexCoord;
IN vec4 aVertexColor;

uniform vec3 uAmbientColor[5];

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
uniform mat3 uModelNormalMatrix;
uniform mat3 uCameraNormalMatrix;
#else
uniform mat4 uModelViewMatrix;
uniform mat3 uNormalMatrix;
#endif
uniform mat4 uProjectionMatrix;
uniform int uAmbientLightCount;

uniform bool uUseVertexColor;
uniform vec4 uMaterialColor;

OUT vec3 vNormal;
OUT vec2 vTexCoord;
OUT vec3 vViewPosition;
OUT vec3 vAmbientColor;
OUT vec4 vColor;

struct Vertex {
  vec3 position;
  vec3 normal;
  vec2 texCoord;
  vec4 color;
};

void main(void) {
  HOOK_beforeVertex();

  Vertex inputs;
  inputs.position = aPosition;
  inputs.normal = aNormal;
  inputs.texCoord = aTexCoord;
  inputs.color = (uUseVertexColor && aVertexColor.x >= 0.0) ? aVertexColor : uMaterialColor;
#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uModelNormalMatrix * inputs.normal;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uCameraNormalMatrix * inputs.normal;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.normal = uNormalMatrix * inputs.normal;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = HOOK_getCameraInputs(inputs);
#endif

  // Pass varyings to fragment shader
  vViewPosition = inputs.position;
  vTexCoord = inputs.texCoord;
  vNormal = inputs.normal;
  vColor = inputs.color;

  // TODO: this should be a uniform
  vAmbientColor = vec3(0.0);
  for (int i = 0; i < 5; i++) {
    if (i < uAmbientLightCount) {
      vAmbientColor += uAmbientColor[i];
    }
  }

  gl_Position = uProjectionMatrix * vec4(inputs.position, 1.);
  HOOK_afterVertex();
}
`,nJ=`// include lighting.glsl
precision highp int;

uniform bool uHasSetAmbient;
uniform vec4 uSpecularMatColor;
uniform vec4 uAmbientMatColor;
uniform vec4 uEmissiveMatColor;

uniform vec4 uTint;
uniform sampler2D uSampler;
uniform bool isTexture;

IN vec3 vNormal;
IN vec2 vTexCoord;
IN vec3 vViewPosition;
IN vec3 vAmbientColor;
IN vec4 vColor;

struct ColorComponents {
  vec3 baseColor;
  float opacity;
  vec3 ambientColor;
  vec3 specularColor;
  vec3 diffuse;
  vec3 ambient;
  vec3 specular;
  vec3 emissive;
};

struct Inputs {
  vec3 normal;
  vec2 texCoord;
  vec3 ambientLight;
  vec3 ambientMaterial;
  vec3 specularMaterial;
  vec3 emissiveMaterial;
  vec4 color;
  float shininess;
  float metalness;
};

void main(void) {
  HOOK_beforeFragment();

  Inputs inputs;
  inputs.normal = normalize(vNormal);
  inputs.texCoord = vTexCoord;
  inputs.ambientLight = vAmbientColor;
  inputs.color = isTexture
      ? TEXTURE(uSampler, vTexCoord) * (vec4(uTint.rgb/255., 1.) * uTint.a/255.)
      : vColor;
  if (isTexture && inputs.color.a > 0.0) {
    // Textures come in with premultiplied alpha. Temporarily unpremultiply it
    // so hooks users don't have to think about premultiplied alpha.
    inputs.color.rgb /= inputs.color.a;
  }
  inputs.shininess = uShininess;
  inputs.metalness = uMetallic;
  inputs.ambientMaterial = uHasSetAmbient ? uAmbientMatColor.rgb : inputs.color.rgb;
  inputs.specularMaterial = uSpecularMatColor.rgb;
  inputs.emissiveMaterial = uEmissiveMatColor.rgb;
  inputs = HOOK_getPixelInputs(inputs);

  vec3 diffuse;
  vec3 specular;
  totalLight(vViewPosition, inputs.normal, inputs.shininess, inputs.metalness, diffuse, specular);

  // Calculating final color as result of all lights (plus emissive term).

  vec2 texCoord = inputs.texCoord;
  vec4 baseColor = inputs.color;
  ColorComponents c;
  c.opacity = baseColor.a;
  c.baseColor = baseColor.rgb;
  c.ambientColor = inputs.ambientMaterial;
  c.specularColor = inputs.specularMaterial;
  c.diffuse = diffuse;
  c.ambient = inputs.ambientLight;
  c.specular = specular;
  c.emissive = inputs.emissiveMaterial;
  OUT_COLOR = HOOK_getFinalColor(HOOK_combineColors(c));
  OUT_COLOR.rgb *= OUT_COLOR.a; // Premultiply alpha before rendering
  HOOK_afterFragment();
}
`,rJ=`IN vec3 aPosition;
IN vec2 aTexCoord;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

uniform vec4 uGlyphRect;
uniform float uGlyphOffset;

OUT vec2 vTexCoord;
OUT float w;

void main() {
  vec4 positionVec4 = vec4(aPosition, 1.0);

  // scale by the size of the glyph's rectangle
  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;

  // Expand glyph bounding boxes by 1px on each side to give a bit of room
  // for antialiasing
  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;
  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;
  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;
  vec2 pixelScale = vec2(
    1. / length(newOrigin - newDX),
    1. / length(newOrigin - newDY)
  );
  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5));
  vec2 textureOffset = offset * (1. / vec2(
    uGlyphRect.z - uGlyphRect.x,
    uGlyphRect.w - uGlyphRect.y
  ));

  // move to the corner of the glyph
  positionVec4.xy += uGlyphRect.xy;

  // move to the letter's line offset
  positionVec4.x += uGlyphOffset;

  positionVec4.xy += offset;
  
  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
  vTexCoord = aTexCoord + textureOffset;
  w = gl_Position.w;
}
`,sJ=`#ifndef WEBGL2
#extension GL_OES_standard_derivatives : enable
#endif

#if 0
  // simulate integer math using floats
	#define int float
	#define ivec2 vec2
	#define INT(x) float(x)

	int ifloor(float v) { return floor(v); }
	ivec2 ifloor(vec2 v) { return floor(v); }

#else
  // use native integer math
	precision highp int;
	#define INT(x) x

	int ifloor(float v) { return int(v); }
	int ifloor(int v) { return v; }
	ivec2 ifloor(vec2 v) { return ivec2(v); }

#endif

uniform sampler2D uSamplerStrokes;
uniform sampler2D uSamplerRowStrokes;
uniform sampler2D uSamplerRows;
uniform sampler2D uSamplerColStrokes;
uniform sampler2D uSamplerCols;

uniform ivec2 uStrokeImageSize;
uniform ivec2 uCellsImageSize;
uniform ivec2 uGridImageSize;

uniform ivec2 uGridOffset;
uniform ivec2 uGridSize;
uniform vec4 uMaterialColor;

IN vec2 vTexCoord;

// some helper functions
int ROUND(float v) { return ifloor(v + 0.5); }
ivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }
float saturate(float v) { return clamp(v, 0.0, 1.0); }
vec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }

int mul(float v1, int v2) {
  return ifloor(v1 * float(v2));
}

ivec2 mul(vec2 v1, ivec2 v2) {
  return ifloor(v1 * vec2(v2) + 0.5);
}

// unpack a 16-bit integer from a float vec2
int getInt16(vec2 v) {
  ivec2 iv = ROUND(v * 255.0);
  return iv.x * INT(128) + iv.y;
}

vec2 pixelScale;
vec2 coverage = vec2(0.0);
vec2 weight = vec2(0.5);
const float minDistance = 1.0/8192.0;
const float hardness = 1.05; // amount of antialias

// the maximum number of curves in a glyph
const int N = INT(250);

// retrieves an indexed pixel from a sampler
vec4 getTexel(sampler2D sampler, int pos, ivec2 size) {
  int width = size.x;
  int y = ifloor(pos / width);
  int x = pos - y * width;  // pos % width

  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));
}

void calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {

  // get the coefficients of the quadratic in t
  vec2 a = p0 - p1 * 2.0 + p2;
  vec2 b = p0 - p1;
  vec2 c = p0 - vTexCoord;

  // found out which values of 't' it crosses the axes
  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));
  vec2 t1 = ((b - surd) / a).yx;
  vec2 t2 = ((b + surd) / a).yx;

  // approximate straight lines to avoid rounding errors
  if (abs(a.y) < 0.001)
    t1.x = t2.x = c.y / (2.0 * b.y);

  if (abs(a.x) < 0.001)
    t1.y = t2.y = c.x / (2.0 * b.x);

  // plug into quadratic formula to find the corrdinates of the crossings
  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;
  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;
}

void coverageX(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  // determine on which side of the x-axis the points lie
  bool y0 = p0.y > vTexCoord.y;
  bool y1 = p1.y > vTexCoord.y;
  bool y2 = p2.y > vTexCoord.y;

  // could web be under the curve (after t1)?
  if (y1 ? !y2 : y0) {
    // add the coverage for t1
    coverage.x += saturate(C1.x + 0.5);
    // calculate the anti-aliasing for t1
    weight.x = min(weight.x, abs(C1.x));
  }

  // are we outside the curve (after t2)?
  if (y1 ? !y0 : y2) {
    // subtract the coverage for t2
    coverage.x -= saturate(C2.x + 0.5);
    // calculate the anti-aliasing for t2
    weight.x = min(weight.x, abs(C2.x));
  }
}

// this is essentially the same as coverageX, but with the axes swapped
void coverageY(vec2 p0, vec2 p1, vec2 p2) {

  vec2 C1, C2;
  calulateCrossings(p0, p1, p2, C1, C2);

  bool x0 = p0.x > vTexCoord.x;
  bool x1 = p1.x > vTexCoord.x;
  bool x2 = p2.x > vTexCoord.x;

  if (x1 ? !x2 : x0) {
    coverage.y -= saturate(C1.y + 0.5);
    weight.y = min(weight.y, abs(C1.y));
  }

  if (x1 ? !x0 : x2) {
    coverage.y += saturate(C2.y + 0.5);
    weight.y = min(weight.y, abs(C2.y));
  }
}

void main() {

  // calculate the pixel scale based on screen-coordinates
  pixelScale = hardness / fwidth(vTexCoord);

  // which grid cell is this pixel in?
  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));

  // intersect curves in this row
  {
    // the index into the row info bitmap
    int rowIndex = gridCoord.y + uGridOffset.y;
    // fetch the info texel
    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);
    // unpack the rowInfo
    int rowStrokeIndex = getInt16(rowInfo.xy);
    int rowStrokeCount = getInt16(rowInfo.zw);

    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {
      if (iRowStroke >= rowStrokeCount)
        break;

      // each stroke is made up of 3 points: the start and control point
      // and the start of the next curve.
      // fetch the indices of this pair of strokes:
      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);

      // unpack the stroke index
      int strokePos = getInt16(strokeIndices.xy);

      // fetch the two strokes
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);

      // calculate the coverage
      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  // intersect curves in this column
  {
    int colIndex = gridCoord.x + uGridOffset.x;
    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);
    int colStrokeIndex = getInt16(colInfo.xy);
    int colStrokeCount = getInt16(colInfo.zw);
    
    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {
      if (iColStroke >= colStrokeCount)
        break;

      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);

      int strokePos = getInt16(strokeIndices.xy);
      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);
      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);
      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);
    }
  }

  weight = saturate(1.0 - weight * 2.0);
  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.
  float antialias = abs(dot(coverage, weight) / distance);
  float cover = min(abs(coverage.x), abs(coverage.y));
  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;
  OUT_COLOR *= saturate(max(antialias, cover));
}
`,iJ=`/*
  Part of the Processing project - http://processing.org
  Copyright (c) 2012-15 The Processing Foundation
  Copyright (c) 2004-12 Ben Fry and Casey Reas
  Copyright (c) 2001-04 Massachusetts Institute of Technology
  This library is free software; you can redistribute it and/or
  modify it under the terms of the GNU Lesser General Public
  License as published by the Free Software Foundation, version 2.1.
  This library is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  Lesser General Public License for more details.
  You should have received a copy of the GNU Lesser General
  Public License along with this library; if not, write to the
  Free Software Foundation, Inc., 59 Temple Place, Suite 330,
  Boston, MA  02111-1307  USA
*/

#define PROCESSING_LINE_SHADER

#define HOOK_DEFINES

precision highp int;
precision highp float;

#ifdef AUGMENTED_HOOK_getWorldInputs
uniform mat4 uModelMatrix;
uniform mat4 uViewMatrix;
#else
uniform mat4 uModelViewMatrix;
#endif

uniform mat4 uProjectionMatrix;
uniform float uStrokeWeight;

uniform bool uUseLineColor;
uniform bool uSimpleLines;
uniform vec4 uMaterialColor;

uniform vec4 uViewport;
uniform int uPerspective;
uniform int uStrokeJoin;

IN vec3 aPosition;
IN vec3 aTangentIn;
IN vec3 aTangentOut;
IN float aSide;
IN vec4 aVertexColor;

OUT vec4 vColor;
OUT vec2 vTangent;
OUT vec2 vCenter;
OUT vec2 vPosition;
OUT float vMaxDist;
OUT float vCap;
OUT float vJoin;
OUT float vStrokeWeight;

vec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {
  // Rotate and translate so a starts at the origin and goes out to the right
  bPoint -= aPoint;
  vec2 rotatedBFrom = vec2(
    bPoint.x*aDir.x + bPoint.y*aDir.y,
    bPoint.y*aDir.x - bPoint.x*aDir.y
  );
  vec2 bTo = bPoint + bDir;
  vec2 rotatedBTo = vec2(
    bTo.x*aDir.x + bTo.y*aDir.y,
    bTo.y*aDir.x - bTo.x*aDir.y
  );
  float intersectionDistance =
    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /
    (rotatedBTo.y - rotatedBFrom.y);
  return aPoint + aDir * intersectionDistance;
}

struct StrokeVertex {
  vec3 position;
  vec3 tangentIn;
  vec3 tangentOut;
  vec4 color;
  float weight;
};

void main() {
  HOOK_beforeVertex();

  if (!uSimpleLines) {
      // Caps have one of either the in or out tangent set to 0
      vCap = (aTangentIn == vec3(0.)) != (aTangentOut == vec3(0.)) ? 1. : 0.;

      // Joins have two unique, defined tangents
      vJoin = (
          aTangentIn != vec3(0.) &&
          aTangentOut != vec3(0.) &&
          aTangentIn != aTangentOut
      ) ? 1. : 0.;
  }

  StrokeVertex inputs;
  inputs.position = aPosition.xyz;
  inputs.color = uUseLineColor ? aVertexColor : uMaterialColor;
  inputs.weight = uStrokeWeight;
  inputs.tangentIn = aTangentIn;
  inputs.tangentOut = aTangentOut;

#ifdef AUGMENTED_HOOK_getObjectInputs
  inputs = HOOK_getObjectInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  inputs.position = (uModelMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uModelMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uModelMatrix * vec4(aTangentOut, 0.)).xyz;
  inputs = HOOK_getWorldInputs(inputs);
#endif

#ifdef AUGMENTED_HOOK_getWorldInputs
  // Already multiplied by the model matrix, just apply view
  inputs.position = (uViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uViewMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uViewMatrix * vec4(aTangentOut, 0.)).xyz;
#else
  // Apply both at once
  inputs.position = (uModelViewMatrix * vec4(inputs.position, 1.)).xyz;
  inputs.tangentIn = (uModelViewMatrix * vec4(aTangentIn, 0.)).xyz;
  inputs.tangentOut = (uModelViewMatrix * vec4(aTangentOut, 0.)).xyz;
#endif
#ifdef AUGMENTED_HOOK_getCameraInputs
  inputs = hook_getCameraInputs(inputs);
#endif

  vec4 posp = vec4(inputs.position, 1.);
  vec4 posqIn = vec4(inputs.position + inputs.tangentIn, 1.);
  vec4 posqOut = vec4(inputs.position + inputs.tangentOut, 1.);
  vStrokeWeight = inputs.weight;

  float facingCamera = pow(
    // The word space tangent's z value is 0 if it's facing the camera
    abs(normalize(posqIn-posp).z),

    // Using pow() here to ramp \`facingCamera\` up from 0 to 1 really quickly
    // so most lines get scaled and don't get clipped
    0.25
  );

  // Moving vertices slightly toward the camera
  // to avoid depth-fighting with the fill triangles.
  // A mix of scaling and offsetting is used based on distance
  // Discussion here:
  // https://github.com/processing/p5.js/issues/7200 

  // using a scale <1 moves the lines towards nearby camera
  // in order to prevent popping effects due to half of
  // the line disappearing behind the geometry faces.
  float zDistance = -posp.z; 
  float distanceFactor = smoothstep(0.0, 800.0, zDistance); 
  
  // Discussed here:
  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  
  float scale = mix(1., 0.995, facingCamera);
  float dynamicScale = mix(scale, 1.0, distanceFactor); // Closer = more scale, farther = less

  posp.xyz = posp.xyz * dynamicScale;
  posqIn.xyz = posqIn.xyz * dynamicScale;
  posqOut.xyz = posqOut.xyz * dynamicScale;

  // Moving vertices slightly toward camera when far away 
  // https://github.com/processing/p5.js/issues/6956 
  float zOffset = mix(0., -1., facingCamera);
  float dynamicZAdjustment = mix(0.0, zOffset, distanceFactor); // Closer = less zAdjustment, farther = more

  posp.z -= dynamicZAdjustment;
  posqIn.z -= dynamicZAdjustment;
  posqOut.z -= dynamicZAdjustment;
  
  vec4 p = uProjectionMatrix * posp;
  vec4 qIn = uProjectionMatrix * posqIn;
  vec4 qOut = uProjectionMatrix * posqOut;

  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])
  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw

  // prevent division by W by transforming the tangent formula (div by 0 causes
  // the line to disappear, see https://github.com/processing/processing/issues/5183)
  // t = screen_q - screen_p
  //
  // tangent is normalized and we don't care which aDirection it points to (+-)
  // t = +- normalize( screen_q - screen_p )
  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )
  //
  // extract common factor, <1,1> - <1,1> cancels out
  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )
  //
  // convert to common divisor
  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )
  //
  // remove the common scalar divisor/factor, not needed due to normalize and +-
  // (keep uViewport - can't remove because it has different components for x and y
  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)
  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )

  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);
  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);

  vec2 curPerspScale;
  if(uPerspective == 1) {
    // Perspective ---
    // convert from world to clip by multiplying with projection scaling factor
    // to get the right thickness (see https://github.com/processing/processing/issues/5182)

    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.
    // Multiplying again by its sign here negates the flip to get just the scale.
    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;
  } else {
    // No Perspective ---
    // multiply by W (to cancel out division by W later in the pipeline) and
    // convert from screen to clip (derived from clip to screen above)
    curPerspScale = p.w / (0.5 * uViewport.zw);
  }

  vec2 offset;
  if (vJoin == 1. && !uSimpleLines) {
    vTangent = normalize(tangentIn + tangentOut);
    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);
    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);
    float side = sign(aSide);
    float sideEnum = abs(aSide);

    // We generate vertices for joins on either side of the centerline, but
    // the "elbow" side is the only one needing a join. By not setting the
    // offset for the other side, all its vertices will end up in the same
    // spot and not render, effectively discarding it.
    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {
      // Side enums:
      //   1: the side going into the join
      //   2: the middle of the join
      //   3: the side going out of the join
      if (sideEnum == 2.) {
        // Calculate the position + tangent on either side of the join, and
        // find where the lines intersect to find the elbow of the join
        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;
        vec2 intersection = lineIntersection(
          c + (side * normalIn * inputs.weight / 2.),
          tangentIn,
          c + (side * normalOut * inputs.weight / 2.),
          tangentOut
        );
        offset = (intersection - c);

        // When lines are thick and the angle of the join approaches 180, the
        // elbow might be really far from the center. We'll apply a limit to
        // the magnitude to avoid lines going across the whole screen when this
        // happens.
        float mag = length(offset);
        float maxMag = 3. * inputs.weight;
        if (mag > maxMag) {
          offset *= maxMag / mag;
        }
      } else if (sideEnum == 1.) {
        offset = side * normalIn * inputs.weight / 2.;
      } else if (sideEnum == 3.) {
        offset = side * normalOut * inputs.weight / 2.;
      }
    }
    if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);
      vMaxDist = abs(dot(avgNormal, normalIn * inputs.weight / 2.));
    } else {
      vMaxDist = inputs.weight / 2.;
    }
  } else {
    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;
    vTangent = tangent;
    vec2 normal = vec2(-tangent.y, tangent.x);

    float normalOffset = sign(aSide);
    // Caps will have side values of -2 or 2 on the edge of the cap that
    // extends out from the line
    float tangentOffset = abs(aSide) - 1.;
    offset = (normal * normalOffset + tangent * tangentOffset) *
      inputs.weight * 0.5;
    vMaxDist = inputs.weight / 2.;
  }

  vCenter = p.xy;
  vPosition = vCenter + offset;
  vColor = inputs.color;

  gl_Position.xy = p.xy + offset.xy * curPerspScale;
  gl_Position.zw = p.zw;
  
  HOOK_afterVertex();
}
`,aJ=`precision highp int;
precision highp float;

uniform vec4 uMaterialColor;
uniform int uStrokeCap;
uniform int uStrokeJoin;

IN vec4 vColor;
IN vec2 vTangent;
IN vec2 vCenter;
IN vec2 vPosition;
IN float vStrokeWeight;
IN float vMaxDist;
IN float vCap;
IN float vJoin;

float distSquared(vec2 a, vec2 b) {
  vec2 aToB = b - a;
  return dot(aToB, aToB);
}

struct Inputs {
  vec4 color;
  vec2 tangent;
  vec2 center;
  vec2 position;
  float strokeWeight;
};

void main() {
  HOOK_beforeFragment();

  Inputs inputs;
  inputs.color = vColor;
  inputs.tangent = vTangent;
  inputs.center = vCenter;
  inputs.position = vPosition;
  inputs.strokeWeight = vStrokeWeight;
  inputs = HOOK_getPixelInputs(inputs);

  if (vCap > 0.) {
    if (
      uStrokeCap == STROKE_CAP_ROUND &&
      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)
    ) {
      discard;
    } else if (
      uStrokeCap == STROKE_CAP_SQUARE &&
      HOOK_shouldDiscard(dot(inputs.position - inputs.center, inputs.tangent) > 0.)
    ) {
      discard;
    // Use full area for PROJECT
    } else if (HOOK_shouldDiscard(false)) {
      discard;
    }
  } else if (vJoin > 0.) {
    if (
      uStrokeJoin == STROKE_JOIN_ROUND &&
      HOOK_shouldDiscard(distSquared(inputs.position, inputs.center) > inputs.strokeWeight * inputs.strokeWeight * 0.25)
    ) {
      discard;
    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {
      vec2 normal = vec2(-inputs.tangent.y, inputs.tangent.x);
      if (HOOK_shouldDiscard(abs(dot(inputs.position - inputs.center, normal)) > vMaxDist)) {
        discard;
      }
    // Use full area for MITER
    } else if (HOOK_shouldDiscard(false)) {
      discard;
    }
  }
  OUT_COLOR = HOOK_getFinalColor(vec4(inputs.color.rgb, 1.) * inputs.color.a);
  HOOK_afterFragment();
}
`,oJ=`IN vec3 aPosition;
uniform float uPointSize;
OUT float vStrokeWeight;
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

void main() {
  HOOK_beforeVertex();
  vec4 viewModelPosition = vec4(HOOK_getWorldPosition(
    (uModelViewMatrix * vec4(HOOK_getLocalPosition(aPosition), 1.0)).xyz
  ), 1.);
  gl_Position = uProjectionMatrix * viewModelPosition;  

  float pointSize = HOOK_getPointSize(uPointSize);

	gl_PointSize = pointSize;
	vStrokeWeight = pointSize;
  HOOK_afterVertex();
}
`,uJ=`precision mediump int;
uniform vec4 uMaterialColor;
IN float vStrokeWeight;

void main(){
  HOOK_beforeFragment();
  float mask = 0.0;

  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)
  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant

  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));

  // if strokeWeight is 1 or less lets just draw a square
  // this prevents weird artifacting from carving circles when our points are really small
  // if strokeWeight is larger than 1, we just use it as is

  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));

  // throw away the borders of the mask
  // otherwise we get weird alpha blending issues

  if(HOOK_shouldDiscard(mask > 0.98)){
    discard;
  }

  OUT_COLOR = HOOK_getFinalColor(vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a);
  HOOK_afterFragment();
}
`,lJ=`precision highp float;
attribute vec3 aPosition;
attribute vec3 aNormal;
attribute vec2 aTexCoord;

varying vec3 localPos;
varying vec3 vWorldNormal;
varying vec3 vWorldPosition;
varying vec2 vTexCoord;

uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;

void main() {
  // Multiply the position by the matrix.
  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);
  gl_Position = uProjectionMatrix * viewModelPosition;  
  
  // orient the normals and pass to the fragment shader
  vWorldNormal = uNormalMatrix * aNormal;
  
  // send the view position to the fragment shader
  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;
  
  localPos = vWorldPosition;
  vTexCoord = aTexCoord;
}


/*
in the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.
*/
`,cJ=`precision highp float;
varying vec3 localPos;

// the HDR cubemap converted (can be from an equirectangular environment map.)
uniform sampler2D environmentMap;
varying vec2 vTexCoord;

const float PI = 3.14159265359;

vec2 nTOE( vec3 v ){
  // x = r sin(phi) cos(theta)   
  // y = r cos(phi)  
  // z = r sin(phi) sin(theta)
  float phi = acos( v.y );
  // if phi is 0, then there are no x, z components
  float theta = 0.0;
  // else 
  theta = acos(v.x / sin(phi));
  float sinTheta = v.z / sin(phi);
  if (sinTheta < 0.0) {
    // Turn it into -theta, but in the 0-2PI range
    theta = 2.0 * PI - theta;
  }
  theta = theta / (2.0 * 3.14159);
  phi = phi / 3.14159 ;
  
  vec2 angles = vec2( phi, theta );
  return angles;
}

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

void main()
{   	 
	// the sample direction equals the hemisphere's orientation
  float phi = vTexCoord.x * 2.0 * PI;
  float theta = vTexCoord.y * PI;
  float x = sin(theta) * cos(phi);
  float y = sin(theta) * sin(phi);
  float z = cos(theta);
  vec3 normal = vec3( x, y, z);

	// Discretely sampling the hemisphere given the integral's
  // spherical coordinates translates to the following fragment code:
	vec3 irradiance = vec3(0.0);  
	vec3 up	= vec3(0.0, 1.0, 0.0);
	vec3 right = normalize(cross(up, normal));
	up = normalize(cross(normal, right));

	//  We specify a fixed sampleDelta delta value to traverse
  // the hemisphere; decreasing or increasing the sample delta
  // will increase or decrease the accuracy respectively.
	const float sampleDelta = 0.100;
	float nrSamples = 0.0;
  float randomOffset = random(gl_FragCoord.xy) * sampleDelta;
	for(float rawPhi = 0.0; rawPhi < 2.0 * PI; rawPhi += sampleDelta)
	{
    float phi = rawPhi + randomOffset;
    for(float rawTheta = 0.0; rawTheta < ( 0.5 ) * PI; rawTheta += sampleDelta)
    {
      float theta = rawTheta + randomOffset;
      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance
      float x = sin(theta) * cos(phi);
      float y = sin(theta) * sin(phi);
      float z = cos(theta);
      vec3 tangentSample = vec3( x, y, z);
      
      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;
        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);
      nrSamples++;
    }
	}
	// divide by the total number of samples taken, giving us the average sampled irradiance.
	irradiance = PI * irradiance * (1.0 / float(nrSamples )) ;
  
 
	gl_FragColor = vec4(irradiance, 1.0);
}`,hJ=`precision highp float;\r
varying vec3 localPos;\r
varying vec2 vTexCoord;\r
\r
// our texture\r
uniform sampler2D environmentMap;\r
uniform float roughness;\r
\r
const float PI = 3.14159265359;\r
\r
float VanDerCorput(int bits);\r
vec2 HammersleyNoBitOps(int i, int N);\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\r
\r
\r
vec2 nTOE( vec3 v ){\r
  // x = r sin(phi) cos(theta)   \r
  // y = r cos(phi)  \r
  // z = r sin(phi) sin(theta)\r
  float phi = acos( v.y );\r
  // if phi is 0, then there are no x, z components\r
  float theta = 0.0;\r
  // else \r
  theta = acos(v.x / sin(phi));\r
  float sinTheta = v.z / sin(phi);\r
  if (sinTheta < 0.0) {\r
    // Turn it into -theta, but in the 0-2PI range\r
    theta = 2.0 * PI - theta;\r
  }\r
  theta = theta / (2.0 * 3.14159);\r
  phi = phi / 3.14159 ;\r
  \r
  vec2 angles = vec2( phi, theta );\r
  return angles;\r
}\r
\r
\r
void main(){\r
  const int SAMPLE_COUNT = 400; // 4096\r
  int lowRoughnessLimit = int(pow(2.0,(roughness+0.1)*20.0));\r
  float totalWeight = 0.0;\r
  vec3 prefilteredColor = vec3(0.0);\r
  float phi = vTexCoord.x * 2.0 * PI;\r
  float theta = vTexCoord.y * PI;\r
  float x = sin(theta) * cos(phi);\r
  float y = sin(theta) * sin(phi);\r
  float z = cos(theta);\r
  vec3 N = vec3(x,y,z);\r
  vec3 V = N;\r
  for (int i = 0; i < SAMPLE_COUNT; ++i)\r
  {\r
    // break at smaller sample numbers for low roughness levels\r
    if(i == lowRoughnessLimit)\r
    {\r
      break;\r
    }\r
    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\r
    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\r
    vec3 L = normalize(2.0 * dot(V, H) * H - V);\r
\r
    float NdotL = max(dot(N, L), 0.0);\r
    if (NdotL > 0.0)\r
    {\r
      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\r
      totalWeight += NdotL;\r
    }\r
  }\r
  prefilteredColor = prefilteredColor / totalWeight;\r
\r
  gl_FragColor = vec4(prefilteredColor, 1.0);\r
}\r
\r
vec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\r
  float a = roughness * roughness;\r
\r
  float phi = 2.0 * PI * Xi.x;\r
  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\r
  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\r
  // from spherical coordinates to cartesian coordinates\r
  vec3 H;\r
  H.x = cos(phi) * sinTheta;\r
  H.y = sin(phi) * sinTheta;\r
  H.z = cosTheta;\r
\r
  // from tangent-space vector to world-space sample vector\r
  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\r
  vec3 tangent = normalize(cross(up, N));\r
  vec3 bitangent = cross(N, tangent);\r
\r
  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\r
  return normalize(sampleVec);\r
}\r
\r
\r
float VanDerCorput(int n, int base)\r
{\r
#ifdef WEBGL2\r
\r
    uint bits = uint(n);\r
    bits = (bits << 16u) | (bits >> 16u);\r
    bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\r
    bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\r
    bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\r
    bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\r
    return float(bits) * 2.3283064365386963e-10; // / 0x100000000\r
\r
#else\r
\r
  float invBase = 1.0 / float(base);\r
  float denom = 1.0;\r
  float result = 0.0;\r
\r
\r
  for (int i = 0; i < 32; ++i)\r
  {\r
        if (n > 0)\r
        {\r
        denom = mod(float(n), 2.0);\r
        result += denom * invBase;\r
        invBase = invBase / 2.0;\r
        n = int(float(n) / 2.0);\r
        }\r
  }\r
\r
\r
  return result;\r
\r
#endif\r
}\r
\r
vec2 HammersleyNoBitOps(int i, int N)\r
{\r
  return vec2(float(i) / float(N), VanDerCorput(i, 2));\r
}\r
`,A8=`precision highp float;

uniform sampler2D tex0;
uniform vec2 canvasSize;
uniform vec2 texelSize;

IN vec2 vTexCoord;

struct FilterInputs {
  vec2 texCoord;
  vec2 canvasSize;
  vec2 texelSize;
};

void main(void) {
  FilterInputs inputs;
  inputs.texCoord = vTexCoord;
  inputs.canvasSize = canvasSize;
  inputs.texelSize = texelSize;
  OUT_COLOR = HOOK_getColor(inputs, tex0);
  OUT_COLOR.rgb *= outColor.a;
}
`,I8=`precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 tex = texture2D(tex0, vTexCoord);
  float gray = luma(tex.rgb);
  gl_FragColor = vec4(gray, gray, gray, tex.a);
}
`,$8=`// Reduces the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the darkest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum < lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`,F8=`// Increase the bright areas in an image

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform vec2 texelSize;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  // weights 77, 151, 28 taken from src/image/filters.js
  return dot(color, vec3(0.300781, 0.589844, 0.109375));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float lum = luma(color.rgb);

  // set current color as the brightest neighbor color

  vec4 neighbors[4];
  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));
  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));
  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));
  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));

  for (int i = 0; i < 4; i++) {
    vec4 neighborColor = neighbors[i];
    float neighborLum = luma(neighborColor.rgb);

    if (neighborLum > lum) {
      color = neighborColor;
      lum = neighborLum;
    }
  }

  gl_FragColor = color;
}
`,R8=`precision highp float;

// Two-pass blur filter, unweighted kernel.
// See also a similar blur at Adam Ferriss' repo of shader examples:
// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag


uniform sampler2D tex0;
varying vec2 vTexCoord;
uniform vec2 direction;
uniform vec2 canvasSize;
uniform float radius;

float random(vec2 p) {
  vec3 p3  = fract(vec3(p.xyx) * .1031);
  p3 += dot(p3, p3.yzx + 33.33);
  return fract((p3.x + p3.y) * p3.z);
}

// This isn't a real Gaussian weight, it's a quadratic weight. It's what the
// CPU mode's blur uses though, so we also use it here to match.
float quadWeight(float x, float e) {
  return pow(e-abs(x), 2.);
}

void main(){
  vec2 uv = vTexCoord;

  // A reasonable maximum number of samples
  const float maxSamples = 64.0;

  float numSamples = floor(7. * radius);
  if (fract(numSamples / 2.) == 0.) {
    numSamples++;
  }
  vec4 avg = vec4(0.0);
  float total = 0.0;

  // Calculate the spacing to avoid skewing if numSamples > maxSamples
  float spacing = 1.0;
  if (numSamples > maxSamples) {
    spacing = numSamples / maxSamples;
    numSamples = maxSamples;
  }

  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));
  for (float i = 0.0; i < maxSamples; i++) {
    if (i >= numSamples) break;

    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;
    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;
    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);

    avg += weight * texture2D(tex0, sampleCoord);
    total += weight;
  }

  avg /= total;
  gl_FragColor = avg;
}
`,O8=`// Limit color space for a stylized cartoon / poster effect

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

vec3 quantize(vec3 color, float n) {
  // restrict values to N options/bins
  // and floor each channel to nearest value
  //
  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0
  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)

  color = color * n;
  color = floor(color);
  color = color / (n - 1.0);
  return color;
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);

  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);

  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);
}
`,M8=`// Set alpha channel to entirely opaque

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  gl_FragColor = vec4(color.rgb / color.a, 1.0);
}
`,L8=`// Set each pixel to inverse value
// Note that original INVERT does not change the opacity, so this follows suit

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;

void main() {
vec4 color = texture2D(tex0, vTexCoord);
vec3 origColor = color.rgb / color.a;
vec3 invertedColor = vec3(1.0) - origColor;
gl_FragColor = vec4(invertedColor * color.a, color.a);
}
`,B8=`// Convert pixels to either white or black, 
// depending on if their luma is above or below filterParameter

precision highp float;

varying vec2 vTexCoord;

uniform sampler2D tex0;
uniform float filterParameter;

float luma(vec3 color) {
  // weighted grayscale with luminance values
  return dot(color, vec3(0.2126, 0.7152, 0.0722));
}

void main() {
  vec4 color = texture2D(tex0, vTexCoord);
  float gray = luma(color.rgb / color.a);
  // floor() used to match src/image/filters.js
  float threshold = floor(filterParameter * 255.0) / 255.0;
  float blackOrWhite = step(threshold, gray);
  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);
}
`,P8=`uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;

attribute vec3 aPosition;
// texcoords only come from p5 to vertex shader
// so pass texcoords on to the fragment shader in a varying variable
attribute vec2 aTexCoord;
varying vec2 vTexCoord;

void main() {
  // transferring texcoords for the frag shader
  vTexCoord = aTexCoord;

  // copy position with a fourth coordinate for projection (1.0 is normal)
  vec4 positionVec4 = vec4(aPosition, 1.0);

  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
}
`;const V8={},z8={};let Ox="";const wT=function(r,t){Ox+=`#define STROKE_CAP_${r} ${t}
`,V8[qc[r]]=t},ST=function(r,t){Ox+=`#define STROKE_JOIN_${r} ${t}
`,z8[qc[r]]=t};wT("ROUND",0);wT("PROJECT",1);wT("SQUARE",2);ST("ROUND",0);ST("MITER",1);ST("BEVEL",2);const Cr={normalVert:XQ,normalFrag:YQ,basicFrag:ZQ,sphereMappingFrag:QQ,lightVert:lF+JQ,lightTextureFrag:eJ,phongVert:tJ,phongFrag:lF+nJ,fontVert:rJ,fontFrag:sJ,lineVert:Ox+iJ,lineFrag:Ox+aJ,pointVert:oJ,pointFrag:uJ,imageLightVert:lJ,imageLightDiffusedFrag:cJ,imageLightSpecularFrag:hJ,filterBaseVert:k8,filterBaseFrag:A8};let fJ=Cr.sphereMappingFrag;for(const r in Cr)Cr[r]=Q_+Cr[r];const dJ={[QD]:I8,[nT]:$8,[tT]:F8,[id]:R8,[ev]:O8,[JD]:M8,[eT]:L8,[Jb]:B8};class Ht extends Pt{constructor(t,n,s,i,a,o){super(t,n,s,i),this.canvas=this.elt=a||document.createElement("canvas"),this._setAttributeDefaults(t),this._initContext(),this.GL=this.drawingContext,this._isMainCanvas?(this._pInst._curElement=this,this._pInst.canvas=this.canvas):this.canvas.style.display="none",this.elt.id="defaultCanvas0",this.elt.classList.add("p5Canvas"),this.wrappedElt=new vn(this.elt,this._pInst);for(const l of Object.getOwnPropertyNames(vn.prototype))l!=="constructor"&&l[0]!=="_"&&Object.defineProperty(this,l,{get(){return this.wrappedElt[l]}});const u=this._adjustDimensions(n,s);if(n=u.adjustedWidth,s=u.adjustedHeight,this.width=n,this.height=s,this.elt.width=n*this._pixelDensity,this.elt.height=s*this._pixelDensity,this.elt.style.width=`${n}px`,this.elt.style.height=`${s}px`,this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this._pInst._userNode)this._pInst._userNode.appendChild(this.elt);else{if(document.getElementsByTagName("main").length===0){let l=document.createElement("main");document.body.appendChild(l)}document.getElementsByTagName("main")[0].appendChild(this.elt)}this.isP3D=!0,this.geometryBuilder=void 0,this.states.uModelMatrix=new zr(4),this.states.uViewMatrix=new zr(4),this.states.uPMatrix=new zr(4),this.states.curCamera=new Qc(this),this.states.uPMatrix.set(this.states.curCamera.projMatrix),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this.states.enableLighting=!1,this.states.ambientLightColors=[],this.states.specularColors=[1,1,1],this.states.directionalLightDirections=[],this.states.directionalLightDiffuseColors=[],this.states.directionalLightSpecularColors=[],this.states.pointLightPositions=[],this.states.pointLightDiffuseColors=[],this.states.pointLightSpecularColors=[],this.states.spotLightPositions=[],this.states.spotLightDirections=[],this.states.spotLightDiffuseColors=[],this.states.spotLightSpecularColors=[],this.states.spotLightAngle=[],this.states.spotLightConc=[],this.states.activeImageLight=null,this.states.curFillColor=[1,1,1,1],this.states.curAmbientColor=[1,1,1,1],this.states.curSpecularColor=[0,0,0,0],this.states.curEmissiveColor=[0,0,0,0],this.states.curStrokeColor=[0,0,0,1],this.states.curBlendMode=ci,this.states._hasSetAmbient=!1,this.states._useSpecularMaterial=!1,this.states._useEmissiveMaterial=!1,this.states._useNormalMaterial=!1,this.states._useShininess=1,this.states._useMetalness=0,this.states.tint=[255,255,255,255],this.states.constantAttenuation=1,this.states.linearAttenuation=0,this.states.quadraticAttenuation=0,this.states._currentNormal=new Ee(0,0,1),this.states.drawMode=Dx,this.states._tex=null,this.states.textureMode=tv,this.states.textureWrapX=P_,this.states.textureWrapY=P_,this._isErasing=!1,this._simpleLines=!1,this._clipDepths=[],this._isClipApplied=!1,this._stencilTestOn=!1,this.mixedAmbientLight=[],this.mixedSpecularColor=[],this.diffusedTextures=new Map,this.specularTextures=new Map,this.preEraseBlend=void 0,this._cachedBlendMode=void 0,this._cachedFillStyle=[1,1,1,1],this._cachedStrokeStyle=[0,0,0,1],this.webglVersion===Qr?this.blendExt=this.GL:this.blendExt=this.GL.getExtension("EXT_blend_minmax"),this._isBlending=!1,this._useLineColor=!1,this._useVertexColor=!1,this.registerEnabled=new Set,this.states.curCamera._computeCameraDefaultSettings(),this.states.curCamera._setDefaultCamera(),this.filterCamera=new Qc(this),this.filterCamera._computeCameraDefaultSettings(),this.filterCamera._setDefaultCamera(),this.prevTouches=[],this.zoomVelocity=0,this.rotateVelocity=new Ee(0,0),this.moveVelocity=new Ee(0,0),this.executeZoom=!1,this.executeRotateAndMove=!1,this._drawingFilter=!1,this._drawingImage=!1,this.specularShader=void 0,this.sphereMapping=void 0,this.diffusedShader=void 0,this._baseFilterShader=void 0,this._defaultLightShader=void 0,this._defaultImmediateModeShader=void 0,this._defaultNormalShader=void 0,this._defaultColorShader=void 0,this._defaultPointShader=void 0,this.states.userFillShader=void 0,this.states.userStrokeShader=void 0,this.states.userPointShader=void 0,this.states.userImageShader=void 0,this.states.curveDetail=1/4,this.shapeBuilder=new qQ(this),this.buffers={fill:[new ii(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new ii(3,"vertexNormals","normalBuffer","aNormal",this,this._vToNArray),new ii(4,"vertexColors","colorBuffer","aVertexColor",this),new ii(3,"vertexAmbients","ambientBuffer","aAmbientColor",this),new ii(2,"uvs","uvBuffer","aTexCoord",this,l=>l.flat())],stroke:[new ii(4,"lineVertexColors","lineColorBuffer","aVertexColor",this),new ii(3,"lineVertices","lineVerticesBuffer","aPosition",this),new ii(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",this),new ii(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",this),new ii(1,"lineSides","lineSidesBuffer","aSide",this)],text:[new ii(3,"vertices","vertexBuffer","aPosition",this,this._vToNArray),new ii(2,"uvs","uvBuffer","aTexCoord",this,l=>l.flat())],point:this.GL.createBuffer(),user:[]},this.geometryBufferCache=new KQ(this),this.curStrokeCap=vl,this.curStrokeJoin=vl,this.textures=new Map,this.framebuffers=new Set,this.activeFramebuffers=[],this.states.filterShader=void 0,this.filterLayer=void 0,this.filterLayerTemp=void 0,this.defaultFilterShaders={},this.fontInfos={},this._curShader=void 0,this.drawShapeCount=1,this.scratchMat3=new zr(3),this._userEnabledStencil=!1,this._internalEnable=this.drawingContext.enable,this._internalDisable=this.drawingContext.disable,this.drawingContext.enable=l=>(l===this.drawingContext.STENCIL_TEST&&(this._clipping||(this._userEnabledStencil=!0)),this._internalEnable.call(this.drawingContext,l)),this.drawingContext.disable=l=>(l===this.drawingContext.STENCIL_TEST&&(this._userEnabledStencil=!1),this._internalDisable.call(this.drawingContext,l))}remove(){this.wrappedElt.remove(),this.wrappedElt=null,this.canvas=null,this.elt=null}beginGeometry(){if(this.geometryBuilder)throw new Error("It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.");this.geometryBuilder=new Zm(this),this.geometryBuilder.prevFillColor=this.states.fillColor,this.fill(new pr([-1,-1,-1,-1]))}endGeometry(){if(!this.geometryBuilder)throw new Error("Make sure you call beginGeometry() before endGeometry()!");const t=this.geometryBuilder.finish();return this.fill(this.geometryBuilder.prevFillColor),this.geometryBuilder=void 0,t}buildGeometry(t){return this.beginGeometry(),t(),this.endGeometry()}beginShape(...t){super.beginShape(...t)}curveDetail(t){if(t===void 0)return this.states.curveDetail;this.states.setValue("curveDetail",t)}drawShape(t){const n=new o8({curveDetail:this.states.curveDetail});t.accept(n),this.shapeBuilder.constructFromContours(t,n.contours),this.geometryBuilder?this.geometryBuilder.addImmediate(this.shapeBuilder.geometry,this.shapeBuilder.shapeMode):(this.states.fillColor||this.states.strokeColor)&&(this.shapeBuilder.shapeMode===_x?this._drawPoints(this.shapeBuilder.geometry.vertices,this.buffers.point):this._drawGeometry(this.shapeBuilder.geometry,{mode:this.shapeBuilder.shapeMode,count:this.drawShapeCount})),this.drawShapeCount=1}endShape(t,n){this.drawShapeCount=n,super.endShape(t,n)}vertexProperty(...t){this.currentShape.vertexProperty(...t)}normal(t,n,s){t instanceof Ee?this.states.setValue("_currentNormal",t):this.states.setValue("_currentNormal",new Ee(t,n,s)),this.updateShapeVertexProperties()}model(t,n=1){t.vertices.length>0&&(this.geometryBuilder?this.geometryBuilder.addRetained(t):(this.geometryInHash(t.gid)||(t._edgesToVertices(),this._getOrMakeCachedBuffers(t)),this._drawGeometry(t,{count:n})))}_drawGeometry(t,{mode:n=zf,count:s=1}={}){for(const i in t.userVertexProperties){const a=t.userVertexProperties[i];this.buffers.user.push(new ii(a.getDataSize(),a.getSrcName(),a.getDstName(),a.getName(),this))}this.states.fillColor&&t.vertices.length>=3&&![sd,_x].includes(n)&&this._drawFills(t,{mode:n,count:s}),this.states.strokeColor&&t.lineVertices.length>=1&&this._drawStrokes(t,{count:s}),this.buffers.user=[]}_drawGeometryScaled(t,n,s,i){let a=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone());try{this.states.uModelMatrix.scale(n,s,i),this.geometryBuilder?this.geometryBuilder.addRetained(t):this._drawGeometry(t)}finally{this.states.setValue("uModelMatrix",a)}}_drawFills(t,{count:n,mode:s}={}){this._useVertexColor=t.vertexColors.length>0;const i=!this._drawingFilter&&this.states.userFillShader?this.states.userFillShader:this._getFillShader();i.bindShader(),this._setGlobalUniforms(i),this._setFillUniforms(i),i.bindTextures();for(const a of this.buffers.fill)a._prepareBuffer(t,i);this._prepareUserAttributes(t,i),i.disableRemainingAttributes(),this._applyColorBlend(this.states.curFillColor,t.hasFillTransparency()),this._drawBuffers(t,{mode:s,count:n}),i.unbindShader()}_drawStrokes(t,{count:n}={}){const s=this.GL;this._useLineColor=t.vertexStrokeColors.length>0;const i=this._getStrokeShader();i.bindShader(),this._setGlobalUniforms(i),this._setStrokeUniforms(i),i.bindTextures();for(const a of this.buffers.stroke)a._prepareBuffer(t,i);if(this._prepareUserAttributes(t,i),i.disableRemainingAttributes(),this._applyColorBlend(this.states.curStrokeColor,t.hasStrokeTransparency()),n===1)s.drawArrays(s.TRIANGLES,0,t.lineVertices.length/3);else try{s.drawArraysInstanced(s.TRIANGLES,0,t.lineVertices.length/3,n)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}i.unbindShader()}_drawPoints(t,n){const s=this.GL,i=this._getPointShader();i.bindShader(),this._setGlobalUniforms(i),this._setPointUniforms(i),i.bindTextures(),this._bindBuffer(n,s.ARRAY_BUFFER,this._vToNArray(t),Float32Array,s.STATIC_DRAW),i.enableAttrib(i.attributes.aPosition,3),this._applyColorBlend(this.states.curStrokeColor),s.drawArrays(s.Points,0,t.length),i.unbindShader()}_prepareUserAttributes(t,n){for(const s of this.buffers.user){if(!this._pInst.constructor.disableFriendleErrors){const i=t.userVertexProperties[s.attr];if(i){const a=i.getSrcArray().length/i.getDataSize();a>t.vertices.length?this._pInst.constructor._friendlyError(`One of the geometries has a custom vertex property '${i.getName()}' with more values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,"vertexProperty()"):a<t.vertices.length&&this._pInst.constructor._friendlyError(`One of the geometries has a custom vertex property '${i.getName()}' with fewer values than vertices. This is probably caused by directly using the Geometry.vertexProperty() method.`,"vertexProperty()")}}s._prepareBuffer(t,n)}}_drawBuffers(t,{mode:n=this.GL.TRIANGLES,count:s}){const i=this.GL,a=this.geometryBufferCache.getCached(t);if(a)if(a.indexBuffer){if(this._bindBuffer(a.indexBuffer,i.ELEMENT_ARRAY_BUFFER),this._pInst.webglVersion!==Qr&&a.indexBufferType===i.UNSIGNED_INT&&!i.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");if(s===1)i.drawElements(i.TRIANGLES,t.faces.length*3,a.indexBufferType,0);else try{i.drawElementsInstanced(i.TRIANGLES,t.faces.length*3,a.indexBufferType,0,s)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}}else if(s===1)i.drawArrays(n,0,t.vertices.length);else try{i.drawArraysInstanced(n,0,t.vertices.length,s)}catch{console.log(" p5.js says: Instancing is only supported in WebGL2 mode")}}_getOrMakeCachedBuffers(t){return this.geometryBufferCache.ensureCached(t)}_setAttributeDefaults(t){const s={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0,version:2};t._glAttributes===null?t._glAttributes=s:t._glAttributes=Object.assign(s,t._glAttributes)}_initContext(){var t;if(((t=this._pInst._glAttributes)==null?void 0:t.version)!==1&&(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)),this.webglVersion=this.drawingContext?Qr:Nl,this._pInst.webglVersion=this.webglVersion,this.drawingContext||(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)),this.drawingContext===null)throw new Error("Error creating webgl context");{const n=this.drawingContext;n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}}_getMaxTextureSize(){const t=this.drawingContext;return t.getParameter(t.MAX_TEXTURE_SIZE)}_adjustDimensions(t,n){this._maxTextureSize||(this._maxTextureSize=this._getMaxTextureSize());let s=this._maxTextureSize,i=Math.floor(s/this._pixelDensity),a=Math.min(t,i),o=Math.min(n,i);return(a!==t||o!==n)&&console.warn(`Warning: The requested width/height exceeds hardware limits. Adjusting dimensions to width: ${a}, height: ${o}.`),{adjustedWidth:a,adjustedHeight:o}}_resetContext(t,n){const s=this.width,i=this.height,a=this.canvas.id,o=this._pInst instanceof ud,u={position:this.canvas.style.position,top:this.canvas.style.top,left:this.canvas.style.left};if(o){const c=this._pInst;c.canvas.parentNode.removeChild(c.canvas),c.canvas=document.createElement("canvas"),(c._pInst._userNode||document.body).appendChild(c.canvas),vn.call(c,c.canvas,c._pInst),c.width=s,c.height=i}else{let c=this.canvas;c&&c.parentNode.removeChild(c),c=document.createElement("canvas"),c.id=a,this._pInst._userNode?this._pInst._userNode.appendChild(c):document.body.appendChild(c),this._pInst.canvas=c,this.canvas=c,this.canvas.style.position=u.position,this.canvas.style.top=u.top,this.canvas.style.left=u.left}const l=new Ht(this._pInst,s,i,!o,this._pInst.canvas);this._pInst._renderer=l,l._applyDefaults(),typeof n=="function"&&setTimeout(()=>{n.apply(window._renderer,t)},0)}_update(){this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.reset(),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this.states.setValue("ambientLightColors",[]),this.states.setValue("specularColors",[1,1,1]),this.states.setValue("directionalLightDirections",[]),this.states.setValue("directionalLightDiffuseColors",[]),this.states.setValue("directionalLightSpecularColors",[]),this.states.setValue("pointLightPositions",[]),this.states.setValue("pointLightDiffuseColors",[]),this.states.setValue("pointLightSpecularColors",[]),this.states.setValue("spotLightPositions",[]),this.states.setValue("spotLightDirections",[]),this.states.setValue("spotLightDiffuseColors",[]),this.states.setValue("spotLightSpecularColors",[]),this.states.setValue("spotLightAngle",[]),this.states.setValue("spotLightConc",[]),this.states.setValue("enableLighting",!1),this.states.setValue("tint",[255,255,255,255]),this.GL.clearStencil(0),this.GL.clear(this.GL.DEPTH_BUFFER_BIT|this.GL.STENCIL_BUFFER_BIT),this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST)}background(...t){const n=this._pInst.color(...t);this.clear(...n._getRGBA())}get uModelMatrix(){return this.states.uModelMatrix}get uViewMatrix(){return this.states.uViewMatrix}get uPMatrix(){return this.states.uPMatrix}get uMVMatrix(){const t=this.uModelMatrix.copy();return t.mult(this.uViewMatrix),t}getWorldToScreenMatrix(){const t=this.states.uModelMatrix,n=this.states.uViewMatrix,s=this.states.uPMatrix,i=new zr(4);return i.scale(this.width,this.height,1),i.translate([.5,.5,.5]),i.scale(.5,-.5,.5),t.copy().mult(n).mult(s).mult(i)}fill(...t){super.fill(...t);const n=this.states.fillColor;this.states.setValue("curFillColor",n._array),this.states.setValue("drawMode",Dx),this.states.setValue("_useNormalMaterial",!1),this.states.setValue("_tex",null)}stroke(...t){super.stroke(...t),this.states.setValue("curStrokeColor",this.states.strokeColor._array)}getCommonVertexProperties(){return{...super.getCommonVertexProperties(),stroke:this.states.strokeColor,fill:this.states.fillColor,normal:this.states._currentNormal}}getSupportedIndividualVertexProperties(){return{textureCoordinates:!0}}strokeCap(t){this.curStrokeCap=t}strokeJoin(t){this.curStrokeJoin=t}getFilterLayer(){return this.filterLayer||(this.filterLayer=new Ha(this)),this.filterLayer}getFilterLayerTemp(){return this.filterLayerTemp||(this.filterLayerTemp=new Ha(this)),this.filterLayerTemp}matchSize(t,n){(t.width!==n.width||t.height!==n.height)&&t.resize(n.width,n.height),t.pixelDensity()!==n.pixelDensity()&&t.pixelDensity(n.pixelDensity())}filter(...t){let n=this.getFilterLayer(),s,i;typeof t[0]=="string"?(i=t[0],s=i in Rx&&t[1]===void 0?Rx[i]:t[1],i in this.defaultFilterShaders||(this.defaultFilterShaders[i]=new Ns(n.renderer,P8,dJ[i])),this.states.setValue("filterShader",this.defaultFilterShaders[i])):this.states.setValue("filterShader",t[0]);const a=this.activeFramebuffer()||this;this.matchSize(n,a),n.draw(()=>this.clear());let o=[1/(a.width*a.pixelDensity()),1/(a.height*a.pixelDensity())];if(i===id){const u=this.getFilterLayerTemp();this.matchSize(u,a),this.push(),this.states.setValue("strokeColor",null),this.blendMode(ci),this.shader(this.states.filterShader),this.states.filterShader.setUniform("texelSize",o),this.states.filterShader.setUniform("canvasSize",[a.width,a.height]),this.states.filterShader.setUniform("radius",Math.max(1,s)),u.draw(()=>{this.states.filterShader.setUniform("direction",[1,0]),this.states.filterShader.setUniform("tex0",a),this.clear(),this.shader(this.states.filterShader),this.noLights(),this.plane(a.width,a.height)}),n.draw(()=>{this.states.filterShader.setUniform("direction",[0,1]),this.states.filterShader.setUniform("tex0",u),this.clear(),this.shader(this.states.filterShader),this.noLights(),this.plane(a.width,a.height)}),this.pop()}else n.draw(()=>{this.states.setValue("strokeColor",null),this.blendMode(ci),this.shader(this.states.filterShader),this.states.filterShader.setUniform("tex0",a),this.states.filterShader.setUniform("texelSize",o),this.states.filterShader.setUniform("canvasSize",[a.width,a.height]),this.states.filterShader.setUniform("filterParameter",s),this.noLights(),this.plane(a.width,a.height)});this.push(),this.states.setValue("strokeColor",null),this.clear(),this.push(),this.states.setValue("imageMode",Yi),this.blendMode(ci),a.filterCamera._resize(),this.setCamera(a.filterCamera),this.resetMatrix(),this._drawingFilter=!0,this.image(n,0,0,this.width,this.height,-a.width/2,-a.height/2,a.width,a.height),this._drawingFilter=!1,this.clearDepth(),this.pop(),this.pop()}pixelDensity(t){return t?this._pInst.pixelDensity(t):this._pInst.pixelDensity()}blendMode(t){t===Hb||t===qb||t===Wm||t===ci||t===Kb||t===Zb||t===Xb||t===Qb||t===Yb||t===Hc?this.states.setValue("curBlendMode",t):(t===ZD||t===qD||t===KD||t===XD||t===YD)&&console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}erase(t,n){this._isErasing||(this.preEraseBlend=this.states.curBlendMode,this._isErasing=!0,this.blendMode(Hc),this._cachedFillStyle=this.states.curFillColor.slice(),this.states.setValue("curFillColor",[1,1,1,t/255]),this._cachedStrokeStyle=this.states.curStrokeColor.slice(),this.states.setValue("curStrokeColor",[1,1,1,n/255]))}noErase(){this._isErasing&&(this.states.setValue("curFillColor",this._cachedFillStyle.slice()),this.states.setValue("curStrokeColor",this._cachedStrokeStyle.slice()),this.states.setValue("curBlendMode",this.preEraseBlend),this.blendMode(this.preEraseBlend),this._isErasing=!1,this._applyBlendMode())}drawTarget(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||this}beginClip(t={}){super.beginClip(t),this.drawTarget()._isClipApplied=!0;const n=this.GL;n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),this._internalEnable.call(n,n.STENCIL_TEST),this._stencilTestOn=!0,n.stencilFunc(n.ALWAYS,1,255),n.stencilOp(n.KEEP,n.KEEP,n.REPLACE),n.disable(n.DEPTH_TEST),this.push(),this.resetShader(),this.states.fillColor&&this.fill(0,0),this.states.strokeColor&&this.stroke(0,0)}endClip(){this.pop();const t=this.GL;t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.stencilFunc(this._clipInvert?t.EQUAL:t.NOTEQUAL,0,255),t.enable(t.DEPTH_TEST),this._clipDepths.push(this._pushPopDepth),super.endClip()}_clearClip(){this.GL.clearStencil(1),this.GL.clear(this.GL.STENCIL_BUFFER_BIT),this._clipDepths.length>0&&this._clipDepths.pop(),this.drawTarget()._isClipApplied=!1}_getPixel(t,n){const s=this.GL;return G8(s,null,t,n,s.RGBA,s.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}loadPixels(){if(this._pInst._glAttributes.preserveDrawingBuffer!==!0){console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true.");return}const t=this._pixelDensity,n=this.GL;this.pixels=J_(this.pixels,n,null,0,0,this.width*t,this.height*t,n.RGBA,n.UNSIGNED_BYTE,this.height*t)}updatePixels(){const t=this._getTempFramebuffer();t.pixels=this.pixels,t.updatePixels(),this.push(),this.resetMatrix(),this.clear(),this.states.setValue("imageMode",Yi),this.image(t,0,0,t.width,t.height,-t.width/2,-t.height/2,t.width,t.height),this.pop(),this.GL.clearDepth(1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}_getTempFramebuffer(){return this._tempFramebuffer||(this._tempFramebuffer=new Ha(this,{format:ul,useDepth:this._pInst._glAttributes.depth,depthFormat:km,antialias:this._pInst._glAttributes.antialias})),this._tempFramebuffer}geometryInHash(t){return this.geometryBufferCache.isCached(t)}viewport(t,n){this._viewport=[0,0,t,n],this.GL.viewport(0,0,t,n)}resize(t,n){super.resize(t,n);const s={};for(const a in this.drawingContext){const o=this.drawingContext[a];typeof o!="object"&&typeof o!="function"&&(s[a]=o)}const i=this._adjustDimensions(t,n);t=i.adjustedWidth,n=i.adjustedHeight,this.width=t,this.height=n,this.canvas.width=t*this._pixelDensity,this.canvas.height=n*this._pixelDensity,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${n}px`,this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight},this.viewport(this._origViewport.width,this._origViewport.height),this.states.curCamera._resize(),typeof this.pixels<"u"&&(this.pixels=new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4));for(const a of this.framebuffers)a._canvasSizeChanged();for(const a in s)try{this.drawingContext[a]=s[a]}catch{}}clear(...t){const n=t[0]||0,s=t[1]||0,i=t[2]||0;let a=t[3]||0;const o=this.activeFramebuffer();o&&o.format===ul&&!o.antialias&&a===0&&(a=1e-10),this.GL.clearColor(n*a,s*a,i*a,a),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}clearDepth(t=1){this.GL.clearDepth(t),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}applyMatrix(t,n,s,i,a,o){this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),arguments.length===16?zr.prototype.apply.apply(this.states.uModelMatrix,arguments):this.states.uModelMatrix.apply([t,n,0,0,s,i,0,0,0,0,1,0,a,o,0,1])}translate(t,n,s){return t instanceof Ee&&(s=t.z,n=t.y,t=t.x),this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.translate([t,n,s]),this}scale(t,n,s){return this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.scale(t,n,s),this}rotate(t,n){return typeof n>"u"?this.rotateZ(t):(this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),zr.prototype.rotate4x4.apply(this.states.uModelMatrix,arguments),this)}rotateX(t){return this.rotate(t,1,0,0),this}rotateY(t){return this.rotate(t,0,1,0),this}rotateZ(t){return this.rotate(t,0,0,1),this}pop(...t){this._clipDepths.length>0&&this._pushPopDepth===this._clipDepths[this._clipDepths.length-1]&&(this._clearClip(),this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST)),super.pop(...t),this._applyStencilTestIfClipping()}_applyStencilTestIfClipping(){const t=this.drawTarget();t._isClipApplied!==this._stencilTestOn&&(t._isClipApplied?(this._internalEnable.call(this.GL,this.GL.STENCIL_TEST),this._stencilTestOn=!0):(this._userEnabledStencil||this._internalDisable.call(this.GL,this.GL.STENCIL_TEST),this._stencilTestOn=!1))}resetMatrix(){return this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone()),this.states.uModelMatrix.reset(),this.states.setValue("uViewMatrix",this.states.uViewMatrix.clone()),this.states.uViewMatrix.set(this.states.curCamera.cameraMatrix),this}_getStrokeShader(){const t=this.states.userStrokeShader;return t||this._getLineShader()}_getSphereMapping(t){return this.sphereMapping||(this.sphereMapping=this._pInst.createFilterShader(fJ)),this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),this.scratchMat3.invert(this.scratchMat3),this.sphereMapping.setUniform("uFovY",this.states.curCamera.cameraFOV),this.sphereMapping.setUniform("uAspect",this.states.curCamera.aspectRatio),this.sphereMapping.setUniform("uNewNormalMatrix",this.scratchMat3.mat3),this.sphereMapping.setUniform("uEnvMap",t),this.sphereMapping}_getFillShader(){return this._drawingImage?this.states.userImageShader&&!this._drawingFilter?this.states.userImageShader:this._getLightShader():this.states.userFillShader?this.states.userFillShader:this.states._useNormalMaterial?this._getNormalShader():this.states.enableLighting||this.states._tex?this._getLightShader():this._getColorShader()}_getPointShader(){const t=this.states.userPointShader;return!t||!t.isPointShader()?this._getPointShader():t}baseMaterialShader(){if(!this._pInst._glAttributes.perPixelLighting)throw new Error("The material shader does not support hooks without perPixelLighting. Try turning it back on.");return this._getLightShader()}_getLightShader(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","highp")+Cr.phongVert,this._webGL2CompatibilityPrefix("frag","highp")+Cr.phongFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","Inputs getPixelInputs":"(Inputs inputs) { return inputs; }","vec4 combineColors":`(ColorComponents components) {
                vec4 color = vec4(0.);
                color.rgb += components.diffuse * components.baseColor;
                color.rgb += components.ambient * components.ambientColor;
                color.rgb += components.specular * components.specularColor;
                color.rgb += components.emissive;
                color.a = components.opacity;
                return color;
              }`,"vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}}):this._defaultLightShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","highp")+Cr.lightVert,this._webGL2CompatibilityPrefix("frag","highp")+Cr.lightTextureFrag)),this._defaultLightShader}baseNormalShader(){return this._getNormalShader()}_getNormalShader(){return this._defaultNormalShader||(this._defaultNormalShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","mediump")+Cr.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+Cr.normalFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}})),this._defaultNormalShader}baseColorShader(){return this._getColorShader()}_getColorShader(){return this._defaultColorShader||(this._defaultColorShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","mediump")+Cr.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+Cr.basicFrag,{vertex:{"void beforeVertex":"() {}","Vertex getObjectInputs":"(Vertex inputs) { return inputs; }","Vertex getWorldInputs":"(Vertex inputs) { return inputs; }","Vertex getCameraInputs":"(Vertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","void afterFragment":"() {}"}})),this._defaultColorShader}pointShader(){return this._getPointShader()}_getPointShader(){return this._defaultPointShader||(this._defaultPointShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","mediump")+Cr.pointVert,this._webGL2CompatibilityPrefix("frag","mediump")+Cr.pointFrag,{vertex:{"void beforeVertex":"() {}","vec3 getLocalPosition":"(vec3 position) { return position; }","vec3 getWorldPosition":"(vec3 position) { return position; }","float getPointSize":"(float size) { return size; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","vec4 getFinalColor":"(vec4 color) { return color; }","bool shouldDiscard":"(bool outside) { return outside; }","void afterFragment":"() {}"}})),this._defaultPointShader}baseStrokeShader(){return this._getLineShader()}_getLineShader(){return this._defaultLineShader||(this._defaultLineShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","mediump")+Cr.lineVert,this._webGL2CompatibilityPrefix("frag","mediump")+Cr.lineFrag,{vertex:{"void beforeVertex":"() {}","StrokeVertex getObjectInputs":"(StrokeVertex inputs) { return inputs; }","StrokeVertex getWorldInputs":"(StrokeVertex inputs) { return inputs; }","StrokeVertex getCameraInputs":"(StrokeVertex inputs) { return inputs; }","void afterVertex":"() {}"},fragment:{"void beforeFragment":"() {}","Inputs getPixelInputs":"(Inputs inputs) { return inputs; }","vec4 getFinalColor":"(vec4 color) { return color; }","bool shouldDiscard":"(bool outside) { return outside; }","void afterFragment":"() {}"}})),this._defaultLineShader}_getFontShader(){return this._defaultFontShader||(this.webglVersion===Nl&&this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","highp")+Cr.fontVert,this._webGL2CompatibilityPrefix("frag","highp")+Cr.fontFrag)),this._defaultFontShader}baseFilterShader(){return this._baseFilterShader||(this._baseFilterShader=new Ns(this,this._webGL2CompatibilityPrefix("vert","highp")+Cr.filterBaseVert,this._webGL2CompatibilityPrefix("frag","highp")+Cr.filterBaseFrag,{vertex:{},fragment:{"vec4 getColor":`(FilterInputs inputs, in sampler2D canvasContent) {
                return getTexture(canvasContent, inputs.texCoord);
              }`}})),this._baseFilterShader}_webGL2CompatibilityPrefix(t,n){let s="";return this.webglVersion===Qr&&(s+=`#version 300 es
#define WEBGL2
`),t==="vert"?s+=`#define VERTEX_SHADER
`:t==="frag"&&(s+=`#define FRAGMENT_SHADER
`),n&&(s+=`precision ${n} float;
`),s}_getEmptyTexture(){if(!this._emptyTexture){const t=new kl(1,1);t.set(0,0,255),this._emptyTexture=new bu(this,t)}return this._emptyTexture}getTexture(t){let n=t;n instanceof Ha&&(n=n.color);const s=this.textures.get(n);if(s)return s;const i=new bu(this,n);return this.textures.set(n,i),i}getDiffusedTexture(t){if(this.diffusedTextures.get(t)!=null)return this.diffusedTextures.get(t);let n,s=200,i=s,a=Math.floor(s*(t.height/t.width));return n=new Ha(this,{width:i,height:a,density:1}),this.diffusedShader||(this.diffusedShader=this._pInst.createShader(Cr.imageLightVert,Cr.imageLightDiffusedFrag)),n.draw(()=>{this.shader(this.diffusedShader),this.diffusedShader.setUniform("environmentMap",t),this.states.setValue("strokeColor",null),this.noLights(),this.plane(i,a)}),this.diffusedTextures.set(t,n),n}getSpecularTexture(t){if(this.specularTextures.get(t)!=null)return this.specularTextures.get(t);const n=512;let s;const i=[],a=new Ha(this,{width:n,height:n,density:1});let o=Math.log(n)/Math.log(2);this.specularShader||(this.specularShader=this._pInst.createShader(Cr.imageLightVert,Cr.imageLightSpecularFrag));for(let u=n;u>=1;u/=2){a.resize(u,u);let c=1-Math.log(u)/Math.log(2)/o;a.draw(()=>{this.shader(this.specularShader),this.clear(),this.specularShader.setUniform("environmentMap",t),this.specularShader.setUniform("roughness",c),this.states.setValue("strokeColor",null),this.noLights(),this.plane(u,u)}),i.push(a.get().drawingContext.getImageData(0,0,u,u))}return a.remove(),s=new W8(this,i,{}),this.specularTextures.set(t,s),s}activeFramebuffer(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||null}createFramebuffer(t){return new Ha(this,t)}_setGlobalUniforms(t){const n=this.states.uModelMatrix,s=this.states.uViewMatrix,i=this.states.uPMatrix,a=n.copy().mult(s);if(t.setUniform("uPerspective",this.states.curCamera.useLinePerspective?1:0),t.setUniform("uViewMatrix",s.mat4),t.setUniform("uProjectionMatrix",i.mat4),t.setUniform("uModelMatrix",n.mat4),t.setUniform("uModelViewMatrix",a.mat4),t.uniforms.uModelViewProjectionMatrix){const o=a.copy();o.mult(i),t.setUniform("uModelViewProjectionMatrix",o.mat4)}t.uniforms.uNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(a),t.setUniform("uNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uModelNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(this.states.uModelMatrix),t.setUniform("uModelNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uCameraNormalMatrix&&(this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),t.setUniform("uCameraNormalMatrix",this.scratchMat3.mat3)),t.uniforms.uCameraRotation&&(this.scratchMat3.inverseTranspose4x4(this.states.uViewMatrix),t.setUniform("uCameraRotation",this.scratchMat3.mat3)),t.setUniform("uViewport",this._viewport)}_setStrokeUniforms(t){t.setUniform("uSimpleLines",this._simpleLines),t.setUniform("uUseLineColor",this._useLineColor),t.setUniform("uMaterialColor",this.states.curStrokeColor),t.setUniform("uStrokeWeight",this.states.strokeWeight),t.setUniform("uStrokeCap",V8[this.curStrokeCap]),t.setUniform("uStrokeJoin",z8[this.curStrokeJoin])}_setFillUniforms(t){this.mixedSpecularColor=[...this.states.curSpecularColor];const n=this._getEmptyTexture();this.states._useMetalness>0&&(this.mixedSpecularColor=this.mixedSpecularColor.map((u,l)=>this.states.curFillColor[l]*this.states._useMetalness+u*(1-this.states._useMetalness))),t.setUniform("uUseVertexColor",this._useVertexColor),t.setUniform("uMaterialColor",this.states.curFillColor),t.setUniform("isTexture",!!this.states._tex),t.setUniform("uSampler",this.states._tex||n),t.setUniform("uTint",this.states.tint),t.setUniform("uHasSetAmbient",this.states._hasSetAmbient),t.setUniform("uAmbientMatColor",this.states.curAmbientColor),t.setUniform("uSpecularMatColor",this.mixedSpecularColor),t.setUniform("uEmissiveMatColor",this.states.curEmissiveColor),t.setUniform("uSpecular",this.states._useSpecularMaterial),t.setUniform("uEmissive",this.states._useEmissiveMaterial),t.setUniform("uShininess",this.states._useShininess),t.setUniform("uMetallic",this.states._useMetalness),this._setImageLightUniforms(t),t.setUniform("uUseLighting",this.states.enableLighting);const s=this.states.pointLightDiffuseColors.length/3;t.setUniform("uPointLightCount",s),t.setUniform("uPointLightLocation",this.states.pointLightPositions),t.setUniform("uPointLightDiffuseColors",this.states.pointLightDiffuseColors),t.setUniform("uPointLightSpecularColors",this.states.pointLightSpecularColors);const i=this.states.directionalLightDiffuseColors.length/3;t.setUniform("uDirectionalLightCount",i),t.setUniform("uLightingDirection",this.states.directionalLightDirections),t.setUniform("uDirectionalDiffuseColors",this.states.directionalLightDiffuseColors),t.setUniform("uDirectionalSpecularColors",this.states.directionalLightSpecularColors);const a=this.states.ambientLightColors.length/3;this.mixedAmbientLight=[...this.states.ambientLightColors],this.states._useMetalness>0&&(this.mixedAmbientLight=this.mixedAmbientLight.map(u=>{let l=u-this.states._useMetalness;return Math.max(0,l)})),t.setUniform("uAmbientLightCount",a),t.setUniform("uAmbientColor",this.mixedAmbientLight);const o=this.states.spotLightDiffuseColors.length/3;t.setUniform("uSpotLightCount",o),t.setUniform("uSpotLightAngle",this.states.spotLightAngle),t.setUniform("uSpotLightConc",this.states.spotLightConc),t.setUniform("uSpotLightDiffuseColors",this.states.spotLightDiffuseColors),t.setUniform("uSpotLightSpecularColors",this.states.spotLightSpecularColors),t.setUniform("uSpotLightLocation",this.states.spotLightPositions),t.setUniform("uSpotLightDirection",this.states.spotLightDirections),t.setUniform("uConstantAttenuation",this.states.constantAttenuation),t.setUniform("uLinearAttenuation",this.states.linearAttenuation),t.setUniform("uQuadraticAttenuation",this.states.quadraticAttenuation)}_setImageLightUniforms(t){if(t.setUniform("uUseImageLight",this.states.activeImageLight!=null),this.states.activeImageLight){let n=this.getDiffusedTexture(this.states.activeImageLight);t.setUniform("environmentMapDiffused",n);let s=this.getSpecularTexture(this.states.activeImageLight);t.setUniform("environmentMapSpecular",s)}}_setPointUniforms(t){t.setUniform("uMaterialColor",this.states.curStrokeColor),t.setUniform("uPointSize",this.states.strokeWeight*this._pixelDensity)}_bindBuffer(t,n,s,i,a){if(n||(n=this.GL.ARRAY_BUFFER),this.GL.bindBuffer(n,t),s!==void 0){let o=s;s instanceof Tc?o=s.dataArray():o instanceof(i||Float32Array)||(o=new(i||Float32Array)(o)),this.GL.bufferData(n,o,a||this.GL.STATIC_DRAW)}}_arraysEqual(t,n){return t.length!==n.length?!1:t.every((i,a)=>i===n[a])}_isTypedArray(t){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some(n=>t instanceof n)}_vToNArray(t){return t.flatMap(n=>[n.x,n.y,n.z])}}function U8(r,t){r.RendererGL=Ht,t.setAttributes=function(n,s){if(typeof this._glAttributes>"u"){console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.");return}let i=!0;if(typeof s<"u"?(this._glAttributes===null&&(this._glAttributes={}),this._glAttributes[n]!==s&&(this._glAttributes[n]=s,i=!1)):n instanceof Object&&this._glAttributes!==n&&(this._glAttributes=n,i=!1),!(!this._renderer.isP3D||i)){if(!this._setupDone&&this._renderer.geometryBufferCache.numCached()>0){r._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()");return}this._renderer._resetContext(),this._renderer.states.curCamera&&(this._renderer.states.curCamera._renderer=this._renderer)}},t._assert3d=function(n){if(!this._renderer.isP3D)throw new Error(`${n}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`)},r.renderers[Nl]=r.RendererGL,r.renderers[Qr]=r.RendererGL}function J_(r,t,n,s,i,a,o,u,l,c){const h=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,n);const f=u===t.RGBA?4:3,p=a*o*f,g=l===t.UNSIGNED_BYTE?Uint8Array:Float32Array;if((!(r instanceof g)||r.length!==p)&&(r=new g(p)),t.readPixels(s,c?c-i-o:i,a,o,u,l,r),t.bindFramebuffer(t.FRAMEBUFFER,h),c){const y=Math.floor(o/2),x=new g(a*f);for(let v=0;v<y;v++){const S=v*a*4,w=(o-v-1)*a*4;x.set(r.subarray(S,S+a*4)),r.copyWithin(S,w,w+a*4),r.set(x,w)}}return r}function G8(r,t,n,s,i,a,o){const u=r.getParameter(r.FRAMEBUFFER_BINDING);r.bindFramebuffer(r.FRAMEBUFFER,t);const l=i===r.RGBA?4:3,c=a===r.UNSIGNED_BYTE?Uint8Array:Float32Array,h=new c(l);return r.readPixels(n,o?o-s-1:s,1,1,i,a,h),r.bindFramebuffer(r.FRAMEBUFFER,u),Array.from(h)}typeof p5<"u"&&U8(p5,p5.prototype);function CT(r,t){t.strokeMode=function(s){if(s===void 0)return this._renderer._simpleLines?F_:R_;if(s===F_)this._renderer._simpleLines=!0;else if(s===R_)this._renderer._simpleLines=!1;else throw Error("no such parameter")},t.buildGeometry=function(s){return this._renderer.buildGeometry(s)},t.freeGeometry=function(s){this._renderer.geometryBufferCache.freeBuffers(s.gid)},t.plane=function(s=50,i=s,a=1,o=1){return this._assert3d("plane"),this._renderer.plane(s,i,a,o),this},t.box=function(s,i,a,o,u){return this._assert3d("box"),this._renderer.box(s,i,a,o,u),this},t.sphere=function(s=50,i=24,a=16){return this._assert3d("sphere"),this._renderer.sphere(s,i,a),this},t.cylinder=function(s=50,i=s,a=24,o=1,u=!0,l=!0){return this._assert3d("cylinder"),this._renderer.cylinder(s,i,a,o,u,l),this},t.cone=function(s=50,i=s,a=24,o=1,u=!0){return this._assert3d("cone"),this._renderer.cone(s,i,a,o,u),this},t.ellipsoid=function(s=50,i=s,a=s,o=24,u=16){return this._assert3d("ellipsoid"),this._renderer.ellipsoid(s,i,a,o,u),this},t.torus=function(s,i,a,o){return this._assert3d("torus"),this._renderer.torus(s,i,a,o),this},Ht.prototype.point=function(s,i,a=0){const o=[];return o.push(new Ee(s,i,a)),this._drawPoints(o,this.buffers.point),this},Ht.prototype.triangle=function(s){const i=s[0],a=s[1],o=s[2],u=s[3],l=s[4],c=s[5],h="tri";if(!this.geometryInHash(h)){const p=function(){const y=[];y.push(new Ee(0,0,0)),y.push(new Ee(1,0,0)),y.push(new Ee(0,1,0)),this.edges=[[0,1],[1,2],[2,0]],this.vertices=y,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]},g=new Ts(1,1,p,this);g._edgesToVertices(),g.computeNormals(),g.gid=h,this.geometryBufferCache.ensureCached(g)}const f=this.states.uModelMatrix.copy();try{const p=Math.sign(i*u-o*a+o*c-l*u+l*a-i*c),g=new zr([o-i,u-a,0,0,l-i,c-a,0,0,0,0,p,0,i,a,0,1]).mult(this.states.uModelMatrix);this.states.setValue("uModelMatrix",g),this._drawGeometry(this.geometryBufferCache.getGeometryByID(h))}finally{this.states.setValue("uModelMatrix",f)}return this},Ht.prototype.ellipse=function(s){this.arc(s[0],s[1],s[2],s[3],0,ai,Wc,s[4])},Ht.prototype.arc=function(...s){const i=s[0],a=s[1],o=s[2],u=s[3],l=s[4],c=s[5],h=s[6],f=s[7]||25;let p,g;if(Math.abs(c-l)>=ai?(p="ellipse",g=`${p}|${f}|`):(p="arc",g=`${p}|${l}|${c}|${h}|${f}|`),!this.geometryInHash(g)){const x=function(){if(l.toFixed(10)!==c.toFixed(10)){(h===jm||typeof h>"u")&&(this.vertices.push(new Ee(.5,.5,0)),this.uvs.push([.5,.5]));for(let S=0;S<=f;S++){const w=S/f,E=(c-l)*w+l,_=.5+Math.cos(E)/2,D=.5+Math.sin(E)/2;this.vertices.push(new Ee(_,D,0)),this.uvs.push([_,D]),S<f-1&&(this.faces.push([0,S+1,S+2]),this.edges.push([S+1,S+2]))}switch(h){case jm:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,1]),this.edges.push([this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,this.vertices.length-1]);break;case Ex:this.edges.push([0,1]),this.edges.push([0,this.vertices.length-1]);break;case Wc:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([this.vertices.length-2,this.vertices.length-1])}}},v=new Ts(f,1,x,this);v.computeNormals(),f<=50?v._edgesToVertices(v):this.states.strokeColor&&console.log(`Cannot apply a stroke to an ${p} with more than 50 detail`),v.gid=g,this.geometryBufferCache.ensureCached(v)}const y=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.clone());try{this.states.uModelMatrix.translate([i,a,0]),this.states.uModelMatrix.scale(o,u,1),this._drawGeometry(this.geometryBufferCache.getGeometryByID(g))}finally{this.states.setValue("uModelMatrix",y)}return this},Ht.prototype.rect=function(s){const i=s[0],a=s[1],o=s[2],u=s[3];if(typeof s[4]>"u"){const l=this._pInst._glAttributes.perPixelLighting,c=s[4]||(l?1:24),h=s[5]||(l?1:16),f=`rect|${c}|${h}`;if(!this.geometryInHash(f)){const g=function(){for(let x=0;x<=this.detailY;x++){const v=x/this.detailY;for(let S=0;S<=this.detailX;S++){const w=S/this.detailX,E=new Ee(w,v,0);this.vertices.push(E),this.uvs.push(w,v)}}c>0&&h>0&&(this.edges=[[0,c],[c,(c+1)*(h+1)-1],[(c+1)*(h+1)-1,(c+1)*h],[(c+1)*h,0]])},y=new Ts(c,h,g,this);y.computeFaces().computeNormals()._edgesToVertices(),y.gid=f,this.geometryBufferCache.ensureCached(y)}const p=this.states.uModelMatrix;this.states.setValue("uModelMatrix",this.states.uModelMatrix.copy());try{this.states.uModelMatrix.translate([i,a,0]),this.states.uModelMatrix.scale(o,u,1),this._drawGeometry(this.geometryBufferCache.getGeometryByID(f))}finally{this.states.setValue("uModelMatrix",p)}}else{let l=s[4],c=typeof s[5]>"u"?l:s[5],h=typeof s[6]>"u"?c:s[6],f=typeof s[7]>"u"?h:s[7],p=i,g=a,y=o,x=u;if(y+=p,x+=g,p>y){const A=p;p=y,y=A}if(g>x){const A=g;g=x,x=A}const v=Math.min((y-p)/2,(x-g)/2);l>v&&(l=v),c>v&&(c=v),h>v&&(h=v),f>v&&(f=v);let S=p,w=g,E=y,_=x;const D=this.states.textureMode;this.states.setValue("textureMode",wo);const I=this.bezierOrder();this.bezierOrder(2),this.beginShape();const k=(A,N)=>[A,N,(A-S)/o,(N-w)/u];c!==0?(this.vertex(...k(E-c,w)),this.bezierVertex(...k(E,w)),this.bezierVertex(...k(E,w+c))):this.vertex(...k(E,w)),h!==0?(this.vertex(...k(E,_-h)),this.bezierVertex(...k(E,_)),this.bezierVertex(...k(E-h,_))):this.vertex(...k(E,_)),f!==0?(this.vertex(...k(S+f,_)),this.bezierVertex(...k(S,_)),this.bezierVertex(...k(S,_-f))):this.vertex(...k(S,_)),l!==0?(this.vertex(...k(S,w+l)),this.bezierVertex(...k(S,w)),this.bezierVertex(...k(S+l,w))):this.vertex(...k(S,w)),this.endShape(Gm),this.states.setValue("textureMode",D),this.bezierOrder(I)}return this},Ht.prototype.quad=function(s,i,a,o,u,l,c,h,f,p,g,y,x=2,v=2){const S=`quad|${s}|${i}|${a}|${o}|${u}|${l}|${c}|${h}|${f}|${p}|${g}|${y}|${x}|${v}`;if(!this.geometryInHash(S)){const w=new Ts(x,v,function(){let _=1/(this.detailX-1),D=1/(this.detailY-1);for(let I=0;I<this.detailY;I++)for(let k=0;k<this.detailX;k++){let A=k*_,N=I*D,F=(1-N)*s+N*p,$=(1-N)*i+N*g,O=(1-N)*a+N*y,M=(1-N)*o+N*c,B=(1-N)*u+N*h,U=(1-N)*l+N*f,V=(1-A)*F+A*M,Z=(1-A)*$+A*B,J=(1-A)*O+A*U;this.vertices.push(new Ee(V,Z,J)),this.uvs.push([A,N])}},this);w.faces=[];for(let _=0;_<v-1;_++)for(let D=0;D<x-1;D++){let I=D+_*x,k=D+1+_*x,A=D+1+(_+1)*x,N=D+(_+1)*x;w.faces.push([I,k,A]),w.faces.push([I,A,N])}w.computeNormals(),w.edges.length=0;const E=[0,2,3,1];for(let _=0;_<E.length;_++){const D=E[_],I=E[(_+1)%E.length];w.edges.push([D,I])}w._edgesToVertices(),w.gid=S,this.geometryBufferCache.ensureCached(w)}return this._drawGeometry(this.geometryBufferCache.getGeometryByID(S)),this},Ht.prototype.bezier=function(s,i,a,o,u,l,c,h,f,p,g,y){arguments.length===8&&(g=h,p=c,h=l,c=u,u=o,o=a,a=l=f=y=0),this.bezierOrder(),this.bezierOrder(3),this.beginShape(),this.vertex(s,i,a),this.bezierVertex(o,u,l),this.bezierVertex(c,h,f),this.bezierVertex(p,g,y),this.endShape()},Ht.prototype.curve=function(s,i,a,o,u,l,c,h,f,p,g,y){arguments.length===8&&(p=c,g=h,c=u,h=o,o=a,u=o,a=l=f=y=0),this.beginShape(),this.splineVertex(s,i,a),this.splineVertex(o,u,l),this.splineVertex(c,h,f),this.splineVertex(p,g,y),this.endShape()},Ht.prototype.line=function(...s){return s.length===6?(this.beginShape(sd),this.vertex(s[0],s[1],s[2]),this.vertex(s[3],s[4],s[5]),this.endShape()):s.length===4&&(this.beginShape(sd),this.vertex(s[0],s[1],0),this.vertex(s[2],s[3],0),this.endShape()),this},Ht.prototype.image=function(s,i,a,o,u,l,c,h,f){this._isErasing&&this.blendMode(this._cachedBlendMode),this.push(),this.noLights(),this.states.setValue("strokeColor",null),this.texture(s),this.states.setValue("textureMode",wo);let p=0;i<=s.width&&(p=i/s.width);let g=1;i+o<=s.width&&(g=(i+o)/s.width);let y=0;a<=s.height&&(y=a/s.height);let x=1;a+u<=s.height&&(x=(a+u)/s.height),this._drawingImage=!0,this.beginShape(),this.vertex(l,c,0,p,y),this.vertex(l+h,c,0,g,y),this.vertex(l+h,c+f,0,g,x),this.vertex(l,c+f,0,p,x),this.endShape(Gm),this._drawingImage=!1,this.pop(),this._isErasing&&this.blendMode(Hc)};const n=function(s,i,a,o,u,l,c){s=s<=0?1:s,i=i<0?0:i,a=a<=0?s:a,o=o<3?3:o,u=u<1?1:u,l=l===void 0?!0:l,c=c===void 0?i!==0:c;const h=l?-2:0,f=u+(c?2:0),p=Math.atan2(s-i,a),g=Math.sin(p),y=Math.cos(p);let x,v,S;for(x=h;x<=f;++x){let E=x/u,_=a*E,D;for(x<0?(_=0,E=0,D=s):x>u?(_=a,E=1,D=i):D=s+(i-s)*E,(x===-2||x===u+2)&&(D=0),_-=a/2,v=0;v<o;++v){const I=v/(o-1),k=2*Math.PI*I,A=Math.sin(k),N=Math.cos(k);this.vertices.push(new Ee(A*D,_,N*D));let F;x<0?F=new Ee(0,-1,0):x>u&&i?F=new Ee(0,1,0):F=new Ee(A*y,g,N*y),this.vertexNormals.push(F),this.uvs.push(I,E)}}let w=0;if(l){for(S=0;S<o;++S){const E=(S+1)%o;this.faces.push([w+S,w+o+E,w+o+S])}w+=o*2}for(x=0;x<u;++x){for(v=0;v<o;++v){const E=(v+1)%o;this.faces.push([w+v,w+E,w+o+E]),this.faces.push([w+v,w+o+E,w+o+v])}w+=o}if(c)for(w+=o,v=0;v<o;++v)this.faces.push([w+v,w+(v+1)%o,w+o])};Ht.prototype.plane=function(s=50,i=s,a=1,o=1){const u=`plane|${a}|${o}`;if(!this.geometryInHash(u)){const l=function(){let h,f,p;for(let g=0;g<=this.detailY;g++){f=g/this.detailY;for(let y=0;y<=this.detailX;y++)h=y/this.detailX,p=new Ee(h-.5,f-.5,0),this.vertices.push(p),this.uvs.push(h,f)}},c=new Ts(a,o,l,this);c.computeFaces().computeNormals(),a<=1&&o<=1?c._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),c.gid=u,this.geometryBufferCache.ensureCached(c)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(u),s,i,1)},Ht.prototype.box=function(s=50,i=s,a=i,o,u){const l=this.attributes&&this.attributes.perPixelLighting;typeof o>"u"&&(o=l?1:4),typeof u>"u"&&(u=l?1:4);const c=`box|${o}|${u}`;if(!this.geometryInHash(c)){const h=function(){const p=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]];this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]],p.forEach((g,y)=>{const x=y*4;for(let v=0;v<4;v++){const S=g[v],w=new Ee(((S&1)*2-1)/2,((S&2)-1)/2,((S&4)/2-1)/2);this.vertices.push(w),this.uvs.push(v&1,(v&2)/2)}this.faces.push([x,x+1,x+2]),this.faces.push([x+2,x+1,x+3])})},f=new Ts(o,u,h,this);f.computeNormals(),o<=4&&u<=4?f._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),f.gid=c,this.geometryBufferCache.ensureCached(f)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(c),s,i,a)},Ht.prototype.sphere=function(s=50,i=24,a=16){this.ellipsoid(s,s,s,i,a)},Ht.prototype.ellipsoid=function(s=50,i=s,a=s,o=24,u=16){const l=`ellipsoid|${o}|${u}`;if(!this.geometryInHash(l)){const c=function(){for(let f=0;f<=this.detailY;f++){const p=f/this.detailY,g=Math.PI*p-Math.PI/2,y=Math.cos(g),x=Math.sin(g);for(let v=0;v<=this.detailX;v++){const S=v/this.detailX,w=2*Math.PI*S,E=Math.cos(w),_=Math.sin(w),D=new r.Vector(y*_,x,y*E);this.vertices.push(D),this.vertexNormals.push(D),this.uvs.push(S,p)}}},h=new Ts(o,u,c,this);h.computeFaces(),o<=24&&u<=24?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),h.gid=l,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),s,i,a)},Ht.prototype.cylinder=function(s=50,i=s,a=24,o=1,u=!0,l=!0){const c=`cylinder|${a}|${o}|${u}|${l}`;if(!this.geometryInHash(c)){const h=new r.Geometry(a,o,function(){n.call(this,1,1,1,a,o,u,l)},this);a<=24&&o<=16?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),h.gid=c,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(c),s,i,s)},Ht.prototype.cone=function(s=50,i=s,a=24,o=1,u=!0){const l=`cone|${a}|${o}|${u}`;if(!this.geometryInHash(l)){const c=new Ts(a,o,function(){n.call(this,1,0,1,a,o,u,!1)},this);a<=24&&o<=16?c._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),c.gid=l,this.geometryBufferCache.ensureCached(c)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),s,i,s)},Ht.prototype.torus=function(s=50,i=10,a=24,o=16){if(s===0||i===0)return;const u=(i/s).toPrecision(4),l=`torus|${u}|${a}|${o}`;if(!this.geometryInHash(l)){const c=function(){for(let f=0;f<=this.detailY;f++){const p=f/this.detailY,g=2*Math.PI*p,y=Math.cos(g),x=Math.sin(g),v=1+u*y;for(let S=0;S<=this.detailX;S++){const w=S/this.detailX,E=2*Math.PI*w,_=Math.cos(E),D=Math.sin(E),I=new Ee(v*_,v*D,u*x),k=new Ee(y*_,y*D,x);this.vertices.push(I),this.vertexNormals.push(k),this.uvs.push(w,p)}}},h=new Ts(a,o,c,this);h.computeFaces(),a<=24&&o<=16?h._makeTriangleEdges()._edgesToVertices():this.states.strokeColor&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),h.gid=l,this.geometryBufferCache.ensureCached(h)}this._drawGeometryScaled(this.geometryBufferCache.getGeometryByID(l),s,s,s)},t.curveDetail=function(s){if(!(this._renderer instanceof Ht))throw new Error("curveDetail() only works in WebGL mode. Did you mean to call createCanvas(width, height, WEBGL)?");return this._renderer.curveDetail(s)}}typeof p5<"u"&&CT(p5,p5.prototype);function _T(r,t){t.ambientLight=function(n,s,i,a){return this._assert3d("ambientLight"),this._renderer.ambientLight(...arguments),this},t.specularColor=function(n,s,i){return this._assert3d("specularColor"),this._renderer.specularColor(...arguments),this},t.directionalLight=function(n,s,i,a,o,u){return this._assert3d("directionalLight"),this._renderer.directionalLight(...arguments),this},t.pointLight=function(n,s,i,a,o,u){return this._assert3d("pointLight"),this._renderer.pointLight(...arguments),this},t.imageLight=function(n){this._renderer.imageLight(n)},t.panorama=function(n){this.filter(this._renderer._getSphereMapping(n))},t.lights=function(){return this._assert3d("lights"),this._renderer.lights(),this},t.lightFalloff=function(n,s,i){return this._assert3d("lightFalloff"),this._renderer.lightFalloff(n,s,i),this},t.spotLight=function(n,s,i,a,o,u,l,c,h,f,p){return this._assert3d("spotLight"),this._renderer.spotLight(...arguments),this},t.noLights=function(...n){return this._assert3d("noLights"),this._renderer.noLights(),this},Ht.prototype.ambientLight=function(n,s,i,a){const o=this._pInst.color(...arguments);this.states.setValue("ambientLightColors",[...this.states.ambientLightColors]),this.states.ambientLightColors.push(o._array[0],o._array[1],o._array[2]),this.states.setValue("enableLighting",!0)},Ht.prototype.specularColor=function(n,s,i){const a=this._pInst.color(...arguments);this.states.setValue("specularColors",[a._array[0],a._array[1],a._array[2]])},Ht.prototype.directionalLight=function(n,s,i,a,o,u){let l;n instanceof pr?l=n:l=this._pInst.color(n,s,i);let c,h,f;const p=arguments[arguments.length-1];typeof p=="number"?(c=arguments[arguments.length-3],h=arguments[arguments.length-2],f=arguments[arguments.length-1]):(c=p.x,h=p.y,f=p.z);const g=Math.sqrt(c*c+h*h+f*f);this.states.setValue("directionalLightDirections",[...this.states.directionalLightDirections]),this.states.directionalLightDirections.push(c/g,h/g,f/g),this.states.setValue("directionalLightDiffuseColors",[...this.states.directionalLightDiffuseColors]),this.states.directionalLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),this.states.setValue("directionalLightSpecularColors",[...this.states.directionalLightSpecularColors]),Array.prototype.push.apply(this.states.directionalLightSpecularColors,this.states.specularColors),this.states.setValue("enableLighting",!0)},Ht.prototype.pointLight=function(n,s,i,a,o,u){let l;n instanceof pr?l=n:l=this._pInst.color(n,s,i);let c,h,f;const p=arguments[arguments.length-1];typeof p=="number"?(c=arguments[arguments.length-3],h=arguments[arguments.length-2],f=arguments[arguments.length-1]):(c=p.x,h=p.y,f=p.z),this.states.setValue("pointLightPositions",[...this.states.pointLightPositions]),this.states.pointLightPositions.push(c,h,f),this.states.setValue("pointLightDiffuseColors",[...this.states.pointLightDiffuseColors]),this.states.pointLightDiffuseColors.push(l._array[0],l._array[1],l._array[2]),this.states.setValue("pointLightSpecularColors",[...this.states.pointLightSpecularColors]),Array.prototype.push.apply(this.states.pointLightSpecularColors,this.states.specularColors),this.states.setValue("enableLighting",!0)},Ht.prototype.imageLight=function(n){this.states.setValue("activeImageLight",n),this.states.setValue("enableLighting",!0)},Ht.prototype.lights=function(){const n=this._pInst.color("rgb(128,128,128)");this.ambientLight(n),this.directionalLight(n,0,0,-1)},Ht.prototype.lightFalloff=function(n,s,i){n<0&&(n=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),s<0&&(s=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),i<0&&(i=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),n===0&&s===0&&i===0&&(n=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this.states.setValue("constantAttenuation",n),this.states.setValue("linearAttenuation",s),this.states.setValue("quadraticAttenuation",i)},Ht.prototype.spotLight=function(n,s,i,a,o,u,l,c,h,f,p){let g,y,x;const v=arguments.length;switch(v){case 11:case 10:g=this._pInst.color(n,s,i),y=new Ee(a,o,u),x=new Ee(l,c,h);break;case 9:n instanceof pr?(g=n,y=new Ee(s,i,a),x=new Ee(o,u,l),f=c,p=h):a instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=new Ee(o,u,l),f=c,p=h):l instanceof Ee?(g=this._pInst.color(n,s,i),y=new Ee(a,o,u),x=l,f=c,p=h):(g=this._pInst.color(n,s,i),y=new Ee(a,o,u),x=new Ee(l,c,h));break;case 8:n instanceof pr?(g=n,y=new Ee(s,i,a),x=new Ee(o,u,l),f=c):a instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=new Ee(o,u,l),f=c):(g=this._pInst.color(n,s,i),y=new Ee(a,o,u),x=l,f=c);break;case 7:n instanceof pr&&s instanceof Ee?(g=n,y=s,x=new Ee(i,a,o),f=u,p=l):n instanceof pr&&o instanceof Ee?(g=n,y=new Ee(s,i,a),x=o,f=u,p=l):a instanceof Ee&&o instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=o,f=u,p=l):n instanceof pr?(g=n,y=new Ee(s,i,a),x=new Ee(o,u,l)):a instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=new Ee(o,u,l)):(g=this._pInst.color(n,s,i),y=new Ee(a,o,u),x=l);break;case 6:a instanceof Ee&&o instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=o,f=u):n instanceof pr&&o instanceof Ee?(g=n,y=new Ee(s,i,a),x=o,f=u):n instanceof pr&&s instanceof Ee&&(g=n,y=s,x=new Ee(i,a,o),f=u);break;case 5:n instanceof pr&&s instanceof Ee&&i instanceof Ee?(g=n,y=s,x=i,f=a,p=o):a instanceof Ee&&o instanceof Ee?(g=this._pInst.color(n,s,i),y=a,x=o):n instanceof pr&&o instanceof Ee?(g=n,y=new Ee(s,i,a),x=o):n instanceof pr&&s instanceof Ee&&(g=n,y=s,x=new Ee(i,a,o));break;case 4:g=n,y=s,x=i,f=a;break;case 3:g=n,y=s,x=i;break;default:console.warn(`Sorry, input for spotlight() is not in prescribed format. Too ${v<3?"few":"many"} arguments were provided`);return}this.states.setValue("spotLightDiffuseColors",[g._array[0],g._array[1],g._array[2]]),this.states.setValue("spotLightSpecularColors",[...this.states.specularColors]),this.states.setValue("spotLightPositions",[y.x,y.y,y.z]),x.normalize(),this.states.setValue("spotLightDirections",[x.x,x.y,x.z]),f===void 0&&(f=Math.PI/3),p!==void 0&&p<1?(p=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):p===void 0&&(p=100),f=this._pInst._toRadians(f),this.states.setValue("spotLightAngle",[Math.cos(f)]),this.states.setValue("spotLightConc",[p]),this.states.setValue("enableLighting",!0)},Ht.prototype.noLights=function(){this.states.setValue("activeImageLight",null),this.states.setValue("enableLighting",!1),this.states.setValue("ambientLightColors",[]),this.states.setValue("specularColors",[1,1,1]),this.states.setValue("directionalLightDirections",[]),this.states.setValue("directionalLightDiffuseColors",[]),this.states.setValue("directionalLightSpecularColors",[]),this.states.setValue("pointLightPositions",[]),this.states.setValue("pointLightDiffuseColors",[]),this.states.setValue("pointLightSpecularColors",[]),this.states.setValue("spotLightPositions",[]),this.states.setValue("spotLightDirections",[]),this.states.setValue("spotLightDiffuseColors",[]),this.states.setValue("spotLightSpecularColors",[]),this.states.setValue("spotLightAngle",[]),this.states.setValue("spotLightConc",[]),this.states.setValue("constantAttenuation",1),this.states.setValue("linearAttenuation",0),this.states.setValue("quadraticAttenuation",0),this.states.setValue("_useShininess",1),this.states.setValue("_useMetalness",0)}}typeof p5<"u"&&_T(p5,p5.prototype);function j8(r,t){t.loadShader=async function(n,s,i,a){const o=new Ns;try{return o._vertSrc=(await Wi(n,"text")).data,o._fragSrc=(await Wi(s,"text")).data,i?i(o):o}catch(u){if(a)return a(u);throw u}},t.createShader=function(n,s,i){return new Ns(this._renderer,n,s,i)},t.loadFilterShader=async function(n,s,i){try{const o=await(await this.loadStrings(n)).join(`
`),u=this.createFilterShader(o,!0);return s&&s(u),u}catch(a){i?i(a):console.error(a)}},t.createFilterShader=function(n,s=!1){let o=n.includes("#version 300 es")?`#version 300 es
      uniform mat4 uModelViewMatrix;
      uniform mat4 uProjectionMatrix;

      in vec3 aPosition;
      in vec2 aTexCoord;
      out vec2 vTexCoord;

      void main() {
        // transferring texcoords for the frag shader
        vTexCoord = aTexCoord;

        // copy position with a fourth coordinate for projection (1.0 is normal)
        vec4 positionVec4 = vec4(aPosition, 1.0);

        // project to 3D space
        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
      }
    `:`
      uniform mat4 uModelViewMatrix;
      uniform mat4 uProjectionMatrix;

      attribute vec3 aPosition;
      // texcoords only come from p5 to vertex shader
      // so pass texcoords on to the fragment shader in a varying variable
      attribute vec2 aTexCoord;
      varying vec2 vTexCoord;

      void main() {
        // transferring texcoords for the frag shader
        vTexCoord = aTexCoord;

        // copy position with a fourth coordinate for projection (1.0 is normal)
        vec4 positionVec4 = vec4(aPosition, 1.0);

        // project to 3D space
        gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;
      }
    `;const u=new Ns(this._renderer,o,n);return s||(this._renderer.GL?u.ensureCompiledOnContext(this._renderer):u.ensureCompiledOnContext(this)),u},t.shader=function(n){return this._assert3d("shader"),this._renderer.shader(n),this},t.strokeShader=function(n){return this._assert3d("strokeShader"),this._renderer.strokeShader(n),this},t.imageShader=function(n){return this._assert3d("imageShader"),this._renderer.imageShader(n),this},t.baseMaterialShader=function(){return this._assert3d("baseMaterialShader"),this._renderer.baseMaterialShader()},t.baseFilterShader=function(){return(this._renderer.filterRenderer||this._renderer).baseFilterShader()},t.baseNormalShader=function(){return this._assert3d("baseNormalShader"),this._renderer.baseNormalShader()},t.baseColorShader=function(){return this._assert3d("baseColorShader"),this._renderer.baseColorShader()},t.baseStrokeShader=function(){return this._assert3d("baseStrokeShader"),this._renderer.baseStrokeShader()},t.resetShader=function(){return this._renderer.resetShader(),this},t.texture=function(n){return this._assert3d("texture"),n.gifProperties&&n._animateGif(this),this._renderer.texture(n),this},t.textureMode=function(n){n!==tv&&n!==wo?console.warn(`You tried to set ${n} textureMode only supports IMAGE & NORMAL `):this._renderer.states.setValue("textureMode",n)},t.textureWrap=function(n,s=n){this._renderer.states.setValue("textureWrapX",n),this._renderer.states.setValue("textureWrapY",s);for(const i of this._renderer.textures.values())i.setWrapMode(n,s)},t.normalMaterial=function(...n){return this._assert3d("normalMaterial"),this._renderer.normalMaterial(...n),this},t.ambientMaterial=function(n,s,i){this._assert3d("ambientMaterial");const a=t.color.apply(this,arguments);return this._renderer.states.setValue("_hasSetAmbient",!0),this._renderer.states.setValue("curAmbientColor",a._array),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this._renderer.states.fillColor||this._renderer.states.setValue("fillColor",new pr([1,1,1])),this},t.emissiveMaterial=function(n,s,i,a){this._assert3d("emissiveMaterial");const o=t.color.apply(this,arguments);return this._renderer.states.setValue("curEmissiveColor",o._array),this._renderer.states.setValue("_useEmissiveMaterial",!0),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this},t.specularMaterial=function(n,s,i,a){this._assert3d("specularMaterial");const o=t.color.apply(this,arguments);return this._renderer.states.setValue("curSpecularColor",o._array),this._renderer.states.setValue("_useSpecularMaterial",!0),this._renderer.states.setValue("_useNormalMaterial",!1),this._renderer.states.setValue("enableLighting",!0),this},t.shininess=function(n){return this._assert3d("shininess"),this._renderer.shininess(n),this},t.metalness=function(n){return this._assert3d("metalness"),this._renderer.metalness(n),this},Ht.prototype._applyColorBlend=function(n,s){const i=this.GL,a=this.states.drawMode===Tx,o=s||this.states.userFillShader||this.states.userStrokeShader||this.states.userPointShader||a||this.states.curBlendMode!==ci||n[n.length-1]<1||this._isErasing;return o!==this._isBlending&&(o||this.states.curBlendMode!==ci&&this.states.curBlendMode!==Wm?i.enable(i.BLEND):i.disable(i.BLEND),i.depthMask(!0),this._isBlending=o),this._applyBlendMode(),n},Ht.prototype._applyBlendMode=function(){if(this._cachedBlendMode===this.states.curBlendMode)return;const n=this.GL;switch(this.states.curBlendMode){case ci:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Wm:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ONE);break;case Hc:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ZERO,n.ONE_MINUS_SRC_ALPHA);break;case Yb:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA);break;case Zb:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_COLOR);break;case Xb:n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD),n.blendFuncSeparate(n.ONE_MINUS_DST_COLOR,n.ONE_MINUS_SRC_COLOR,n.ONE,n.ONE);break;case Qb:n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO);break;case Kb:n.blendEquationSeparate(n.FUNC_REVERSE_SUBTRACT,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Hb:this.blendExt?(n.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE,n.ONE,n.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case qb:this.blendExt?(n.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,n.FUNC_ADD),n.blendFuncSeparate(n.ONE,n.ONE,n.ONE,n.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.");break}this._cachedBlendMode=this.states.curBlendMode},Ht.prototype.shader=function(n){this.states.setValue("userFillShader",n),this.states.setValue("_useNormalMaterial",!1),n.ensureCompiledOnContext(this),n.setDefaultUniforms()},Ht.prototype.strokeShader=function(n){this.states.setValue("userStrokeShader",n),n.ensureCompiledOnContext(this),n.setDefaultUniforms()},Ht.prototype.imageShader=function(n){this.states.setValue("userImageShader",n),n.ensureCompiledOnContext(this),n.setDefaultUniforms()},Ht.prototype.resetShader=function(){this.states.setValue("userFillShader",null),this.states.setValue("userStrokeShader",null),this.states.setValue("userImageShader",null)},Ht.prototype.texture=function(n){this.states.setValue("drawMode",Tx),this.states.setValue("_useNormalMaterial",!1),this.states.setValue("_tex",n),this.states.setValue("fillColor",new pr([1,1,1]))},Ht.prototype.normalMaterial=function(...n){this.states.setValue("drawMode",Dx),this.states.setValue("_useSpecularMaterial",!1),this.states.setValue("_useEmissiveMaterial",!1),this.states.setValue("_useNormalMaterial",!0),this.states.setValue("curFillColor",[1,1,1,1]),this.states.setValue("fillColor",new pr([1,1,1])),this.states.setValue("strokeColor",null)},Ht.prototype.shininess=function(n){n<1&&(n=1),this.states.setValue("_useShininess",n)},Ht.prototype.metalness=function(n){const s=1-Math.exp(-n/100);this.states.setValue("_useMetalness",s)}}typeof p5<"u"&&loading(p5,p5.prototype);class ud{constructor(t,n,s,i,a){const o=s||jc;return this._pInst=i,this._renderer=new tx[o](this._pInst,t,n,!1,a),this._initializeInstanceVariables(this),this._renderer._applyDefaults(),this}get deltaTime(){return this._pInst.deltaTime}get canvas(){var t;return(t=this._renderer)==null?void 0:t.canvas}get drawingContext(){return this._renderer.drawingContext}get width(){var t;return(t=this._renderer)==null?void 0:t.width}get height(){var t;return(t=this._renderer)==null?void 0:t.height}get pixels(){var t;return(t=this._renderer)==null?void 0:t.pixels}pixelDensity(t){let n;return typeof t=="number"?(t!==this._renderer._pixelDensity&&(this._renderer._pixelDensity=t),n=this,this.resizeCanvas(this.width,this.height,!0)):n=this._renderer._pixelDensity,n}resizeCanvas(t,n){this._renderer.resize(t,n)}reset(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()}remove(){this._renderer.remove(),this._renderer=void 0}createFramebuffer(t){return new Ha(this._renderer,t)}_assert3d(t){if(!this._renderer.isP3D)throw new Error(`${t}() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information.`)}_initializeInstanceVariables(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._downKeys={}}}function pJ(r,t){r.Graphics=ud,cT(r,r.Graphics.prototype),hT(r,r.Graphics.prototype),fT(r,r.Graphics.prototype),dT(r,r.Graphics.prototype),oT(r,r.Graphics.prototype),pT(r,r.Graphics.prototype),bT(r,r.Graphics.prototype),xT(r,r.Graphics.prototype),gT(r,r.Graphics.prototype),rT(r,r.Graphics.prototype),CT(r,r.Graphics.prototype),_T(r,r.Graphics.prototype),j8(r,r.Graphics.prototype),aT(r,r.Graphics.prototype),yT(r,r.Graphics.prototype)}class bu{constructor(t,n,s){this._renderer=t;const i=this._renderer.GL;s=s||{},this.src=n,this.glTex=void 0,this.glTarget=i.TEXTURE_2D,this.glFormat=s.format||i.RGBA,this.mipmaps=!1,this.glMinFilter=s.minFilter||i.LINEAR,this.glMagFilter=s.magFilter||i.LINEAR,this.glWrapS=s.wrapS||i.CLAMP_TO_EDGE,this.glWrapT=s.wrapT||i.CLAMP_TO_EDGE,this.glDataType=s.dataType||i.UNSIGNED_BYTE;const a=H8(t);this.glFormat===i.HALF_FLOAT&&!a.halfFloat&&(console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT."),this.glDataType=i.FLOAT),this.glFormat===i.HALF_FLOAT&&(this.glMinFilter===i.LINEAR||this.glMagFilter===i.LINEAR)&&!a.halfFloatLinear&&(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===i.LINEAR&&(this.glMinFilter=i.NEAREST),this.glMagFilter===i.LINEAR&&(this.glMagFilter=i.NEAREST)),this.glFormat===i.FLOAT&&!a.float&&(console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE."),this.glDataType=i.UNSIGNED_BYTE),this.glFormat===i.FLOAT&&(this.glMinFilter===i.LINEAR||this.glMagFilter===i.LINEAR)&&!a.floatLinear&&(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===i.LINEAR&&(this.glMinFilter=i.NEAREST),this.glMagFilter===i.LINEAR&&(this.glMagFilter=i.NEAREST)),this.isSrcMediaElement=!1,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=typeof vn<"u"&&n instanceof vn&&!(n instanceof ud)&&!(n instanceof Pt),this.isSrcP5Image=n instanceof kl,this.isSrcP5Graphics=n instanceof ud,this.isSrcP5Renderer=n instanceof Pt,this.isImageData=typeof ImageData<"u"&&n instanceof ImageData,this.isFramebufferTexture=n instanceof Mx;const o=this._getTextureDataFromSource();return this.width=o.width,this.height=o.height,this.init(o),this}remove(){this.glTex&&(this._renderer.GL.deleteTexture(this.glTex),this.glTex=void 0)}_getTextureDataFromSource(){let t;return this.isFramebufferTexture?t=this.src.rawTexture():this.isSrcP5Image?t=this.src.canvas:this.isSrcMediaElement||this.isSrcHTMLElement?(this.src._ensureCanvas&&this.src._ensureCanvas(),t=this.src.elt):this.isSrcP5Graphics||this.isSrcP5Renderer?t=this.src.canvas:this.isImageData&&(t=this.src),t}init(t){const n=this._renderer.GL;if(this.isFramebufferTexture||(this.glTex=n.createTexture()),this.glWrapS=this._renderer.states.textureWrapX,this.glWrapT=this._renderer.states.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,this.glMagFilter),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.glMinFilter),!this.isFramebufferTexture)if(this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata){const s=new Uint8Array([1,1,1,1]);n.texImage2D(this.glTarget,0,n.RGBA,1,1,0,this.glFormat,this.glDataType,s)}else n.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,t)}update(){const t=this.src;if(t.width===0||t.height===0)return!1;if(this.isFramebufferTexture)return this.src.update(),!1;const n=this._getTextureDataFromSource();let s=!1;const i=this._renderer.GL;return n.width!==this.width||n.height!==this.height?(s=!0,this.width=n.width||t.width,this.height=n.height||t.height,this.isSrcP5Image?t.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&t.setModified&&t.setModified(!0)):this.isSrcP5Image?t.isModified()&&(s=!0,t.setModified(!1)):this.isSrcMediaElement?t.isModified()?(s=!0,t.setModified(!1)):t.loadedmetadata&&this._videoPrevUpdateTime!==t.time()&&(this._videoPrevUpdateTime=t.time(),s=!0):this.isImageData?t._dirty&&(t._dirty=!1,s=!0):s=!0,s&&(this.bindTexture(),i.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,n)),s}bindTexture(){return this._renderer.GL.bindTexture(this.glTarget,this.getTexture()),this}unbindTexture(){this._renderer.GL.bindTexture(this.glTarget,null)}getTexture(){return this.isFramebufferTexture?this.src.rawTexture():this.glTex}setInterpolation(t,n){const s=this._renderer.GL;this.glMinFilter=this.glFilter(t),this.glMagFilter=this.glFilter(n),this.bindTexture(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,this.glMinFilter),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()}glFilter(t){const n=this._renderer.GL;return t===c6?n.NEAREST:n.LINEAR}setWrapMode(t,n){const s=this._renderer.GL,i=h=>(h&h-1)===0,a=this._getTextureDataFromSource();let o,u;a.naturalWidth&&a.naturalHeight?(o=a.naturalWidth,u=a.naturalHeight):(o=this.width,u=this.height);const l=i(o),c=i(u);t===B_?this._renderer.webglVersion===Qr||l&&c?this.glWrapS=s.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=s.CLAMP_TO_EDGE):t===V_?this._renderer.webglVersion===Qr||l&&c?this.glWrapS=s.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=s.CLAMP_TO_EDGE):this.glWrapS=s.CLAMP_TO_EDGE,n===B_?this._renderer.webglVersion===Qr||l&&c?this.glWrapT=s.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=s.CLAMP_TO_EDGE):n===V_?this._renderer.webglVersion===Qr||l&&c?this.glWrapT=s.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=s.CLAMP_TO_EDGE):this.glWrapT=s.CLAMP_TO_EDGE,this.bindTexture(),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,this.glWrapS),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()}}class W8 extends bu{constructor(t,n,s){super(t,n,s);const i=this._renderer.GL;this.glMinFilter===i.LINEAR&&(this.glMinFilter=i.LINEAR_MIPMAP_LINEAR)}glFilter(t){return this._renderer.GL.LINEAR_MIPMAP_LINEAR}_getTextureDataFromSource(){return this.src}init(t){const n=this._renderer.GL;this.glTex=n.createTexture(),this.bindTexture();for(let s=0;s<t.length;s++)n.texImage2D(this.glTarget,s,this.glFormat,this.glFormat,this.glDataType,t[s]);this.glMinFilter=n.LINEAR_MIPMAP_LINEAR,n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,this.glMagFilter),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.glMinFilter),this.unbindTexture()}update(){}}function ET(r,t){r.Texture=bu,r.MipmapTexture=W8}function H8({GL:r,webglVersion:t}){const n=r,s=t===Qr?n.getExtension("EXT_color_buffer_float")&&n.getExtension("EXT_float_blend"):n.getExtension("OES_texture_float"),i=s&&n.getExtension("OES_texture_float_linear"),a=t===Qr?n.getExtension("EXT_color_buffer_float"):n.getExtension("OES_texture_half_float"),o=a&&n.getExtension("OES_texture_half_float_linear");return{float:s,floatLinear:i,halfFloat:a,halfFloatLinear:o}}typeof p5<"u"&&ET(p5,p5.prototype);const vf=(r,t,n)=>Math.max(Math.min(r,n),t);class q8 extends Qc{constructor(t){super(t.renderer),this.fbo=t,this.yScale=-1}_computeCameraDefaultSettings(){super._computeCameraDefaultSettings(),this.defaultAspectRatio=this.fbo.width/this.fbo.height,this.defaultCameraFOV=2*Math.atan(this.fbo.height/2/this.defaultEyeZ)}}class Mx{constructor(t,n){this.framebuffer=t,this.property=n}get width(){return this.framebuffer.width*this.framebuffer.density}get height(){return this.framebuffer.height*this.framebuffer.density}update(){this.framebuffer._update(this.property)}rawTexture(){return this.framebuffer[this.property]}}class Ha{constructor(t,n={}){this.renderer=t,this.renderer.framebuffers.add(this),this._isClipApplied=!1,this.dirty={colorTexture:!1,depthTexture:!1},this.pixels=[],this.format=n.format||ul,this.channels=n.channels||(this.renderer._pInst._glAttributes.alpha?Xy:dr),this.useDepth=n.depth===void 0?!0:n.depth,this.depthFormat=n.depthFormat||Ci,this.textureFiltering=n.textureFiltering||L_,n.antialias===void 0?this.antialiasSamples=this.renderer._pInst._glAttributes.antialias?2:0:typeof n.antialias=="number"?this.antialiasSamples=n.antialias:this.antialiasSamples=n.antialias?2:0,this.antialias=this.antialiasSamples>0,this.antialias&&this.renderer.webglVersion!==Qr&&(console.warn("Antialiasing is unsupported in a WebGL 1 context"),this.antialias=!1),this.density=n.density||this.renderer._pixelDensity;const s=this.renderer.GL;if(this.gl=s,n.width&&n.height){const a=this.renderer._adjustDimensions(n.width,n.height);this.width=a.adjustedWidth,this.height=a.adjustedHeight,this._autoSized=!1}else n.width===void 0!=(n.height===void 0)&&console.warn("Please supply both width and height for a framebuffer to give it a size. Only one was given, so the framebuffer will match the size of its canvas."),this.width=this.renderer.width,this.height=this.renderer.height,this._autoSized=!0;if(this._checkIfFormatsAvailable(),n.stencil&&!this.useDepth&&console.warn("A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored."),this.useStencil=this.useDepth&&(n.stencil===void 0?!0:n.stencil),this.framebuffer=s.createFramebuffer(),!this.framebuffer)throw new Error("Unable to create a framebuffer");if(this.antialias&&(this.aaFramebuffer=s.createFramebuffer(),!this.aaFramebuffer))throw new Error("Unable to create a framebuffer for antialiasing");this._recreateTextures();const i=this.renderer.states.curCamera;this.defaultCamera=this.createCamera(),this.filterCamera=this.createCamera(),this.renderer.states.setValue("curCamera",i),this.draw(()=>this.renderer.clear())}resize(t,n){this._autoSized=!1;const s=this.renderer._adjustDimensions(t,n);t=s.adjustedWidth,n=s.adjustedHeight,this.width=t,this.height=n,this._handleResize()}pixelDensity(t){if(t)this._autoSized=!1,this.density=t,this._handleResize();else return this.density}autoSized(t){if(t===void 0)return this._autoSized;this._autoSized=t,this._handleResize()}_checkIfFormatsAvailable(){const t=this.gl;this.useDepth&&this.renderer.webglVersion===Nl&&!t.getExtension("WEBGL_depth_texture")&&(console.warn("Unable to create depth textures in this environment. Falling back to a framebuffer without depth."),this.useDepth=!1),this.useDepth&&this.renderer.webglVersion===Nl&&this.depthFormat===Ci&&(console.warn("FLOAT depth format is unavailable in WebGL 1. Defaulting to UNSIGNED_INT."),this.depthFormat=km),[ul,Ci,kf].includes(this.format)||(console.warn("Unknown Framebuffer format. Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. Defaulting to UNSIGNED_BYTE."),this.format=ul),this.useDepth&&![km,Ci].includes(this.depthFormat)&&(console.warn("Unknown Framebuffer depth format. Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT."),this.depthFormat=Ci);const n=H8(this.renderer);!n.float&&this.format===Ci&&(console.warn("This environment does not support FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=ul),this.useDepth&&!n.float&&this.depthFormat===Ci&&(console.warn("This environment does not support FLOAT depth textures. Falling back to UNSIGNED_INT."),this.depthFormat=km),!n.halfFloat&&this.format===kf&&(console.warn("This environment does not support HALF_FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=ul),this.channels===dr&&[Ci,kf].includes(this.format)&&(console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only RGB channels. Falling back to RGBA."),this.channels=Xy)}_recreateTextures(){const t=this.gl;this._updateSize();const n=t.getParameter(t.TEXTURE_BINDING_2D),s=t.getParameter(t.FRAMEBUFFER_BINDING),i=t.createTexture();if(!i)throw new Error("Unable to create color texture");t.bindTexture(t.TEXTURE_2D,i);const a=this._glColorFormat();if(t.texImage2D(t.TEXTURE_2D,0,a.internalFormat,this.width*this.density,this.height*this.density,0,a.format,a.type,null),this.colorTexture=i,t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),this.useDepth){const u=t.createTexture();if(!u)throw new Error("Unable to create depth texture");const l=this._glDepthFormat();t.bindTexture(t.TEXTURE_2D,u),t.texImage2D(t.TEXTURE_2D,0,l.internalFormat,this.width*this.density,this.height*this.density,0,l.format,l.type,null),t.framebufferTexture2D(t.FRAMEBUFFER,this.useStencil?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,t.TEXTURE_2D,u,0),this.depthTexture=u}if(this.antialias){if(this.colorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.colorRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,t.getParameter(t.MAX_SAMPLES))),a.internalFormat,this.width*this.density,this.height*this.density),this.useDepth){const u=this._glDepthFormat();this.depthRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthRenderbuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,t.getParameter(t.MAX_SAMPLES))),u.internalFormat,this.width*this.density,this.height*this.density)}t.bindFramebuffer(t.FRAMEBUFFER,this.aaFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this.colorRenderbuffer),this.useDepth&&t.framebufferRenderbuffer(t.FRAMEBUFFER,this.useStencil?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthRenderbuffer)}if(this.useDepth){this.depth=new Mx(this,"depthTexture");const u=t.NEAREST;this.depthP5Texture=new bu(this.renderer,this.depth,{minFilter:u,magFilter:u}),this.renderer.textures.set(this.depth,this.depthP5Texture)}this.color=new Mx(this,"colorTexture");const o=this.textureFiltering===L_?t.LINEAR:t.NEAREST;this.colorP5Texture=new bu(this.renderer,this.color,{minFilter:o,magFilter:o}),this.renderer.textures.set(this.color,this.colorP5Texture),t.bindTexture(t.TEXTURE_2D,n),t.bindFramebuffer(t.FRAMEBUFFER,s)}_glColorFormat(){let t,n,s;const i=this.gl;return this.format===Ci?t=i.FLOAT:this.format===kf?t=this.renderer.webglVersion===Qr?i.HALF_FLOAT:i.getExtension("OES_texture_half_float").HALF_FLOAT_OES:t=i.UNSIGNED_BYTE,this.channels===Xy?n=i.RGBA:n=i.RGB,this.renderer.webglVersion===Qr?s={[i.FLOAT]:{[i.RGBA]:i.RGBA32F},[i.HALF_FLOAT]:{[i.RGBA]:i.RGBA16F},[i.UNSIGNED_BYTE]:{[i.RGBA]:i.RGBA8,[i.RGB]:i.RGB8}}[t][n]:this.format===kf?s=i.RGBA:s=n,{internalFormat:s,format:n,type:t}}_glDepthFormat(){let t,n,s;const i=this.gl;return this.useStencil?this.depthFormat===Ci?t=i.FLOAT_32_UNSIGNED_INT_24_8_REV:this.renderer.webglVersion===Qr?t=i.UNSIGNED_INT_24_8:t=i.getExtension("WEBGL_depth_texture").UNSIGNED_INT_24_8_WEBGL:this.depthFormat===Ci?t=i.FLOAT:t=i.UNSIGNED_INT,this.useStencil?n=i.DEPTH_STENCIL:n=i.DEPTH_COMPONENT,this.useStencil?this.depthFormat===Ci?s=i.DEPTH32F_STENCIL8:this.renderer.webglVersion===Qr?s=i.DEPTH24_STENCIL8:s=i.DEPTH_STENCIL:this.renderer.webglVersion===Qr?this.depthFormat===Ci?s=i.DEPTH_COMPONENT32F:s=i.DEPTH_COMPONENT24:s=i.DEPTH_COMPONENT,{internalFormat:s,format:n,type:t}}_updateSize(){this._autoSized&&(this.width=this.renderer.width,this.height=this.renderer.height,this.density=this.renderer._pixelDensity)}_canvasSizeChanged(){this._autoSized&&this._handleResize()}_handleResize(){const t=this.color,n=this.depth,s=this.colorRenderbuffer,i=this.depthRenderbuffer;this._deleteTexture(t),n&&this._deleteTexture(n);const a=this.gl;s&&a.deleteRenderbuffer(s),i&&a.deleteRenderbuffer(i),this._recreateTextures(),this.defaultCamera._resize()}createCamera(){const t=new q8(this);return t._computeCameraDefaultSettings(),t._setDefaultCamera(),t}_deleteTexture(t){this.gl.deleteTexture(t.rawTexture()),this.renderer.textures.delete(t)}remove(){const t=this.gl;this._deleteTexture(this.color),this.depth&&this._deleteTexture(this.depth),t.deleteFramebuffer(this.framebuffer),this.aaFramebuffer&&t.deleteFramebuffer(this.aaFramebuffer),this.depthRenderbuffer&&t.deleteRenderbuffer(this.depthRenderbuffer),this.colorRenderbuffer&&t.deleteRenderbuffer(this.colorRenderbuffer),this.renderer.framebuffers.delete(this)}begin(){this.prevFramebuffer=this.renderer.activeFramebuffer(),this.prevFramebuffer&&this.prevFramebuffer._beforeEnd(),this.renderer.activeFramebuffers.push(this),this._beforeBegin(),this.renderer.push(),this.renderer.states.setValue("curCamera",this.defaultCamera),this.renderer.states.setValue("uPMatrix",this.renderer.states.uPMatrix.clone()),this.renderer.states.uPMatrix.set(this.defaultCamera.projMatrix),this.renderer.states.setValue("uViewMatrix",this.renderer.states.uViewMatrix.clone()),this.renderer.states.uViewMatrix.set(this.defaultCamera.cameraMatrix),this.renderer.resetMatrix(),this.renderer.states.uViewMatrix.set(this.renderer.states.curCamera.cameraMatrix),this.renderer.states.uModelMatrix.reset(),this.renderer._applyStencilTestIfClipping()}_framebufferToBind(){return this.antialias?this.aaFramebuffer:this.framebuffer}_update(t){if(this.dirty[t]&&this.antialias){const n=this.gl;n.bindFramebuffer(n.READ_FRAMEBUFFER,this.aaFramebuffer),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.framebuffer);const s={colorTexture:[n.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]};this.useDepth&&(s.depthTexture=[n.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter]);const[i,a]=s[t];n.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,i,a),this.dirty[t]=!1;const o=this.renderer.activeFramebuffer();o?n.bindFramebuffer(n.FRAMEBUFFER,o._framebufferToBind()):n.bindFramebuffer(n.FRAMEBUFFER,null)}}_beforeBegin(){const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebufferToBind()),this.renderer.viewport(this.width*this.density,this.height*this.density)}_beforeEnd(){this.antialias&&(this.dirty={colorTexture:!0,depthTexture:!0})}end(){const t=this.gl;if(this.renderer.pop(),this.renderer.activeFramebuffers.pop()!==this)throw new Error("It looks like you've called end() while another Framebuffer is active.");this._beforeEnd(),this.prevFramebuffer?this.prevFramebuffer._beforeBegin():(t.bindFramebuffer(t.FRAMEBUFFER,null),this.renderer.viewport(this.renderer._origViewport.width,this.renderer._origViewport.height)),this.renderer._applyStencilTestIfClipping()}draw(t){this.begin(),t(),this.end()}loadPixels(){this._update("colorTexture");const t=this.gl,n=this.renderer.activeFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer);const s=this._glColorFormat();this.pixels=J_(this.pixels,t,this.framebuffer,0,0,this.width*this.density,this.height*this.density,s.format,s.type),n?t.bindFramebuffer(t.FRAMEBUFFER,n._framebufferToBind()):t.bindFramebuffer(t.FRAMEBUFFER,null)}get(t,n,s,i){this._update("colorTexture");const a=this._glColorFormat();if(t===void 0&&n===void 0)t=0,n=0,s=this.width,i=this.height;else if(s===void 0&&i===void 0)return(t<0||n<0||t>=this.width||n>=this.height)&&(console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped."),t=vf(t,0,this.width-1),n=vf(n,0,this.height-1)),G8(this.gl,this.framebuffer,t*this.density,n*this.density,a.format,a.type);t=vf(t,0,this.width-1),n=vf(n,0,this.height-1),s=vf(s,1,this.width-t),i=vf(i,1,this.height-n);const o=J_(void 0,this.gl,this.framebuffer,t*this.density,n*this.density,s*this.density,i*this.density,a.format,a.type),u=new Uint8ClampedArray(s*i*this.density*this.density*4);u.fill(255);const l=a.type===this.gl.RGB?3:4;for(let h=0;h<i*this.density;h++)for(let f=0;f<s*this.density;f++)for(let p=0;p<4;p++){const g=(h*s*this.density+f)*4+p;if(p<l){const y=l===4?g:(h*s*this.density+f)*l+p;u[g]=o[y]}}const c=new kl(s*this.density,i*this.density);return c.imageData=c.canvas.getContext("2d").createImageData(c.width,c.height),c.imageData.data.set(u),c.pixels=c.imageData.data,c.updatePixels(),this.density!==1&&c.resize(s,i),c}updatePixels(){const t=this.gl;this.colorP5Texture.bindTexture();const n=this._glColorFormat(),s=n.format===t.RGBA?4:3,i=this.width*this.height*this.density*this.density*s,a=n.type===t.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(this.pixels instanceof a)||this.pixels.length!==i)throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().");t.texImage2D(t.TEXTURE_2D,0,n.internalFormat,this.width*this.density,this.height*this.density,0,n.format,n.type,this.pixels),this.colorP5Texture.unbindTexture(),this.dirty.colorTexture=!1;const o=this.renderer.activeFramebuffer();this.antialias?(this.begin(),this.renderer.push(),this.renderer.states.setValue("imageMode",Yi),this.renderer.setCamera(this.filterCamera),this.renderer.resetMatrix(),this.renderer.states.setValue("strokeColor",null),this.renderer.clear(),this.renderer._drawingFilter=!0,this.renderer.image(this,0,0,this.width,this.height,-this.renderer.width/2,-this.renderer.height/2,this.renderer.width,this.renderer.height),this.renderer._drawingFilter=!1,this.renderer.pop(),this.useDepth&&(t.clearDepth(1),t.clear(t.DEPTH_BUFFER_BIT)),this.end()):(t.bindFramebuffer(t.FRAMEBUFFER,this.framebuffer),this.useDepth&&(t.clearDepth(1),t.clear(t.DEPTH_BUFFER_BIT)),o?t.bindFramebuffer(t.FRAMEBUFFER,o._framebufferToBind()):t.bindFramebuffer(t.FRAMEBUFFER,null))}}function K8(r,t){r.FramebufferCamera=q8,r.FramebufferTexture=Mx,r.Framebuffer=Ha}typeof p5<"u"&&K8(p5,p5.prototype);let tx;function X8(r,t){tx=r.renderers={},t.createCanvas=function(n,s,i,...a){let o=jc;return Reflect.ownKeys(tx).includes(i)?o=i:a.unshift(i),this._renderer&&this._renderer.remove(),this._renderer=new tx[o](this,n,s,!0,...a),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer),this._renderer._applyDefaults(),Object.hasOwn(this,"pixels")||Object.defineProperty(this,"pixels",{get(){var u;return(u=this._renderer)==null?void 0:u.pixels}}),this._renderer},t.resizeCanvas=function(n,s,i){this._renderer&&(this._renderer.resize(n,s),i||this.redraw()),this._addAccsOutput()&&this._updateAccsOutput()},t.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},t.createGraphics=function(n,s,...i){return i[0]instanceof HTMLCanvasElement&&(i[1]=i[0],i[0]=jc),new r.Graphics(n,s,i[0],this,i[1])},t.createFramebuffer=function(n){return new Ha(this._renderer,n)},t.clearDepth=function(n){this._assert3d("clearDepth"),this._renderer.clearDepth(n)}}typeof p5<"u"&&X8(p5,p5.prototype);class mJ{constructor(t){this.pInst=t,this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height;let n=Qr;if(this.gl=this.canvas.getContext("webgl2"),this.gl||(n=Nl,this.gl=this.canvas.getContext("webgl")),!this.gl){console.error("WebGL not supported, cannot apply filter.");return}this._renderer={GL:this.gl,registerEnabled:new Set,_curShader:null,_emptyTexture:null,webglVersion:n,states:{textureWrapX:this.gl.CLAMP_TO_EDGE,textureWrapY:this.gl.CLAMP_TO_EDGE},_arraysEqual:(s,i)=>JSON.stringify(s)===JSON.stringify(i),_getEmptyTexture:()=>{if(!this._emptyTexture){const s=new kl(1,1);s.set(0,0,255),this._emptyTexture=new bu(this._renderer,s)}return this._emptyTexture}},this._baseFilterShader=void 0,this.filterShaderSources={[id]:R8,[eT]:L8,[Jb]:B8,[nT]:$8,[QD]:I8,[tT]:F8,[ev]:O8,[JD]:M8},this.filterShaders={},this.operation=null,this.filterParameter=1,this.customShader=null,this._shader=null,this.vertexBuffer=this.gl.createBuffer(),this.texcoordBuffer=this.gl.createBuffer(),this.vertices=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.texcoords=new Float32Array([0,1,1,1,0,0,1,0]),this._bindBufferData(this.vertexBuffer,this.gl.ARRAY_BUFFER,this.vertices),this._bindBufferData(this.texcoordBuffer,this.gl.ARRAY_BUFFER,this.texcoords)}_webGL2CompatibilityPrefix(t,n){let s="";return this._renderer.webglVersion===Qr&&(s+=`#version 300 es
#define WEBGL2
`),t==="vert"?s+=`#define VERTEX_SHADER
`:t==="frag"&&(s+=`#define FRAGMENT_SHADER
`),n&&(s+=`precision ${n} float;
`),s}baseFilterShader(){return this._baseFilterShader||(this._baseFilterShader=new Ns(this._renderer,this._webGL2CompatibilityPrefix("vert","highp")+Q_+k8,this._webGL2CompatibilityPrefix("frag","highp")+Q_+A8,{vertex:{},fragment:{"vec4 getColor":`(FilterInputs inputs, in sampler2D canvasContent) {
                return getTexture(canvasContent, inputs.texCoord);
              }`}})),this._baseFilterShader}setOperation(t,n,s=null){this.operation=t,this.filterParameter=n,t in Rx&&n===void 0&&(this.filterParameter=Rx[t]),this.customShader=s,this._initializeShader()}_initializeShader(){if(this.customShader){this._shader=this.customShader;return}if(!this.operation){console.error("No operation set for FilterRenderer2D, cannot initialize shader.");return}if(this.filterShaders[this.operation]){this._shader=this.filterShaders[this.operation];return}const t=this.filterShaderSources[this.operation];if(!t){console.error("No shader available for this operation:",this.operation);return}const n=new Ns(this._renderer,P8,t);this.filterShaders[this.operation]=n,this._shader=n}_bindBufferData(t,n,s){const i=this.gl;i.bindBuffer(n,t),i.bufferData(n,s,i.STATIC_DRAW)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new bu(this._renderer,this.pInst.wrappedElt)),this._canvasTexture}_renderPass(){const t=this.gl;this._shader.bindShader();const n=this.pInst.pixelDensity?this.pInst.pixelDensity():1,s=[1/(this.pInst.width*n),1/(this.pInst.height*n)],i=this.canvasTexture;this._shader.setUniform("tex0",i),this._shader.setUniform("texelSize",s),this._shader.setUniform("canvasSize",[this.pInst.width,this.pInst.height]),this._shader.setUniform("radius",Math.max(1,this.filterParameter)),this._shader.setUniform("filterParameter",this.filterParameter),this._shader.setDefaultUniforms(),this.pInst.states.setValue("rectMode",Yi),this.pInst.states.setValue("imageMode",Yi),this.pInst.blendMode(ci),this.pInst.resetMatrix();const a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this._shader.setUniform("uModelViewMatrix",a),this._shader.setUniform("uProjectionMatrix",a),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this._shader.enableAttrib(this._shader.attributes.aPosition,2),t.bindBuffer(t.ARRAY_BUFFER,this.texcoordBuffer),this._shader.enableAttrib(this._shader.attributes.aTexCoord,2),this._shader.bindTextures(),this._shader.disableRemainingAttributes(),t.drawArrays(t.TRIANGLE_STRIP,0,4),this._shader.unbindShader()}applyFilter(){if(!this._shader){console.error("Cannot apply filter: shader not initialized.");return}this.pInst.push(),this.pInst.resetMatrix(),this.operation===id&&!this.customShader?(this._shader.setUniform("direction",[1,0]),this._renderPass(),this.pInst.clear(),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height),this._shader.setUniform("direction",[0,1]),this._renderPass(),this.pInst.clear(),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height)):(this._renderPass(),this.pInst.clear(),this.pInst.blendMode(ci),this.pInst.drawingContext.drawImage(this.canvas,0,0,this.pInst.width,this.pInst.height)),this.pInst.pop()}}const po="rgba(0,0,0,0)";class CC extends Pt{constructor(t,n,s,i,a,o={}){super(t,n,s,i),this.canvas=this.elt=a||document.createElement("canvas"),i?(this._pInst._curElement=this,this._pInst.canvas=this.canvas):this.canvas.style.display="none",this.elt.id="defaultCanvas0",this.elt.classList.add("p5Canvas");for(const u of Object.getOwnPropertyNames(vn.prototype))u!=="constructor"&&u[0]!=="_"&&Object.defineProperty(this,u,{get(){return this.wrappedElt[u]}});if(this.elt.width=n*this._pixelDensity,this.elt.height=s*this._pixelDensity,this.elt.style.width=`${n}px`,this.elt.style.height=`${s}px`,this._pInst._userNode)this._pInst._userNode.appendChild(this.elt);else{if(document.getElementsByTagName("main").length===0){let u=document.createElement("main");document.body.appendChild(u)}document.getElementsByTagName("main")[0].appendChild(this.elt)}this.drawingContext=this.canvas.getContext("2d",o),o.colorSpace==="display-p3"&&(this.states.colorMode=ui),this.scale(this._pixelDensity,this._pixelDensity),this.filterRenderer||(this.filterRenderer=new mJ(this)),this.wrappedElt=new vn(this.elt,this._pInst),this.clipPath=null}remove(){this.wrappedElt.remove(),this.wrappedElt=null,this.canvas=null,this.elt=null}getFilterGraphicsLayer(){if(!this.filterGraphicsLayer){const t=this._pInst;this.filterGraphicsLayer=new ud(this.width,this.height,Nl,t)}return(this.filterGraphicsLayer.width!==this.width||this.filterGraphicsLayer.height!==this.height)&&this.filterGraphicsLayer.resizeCanvas(this.width,this.height),this.filterGraphicsLayer.pixelDensity()!==this._pInst.pixelDensity()&&this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity()),this.filterGraphicsLayer}_applyDefaults(){this.states.setValue("_cachedFillStyle",void 0),this.states.setValue("_cachedStrokeStyle",void 0),this._cachedBlendMode=ci,this._setFill(p6),this._setStroke(d6),this.drawingContext.lineCap=vl,this.drawingContext.font="normal 12px sans-serif"}resize(t,n){super.resize(t,n);const s={};for(const i in this.drawingContext){const a=this.drawingContext[i];typeof a!="object"&&typeof a!="function"&&(s[i]=a)}this.canvas.width=t*this._pixelDensity,this.canvas.height=n*this._pixelDensity,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${n}px`,this.drawingContext.scale(this._pixelDensity,this._pixelDensity);for(const i in s)try{this.drawingContext[i]=s[i]}catch{}}background(...t){if(this.push(),this.resetMatrix(),t[0]instanceof kl)if(t[1]>=0){const n=t[0];this.drawingContext.globalAlpha=t[1]/255,this._pInst.image(n,0,0,this.width,this.height)}else this._pInst.image(t[0],0,0,this.width,this.height);else{const n=this._pInst.color(...t);this._pInst._addAccsOutput()&&this._pInst._accsBackground(n._getRGBA([255,255,255,255]));const s=n.toString();this._setFill(s),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._isErasing&&this._pInst.erase()}this.pop()}clear(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()}fill(...t){super.fill(...t);const n=this.states.fillColor;this._setFill(n.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",n._getRGBA([255,255,255,255]))}stroke(...t){super.stroke(...t);const n=this.states.strokeColor;this._setStroke(n.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",n._getRGBA([255,255,255,255]))}erase(t,n){if(!this._isErasing){this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle);const s=this._pInst.color(255,t).toString();this.drawingContext.fillStyle=s,this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle);const i=this._pInst.color(255,n).toString();this.drawingContext.strokeStyle=i;const a=this._cachedBlendMode;this.blendMode(Hc),this._cachedBlendMode=a,this._isErasing=!0}}noErase(){this._isErasing&&(this.drawingContext.fillStyle=this.states._cachedFillStyle,this.drawingContext.strokeStyle=this.states._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)}drawShape(t){const n=new a8({strokeWeight:this.states.strokeWeight});t.accept(n),this._clipping?(this.clipPath.addPath(n.path),this.clipPath.closePath()):(this.states.fillColor&&this.drawingContext.fill(n.path),this.states.strokeColor&&this.drawingContext.stroke(n.path))}beginClip(t={}){super.beginClip(t),this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle);const n=this._pInst.color(255,0).toString();this.drawingContext.fillStyle=n,this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle);const s=this._pInst.color(255,0).toString();this.drawingContext.strokeStyle=s;const i=this._cachedBlendMode;this.blendMode(ci),this._cachedBlendMode=i,this.clipPath=new Path2D,this._clipInvert&&(this.clipPath.moveTo(-2*this.width,-2*this.height),this.clipPath.lineTo(-2*this.width,2*this.height),this.clipPath.lineTo(2*this.width,2*this.height),this.clipPath.lineTo(2*this.width,-2*this.height),this.clipPath.closePath())}endClip(){this.drawingContext.clip(this.clipPath),this.clipPath=null,super.endClip(),this.drawingContext.fillStyle=this.states._cachedFillStyle,this.drawingContext.strokeStyle=this.states._cachedStrokeStyle,this.blendMode(this._cachedBlendMode)}image(t,n,s,i,a,o,u,l,c){let h;t.gifProperties&&t._animateGif(this._pInst);try{t instanceof Ym&&t._ensureCanvas(),this.states.tint&&t.canvas&&(h=this._getTintedImageCanvas(t)),h||(h=t.canvas||t.elt);let f=1;t.width&&t.width>0&&(f=h.width/t.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(h,f*n,f*s,f*i,f*a,o,u,l,c),this._isErasing&&this._pInst.erase()}catch(f){if(f.name!=="NS_ERROR_NOT_AVAILABLE")throw f}}_getTintedImageCanvas(t){if(!t.canvas)return t;t.tintCanvas||(t.tintCanvas=document.createElement("canvas")),t.tintCanvas.width!==t.canvas.width&&(t.tintCanvas.width=t.canvas.width),t.tintCanvas.height!==t.canvas.height&&(t.tintCanvas.height=t.canvas.height);const n=t.tintCanvas.getContext("2d");return n.save(),n.clearRect(0,0,t.canvas.width,t.canvas.height),this.states.tint[0]<255||this.states.tint[1]<255||this.states.tint[2]<255?(n.drawImage(t.canvas,0,0),n.globalCompositeOperation="luminosity",n.drawImage(t.canvas,0,0),n.globalCompositeOperation="color",n.drawImage(t.canvas,0,0),n.globalCompositeOperation="multiply",n.fillStyle=`rgb(${this.states.tint.slice(0,3).join(", ")})`,n.fillRect(0,0,t.canvas.width,t.canvas.height),n.globalCompositeOperation="destination-in",n.globalAlpha=this.states.tint[3]/255,n.drawImage(t.canvas,0,0)):(n.globalAlpha=this.states.tint[3]/255,n.drawImage(t.canvas,0,0)),n.restore(),t.tintCanvas}blendMode(t){if(t===Kb)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else if(t===ci||t===Hc||t===Hb||t===qb||t===u6||t===Yb||t===Xb||t===Zb||t===Qb||t===qD||t===KD||t===XD||t===YD||t===ZD||t===Wm)this._cachedBlendMode=t,this.drawingContext.globalCompositeOperation=t;else throw new Error(`Mode ${t} not recognized.`)}blend(...t){const n=this.drawingContext.globalCompositeOperation,s=t[t.length-1],i=Array.prototype.slice.call(t,0,t.length-1);this.drawingContext.globalCompositeOperation=s,jn.prototype.copy.apply(this,i),this.drawingContext.globalCompositeOperation=n}_getPixel(t,n){let s,i;return s=this.drawingContext.getImageData(t,n,1,1).data,i=0,[s[i+0],s[i+1],s[i+2],s[i+3]]}loadPixels(){const t=this._pixelDensity,n=this.width*t,s=this.height*t,i=this.drawingContext.getImageData(0,0,n,s);this.imageData=i,this.pixels=i.data}set(t,n,s){if(t=Math.floor(t),n=Math.floor(n),s instanceof kl)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this.drawingContext.clearRect(t,n,s.width,s.height),this.drawingContext.drawImage(s.canvas,t,n),this.drawingContext.restore();else{let i=0,a=0,o=0,u=0,l=4*(n*this._pixelDensity*(this.width*this._pixelDensity)+t*this._pixelDensity);if(this.imageData||this.loadPixels(),typeof s=="number")l<this.pixels.length&&(i=s,a=s,o=s,u=255);else if(Array.isArray(s)){if(s.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");l<this.pixels.length&&(i=s[0],a=s[1],o=s[2],u=s[3])}else s instanceof jn.Color&&l<this.pixels.length&&([i,a,o,u]=s._getRGBA([255,255,255,255]));for(let c=0;c<this._pixelDensity;c++)for(let h=0;h<this._pixelDensity;h++)l=4*((n*this._pixelDensity+h)*this.width*this._pixelDensity+(t*this._pixelDensity+c)),this.pixels[l]=i,this.pixels[l+1]=a,this.pixels[l+2]=o,this.pixels[l+3]=u}}updatePixels(t,n,s,i){const a=this._pixelDensity;t===void 0&&n===void 0&&s===void 0&&i===void 0&&(t=0,n=0,s=this.width,i=this.height),t*=a,n*=a,s*=a,i*=a,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=this.imageData),this.drawingContext.putImageData(this.imageData,0,0,t,n,s,i)}arc(t,n,s,i,a,o,u){const l=this.clipPa||this.drawingContext,c=t+s/2,h=n+i/2,f=s/2,p=i/2,g=!(u===Ex||u===Wc||(o-a)%ai===0);return this.states.fillColor&&(this._clipping||l.beginPath(),l.ellipse(c,h,f,p,0,a,o),g&&l.lineTo(c,h),l.closePath(),this._clipping||l.fill()),this.states.strokeColor&&(this._clipping||l.beginPath(),l.ellipse(c,h,f,p,0,a,o),u===jm&&g&&l.lineTo(c,h),(u===jm||u===Ex)&&l.closePath(),this._clipping||l.stroke()),this}ellipse(t){const n=this.clipPath||this.drawingContext,s=!!this.states.fillColor,i=this.states.strokeColor,a=parseFloat(t[0]),o=parseFloat(t[1]),u=parseFloat(t[2]),l=parseFloat(t[3]);if(s&&!i){if(this._getFill()===po)return this}else if(!s&&i&&this._getStroke()===po)return this;const c=a+u/2,h=o+l/2,f=u/2,p=l/2;this._clipping||n.beginPath(),n.ellipse(c,h,f,p,0,0,2*Math.PI),n.closePath(),!this._clipping&&s&&n.fill(),!this._clipping&&i&&n.stroke()}line(t,n,s,i){const a=this.clipPath||this.drawingContext;if(this.states.strokeColor){if(this._getStroke()===po)return this}else return this;return this._clipping||a.beginPath(),a.moveTo(t,n),a.lineTo(s,i),a.stroke(),this}point(t,n){const s=this.clipPath||this.drawingContext;if(this.states.strokeColor){if(this._getStroke()===po)return this}else return this;const i=this._getStroke(),a=this._getFill();this._clipping||this._setFill(i),this._clipping||s.beginPath(),s.arc(t,n,s.lineWidth/2,0,ai,!1),this._clipping||(s.fill(),this._setFill(a))}quad(t,n,s,i,a,o,u,l){const c=this.clipPath||this.drawingContext,h=!!this.states.fillColor,f=this.states.strokeColor;if(h&&!f){if(this._getFill()===po)return this}else if(!h&&f&&this._getStroke()===po)return this;return this._clipping||c.beginPath(),c.moveTo(t,n),c.lineTo(s,i),c.lineTo(a,o),c.lineTo(u,l),c.closePath(),!this._clipping&&h&&c.fill(),!this._clipping&&f&&c.stroke(),this}rect(t){const n=t[0],s=t[1],i=t[2],a=t[3];let o=t[4],u=t[5],l=t[6],c=t[7];const h=this.clipPath||this.drawingContext,f=!!this.states.fillColor,p=this.states.strokeColor;if(f&&!p){if(this._getFill()===po)return this}else if(!f&&p&&this._getStroke()===po)return this;if(this._clipping||h.beginPath(),typeof o>"u")h.rect(n,s,i,a);else{typeof u>"u"&&(u=o),typeof l>"u"&&(l=u),typeof c>"u"&&(c=l);const g=Math.abs(i),y=Math.abs(a),x=g/2,v=y/2;g<2*o&&(o=x),y<2*o&&(o=v),g<2*u&&(u=x),y<2*u&&(u=v),g<2*l&&(l=x),y<2*l&&(l=v),g<2*c&&(c=x),y<2*c&&(c=v),h.roundRect(n,s,i,a,[o,u,l,c])}return!this._clipping&&this.states.fillColor&&h.fill(),!this._clipping&&this.states.strokeColor&&h.stroke(),this}triangle(t){const n=this.clipPath||this.drawingContext,s=!!this.states.fillColor,i=this.states.strokeColor,a=t[0],o=t[1],u=t[2],l=t[3],c=t[4],h=t[5];if(s&&!i){if(this._getFill()===po)return this}else if(!s&&i&&this._getStroke()===po)return this;this._clipping||n.beginPath(),n.moveTo(a,o),n.lineTo(u,l),n.lineTo(c,h),n.closePath(),!this._clipping&&s&&n.fill(),!this._clipping&&i&&n.stroke()}strokeCap(t){return(t===vl||t===jD||t===GD)&&(this.drawingContext.lineCap=t),this}strokeJoin(t){return(t===vl||t===WD||t===HD)&&(this.drawingContext.lineJoin=t),this}strokeWeight(t){return super.strokeWeight(t),typeof t>"u"||t===0?this.drawingContext.lineWidth=1e-4:this.drawingContext.lineWidth=t,this}_getFill(){return this.states._cachedFillStyle||this.states.setValue("_cachedFillStyle",this.drawingContext.fillStyle),this.states._cachedFillStyle}_setFill(t){t!==this.states._cachedFillStyle&&(this.drawingContext.fillStyle=t,this.states.setValue("_cachedFillStyle",t))}_getStroke(){return this.states._cachedStrokeStyle||this.states.setValue("_cachedStrokeStyle",this.drawingContext.strokeStyle),this.states._cachedStrokeStyle}_setStroke(t){t!==this.states._cachedStrokeStyle&&(this.drawingContext.strokeStyle=t,this.states.setValue("_cachedStrokeStyle",t))}applyMatrix(t,n,s,i,a,o){this.drawingContext.transform(t,n,s,i,a,o)}getWorldToScreenMatrix(){let t=new DOMMatrix().scale(1/this._pixelDensity).multiply(this.drawingContext.getTransform());return new zr(t.toFloat32Array())}resetMatrix(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pixelDensity,this._pixelDensity),this}rotate(t){this.drawingContext.rotate(t)}scale(t,n){return this.drawingContext.scale(t,n),this}translate(t,n){return t instanceof jn.Vector&&(n=t.y,t=t.x),this.drawingContext.translate(t,n),this}push(){return this.drawingContext.save(),super.push()}pop(t){this.drawingContext.restore(),super.pop(t)}}function gJ(r,t){r.Renderer2D=CC,r.renderers[jc]=CC,r.renderers["p2d-hdr"]=new Proxy(CC,{construct(n,[s,i,a,o,u]){return new n(s,i,a,o,u,{colorSpace:"display-p3"})}})}var Fr,bh,eE,Y8;let jn=(Fr=class{constructor(t,n){Jn(this,bh);this.hitCriticalError=!1,this._setupDone=!1,this._userNode=n,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._isGlobal=!1,this._loop=!0,this._startListener=null,this._initializeInstanceVariables(),this._events={pointerdown:null,pointerup:null,pointermove:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,wheel:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this._lcg_random_state=null,this._gaussian_previous=!1,window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._updateWindowSize();const s=o=>{Object.defineProperty(window,o,{configurable:!0,enumerable:!0,get:()=>typeof this[o]=="function"?this[o].bind(this):this[o],set:u=>{Object.defineProperty(window,o,{configurable:!0,enumerable:!0,value:u,writable:!0}),Fr.disableFriendlyErrors||console.log(`You just changed the value of "${o}", which was a p5 global value. This could cause problems later if you're not careful.`)}})};if(t)t(this),Fr._checkForUserDefinedFunctions(this);else{if(this._isGlobal=!0,window.hitCriticalError)return;Fr.instance=this;for(const u of Object.getOwnPropertyNames(Fr.prototype))u[0]!=="_"&&s(u);const o=["constructor","length"];for(const u in this)if(this.hasOwnProperty(u)){if(u[0]==="_"||o.includes(u))continue;s(u)}}for(const o in this._events){const u=this[`_on${o}`];if(u){const l=u.bind(this);window.addEventListener(o,l,{passive:!1}),this._events[o]=l}}const i=()=>{this.focused=!0},a=()=>{this.focused=!1};window.addEventListener("focus",i),window.addEventListener("blur",a),Fr.lifecycleHooks.remove.push(function(){window.removeEventListener("focus",i),window.removeEventListener("blur",a)}),document.readyState==="complete"?Yr(this,bh,eE).call(this):(this._startListener=Yr(this,bh,eE).bind(this),window.addEventListener("load",this._startListener,!1))}get pixels(){return this._renderer.pixels}get drawingContext(){return this._renderer.drawingContext}static registerAddon(t){const n={};t(Fr,Fr.prototype,n);const s=Object.keys(Fr.lifecycleHooks);for(const i of s)typeof n[i]=="function"&&Fr.lifecycleHooks[i].push(n[i])}async _draw(t){if(this.hitCriticalError)return;const n=t||window.performance.now(),s=n-this._lastTargetFrameTime,i=1e3/this._targetFrameRate;(!this._loop||s>=i-5)&&(this.deltaTime=n-this._lastRealFrameTime,this._frameRate=1e3/this.deltaTime,await this.redraw(),this._lastTargetFrameTime=Math.max(this._lastTargetFrameTime+i,n),this._lastRealFrameTime=n,typeof this._updateMouseCoords<"u"&&(this._updateMouseCoords(),this.movedX=0,this.movedY=0)),this._loop&&(this._requestAnimId=window.requestAnimationFrame(this._draw.bind(this)))}async remove(){if(this._startListener&&window.removeEventListener("load",this._startListener,!1),this._curElement){this._loop=!1,this._requestAnimId&&window.cancelAnimationFrame(this._requestAnimId);for(const t in this._events)window.removeEventListener(t,this._events[t]);for(const t of this._elements){t.elt&&t.elt.parentNode&&t.elt.parentNode.removeChild(t.elt);for(const n in t._events)t.elt.removeEventListener(n,t._events[n])}await this._runLifecycleHook("remove")}if(this._isGlobal){for(const t in Fr.prototype)try{delete window[t]}catch{window[t]=void 0}for(const t in this)if(this.hasOwnProperty(t))try{delete window[t]}catch{window[t]=void 0}Fr.instance=null}}async _runLifecycleHook(t){for(const n of Fr.lifecycleHooks[t])await n.call(this)}_initializeInstanceVariables(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._downKeys={},this._downKeyCodes={}}},bh=new WeakSet,eE=async function(){this.hitCriticalError||(this._userNode&&typeof this._userNode=="string"&&(this._userNode=document.getElementById(this._userNode)),await Yr(this,bh,Y8).call(this),!this.hitCriticalError&&(this._recording||this._draw()))},Y8=async function(){if(await this._runLifecycleHook("presetup"),this.hitCriticalError)return;this.createCanvas(100,100,jc),this._millisStart=window.performance.now();const t=this._isGlobal?window:this;if(typeof t.setup=="function"&&await t.setup(),this.hitCriticalError)return;const n=document.getElementsByTagName("canvas");if(Object.keys(this._events).some(s=>s.startsWith("pointer")))for(const s of n)s.style.touchAction="none";for(const s of n)s.dataset.hidden==="true"&&(s.style.visibility="",delete s.dataset.hidden);this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),this._setupDone=!0,(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),await this._runLifecycleHook("postsetup")},Bt(Fr,"VERSION",QL),Bt(Fr,"instance",null),Bt(Fr,"lifecycleHooks",{presetup:[],postsetup:[],predraw:[],postdraw:[],remove:[]}),Bt(Fr,"_checkForUserDefinedFunctions",()=>{}),Bt(Fr,"_friendlyFileLoadError",()=>{}),Fr);for(const r in qc)jn.prototype[r]=qc[r];jn.disableFriendlyErrors=!1;jn.registerAddon(rT);jn.registerAddon(b6);jn.registerAddon(w6);jn.registerAddon(X8);jn.registerAddon(bQ);jn.registerAddon(gJ);jn.registerAddon(pJ);function yJ(r){r.registerAddon(cT),r.registerAddon(hT),r.registerAddon(fT),r.registerAddon(dT),r.registerAddon(oT)}function Z8(r,t){const n="_Description",s="_fallbackDesc",i="_fallbackTable",a="_fte_",o="_Label",u="_labelDesc",l="_labelTable",c="_lte_";t.describe=function(p,g){if(typeof p!="string")return;const y=this.canvas.id;p=h(p),this.dummyDOM||(this.dummyDOM=document.getElementById(y).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==p&&(this.descriptions.fallback.innerHTML=p):this._describeHTML("fallback",p),g===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==p&&(this.descriptions.label.innerHTML=p):this._describeHTML("label",p))},t.describeElement=function(p,g,y){if(typeof g!="string"||typeof p!="string")return;const x=this.canvas.id;g=h(g);let v=f(p);p=p.replace(/[^a-zA-Z0-9]/g,"");let S=`<th scope="row">${v}</th><td>${g}</td>`;this.dummyDOM||(this.dummyDOM=document.getElementById(x).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[p]?this.descriptions.fallbackElements[p].innerHTML!==S&&(this.descriptions.fallbackElements[p].innerHTML=S):this._describeElementHTML("fallback",p,S),y===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[p]?this.descriptions.labelElements[p].innerHTML!==S&&(this.descriptions.labelElements[p].innerHTML=S):this._describeElementHTML("label",p,S))};function h(p){if(p==="label"||p==="fallback")throw new Error("description should not be LABEL or FALLBACK");return!p.endsWith(".")&&!p.endsWith(";")&&!p.endsWith(",")&&!p.endsWith("?")&&!p.endsWith("!")&&(p=p+"."),p}t._describeHTML=function(p,g){const y=this.canvas.id;if(p==="fallback"){if(this.dummyDOM.querySelector(`#${y+n}`))this.dummyDOM.querySelector("#"+y+i).insertAdjacentHTML("beforebegin",`<p id="${y+s}"></p>`);else{let x=`<div id="${y}${n}" role="region" aria-label="Canvas Description"><p id="${y}${s}"></p></div>`;this.dummyDOM.querySelector(`#${y}accessibleOutput`)?this.dummyDOM.querySelector(`#${y}accessibleOutput`).insertAdjacentHTML("beforebegin",x):this.dummyDOM.querySelector(`#${y}`).innerHTML=x}this.descriptions.fallback=this.dummyDOM.querySelector(`#${y}${s}`),this.descriptions.fallback.innerHTML=g;return}else if(p==="label"){if(this.dummyDOM.querySelector(`#${y+o}`))this.dummyDOM.querySelector(`#${y+l}`)&&this.dummyDOM.querySelector(`#${y+l}`).insertAdjacentHTML("beforebegin",`<p id="${y}${u}"></p>`);else{let x=`<div id="${y}${o}" class="p5Label"><p id="${y}${u}"></p></div>`;this.dummyDOM.querySelector(`#${y}accessibleOutputLabel`)?this.dummyDOM.querySelector(`#${y}accessibleOutputLabel`).insertAdjacentHTML("beforebegin",x):this.dummyDOM.querySelector("#"+y).insertAdjacentHTML("afterend",x)}this.descriptions.label=this.dummyDOM.querySelector("#"+y+u),this.descriptions.label.innerHTML=g;return}};function f(p){if(p==="label"||p==="fallback")throw new Error("element name should not be LABEL or FALLBACK");return p.endsWith(".")||p.endsWith(";")||p.endsWith(",")?p=p.replace(/.$/,":"):p.endsWith(":")||(p=p+":"),p}t._describeElementHTML=function(p,g,y){const x=this.canvas.id;if(p==="fallback"){if(this.dummyDOM.querySelector(`#${x+n}`))this.dummyDOM.querySelector("#"+x+i)||this.dummyDOM.querySelector("#"+x+s).insertAdjacentHTML("afterend",`<table id="${x}${i}"><caption>Canvas elements and their descriptions</caption></table>`);else{let S=`<div id="${x}${n}" role="region" aria-label="Canvas Description"><table id="${x}${i}"><caption>Canvas elements and their descriptions</caption></table></div>`;this.dummyDOM.querySelector(`#${x}accessibleOutput`)?this.dummyDOM.querySelector(`#${x}accessibleOutput`).insertAdjacentHTML("beforebegin",S):this.dummyDOM.querySelector("#"+x).innerHTML=S}let v=document.createElement("tr");v.id=x+a+g,this.dummyDOM.querySelector("#"+x+i).appendChild(v),this.descriptions.fallbackElements[g]=this.dummyDOM.querySelector(`#${x}${a}${g}`),this.descriptions.fallbackElements[g].innerHTML=y;return}else if(p==="label"){if(this.dummyDOM.querySelector(`#${x+o}`))this.dummyDOM.querySelector(`#${x+l}`)||this.dummyDOM.querySelector("#"+x+u).insertAdjacentHTML("afterend",`<table id="${x+l}"></table>`);else{let S=`<div id="${x}${o}" class="p5Label"><table id="${x}${l}"></table></div>`;this.dummyDOM.querySelector(`#${x}accessibleOutputLabel`)?this.dummyDOM.querySelector(`#${x}accessibleOutputLabel`).insertAdjacentHTML("beforebegin",S):this.dummyDOM.querySelector("#"+x).insertAdjacentHTML("afterend",S)}let v=document.createElement("tr");v.id=x+c+g,this.dummyDOM.querySelector("#"+x+l).appendChild(v),this.descriptions.labelElements[g]=this.dummyDOM.querySelector(`#${x}${c}${g}`),this.descriptions.labelElements[g].innerHTML=y}}}typeof p5<"u"&&Z8(p5,p5.prototype);function Q8(r,t){t._updateGridOutput=function(a){if(!this.dummyDOM.querySelector(`#${a}_summary`))return;let o=this._accessibleOutputs[a],u=i(a,this.ingredients.shapes),l=s(u.numShapes,this.ingredients.colors.background,this.width,this.height),c=n(a,this.ingredients.shapes);l!==o.summary.innerHTML&&(o.summary.innerHTML=l),c!==o.map.innerHTML&&(o.map.innerHTML=c),u.details!==o.shapeDetails.innerHTML&&(o.shapeDetails.innerHTML=u.details),this._accessibleOutputs[a]=o};function n(a,o){let u=0,l="",c=Array.from(Array(10),()=>Array(10));for(let h in o)for(let f in o[h]){let p;h!=="line"?p=`<a href="#${a}shape${u}">${o[h][f].color} ${h}</a>`:p=`<a href="#${a}shape${u}">${o[h][f].color} ${h} midpoint</a>`,o[h][f].loc.locY<c.length&&o[h][f].loc.locX<c[o[h][f].loc.locY].length&&(c[o[h][f].loc.locY][o[h][f].loc.locX]?c[o[h][f].loc.locY][o[h][f].loc.locX]=c[o[h][f].loc.locY][o[h][f].loc.locX]+"  "+p:c[o[h][f].loc.locY][o[h][f].loc.locX]=p,u++)}for(let h in c){let f="<tr>";for(let p in c[h])f=f+"<td>",c[h][p]!==void 0&&(f=f+c[h][p]),f=f+"</td>";l=l+f+"</tr>"}return l}function s(a,o,u,l){let c=`${o} canvas, ${u} by ${l} pixels, contains ${a[0]}`;return a[0]===1?c=`${c} shape: ${a[1]}`:c=`${c} shapes: ${a[1]}`,c}function i(a,o){let u="",l="",c=0;for(let h in o){let f=0;for(let p in o[h]){let g=`<li id="${a}shape${c}">${o[h][p].color} ${h},`;h==="line"?g=g+` location = ${o[h][p].pos}, length = ${o[h][p].length} pixels`:(g=g+` location = ${o[h][p].pos}`,h!=="point"&&(g=g+`, area = ${o[h][p].area} %`),g=g+"</li>"),u=u+g,f++,c++}f>1?l=`${l} ${f} ${h}s`:l=`${l} ${f} ${h}`}return{numShapes:[c,l],details:u}}}typeof p5<"u"&&Q8(p5,p5.prototype);function J8(r,t){t._updateTextOutput=function(a){if(!this.dummyDOM.querySelector(`#${a}_summary`))return;let o=this._accessibleOutputs[a],u=i(a,this.ingredients.shapes),l=n(u.numShapes,this.ingredients.colors.background,this.width,this.height),c=s(a,this.ingredients.shapes);l!==o.summary.innerHTML&&(o.summary.innerHTML=l),u.listShapes!==o.list.innerHTML&&(o.list.innerHTML=u.listShapes),c!==o.shapeDetails.innerHTML&&(o.shapeDetails.innerHTML=c),this._accessibleOutputs[a]=o};function n(a,o,u,l){let c=`Your output is a, ${u} by ${l} pixels, ${o} canvas containing the following`;return a===1?c=`${c} shape:`:c=`${c} ${a} shapes:`,c}function s(a,o){let u="",l=0;for(let c in o)for(let h in o[c]){let f=`<tr id="${a}shape${l}"><th>${o[c][h].color} ${c}</th>`;c==="line"?f=f+`<td>location = ${o[c][h].pos}</td><td>length = ${o[c][h].length} pixels</td></tr>`:(f=f+`<td>location = ${o[c][h].pos}</td>`,c!=="point"&&(f=f+`<td> area = ${o[c][h].area}%</td>`),f=f+"</tr>"),u=u+f,l++}return u}function i(a,o){let u="",l=0;for(let c in o)for(let h in o[c]){let f=`<li><a href="#${a}shape${l}">${o[c][h].color} ${c}</a>`;c==="line"?f=f+`, ${o[c][h].pos}, ${o[c][h].length} pixels long.</li>`:(f=f+`, at ${o[c][h].pos}`,c!=="point"&&(f=f+`, covering ${o[c][h].area}% of the canvas`),f=f+".</li>"),u=u+f,l++}return{numShapes:l,listShapes:u}}}typeof p5<"u"&&J8(p5,p5.prototype);function e9(r,t){t.textOutput=function(i){this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),i===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},t.gridOutput=function(i){this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),i===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},t._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},t._createOutput=function(i,a){let o=this.canvas.id;this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:"",pBackground:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(o).parentNode);let u,l,c,h="";a==="Fallback"?(u=o+i,l=o+"accessibleOutput",this.dummyDOM.querySelector(`#${l}`)||(this.dummyDOM.querySelector(`#${o}_Description`)?this.dummyDOM.querySelector(`#${o}_Description`).insertAdjacentHTML("afterend",`<div id="${l}" role="region" aria-label="Canvas Outputs"></div>`):this.dummyDOM.querySelector(`#${o}`).innerHTML=`<div id="${l}" role="region" aria-label="Canvas Outputs"></div>`)):a==="Label"&&(h=a,u=o+i+a,l=o+"accessibleOutput"+a,this.dummyDOM.querySelector(`#${l}`)||(this.dummyDOM.querySelector(`#${o}_Label`)?this.dummyDOM.querySelector(`#${o}_Label`).insertAdjacentHTML("afterend",`<div id="${l}"></div>`):this.dummyDOM.querySelector(`#${o}`).insertAdjacentHTML("afterend",`<div id="${l}"></div>`))),this._accessibleOutputs[u]={},i==="textOutput"?(h=`#${o}gridOutput${h}`,c=`<div id="${u}">Text Output<div id="${u}Summary" aria-label="text output summary"><p id="${u}_summary"></p><ul id="${u}_list"></ul></div><table id="${u}_shapeDetails" summary="text output shape details"></table></div>`,this.dummyDOM.querySelector(h)?this.dummyDOM.querySelector(h).insertAdjacentHTML("beforebegin",c):this.dummyDOM.querySelector(`#${l}`).innerHTML=c,this._accessibleOutputs[u].list=this.dummyDOM.querySelector(`#${u}_list`)):i==="gridOutput"&&(h=`#${o}textOutput${h}`,c=`<div id="${u}">Grid Output<p id="${u}_summary" aria-label="grid output summary"><table id="${u}_map" summary="grid output content"></table><ul id="${u}_shapeDetails" aria-label="grid output shape details"></ul></div>`,this.dummyDOM.querySelector(h)?this.dummyDOM.querySelector(h).insertAdjacentHTML("afterend",c):this.dummyDOM.querySelector(`#${l}`).innerHTML=c,this._accessibleOutputs[u].map=this.dummyDOM.querySelector(`#${u}_map`)),this._accessibleOutputs[u].shapeDetails=this.dummyDOM.querySelector(`#${u}_shapeDetails`),this._accessibleOutputs[u].summary=this.dummyDOM.querySelector(`#${u}_summary`)},t._updateAccsOutput=function(){let i=this.canvas.id;(JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes||this.ingredients.colors.background!==this.ingredients.pBackground)&&(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(i+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(i+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(i+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(i+"gridOutputLabel"))},t._accsBackground=function(i){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.pBackground=this.ingredients.colors.background,this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==i&&(this.ingredients.colors.backgroundRGBA=i,this.ingredients.colors.background=this._rgbColorName(i))},t._accsCanvasColors=function(i,a){i==="fill"?this.ingredients.colors.fillRGBA!==a&&(this.ingredients.colors.fillRGBA=a,this.ingredients.colors.fill=this._rgbColorName(a)):i==="stroke"&&this.ingredients.colors.strokeRGBA!==a&&(this.ingredients.colors.strokeRGBA=a,this.ingredients.colors.stroke=this._rgbColorName(a))},t._accsOutput=function(i,a){i==="ellipse"&&a[2]===a[3]?i="circle":i==="rectangle"&&a[2]===a[3]&&(i="square");let o={},u=!0,l=n(i,a);if(i==="line"){o.color=this.ingredients.colors.stroke,o.length=Math.round(Math.hypot(a[2]-a[0],a[3]-a[1]));let c=this._getPos(a[0],[1]),h=this._getPos(a[2],[3]);o.loc=s(l,this.width,this.height),c===h?o.pos=`at ${c}`:o.pos=`from ${c} to ${h}`}else i==="point"?o.color=this.ingredients.colors.stroke:(o.color=this.ingredients.colors.fill,o.area=this._getArea(i,a)),o.pos=this._getPos(...l),o.loc=s(l,this.width,this.height);if(!this.ingredients.shapes[i])this.ingredients.shapes[i]=[o];else if(this.ingredients.shapes[i]!==[o]){for(let c in this.ingredients.shapes[i])JSON.stringify(this.ingredients.shapes[i][c])===JSON.stringify(o)&&(u=!1);u===!0&&this.ingredients.shapes[i].push(o)}};function n(i,a){let o,u;return i==="rectangle"||i==="ellipse"||i==="arc"||i==="circle"||i==="square"?(o=Math.round(a[0]+a[2]/2),u=Math.round(a[1]+a[3]/2)):i==="triangle"?(o=(a[0]+a[2]+a[4])/3,u=(a[1]+a[3]+a[5])/3):i==="quadrilateral"?(o=(a[0]+a[2]+a[4]+a[6])/4,u=(a[1]+a[3]+a[5]+a[7])/4):i==="line"?(o=(a[0]+a[2])/2,u=(a[1]+a[3])/2):(o=a[0],u=a[1]),[o,u]}t._getPos=function(i,a){const{x:o,y:u}=this.worldToScreen(new r.Vector(i,a)),l=this.width,c=this.height;return o<.4*l?u<.4*c?"top left":u>.6*c?"bottom left":"mid left":o>.6*l?u<.4*c?"top right":u>.6*c?"bottom right":"mid right":u<.4*c?"top middle":u>.6*c?"bottom middle":"middle"};function s(i,a,o){let c=Math.floor(i[0]/a*10),h=Math.floor(i[1]/o*10);return c===10&&(c=c-1),h===10&&(h=h-1),{locX:c,locY:h}}t._getArea=function(i,a){let o=0;if(i==="arc"){const x=((a[5]-a[4])%(Math.PI*2)+Math.PI*2)%(Math.PI*2);if(o=x*a[2]*a[3]/8,a[6]==="open"||a[6]==="chord"){const v=a[0],S=a[1],w=a[0]+a[2]/2*Math.cos(a[4]).toFixed(2),E=a[1]+a[3]/2*Math.sin(a[4]).toFixed(2),_=a[0]+a[2]/2*Math.cos(a[5]).toFixed(2),D=a[1]+a[3]/2*Math.sin(a[5]).toFixed(2),I=Math.abs(v*(E-D)+w*(D-S)+_*(S-E))/2;x>Math.PI?o=o+I:o=o-I}}else i==="ellipse"||i==="circle"?o=3.14*a[2]/2*a[3]/2:i==="line"||i==="point"?o=0:i==="quadrilateral"?o=Math.abs((a[6]+a[0])*(a[7]-a[1])+(a[0]+a[2])*(a[1]-a[3])+(a[2]+a[4])*(a[3]-a[5])+(a[4]+a[6])*(a[5]-a[7]))/2:i==="rectangle"||i==="square"?o=a[2]*a[3]:i==="triangle"&&(o=Math.abs(a[0]*(a[3]-a[5])+a[2]*(a[5]-a[1])+a[4]*(a[1]-a[3]))/2);const u=this.width*this._renderer._pixelDensity,l=this.height*this._renderer._pixelDensity,c=[new DOMPoint(0,0),new DOMPoint(u,0),new DOMPoint(u,l),new DOMPoint(0,l)],f=(this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform()).inverse(),p=c.map(x=>x.matrixTransform(f)),g=Math.abs((p[3].x+p[0].x)*(p[3].y-p[0].y)+(p[0].x+p[1].x)*(p[0].y-p[1].y)+(p[1].x+p[2].x)*(p[1].y-p[2].y)+(p[2].x+p[3].x)*(p[2].y-p[3].y))/2;return Math.round(o*100/g)}}typeof p5<"u"&&e9(p5,p5.prototype);jn.ColorConversion={_hsbaToHSLA(r){const t=r[0];let n=r[1];const s=r[2],i=(2-n)*s/2;return i!==0&&(i===1?n=0:i<.5?n=n/(2-n):n=n*s/(2-i*2)),[t,n,i,r[3]]},_hsbaToRGBA(r){const t=r[0]*6,n=r[1],s=r[2];let i=[];if(n===0)i=[s,s,s,r[3]];else{const a=Math.floor(t),o=s*(1-n),u=s*(1-n*(t-a)),l=s*(1-n*(1+a-t));let c,h,f;a===1?(c=u,h=s,f=o):a===2?(c=o,h=s,f=l):a===3?(c=o,h=u,f=s):a===4?(c=l,h=o,f=s):a===5?(c=s,h=o,f=u):(c=s,h=l,f=o),i=[c,h,f,r[3]]}return i},_hslaToHSBA(r){const t=r[0];let n=r[1];const s=r[2];let i;return s<.5?i=(1+n)*s:i=s+n-s*n,n=2*(i-s)/i,[t,n,i,r[3]]},_hslaToRGBA(r){const t=r[0]*6,n=r[1],s=r[2];let i=[];if(n===0)i=[s,s,s,r[3]];else{let a;s<.5?a=(1+n)*s:a=s+n-s*n;const o=2*s-a,u=(l,c,h)=>(l<0?l+=6:l>=6&&(l-=6),l<1?c+(h-c)*l:l<3?h:l<4?c+(h-c)*(4-l):c);i=[u(t+2,o,a),u(t,o,a),u(t-2,o,a),r[3]]}return i},_rgbaToHSBA(r){const t=r[0],n=r[1],s=r[2],i=Math.max(t,n,s),a=i-Math.min(t,n,s);let o,u;return a===0?(o=0,u=0):(u=a/i,t===i?o=(n-s)/a:n===i?o=2+(s-t)/a:s===i&&(o=4+(t-n)/a),o<0?o+=6:o>=6&&(o-=6)),[o/6,u,i,r[3]]},_rgbaToHSLA(r){const t=r[0],n=r[1],s=r[2],i=Math.max(t,n,s),a=Math.min(t,n,s),o=i+a,u=i-a;let l,c;return u===0?(l=0,c=0):(o<1?c=u/o:c=u/(2-o),t===i?l=(n-s)/u:n===i?l=2+(s-t)/u:s===i&&(l=4+(t-n)/u),l<0?l+=6:l>=6&&(l-=6)),[l/6,c,o/2,r[3]]}};var xJ=jn.ColorConversion;function t9(r,t){let n;const s=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],i=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];function a(o){let u;if(o[0]!==0){o[0]=Math.round(o[0]*100);let l=o[0].toString().split("");const c=l.length-1;l[c]=parseInt(l[c]),l[c]<2.5?l[c]=0:l[c]>=2.5&&l[c]<7.5&&(l[c]=5),l.length===2?(l[0]=parseInt(l[0]),l[c]>=7.5&&(l[c]=0,l[0]=l[0]+1),o[0]=l[0]*10+l[1]):l[c]>=7.5?o[0]=10:o[0]=l[c]}o[2]=o[2]/255;for(let l=o.length-1;l>=1;l--)o[l]<=.25?o[l]=0:o[l]>.25&&o[l]<.75?o[l]=.5:o[l]=1;if(o[0]===0&&o[1]===0&&o[2]===1){for(let l=2;l>=0;l--)n[l]=Math.round(n[l]*1e4)/1e4;for(let l=0;l<s.length;l++)if(s[l].h===n[0]&&s[l].s===n[1]&&s[l].b===n[2]){u=s[l].name;break}else u="white"}else for(let l=0;l<i.length;l++)if(i[l].h===o[0]&&i[l].s===o[1]&&i[l].b===o[2]){u=i[l].name;break}return u}t._rgbColorName=function(o){let u=xJ._rgbaToHSBA(o);return n=u,a([u[0],u[1],u[2]])}}typeof p5<"u"&&t9(p5,p5.prototype);function bJ(r){r.registerAddon(Z8),r.registerAddon(Q8),r.registerAddon(J8),r.registerAddon(e9),r.registerAddon(t9)}function vJ(r){r.registerAddon(aT),r.registerAddon(V6),r.registerAddon(pT)}function eo(r){"@babel/helpers - typeof";return eo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eo(r)}function wJ(r,t){if(eo(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var s=n.call(r,t);if(eo(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function n9(r){var t=wJ(r,"string");return eo(t)=="symbol"?t:t+""}function SJ(r,t,n){return(t=n9(t))in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function Ys(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&s.push.apply(s,Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),s.forEach(function(i){SJ(r,i,n[i])})}return r}function Bo(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function cF(r,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,n9(s.key),s)}}function Po(r,t,n){return t&&cF(r.prototype,t),n&&cF(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function Jc(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Qm(r,t){if(t&&(eo(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jc(r)}function ld(r){return ld=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ld(r)}function tE(r,t){return tE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},tE(r,t)}function rv(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&tE(r,t)}var CJ={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,n){console&&console[t]&&console[t].apply(console,n)}},_J=function(){function r(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Bo(this,r),this.init(t,n)}return Po(r,[{key:"init",value:function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=s.prefix||"i18next:",this.logger=n||CJ,this.options=s,this.debug=s.debug}},{key:"setDebug",value:function(n){this.debug=n}},{key:"log",value:function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return this.forward(s,"log","",!0)}},{key:"warn",value:function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return this.forward(s,"warn","",!0)}},{key:"error",value:function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return this.forward(s,"error","")}},{key:"deprecate",value:function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return this.forward(s,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(n,s,i,a){return a&&!this.debug?null:(typeof n[0]=="string"&&(n[0]="".concat(i).concat(this.prefix," ").concat(n[0])),this.logger[s](n))}},{key:"create",value:function(n){return new r(this.logger,Ys({},{prefix:"".concat(this.prefix,":").concat(n,":")},this.options))}}]),r}(),mu=new _J,Al=function(){function r(){Bo(this,r),this.observers={}}return Po(r,[{key:"on",value:function(n,s){var i=this;return n.split(" ").forEach(function(a){i.observers[a]=i.observers[a]||[],i.observers[a].push(s)}),this}},{key:"off",value:function(n,s){if(this.observers[n]){if(!s){delete this.observers[n];return}this.observers[n]=this.observers[n].filter(function(i){return i!==s})}}},{key:"emit",value:function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];if(this.observers[n]){var o=[].concat(this.observers[n]);o.forEach(function(l){l.apply(void 0,i)})}if(this.observers["*"]){var u=[].concat(this.observers["*"]);u.forEach(function(l){l.apply(l,[n].concat(i))})}}}]),r}();function sm(){var r,t,n=new Promise(function(s,i){r=s,t=i});return n.resolve=r,n.reject=t,n}function hF(r){return r==null?"":""+r}function EJ(r,t,n){r.forEach(function(s){t[s]&&(n[s]=t[s])})}function DT(r,t,n){function s(u){return u&&u.indexOf("###")>-1?u.replace(/###/g,"."):u}function i(){return!r||typeof r=="string"}for(var a=typeof t!="string"?[].concat(t):t.split(".");a.length>1;){if(i())return{};var o=s(a.shift());!r[o]&&n&&(r[o]=new n),Object.prototype.hasOwnProperty.call(r,o)?r=r[o]:r={}}return i()?{}:{obj:r,k:s(a.shift())}}function fF(r,t,n){var s=DT(r,t,Object),i=s.obj,a=s.k;i[a]=n}function DJ(r,t,n,s){var i=DT(r,t,Object),a=i.obj,o=i.k;a[o]=a[o]||[],a[o].push(n)}function Lx(r,t){var n=DT(r,t),s=n.obj,i=n.k;if(s)return s[i]}function dF(r,t,n){var s=Lx(r,n);return s!==void 0?s:Lx(t,n)}function r9(r,t,n){for(var s in t)s!=="__proto__"&&s!=="constructor"&&(s in r?typeof r[s]=="string"||r[s]instanceof String||typeof t[s]=="string"||t[s]instanceof String?n&&(r[s]=t[s]):r9(r[s],t[s],n):r[s]=t[s]);return r}function wf(r){return r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var TJ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function NJ(r){return typeof r=="string"?r.replace(/[&<>"'\/]/g,function(t){return TJ[t]}):r}var sv=typeof window<"u"&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,kJ=function(r){rv(t,r);function t(n){var s,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return Bo(this,t),s=Qm(this,ld(t).call(this)),sv&&Al.call(Jc(s)),s.data=n||{},s.options=i,s.options.keySeparator===void 0&&(s.options.keySeparator="."),s}return Po(t,[{key:"addNamespaces",value:function(s){this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}},{key:"removeNamespaces",value:function(s){var i=this.options.ns.indexOf(s);i>-1&&this.options.ns.splice(i,1)}},{key:"getResource",value:function(s,i,a){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},u=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,l=[s,i];return a&&typeof a!="string"&&(l=l.concat(a)),a&&typeof a=="string"&&(l=l.concat(u?a.split(u):a)),s.indexOf(".")>-1&&(l=s.split(".")),Lx(this.data,l)}},{key:"addResource",value:function(s,i,a,o){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},l=this.options.keySeparator;l===void 0&&(l=".");var c=[s,i];a&&(c=c.concat(l?a.split(l):a)),s.indexOf(".")>-1&&(c=s.split("."),o=i,i=c[1]),this.addNamespaces(i),fF(this.data,c,o),u.silent||this.emit("added",s,i,a,o)}},{key:"addResources",value:function(s,i,a){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var u in a)(typeof a[u]=="string"||Object.prototype.toString.apply(a[u])==="[object Array]")&&this.addResource(s,i,u,a[u],{silent:!0});o.silent||this.emit("added",s,i,a)}},{key:"addResourceBundle",value:function(s,i,a,o,u){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},c=[s,i];s.indexOf(".")>-1&&(c=s.split("."),o=a,a=i,i=c[1]),this.addNamespaces(i);var h=Lx(this.data,c)||{};o?r9(h,a,u):h=Ys({},h,a),fF(this.data,c,h),l.silent||this.emit("added",s,i,a)}},{key:"removeResourceBundle",value:function(s,i){this.hasResourceBundle(s,i)&&delete this.data[s][i],this.removeNamespaces(i),this.emit("removed",s,i)}},{key:"hasResourceBundle",value:function(s,i){return this.getResource(s,i)!==void 0}},{key:"getResourceBundle",value:function(s,i){return i||(i=this.options.defaultNS),this.options.compatibilityAPI==="v1"?Ys({},{},this.getResource(s,i)):this.getResource(s,i)}},{key:"getDataByLanguage",value:function(s){return this.data[s]}},{key:"toJSON",value:function(){return this.data}}]),t}(Al),s9={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,n,s,i,a){var o=this;return t.forEach(function(u){o.processors[u]&&(n=o.processors[u].process(n,s,i,a))}),n}},pF={},mF=function(r){rv(t,r);function t(n){var s,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Bo(this,t),s=Qm(this,ld(t).call(this)),sv&&Al.call(Jc(s)),EJ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],n,Jc(s)),s.options=i,s.options.keySeparator===void 0&&(s.options.keySeparator="."),s.logger=mu.create("translator"),s}return Po(t,[{key:"changeLanguage",value:function(s){s&&(this.language=s)}},{key:"exists",value:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},a=this.resolve(s,i);return a&&a.res!==void 0}},{key:"extractFromKey",value:function(s,i){var a=i.nsSeparator!==void 0?i.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");var o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,u=i.ns||this.options.defaultNS;if(a&&s.indexOf(a)>-1){var l=s.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:s,namespaces:u};var c=s.split(a);(a!==o||a===o&&this.options.ns.indexOf(c[0])>-1)&&(u=c.shift()),s=c.join(o)}return typeof u=="string"&&(u=[u]),{key:s,namespaces:u}}},{key:"translate",value:function(s,i,a){var o=this;if(eo(i)!=="object"&&this.options.overloadTranslationOptionHandler&&(i=this.options.overloadTranslationOptionHandler(arguments)),i||(i={}),s==null)return"";Array.isArray(s)||(s=[String(s)]);var u=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,l=this.extractFromKey(s[s.length-1],i),c=l.key,h=l.namespaces,f=h[h.length-1],p=i.lng||this.language,g=i.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(p&&p.toLowerCase()==="cimode"){if(g){var y=i.nsSeparator||this.options.nsSeparator;return f+y+c}return c}var x=this.resolve(s,i),v=x&&x.res,S=x&&x.usedKey||c,w=x&&x.exactUsedKey||c,E=Object.prototype.toString.apply(v),_=["[object Number]","[object Function]","[object RegExp]"],D=i.joinArrays!==void 0?i.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject,k=typeof v!="string"&&typeof v!="boolean"&&typeof v!="number";if(I&&v&&k&&_.indexOf(E)<0&&!(typeof D=="string"&&E==="[object Array]")){if(!i.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(S,v,i):"key '".concat(c," (").concat(this.language,")' returned an object instead of string.");if(u){var A=E==="[object Array]",N=A?[]:{},F=A?w:S;for(var $ in v)if(Object.prototype.hasOwnProperty.call(v,$)){var O="".concat(F).concat(u).concat($);N[$]=this.translate(O,Ys({},i,{joinArrays:!1,ns:h})),N[$]===O&&(N[$]=v[$])}v=N}}else if(I&&typeof D=="string"&&E==="[object Array]")v=v.join(D),v&&(v=this.extendTranslation(v,s,i,a));else{var M=!1,B=!1,U=i.count!==void 0&&typeof i.count!="string",V=t.hasDefaultValue(i),Z=U?this.pluralResolver.getSuffix(p,i.count):"",J=i["defaultValue".concat(Z)]||i.defaultValue;!this.isValidLookup(v)&&V&&(M=!0,v=J),this.isValidLookup(v)||(B=!0,v=c);var ne=V&&J!==v&&this.options.updateMissing;if(B||M||ne){if(this.logger.log(ne?"updateKey":"missingKey",p,f,c,ne?J:v),u){var z=this.resolve(c,Ys({},i,{keySeparator:!1}));z&&z.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var X=[],Y=this.languageUtils.getFallbackCodes(this.options.fallbackLng,i.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Y&&Y[0])for(var se=0;se<Y.length;se++)X.push(Y[se]);else this.options.saveMissingTo==="all"?X=this.languageUtils.toResolveHierarchy(i.lng||this.language):X.push(i.lng||this.language);var ue=function(de,be,Me){o.options.missingKeyHandler?o.options.missingKeyHandler(de,f,be,ne?Me:v,ne,i):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(de,f,be,ne?Me:v,ne,i),o.emit("missingKey",de,f,be,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&U?X.forEach(function(fe){o.pluralResolver.getSuffixes(fe).forEach(function(de){ue([fe],c+de,i["defaultValue".concat(de)]||J)})}):ue(X,c,J))}v=this.extendTranslation(v,s,i,x,a),B&&v===c&&this.options.appendNamespaceToMissingKey&&(v="".concat(f,":").concat(c)),B&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(v))}return v}},{key:"extendTranslation",value:function(s,i,a,o,u){var l=this;if(this.i18nFormat&&this.i18nFormat.parse)s=this.i18nFormat.parse(s,a,o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init(Ys({},a,{interpolation:Ys({},this.options.interpolation,a.interpolation)}));var c=a.interpolation&&a.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables,h;if(c){var f=s.match(this.interpolator.nestingRegexp);h=f&&f.length}var p=a.replace&&typeof a.replace!="string"?a.replace:a;if(this.options.interpolation.defaultVariables&&(p=Ys({},this.options.interpolation.defaultVariables,p)),s=this.interpolator.interpolate(s,p,a.lng||this.language,a),c){var g=s.match(this.interpolator.nestingRegexp),y=g&&g.length;h<y&&(a.nest=!1)}a.nest!==!1&&(s=this.interpolator.nest(s,function(){for(var S=arguments.length,w=new Array(S),E=0;E<S;E++)w[E]=arguments[E];return u&&u[0]===w[0]&&!a.context?(l.logger.warn("It seems you are nesting recursively key: ".concat(w[0]," in key: ").concat(i[0])),null):l.translate.apply(l,w.concat([i]))},a)),a.interpolation&&this.interpolator.reset()}var x=a.postProcess||this.options.postProcess,v=typeof x=="string"?[x]:x;return s!=null&&v&&v.length&&a.applyPostProcessor!==!1&&(s=s9.handle(v,s,i,this.options&&this.options.postProcessPassResolved?Ys({i18nResolved:o},a):a,this)),s}},{key:"resolve",value:function(s){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o,u,l,c,h;return typeof s=="string"&&(s=[s]),s.forEach(function(f){if(!i.isValidLookup(o)){var p=i.extractFromKey(f,a),g=p.key;u=g;var y=p.namespaces;i.options.fallbackNS&&(y=y.concat(i.options.fallbackNS));var x=a.count!==void 0&&typeof a.count!="string",v=a.context!==void 0&&typeof a.context=="string"&&a.context!=="",S=a.lngs?a.lngs:i.languageUtils.toResolveHierarchy(a.lng||i.language,a.fallbackLng);y.forEach(function(w){i.isValidLookup(o)||(h=w,!pF["".concat(S[0],"-").concat(w)]&&i.utils&&i.utils.hasLoadedNamespace&&!i.utils.hasLoadedNamespace(h)&&(pF["".concat(S[0],"-").concat(w)]=!0,i.logger.warn('key "'.concat(u,'" for languages "').concat(S.join(", "),`" won't get resolved as namespace "`).concat(h,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),S.forEach(function(E){if(!i.isValidLookup(o)){c=E;var _=g,D=[_];if(i.i18nFormat&&i.i18nFormat.addLookupKeys)i.i18nFormat.addLookupKeys(D,g,E,w,a);else{var I;x&&(I=i.pluralResolver.getSuffix(E,a.count)),x&&v&&D.push(_+I),v&&D.push(_+="".concat(i.options.contextSeparator).concat(a.context)),x&&D.push(_+=I)}for(var k;k=D.pop();)i.isValidLookup(o)||(l=k,o=i.getResource(E,w,k,a))}}))})}}),{res:o,usedKey:u,exactUsedKey:l,usedLng:c,usedNS:h}}},{key:"isValidLookup",value:function(s){return s!==void 0&&!(!this.options.returnNull&&s===null)&&!(!this.options.returnEmptyString&&s==="")}},{key:"getResource",value:function(s,i,a){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(s,i,a,o):this.resourceStore.getResource(s,i,a,o)}}],[{key:"hasDefaultValue",value:function(s){var i="defaultValue";for(var a in s)if(Object.prototype.hasOwnProperty.call(s,a)&&i===a.substring(0,i.length)&&s[a]!==void 0)return!0;return!1}}]),t}(Al);function _C(r){return r.charAt(0).toUpperCase()+r.slice(1)}var AJ=function(){function r(t){Bo(this,r),this.options=t,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=mu.create("languageUtils")}return Po(r,[{key:"getScriptPartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return null;var s=n.split("-");return s.length===2||(s.pop(),s[s.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(s.join("-"))}},{key:"getLanguagePartFromCode",value:function(n){if(!n||n.indexOf("-")<0)return n;var s=n.split("-");return this.formatLanguageCode(s[0])}},{key:"formatLanguageCode",value:function(n){if(typeof n=="string"&&n.indexOf("-")>-1){var s=["hans","hant","latn","cyrl","cans","mong","arab"],i=n.split("-");return this.options.lowerCaseLng?i=i.map(function(a){return a.toLowerCase()}):i.length===2?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),s.indexOf(i[1].toLowerCase())>-1&&(i[1]=_C(i[1].toLowerCase()))):i.length===3&&(i[0]=i[0].toLowerCase(),i[1].length===2&&(i[1]=i[1].toUpperCase()),i[0]!=="sgn"&&i[2].length===2&&(i[2]=i[2].toUpperCase()),s.indexOf(i[1].toLowerCase())>-1&&(i[1]=_C(i[1].toLowerCase())),s.indexOf(i[2].toLowerCase())>-1&&(i[2]=_C(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?n.toLowerCase():n}},{key:"isWhitelisted",value:function(n){return this.logger.deprecate("languageUtils.isWhitelisted",`function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it's usage asap.`),this.isSupportedCode(n)}},{key:"isSupportedCode",value:function(n){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(n=this.getLanguagePartFromCode(n)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(n)>-1}},{key:"getBestMatchFromCodes",value:function(n){var s=this;if(!n)return null;var i;return n.forEach(function(a){if(!i){var o=s.formatLanguageCode(a);(!s.options.supportedLngs||s.isSupportedCode(o))&&(i=o)}}),!i&&this.options.supportedLngs&&n.forEach(function(a){if(!i){var o=s.getLanguagePartFromCode(a);if(s.isSupportedCode(o))return i=o;i=s.options.supportedLngs.find(function(u){if(u.indexOf(o)===0)return u})}}),i||(i=this.getFallbackCodes(this.options.fallbackLng)[0]),i}},{key:"getFallbackCodes",value:function(n,s){if(!n)return[];if(typeof n=="function"&&(n=n(s)),typeof n=="string"&&(n=[n]),Object.prototype.toString.apply(n)==="[object Array]")return n;if(!s)return n.default||[];var i=n[s];return i||(i=n[this.getScriptPartFromCode(s)]),i||(i=n[this.formatLanguageCode(s)]),i||(i=n[this.getLanguagePartFromCode(s)]),i||(i=n.default),i||[]}},{key:"toResolveHierarchy",value:function(n,s){var i=this,a=this.getFallbackCodes(s||this.options.fallbackLng||[],n),o=[],u=function(c){c&&(i.isSupportedCode(c)?o.push(c):i.logger.warn("rejecting language code not found in supportedLngs: ".concat(c)))};return typeof n=="string"&&n.indexOf("-")>-1?(this.options.load!=="languageOnly"&&u(this.formatLanguageCode(n)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&u(this.getScriptPartFromCode(n)),this.options.load!=="currentOnly"&&u(this.getLanguagePartFromCode(n))):typeof n=="string"&&u(this.formatLanguageCode(n)),a.forEach(function(l){o.indexOf(l)<0&&u(i.formatLanguageCode(l))}),o}}]),r}(),IJ=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],$J={1:function(t){return+(t>1)},2:function(t){return+(t!=1)},3:function(t){return 0},4:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},5:function(t){return t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5},6:function(t){return t==1?0:t>=2&&t<=4?1:2},7:function(t){return t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},8:function(t){return t==1?0:t==2?1:t!=8&&t!=11?2:3},9:function(t){return+(t>=2)},10:function(t){return t==1?0:t==2?1:t<7?2:t<11?3:4},11:function(t){return t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3},12:function(t){return+(t%10!=1||t%100==11)},13:function(t){return+(t!==0)},14:function(t){return t==1?0:t==2?1:t==3?2:3},15:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2},16:function(t){return t%10==1&&t%100!=11?0:t!==0?1:2},17:function(t){return t==1||t%10==1&&t%100!=11?0:1},18:function(t){return t==0?0:t==1?1:2},19:function(t){return t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3},20:function(t){return t==1?0:t==0||t%100>0&&t%100<20?1:2},21:function(t){return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0},22:function(t){return t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3}};function FJ(){var r={};return IJ.forEach(function(t){t.lngs.forEach(function(n){r[n]={numbers:t.nr,plurals:$J[t.fc]}})}),r}var RJ=function(){function r(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Bo(this,r),this.languageUtils=t,this.options=n,this.logger=mu.create("pluralResolver"),this.rules=FJ()}return Po(r,[{key:"addRule",value:function(n,s){this.rules[n]=s}},{key:"getRule",value:function(n){return this.rules[n]||this.rules[this.languageUtils.getLanguagePartFromCode(n)]}},{key:"needsPlural",value:function(n){var s=this.getRule(n);return s&&s.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(n,s){return this.getSuffixes(n).map(function(i){return s+i})}},{key:"getSuffixes",value:function(n){var s=this,i=this.getRule(n);return i?i.numbers.map(function(a){return s.getSuffix(n,a)}):[]}},{key:"getSuffix",value:function(n,s){var i=this,a=this.getRule(n);if(a){var o=a.noAbs?a.plurals(s):a.plurals(Math.abs(s)),u=a.numbers[o];this.options.simplifyPluralSuffix&&a.numbers.length===2&&a.numbers[0]===1&&(u===2?u="plural":u===1&&(u=""));var l=function(){return i.options.prepend&&u.toString()?i.options.prepend+u.toString():u.toString()};return this.options.compatibilityJSON==="v1"?u===1?"":typeof u=="number"?"_plural_".concat(u.toString()):l():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&a.numbers.length===2&&a.numbers[0]===1?l():this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString()}return this.logger.warn("no plural rule found for: ".concat(n)),""}}]),r}(),OJ=function(){function r(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Bo(this,r),this.logger=mu.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(n){return n},this.init(t)}return Po(r,[{key:"init",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};n.interpolation||(n.interpolation={escapeValue:!0});var s=n.interpolation;this.escape=s.escape!==void 0?s.escape:NJ,this.escapeValue=s.escapeValue!==void 0?s.escapeValue:!0,this.useRawValueToEscape=s.useRawValueToEscape!==void 0?s.useRawValueToEscape:!1,this.prefix=s.prefix?wf(s.prefix):s.prefixEscaped||"{{",this.suffix=s.suffix?wf(s.suffix):s.suffixEscaped||"}}",this.formatSeparator=s.formatSeparator?s.formatSeparator:s.formatSeparator||",",this.unescapePrefix=s.unescapeSuffix?"":s.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":s.unescapeSuffix||"",this.nestingPrefix=s.nestingPrefix?wf(s.nestingPrefix):s.nestingPrefixEscaped||wf("$t("),this.nestingSuffix=s.nestingSuffix?wf(s.nestingSuffix):s.nestingSuffixEscaped||wf(")"),this.nestingOptionsSeparator=s.nestingOptionsSeparator?s.nestingOptionsSeparator:s.nestingOptionsSeparator||",",this.maxReplaces=s.maxReplaces?s.maxReplaces:1e3,this.alwaysFormat=s.alwaysFormat!==void 0?s.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var n="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(n,"g");var s="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(s,"g");var i="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(i,"g")}},{key:"interpolate",value:function(n,s,i,a){var o=this,u,l,c,h=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function f(v){return v.replace(/\$/g,"$$$$")}var p=function(S){if(S.indexOf(o.formatSeparator)<0){var w=dF(s,h,S);return o.alwaysFormat?o.format(w,void 0,i):w}var E=S.split(o.formatSeparator),_=E.shift().trim(),D=E.join(o.formatSeparator).trim();return o.format(dF(s,h,_),D,i,a)};this.resetRegExp();var g=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,y=a&&a.interpolation&&a.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables,x=[{regex:this.regexpUnescape,safeValue:function(S){return f(S)}},{regex:this.regexp,safeValue:function(S){return o.escapeValue?f(o.escape(S)):f(S)}}];return x.forEach(function(v){for(c=0;u=v.regex.exec(n);){if(l=p(u[1].trim()),l===void 0)if(typeof g=="function"){var S=g(n,u,a);l=typeof S=="string"?S:""}else if(y){l=u[0];continue}else o.logger.warn("missed to pass in variable ".concat(u[1]," for interpolating ").concat(n)),l="";else typeof l!="string"&&!o.useRawValueToEscape&&(l=hF(l));if(n=n.replace(u[0],v.safeValue(l)),v.regex.lastIndex=0,c++,c>=o.maxReplaces)break}}),n}},{key:"nest",value:function(n,s){var i=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o,u,l=Ys({},a);l.applyPostProcessor=!1,delete l.defaultValue;function c(g,y){var x=this.nestingOptionsSeparator;if(g.indexOf(x)<0)return g;var v=g.split(new RegExp("".concat(x,"[ ]*{"))),S="{".concat(v[1]);g=v[0],S=this.interpolate(S,l),S=S.replace(/'/g,'"');try{l=JSON.parse(S),y&&(l=Ys({},y,l))}catch(w){return this.logger.warn("failed parsing options string in nesting for key ".concat(g),w),"".concat(g).concat(x).concat(S)}return delete l.defaultValue,g}for(;o=this.nestingRegexp.exec(n);){var h=[],f=!1;if(o[0].includes(this.formatSeparator)&&!/{.*}/.test(o[1])){var p=o[1].split(this.formatSeparator).map(function(g){return g.trim()});o[1]=p.shift(),h=p,f=!0}if(u=s(c.call(this,o[1].trim(),l),l),u&&o[0]===n&&typeof u!="string")return u;typeof u!="string"&&(u=hF(u)),u||(this.logger.warn("missed to resolve ".concat(o[1]," for nesting ").concat(n)),u=""),f&&(u=h.reduce(function(g,y){return i.format(g,y,a.lng,a)},u.trim())),n=n.replace(o[0],u),this.regexp.lastIndex=0}return n}}]),r}();function MJ(r,t){for(var n=r.indexOf(t);n!==-1;)r.splice(n,1),n=r.indexOf(t)}var LJ=function(r){rv(t,r);function t(n,s,i){var a,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return Bo(this,t),a=Qm(this,ld(t).call(this)),sv&&Al.call(Jc(a)),a.backend=n,a.store=s,a.services=i,a.languageUtils=i.languageUtils,a.options=o,a.logger=mu.create("backendConnector"),a.state={},a.queue=[],a.backend&&a.backend.init&&a.backend.init(i,o.backend,o),a}return Po(t,[{key:"queueLoad",value:function(s,i,a,o){var u=this,l=[],c=[],h=[],f=[];return s.forEach(function(p){var g=!0;i.forEach(function(y){var x="".concat(p,"|").concat(y);!a.reload&&u.store.hasResourceBundle(p,y)?u.state[x]=2:u.state[x]<0||(u.state[x]===1?c.indexOf(x)<0&&c.push(x):(u.state[x]=1,g=!1,c.indexOf(x)<0&&c.push(x),l.indexOf(x)<0&&l.push(x),f.indexOf(y)<0&&f.push(y)))}),g||h.push(p)}),(l.length||c.length)&&this.queue.push({pending:c,loaded:{},errors:[],callback:o}),{toLoad:l,pending:c,toLoadLanguages:h,toLoadNamespaces:f}}},{key:"loaded",value:function(s,i,a){var o=s.split("|"),u=o[0],l=o[1];i&&this.emit("failedLoading",u,l,i),a&&this.store.addResourceBundle(u,l,a),this.state[s]=i?-1:2;var c={};this.queue.forEach(function(h){DJ(h.loaded,[u],l),MJ(h.pending,s),i&&h.errors.push(i),h.pending.length===0&&!h.done&&(Object.keys(h.loaded).forEach(function(f){c[f]||(c[f]=[]),h.loaded[f].length&&h.loaded[f].forEach(function(p){c[f].indexOf(p)<0&&c[f].push(p)})}),h.done=!0,h.errors.length?h.callback(h.errors):h.callback())}),this.emit("loaded",c),this.queue=this.queue.filter(function(h){return!h.done})}},{key:"read",value:function(s,i,a){var o=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:350,c=arguments.length>5?arguments[5]:void 0;return s.length?this.backend[a](s,i,function(h,f){if(h&&f&&u<5){setTimeout(function(){o.read.call(o,s,i,a,u+1,l*2,c)},l);return}c(h,f)}):c(null,{})}},{key:"prepareLoading",value:function(s,i){var a=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),u&&u();typeof s=="string"&&(s=this.languageUtils.toResolveHierarchy(s)),typeof i=="string"&&(i=[i]);var l=this.queueLoad(s,i,o,u);if(!l.toLoad.length)return l.pending.length||u(),null;l.toLoad.forEach(function(c){a.loadOne(c)})}},{key:"load",value:function(s,i,a){this.prepareLoading(s,i,{},a)}},{key:"reload",value:function(s,i,a){this.prepareLoading(s,i,{reload:!0},a)}},{key:"loadOne",value:function(s){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",o=s.split("|"),u=o[0],l=o[1];this.read(u,l,"read",void 0,void 0,function(c,h){c&&i.logger.warn("".concat(a,"loading namespace ").concat(l," for language ").concat(u," failed"),c),!c&&h&&i.logger.log("".concat(a,"loaded namespace ").concat(l," for language ").concat(u),h),i.loaded(s,c,h)})}},{key:"saveMissing",value:function(s,i,a,o,u){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(i)){this.logger.warn('did not save key "'.concat(a,'" as the namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}a==null||a===""||(this.backend&&this.backend.create&&this.backend.create(s,i,a,o,null,Ys({},l,{isUpdate:u})),!(!s||!s[0])&&this.store.addResource(s[0],i,a,o))}}]),t}(Al);function BJ(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var n={};if(eo(t[1])==="object"&&(n=t[1]),typeof t[1]=="string"&&(n.defaultValue=t[1]),typeof t[2]=="string"&&(n.tDescription=t[2]),eo(t[2])==="object"||eo(t[3])==="object"){var s=t[3]||t[2];Object.keys(s).forEach(function(i){n[i]=s[i]})}return n},interpolation:{escapeValue:!0,format:function(t,n,s,i){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function gF(r){return typeof r.ns=="string"&&(r.ns=[r.ns]),typeof r.fallbackLng=="string"&&(r.fallbackLng=[r.fallbackLng]),typeof r.fallbackNS=="string"&&(r.fallbackNS=[r.fallbackNS]),r.whitelist&&(r.whitelist&&r.whitelist.indexOf("cimode")<0&&(r.whitelist=r.whitelist.concat(["cimode"])),r.supportedLngs=r.whitelist),r.nonExplicitWhitelist&&(r.nonExplicitSupportedLngs=r.nonExplicitWhitelist),r.supportedLngs&&r.supportedLngs.indexOf("cimode")<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),r}function Cy(){}var PJ=function(r){rv(t,r);function t(){var n,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(Bo(this,t),n=Qm(this,ld(t).call(this)),sv&&Al.call(Jc(n)),n.options=gF(s),n.services={},n.logger=mu,n.modules={external:[]},i&&!n.isInitialized&&!s.isClone){if(!n.options.initImmediate)return n.init(s,i),Qm(n,Jc(n));setTimeout(function(){n.init(s,i)},0)}return n}return Po(t,[{key:"init",value:function(){var s=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;typeof i=="function"&&(a=i,i={}),i.whitelist&&!i.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),i.nonExplicitWhitelist&&!i.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=Ys({},BJ(),this.options,gF(i)),this.format=this.options.interpolation.format,a||(a=Cy);function o(y){return y?typeof y=="function"?new y:y:null}if(!this.options.isClone){this.modules.logger?mu.init(o(this.modules.logger),this.options):mu.init(null,this.options);var u=new AJ(this.options);this.store=new kJ(this.options.resources,this.options);var l=this.services;l.logger=mu,l.resourceStore=this.store,l.languageUtils=u,l.pluralResolver=new RJ(u,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),l.interpolator=new OJ(this.options),l.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},l.backendConnector=new LJ(o(this.modules.backend),l.resourceStore,l,this.options),l.backendConnector.on("*",function(y){for(var x=arguments.length,v=new Array(x>1?x-1:0),S=1;S<x;S++)v[S-1]=arguments[S];s.emit.apply(s,[y].concat(v))}),this.modules.languageDetector&&(l.languageDetector=o(this.modules.languageDetector),l.languageDetector.init(l,this.options.detection,this.options)),this.modules.i18nFormat&&(l.i18nFormat=o(this.modules.i18nFormat),l.i18nFormat.init&&l.i18nFormat.init(this)),this.translator=new mF(this.services,this.options),this.translator.on("*",function(y){for(var x=arguments.length,v=new Array(x>1?x-1:0),S=1;S<x;S++)v[S-1]=arguments[S];s.emit.apply(s,[y].concat(v))}),this.modules.external.forEach(function(y){y.init&&y.init(s)})}if(this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var h=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];h.forEach(function(y){s[y]=function(){var x;return(x=s.store)[y].apply(x,arguments)}});var f=["addResource","addResources","addResourceBundle","removeResourceBundle"];f.forEach(function(y){s[y]=function(){var x;return(x=s.store)[y].apply(x,arguments),s}});var p=sm(),g=function(){var x=function(S,w){s.isInitialized&&s.logger.warn("init: i18next is already initialized. You should call init just once!"),s.isInitialized=!0,s.options.isClone||s.logger.log("initialized",s.options),s.emit("initialized",s.options),p.resolve(w),a(S,w)};if(s.languages&&s.options.compatibilityAPI!=="v1"&&!s.isInitialized)return x(null,s.t.bind(s));s.changeLanguage(s.options.lng,x)};return this.options.resources||!this.options.initImmediate?g():setTimeout(g,0),p}},{key:"loadResources",value:function(s){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cy,o=a,u=typeof s=="string"?s:this.language;if(typeof s=="function"&&(o=s),!this.options.resources||this.options.partialBundledLanguages){if(u&&u.toLowerCase()==="cimode")return o();var l=[],c=function(p){if(p){var g=i.services.languageUtils.toResolveHierarchy(p);g.forEach(function(y){l.indexOf(y)<0&&l.push(y)})}};if(u)c(u);else{var h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.forEach(function(f){return c(f)})}this.options.preload&&this.options.preload.forEach(function(f){return c(f)}),this.services.backendConnector.load(l,this.options.ns,o)}else o(null)}},{key:"reloadResources",value:function(s,i,a){var o=sm();return s||(s=this.languages),i||(i=this.options.ns),a||(a=Cy),this.services.backendConnector.reload(s,i,function(u){o.resolve(),a(u)}),o}},{key:"use",value:function(s){if(!s)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!s.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return s.type==="backend"&&(this.modules.backend=s),(s.type==="logger"||s.log&&s.warn&&s.error)&&(this.modules.logger=s),s.type==="languageDetector"&&(this.modules.languageDetector=s),s.type==="i18nFormat"&&(this.modules.i18nFormat=s),s.type==="postProcessor"&&s9.addPostProcessor(s),s.type==="3rdParty"&&this.modules.external.push(s),this}},{key:"changeLanguage",value:function(s,i){var a=this;this.isLanguageChangingTo=s;var o=sm();this.emit("languageChanging",s);var u=function(h,f){f?(a.language=f,a.languages=a.services.languageUtils.toResolveHierarchy(f),a.translator.changeLanguage(f),a.isLanguageChangingTo=void 0,a.emit("languageChanged",f),a.logger.log("languageChanged",f)):a.isLanguageChangingTo=void 0,o.resolve(function(){return a.t.apply(a,arguments)}),i&&i(h,function(){return a.t.apply(a,arguments)})},l=function(h){var f=typeof h=="string"?h:a.services.languageUtils.getBestMatchFromCodes(h);f&&(a.language||(a.language=f,a.languages=a.services.languageUtils.toResolveHierarchy(f)),a.translator.language||a.translator.changeLanguage(f),a.services.languageDetector&&a.services.languageDetector.cacheUserLanguage(f)),a.loadResources(f,function(p){u(p,f)})};return!s&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!s&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(l):l(s),o}},{key:"getFixedT",value:function(s,i){var a=this,o=function u(l,c){var h;if(eo(c)!=="object"){for(var f=arguments.length,p=new Array(f>2?f-2:0),g=2;g<f;g++)p[g-2]=arguments[g];h=a.options.overloadTranslationOptionHandler([l,c].concat(p))}else h=Ys({},c);return h.lng=h.lng||u.lng,h.lngs=h.lngs||u.lngs,h.ns=h.ns||u.ns,a.t(l,h)};return typeof s=="string"?o.lng=s:o.lngs=s,o.ns=i,o}},{key:"t",value:function(){var s;return this.translator&&(s=this.translator).translate.apply(s,arguments)}},{key:"exists",value:function(){var s;return this.translator&&(s=this.translator).exists.apply(s,arguments)}},{key:"setDefaultNamespace",value:function(s){this.options.defaultNS=s}},{key:"hasLoadedNamespace",value:function(s){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var o=this.languages[0],u=this.options?this.options.fallbackLng:!1,l=this.languages[this.languages.length-1];if(o.toLowerCase()==="cimode")return!0;var c=function(p,g){var y=i.services.backendConnector.state["".concat(p,"|").concat(g)];return y===-1||y===2};if(a.precheck){var h=a.precheck(this,c);if(h!==void 0)return h}return!!(this.hasResourceBundle(o,s)||!this.services.backendConnector.backend||c(o,s)&&(!u||c(l,s)))}},{key:"loadNamespaces",value:function(s,i){var a=this,o=sm();return this.options.ns?(typeof s=="string"&&(s=[s]),s.forEach(function(u){a.options.ns.indexOf(u)<0&&a.options.ns.push(u)}),this.loadResources(function(u){o.resolve(),i&&i(u)}),o):(i&&i(),Promise.resolve())}},{key:"loadLanguages",value:function(s,i){var a=sm();typeof s=="string"&&(s=[s]);var o=this.options.preload||[],u=s.filter(function(l){return o.indexOf(l)<0});return u.length?(this.options.preload=o.concat(u),this.loadResources(function(l){a.resolve(),i&&i(l)}),a):(i&&i(),Promise.resolve())}},{key:"dir",value:function(s){if(s||(s=this.languages&&this.languages.length>0?this.languages[0]:this.language),!s)return"rtl";var i=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"];return i.indexOf(this.services.languageUtils.getLanguagePartFromCode(s))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;return new t(s,i)}},{key:"cloneInstance",value:function(){var s=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cy,o=Ys({},this.options,i,{isClone:!0}),u=new t(o),l=["store","services","language"];return l.forEach(function(c){u[c]=s[c]}),u.services=Ys({},this.services),u.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u.translator=new mF(u.services,u.options),u.translator.on("*",function(c){for(var h=arguments.length,f=new Array(h>1?h-1:0),p=1;p<h;p++)f[p-1]=arguments[p];u.emit.apply(u,[c].concat(f))}),u.init(o,a),u.translator.options=u.options,u.translator.backendConnector.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u}}]),t}(Al),i9=new PJ,a9=[],VJ=a9.forEach,zJ=a9.slice;function UJ(r){return VJ.call(zJ.call(arguments,1),function(t){if(t)for(var n in t)r[n]===void 0&&(r[n]=t[n])}),r}var yF={create:function(t,n,s,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/"},o;if(s){var u=new Date;u.setTime(u.getTime()+s*60*1e3),o="; expires="+u.toUTCString()}else o="";i=i?"domain="+i+";":"",a=Object.keys(a).reduce(function(l,c){return l+";"+c.replace(/([A-Z])/g,function(h){return"-"+h.toLowerCase()})+"="+a[c]},""),document.cookie=t+"="+encodeURIComponent(n)+o+";"+i+a},read:function(t){for(var n=t+"=",s=document.cookie.split(";"),i=0;i<s.length;i++){for(var a=s[i];a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(n)===0)return a.substring(n.length,a.length)}return null},remove:function(t){this.create(t,"",-1)}},GJ={name:"cookie",lookup:function(t){var n;if(t.lookupCookie&&typeof document<"u"){var s=yF.read(t.lookupCookie);s&&(n=s)}return n},cacheUserLanguage:function(t,n){n.lookupCookie&&typeof document<"u"&&yF.create(n.lookupCookie,t,n.cookieMinutes,n.cookieDomain,n.cookieOptions)}},jJ={name:"querystring",lookup:function(t){var n;if(typeof window<"u")for(var s=window.location.search.substring(1),i=s.split("&"),a=0;a<i.length;a++){var o=i[a].indexOf("=");if(o>0){var u=i[a].substring(0,o);u===t.lookupQuerystring&&(n=i[a].substring(o+1))}}return n}},Bx;try{Bx=window!=="undefined"&&window.localStorage!==null;var xF="i18next.translate.boo";window.localStorage.setItem(xF,"foo"),window.localStorage.removeItem(xF)}catch{Bx=!1}var WJ={name:"localStorage",lookup:function(t){var n;if(t.lookupLocalStorage&&Bx){var s=window.localStorage.getItem(t.lookupLocalStorage);s&&(n=s)}return n},cacheUserLanguage:function(t,n){n.lookupLocalStorage&&Bx&&window.localStorage.setItem(n.lookupLocalStorage,t)}},Px;try{Px=window!=="undefined"&&window.sessionStorage!==null;var bF="i18next.translate.boo";window.sessionStorage.setItem(bF,"foo"),window.sessionStorage.removeItem(bF)}catch{Px=!1}var HJ={name:"sessionStorage",lookup:function(t){var n;if(t.lookupsessionStorage&&Px){var s=window.sessionStorage.getItem(t.lookupsessionStorage);s&&(n=s)}return n},cacheUserLanguage:function(t,n){n.lookupsessionStorage&&Px&&window.sessionStorage.setItem(n.lookupsessionStorage,t)}},qJ={name:"navigator",lookup:function(t){var n=[];if(typeof navigator<"u"){if(navigator.languages)for(var s=0;s<navigator.languages.length;s++)n.push(navigator.languages[s]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return n.length>0?n:void 0}},KJ={name:"htmlTag",lookup:function(t){var n,s=t.htmlTag||(typeof document<"u"?document.documentElement:null);return s&&typeof s.getAttribute=="function"&&(n=s.getAttribute("lang")),n}},XJ={name:"path",lookup:function(t){var n;if(typeof window<"u"){var s=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(s instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof s[t.lookupFromPathIndex]!="string")return;n=s[t.lookupFromPathIndex].replace("/","")}else n=s[0].replace("/","")}return n}},YJ={name:"subdomain",lookup:function(t){var n;if(typeof window<"u"){var s=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);s instanceof Array&&(typeof t.lookupFromSubdomainIndex=="number"?n=s[t.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".",""):n=s[0].replace("http://","").replace("https://","").replace(".",""))}return n}};function ZJ(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],checkWhitelist:!0,checkForSimilarInWhitelist:!1}}var o9=function(){function r(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Bo(this,r),this.type="languageDetector",this.detectors={},this.init(t,n)}return Po(r,[{key:"init",value:function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=n,this.options=UJ(s,this.options||{},ZJ()),this.options.checkForSimilarInWhitelist&&(this.options.checkWhitelist=!0),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=i,this.addDetector(GJ),this.addDetector(jJ),this.addDetector(WJ),this.addDetector(HJ),this.addDetector(qJ),this.addDetector(KJ),this.addDetector(XJ),this.addDetector(YJ)}},{key:"addDetector",value:function(n){this.detectors[n.name]=n}},{key:"detect",value:function(n){var s=this;n||(n=this.options.order);var i=[];n.forEach(function(u){if(s.detectors[u]){var l=s.detectors[u].lookup(s.options);l&&typeof l=="string"&&(l=[l]),l&&(i=i.concat(l))}});var a;if(i.forEach(function(u){if(!a){var l=s.services.languageUtils.formatLanguageCode(u);(!s.options.checkWhitelist||s.services.languageUtils.isWhitelisted(l))&&(a=l),!a&&s.options.checkForSimilarInWhitelist&&(a=s.getSimilarInWhitelist(l))}}),!a){var o=this.i18nOptions.fallbackLng;typeof o=="string"&&(o=[o]),o||(o=[]),Object.prototype.toString.apply(o)==="[object Array]"?a=o[0]:a=o[0]||o.default&&o.default[0]}return a}},{key:"cacheUserLanguage",value:function(n,s){var i=this;s||(s=this.options.caches),s&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(n)>-1||s.forEach(function(a){i.detectors[a]&&i.detectors[a].cacheUserLanguage(n,i.options)}))}},{key:"getSimilarInWhitelist",value:function(n){var s=this;if(this.i18nOptions.whitelist){if(n.includes("-")){var i=n.split("-")[0],a=this.services.languageUtils.formatLanguageCode(i);if(this.services.languageUtils.isWhitelisted(a))return a;n=a}var o=this.i18nOptions.whitelist.find(function(u){var l=s.services.languageUtils.formatLanguageCode(u);if(l.startsWith(n))return l});if(o)return o}}}]),r}();o9.type="languageDetector";var QJ={autoplay:`The media that tried to play (with '{{src}}') wasn't allowed to by this browser, most likely due to the browser's autoplay policy.

+ More info: {{url}}`,checkUserDefinedFns:"It seems that you may have accidentally written {{name}} instead of {{actualName}}. Please correct it if it's not intentional.",fileLoadError:{bytes:"It looks like there was a problem loading your file. {{suggestion}}",font:"It looks like there was a problem loading your font. {{suggestion}}",gif:"There was some trouble loading your GIF. Make sure that your GIF is using 87a or 89a encoding.",image:"It looks like there was a problem loading your image. {{suggestion}}",json:"It looks like there was a problem loading your JSON file. {{suggestion}}",large:"If your large file isn't fetched successfully, we recommend splitting the file into smaller segments and fetching those.",strings:"It looks like there was a problem loading your text file. {{suggestion}}",suggestion:`Try checking if the file path ({{filePath}}) is correct, hosting the file online, or running a local server.

+ More info: {{url}}`,table:"It looks like there was a problem loading your table file. {{suggestion}}",xml:"It looks like there was a problem loading your XML file. {{suggestion}}"},friendlyParamError:{type_EMPTY_VAR:`{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received an empty variable instead. If not intentional, this is often a problem with scope.

+ More info: {{url}}`,type_TOO_FEW_ARGUMENTS:"{{location}} {{func}}() was expecting at least {{minParams}} arguments, but received only {{argCount}}.",type_TOO_MANY_ARGUMENTS:"{{location}} {{func}}() was expecting no more than {{maxParams}} arguments, but received {{argCount}}.",type_WRONG_TYPE:"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received {{argType}} instead."},globalErrors:{reference:{cannotAccess:`
{{location}} "{{symbol}}" is used before declaration. Make sure you have declared the variable before using it.

+ More info: {{url}}`,notDefined:`
{{location}} "{{symbol}}" is not defined in the current scope. If you have defined it in your code, you should check its scope, spelling, and letter-casing (JavaScript is case-sensitive).

+ More info: {{url}}`},stackSubseq:`[{{location}}] 
	 Called from line {{line}} in {{func}}()
`,stackTop:`[{{location}}] 
	 Error at line {{line}} in {{func}}()
`,syntax:{badReturnOrYield:`
Syntax Error - return lies outside of a function. Make sure youre not missing any brackets, so that return lies inside a function.

+ More info: {{url}}`,invalidToken:`
Syntax Error - Found a symbol that JavaScript doesn't recognize or didn't expect at it's place.

+ More info: {{url}}`,missingInitializer:`
Syntax Error - A const variable is declared but not initialized. In JavaScript, an initializer for a const is required. A value must be specified in the same statement in which the variable is declared. Check the line number in the error and assign the const variable a value.

+ More info: {{url}}`,redeclaredVariable:`
Syntax Error - "{{symbol}}" is being redeclared. JavaScript doesn't allow declaring a variable more than once. Check the line number in error for redeclaration of the variable.

+ More info: {{url}}`,unexpectedToken:`
Syntax Error - Symbol present at a place that wasn't expected.
Usually this is due to a typo. Check the line number in the error for anything missing/extra.

+ More info: {{url}}`},type:{constAssign:`
{{location}} A const variable is being re-assigned. In javascript, re-assigning a value to a constant is not allowed. If you want to re-assign new values to a variable, make sure it is declared as var or let.

+ More info: {{url}}`,notfunc:`
{{location}} "{{symbol}}" could not be called as a function.
Check the spelling, letter-casing (JavaScript is case-sensitive) and its type.

+ More info: {{url}}`,notfuncObj:`
{{location}} "{{symbol}}" could not be called as a function.
Verify whether "{{obj}}" has "{{symbol}}" in it and check the spelling, letter-casing (JavaScript is case-sensitive) and its type.

+ More info: {{url}}`,readFromNull:`
{{location}} The property of null can't be read. In javascript the value null indicates that an object has no value.

+ More info: {{url}}`,readFromUndefined:`
{{location}} Cannot read property of undefined. Check the line number in error and make sure the variable which is being operated is not undefined.

 + More info: {{url}}`}},libraryError:'{{location}} An error with message "{{error}}" occurred inside the p5js library when {{func}} was called. If not stated otherwise, it might be an issue with the arguments passed to {{func}}.',location:"[{{file}}, line {{line}}]",misspelling:'{{location}} It seems that you may have accidentally written "{{name}}" instead of "{{actualName}}". Please correct it to {{actualName}} if you wish to use the {{type}} from p5.js.',misspelling_plural:`{{location}} It seems that you may have accidentally written "{{name}}".
You may have meant one of the following: 
{{suggestions}}`,misusedTopLevel:`Did you just try to use p5.js's {{symbolName}} {{symbolType}}? If so, you may want to move it into your sketch's setup() function.

+ More info: {{url}}`,preloadDisabled:"The preload() function has been removed in p5.js 2.0. Please load assets in setup() using async / await keywords or callbacks instead. See https://dev.to/limzykenneth/asynchronous-p5js-20-458f for more information.",positions:{p_1:"first",p_10:"tenth",p_11:"eleventh",p_12:"twelfth",p_2:"second",p_3:"third",p_4:"fourth",p_5:"fifth",p_6:"sixth",p_7:"seventh",p_8:"eighth",p_9:"ninth"},pre:`
 p5.js says: {{message}}`,sketchReaderErrors:{reservedConst:`you have used a p5.js reserved variable "{{symbol}}" make sure you change the variable name to something else.

+ More info: {{url}}`,reservedFunc:`you have used a p5.js reserved function "{{symbol}}" make sure you change the function name to something else.

+ More info: {{url}}`},welcome:"Welcome! This is your friendly debugger. To turn me off, switch to using p5.min.js.",wrongPreload:'{{location}} An error with message "{{error}}" occurred inside the p5js library when "{{func}}" was called. If not stated otherwise, it might be due to "{{func}}" being called from preload. Nothing besides load calls (loadImage, loadJSON, loadFont, loadStrings, etc.) should be inside the preload function.'},JJ={fes:QJ},Im={en:{translation:JJ}};const eee=["en","es","ko","zh","hi","ja"];if(typeof IS_MINIFIED>"u"&&typeof P5_DEV_BUILD<"u"){let r=require("../../translations/dev");for(const t of Object.keys(r)){const n=t.split("_"),s=n.slice(0,n.length-1).join("-"),i=n[n.length-1];Im[s]=Im[s]||{},Im[s][i]=r[t]}}class u9{constructor(t,n){this.init(t,n)}fetchWithTimeout(t,n,s=2e3){return Promise.race([fetch(t,n),new Promise((i,a)=>setTimeout(()=>a(new Error("timeout")),s))])}init(t,n={}){this.services=t,this.options=n}read(t,n,s){const i=this.options.loadPath;if(t===this.options.fallback)s(null,Im[t][n]);else if(eee.includes(t)){const a=this.services.interpolator.interpolate(i,{lng:t,ns:n});this.loadUrl(a,s)}else s("Not found",!1)}loadUrl(t,n){this.fetchWithTimeout(t).then(s=>{if(!s.ok)throw new Error(`failed loading ${t}`);return s.json()},()=>{throw new Error(`failed loading ${t}`)}).then(s=>n(null,s)).catch(n)}}u9.type="backend";let Jt=(r,t)=>{console.debug("p5.js translator called before translations were loaded"),i9.t(r,t)};const tee=()=>i9.use(o9).use(u9).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:Im}).then(t=>{Jt=t},t=>console.debug(`Translations failed to load (${t})`)),nee={ReferenceError:[{msg:"{{}} is not defined",type:"NOTDEFINED",browser:"all"},{msg:"Can't find variable: {{}}",type:"NOTDEFINED",browser:"Safari"},{msg:"Cannot access '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Chrome"},{msg:"can't access lexical declaration '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Firefox"}],SyntaxError:[{msg:"illegal character",type:"INVALIDTOKEN",browser:"Firefox"},{msg:"Invalid character",type:"INVALIDTOKEN",browser:"Safari"},{msg:"Invalid or unexpected token",type:"INVALIDTOKEN",browser:"Chrome"},{msg:"Unexpected token '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"expected {{.}}, got '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"Identifier '{{.}}' has already been declared",type:"REDECLAREDVARIABLE",browser:"Chrome"},{msg:"redeclaration of {} {{.}}",type:"REDECLAREDVARIABLE",browser:"Firefox"},{msg:"Missing initializer in const declaration",type:"MISSINGINITIALIZER",browser:"Chrome"},{msg:"missing = in const declaration",type:"MISSINGINITIALIZER",browser:"Firefox"},{msg:"Illegal return statement",type:"BADRETURNORYIELD",browser:"Chrome"},{msg:"return not in function",type:"BADRETURNORYIELD",browser:"Firefox"}],TypeError:[{msg:"{{.}} is not a function",type:"NOTFUNC",browser:"all"},{msg:"Cannot read {{.}} null",type:"READNULL",browser:"Chrome"},{msg:"{{.}} is null",type:"READNULL",browser:"Firefox"},{msg:"Cannot read {{.}} undefined",type:"READUDEFINED",browser:"Chrome"},{msg:"{{.}} is undefined",type:"READUDEFINED",browser:"Firefox"},{msg:"Assignment to constant variable",type:"CONSTASSIGN",browser:"Chrome"},{msg:"invalid assignment to const '{{.}}'",type:"CONSTASSIGN",browser:"Firefox"}]};function l9(r,t){const n=["#2D7BB6","#EE9900","#4DB200","#C83C00"];let s=null,i=null;const a=2;class o extends Error{}if(typeof IS_MINIFIED<"u")r._friendlyError=r._checkForUserDefinedFunctions=r._fesErrorMonitor=()=>{};else{const c={},h=c.toString,f=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(let D=0;D<f.length;D++)c[`[object ${f[D]}]`]=f[D].toLowerCase();const p=D=>D==null?`${D}`:typeof D=="object"||typeof D=="function"?c[h.call(D)]||"object":typeof D,g=["setup","draw","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized"],y=(D,I)=>{let k="";if(I==null||I.substring(0,4)==="load")k=D;else{const A=I.split("."),N=A.length>1?`${A[0]}.${A[1]}`:"p5",F=A.length===1?I:A.slice(2).join("/");F.startsWith("p5.")?k=`${D} (https://p5js.org/reference/${N}.${F})`:k=`${D} (https://p5js.org/reference/${N}/${F})`}return k};r._report=(D,I,k)=>{const A=r._fesLogger==null?console.log.bind(console):r._fesLogger;p(k)==="undefined"?k="#B40033":p(k)==="number"&&(k=n[k]),D=y(D,I);const N=Jt("fes.pre",{message:D});A(N)},r._error=(D,I,k)=>{throw r._report(I,k),D.hitCriticalError=!0,new o("Stopping sketch to prevent more errors")},r._friendlyError=function(D,I,k){r._report(D,I,k)},r._friendlyAutoplayError=function(D){const I=Jt("fes.autoplay",{src:D,url:"https://developer.mozilla.org/docs/Web/Media/Autoplay_guide"});console.log(Jt("fes.pre",{message:I}))};const x=(D,I)=>{const k=D.length,A=I.length;if(k===0)return I;if(A===0)return D;let N=[],F=[];for(let $=0;$<A+1;$++)F[$]=$;N=F;for(let $=1;$<k+1;$++){F=[];for(let O=0;O<A+1;O++)if(O===0)F[O]=$;else{let M=D[$-1],B=I[O-1],U=999999,V=M.toLowerCase()===B.toLowerCase()?0:1;U=U>V+N[O-1]?V+N[O-1]:U,U=U>1+F[O-1]?1+F[O-1]:U,U=U>1+N[O]?1+N[O]:U,F[O]=U}N=F}return F[A]};r.isPreloadSupported=function(){return!1};const v=D=>{if(r.disableFriendlyErrors)return;D=D instanceof r?D:window;const k=g;D.preload&&!r.isPreloadSupported()&&r._error(D,Jt("fes.preloadDisabled"));const A={};k.forEach(N=>{A[N.toLowerCase()]=N});for(const N of Object.keys(D)){const F=N.toLowerCase();if(A.hasOwnProperty(F)&&!D[A[F]]&&typeof D[N]=="function"){const $=Jt("fes.checkUserDefinedFns",{name:N,actualName:A[F]});r._friendlyError($,A[F])}}},S=(D,I)=>{s||i();const k={};let A=999999;if(s.forEach(F=>{let $=x(D,F.name);k[$]?k[$].push(F):k[$]=[F],$<A&&(A=$)}),A>Math.min(a,D.length))return!1;const N=k[A].filter(F=>F.name!==D);if(N.length!==0){const F=r._getErrorStackParser().parse(I);let $;F&&F[0]&&F[0].fileName&&F[0].lineNumber&&F[0].columnNumber&&($={location:`${F[0].fileName}:${F[0].lineNumber}:${F[0].columnNumber}`,file:F[0].fileName.split("/").slice(-1),line:F[0].lineNumber});let O;if(N.length===1)O=Jt("fes.misspelling",{name:D,actualName:N[0].name,type:N[0].type,location:$?Jt("fes.location",$):"",count:N.length});else{const M=N.map(B=>{const U=" "+B.name+(B.type==="function"?"()":"");return y(U,B.name)}).join(`
`);O=Jt("fes.misspelling",{name:D,suggestions:M,location:$?Jt("fes.location",$):"",count:N.length})}return r._friendlyError(O,N.length===1?N[0].name:void 0),!0}return!1},w=D=>{const I=r._fesLogger&&typeof r._fesLogger=="function"?r._fesLogger:console.log.bind(console);if(D.length>1){let k="";D.forEach((A,N)=>{const F=`${A.fileName}:${A.lineNumber}:${A.columnNumber}`;let $,O={func:A.functionName,line:A.lineNumber,location:F,file:A.fileName.split("/").slice(-1)};N===0?$=Jt("fes.globalErrors.stackTop",O):$=Jt("fes.globalErrors.stackSubseq",O),k+=$}),I(k)}},E=(D,I)=>{if(!I)return[!1,null];I.forEach($=>{$.functionName=$.functionName||""});let k=!1,A,N,F;try{throw new Error}catch($){A=r._getErrorStackParser().parse($)[0].fileName}for(let $=I.length-1;$>=0;$--){let O=I[$].functionName.split(".");if(g.includes(O[O.length-1])){if(N=I.slice(0,$+1),F=O[O.length-1],I[0].fileName===A){k=!0;break}break}}if(N||(N=I),k){if(N=N.map((M,B)=>(M.frameIndex=B,M)).filter(M=>M.fileName!==A),N.length===0)return[!0,null];const $=I[N[0].frameIndex-2].functionName.split(".").slice(-1)[0];let O;if(N[0].fileName&&N[0].lineNumber&&N[0].columnNumber&&(O={location:`${N[0].fileName}:${N[0].lineNumber}:${N[0].columnNumber}`,file:N[0].fileName.split("/").slice(-1),line:N[0].lineNumber},r._fesLogCache[O.location]))return[!0,null];F==="preload"&&t._preloadMethods[$]==null?r._friendlyError(Jt("fes.wrongPreload",{func:$,location:O?Jt("fes.location",O):"",error:D.message}),"preload"):r._friendlyError(Jt("fes.libraryError",{func:$,location:O?Jt("fes.location",O):"",error:D.message}),$),N&&N.length&&w(N)}return[k,N]},_=D=>{if(r.disableFriendlyErrors||D&&(D instanceof o||D.reason instanceof o))return;let I;if(D instanceof Error)I=D;else if(D instanceof ErrorEvent)I=D.error;else if(D instanceof PromiseRejectionEvent&&(I=D.reason,!(I instanceof Error)))return;if(!I)return;let k=r._getErrorStackParser().parse(I),[A,N]=E(I,k);if(A)return;const F=nee[I.name];if(!F)return;let $;for(const M of F){let B=M.msg;B=B.replace(new RegExp("{{}}","g"),"([a-zA-Z0-9_]+)"),B=B.replace(new RegExp("{{.}}","g"),"(.+)"),B=B.replace(new RegExp("{}","g"),"(?:[a-zA-Z0-9_]+)");let U=I.message.match(B);if(U){$=Object.assign({},M),$.match=U;break}}if(!$)return;let O;switch(k&&k[0].fileName&&k[0].lineNumber&&k[0].columnNumber&&(O={location:`${k[0].fileName}:${k[0].lineNumber}:${k[0].columnNumber}`,file:k[0].fileName.split("/").slice(-1),line:N[0].lineNumber}),I.name){case"SyntaxError":{switch($.type){case"INVALIDTOKEN":{r._friendlyError(Jt("fes.globalErrors.syntax.invalidToken",{url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Illegal_character#What_went_wrong"}));break}case"UNEXPECTEDTOKEN":{r._friendlyError(Jt("fes.globalErrors.syntax.unexpectedToken",{url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Unexpected_token#What_went_wrong"}));break}case"REDECLAREDVARIABLE":{let M=$.match[1];r._friendlyError(Jt("fes.globalErrors.syntax.redeclaredVariable",{symbol:M,url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Redeclared_parameter#what_went_wrong"}));break}case"MISSINGINITIALIZER":{r._friendlyError(Jt("fes.globalErrors.syntax.missingInitializer",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Missing_initializer_in_const#what_went_wrong"}));break}case"BADRETURNORYIELD":{r._friendlyError(Jt("fes.globalErrors.syntax.badReturnOrYield",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_return_or_yield#what_went_wrong"}));break}}break}case"ReferenceError":{switch($.type){case"NOTDEFINED":{let M=$.match[1];if(M&&S(M,I))break;r._friendlyError(Jt("fes.globalErrors.reference.notDefined",{url:"https://p5js.org/examples/data-variable-scope.html",symbol:M,location:O?Jt("fes.location",O):""})),N&&w(N);break}case"CANNOTACCESS":{let M=$.match[1];r._friendlyError(Jt("fes.globalErrors.reference.cannotAccess",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_lexical_declaration_before_init#what_went_wrong",symbol:M,location:O?Jt("fes.location",O):""})),N&&w(N);break}}break}case"TypeError":switch($.type){case"NOTFUNC":{let B=$.match[1].split("."),V={url:"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Not_a_function#What_went_wrong",symbol:B[B.length-1],obj:B.slice(0,B.length-1).join("."),location:O?Jt("fes.location",O):""};B.length>1?r._friendlyError(Jt("fes.globalErrors.type.notfuncObj",V)):r._friendlyError(Jt("fes.globalErrors.type.notfunc",V)),N&&w(N);break}case"READNULL":{let M=$.match[1];r._friendlyError(Jt("fes.globalErrors.type.readFromNull",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong",symbol:M,location:O?Jt("fes.location",O):""})),N&&w(N);break}case"READUDEFINED":{let M=$.match[1];r._friendlyError(Jt("fes.globalErrors.type.readFromUndefined",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong",symbol:M,location:O?Jt("fes.location",O):""})),N&&w(N);break}case"CONSTASSIGN":{r._friendlyError(Jt("fes.globalErrors.type.constAssign",{url:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Invalid_const_assignment#what_went_wrong",location:O?Jt("fes.location",O):""})),N&&w(N);break}}}};r._fesErrorMonitor=_,r._checkForUserDefinedFunctions=v,r._fesLogger=null,r._fesLogCache={},window.addEventListener("load",v,!1),window.addEventListener("error",r._fesErrorMonitor,!1),window.addEventListener("unhandledrejection",r._fesErrorMonitor,!1)}s=null;const u="https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup";i=()=>{const c={},h=f=>Object.getOwnPropertyNames(f).filter(p=>p[0]==="_"||p in c?!1:(c[p]=!0,!0)).map(p=>{let g;return typeof f[p]=="function"?g="function":p===p.toUpperCase()?g="constant":g="variable",{name:p,type:g}});s=[].concat(h(t),h(qc)),s.sort((f,p)=>p.name.length-f.name.length)};const l=(c,h)=>{h||(h=console.log.bind(console)),s||i(),s.some(f=>{if(c.message&&c.message.match(`\\W?${f.name}\\W`)!==null){const p=f.type==="function"?`${f.name}()`:f.name;return h(typeof IS_MINIFIED<"u"?`Did you just try to use p5.js's ${p} ${f.type}? If so, you may want to move it into your sketch's setup() function.

For more details, see: ${u}`:Jt("fes.misusedTopLevel",{symbolName:p,symbolType:f.type,url:u})),!0}})};t._helpForMisusedAtTopLevelCode=l,document.readyState!=="complete"&&(window.addEventListener("error",l,!1),window.addEventListener("load",()=>{window.removeEventListener("error",l,!1)}))}typeof p5<"u"&&l9(p5,p5.prototype);function ree(){let r=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,n=/^(eval@)?(\[native code])?$/;return{parse:function(i){if(typeof i.stacktrace<"u"||typeof i["opera#sourceloc"]<"u")return this.parseOpera(i);if(i.stack&&i.stack.match(t))return this.parseV8OrIE(i);if(i.stack)return this.parseFFOrSafari(i)},extractLocation:function(i){if(i.indexOf(":")===-1)return[i];let o=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(i.replace(/[()]/g,""));return[o[1],o[2]||void 0,o[3]||void 0]},parseV8OrIE:function(i){return i.stack.split(`
`).filter(function(o){return!!o.match(t)},this).map(function(o){o.indexOf("(eval ")>-1&&(o=o.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let u=o.replace(/^\s+/,"").replace(/\(eval code/g,"("),l=u.match(/ (\((.+):(\d+):(\d+)\)$)/);u=l?u.replace(l[0],""):u;let c=u.split(/\s+/).slice(1),h=this.extractLocation(l?l[1]:c.pop()),f=c.join(" ")||void 0,p=["eval","<anonymous>"].indexOf(h[0])>-1?void 0:h[0];return{functionName:f,fileName:p,lineNumber:h[1],columnNumber:h[2],source:o}},this)},parseFFOrSafari:function(i){return i.stack.split(`
`).filter(function(o){return!o.match(n)},this).map(function(o){if(o.indexOf(" > eval")>-1&&(o=o.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),o.indexOf("@")===-1&&o.indexOf(":")===-1)return{functionName:o};{let u=/((.*".+"[^@]*)?[^@]*)(?:@)/,l=o.match(u),c=l&&l[1]?l[1]:void 0,h=this.extractLocation(o.replace(u,""));return{functionName:c,fileName:h[0],lineNumber:h[1],columnNumber:h[2],source:o}}},this)},parseOpera:function(i){return!i.stacktrace||i.message.indexOf(`
`)>-1&&i.message.split(`
`).length>i.stacktrace.split(`
`).length?this.parseOpera9(i):i.stack?this.parseOpera11(i):this.parseOpera10(i)},parseOpera9:function(i){let a=/Line (\d+).*script (?:in )?(\S+)/i,o=i.message.split(`
`),u=[];for(let l=2,c=o.length;l<c;l+=2){let h=a.exec(o[l]);h&&u.push({fileName:h[2],lineNumber:h[1],source:o[l]})}return u},parseOpera10:function(i){let a=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,o=i.stacktrace.split(`
`),u=[];for(let l=0,c=o.length;l<c;l+=2){let h=a.exec(o[l]);h&&u.push({functionName:h[3]||void 0,fileName:h[2],lineNumber:h[1],source:o[l]})}return u},parseOpera11:function(i){return i.stack.split(`
`).filter(function(o){return!!o.match(r)&&!o.match(/^Error created at/)},this).map(function(o){let u=o.split("@"),l=this.extractLocation(u.pop()),c=u.shift()||"",h=c.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,f;c.match(/\(([^)]*)\)/)&&(f=c.replace(/^[^(]+\(([^)]*)\)$/,"$1"));let p=f===void 0||f==="[arguments not available]"?void 0:f.split(",");return{functionName:h,args:p,fileName:l[0],lineNumber:l[1],columnNumber:l[2],source:o}},this)}}}function c9(r,t){r._getErrorStackParser=function(){return new ree}}typeof p5<"u"&&c9(p5,p5.prototype);var Mn;(function(r){r.assertEqual=i=>{};function t(i){}r.assertIs=t;function n(i){throw new Error}r.assertNever=n,r.arrayToEnum=i=>{const a={};for(const o of i)a[o]=o;return a},r.getValidEnumValues=i=>{const a=r.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),o={};for(const u of a)o[u]=i[u];return r.objectValues(o)},r.objectValues=i=>r.objectKeys(i).map(function(a){return i[a]}),r.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const a=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.push(o);return a},r.find=(i,a)=>{for(const o of i)if(a(o))return o},r.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function s(i,a=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}r.joinValues=s,r.jsonStringifyReplacer=(i,a)=>typeof a=="bigint"?a.toString():a})(Mn||(Mn={}));var vF;(function(r){r.mergeShapes=(t,n)=>({...t,...n})})(vF||(vF={}));const kt=Mn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),il=r=>{switch(typeof r){case"undefined":return kt.undefined;case"string":return kt.string;case"number":return Number.isNaN(r)?kt.nan:kt.number;case"boolean":return kt.boolean;case"function":return kt.function;case"bigint":return kt.bigint;case"symbol":return kt.symbol;case"object":return Array.isArray(r)?kt.array:r===null?kt.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?kt.promise:typeof Map<"u"&&r instanceof Map?kt.map:typeof Set<"u"&&r instanceof Set?kt.set:typeof Date<"u"&&r instanceof Date?kt.date:kt.object;default:return kt.unknown}},mt=Mn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Na extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(a){return a.message},s={_errors:[]},i=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)s._errors.push(n(o));else{let u=s,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(u[c]=u[c]||{_errors:[]},u[c]._errors.push(n(o))):u[c]=u[c]||{_errors:[]},u=u[c],l++}}};return i(this),s}static assert(t){if(!(t instanceof Na))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Mn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},s=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):s.push(t(i));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}Na.create=r=>new Na(r);const Jm=(r,t)=>{let n;switch(r.code){case mt.invalid_type:r.received===kt.undefined?n="Required":n=`Expected ${r.expected}, received ${r.received}`;break;case mt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(r.expected,Mn.jsonStringifyReplacer)}`;break;case mt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Mn.joinValues(r.keys,", ")}`;break;case mt.invalid_union:n="Invalid input";break;case mt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Mn.joinValues(r.options)}`;break;case mt.invalid_enum_value:n=`Invalid enum value. Expected ${Mn.joinValues(r.options)}, received '${r.received}'`;break;case mt.invalid_arguments:n="Invalid function arguments";break;case mt.invalid_return_type:n="Invalid function return type";break;case mt.invalid_date:n="Invalid date";break;case mt.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(n=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?n=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?n=`Invalid input: must end with "${r.validation.endsWith}"`:Mn.assertNever(r.validation):r.validation!=="regex"?n=`Invalid ${r.validation}`:n="Invalid";break;case mt.too_small:r.type==="array"?n=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?n=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?n=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?n=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:n="Invalid input";break;case mt.too_big:r.type==="array"?n=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?n=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?n=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?n=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?n=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:n="Invalid input";break;case mt.custom:n="Invalid input";break;case mt.invalid_intersection_types:n="Intersection results could not be merged";break;case mt.not_multiple_of:n=`Number must be a multiple of ${r.multipleOf}`;break;case mt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Mn.assertNever(r)}return{message:n}};let see=Jm;function nE(){return see}const rE=r=>{const{data:t,path:n,errorMaps:s,issueData:i}=r,a=[...n,...i.path||[]],o={...i,path:a};if(i.message!==void 0)return{...i,path:a,message:i.message};let u="";const l=s.filter(c=>!!c).slice().reverse();for(const c of l)u=c(o,{data:t,defaultError:u}).message;return{...i,path:a,message:u}};function Ct(r,t){const n=nE(),s=rE({issueData:t,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,n,n===Jm?void 0:Jm].filter(i=>!!i)});r.common.issues.push(s)}class Zi{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const s=[];for(const i of n){if(i.status==="aborted")return on;i.status==="dirty"&&t.dirty(),s.push(i.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,n){const s=[];for(const i of n){const a=await i.key,o=await i.value;s.push({key:a,value:o})}return Zi.mergeObjectSync(t,s)}static mergeObjectSync(t,n){const s={};for(const i of n){const{key:a,value:o}=i;if(a.status==="aborted"||o.status==="aborted")return on;a.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(s[a.value]=o.value)}return{status:t.value,value:s}}}const on=Object.freeze({status:"aborted"}),pm=r=>({status:"dirty",value:r}),Ii=r=>({status:"valid",value:r}),wF=r=>r.status==="aborted",SF=r=>r.status==="dirty",cd=r=>r.status==="valid",Vx=r=>typeof Promise<"u"&&r instanceof Promise;var Rt;(function(r){r.errToObj=t=>typeof t=="string"?{message:t}:t||{},r.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Rt||(Rt={}));var zx=function(r,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?r!==t||!s:!t.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(r):s?s.value:t.get(r)},h9=function(r,t,n,s,i){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?r!==t||!i:!t.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?i.call(r,n):i?i.value=n:t.set(r,n),n},mm,gm;class Il{constructor(t,n,s,i){this._cachedPath=[],this.parent=t,this.data=n,this._path=s,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const CF=(r,t)=>{if(cd(t))return{success:!0,data:t.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Na(r.common.issues);return this._error=n,this._error}}};function yn(r){if(!r)return{};const{errorMap:t,invalid_type_error:n,required_error:s,description:i}=r;if(t&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(o,u)=>{const{message:l}=r;return o.code==="invalid_enum_value"?{message:l??u.defaultError}:typeof u.data>"u"?{message:l??s??u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:l??n??u.defaultError}},description:i}}class In{get description(){return this._def.description}_getType(t){return il(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:il(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Zi,ctx:{common:t.parent.common,data:t.data,parsedType:il(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Vx(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const s=this.safeParse(t,n);if(s.success)return s.data;throw s.error}safeParse(t,n){const s={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:il(t)},i=this._parseSync({data:t,path:s.path,parent:s});return CF(s,i)}"~validate"(t){var s,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:il(t)};if(!this["~standard"].async)try{const a=this._parseSync({data:t,path:[],parent:n});return cd(a)?{value:a.value}:{issues:n.common.issues}}catch(a){(i=(s=a==null?void 0:a.message)==null?void 0:s.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(a=>cd(a)?{value:a.value}:{issues:n.common.issues})}async parseAsync(t,n){const s=await this.safeParseAsync(t,n);if(s.success)return s.data;throw s.error}async safeParseAsync(t,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:il(t)},i=this._parse({data:t,path:s.path,parent:s}),a=await(Vx(i)?i:Promise.resolve(i));return CF(s,a)}refine(t,n){const s=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,a)=>{const o=t(i),u=()=>a.addIssue({code:mt.custom,...s(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(u(),!1)):o?!0:(u(),!1)})}refinement(t,n){return this._refinement((s,i)=>t(s)?!0:(i.addIssue(typeof n=="function"?n(s,i):n),!1))}_refinement(t){return new dd({schema:this,typeName:en.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Sl.create(this,this._def)}nullable(){return pd.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return _o.create(this)}promise(){return sg.create(this,this._def)}or(t){return ng.create([this,t],this._def)}and(t){return Gx.create(this,t,this._def)}transform(t){return new dd({...yn(this._def),schema:this,typeName:en.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new oE({...yn(this._def),innerType:this,defaultValue:n,typeName:en.ZodDefault})}brand(){return new Tee({typeName:en.ZodBranded,type:this,...yn(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new uE({...yn(this._def),innerType:this,catchValue:n,typeName:en.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return TT.create(this,t)}readonly(){return lE.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const iee=/^c[^\s-]{8,}$/i,aee=/^[0-9a-z]+$/,oee=/^[0-9A-HJKMNP-TV-Z]{26}$/i,uee=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,lee=/^[a-z0-9_-]{21}$/i,cee=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,hee=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,fee=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,dee="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let EC;const pee=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,mee=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,gee=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,yee=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,xee=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bee=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,f9="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",vee=new RegExp(`^${f9}$`);function d9(r){let t="[0-5]\\d";r.precision?t=`${t}\\.\\d{${r.precision}}`:r.precision==null&&(t=`${t}(\\.\\d+)?`);const n=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function wee(r){return new RegExp(`^${d9(r)}$`)}function See(r){let t=`${f9}T${d9(r)}`;const n=[];return n.push(r.local?"Z?":"Z"),r.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Cee(r,t){return!!((t==="v4"||!t)&&pee.test(r)||(t==="v6"||!t)&&gee.test(r))}function _ee(r,t){if(!cee.test(r))return!1;try{const[n]=r.split("."),s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(s));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||t&&i.alg!==t)}catch{return!1}}function Eee(r,t){return!!((t==="v4"||!t)&&mee.test(r)||(t==="v6"||!t)&&yee.test(r))}class pl extends In{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==kt.string){const a=this._getOrReturnCtx(t);return Ct(a,{code:mt.invalid_type,expected:kt.string,received:a.parsedType}),on}const s=new Zi;let i;for(const a of this._def.checks)if(a.kind==="min")t.data.length<a.value&&(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="max")t.data.length>a.value&&(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if(a.kind==="length"){const o=t.data.length>a.value,u=t.data.length<a.value;(o||u)&&(i=this._getOrReturnCtx(t,i),o?Ct(i,{code:mt.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&Ct(i,{code:mt.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),s.dirty())}else if(a.kind==="email")fee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"email",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="emoji")EC||(EC=new RegExp(dee,"u")),EC.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"emoji",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="uuid")uee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"uuid",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="nanoid")lee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"nanoid",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid")iee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"cuid",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="cuid2")aee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"cuid2",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="ulid")oee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"ulid",code:mt.invalid_string,message:a.message}),s.dirty());else if(a.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),Ct(i,{validation:"url",code:mt.invalid_string,message:a.message}),s.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"regex",code:mt.invalid_string,message:a.message}),s.dirty())):a.kind==="trim"?t.data=t.data.trim():a.kind==="includes"?t.data.includes(a.value,a.position)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),s.dirty()):a.kind==="toLowerCase"?t.data=t.data.toLowerCase():a.kind==="toUpperCase"?t.data=t.data.toUpperCase():a.kind==="startsWith"?t.data.startsWith(a.value)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:{startsWith:a.value},message:a.message}),s.dirty()):a.kind==="endsWith"?t.data.endsWith(a.value)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:{endsWith:a.value},message:a.message}),s.dirty()):a.kind==="datetime"?See(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:"datetime",message:a.message}),s.dirty()):a.kind==="date"?vee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:"date",message:a.message}),s.dirty()):a.kind==="time"?wee(a).test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.invalid_string,validation:"time",message:a.message}),s.dirty()):a.kind==="duration"?hee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"duration",code:mt.invalid_string,message:a.message}),s.dirty()):a.kind==="ip"?Cee(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"ip",code:mt.invalid_string,message:a.message}),s.dirty()):a.kind==="jwt"?_ee(t.data,a.alg)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"jwt",code:mt.invalid_string,message:a.message}),s.dirty()):a.kind==="cidr"?Eee(t.data,a.version)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"cidr",code:mt.invalid_string,message:a.message}),s.dirty()):a.kind==="base64"?xee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"base64",code:mt.invalid_string,message:a.message}),s.dirty()):a.kind==="base64url"?bee.test(t.data)||(i=this._getOrReturnCtx(t,i),Ct(i,{validation:"base64url",code:mt.invalid_string,message:a.message}),s.dirty()):Mn.assertNever(a);return{status:s.value,value:t.data}}_regex(t,n,s){return this.refinement(i=>t.test(i),{validation:n,code:mt.invalid_string,...Rt.errToObj(s)})}_addCheck(t){return new pl({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Rt.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Rt.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Rt.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Rt.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Rt.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Rt.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Rt.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Rt.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Rt.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Rt.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Rt.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Rt.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Rt.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Rt.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Rt.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Rt.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Rt.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Rt.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Rt.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Rt.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Rt.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Rt.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Rt.errToObj(n)})}nonempty(t){return this.min(1,Rt.errToObj(t))}trim(){return new pl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new pl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new pl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}pl.create=r=>new pl({checks:[],typeName:en.ZodString,coerce:(r==null?void 0:r.coerce)??!1,...yn(r)});function Dee(r,t){const n=(r.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,i=n>s?n:s,a=Number.parseInt(r.toFixed(i).replace(".","")),o=Number.parseInt(t.toFixed(i).replace(".",""));return a%o/10**i}class hd extends In{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==kt.number){const a=this._getOrReturnCtx(t);return Ct(a,{code:mt.invalid_type,expected:kt.number,received:a.parsedType}),on}let s;const i=new Zi;for(const a of this._def.checks)a.kind==="int"?Mn.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.invalid_type,expected:"integer",received:"float",message:a.message}),i.dirty()):a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),i.dirty()):a.kind==="multipleOf"?Dee(t.data,a.value)!==0&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):a.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.not_finite,message:a.message}),i.dirty()):Mn.assertNever(a);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Rt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Rt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Rt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Rt.toString(n))}setLimit(t,n,s,i){return new hd({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:s,message:Rt.toString(i)}]})}_addCheck(t){return new hd({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Rt.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Rt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Rt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Rt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Rt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Rt.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Rt.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Rt.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Rt.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Mn.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(n)&&Number.isFinite(t)}}hd.create=r=>new hd({checks:[],typeName:en.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...yn(r)});class eg extends In{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==kt.bigint)return this._getInvalidInput(t);let s;const i=new Zi;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?t.data<a.value:t.data<=a.value)&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="max"?(a.inclusive?t.data>a.value:t.data>=a.value)&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),i.dirty()):a.kind==="multipleOf"?t.data%a.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),Ct(s,{code:mt.not_multiple_of,multipleOf:a.value,message:a.message}),i.dirty()):Mn.assertNever(a);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Ct(n,{code:mt.invalid_type,expected:kt.bigint,received:n.parsedType}),on}gte(t,n){return this.setLimit("min",t,!0,Rt.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Rt.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Rt.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Rt.toString(n))}setLimit(t,n,s,i){return new eg({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:s,message:Rt.toString(i)}]})}_addCheck(t){return new eg({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Rt.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Rt.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Rt.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Rt.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Rt.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}eg.create=r=>new eg({checks:[],typeName:en.ZodBigInt,coerce:(r==null?void 0:r.coerce)??!1,...yn(r)});class sE extends In{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==kt.boolean){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.boolean,received:s.parsedType}),on}return Ii(t.data)}}sE.create=r=>new sE({typeName:en.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...yn(r)});class Ux extends In{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==kt.date){const a=this._getOrReturnCtx(t);return Ct(a,{code:mt.invalid_type,expected:kt.date,received:a.parsedType}),on}if(Number.isNaN(t.data.getTime())){const a=this._getOrReturnCtx(t);return Ct(a,{code:mt.invalid_date}),on}const s=new Zi;let i;for(const a of this._def.checks)a.kind==="min"?t.data.getTime()<a.value&&(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),s.dirty()):a.kind==="max"?t.data.getTime()>a.value&&(i=this._getOrReturnCtx(t,i),Ct(i,{code:mt.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),s.dirty()):Mn.assertNever(a);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ux({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Rt.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Rt.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Ux.create=r=>new Ux({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:en.ZodDate,...yn(r)});class _F extends In{_parse(t){if(this._getType(t)!==kt.symbol){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.symbol,received:s.parsedType}),on}return Ii(t.data)}}_F.create=r=>new _F({typeName:en.ZodSymbol,...yn(r)});class EF extends In{_parse(t){if(this._getType(t)!==kt.undefined){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.undefined,received:s.parsedType}),on}return Ii(t.data)}}EF.create=r=>new EF({typeName:en.ZodUndefined,...yn(r)});class DF extends In{_parse(t){if(this._getType(t)!==kt.null){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.null,received:s.parsedType}),on}return Ii(t.data)}}DF.create=r=>new DF({typeName:en.ZodNull,...yn(r)});class tg extends In{constructor(){super(...arguments),this._any=!0}_parse(t){return Ii(t.data)}}tg.create=r=>new tg({typeName:en.ZodAny,...yn(r)});class Yf extends In{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ii(t.data)}}Yf.create=r=>new Yf({typeName:en.ZodUnknown,...yn(r)});class $l extends In{_parse(t){const n=this._getOrReturnCtx(t);return Ct(n,{code:mt.invalid_type,expected:kt.never,received:n.parsedType}),on}}$l.create=r=>new $l({typeName:en.ZodNever,...yn(r)});class TF extends In{_parse(t){if(this._getType(t)!==kt.undefined){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.void,received:s.parsedType}),on}return Ii(t.data)}}TF.create=r=>new TF({typeName:en.ZodVoid,...yn(r)});class _o extends In{_parse(t){const{ctx:n,status:s}=this._processInputParams(t),i=this._def;if(n.parsedType!==kt.array)return Ct(n,{code:mt.invalid_type,expected:kt.array,received:n.parsedType}),on;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,u=n.data.length<i.exactLength.value;(o||u)&&(Ct(n,{code:o?mt.too_big:mt.too_small,minimum:u?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),s.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(Ct(n,{code:mt.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),s.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(Ct(n,{code:mt.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((o,u)=>i.type._parseAsync(new Il(n,o,n.path,u)))).then(o=>Zi.mergeArray(s,o));const a=[...n.data].map((o,u)=>i.type._parseSync(new Il(n,o,n.path,u)));return Zi.mergeArray(s,a)}get element(){return this._def.type}min(t,n){return new _o({...this._def,minLength:{value:t,message:Rt.toString(n)}})}max(t,n){return new _o({...this._def,maxLength:{value:t,message:Rt.toString(n)}})}length(t,n){return new _o({...this._def,exactLength:{value:t,message:Rt.toString(n)}})}nonempty(t){return this.min(1,t)}}_o.create=(r,t)=>new _o({type:r,minLength:null,maxLength:null,exactLength:null,typeName:en.ZodArray,...yn(t)});function Af(r){if(r instanceof Zr){const t={};for(const n in r.shape){const s=r.shape[n];t[n]=Sl.create(Af(s))}return new Zr({...r._def,shape:()=>t})}else return r instanceof _o?new _o({...r._def,type:Af(r.element)}):r instanceof Sl?Sl.create(Af(r.unwrap())):r instanceof pd?pd.create(Af(r.unwrap())):r instanceof ko?ko.create(r.items.map(t=>Af(t))):r}class Zr extends In{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Mn.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==kt.object){const c=this._getOrReturnCtx(t);return Ct(c,{code:mt.invalid_type,expected:kt.object,received:c.parsedType}),on}const{status:s,ctx:i}=this._processInputParams(t),{shape:a,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof $l&&this._def.unknownKeys==="strip"))for(const c in i.data)o.includes(c)||u.push(c);const l=[];for(const c of o){const h=a[c],f=i.data[c];l.push({key:{status:"valid",value:c},value:h._parse(new Il(i,f,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof $l){const c=this._def.unknownKeys;if(c==="passthrough")for(const h of u)l.push({key:{status:"valid",value:h},value:{status:"valid",value:i.data[h]}});else if(c==="strict")u.length>0&&(Ct(i,{code:mt.unrecognized_keys,keys:u}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const h of u){const f=i.data[h];l.push({key:{status:"valid",value:h},value:c._parse(new Il(i,f,i.path,h)),alwaysSet:h in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const h of l){const f=await h.key,p=await h.value;c.push({key:f,value:p,alwaysSet:h.alwaysSet})}return c}).then(c=>Zi.mergeObjectSync(s,c)):Zi.mergeObjectSync(s,l)}get shape(){return this._def.shape()}strict(t){return Rt.errToObj,new Zr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,s)=>{var a,o;const i=((o=(a=this._def).errorMap)==null?void 0:o.call(a,n,s).message)??s.defaultError;return n.code==="unrecognized_keys"?{message:Rt.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new Zr({...this._def,unknownKeys:"strip"})}passthrough(){return new Zr({...this._def,unknownKeys:"passthrough"})}extend(t){return new Zr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Zr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:en.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Zr({...this._def,catchall:t})}pick(t){const n={};for(const s of Mn.objectKeys(t))t[s]&&this.shape[s]&&(n[s]=this.shape[s]);return new Zr({...this._def,shape:()=>n})}omit(t){const n={};for(const s of Mn.objectKeys(this.shape))t[s]||(n[s]=this.shape[s]);return new Zr({...this._def,shape:()=>n})}deepPartial(){return Af(this)}partial(t){const n={};for(const s of Mn.objectKeys(this.shape)){const i=this.shape[s];t&&!t[s]?n[s]=i:n[s]=i.optional()}return new Zr({...this._def,shape:()=>n})}required(t){const n={};for(const s of Mn.objectKeys(this.shape))if(t&&!t[s])n[s]=this.shape[s];else{let a=this.shape[s];for(;a instanceof Sl;)a=a._def.innerType;n[s]=a}return new Zr({...this._def,shape:()=>n})}keyof(){return p9(Mn.objectKeys(this.shape))}}Zr.create=(r,t)=>new Zr({shape:()=>r,unknownKeys:"strip",catchall:$l.create(),typeName:en.ZodObject,...yn(t)});Zr.strictCreate=(r,t)=>new Zr({shape:()=>r,unknownKeys:"strict",catchall:$l.create(),typeName:en.ZodObject,...yn(t)});Zr.lazycreate=(r,t)=>new Zr({shape:r,unknownKeys:"strip",catchall:$l.create(),typeName:en.ZodObject,...yn(t)});class ng extends In{_parse(t){const{ctx:n}=this._processInputParams(t),s=this._def.options;function i(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return n.common.issues.push(...u.ctx.common.issues),u.result;const o=a.map(u=>new Na(u.ctx.common.issues));return Ct(n,{code:mt.invalid_union,unionErrors:o}),on}if(n.common.async)return Promise.all(s.map(async a=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await a._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(i);{let a;const o=[];for(const l of s){const c={...n,common:{...n.common,issues:[]},parent:null},h=l._parseSync({data:n.data,path:n.path,parent:c});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(a)return n.common.issues.push(...a.ctx.common.issues),a.result;const u=o.map(l=>new Na(l));return Ct(n,{code:mt.invalid_union,unionErrors:u}),on}}get options(){return this._def.options}}ng.create=(r,t)=>new ng({options:r,typeName:en.ZodUnion,...yn(t)});function iE(r,t){const n=il(r),s=il(t);if(r===t)return{valid:!0,data:r};if(n===kt.object&&s===kt.object){const i=Mn.objectKeys(t),a=Mn.objectKeys(r).filter(u=>i.indexOf(u)!==-1),o={...r,...t};for(const u of a){const l=iE(r[u],t[u]);if(!l.valid)return{valid:!1};o[u]=l.data}return{valid:!0,data:o}}else if(n===kt.array&&s===kt.array){if(r.length!==t.length)return{valid:!1};const i=[];for(let a=0;a<r.length;a++){const o=r[a],u=t[a],l=iE(o,u);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===kt.date&&s===kt.date&&+r==+t?{valid:!0,data:r}:{valid:!1}}class Gx extends In{_parse(t){const{status:n,ctx:s}=this._processInputParams(t),i=(a,o)=>{if(wF(a)||wF(o))return on;const u=iE(a.value,o.value);return u.valid?((SF(a)||SF(o))&&n.dirty(),{status:n.value,value:u.data}):(Ct(s,{code:mt.invalid_intersection_types}),on)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([a,o])=>i(a,o)):i(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Gx.create=(r,t,n)=>new Gx({left:r,right:t,typeName:en.ZodIntersection,...yn(n)});class ko extends In{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kt.array)return Ct(s,{code:mt.invalid_type,expected:kt.array,received:s.parsedType}),on;if(s.data.length<this._def.items.length)return Ct(s,{code:mt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),on;!this._def.rest&&s.data.length>this._def.items.length&&(Ct(s,{code:mt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const a=[...s.data].map((o,u)=>{const l=this._def.items[u]||this._def.rest;return l?l._parse(new Il(s,o,s.path,u)):null}).filter(o=>!!o);return s.common.async?Promise.all(a).then(o=>Zi.mergeArray(n,o)):Zi.mergeArray(n,a)}get items(){return this._def.items}rest(t){return new ko({...this._def,rest:t})}}ko.create=(r,t)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ko({items:r,typeName:en.ZodTuple,rest:null,...yn(t)})};class NF extends In{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kt.map)return Ct(s,{code:mt.invalid_type,expected:kt.map,received:s.parsedType}),on;const i=this._def.keyType,a=this._def.valueType,o=[...s.data.entries()].map(([u,l],c)=>({key:i._parse(new Il(s,u,s.path,[c,"key"])),value:a._parse(new Il(s,l,s.path,[c,"value"]))}));if(s.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,h=await l.value;if(c.status==="aborted"||h.status==="aborted")return on;(c.status==="dirty"||h.status==="dirty")&&n.dirty(),u.set(c.value,h.value)}return{status:n.value,value:u}})}else{const u=new Map;for(const l of o){const c=l.key,h=l.value;if(c.status==="aborted"||h.status==="aborted")return on;(c.status==="dirty"||h.status==="dirty")&&n.dirty(),u.set(c.value,h.value)}return{status:n.value,value:u}}}}NF.create=(r,t,n)=>new NF({valueType:t,keyType:r,typeName:en.ZodMap,...yn(n)});class rg extends In{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.parsedType!==kt.set)return Ct(s,{code:mt.invalid_type,expected:kt.set,received:s.parsedType}),on;const i=this._def;i.minSize!==null&&s.data.size<i.minSize.value&&(Ct(s,{code:mt.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&s.data.size>i.maxSize.value&&(Ct(s,{code:mt.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const a=this._def.valueType;function o(l){const c=new Set;for(const h of l){if(h.status==="aborted")return on;h.status==="dirty"&&n.dirty(),c.add(h.value)}return{status:n.value,value:c}}const u=[...s.data.values()].map((l,c)=>a._parse(new Il(s,l,s.path,c)));return s.common.async?Promise.all(u).then(l=>o(l)):o(u)}min(t,n){return new rg({...this._def,minSize:{value:t,message:Rt.toString(n)}})}max(t,n){return new rg({...this._def,maxSize:{value:t,message:Rt.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}rg.create=(r,t)=>new rg({valueType:r,minSize:null,maxSize:null,typeName:en.ZodSet,...yn(t)});class $m extends In{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==kt.function)return Ct(n,{code:mt.invalid_type,expected:kt.function,received:n.parsedType}),on;function s(u,l){return rE({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,nE(),Jm].filter(c=>!!c),issueData:{code:mt.invalid_arguments,argumentsError:l}})}function i(u,l){return rE({data:u,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,nE(),Jm].filter(c=>!!c),issueData:{code:mt.invalid_return_type,returnTypeError:l}})}const a={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof sg){const u=this;return Ii(async function(...l){const c=new Na([]),h=await u._def.args.parseAsync(l,a).catch(g=>{throw c.addIssue(s(l,g)),c}),f=await Reflect.apply(o,this,h);return await u._def.returns._def.type.parseAsync(f,a).catch(g=>{throw c.addIssue(i(f,g)),c})})}else{const u=this;return Ii(function(...l){const c=u._def.args.safeParse(l,a);if(!c.success)throw new Na([s(l,c.error)]);const h=Reflect.apply(o,this,c.data),f=u._def.returns.safeParse(h,a);if(!f.success)throw new Na([i(h,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new $m({...this._def,args:ko.create(t).rest(Yf.create())})}returns(t){return new $m({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,s){return new $m({args:t||ko.create([]).rest(Yf.create()),returns:n||Yf.create(),typeName:en.ZodFunction,...yn(s)})}}class kF extends In{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}kF.create=(r,t)=>new kF({getter:r,typeName:en.ZodLazy,...yn(t)});class aE extends In{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Ct(n,{received:n.data,code:mt.invalid_literal,expected:this._def.value}),on}return{status:"valid",value:t.data}}get value(){return this._def.value}}aE.create=(r,t)=>new aE({value:r,typeName:en.ZodLiteral,...yn(t)});function p9(r,t){return new fd({values:r,typeName:en.ZodEnum,...yn(t)})}class fd extends In{constructor(){super(...arguments),mm.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),s=this._def.values;return Ct(n,{expected:Mn.joinValues(s),received:n.parsedType,code:mt.invalid_type}),on}if(zx(this,mm,"f")||h9(this,mm,new Set(this._def.values),"f"),!zx(this,mm,"f").has(t.data)){const n=this._getOrReturnCtx(t),s=this._def.values;return Ct(n,{received:n.data,code:mt.invalid_enum_value,options:s}),on}return Ii(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return fd.create(t,{...this._def,...n})}exclude(t,n=this._def){return fd.create(this.options.filter(s=>!t.includes(s)),{...this._def,...n})}}mm=new WeakMap;fd.create=p9;class AF extends In{constructor(){super(...arguments),gm.set(this,void 0)}_parse(t){const n=Mn.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==kt.string&&s.parsedType!==kt.number){const i=Mn.objectValues(n);return Ct(s,{expected:Mn.joinValues(i),received:s.parsedType,code:mt.invalid_type}),on}if(zx(this,gm,"f")||h9(this,gm,new Set(Mn.getValidEnumValues(this._def.values)),"f"),!zx(this,gm,"f").has(t.data)){const i=Mn.objectValues(n);return Ct(s,{received:s.data,code:mt.invalid_enum_value,options:i}),on}return Ii(t.data)}get enum(){return this._def.values}}gm=new WeakMap;AF.create=(r,t)=>new AF({values:r,typeName:en.ZodNativeEnum,...yn(t)});class sg extends In{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==kt.promise&&n.common.async===!1)return Ct(n,{code:mt.invalid_type,expected:kt.promise,received:n.parsedType}),on;const s=n.parsedType===kt.promise?n.data:Promise.resolve(n.data);return Ii(s.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}sg.create=(r,t)=>new sg({type:r,typeName:en.ZodPromise,...yn(t)});class dd extends In{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===en.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:s}=this._processInputParams(t),i=this._def.effect||null,a={addIssue:o=>{Ct(s,o),o.fatal?n.abort():n.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),i.type==="preprocess"){const o=i.transform(s.data,a);if(s.common.async)return Promise.resolve(o).then(async u=>{if(n.value==="aborted")return on;const l=await this._def.schema._parseAsync({data:u,path:s.path,parent:s});return l.status==="aborted"?on:l.status==="dirty"||n.value==="dirty"?pm(l.value):l});{if(n.value==="aborted")return on;const u=this._def.schema._parseSync({data:o,path:s.path,parent:s});return u.status==="aborted"?on:u.status==="dirty"||n.value==="dirty"?pm(u.value):u}}if(i.type==="refinement"){const o=u=>{const l=i.refinement(u,a);if(s.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(s.common.async===!1){const u=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return u.status==="aborted"?on:(u.status==="dirty"&&n.dirty(),o(u.value),{status:n.value,value:u.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(u=>u.status==="aborted"?on:(u.status==="dirty"&&n.dirty(),o(u.value).then(()=>({status:n.value,value:u.value}))))}if(i.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!cd(o))return o;const u=i.transform(o.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:u}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>cd(o)?Promise.resolve(i.transform(o.value,a)).then(u=>({status:n.value,value:u})):o);Mn.assertNever(i)}}dd.create=(r,t,n)=>new dd({schema:r,typeName:en.ZodEffects,effect:t,...yn(n)});dd.createWithPreprocess=(r,t,n)=>new dd({schema:t,effect:{type:"preprocess",transform:r},typeName:en.ZodEffects,...yn(n)});class Sl extends In{_parse(t){return this._getType(t)===kt.undefined?Ii(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Sl.create=(r,t)=>new Sl({innerType:r,typeName:en.ZodOptional,...yn(t)});class pd extends In{_parse(t){return this._getType(t)===kt.null?Ii(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}pd.create=(r,t)=>new pd({innerType:r,typeName:en.ZodNullable,...yn(t)});class oE extends In{_parse(t){const{ctx:n}=this._processInputParams(t);let s=n.data;return n.parsedType===kt.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}oE.create=(r,t)=>new oE({innerType:r,typeName:en.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...yn(t)});class uE extends In{_parse(t){const{ctx:n}=this._processInputParams(t),s={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Vx(i)?i.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Na(s.common.issues)},input:s.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Na(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}uE.create=(r,t)=>new uE({innerType:r,typeName:en.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...yn(t)});class IF extends In{_parse(t){if(this._getType(t)!==kt.nan){const s=this._getOrReturnCtx(t);return Ct(s,{code:mt.invalid_type,expected:kt.nan,received:s.parsedType}),on}return{status:"valid",value:t.data}}}IF.create=r=>new IF({typeName:en.ZodNaN,...yn(r)});class Tee extends In{_parse(t){const{ctx:n}=this._processInputParams(t),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class TT extends In{_parse(t){const{status:n,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?on:a.status==="dirty"?(n.dirty(),pm(a.value)):this._def.out._parseAsync({data:a.value,path:s.path,parent:s})})();{const i=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?on:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:s.path,parent:s})}}static create(t,n){return new TT({in:t,out:n,typeName:en.ZodPipeline})}}class lE extends In{_parse(t){const n=this._def.innerType._parse(t),s=i=>(cd(i)&&(i.value=Object.freeze(i.value)),i);return Vx(n)?n.then(i=>s(i)):s(n)}unwrap(){return this._def.innerType}}lE.create=(r,t)=>new lE({innerType:r,typeName:en.ZodReadonly,...yn(t)});function $F(r,t){const n=typeof r=="function"?r(t):typeof r=="string"?{message:r}:r;return typeof n=="string"?{message:n}:n}function m9(r,t={},n){return r?tg.create().superRefine((s,i)=>{const a=r(s);if(a instanceof Promise)return a.then(o=>{if(!o){const u=$F(t,s),l=u.fatal??n??!0;i.addIssue({code:"custom",...u,fatal:l})}});if(!a){const o=$F(t,s),u=o.fatal??n??!0;i.addIssue({code:"custom",...o,fatal:u})}}):tg.create()}var en;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(en||(en={}));const FF=(r,t={message:`Input not instance of ${r.name}`})=>m9(n=>n instanceof r,t),Nee=pl.create,RF=hd.create,kee=sE.create,DC=tg.create;Yf.create;$l.create;const OF=_o.create,Aee=Zr.create,MF=ng.create;Gx.create;const LF=ko.create,BF=$m.create,PF=aE.create;fd.create;sg.create;Sl.create;pd.create;var Iee={describe:{overloads:[["String","FALLBACK|LABEL?"]]},describeElement:{overloads:[["String","String","FALLBACK|LABEL?"]]},textOutput:{overloads:[["FALLBACK|LABEL?"]]},gridOutput:{overloads:[["FALLBACK|LABEL?"]]},p5:{overloads:[["Object","String|HTMLElement"]]},color:{overloads:[["Number","Number?"],["Number","Number","Number","Number?"],["String"],["Number[]"],["p5.Color"]]},red:{overloads:[["p5.Color|Number[]|String"]]},green:{overloads:[["p5.Color|Number[]|String"]]},blue:{overloads:[["p5.Color|Number[]|String"]]},alpha:{overloads:[["p5.Color|Number[]|String"]]},hue:{overloads:[["p5.Color|Number[]|String"]]},saturation:{overloads:[["p5.Color|Number[]|String"]]},brightness:{overloads:[["p5.Color|Number[]|String"]]},lightness:{overloads:[["p5.Color|Number[]|String"]]},lerpColor:{overloads:[["p5.Color","p5.Color","Number"]]},paletteLerp:{overloads:[["[p5.Color|String|Number|Number[], Number][]","Number"]]},beginClip:{overloads:[["Object?"]]},endClip:{overloads:[[]]},clip:{overloads:[["Function","Object?"]]},background:{overloads:[["p5.Color"],["String","Number?"],["Number","Number?"],["Number","Number","Number","Number?"],["Number[]"],["p5.Image","Number?"]]},clear:{overloads:[["Number?","Number?","Number?","Number?"],[]]},colorMode:{overloads:[["RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH","Number?"],["RGB|HSB|HSL|RGBHDR|HWB|LAB|LCH|OKLAB|OKLCH","Number","Number","Number","Number?"]]},fill:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},noFill:{overloads:[[]]},noStroke:{overloads:[[]]},stroke:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},erase:{overloads:[["Number?","Number?"]]},noErase:{overloads:[[]]},blendMode:{overloads:[["BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|REMOVE|SUBTRACT"]]},print:{overloads:[["Any"],["String|Number|Array"]]},cursor:{overloads:[["ARROW|CROSS|HAND|MOVE|TEXT|WAIT|String","Number?","Number?"]]},frameRate:{overloads:[["Number"],[]]},getTargetFrameRate:{overloads:[[]]},noCursor:{overloads:[[]]},windowResized:{overloads:[["UIEvent?"]]},fullscreen:{overloads:[["Boolean?"]]},pixelDensity:{overloads:[["Number?"],[]]},displayDensity:{overloads:[[]]},getURL:{overloads:[[]]},getURLPath:{overloads:[[]]},getURLParams:{overloads:[[]]},worldToScreen:{overloads:[["Number|p5.Vector","Number","Number?"]]},screenToWorld:{overloads:[["Number|p5.Vector","Number","Number?"]]},setup:{overloads:[[]]},draw:{overloads:[[]]},createCanvas:{overloads:[["Number?","Number?","P2D|WEBGL|P2DHDR?","HTMLCanvasElement?"],["Number?","Number?","HTMLCanvasElement?"]]},resizeCanvas:{overloads:[["Number","Number","Boolean?"]]},noCanvas:{overloads:[[]]},createGraphics:{overloads:[["Number","Number","P2D|WEBGL?","HTMLCanvasElement?"],["Number","Number","HTMLCanvasElement?"]]},createFramebuffer:{overloads:[["Object?"]]},clearDepth:{overloads:[["Number?"]]},noLoop:{overloads:[[]]},loop:{overloads:[[]]},isLooping:{overloads:[[]]},redraw:{overloads:[["Integer?"]]},applyMatrix:{overloads:[["Array"],["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},resetMatrix:{overloads:[[]]},rotate:{overloads:[["Number","p5.Vector|Number[]?"]]},rotateX:{overloads:[["Number"]]},rotateY:{overloads:[["Number"]]},rotateZ:{overloads:[["Number"]]},scale:{overloads:[["Number|p5.Vector|Number[]","Number?","Number?"],["p5.Vector|Number[]"]]},shearX:{overloads:[["Number"]]},shearY:{overloads:[["Number"]]},translate:{overloads:[["Number","Number","Number?"],["p5.Vector"]]},push:{overloads:[[]]},pop:{overloads:[[]]},storeItem:{overloads:[["String","String|Number|Boolean|Object|Array"]]},getItem:{overloads:[["String"]]},clearStorage:{overloads:[[]]},removeItem:{overloads:[["String"]]},select:{overloads:[["String","String|p5.Element|HTMLElement?"]]},selectAll:{overloads:[["String","String|p5.Element|HTMLElement?"]]},createElement:{overloads:[["String","String?"]]},removeElements:{overloads:[[]]},addElement:{overloads:[[]]},createDiv:{overloads:[["String?"]]},createP:{overloads:[["String?"]]},createSpan:{overloads:[["String?"]]},createImg:{overloads:[["String","String"],["String","String","String?","Function?"]]},createA:{overloads:[["String","String","String?"]]},createSlider:{overloads:[["Number","Number","Number?","Number?"]]},createButton:{overloads:[["String","String?"]]},createCheckbox:{overloads:[["String?","Boolean?"]]},createSelect:{overloads:[["Boolean?"],["Object"]]},createRadio:{overloads:[["Object?"],["String?"],[]]},createColorPicker:{overloads:[["String|p5.Color?"]]},createInput:{overloads:[["String?","String?"],["String?"]]},createFileInput:{overloads:[["Function","Boolean?"]]},setMoveThreshold:{overloads:[["Number"]]},setShakeThreshold:{overloads:[["Number"]]},deviceMoved:{overloads:[[]]},deviceTurned:{overloads:[[]]},deviceShaken:{overloads:[[]]},keyPressed:{overloads:[["KeyboardEvent?"]]},keyReleased:{overloads:[["KeyboardEvent?"]]},keyTyped:{overloads:[["KeyboardEvent?"]]},keyIsDown:{overloads:[["Number|String"]]},mouseMoved:{overloads:[["MouseEvent?"]]},mouseDragged:{overloads:[["MouseEvent?"]]},mousePressed:{overloads:[["MouseEvent?"]]},mouseReleased:{overloads:[["MouseEvent?"]]},mouseClicked:{overloads:[["MouseEvent?"]]},doubleClicked:{overloads:[["MouseEvent?"]]},mouseWheel:{overloads:[["WheelEvent?"]]},requestPointerLock:{overloads:[[]]},exitPointerLock:{overloads:[[]]},createImage:{overloads:[["Integer","Integer"]]},saveCanvas:{overloads:[["p5.Framebuffer|p5.Element|HTMLCanvasElement","String?","String?"],["String?","String?"]]},saveFrames:{overloads:[["String","String","Number","Number","function(Array)?"]]},loadImage:{overloads:[["String|Request","function(p5.Image)?","function(Event)?"]]},saveGif:{overloads:[["String","Number","Object?"]]},image:{overloads:[["p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture|p5.Renderer|p5.Graphics","Number","Number","Number?","Number?"],["p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture","Number","Number","Number","Number","Number","Number","Number?","Number?","CONTAIN|COVER?","LEFT|RIGHT|CENTER?","TOP|BOTTOM|CENTER?"]]},tint:{overloads:[["Number","Number","Number","Number?"],["String"],["Number","Number?"],["Number[]"],["p5.Color"]]},noTint:{overloads:[[]]},imageMode:{overloads:[["CORNER|CORNERS|CENTER"]]},blend:{overloads:[["p5.Image","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"]]},copy:{overloads:[["p5.Image|p5.Element","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"]]},filter:{overloads:[["THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|BLUR|ERODE|DILATE|BLUR","Number?","Boolean?"],["p5.Shader"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]},loadPixels:{overloads:[[]]},set:{overloads:[["Number","Number","Number|Number[]|Object"]]},updatePixels:{overloads:[["Number?","Number?","Number?","Number?"],[]]},loadJSON:{overloads:[["String|Request","Function?","Function?"]]},loadStrings:{overloads:[["String|Request","Function?","Function?"]]},loadTable:{overloads:[["String|Request","String?","String?","Function?","Function?"]]},loadXML:{overloads:[["String|Request","Function?","Function?"]]},loadBytes:{overloads:[["String|Request","Function?","Function?"]]},loadBlob:{overloads:[["String|Request","Function?","Function?"]]},httpGet:{overloads:[["String|Request","String?","Function?","Function?"],["String|Request","Function","Function?"]]},httpPost:{overloads:[["String|Request","Object|Boolean?","String?","Function?","Function?"],["String|Request","Object|Boolean","Function?","Function?"],["String|Request","Function?","Function?"]]},httpDo:{overloads:[["String|Request","String?","String?","Object?","Function?","Function?"],["String|Request","Function?","Function?"]]},createWriter:{overloads:[["String","String?"]]},write:{overloads:[["String|Number|Array"]]},close:{overloads:[[]]},save:{overloads:[["Object|String?","String?","Boolean|String?"]]},saveJSON:{overloads:[["Array|Object","String","Boolean?"]]},saveStrings:{overloads:[["String[]","String","String?","Boolean?"]]},saveTable:{overloads:[["p5.Table","String","String?"]]},abs:{overloads:[["Number"]]},ceil:{overloads:[["Number"]]},constrain:{overloads:[["Number","Number","Number"]]},dist:{overloads:[["Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number"],["p5.Vector"]]},exp:{overloads:[["Number"]]},floor:{overloads:[["Number"]]},lerp:{overloads:[["Number","Number","Number"]]},log:{overloads:[["Number"]]},mag:{overloads:[["Number","Number"]]},map:{overloads:[["Number","Number","Number","Number","Number","Boolean?"]]},max:{overloads:[["Number","Number"],["Number[]"]]},min:{overloads:[["Number","Number"],["Number[]"]]},norm:{overloads:[["Number","Number","Number"]]},pow:{overloads:[["Number","Number"]]},round:{overloads:[["Number","Number?"]]},sq:{overloads:[["Number"]]},sqrt:{overloads:[["Number"]]},fract:{overloads:[["Number"]]},createVector:{overloads:[["...Number[]"]]},noise:{overloads:[["Number","Number?","Number?"]]},noiseDetail:{overloads:[["Number","Number"]]},noiseSeed:{overloads:[["Number"]]},randomSeed:{overloads:[["Number"]]},random:{overloads:[["Number?","Number?"],["Array"]]},randomGaussian:{overloads:[["Number?","Number?"]]},acos:{overloads:[["Number"]]},asin:{overloads:[["Number"]]},atan:{overloads:[["Number"]]},atan2:{overloads:[["Number","Number"]]},cos:{overloads:[["Number"]]},sin:{overloads:[["Number"]]},tan:{overloads:[["Number"]]},degrees:{overloads:[["Number"]]},radians:{overloads:[["Number"]]},angleMode:{overloads:[["RADIANS|DEGREES"],[]]},arc:{overloads:[["Number","Number","Number","Number","Number","Number","CHORD|PIE|OPEN?","Integer?"]]},ellipse:{overloads:[["Number","Number","Number","Number?"],["Number","Number","Number","Number","Integer?"]]},circle:{overloads:[["Number","Number","Number"]]},line:{overloads:[["Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number"]]},point:{overloads:[["Number","Number","Number?"],["p5.Vector"]]},quad:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number","Integer?","Integer?"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Integer?","Integer?"]]},rect:{overloads:[["Number","Number","Number","Number?","Number?","Number?","Number?","Number?"],["Number","Number","Number","Number","Integer?","Integer?"]]},square:{overloads:[["Number","Number","Number","Number?","Number?","Number?","Number?"]]},triangle:{overloads:[["Number","Number","Number","Number","Number","Number"]]},ellipseMode:{overloads:[["CENTER|RADIUS|CORNER|CORNERS"]]},noSmooth:{overloads:[[]]},rectMode:{overloads:[["CENTER|RADIUS|CORNER|CORNERS"]]},smooth:{overloads:[[]]},strokeCap:{overloads:[["ROUND|SQUARE|PROJECT"]]},strokeJoin:{overloads:[["MITER|BEVEL|ROUND"]]},strokeWeight:{overloads:[["Number"]]},bezier:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},bezierPoint:{overloads:[["Number","Number","Number","Number","Number"]]},bezierTangent:{overloads:[["Number","Number","Number","Number","Number"]]},spline:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number"],["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number","Number"]]},splinePoint:{overloads:[["Number","Number","Number","Number","Number"]]},splineTangent:{overloads:[["Number","Number","Number","Number","Number"]]},bezierOrder:{overloads:[["Number"],[]]},splineVertex:{overloads:[["Number","Number"],["Number","Number","Number?"],["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},splineProperty:{overloads:[["String",null],["String"]]},splineProperties:{overloads:[["Object"],[]]},vertex:{overloads:[["Number","Number"],["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},beginContour:{overloads:[[]]},endContour:{overloads:[["OPEN|CLOSE?"]]},beginShape:{overloads:[["POINTS|LINES|TRIANGLES|TRIANGLE_FAN|TRIANGLE_STRIP|QUADS|QUAD_STRIP|PATH?"]]},bezierVertex:{overloads:[["Number","Number","Number?","Number?"],["Number","Number","Number","Number?","Number?"]]},endShape:{overloads:[["CLOSE?","Integer?"]]},normal:{overloads:[["p5.Vector"],["Number","Number","Number"]]},vertexProperty:{overloads:[["String","Number|Number[]"]]},loadFont:{overloads:[["String","String?","Object?","String|String[]?","Function?","Function?"],["String","Function?","Function?"]]},text:{overloads:[["String|Object|Array|Number|Boolean","Number","Number","Number?","Number?"]]},textAlign:{overloads:[["LEFT|CENTER|RIGHT","TOP|BOTTOM|CENTER|BASELINE?"]]},textAscent:{overloads:[["String?"]]},textDescent:{overloads:[["String?"]]},textLeading:{overloads:[["Number"]]},textFont:{overloads:[["p5.Font|String|Object","Number?"]]},textSize:{overloads:[["Number"],[]]},textStyle:{overloads:[["NORMAL|ITALIC|BOLD|BOLDITALIC"],[]]},textWidth:{overloads:[["String"]]},textWrap:{overloads:[["WORD|CHAR"],[]]},textBounds:{overloads:[["String","Number","Number","Number?","Number?"]]},textDirection:{overloads:[["String"],[]]},textProperty:{overloads:[["String",null],["String"]]},textProperties:{overloads:[["Object"],[]]},fontBounds:{overloads:[["String","Number","Number","Number?","Number?"]]},fontWidth:{overloads:[["String"]]},fontAscent:{overloads:[[]]},fontDescent:{overloads:[[]]},textWeight:{overloads:[["Number"],[]]},float:{overloads:[["String"],["String[]"]]},int:{overloads:[["String|Boolean|Number"],["Array"]]},str:{overloads:[["String|Boolean|Number"]]},boolean:{overloads:[["String|Boolean|Number"],["Array"]]},byte:{overloads:[["String|Boolean|Number"],["Array"]]},char:{overloads:[["String|Number"],["Array"]]},unchar:{overloads:[["String"],["String[]"]]},hex:{overloads:[["Number","Number?"],["Number[]","Number?"]]},unhex:{overloads:[["String"],["String[]"]]},day:{overloads:[[]]},hour:{overloads:[[]]},minute:{overloads:[[]]},millis:{overloads:[[]]},month:{overloads:[[]]},second:{overloads:[[]]},year:{overloads:[[]]},nf:{overloads:[["Number|String","Integer|String?","Integer|String?"],["Number[]","Integer|String?","Integer|String?"]]},nfc:{overloads:[["Number|String","Integer|String?"],["Number[]","Integer|String?"]]},nfp:{overloads:[["Number","Integer?","Integer?"],["Number[]","Integer?","Integer?"]]},nfs:{overloads:[["Number","Integer?","Integer?"],["Array","Integer?","Integer?"]]},splitTokens:{overloads:[["String","String?"]]},shuffle:{overloads:[["Array","Boolean?"]]},strokeMode:{overloads:[["String"]]},buildGeometry:{overloads:[["Function"]]},freeGeometry:{overloads:[["p5.Geometry"]]},plane:{overloads:[["Number?","Number?","Integer?","Integer?"]]},box:{overloads:[["Number?","Number?","Number?","Integer?","Integer?"]]},sphere:{overloads:[["Number?","Integer?","Integer?"]]},cylinder:{overloads:[["Number?","Number?","Integer?","Integer?","Boolean?","Boolean?"]]},cone:{overloads:[["Number?","Number?","Integer?","Integer?","Boolean?"]]},ellipsoid:{overloads:[["Number?","Number?","Number?","Integer?","Integer?"]]},torus:{overloads:[["Number?","Number?","Integer?","Integer?"]]},curveDetail:{overloads:[["Number"]]},orbitControl:{overloads:[["Number?","Number?","Number?","Object?"]]},debugMode:{overloads:[[],["GRID|AXES"],["GRID|AXES","Number?","Number?","Number?","Number?","Number?"],["GRID|AXES","Number?","Number?","Number?","Number?"],["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},noDebugMode:{overloads:[[]]},ambientLight:{overloads:[["Number","Number","Number","Number?"],["Number","Number?"],["String"],["Number[]"],["p5.Color"]]},specularColor:{overloads:[["Number","Number","Number"],["Number"],["String"],["Number[]"],["p5.Color"]]},directionalLight:{overloads:[["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","p5.Vector"],["p5.Color|Number[]|String","Number","Number","Number"],["p5.Color|Number[]|String","p5.Vector"]]},pointLight:{overloads:[["Number","Number","Number","Number","Number","Number"],["Number","Number","Number","p5.Vector"],["p5.Color|Number[]|String","Number","Number","Number"],["p5.Color|Number[]|String","p5.Vector"]]},imageLight:{overloads:[["p5.image"]]},panorama:{overloads:[["p5.Image"]]},lights:{overloads:[[]]},lightFalloff:{overloads:[["Number","Number","Number"]]},spotLight:{overloads:[["Number","Number","Number","Number","Number","Number","Number","Number","Number","Number?","Number?"],["p5.Color|Number[]|String","p5.Vector","p5.Vector","Number?","Number?"],["Number","Number","Number","p5.Vector","p5.Vector","Number?","Number?"],["p5.Color|Number[]|String","Number","Number","Number","p5.Vector","Number?","Number?"],["p5.Color|Number[]|String","p5.Vector","Number","Number","Number","Number?","Number?"],["Number","Number","Number","Number","Number","Number","p5.Vector","Number?","Number?"],["Number","Number","Number","p5.Vector","Number","Number","Number","Number?","Number?"],["p5.Color|Number[]|String","Number","Number","Number","Number","Number","Number","Number?","Number?"]]},noLights:{overloads:[[]]},loadModel:{overloads:[["String|Request","String?","Boolean","function(p5.Geometry)?","function(Event)?"],["String|Request","String?","function(p5.Geometry)?","function(Event)?"],["String|Request","Object?","String?","function(p5.Geometry)?","function(Event)?","Boolean?","Boolean?","Boolean?"]]},model:{overloads:[["p5.Geometry"]]},createModel:{overloads:[["String","String?","Boolean","function(p5.Geometry)?","function(Event)?"],["String","String?","function(p5.Geometry)?","function(Event)?"],["String","String?","Object?","function(p5.Geometry)?","function(Event)?","boolean?","boolean?","boolean?"]]},loadShader:{overloads:[["String|Request","String|Request","Function?","Function?"]]},createShader:{overloads:[["String","String","Object?"]]},loadFilterShader:{overloads:[["String","Function?","Function?"]]},createFilterShader:{overloads:[["String"]]},shader:{overloads:[["p5.Shader"]]},strokeShader:{overloads:[["p5.Shader"]]},imageShader:{overloads:[["p5.Shader"]]},baseMaterialShader:{overloads:[[]]},baseFilterShader:{overloads:[[]]},baseNormalShader:{overloads:[[]]},baseColorShader:{overloads:[[]]},baseStrokeShader:{overloads:[[]]},resetShader:{overloads:[[]]},texture:{overloads:[["p5.Image|p5.MediaElement|p5.Graphics|p5.Texture|p5.Framebuffer|p5.FramebufferTexture"]]},textureMode:{overloads:[["IMAGE|NORMAL"]]},textureWrap:{overloads:[["CLAMP|REPEAT|MIRROR","CLAMP|REPEAT|MIRROR?"]]},normalMaterial:{overloads:[[]]},ambientMaterial:{overloads:[["Number","Number","Number"],["Number"],["p5.Color|Number[]|String"]]},emissiveMaterial:{overloads:[["Number","Number","Number","Number?"],["Number"],["p5.Color|Number[]|String"]]},specularMaterial:{overloads:[["Number","Number?"],["Number","Number","Number","Number?"],["p5.Color|Number[]|String"]]},shininess:{overloads:[["Number"]]},metalness:{overloads:[["Number"]]},camera:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},perspective:{overloads:[["Number?","Number?","Number?","Number?"]]},linePerspective:{overloads:[["Boolean"],[]]},ortho:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},frustum:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},createCamera:{overloads:[[]]},setCamera:{overloads:[["p5.Camera"]]},saveObj:{overloads:[["String?"]]},saveStl:{overloads:[["String?","Object?"]]},setAttributes:{overloads:[["String","Boolean"],["Object"]]},remove:{overloads:[[]]},createVideo:{overloads:[["String|String[]","Function?"]]},createAudio:{overloads:[[],["String|String[]?","Function?"]]},createCapture:{overloads:[["AUDIO|VIDEO|Object?","Object?","Function?"]]}},$ee={p5:Iee,"p5.Geometry":{flipV:{overloads:[[]]},calculateBoundingBox:{overloads:[[]]},clearColors:{overloads:[[]]},flipU:{overloads:[[]]},computeFaces:{overloads:[[]]},computeNormals:{overloads:[["FLAT|SMOOTH?","Object?"]]},makeEdgesFromFaces:{overloads:[[]]},normalize:{overloads:[[]]},vertexProperty:{overloads:[["String","Number|Number[]","Number?"]]}},"p5.Color":{toString:{overloads:[["String?"]]},setRed:{overloads:[["Number"]]},setGreen:{overloads:[["Number"]]},setBlue:{overloads:[["Number"]]},setAlpha:{overloads:[["Number"]]}},"p5.Graphics":{reset:{overloads:[[]]},remove:{overloads:[[]]},createFramebuffer:{overloads:[["Object?"]]}},"p5.Element":{remove:{overloads:[[]]},parent:{overloads:[["String|p5.Element|Object"],[]]},child:{overloads:[[],["String|p5.Element?"]]},html:{overloads:[[],["String?","Boolean?"]]},id:{overloads:[["String"],[]]},class:{overloads:[["String"],[]]},addClass:{overloads:[["String"]]},removeClass:{overloads:[["String"]]},hasClass:{overloads:[[null]]},toggleClass:{overloads:[[null]]},center:{overloads:[["String?"]]},position:{overloads:[[],["Number?","Number?","String?"]]},show:{overloads:[[]]},hide:{overloads:[[]]},size:{overloads:[[],["Number|AUTO?","Number|AUTO?"]]},style:{overloads:[["String"],["String","String|p5.Color"]]},attribute:{overloads:[[],["String","String"]]},removeAttribute:{overloads:[["String"]]},value:{overloads:[[],["String|Number"]]},mousePressed:{overloads:[["Function|Boolean"]]},doubleClicked:{overloads:[["Function|Boolean"]]},mouseWheel:{overloads:[["Function|Boolean"]]},mouseReleased:{overloads:[["Function|Boolean"]]},mouseClicked:{overloads:[["Function|Boolean"]]},mouseMoved:{overloads:[["Function|Boolean"]]},mouseOver:{overloads:[["Function|Boolean"]]},mouseOut:{overloads:[["Function|Boolean"]]},dragOver:{overloads:[["Function|Boolean"]]},dragLeave:{overloads:[["Function|Boolean"]]},changed:{overloads:[["Function|Boolean"]]},input:{overloads:[["Function|Boolean"]]},drop:{overloads:[["Function","Function?"]]},draggable:{overloads:[["p5.Element?"]]}},"p5.MediaElement":{play:{overloads:[[]]},stop:{overloads:[[]]},pause:{overloads:[[]]},loop:{overloads:[[]]},noLoop:{overloads:[[]]},autoplay:{overloads:[["Boolean?"]]},volume:{overloads:[[],["Number"]]},speed:{overloads:[[],["Number"]]},time:{overloads:[[],["Number"]]},duration:{overloads:[[]]},onended:{overloads:[["Function"]]},connect:{overloads:[["AudioNode|Object"]]},disconnect:{overloads:[[]]},showControls:{overloads:[[]]},hideControls:{overloads:[[]]},addCue:{overloads:[["Number","Function","Object?"]]},removeCue:{overloads:[["Number"]]},clearCues:{overloads:[[]]}},"p5.Image":{pixelDensity:{overloads:[["Number?"]]},loadPixels:{overloads:[[]]},updatePixels:{overloads:[["Integer","Integer","Integer","Integer"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]},set:{overloads:[["Number","Number","Number|Number[]|Object"]]},resize:{overloads:[["Number","Number"]]},copy:{overloads:[["p5.Image|p5.Element","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer"]]},mask:{overloads:[["p5.Image"]]},filter:{overloads:[["THRESHOLD|GRAY|OPAQUE|INVERT|POSTERIZE|ERODE|DILATE|BLUR","Number?"]]},blend:{overloads:[["p5.Image","Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"],["Integer","Integer","Integer","Integer","Integer","Integer","Integer","Integer","BLEND|DARKEST|LIGHTEST|DIFFERENCE|MULTIPLY|EXCLUSION|SCREEN|REPLACE|OVERLAY|HARD_LIGHT|SOFT_LIGHT|DODGE|BURN|ADD|NORMAL"]]},save:{overloads:[["String","String?"]]},reset:{overloads:[[]]},getCurrentFrame:{overloads:[[]]},setFrame:{overloads:[["Number"]]},numFrames:{overloads:[[]]},play:{overloads:[[]]},pause:{overloads:[[]]},delay:{overloads:[["Number","Number?"]]}},"p5.Table":{addRow:{overloads:[["p5.TableRow?"]]},removeRow:{overloads:[["Integer"]]},getRow:{overloads:[["Integer"]]},getRows:{overloads:[[]]},findRow:{overloads:[["String","Integer|String"]]},findRows:{overloads:[["String","Integer|String"]]},matchRow:{overloads:[["String|RegExp","String|Integer"]]},matchRows:{overloads:[["String","String|Integer?"]]},getColumn:{overloads:[["String|Number"]]},clearRows:{overloads:[[]]},addColumn:{overloads:[["String?"]]},getColumnCount:{overloads:[[]]},getRowCount:{overloads:[[]]},removeTokens:{overloads:[["String","String|Integer?"]]},trim:{overloads:[["String|Integer?"]]},removeColumn:{overloads:[["String|Integer"]]},set:{overloads:[["Integer","String|Integer","String|Number"]]},setNum:{overloads:[["Integer","String|Integer","Number"]]},setString:{overloads:[["Integer","String|Integer","String"]]},get:{overloads:[["Integer","String|Integer"]]},getNum:{overloads:[["Integer","String|Integer"]]},getString:{overloads:[["Integer","String|Integer"]]},getObject:{overloads:[["String?"]]},getArray:{overloads:[[]]}},"p5.TableRow":{set:{overloads:[["String|Integer","String|Number"]]},setNum:{overloads:[["String|Integer","Number|String"]]},setString:{overloads:[["String|Integer","String|Number|Boolean|Object"]]},get:{overloads:[["String|Integer"]]},getNum:{overloads:[["String|Integer"]]},getString:{overloads:[["String|Integer"]]}},"p5.XML":{getParent:{overloads:[[]]},getName:{overloads:[[]]},setName:{overloads:[["String"]]},hasChildren:{overloads:[[]]},listChildren:{overloads:[[]]},getChildren:{overloads:[["String?"]]},getChild:{overloads:[["String|Integer"]]},addChild:{overloads:[["p5.XML"]]},removeChild:{overloads:[["String|Integer"]]},getAttributeCount:{overloads:[[]]},listAttributes:{overloads:[[]]},hasAttribute:{overloads:[["String"]]},getNum:{overloads:[["String","Number?"]]},getString:{overloads:[["String","Number?"]]},setAttribute:{overloads:[["String","Number|String|Boolean"]]},getContent:{overloads:[["String?"]]},serialize:{overloads:[[]]}},"p5.Vector":{getValue:{overloads:[["Number"]]},setValue:{overloads:[["Number","Number"]]},set:{overloads:[["Number?","Number?","Number?"],["p5.Vector|Number[]"]]},copy:{overloads:[[],["p5.Vector"]]},add:{overloads:[["Number|Array","Number?","Number?"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector","p5.Vector?"]]},rem:{overloads:[["Number","Number","Number"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector"]]},sub:{overloads:[["Number","Number?","Number?"],["p5.Vector|Number[]"],["p5.Vector","p5.Vector","p5.Vector?"]]},mult:{overloads:[["Number","Number","Number?"],["Number[]"],["p5.Vector"],[],["p5.Vector","Number","p5.Vector?"],["p5.Vector","p5.Vector","p5.Vector?"],["p5.Vector","Number[]","p5.Vector?"]]},div:{overloads:[["Number"],["Number","Number","Number?"],["Number[]"],["p5.Vector"],[],["p5.Vector","Number","p5.Vector?"],["p5.Vector","p5.Vector","p5.Vector?"],["p5.Vector","Number[]","p5.Vector?"]]},mag:{overloads:[[],["p5.Vector"]]},magSq:{overloads:[[],["p5.Vector"]]},dot:{overloads:[["Number","Number?","Number?"],["p5.Vector"],[],["p5.Vector","p5.Vector"]]},cross:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector"]]},normalize:{overloads:[[],["p5.Vector","p5.Vector?"]]},limit:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},setMag:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},heading:{overloads:[[],["p5.Vector"]]},setHeading:{overloads:[["Number"]]},rotate:{overloads:[["Number"],[],["p5.Vector","Number","p5.Vector?"]]},angleBetween:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector"]]},lerp:{overloads:[["Number","Number","Number","Number"],["p5.Vector","Number"],[],["p5.Vector","p5.Vector","Number","p5.Vector?"]]},slerp:{overloads:[["p5.Vector","Number"],[],["p5.Vector","p5.Vector","Number","p5.Vector?"]]},reflect:{overloads:[["p5.Vector"],[],["p5.Vector","p5.Vector","p5.Vector?"]]},array:{overloads:[[],["p5.Vector"]]},equals:{overloads:[["Number?","Number?","Number?"],["p5.Vector|Array"],[],["p5.Vector|Array","p5.Vector|Array"]]},fromAngle:{overloads:[["Number","Number?"]]},fromAngles:{overloads:[["Number","Number","Number?"]]},random2D:{overloads:[[]]},random3D:{overloads:[[]]},dist:{overloads:[[],["p5.Vector","p5.Vector"]]}},"p5.Font":{textToPaths:{overloads:[["String","Number","Number","Number?","Number?","Object?"]]},textToPoints:{overloads:[["String","Number","Number","Object?"]]},textToContours:{overloads:[["String","Number","Number","Object?"]]},textToModel:{overloads:[["String","Number","Number","Number","Number","Object?","Number?","Number?"]]}},"p5.Camera":{perspective:{overloads:[["Number?","Number?","Number?","Number?"]]},ortho:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},frustum:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?"]]},pan:{overloads:[["Number"]]},tilt:{overloads:[["Number"]]},lookAt:{overloads:[["Number","Number","Number"]]},camera:{overloads:[["Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?","Number?"]]},move:{overloads:[["Number","Number","Number"]]},setPosition:{overloads:[["Number","Number","Number"]]},set:{overloads:[["p5.Camera"]]},slerp:{overloads:[["p5.Camera","p5.Camera","Number"]]}},"p5.Framebuffer":{resize:{overloads:[["Number","Number"]]},pixelDensity:{overloads:[["Number?"]]},autoSized:{overloads:[["Boolean?"]]},createCamera:{overloads:[[]]},remove:{overloads:[[]]},begin:{overloads:[[]]},end:{overloads:[[]]},draw:{overloads:[["Function"]]},get:{overloads:[["Number","Number","Number","Number"],[],["Number","Number"]]}},"p5.Shader":{version:{overloads:[[]]},inspectHooks:{overloads:[[]]},modify:{overloads:[["Object?"]]},copyToContext:{overloads:[["p5|p5.Graphics"]]},setUniform:{overloads:[["String","Boolean|Number|Number[]|p5.Image|p5.Graphics|p5.MediaElement|p5.Texture"]]}}};function g9(r,t,n){let s=new Map;const i=Object.keys(r).reduce((y,x)=>(x.match(/^[A-Z]/)&&!x.match(/^[A-Z][A-Z0-9]*$/)&&r[x]instanceof Function&&(y[x]=r[x]),y),{});function a(){for(let y of Object.keys(r))typeof r[y]=="function"&&y[0]!==y[0].toLowerCase()&&(i[y]=r[y])}const o={};for(const[y,x]of Object.entries(qc))o[y]=x;const u={Any:DC(),Array:OF(DC()),Boolean:kee(),Function:BF(),Integer:RF().int(),Number:RF(),Object:Aee({}),String:Nee()},l=["AudioNode","HTMLCanvasElement","HTMLElement","KeyboardEvent","MouseEvent","RegExp","TouchEvent","UIEvent","WheelEvent"];function c(y){return y.reduce((x,v)=>(x[v]=m9(S=>S instanceof globalThis[v],{message:`Expected a ${v}`}),x),{})}const h=c(l);Object.assign(u,h);const f=["first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth"];function p(y){const x=y.lastIndexOf("."),v=y.slice(x+1),S=y.slice(0,x!==-1?x:0)||"p5";return{funcName:v,funcClass:S}}function g(y){let x=0;for(let v=0;v<y.length;v++)if(y[v]==="[")x++;else if(y[v]==="]"&&(x--,x<0))return!1;return x===0}t.generateZodSchemasForFunc=function(y){const{funcName:x,funcClass:v}=p(y);let S=$ee[v][x];if(!S)return;let w=[];S.hasOwnProperty("overloads")&&(w=S.overloads);const E=k=>{if(!k)return DC();let A;if(k in o)A=PF(o[k]);else if(k.match(/^[A-Z][A-Z0-9]*$/)&&k in t)A=PF(t[k]);else if(k.startsWith("function"))A=BF();else if(/^p5\.[a-zA-Z0-9]+$/.exec(k)||k==="p5"){const N=k.substring(k.indexOf(".")+1);A=FF(i[N])}else if(u[k])A=u[k];else if(k.startsWith("[")&&k.endsWith("]")&&g(k.slice(1,-1)))A=LF(k.slice(1,-1).split(/, */g).map(N=>E(N)));else if(k.match(/^[A-Z]/)&&k in window)A=FF(window[k]);else if(k.includes("|")&&k.split("|").every(N=>g(N))){const N=k.split("|");A=MF(N.map(F=>E(F)).filter(F=>F!==void 0))}else if(k.endsWith("[]"))A=OF(E(k.slice(0,-2)));else throw new Error(`Unsupported type '${k}' in parameter validation. Please report this issue.`);return A},_=k=>{const A=k==null?void 0:k.endsWith("?");k=k==null?void 0:k.replace(/\?$/,"");const N=(k==null?void 0:k.startsWith("..."))&&(k==null?void 0:k.endsWith("[]"));k=k==null?void 0:k.replace(/^\.\.\.(.+)\[\]$/,"$1");let F=E(k);return A&&(F=F.optional()),{schema:F,rest:N}},D=k=>{if(!k.some(F=>F==null?void 0:F.endsWith("?")))return[k];const A=k.filter(F=>F===null||!F.endsWith("?")).length,N=[];for(let F=A;F<=k.length;F++)N.push(k.slice(0,F));return N},I=w.flatMap(k=>D(k).map(N=>{var M;const F=N.map(B=>_(B)).filter(B=>B.schema!==void 0);let $;(M=F.at(-1))!=null&&M.rest&&($=F.pop());let O=LF(F.map(B=>B.schema));return $&&(O=O.rest($.schema)),O}));return I.length===1?I[0]:MF(I)},t.findClosestSchema=function(y,x){if(!(y instanceof ng))return y;const v=_=>{let D=1/0;if(!(_ instanceof ko))return console.warn("Schema below is not a tuple: "),printZodSchema(_),D;const I=x.length,k=_.items,A=k.length,N=k.filter(F=>!F.isOptional()).length;I>=N&&I<=A?D=0:D=Math.abs(I<N?N-I:I-A)*4;for(let F=0;F<Math.min(k.length,x.length);F++){const $=k[F],O=x[F];$.safeParse(O).success||D++}return D};let S=y._def.options[0],w=1/0;return y._def.options.forEach(_=>{const D=v(_);D<w&&(S=_,w=D)}),S},t.friendlyParamError=function(y,x,v){let S=" p5.js says: ",w=!1,E=y.errors[0];const _=(k,A,N)=>{const F=N?`at the ${f[N]} parameter`:"",$=k?`, but received ${k}`:"";return`Expected ${A} ${F}${$}`},D=k=>{var F;const A=new Set;let N;if(k.unionErrors.forEach($=>{const O=$.issues[0];if(O){if(N||(N=O.received),O.code==="invalid_type")A.add(O.expected);else if(O.code==="invalid_literal")A.add("constant (please refer to documentation for allowed values)");else if(O.code==="custom"){const M=O.message.match(/Input not instance of (\w+)/);M&&A.add(M[1])}}}),A.size>0){((F=k.path)==null?void 0:F.length)>0&&v[k.path[0]]instanceof Promise&&(S+="Did you mean to put `await` before a loading function? An unexpected Promise was found. ",w=!0);const $=Array.from(A).join(" or "),O=k.path.join(".");S+=_(N,$,O)}return S};switch(E.code){case"invalid_union":{D(E);break}case"too_small":{const k=E.minimum;S+=`Expected at least ${k} argument${k>1?"s":""}, but received fewer`;break}case"invalid_type":{S+=_(E.received,E.expected,E.path.join("."));break}case"too_big":{const k=E.maximum;S+=`Expected at most ${k} argument${k>1?"s":""}, but received more`;break}default:console.log("Zod error object",E)}S+=` in ${x}().`;const I=k=>{const{funcName:A,funcClass:N}=p(k);return`https://p5js.org/reference/${N}/${A}`};if(E.code==="too_big"||E.code==="too_small"){const k=I(x);S+=` For more information, see ${k}.`}return w?r._error(this,S):console.log(S),S},t.validate=function(y,x){if(r.disableFriendlyErrors)return;if(Array.isArray(x)||(x=Array.from(x)),Array.isArray(x)&&x.length>0&&x.every(S=>S===void 0))return{success:!1,error:` p5.js says: All arguments for ${y}() are undefined. There is likely an error in the code.`};let v=s.get(y);if(!v){if(v=t.generateZodSchemasForFunc(y),!v)return;s.set(y,v)}try{return{success:!0,data:v.parse(x)}}catch{const E=t.findClosestSchema(v,x).safeParse(x).error;return{success:!1,error:t.friendlyParamError(E,y,x)}}},n.presetup=function(){a();const y=["validate"];for(const x in this)if(!y.includes(x)&&!x.startsWith("_")&&typeof this[x]=="function"){const v=this[x];this[x]=function(...S){return this.validate(x,S),v.call(this,...S)}}}}typeof p5<"u"&&g9(p5,p5.prototype);var Fee=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],y9=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Ree="-----------------------------------------------------------------------------------------------------------------------------------------------------",x9="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",TC={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},NC="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Oee={5:NC,"5module":NC+" export import",6:NC+" const class extends export import super"},Mee=/^in(stanceof)?$/,Lee=new RegExp("["+x9+"]"),Bee=new RegExp("["+x9+Ree+"]");function cE(r,t){for(var n=65536,s=0;s<t.length;s+=2){if(n+=t[s],n>r)return!1;if(n+=t[s+1],n>=r)return!0}return!1}function vu(r,t){return r<65?r===36:r<91?!0:r<97?r===95:r<123?!0:r<=65535?r>=170&&Lee.test(String.fromCharCode(r)):t===!1?!1:cE(r,y9)}function md(r,t){return r<48?r===36:r<58?!0:r<65?!1:r<91?!0:r<97?r===95:r<123?!0:r<=65535?r>=170&&Bee.test(String.fromCharCode(r)):t===!1?!1:cE(r,y9)||cE(r,Fee)}var $n=function(t,n){n===void 0&&(n={}),this.label=t,this.keyword=n.keyword,this.beforeExpr=!!n.beforeExpr,this.startsExpr=!!n.startsExpr,this.isLoop=!!n.isLoop,this.isAssign=!!n.isAssign,this.prefix=!!n.prefix,this.postfix=!!n.postfix,this.binop=n.binop||null,this.updateContext=null};function fa(r,t){return new $n(r,{beforeExpr:!0,binop:t})}var da={beforeExpr:!0},wi={startsExpr:!0},NT={};function Tn(r,t){return t===void 0&&(t={}),t.keyword=r,NT[r]=new $n(r,t)}var te={num:new $n("num",wi),regexp:new $n("regexp",wi),string:new $n("string",wi),name:new $n("name",wi),privateId:new $n("privateId",wi),eof:new $n("eof"),bracketL:new $n("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new $n("]"),braceL:new $n("{",{beforeExpr:!0,startsExpr:!0}),braceR:new $n("}"),parenL:new $n("(",{beforeExpr:!0,startsExpr:!0}),parenR:new $n(")"),comma:new $n(",",da),semi:new $n(";",da),colon:new $n(":",da),dot:new $n("."),question:new $n("?",da),questionDot:new $n("?."),arrow:new $n("=>",da),template:new $n("template"),invalidTemplate:new $n("invalidTemplate"),ellipsis:new $n("...",da),backQuote:new $n("`",wi),dollarBraceL:new $n("${",{beforeExpr:!0,startsExpr:!0}),eq:new $n("=",{beforeExpr:!0,isAssign:!0}),assign:new $n("_=",{beforeExpr:!0,isAssign:!0}),incDec:new $n("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new $n("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:fa("||",1),logicalAND:fa("&&",2),bitwiseOR:fa("|",3),bitwiseXOR:fa("^",4),bitwiseAND:fa("&",5),equality:fa("==/!=/===/!==",6),relational:fa("</>/<=/>=",7),bitShift:fa("<</>>/>>>",8),plusMin:new $n("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:fa("%",10),star:fa("*",10),slash:fa("/",10),starstar:new $n("**",{beforeExpr:!0}),coalesce:fa("??",1),_break:Tn("break"),_case:Tn("case",da),_catch:Tn("catch"),_continue:Tn("continue"),_debugger:Tn("debugger"),_default:Tn("default",da),_do:Tn("do",{isLoop:!0,beforeExpr:!0}),_else:Tn("else",da),_finally:Tn("finally"),_for:Tn("for",{isLoop:!0}),_function:Tn("function",wi),_if:Tn("if"),_return:Tn("return",da),_switch:Tn("switch"),_throw:Tn("throw",da),_try:Tn("try"),_var:Tn("var"),_const:Tn("const"),_while:Tn("while",{isLoop:!0}),_with:Tn("with"),_new:Tn("new",{beforeExpr:!0,startsExpr:!0}),_this:Tn("this",wi),_super:Tn("super",wi),_class:Tn("class",wi),_extends:Tn("extends",da),_export:Tn("export"),_import:Tn("import",wi),_null:Tn("null",wi),_true:Tn("true",wi),_false:Tn("false",wi),_in:Tn("in",{beforeExpr:!0,binop:7}),_instanceof:Tn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Tn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Tn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Tn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},$a=/\r\n?|\n|\u2028|\u2029/,Pee=new RegExp($a.source,"g");function Md(r){return r===10||r===13||r===8232||r===8233}function b9(r,t,n){n===void 0&&(n=r.length);for(var s=t;s<n;s++){var i=r.charCodeAt(s);if(Md(i))return s<n-1&&i===13&&r.charCodeAt(s+1)===10?s+2:s+1}return-1}var v9=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,va=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,w9=Object.prototype,Vee=w9.hasOwnProperty,zee=w9.toString,Ld=Object.hasOwn||function(r,t){return Vee.call(r,t)},VF=Array.isArray||function(r){return zee.call(r)==="[object Array]"},zF=Object.create(null);function ml(r){return zF[r]||(zF[r]=new RegExp("^(?:"+r.replace(/ /g,"|")+")$"))}function wu(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}var Uee=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ig=function(t,n){this.line=t,this.column=n};ig.prototype.offset=function(t){return new ig(this.line,this.column+t)};var iv=function(t,n,s){this.start=n,this.end=s,t.sourceFile!==null&&(this.source=t.sourceFile)};function S9(r,t){for(var n=1,s=0;;){var i=b9(r,s,t);if(i<0)return new ig(n,t-s);++n,s=i}}var hE={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},UF=!1;function Gee(r){var t={};for(var n in hE)t[n]=r&&Ld(r,n)?r[n]:hE[n];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!UF&&typeof console=="object"&&console.warn&&(UF=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!r||r.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),VF(t.onToken)){var s=t.onToken;t.onToken=function(i){return s.push(i)}}return VF(t.onComment)&&(t.onComment=jee(t,t.onComment)),t}function jee(r,t){return function(n,s,i,a,o,u){var l={type:n?"Block":"Line",value:s,start:i,end:a};r.locations&&(l.loc=new iv(this,o,u)),r.ranges&&(l.range=[i,a]),t.push(l)}}var ag=1,Bd=2,kT=4,C9=8,AT=16,_9=32,av=64,E9=128,wh=256,Ng=512,ov=ag|Bd|wh;function IT(r,t){return Bd|(r?kT:0)|(t?C9:0)}var jx=0,$T=1,ku=2,D9=3,T9=4,N9=5,ys=function(t,n,s){this.options=t=Gee(t),this.sourceFile=t.sourceFile,this.keywords=ml(Oee[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var i="";t.allowReserved!==!0&&(i=TC[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(i+=" await")),this.reservedWords=ml(i);var a=(i?i+" ":"")+TC.strict;this.reservedWordsStrict=ml(a),this.reservedWordsStrictBind=ml(a+" "+TC.strictBind),this.input=String(n),this.containsEsc=!1,s?(this.pos=s,this.lineStart=this.input.lastIndexOf(`
`,s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split($a).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=te.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(ag),this.regexpState=null,this.privateNameStack=[]},Vo={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};ys.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};Vo.inFunction.get=function(){return(this.currentVarScope().flags&Bd)>0};Vo.inGenerator.get=function(){return(this.currentVarScope().flags&C9)>0};Vo.inAsync.get=function(){return(this.currentVarScope().flags&kT)>0};Vo.canAwait.get=function(){for(var r=this.scopeStack.length-1;r>=0;r--){var t=this.scopeStack[r],n=t.flags;if(n&(wh|Ng))return!1;if(n&Bd)return(n&kT)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Vo.allowSuper.get=function(){var r=this.currentThisScope(),t=r.flags;return(t&av)>0||this.options.allowSuperOutsideMethod};Vo.allowDirectSuper.get=function(){return(this.currentThisScope().flags&E9)>0};Vo.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Vo.allowNewDotTarget.get=function(){for(var r=this.scopeStack.length-1;r>=0;r--){var t=this.scopeStack[r],n=t.flags;if(n&(wh|Ng)||n&Bd&&!(n&AT))return!0}return!1};Vo.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&wh)>0};ys.extend=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];for(var s=this,i=0;i<t.length;i++)s=t[i](s);return s};ys.parse=function(t,n){return new this(n,t).parse()};ys.parseExpressionAt=function(t,n,s){var i=new this(s,t,n);return i.nextToken(),i.parseExpression()};ys.tokenizer=function(t,n){return new this(n,t)};Object.defineProperties(ys.prototype,Vo);var pi=ys.prototype,Wee=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;pi.strictDirective=function(r){if(this.options.ecmaVersion<5)return!1;for(;;){va.lastIndex=r,r+=va.exec(this.input)[0].length;var t=Wee.exec(this.input.slice(r));if(!t)return!1;if((t[1]||t[2])==="use strict"){va.lastIndex=r+t[0].length;var n=va.exec(this.input),s=n.index+n[0].length,i=this.input.charAt(s);return i===";"||i==="}"||$a.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||i==="!"&&this.input.charAt(s+1)==="=")}r+=t[0].length,va.lastIndex=r,r+=va.exec(this.input)[0].length,this.input[r]===";"&&r++}};pi.eat=function(r){return this.type===r?(this.next(),!0):!1};pi.isContextual=function(r){return this.type===te.name&&this.value===r&&!this.containsEsc};pi.eatContextual=function(r){return this.isContextual(r)?(this.next(),!0):!1};pi.expectContextual=function(r){this.eatContextual(r)||this.unexpected()};pi.canInsertSemicolon=function(){return this.type===te.eof||this.type===te.braceR||$a.test(this.input.slice(this.lastTokEnd,this.start))};pi.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};pi.semicolon=function(){!this.eat(te.semi)&&!this.insertSemicolon()&&this.unexpected()};pi.afterTrailingComma=function(r,t){if(this.type===r)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};pi.expect=function(r){this.eat(r)||this.unexpected()};pi.unexpected=function(r){this.raise(r??this.start,"Unexpected token")};var uv=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};pi.checkPatternErrors=function(r,t){if(r){r.trailingComma>-1&&this.raiseRecoverable(r.trailingComma,"Comma is not permitted after the rest element");var n=t?r.parenthesizedAssign:r.parenthesizedBind;n>-1&&this.raiseRecoverable(n,t?"Assigning to rvalue":"Parenthesized pattern")}};pi.checkExpressionErrors=function(r,t){if(!r)return!1;var n=r.shorthandAssign,s=r.doubleProto;if(!t)return n>=0||s>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};pi.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};pi.isSimpleAssignTarget=function(r){return r.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(r.expression):r.type==="Identifier"||r.type==="MemberExpression"};var Ot=ys.prototype;Ot.parseTopLevel=function(r){var t=Object.create(null);for(r.body||(r.body=[]);this.type!==te.eof;){var n=this.parseStatement(null,!0,t);r.body.push(n)}if(this.inModule)for(var s=0,i=Object.keys(this.undefinedExports);s<i.length;s+=1){var a=i[s];this.raiseRecoverable(this.undefinedExports[a].start,"Export '"+a+"' is not defined")}return this.adaptDirectivePrologue(r.body),this.next(),r.sourceType=this.options.sourceType,this.finishNode(r,"Program")};var FT={kind:"loop"},Hee={kind:"switch"};Ot.isLet=function(r){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;va.lastIndex=this.pos;var t=va.exec(this.input),n=this.pos+t[0].length,s=this.input.charCodeAt(n);if(s===91||s===92)return!0;if(r)return!1;if(s===123||s>55295&&s<56320)return!0;if(vu(s,!0)){for(var i=n+1;md(s=this.input.charCodeAt(i),!0);)++i;if(s===92||s>55295&&s<56320)return!0;var a=this.input.slice(n,i);if(!Mee.test(a))return!0}return!1};Ot.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;va.lastIndex=this.pos;var r=va.exec(this.input),t=this.pos+r[0].length,n;return!$a.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(md(n=this.input.charCodeAt(t+8))||n>55295&&n<56320))};Ot.parseStatement=function(r,t,n){var s=this.type,i=this.startNode(),a;switch(this.isLet(r)&&(s=te._var,a="let"),s){case te._break:case te._continue:return this.parseBreakContinueStatement(i,s.keyword);case te._debugger:return this.parseDebuggerStatement(i);case te._do:return this.parseDoStatement(i);case te._for:return this.parseForStatement(i);case te._function:return r&&(this.strict||r!=="if"&&r!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(i,!1,!r);case te._class:return r&&this.unexpected(),this.parseClass(i,!0);case te._if:return this.parseIfStatement(i);case te._return:return this.parseReturnStatement(i);case te._switch:return this.parseSwitchStatement(i);case te._throw:return this.parseThrowStatement(i);case te._try:return this.parseTryStatement(i);case te._const:case te._var:return a=a||this.value,r&&a!=="var"&&this.unexpected(),this.parseVarStatement(i,a);case te._while:return this.parseWhileStatement(i);case te._with:return this.parseWithStatement(i);case te.braceL:return this.parseBlock(!0,i);case te.semi:return this.parseEmptyStatement(i);case te._export:case te._import:if(this.options.ecmaVersion>10&&s===te._import){va.lastIndex=this.pos;var o=va.exec(this.input),u=this.pos+o[0].length,l=this.input.charCodeAt(u);if(l===40||l===46)return this.parseExpressionStatement(i,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===te._import?this.parseImport(i):this.parseExport(i,n);default:if(this.isAsyncFunction())return r&&this.unexpected(),this.next(),this.parseFunctionStatement(i,!0,!r);var c=this.value,h=this.parseExpression();return s===te.name&&h.type==="Identifier"&&this.eat(te.colon)?this.parseLabeledStatement(i,c,h,r):this.parseExpressionStatement(i,h)}};Ot.parseBreakContinueStatement=function(r,t){var n=t==="break";this.next(),this.eat(te.semi)||this.insertSemicolon()?r.label=null:this.type!==te.name?this.unexpected():(r.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var i=this.labels[s];if((r.label==null||i.name===r.label.name)&&(i.kind!=null&&(n||i.kind==="loop")||r.label&&n))break}return s===this.labels.length&&this.raise(r.start,"Unsyntactic "+t),this.finishNode(r,n?"BreakStatement":"ContinueStatement")};Ot.parseDebuggerStatement=function(r){return this.next(),this.semicolon(),this.finishNode(r,"DebuggerStatement")};Ot.parseDoStatement=function(r){return this.next(),this.labels.push(FT),r.body=this.parseStatement("do"),this.labels.pop(),this.expect(te._while),r.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(te.semi):this.semicolon(),this.finishNode(r,"DoWhileStatement")};Ot.parseForStatement=function(r){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(FT),this.enterScope(0),this.expect(te.parenL),this.type===te.semi)return t>-1&&this.unexpected(t),this.parseFor(r,null);var n=this.isLet();if(this.type===te._var||this.type===te._const||n){var s=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(s,!0,i),this.finishNode(s,"VariableDeclaration"),(this.type===te._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&s.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===te._in?t>-1&&this.unexpected(t):r.await=t>-1),this.parseForIn(r,s)):(t>-1&&this.unexpected(t),this.parseFor(r,s))}var a=this.isContextual("let"),o=!1,u=this.containsEsc,l=new uv,c=this.start,h=t>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===te._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===te._in&&this.unexpected(t),r.await=!0):o&&this.options.ecmaVersion>=8&&(h.start===c&&!u&&h.type==="Identifier"&&h.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(r.await=!1)),a&&o&&this.raise(h.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(h,!1,l),this.checkLValPattern(h),this.parseForIn(r,h)):(this.checkExpressionErrors(l,!0),t>-1&&this.unexpected(t),this.parseFor(r,h))};Ot.parseFunctionStatement=function(r,t,n){return this.next(),this.parseFunction(r,Fm|(n?0:fE),!1,t)};Ot.parseIfStatement=function(r){return this.next(),r.test=this.parseParenExpression(),r.consequent=this.parseStatement("if"),r.alternate=this.eat(te._else)?this.parseStatement("if"):null,this.finishNode(r,"IfStatement")};Ot.parseReturnStatement=function(r){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(te.semi)||this.insertSemicolon()?r.argument=null:(r.argument=this.parseExpression(),this.semicolon()),this.finishNode(r,"ReturnStatement")};Ot.parseSwitchStatement=function(r){this.next(),r.discriminant=this.parseParenExpression(),r.cases=[],this.expect(te.braceL),this.labels.push(Hee),this.enterScope(0);for(var t,n=!1;this.type!==te.braceR;)if(this.type===te._case||this.type===te._default){var s=this.type===te._case;t&&this.finishNode(t,"SwitchCase"),r.cases.push(t=this.startNode()),t.consequent=[],this.next(),s?t.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,t.test=null),this.expect(te.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(r,"SwitchStatement")};Ot.parseThrowStatement=function(r){return this.next(),$a.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),r.argument=this.parseExpression(),this.semicolon(),this.finishNode(r,"ThrowStatement")};var qee=[];Ot.parseCatchClauseParam=function(){var r=this.parseBindingAtom(),t=r.type==="Identifier";return this.enterScope(t?_9:0),this.checkLValPattern(r,t?T9:ku),this.expect(te.parenR),r};Ot.parseTryStatement=function(r){if(this.next(),r.block=this.parseBlock(),r.handler=null,this.type===te._catch){var t=this.startNode();this.next(),this.eat(te.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),r.handler=this.finishNode(t,"CatchClause")}return r.finalizer=this.eat(te._finally)?this.parseBlock():null,!r.handler&&!r.finalizer&&this.raise(r.start,"Missing catch or finally clause"),this.finishNode(r,"TryStatement")};Ot.parseVarStatement=function(r,t,n){return this.next(),this.parseVar(r,!1,t,n),this.semicolon(),this.finishNode(r,"VariableDeclaration")};Ot.parseWhileStatement=function(r){return this.next(),r.test=this.parseParenExpression(),this.labels.push(FT),r.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(r,"WhileStatement")};Ot.parseWithStatement=function(r){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),r.object=this.parseParenExpression(),r.body=this.parseStatement("with"),this.finishNode(r,"WithStatement")};Ot.parseEmptyStatement=function(r){return this.next(),this.finishNode(r,"EmptyStatement")};Ot.parseLabeledStatement=function(r,t,n,s){for(var i=0,a=this.labels;i<a.length;i+=1){var o=a[i];o.name===t&&this.raise(n.start,"Label '"+t+"' is already declared")}for(var u=this.type.isLoop?"loop":this.type===te._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===r.start)c.statementStart=this.start,c.kind=u;else break}return this.labels.push({name:t,kind:u,statementStart:this.start}),r.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),r.label=n,this.finishNode(r,"LabeledStatement")};Ot.parseExpressionStatement=function(r,t){return r.expression=t,this.semicolon(),this.finishNode(r,"ExpressionStatement")};Ot.parseBlock=function(r,t,n){for(r===void 0&&(r=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(te.braceL),r&&this.enterScope(0);this.type!==te.braceR;){var s=this.parseStatement(null);t.body.push(s)}return n&&(this.strict=!1),this.next(),r&&this.exitScope(),this.finishNode(t,"BlockStatement")};Ot.parseFor=function(r,t){return r.init=t,this.expect(te.semi),r.test=this.type===te.semi?null:this.parseExpression(),this.expect(te.semi),r.update=this.type===te.parenR?null:this.parseExpression(),this.expect(te.parenR),r.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(r,"ForStatement")};Ot.parseForIn=function(r,t){var n=this.type===te._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!n||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),r.left=t,r.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(te.parenR),r.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(r,n?"ForInStatement":"ForOfStatement")};Ot.parseVar=function(r,t,n,s){for(r.declarations=[],r.kind=n;;){var i=this.startNode();if(this.parseVarId(i,n),this.eat(te.eq)?i.init=this.parseMaybeAssign(t):!s&&n==="const"&&!(this.type===te._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&i.id.type!=="Identifier"&&!(t&&(this.type===te._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):i.init=null,r.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(te.comma))break}return r};Ot.parseVarId=function(r,t){r.id=this.parseBindingAtom(),this.checkLValPattern(r.id,t==="var"?$T:ku,!1)};var Fm=1,fE=2,k9=4;Ot.parseFunction=function(r,t,n,s,i){this.initFunction(r),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===te.star&&t&fE&&this.unexpected(),r.generator=this.eat(te.star)),this.options.ecmaVersion>=8&&(r.async=!!s),t&Fm&&(r.id=t&k9&&this.type!==te.name?null:this.parseIdent(),r.id&&!(t&fE)&&this.checkLValSimple(r.id,this.strict||r.generator||r.async?this.treatFunctionsAsVar?$T:ku:D9));var a=this.yieldPos,o=this.awaitPos,u=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(IT(r.async,r.generator)),t&Fm||(r.id=this.type===te.name?this.parseIdent():null),this.parseFunctionParams(r),this.parseFunctionBody(r,n,!1,i),this.yieldPos=a,this.awaitPos=o,this.awaitIdentPos=u,this.finishNode(r,t&Fm?"FunctionDeclaration":"FunctionExpression")};Ot.parseFunctionParams=function(r){this.expect(te.parenL),r.params=this.parseBindingList(te.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Ot.parseClass=function(r,t){this.next();var n=this.strict;this.strict=!0,this.parseClassId(r,t),this.parseClassSuper(r);var s=this.enterClassBody(),i=this.startNode(),a=!1;for(i.body=[],this.expect(te.braceL);this.type!==te.braceR;){var o=this.parseClassElement(r.superClass!==null);o&&(i.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(a&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),a=!0):o.key&&o.key.type==="PrivateIdentifier"&&Kee(s,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=n,this.next(),r.body=this.finishNode(i,"ClassBody"),this.exitClassBody(),this.finishNode(r,t?"ClassDeclaration":"ClassExpression")};Ot.parseClassElement=function(r){if(this.eat(te.semi))return null;var t=this.options.ecmaVersion,n=this.startNode(),s="",i=!1,a=!1,o="method",u=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(te.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===te.star?u=!0:s="static"}if(n.static=u,!s&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===te.star)&&!this.canInsertSemicolon()?a=!0:s="async"),!s&&(t>=9||!a)&&this.eat(te.star)&&(i=!0),!s&&!a&&!i){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:s=l)}if(s?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=s,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),t<13||this.type===te.parenL||o!=="method"||i||a){var c=!n.static&&Wx(n,"constructor"),h=c&&r;c&&o!=="method"&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=c?"constructor":o,this.parseClassMethod(n,i,a,h)}else this.parseClassField(n);return n};Ot.isClassElementNameStart=function(){return this.type===te.name||this.type===te.privateId||this.type===te.num||this.type===te.string||this.type===te.bracketL||this.type.keyword};Ot.parseClassElementName=function(r){this.type===te.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),r.computed=!1,r.key=this.parsePrivateIdent()):this.parsePropertyName(r)};Ot.parseClassMethod=function(r,t,n,s){var i=r.key;r.kind==="constructor"?(t&&this.raise(i.start,"Constructor can't be a generator"),n&&this.raise(i.start,"Constructor can't be an async method")):r.static&&Wx(r,"prototype")&&this.raise(i.start,"Classes may not have a static property named prototype");var a=r.value=this.parseMethod(t,n,s);return r.kind==="get"&&a.params.length!==0&&this.raiseRecoverable(a.start,"getter should have no params"),r.kind==="set"&&a.params.length!==1&&this.raiseRecoverable(a.start,"setter should have exactly one param"),r.kind==="set"&&a.params[0].type==="RestElement"&&this.raiseRecoverable(a.params[0].start,"Setter cannot use rest params"),this.finishNode(r,"MethodDefinition")};Ot.parseClassField=function(r){return Wx(r,"constructor")?this.raise(r.key.start,"Classes can't have a field named 'constructor'"):r.static&&Wx(r,"prototype")&&this.raise(r.key.start,"Classes can't have a static field named 'prototype'"),this.eat(te.eq)?(this.enterScope(Ng|av),r.value=this.parseMaybeAssign(),this.exitScope()):r.value=null,this.semicolon(),this.finishNode(r,"PropertyDefinition")};Ot.parseClassStaticBlock=function(r){r.body=[];var t=this.labels;for(this.labels=[],this.enterScope(wh|av);this.type!==te.braceR;){var n=this.parseStatement(null);r.body.push(n)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(r,"StaticBlock")};Ot.parseClassId=function(r,t){this.type===te.name?(r.id=this.parseIdent(),t&&this.checkLValSimple(r.id,ku,!1)):(t===!0&&this.unexpected(),r.id=null)};Ot.parseClassSuper=function(r){r.superClass=this.eat(te._extends)?this.parseExprSubscripts(null,!1):null};Ot.enterClassBody=function(){var r={declared:Object.create(null),used:[]};return this.privateNameStack.push(r),r.declared};Ot.exitClassBody=function(){var r=this.privateNameStack.pop(),t=r.declared,n=r.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,i=s===0?null:this.privateNameStack[s-1],a=0;a<n.length;++a){var o=n[a];Ld(t,o.name)||(i?i.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function Kee(r,t){var n=t.key.name,s=r[n],i="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(i=(t.static?"s":"i")+t.kind),s==="iget"&&i==="iset"||s==="iset"&&i==="iget"||s==="sget"&&i==="sset"||s==="sset"&&i==="sget"?(r[n]="true",!1):s?!0:(r[n]=i,!1)}function Wx(r,t){var n=r.computed,s=r.key;return!n&&(s.type==="Identifier"&&s.name===t||s.type==="Literal"&&s.value===t)}Ot.parseExportAllDeclaration=function(r,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(r.exported=this.parseModuleExportName(),this.checkExport(t,r.exported,this.lastTokStart)):r.exported=null),this.expectContextual("from"),this.type!==te.string&&this.unexpected(),r.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(r.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(r,"ExportAllDeclaration")};Ot.parseExport=function(r,t){if(this.next(),this.eat(te.star))return this.parseExportAllDeclaration(r,t);if(this.eat(te._default))return this.checkExport(t,"default",this.lastTokStart),r.declaration=this.parseExportDefaultDeclaration(),this.finishNode(r,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())r.declaration=this.parseExportDeclaration(r),r.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,r.declaration.declarations):this.checkExport(t,r.declaration.id,r.declaration.id.start),r.specifiers=[],r.source=null,this.options.ecmaVersion>=16&&(r.attributes=[]);else{if(r.declaration=null,r.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==te.string&&this.unexpected(),r.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(r.attributes=this.parseWithClause());else{for(var n=0,s=r.specifiers;n<s.length;n+=1){var i=s[n];this.checkUnreserved(i.local),this.checkLocalExport(i.local),i.local.type==="Literal"&&this.raise(i.local.start,"A string literal cannot be used as an exported binding without `from`.")}r.source=null,this.options.ecmaVersion>=16&&(r.attributes=[])}this.semicolon()}return this.finishNode(r,"ExportNamedDeclaration")};Ot.parseExportDeclaration=function(r){return this.parseStatement(null)};Ot.parseExportDefaultDeclaration=function(){var r;if(this.type===te._function||(r=this.isAsyncFunction())){var t=this.startNode();return this.next(),r&&this.next(),this.parseFunction(t,Fm|k9,!1,r)}else if(this.type===te._class){var n=this.startNode();return this.parseClass(n,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};Ot.checkExport=function(r,t,n){r&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),Ld(r,t)&&this.raiseRecoverable(n,"Duplicate export '"+t+"'"),r[t]=!0)};Ot.checkPatternExport=function(r,t){var n=t.type;if(n==="Identifier")this.checkExport(r,t,t.start);else if(n==="ObjectPattern")for(var s=0,i=t.properties;s<i.length;s+=1){var a=i[s];this.checkPatternExport(r,a)}else if(n==="ArrayPattern")for(var o=0,u=t.elements;o<u.length;o+=1){var l=u[o];l&&this.checkPatternExport(r,l)}else n==="Property"?this.checkPatternExport(r,t.value):n==="AssignmentPattern"?this.checkPatternExport(r,t.left):n==="RestElement"&&this.checkPatternExport(r,t.argument)};Ot.checkVariableExport=function(r,t){if(r)for(var n=0,s=t;n<s.length;n+=1){var i=s[n];this.checkPatternExport(r,i.id)}};Ot.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Ot.parseExportSpecifier=function(r){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(r,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};Ot.parseExportSpecifiers=function(r){var t=[],n=!0;for(this.expect(te.braceL);!this.eat(te.braceR);){if(n)n=!1;else if(this.expect(te.comma),this.afterTrailingComma(te.braceR))break;t.push(this.parseExportSpecifier(r))}return t};Ot.parseImport=function(r){return this.next(),this.type===te.string?(r.specifiers=qee,r.source=this.parseExprAtom()):(r.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),r.source=this.type===te.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(r.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(r,"ImportDeclaration")};Ot.parseImportSpecifier=function(){var r=this.startNode();return r.imported=this.parseModuleExportName(),this.eatContextual("as")?r.local=this.parseIdent():(this.checkUnreserved(r.imported),r.local=r.imported),this.checkLValSimple(r.local,ku),this.finishNode(r,"ImportSpecifier")};Ot.parseImportDefaultSpecifier=function(){var r=this.startNode();return r.local=this.parseIdent(),this.checkLValSimple(r.local,ku),this.finishNode(r,"ImportDefaultSpecifier")};Ot.parseImportNamespaceSpecifier=function(){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLValSimple(r.local,ku),this.finishNode(r,"ImportNamespaceSpecifier")};Ot.parseImportSpecifiers=function(){var r=[],t=!0;if(this.type===te.name&&(r.push(this.parseImportDefaultSpecifier()),!this.eat(te.comma)))return r;if(this.type===te.star)return r.push(this.parseImportNamespaceSpecifier()),r;for(this.expect(te.braceL);!this.eat(te.braceR);){if(t)t=!1;else if(this.expect(te.comma),this.afterTrailingComma(te.braceR))break;r.push(this.parseImportSpecifier())}return r};Ot.parseWithClause=function(){var r=[];if(!this.eat(te._with))return r;this.expect(te.braceL);for(var t={},n=!0;!this.eat(te.braceR);){if(n)n=!1;else if(this.expect(te.comma),this.afterTrailingComma(te.braceR))break;var s=this.parseImportAttribute(),i=s.key.type==="Identifier"?s.key.name:s.key.value;Ld(t,i)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+i+"'"),t[i]=!0,r.push(s)}return r};Ot.parseImportAttribute=function(){var r=this.startNode();return r.key=this.type===te.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(te.colon),this.type!==te.string&&this.unexpected(),r.value=this.parseExprAtom(),this.finishNode(r,"ImportAttribute")};Ot.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===te.string){var r=this.parseLiteral(this.value);return Uee.test(r.value)&&this.raise(r.start,"An export name cannot include a lone surrogate."),r}return this.parseIdent(!0)};Ot.adaptDirectivePrologue=function(r){for(var t=0;t<r.length&&this.isDirectiveCandidate(r[t]);++t)r[t].directive=r[t].expression.raw.slice(1,-1)};Ot.isDirectiveCandidate=function(r){return this.options.ecmaVersion>=5&&r.type==="ExpressionStatement"&&r.expression.type==="Literal"&&typeof r.expression.value=="string"&&(this.input[r.start]==='"'||this.input[r.start]==="'")};var Fa=ys.prototype;Fa.toAssignable=function(r,t,n){if(this.options.ecmaVersion>=6&&r)switch(r.type){case"Identifier":this.inAsync&&r.name==="await"&&this.raise(r.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":r.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var s=0,i=r.properties;s<i.length;s+=1){var a=i[s];this.toAssignable(a,t),a.type==="RestElement"&&(a.argument.type==="ArrayPattern"||a.argument.type==="ObjectPattern")&&this.raise(a.argument.start,"Unexpected token")}break;case"Property":r.kind!=="init"&&this.raise(r.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(r.value,t);break;case"ArrayExpression":r.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(r.elements,t);break;case"SpreadElement":r.type="RestElement",this.toAssignable(r.argument,t),r.argument.type==="AssignmentPattern"&&this.raise(r.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":r.operator!=="="&&this.raise(r.left.end,"Only '=' operator can be used for specifying default value."),r.type="AssignmentPattern",delete r.operator,this.toAssignable(r.left,t);break;case"ParenthesizedExpression":this.toAssignable(r.expression,t,n);break;case"ChainExpression":this.raiseRecoverable(r.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(r.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return r};Fa.toAssignableList=function(r,t){for(var n=r.length,s=0;s<n;s++){var i=r[s];i&&this.toAssignable(i,t)}if(n){var a=r[n-1];this.options.ecmaVersion===6&&t&&a&&a.type==="RestElement"&&a.argument.type!=="Identifier"&&this.unexpected(a.argument.start)}return r};Fa.parseSpread=function(r){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,r),this.finishNode(t,"SpreadElement")};Fa.parseRestBinding=function(){var r=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==te.name&&this.unexpected(),r.argument=this.parseBindingAtom(),this.finishNode(r,"RestElement")};Fa.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case te.bracketL:var r=this.startNode();return this.next(),r.elements=this.parseBindingList(te.bracketR,!0,!0),this.finishNode(r,"ArrayPattern");case te.braceL:return this.parseObj(!0)}return this.parseIdent()};Fa.parseBindingList=function(r,t,n,s){for(var i=[],a=!0;!this.eat(r);)if(a?a=!1:this.expect(te.comma),t&&this.type===te.comma)i.push(null);else{if(n&&this.afterTrailingComma(r))break;if(this.type===te.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),i.push(o),this.type===te.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(r);break}else i.push(this.parseAssignableListItem(s))}return i};Fa.parseAssignableListItem=function(r){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};Fa.parseBindingListItem=function(r){return r};Fa.parseMaybeDefault=function(r,t,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(te.eq))return n;var s=this.startNodeAt(r,t);return s.left=n,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};Fa.checkLValSimple=function(r,t,n){t===void 0&&(t=jx);var s=t!==jx;switch(r.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(r.name)&&this.raiseRecoverable(r.start,(s?"Binding ":"Assigning to ")+r.name+" in strict mode"),s&&(t===ku&&r.name==="let"&&this.raiseRecoverable(r.start,"let is disallowed as a lexically bound name"),n&&(Ld(n,r.name)&&this.raiseRecoverable(r.start,"Argument name clash"),n[r.name]=!0),t!==N9&&this.declareName(r.name,t,r.start));break;case"ChainExpression":this.raiseRecoverable(r.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(r.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(r.start,"Binding parenthesized expression"),this.checkLValSimple(r.expression,t,n);default:this.raise(r.start,(s?"Binding":"Assigning to")+" rvalue")}};Fa.checkLValPattern=function(r,t,n){switch(t===void 0&&(t=jx),r.type){case"ObjectPattern":for(var s=0,i=r.properties;s<i.length;s+=1){var a=i[s];this.checkLValInnerPattern(a,t,n)}break;case"ArrayPattern":for(var o=0,u=r.elements;o<u.length;o+=1){var l=u[o];l&&this.checkLValInnerPattern(l,t,n)}break;default:this.checkLValSimple(r,t,n)}};Fa.checkLValInnerPattern=function(r,t,n){switch(t===void 0&&(t=jx),r.type){case"Property":this.checkLValInnerPattern(r.value,t,n);break;case"AssignmentPattern":this.checkLValPattern(r.left,t,n);break;case"RestElement":this.checkLValPattern(r.argument,t,n);break;default:this.checkLValPattern(r,t,n)}};var za=function(t,n,s,i,a){this.token=t,this.isExpr=!!n,this.preserveSpace=!!s,this.override=i,this.generator=!!a},_r={b_stat:new za("{",!1),b_expr:new za("{",!0),b_tmpl:new za("${",!1),p_stat:new za("(",!1),p_expr:new za("(",!0),q_tmpl:new za("`",!0,!0,function(r){return r.tryReadTemplateToken()}),f_stat:new za("function",!1),f_expr:new za("function",!0),f_expr_gen:new za("function",!0,!1,null,!0),f_gen:new za("function",!1,!1,null,!0)},Pd=ys.prototype;Pd.initialContext=function(){return[_r.b_stat]};Pd.curContext=function(){return this.context[this.context.length-1]};Pd.braceIsBlock=function(r){var t=this.curContext();return t===_r.f_expr||t===_r.f_stat?!0:r===te.colon&&(t===_r.b_stat||t===_r.b_expr)?!t.isExpr:r===te._return||r===te.name&&this.exprAllowed?$a.test(this.input.slice(this.lastTokEnd,this.start)):r===te._else||r===te.semi||r===te.eof||r===te.parenR||r===te.arrow?!0:r===te.braceL?t===_r.b_stat:r===te._var||r===te._const||r===te.name?!1:!this.exprAllowed};Pd.inGeneratorContext=function(){for(var r=this.context.length-1;r>=1;r--){var t=this.context[r];if(t.token==="function")return t.generator}return!1};Pd.updateContext=function(r){var t,n=this.type;n.keyword&&r===te.dot?this.exprAllowed=!1:(t=n.updateContext)?t.call(this,r):this.exprAllowed=n.beforeExpr};Pd.overrideContext=function(r){this.curContext()!==r&&(this.context[this.context.length-1]=r)};te.parenR.updateContext=te.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var r=this.context.pop();r===_r.b_stat&&this.curContext().token==="function"&&(r=this.context.pop()),this.exprAllowed=!r.isExpr};te.braceL.updateContext=function(r){this.context.push(this.braceIsBlock(r)?_r.b_stat:_r.b_expr),this.exprAllowed=!0};te.dollarBraceL.updateContext=function(){this.context.push(_r.b_tmpl),this.exprAllowed=!0};te.parenL.updateContext=function(r){var t=r===te._if||r===te._for||r===te._with||r===te._while;this.context.push(t?_r.p_stat:_r.p_expr),this.exprAllowed=!0};te.incDec.updateContext=function(){};te._function.updateContext=te._class.updateContext=function(r){r.beforeExpr&&r!==te._else&&!(r===te.semi&&this.curContext()!==_r.p_stat)&&!(r===te._return&&$a.test(this.input.slice(this.lastTokEnd,this.start)))&&!((r===te.colon||r===te.braceL)&&this.curContext()===_r.b_stat)?this.context.push(_r.f_expr):this.context.push(_r.f_stat),this.exprAllowed=!1};te.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};te.backQuote.updateContext=function(){this.curContext()===_r.q_tmpl?this.context.pop():this.context.push(_r.q_tmpl),this.exprAllowed=!1};te.star.updateContext=function(r){if(r===te._function){var t=this.context.length-1;this.context[t]===_r.f_expr?this.context[t]=_r.f_expr_gen:this.context[t]=_r.f_gen}this.exprAllowed=!0};te.name.updateContext=function(r){var t=!1;this.options.ecmaVersion>=6&&r!==te.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Qt=ys.prototype;Qt.checkPropClash=function(r,t,n){if(!(this.options.ecmaVersion>=9&&r.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(r.computed||r.method||r.shorthand))){var s=r.key,i;switch(s.type){case"Identifier":i=s.name;break;case"Literal":i=String(s.value);break;default:return}var a=r.kind;if(this.options.ecmaVersion>=6){i==="__proto__"&&a==="init"&&(t.proto&&(n?n.doubleProto<0&&(n.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),t.proto=!0);return}i="$"+i;var o=t[i];if(o){var u;a==="init"?u=this.strict&&o.init||o.get||o.set:u=o.init||o[a],u&&this.raiseRecoverable(s.start,"Redefinition of property")}else o=t[i]={init:!1,get:!1,set:!1};o[a]=!0}};Qt.parseExpression=function(r,t){var n=this.start,s=this.startLoc,i=this.parseMaybeAssign(r,t);if(this.type===te.comma){var a=this.startNodeAt(n,s);for(a.expressions=[i];this.eat(te.comma);)a.expressions.push(this.parseMaybeAssign(r,t));return this.finishNode(a,"SequenceExpression")}return i};Qt.parseMaybeAssign=function(r,t,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(r);this.exprAllowed=!1}var s=!1,i=-1,a=-1,o=-1;t?(i=t.parenthesizedAssign,a=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new uv,s=!0);var u=this.start,l=this.startLoc;(this.type===te.parenL||this.type===te.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=r==="await");var c=this.parseMaybeConditional(r,t);if(n&&(c=n.call(this,c,u,l)),this.type.isAssign){var h=this.startNodeAt(u,l);return h.operator=this.value,this.type===te.eq&&(c=this.toAssignable(c,!1,t)),s||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.start&&(t.shorthandAssign=-1),this.type===te.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(r),o>-1&&(t.doubleProto=o),this.finishNode(h,"AssignmentExpression")}else s&&this.checkExpressionErrors(t,!0);return i>-1&&(t.parenthesizedAssign=i),a>-1&&(t.trailingComma=a),c};Qt.parseMaybeConditional=function(r,t){var n=this.start,s=this.startLoc,i=this.parseExprOps(r,t);if(this.checkExpressionErrors(t))return i;if(this.eat(te.question)){var a=this.startNodeAt(n,s);return a.test=i,a.consequent=this.parseMaybeAssign(),this.expect(te.colon),a.alternate=this.parseMaybeAssign(r),this.finishNode(a,"ConditionalExpression")}return i};Qt.parseExprOps=function(r,t){var n=this.start,s=this.startLoc,i=this.parseMaybeUnary(t,!1,!1,r);return this.checkExpressionErrors(t)||i.start===n&&i.type==="ArrowFunctionExpression"?i:this.parseExprOp(i,n,s,-1,r)};Qt.parseExprOp=function(r,t,n,s,i){var a=this.type.binop;if(a!=null&&(!i||this.type!==te._in)&&a>s){var o=this.type===te.logicalOR||this.type===te.logicalAND,u=this.type===te.coalesce;u&&(a=te.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,f=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,i),c,h,a,i),p=this.buildBinary(t,n,r,f,l,o||u);return(o&&this.type===te.coalesce||u&&(this.type===te.logicalOR||this.type===te.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(p,t,n,s,i)}return r};Qt.buildBinary=function(r,t,n,s,i,a){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(r,t);return o.left=n,o.operator=i,o.right=s,this.finishNode(o,a?"LogicalExpression":"BinaryExpression")};Qt.parseMaybeUnary=function(r,t,n,s){var i=this.start,a=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(s),t=!0;else if(this.type.prefix){var u=this.startNode(),l=this.type===te.incDec;u.operator=this.value,u.prefix=!0,this.next(),u.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(r,!0),l?this.checkLValSimple(u.argument):this.strict&&u.operator==="delete"&&A9(u.argument)?this.raiseRecoverable(u.start,"Deleting local variable in strict mode"):u.operator==="delete"&&dE(u.argument)?this.raiseRecoverable(u.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(u,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===te.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==te._in&&this.unexpected();else{if(o=this.parseExprSubscripts(r,s),this.checkExpressionErrors(r))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(i,a);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!n&&this.eat(te.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(i,a,o,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return o};function A9(r){return r.type==="Identifier"||r.type==="ParenthesizedExpression"&&A9(r.expression)}function dE(r){return r.type==="MemberExpression"&&r.property.type==="PrivateIdentifier"||r.type==="ChainExpression"&&dE(r.expression)||r.type==="ParenthesizedExpression"&&dE(r.expression)}Qt.parseExprSubscripts=function(r,t){var n=this.start,s=this.startLoc,i=this.parseExprAtom(r,t);if(i.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return i;var a=this.parseSubscripts(i,n,s,!1,t);return r&&a.type==="MemberExpression"&&(r.parenthesizedAssign>=a.start&&(r.parenthesizedAssign=-1),r.parenthesizedBind>=a.start&&(r.parenthesizedBind=-1),r.trailingComma>=a.start&&(r.trailingComma=-1)),a};Qt.parseSubscripts=function(r,t,n,s,i){for(var a=this.options.ecmaVersion>=8&&r.type==="Identifier"&&r.name==="async"&&this.lastTokEnd===r.end&&!this.canInsertSemicolon()&&r.end-r.start===5&&this.potentialArrowAt===r.start,o=!1;;){var u=this.parseSubscript(r,t,n,s,a,o,i);if(u.optional&&(o=!0),u===r||u.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(t,n);l.expression=u,u=this.finishNode(l,"ChainExpression")}return u}r=u}};Qt.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(te.arrow)};Qt.parseSubscriptAsyncArrow=function(r,t,n,s){return this.parseArrowExpression(this.startNodeAt(r,t),n,!0,s)};Qt.parseSubscript=function(r,t,n,s,i,a,o){var u=this.options.ecmaVersion>=11,l=u&&this.eat(te.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(te.bracketL);if(c||l&&this.type!==te.parenL&&this.type!==te.backQuote||this.eat(te.dot)){var h=this.startNodeAt(t,n);h.object=r,c?(h.property=this.parseExpression(),this.expect(te.bracketR)):this.type===te.privateId&&r.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,u&&(h.optional=l),r=this.finishNode(h,"MemberExpression")}else if(!s&&this.eat(te.parenL)){var f=new uv,p=this.yieldPos,g=this.awaitPos,y=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var x=this.parseExprList(te.parenR,this.options.ecmaVersion>=8,!1,f);if(i&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=p,this.awaitPos=g,this.awaitIdentPos=y,this.parseSubscriptAsyncArrow(t,n,x,o);this.checkExpressionErrors(f,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=g||this.awaitPos,this.awaitIdentPos=y||this.awaitIdentPos;var v=this.startNodeAt(t,n);v.callee=r,v.arguments=x,u&&(v.optional=l),r=this.finishNode(v,"CallExpression")}else if(this.type===te.backQuote){(l||a)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var S=this.startNodeAt(t,n);S.tag=r,S.quasi=this.parseTemplate({isTagged:!0}),r=this.finishNode(S,"TaggedTemplateExpression")}return r};Qt.parseExprAtom=function(r,t,n){this.type===te.slash&&this.readRegexp();var s,i=this.potentialArrowAt===this.start;switch(this.type){case te._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===te.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==te.dot&&this.type!==te.bracketL&&this.type!==te.parenL&&this.unexpected(),this.finishNode(s,"Super");case te._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case te.name:var a=this.start,o=this.startLoc,u=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!u&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(te._function))return this.overrideContext(_r.f_expr),this.parseFunction(this.startNodeAt(a,o),0,!1,!0,t);if(i&&!this.canInsertSemicolon()){if(this.eat(te.arrow))return this.parseArrowExpression(this.startNodeAt(a,o),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===te.name&&!u&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(te.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(a,o),[l],!0,t)}return l;case te.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case te.num:case te.string:return this.parseLiteral(this.value);case te._null:case te._true:case te._false:return s=this.startNode(),s.value=this.type===te._null?null:this.type===te._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case te.parenL:var h=this.start,f=this.parseParenAndDistinguishExpression(i,t);return r&&(r.parenthesizedAssign<0&&!this.isSimpleAssignTarget(f)&&(r.parenthesizedAssign=h),r.parenthesizedBind<0&&(r.parenthesizedBind=h)),f;case te.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(te.bracketR,!0,!0,r),this.finishNode(s,"ArrayExpression");case te.braceL:return this.overrideContext(_r.b_expr),this.parseObj(!1,r);case te._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case te._class:return this.parseClass(this.startNode(),!1);case te._new:return this.parseNew();case te.backQuote:return this.parseTemplate();case te._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}};Qt.parseExprAtomDefault=function(){this.unexpected()};Qt.parseExprImport=function(r){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===te.parenL&&!r)return this.parseDynamicImport(t);if(this.type===te.dot){var n=this.startNodeAt(t.start,t.loc&&t.loc.start);return n.name="import",t.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};Qt.parseDynamicImport=function(r){if(this.next(),r.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(te.parenR)?r.options=null:(this.expect(te.comma),this.afterTrailingComma(te.parenR)?r.options=null:(r.options=this.parseMaybeAssign(),this.eat(te.parenR)||(this.expect(te.comma),this.afterTrailingComma(te.parenR)||this.unexpected())));else if(!this.eat(te.parenR)){var t=this.start;this.eat(te.comma)&&this.eat(te.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(r,"ImportExpression")};Qt.parseImportMeta=function(r){this.next();var t=this.containsEsc;return r.property=this.parseIdent(!0),r.property.name!=="meta"&&this.raiseRecoverable(r.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(r.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(r.start,"Cannot use 'import.meta' outside a module"),this.finishNode(r,"MetaProperty")};Qt.parseLiteral=function(r){var t=this.startNode();return t.value=r,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Qt.parseParenExpression=function(){this.expect(te.parenL);var r=this.parseExpression();return this.expect(te.parenR),r};Qt.shouldParseArrow=function(r){return!this.canInsertSemicolon()};Qt.parseParenAndDistinguishExpression=function(r,t){var n=this.start,s=this.startLoc,i,a=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,u=this.startLoc,l=[],c=!0,h=!1,f=new uv,p=this.yieldPos,g=this.awaitPos,y;for(this.yieldPos=0,this.awaitPos=0;this.type!==te.parenR;)if(c?c=!1:this.expect(te.comma),a&&this.afterTrailingComma(te.parenR,!0)){h=!0;break}else if(this.type===te.ellipsis){y=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===te.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,f,this.parseParenItem));var x=this.lastTokEnd,v=this.lastTokEndLoc;if(this.expect(te.parenR),r&&this.shouldParseArrow(l)&&this.eat(te.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=g,this.parseParenArrowList(n,s,l,t);(!l.length||h)&&this.unexpected(this.lastTokStart),y&&this.unexpected(y),this.checkExpressionErrors(f,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=g||this.awaitPos,l.length>1?(i=this.startNodeAt(o,u),i.expressions=l,this.finishNodeAt(i,"SequenceExpression",x,v)):i=l[0]}else i=this.parseParenExpression();if(this.options.preserveParens){var S=this.startNodeAt(n,s);return S.expression=i,this.finishNode(S,"ParenthesizedExpression")}else return i};Qt.parseParenItem=function(r){return r};Qt.parseParenArrowList=function(r,t,n,s){return this.parseArrowExpression(this.startNodeAt(r,t),n,!1,s)};var Xee=[];Qt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var r=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===te.dot){var t=this.startNodeAt(r.start,r.loc&&r.loc.start);t.name="new",r.meta=this.finishNode(t,"Identifier"),this.next();var n=this.containsEsc;return r.property=this.parseIdent(!0),r.property.name!=="target"&&this.raiseRecoverable(r.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(r.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(r.start,"'new.target' can only be used in functions and class static block"),this.finishNode(r,"MetaProperty")}var s=this.start,i=this.startLoc;return r.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,i,!0,!1),this.eat(te.parenL)?r.arguments=this.parseExprList(te.parenR,this.options.ecmaVersion>=8,!1):r.arguments=Xee,this.finishNode(r,"NewExpression")};Qt.parseTemplateElement=function(r){var t=r.isTagged,n=this.startNode();return this.type===te.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),n.tail=this.type===te.backQuote,this.finishNode(n,"TemplateElement")};Qt.parseTemplate=function(r){r===void 0&&(r={});var t=r.isTagged;t===void 0&&(t=!1);var n=this.startNode();this.next(),n.expressions=[];var s=this.parseTemplateElement({isTagged:t});for(n.quasis=[s];!s.tail;)this.type===te.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(te.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(te.braceR),n.quasis.push(s=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(n,"TemplateLiteral")};Qt.isAsyncProp=function(r){return!r.computed&&r.key.type==="Identifier"&&r.key.name==="async"&&(this.type===te.name||this.type===te.num||this.type===te.string||this.type===te.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===te.star)&&!$a.test(this.input.slice(this.lastTokEnd,this.start))};Qt.parseObj=function(r,t){var n=this.startNode(),s=!0,i={};for(n.properties=[],this.next();!this.eat(te.braceR);){if(s)s=!1;else if(this.expect(te.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(te.braceR))break;var a=this.parseProperty(r,t);r||this.checkPropClash(a,i,t),n.properties.push(a)}return this.finishNode(n,r?"ObjectPattern":"ObjectExpression")};Qt.parseProperty=function(r,t){var n=this.startNode(),s,i,a,o;if(this.options.ecmaVersion>=9&&this.eat(te.ellipsis))return r?(n.argument=this.parseIdent(!1),this.type===te.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(n,"RestElement")):(n.argument=this.parseMaybeAssign(!1,t),this.type===te.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(n,"SpreadElement"));this.options.ecmaVersion>=6&&(n.method=!1,n.shorthand=!1,(r||t)&&(a=this.start,o=this.startLoc),r||(s=this.eat(te.star)));var u=this.containsEsc;return this.parsePropertyName(n),!r&&!u&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(n)?(i=!0,s=this.options.ecmaVersion>=9&&this.eat(te.star),this.parsePropertyName(n)):i=!1,this.parsePropertyValue(n,r,s,i,a,o,t,u),this.finishNode(n,"Property")};Qt.parseGetterSetter=function(r){var t=r.key.name;this.parsePropertyName(r),r.value=this.parseMethod(!1),r.kind=t;var n=r.kind==="get"?0:1;if(r.value.params.length!==n){var s=r.value.start;r.kind==="get"?this.raiseRecoverable(s,"getter should have no params"):this.raiseRecoverable(s,"setter should have exactly one param")}else r.kind==="set"&&r.value.params[0].type==="RestElement"&&this.raiseRecoverable(r.value.params[0].start,"Setter cannot use rest params")};Qt.parsePropertyValue=function(r,t,n,s,i,a,o,u){(n||s)&&this.type===te.colon&&this.unexpected(),this.eat(te.colon)?(r.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),r.kind="init"):this.options.ecmaVersion>=6&&this.type===te.parenL?(t&&this.unexpected(),r.method=!0,r.value=this.parseMethod(n,s),r.kind="init"):!t&&!u&&this.options.ecmaVersion>=5&&!r.computed&&r.key.type==="Identifier"&&(r.key.name==="get"||r.key.name==="set")&&this.type!==te.comma&&this.type!==te.braceR&&this.type!==te.eq?((n||s)&&this.unexpected(),this.parseGetterSetter(r)):this.options.ecmaVersion>=6&&!r.computed&&r.key.type==="Identifier"?((n||s)&&this.unexpected(),this.checkUnreserved(r.key),r.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=i),t?r.value=this.parseMaybeDefault(i,a,this.copyNode(r.key)):this.type===te.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),r.value=this.parseMaybeDefault(i,a,this.copyNode(r.key))):r.value=this.copyNode(r.key),r.kind="init",r.shorthand=!0):this.unexpected()};Qt.parsePropertyName=function(r){if(this.options.ecmaVersion>=6){if(this.eat(te.bracketL))return r.computed=!0,r.key=this.parseMaybeAssign(),this.expect(te.bracketR),r.key;r.computed=!1}return r.key=this.type===te.num||this.type===te.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Qt.initFunction=function(r){r.id=null,this.options.ecmaVersion>=6&&(r.generator=r.expression=!1),this.options.ecmaVersion>=8&&(r.async=!1)};Qt.parseMethod=function(r,t,n){var s=this.startNode(),i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=r),this.options.ecmaVersion>=8&&(s.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(IT(t,s.generator)|av|(n?E9:0)),this.expect(te.parenL),s.params=this.parseBindingList(te.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(s,"FunctionExpression")};Qt.parseArrowExpression=function(r,t,n,s){var i=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(IT(n,!1)|AT),this.initFunction(r),this.options.ecmaVersion>=8&&(r.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,r.params=this.toAssignableList(t,!0),this.parseFunctionBody(r,!0,!1,s),this.yieldPos=i,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(r,"ArrowFunctionExpression")};Qt.parseFunctionBody=function(r,t,n,s){var i=t&&this.type!==te.braceL,a=this.strict,o=!1;if(i)r.body=this.parseMaybeAssign(s),r.expression=!0,this.checkParams(r,!1);else{var u=this.options.ecmaVersion>=7&&!this.isSimpleParamList(r.params);(!a||u)&&(o=this.strictDirective(this.end),o&&u&&this.raiseRecoverable(r.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(r,!a&&!o&&!t&&!n&&this.isSimpleParamList(r.params)),this.strict&&r.id&&this.checkLValSimple(r.id,N9),r.body=this.parseBlock(!1,void 0,o&&!a),r.expression=!1,this.adaptDirectivePrologue(r.body.body),this.labels=l}this.exitScope()};Qt.isSimpleParamList=function(r){for(var t=0,n=r;t<n.length;t+=1){var s=n[t];if(s.type!=="Identifier")return!1}return!0};Qt.checkParams=function(r,t){for(var n=Object.create(null),s=0,i=r.params;s<i.length;s+=1){var a=i[s];this.checkLValInnerPattern(a,$T,t?null:n)}};Qt.parseExprList=function(r,t,n,s){for(var i=[],a=!0;!this.eat(r);){if(a)a=!1;else if(this.expect(te.comma),t&&this.afterTrailingComma(r))break;var o=void 0;n&&this.type===te.comma?o=null:this.type===te.ellipsis?(o=this.parseSpread(s),s&&this.type===te.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):o=this.parseMaybeAssign(!1,s),i.push(o)}return i};Qt.checkUnreserved=function(r){var t=r.start,n=r.end,s=r.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&ov)&&s==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(t,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(t,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,n).indexOf("\\")!==-1)){var i=this.strict?this.reservedWordsStrict:this.reservedWords;i.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+s+"' is reserved"))}};Qt.parseIdent=function(r){var t=this.parseIdentNode();return this.next(!!r),this.finishNode(t,"Identifier"),r||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};Qt.parseIdentNode=function(){var r=this.startNode();return this.type===te.name?r.name=this.value:this.type.keyword?(r.name=this.type.keyword,(r.name==="class"||r.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=te.name):this.unexpected(),r};Qt.parsePrivateIdent=function(){var r=this.startNode();return this.type===te.privateId?r.name=this.value:this.unexpected(),this.next(),this.finishNode(r,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(r.start,"Private field '#"+r.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(r)),r};Qt.parseYield=function(r){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===te.semi||this.canInsertSemicolon()||this.type!==te.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(te.star),t.argument=this.parseMaybeAssign(r)),this.finishNode(t,"YieldExpression")};Qt.parseAwait=function(r){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,r),this.finishNode(t,"AwaitExpression")};var Hx=ys.prototype;Hx.raise=function(r,t){var n=S9(this.input,r);t+=" ("+n.line+":"+n.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var s=new SyntaxError(t);throw s.pos=r,s.loc=n,s.raisedAt=this.pos,s};Hx.raiseRecoverable=Hx.raise;Hx.curPosition=function(){if(this.options.locations)return new ig(this.curLine,this.pos-this.lineStart)};var Vl=ys.prototype,Yee=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};Vl.enterScope=function(r){this.scopeStack.push(new Yee(r))};Vl.exitScope=function(){this.scopeStack.pop()};Vl.treatFunctionsAsVarInScope=function(r){return r.flags&Bd||!this.inModule&&r.flags&ag};Vl.declareName=function(r,t,n){var s=!1;if(t===ku){var i=this.currentScope();s=i.lexical.indexOf(r)>-1||i.functions.indexOf(r)>-1||i.var.indexOf(r)>-1,i.lexical.push(r),this.inModule&&i.flags&ag&&delete this.undefinedExports[r]}else if(t===T9){var a=this.currentScope();a.lexical.push(r)}else if(t===D9){var o=this.currentScope();this.treatFunctionsAsVar?s=o.lexical.indexOf(r)>-1:s=o.lexical.indexOf(r)>-1||o.var.indexOf(r)>-1,o.functions.push(r)}else for(var u=this.scopeStack.length-1;u>=0;--u){var l=this.scopeStack[u];if(l.lexical.indexOf(r)>-1&&!(l.flags&_9&&l.lexical[0]===r)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(r)>-1){s=!0;break}if(l.var.push(r),this.inModule&&l.flags&ag&&delete this.undefinedExports[r],l.flags&ov)break}s&&this.raiseRecoverable(n,"Identifier '"+r+"' has already been declared")};Vl.checkLocalExport=function(r){this.scopeStack[0].lexical.indexOf(r.name)===-1&&this.scopeStack[0].var.indexOf(r.name)===-1&&(this.undefinedExports[r.name]=r)};Vl.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};Vl.currentVarScope=function(){for(var r=this.scopeStack.length-1;;r--){var t=this.scopeStack[r];if(t.flags&(ov|Ng|wh))return t}};Vl.currentThisScope=function(){for(var r=this.scopeStack.length-1;;r--){var t=this.scopeStack[r];if(t.flags&(ov|Ng|wh)&&!(t.flags&AT))return t}};var lv=function(t,n,s){this.type="",this.start=n,this.end=0,t.options.locations&&(this.loc=new iv(t,s)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[n,0])},kg=ys.prototype;kg.startNode=function(){return new lv(this,this.start,this.startLoc)};kg.startNodeAt=function(r,t){return new lv(this,r,t)};function I9(r,t,n,s){return r.type=t,r.end=n,this.options.locations&&(r.loc.end=s),this.options.ranges&&(r.range[1]=n),r}kg.finishNode=function(r,t){return I9.call(this,r,t,this.lastTokEnd,this.lastTokEndLoc)};kg.finishNodeAt=function(r,t,n,s){return I9.call(this,r,t,n,s)};kg.copyNode=function(r){var t=new lv(this,r.start,this.startLoc);for(var n in r)t[n]=r[n];return t};var Zee="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",$9="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",F9=$9+" Extended_Pictographic",R9=F9,O9=R9+" EBase EComp EMod EPres ExtPict",M9=O9,Qee=M9,Jee={9:$9,10:F9,11:R9,12:O9,13:M9,14:Qee},ete="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",tte={9:"",10:"",11:"",12:"",13:"",14:ete},GF="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",L9="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",B9=L9+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",P9=B9+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",V9=P9+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",z9=V9+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",nte=z9+" "+Zee,rte={9:L9,10:B9,11:P9,12:V9,13:z9,14:nte},U9={};function ste(r){var t=U9[r]={binary:ml(Jee[r]+" "+GF),binaryOfStrings:ml(tte[r]),nonBinary:{General_Category:ml(GF),Script:ml(rte[r])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var kC=0,jF=[9,10,11,12,13,14];kC<jF.length;kC+=1){var ite=jF[kC];ste(ite)}var At=ys.prototype,qx=function(t,n){this.parent=t,this.base=n||this};qx.prototype.separatedFrom=function(t){for(var n=this;n;n=n.parent)for(var s=t;s;s=s.parent)if(n.base===s.base&&n!==s)return!0;return!1};qx.prototype.sibling=function(){return new qx(this.parent,this.base)};var zo=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=U9[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};zo.prototype.reset=function(t,n,s){var i=s.indexOf("v")!==-1,a=s.indexOf("u")!==-1;this.start=t|0,this.source=n+"",this.flags=s,i&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=a&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=a&&this.parser.options.ecmaVersion>=9)};zo.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};zo.prototype.at=function(t,n){n===void 0&&(n=!1);var s=this.source,i=s.length;if(t>=i)return-1;var a=s.charCodeAt(t);if(!(n||this.switchU)||a<=55295||a>=57344||t+1>=i)return a;var o=s.charCodeAt(t+1);return o>=56320&&o<=57343?(a<<10)+o-56613888:a};zo.prototype.nextIndex=function(t,n){n===void 0&&(n=!1);var s=this.source,i=s.length;if(t>=i)return i;var a=s.charCodeAt(t),o;return!(n||this.switchU)||a<=55295||a>=57344||t+1>=i||(o=s.charCodeAt(t+1))<56320||o>57343?t+1:t+2};zo.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};zo.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};zo.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};zo.prototype.eat=function(t,n){return n===void 0&&(n=!1),this.current(n)===t?(this.advance(n),!0):!1};zo.prototype.eatChars=function(t,n){n===void 0&&(n=!1);for(var s=this.pos,i=0,a=t;i<a.length;i+=1){var o=a[i],u=this.at(s,n);if(u===-1||u!==o)return!1;s=this.nextIndex(s,n)}return this.pos=s,!0};At.validateRegExpFlags=function(r){for(var t=r.validFlags,n=r.flags,s=!1,i=!1,a=0;a<n.length;a++){var o=n.charAt(a);t.indexOf(o)===-1&&this.raise(r.start,"Invalid regular expression flag"),n.indexOf(o,a+1)>-1&&this.raise(r.start,"Duplicate regular expression flag"),o==="u"&&(s=!0),o==="v"&&(i=!0)}this.options.ecmaVersion>=15&&s&&i&&this.raise(r.start,"Invalid regular expression flag")};function ate(r){for(var t in r)return!0;return!1}At.validateRegExpPattern=function(r){this.regexp_pattern(r),!r.switchN&&this.options.ecmaVersion>=9&&ate(r.groupNames)&&(r.switchN=!0,this.regexp_pattern(r))};At.regexp_pattern=function(r){r.pos=0,r.lastIntValue=0,r.lastStringValue="",r.lastAssertionIsQuantifiable=!1,r.numCapturingParens=0,r.maxBackReference=0,r.groupNames=Object.create(null),r.backReferenceNames.length=0,r.branchID=null,this.regexp_disjunction(r),r.pos!==r.source.length&&(r.eat(41)&&r.raise("Unmatched ')'"),(r.eat(93)||r.eat(125))&&r.raise("Lone quantifier brackets")),r.maxBackReference>r.numCapturingParens&&r.raise("Invalid escape");for(var t=0,n=r.backReferenceNames;t<n.length;t+=1){var s=n[t];r.groupNames[s]||r.raise("Invalid named capture referenced")}};At.regexp_disjunction=function(r){var t=this.options.ecmaVersion>=16;for(t&&(r.branchID=new qx(r.branchID,null)),this.regexp_alternative(r);r.eat(124);)t&&(r.branchID=r.branchID.sibling()),this.regexp_alternative(r);t&&(r.branchID=r.branchID.parent),this.regexp_eatQuantifier(r,!0)&&r.raise("Nothing to repeat"),r.eat(123)&&r.raise("Lone quantifier brackets")};At.regexp_alternative=function(r){for(;r.pos<r.source.length&&this.regexp_eatTerm(r););};At.regexp_eatTerm=function(r){return this.regexp_eatAssertion(r)?(r.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(r)&&r.switchU&&r.raise("Invalid quantifier"),!0):(r.switchU?this.regexp_eatAtom(r):this.regexp_eatExtendedAtom(r))?(this.regexp_eatQuantifier(r),!0):!1};At.regexp_eatAssertion=function(r){var t=r.pos;if(r.lastAssertionIsQuantifiable=!1,r.eat(94)||r.eat(36))return!0;if(r.eat(92)){if(r.eat(66)||r.eat(98))return!0;r.pos=t}if(r.eat(40)&&r.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=r.eat(60)),r.eat(61)||r.eat(33))return this.regexp_disjunction(r),r.eat(41)||r.raise("Unterminated group"),r.lastAssertionIsQuantifiable=!n,!0}return r.pos=t,!1};At.regexp_eatQuantifier=function(r,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(r,t)?(r.eat(63),!0):!1};At.regexp_eatQuantifierPrefix=function(r,t){return r.eat(42)||r.eat(43)||r.eat(63)||this.regexp_eatBracedQuantifier(r,t)};At.regexp_eatBracedQuantifier=function(r,t){var n=r.pos;if(r.eat(123)){var s=0,i=-1;if(this.regexp_eatDecimalDigits(r)&&(s=r.lastIntValue,r.eat(44)&&this.regexp_eatDecimalDigits(r)&&(i=r.lastIntValue),r.eat(125)))return i!==-1&&i<s&&!t&&r.raise("numbers out of order in {} quantifier"),!0;r.switchU&&!t&&r.raise("Incomplete quantifier"),r.pos=n}return!1};At.regexp_eatAtom=function(r){return this.regexp_eatPatternCharacters(r)||r.eat(46)||this.regexp_eatReverseSolidusAtomEscape(r)||this.regexp_eatCharacterClass(r)||this.regexp_eatUncapturingGroup(r)||this.regexp_eatCapturingGroup(r)};At.regexp_eatReverseSolidusAtomEscape=function(r){var t=r.pos;if(r.eat(92)){if(this.regexp_eatAtomEscape(r))return!0;r.pos=t}return!1};At.regexp_eatUncapturingGroup=function(r){var t=r.pos;if(r.eat(40)){if(r.eat(63)){if(this.options.ecmaVersion>=16){var n=this.regexp_eatModifiers(r),s=r.eat(45);if(n||s){for(var i=0;i<n.length;i++){var a=n.charAt(i);n.indexOf(a,i+1)>-1&&r.raise("Duplicate regular expression modifiers")}if(s){var o=this.regexp_eatModifiers(r);!n&&!o&&r.current()===58&&r.raise("Invalid regular expression modifiers");for(var u=0;u<o.length;u++){var l=o.charAt(u);(o.indexOf(l,u+1)>-1||n.indexOf(l)>-1)&&r.raise("Duplicate regular expression modifiers")}}}}if(r.eat(58)){if(this.regexp_disjunction(r),r.eat(41))return!0;r.raise("Unterminated group")}}r.pos=t}return!1};At.regexp_eatCapturingGroup=function(r){if(r.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(r):r.current()===63&&r.raise("Invalid group"),this.regexp_disjunction(r),r.eat(41))return r.numCapturingParens+=1,!0;r.raise("Unterminated group")}return!1};At.regexp_eatModifiers=function(r){for(var t="",n=0;(n=r.current())!==-1&&ote(n);)t+=wu(n),r.advance();return t};function ote(r){return r===105||r===109||r===115}At.regexp_eatExtendedAtom=function(r){return r.eat(46)||this.regexp_eatReverseSolidusAtomEscape(r)||this.regexp_eatCharacterClass(r)||this.regexp_eatUncapturingGroup(r)||this.regexp_eatCapturingGroup(r)||this.regexp_eatInvalidBracedQuantifier(r)||this.regexp_eatExtendedPatternCharacter(r)};At.regexp_eatInvalidBracedQuantifier=function(r){return this.regexp_eatBracedQuantifier(r,!0)&&r.raise("Nothing to repeat"),!1};At.regexp_eatSyntaxCharacter=function(r){var t=r.current();return G9(t)?(r.lastIntValue=t,r.advance(),!0):!1};function G9(r){return r===36||r>=40&&r<=43||r===46||r===63||r>=91&&r<=94||r>=123&&r<=125}At.regexp_eatPatternCharacters=function(r){for(var t=r.pos,n=0;(n=r.current())!==-1&&!G9(n);)r.advance();return r.pos!==t};At.regexp_eatExtendedPatternCharacter=function(r){var t=r.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(r.advance(),!0):!1};At.regexp_groupSpecifier=function(r){if(r.eat(63)){this.regexp_eatGroupName(r)||r.raise("Invalid group");var t=this.options.ecmaVersion>=16,n=r.groupNames[r.lastStringValue];if(n)if(t)for(var s=0,i=n;s<i.length;s+=1){var a=i[s];a.separatedFrom(r.branchID)||r.raise("Duplicate capture group name")}else r.raise("Duplicate capture group name");t?(n||(r.groupNames[r.lastStringValue]=[])).push(r.branchID):r.groupNames[r.lastStringValue]=!0}};At.regexp_eatGroupName=function(r){if(r.lastStringValue="",r.eat(60)){if(this.regexp_eatRegExpIdentifierName(r)&&r.eat(62))return!0;r.raise("Invalid capture group name")}return!1};At.regexp_eatRegExpIdentifierName=function(r){if(r.lastStringValue="",this.regexp_eatRegExpIdentifierStart(r)){for(r.lastStringValue+=wu(r.lastIntValue);this.regexp_eatRegExpIdentifierPart(r);)r.lastStringValue+=wu(r.lastIntValue);return!0}return!1};At.regexp_eatRegExpIdentifierStart=function(r){var t=r.pos,n=this.options.ecmaVersion>=11,s=r.current(n);return r.advance(n),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(r,n)&&(s=r.lastIntValue),ute(s)?(r.lastIntValue=s,!0):(r.pos=t,!1)};function ute(r){return vu(r,!0)||r===36||r===95}At.regexp_eatRegExpIdentifierPart=function(r){var t=r.pos,n=this.options.ecmaVersion>=11,s=r.current(n);return r.advance(n),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(r,n)&&(s=r.lastIntValue),lte(s)?(r.lastIntValue=s,!0):(r.pos=t,!1)};function lte(r){return md(r,!0)||r===36||r===95||r===8204||r===8205}At.regexp_eatAtomEscape=function(r){return this.regexp_eatBackReference(r)||this.regexp_eatCharacterClassEscape(r)||this.regexp_eatCharacterEscape(r)||r.switchN&&this.regexp_eatKGroupName(r)?!0:(r.switchU&&(r.current()===99&&r.raise("Invalid unicode escape"),r.raise("Invalid escape")),!1)};At.regexp_eatBackReference=function(r){var t=r.pos;if(this.regexp_eatDecimalEscape(r)){var n=r.lastIntValue;if(r.switchU)return n>r.maxBackReference&&(r.maxBackReference=n),!0;if(n<=r.numCapturingParens)return!0;r.pos=t}return!1};At.regexp_eatKGroupName=function(r){if(r.eat(107)){if(this.regexp_eatGroupName(r))return r.backReferenceNames.push(r.lastStringValue),!0;r.raise("Invalid named reference")}return!1};At.regexp_eatCharacterEscape=function(r){return this.regexp_eatControlEscape(r)||this.regexp_eatCControlLetter(r)||this.regexp_eatZero(r)||this.regexp_eatHexEscapeSequence(r)||this.regexp_eatRegExpUnicodeEscapeSequence(r,!1)||!r.switchU&&this.regexp_eatLegacyOctalEscapeSequence(r)||this.regexp_eatIdentityEscape(r)};At.regexp_eatCControlLetter=function(r){var t=r.pos;if(r.eat(99)){if(this.regexp_eatControlLetter(r))return!0;r.pos=t}return!1};At.regexp_eatZero=function(r){return r.current()===48&&!cv(r.lookahead())?(r.lastIntValue=0,r.advance(),!0):!1};At.regexp_eatControlEscape=function(r){var t=r.current();return t===116?(r.lastIntValue=9,r.advance(),!0):t===110?(r.lastIntValue=10,r.advance(),!0):t===118?(r.lastIntValue=11,r.advance(),!0):t===102?(r.lastIntValue=12,r.advance(),!0):t===114?(r.lastIntValue=13,r.advance(),!0):!1};At.regexp_eatControlLetter=function(r){var t=r.current();return j9(t)?(r.lastIntValue=t%32,r.advance(),!0):!1};function j9(r){return r>=65&&r<=90||r>=97&&r<=122}At.regexp_eatRegExpUnicodeEscapeSequence=function(r,t){t===void 0&&(t=!1);var n=r.pos,s=t||r.switchU;if(r.eat(117)){if(this.regexp_eatFixedHexDigits(r,4)){var i=r.lastIntValue;if(s&&i>=55296&&i<=56319){var a=r.pos;if(r.eat(92)&&r.eat(117)&&this.regexp_eatFixedHexDigits(r,4)){var o=r.lastIntValue;if(o>=56320&&o<=57343)return r.lastIntValue=(i-55296)*1024+(o-56320)+65536,!0}r.pos=a,r.lastIntValue=i}return!0}if(s&&r.eat(123)&&this.regexp_eatHexDigits(r)&&r.eat(125)&&cte(r.lastIntValue))return!0;s&&r.raise("Invalid unicode escape"),r.pos=n}return!1};function cte(r){return r>=0&&r<=1114111}At.regexp_eatIdentityEscape=function(r){if(r.switchU)return this.regexp_eatSyntaxCharacter(r)?!0:r.eat(47)?(r.lastIntValue=47,!0):!1;var t=r.current();return t!==99&&(!r.switchN||t!==107)?(r.lastIntValue=t,r.advance(),!0):!1};At.regexp_eatDecimalEscape=function(r){r.lastIntValue=0;var t=r.current();if(t>=49&&t<=57){do r.lastIntValue=10*r.lastIntValue+(t-48),r.advance();while((t=r.current())>=48&&t<=57);return!0}return!1};var W9=0,Su=1,_a=2;At.regexp_eatCharacterClassEscape=function(r){var t=r.current();if(hte(t))return r.lastIntValue=-1,r.advance(),Su;var n=!1;if(r.switchU&&this.options.ecmaVersion>=9&&((n=t===80)||t===112)){r.lastIntValue=-1,r.advance();var s;if(r.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(r))&&r.eat(125))return n&&s===_a&&r.raise("Invalid property name"),s;r.raise("Invalid property name")}return W9};function hte(r){return r===100||r===68||r===115||r===83||r===119||r===87}At.regexp_eatUnicodePropertyValueExpression=function(r){var t=r.pos;if(this.regexp_eatUnicodePropertyName(r)&&r.eat(61)){var n=r.lastStringValue;if(this.regexp_eatUnicodePropertyValue(r)){var s=r.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(r,n,s),Su}}if(r.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(r)){var i=r.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(r,i)}return W9};At.regexp_validateUnicodePropertyNameAndValue=function(r,t,n){Ld(r.unicodeProperties.nonBinary,t)||r.raise("Invalid property name"),r.unicodeProperties.nonBinary[t].test(n)||r.raise("Invalid property value")};At.regexp_validateUnicodePropertyNameOrValue=function(r,t){if(r.unicodeProperties.binary.test(t))return Su;if(r.switchV&&r.unicodeProperties.binaryOfStrings.test(t))return _a;r.raise("Invalid property name")};At.regexp_eatUnicodePropertyName=function(r){var t=0;for(r.lastStringValue="";H9(t=r.current());)r.lastStringValue+=wu(t),r.advance();return r.lastStringValue!==""};function H9(r){return j9(r)||r===95}At.regexp_eatUnicodePropertyValue=function(r){var t=0;for(r.lastStringValue="";fte(t=r.current());)r.lastStringValue+=wu(t),r.advance();return r.lastStringValue!==""};function fte(r){return H9(r)||cv(r)}At.regexp_eatLoneUnicodePropertyNameOrValue=function(r){return this.regexp_eatUnicodePropertyValue(r)};At.regexp_eatCharacterClass=function(r){if(r.eat(91)){var t=r.eat(94),n=this.regexp_classContents(r);return r.eat(93)||r.raise("Unterminated character class"),t&&n===_a&&r.raise("Negated character class may contain strings"),!0}return!1};At.regexp_classContents=function(r){return r.current()===93?Su:r.switchV?this.regexp_classSetExpression(r):(this.regexp_nonEmptyClassRanges(r),Su)};At.regexp_nonEmptyClassRanges=function(r){for(;this.regexp_eatClassAtom(r);){var t=r.lastIntValue;if(r.eat(45)&&this.regexp_eatClassAtom(r)){var n=r.lastIntValue;r.switchU&&(t===-1||n===-1)&&r.raise("Invalid character class"),t!==-1&&n!==-1&&t>n&&r.raise("Range out of order in character class")}}};At.regexp_eatClassAtom=function(r){var t=r.pos;if(r.eat(92)){if(this.regexp_eatClassEscape(r))return!0;if(r.switchU){var n=r.current();(n===99||X9(n))&&r.raise("Invalid class escape"),r.raise("Invalid escape")}r.pos=t}var s=r.current();return s!==93?(r.lastIntValue=s,r.advance(),!0):!1};At.regexp_eatClassEscape=function(r){var t=r.pos;if(r.eat(98))return r.lastIntValue=8,!0;if(r.switchU&&r.eat(45))return r.lastIntValue=45,!0;if(!r.switchU&&r.eat(99)){if(this.regexp_eatClassControlLetter(r))return!0;r.pos=t}return this.regexp_eatCharacterClassEscape(r)||this.regexp_eatCharacterEscape(r)};At.regexp_classSetExpression=function(r){var t=Su,n;if(!this.regexp_eatClassSetRange(r))if(n=this.regexp_eatClassSetOperand(r)){n===_a&&(t=_a);for(var s=r.pos;r.eatChars([38,38]);){if(r.current()!==38&&(n=this.regexp_eatClassSetOperand(r))){n!==_a&&(t=Su);continue}r.raise("Invalid character in character class")}if(s!==r.pos)return t;for(;r.eatChars([45,45]);)this.regexp_eatClassSetOperand(r)||r.raise("Invalid character in character class");if(s!==r.pos)return t}else r.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(r)){if(n=this.regexp_eatClassSetOperand(r),!n)return t;n===_a&&(t=_a)}};At.regexp_eatClassSetRange=function(r){var t=r.pos;if(this.regexp_eatClassSetCharacter(r)){var n=r.lastIntValue;if(r.eat(45)&&this.regexp_eatClassSetCharacter(r)){var s=r.lastIntValue;return n!==-1&&s!==-1&&n>s&&r.raise("Range out of order in character class"),!0}r.pos=t}return!1};At.regexp_eatClassSetOperand=function(r){return this.regexp_eatClassSetCharacter(r)?Su:this.regexp_eatClassStringDisjunction(r)||this.regexp_eatNestedClass(r)};At.regexp_eatNestedClass=function(r){var t=r.pos;if(r.eat(91)){var n=r.eat(94),s=this.regexp_classContents(r);if(r.eat(93))return n&&s===_a&&r.raise("Negated character class may contain strings"),s;r.pos=t}if(r.eat(92)){var i=this.regexp_eatCharacterClassEscape(r);if(i)return i;r.pos=t}return null};At.regexp_eatClassStringDisjunction=function(r){var t=r.pos;if(r.eatChars([92,113])){if(r.eat(123)){var n=this.regexp_classStringDisjunctionContents(r);if(r.eat(125))return n}else r.raise("Invalid escape");r.pos=t}return null};At.regexp_classStringDisjunctionContents=function(r){for(var t=this.regexp_classString(r);r.eat(124);)this.regexp_classString(r)===_a&&(t=_a);return t};At.regexp_classString=function(r){for(var t=0;this.regexp_eatClassSetCharacter(r);)t++;return t===1?Su:_a};At.regexp_eatClassSetCharacter=function(r){var t=r.pos;if(r.eat(92))return this.regexp_eatCharacterEscape(r)||this.regexp_eatClassSetReservedPunctuator(r)?!0:r.eat(98)?(r.lastIntValue=8,!0):(r.pos=t,!1);var n=r.current();return n<0||n===r.lookahead()&&dte(n)||pte(n)?!1:(r.advance(),r.lastIntValue=n,!0)};function dte(r){return r===33||r>=35&&r<=38||r>=42&&r<=44||r===46||r>=58&&r<=64||r===94||r===96||r===126}function pte(r){return r===40||r===41||r===45||r===47||r>=91&&r<=93||r>=123&&r<=125}At.regexp_eatClassSetReservedPunctuator=function(r){var t=r.current();return mte(t)?(r.lastIntValue=t,r.advance(),!0):!1};function mte(r){return r===33||r===35||r===37||r===38||r===44||r===45||r>=58&&r<=62||r===64||r===96||r===126}At.regexp_eatClassControlLetter=function(r){var t=r.current();return cv(t)||t===95?(r.lastIntValue=t%32,r.advance(),!0):!1};At.regexp_eatHexEscapeSequence=function(r){var t=r.pos;if(r.eat(120)){if(this.regexp_eatFixedHexDigits(r,2))return!0;r.switchU&&r.raise("Invalid escape"),r.pos=t}return!1};At.regexp_eatDecimalDigits=function(r){var t=r.pos,n=0;for(r.lastIntValue=0;cv(n=r.current());)r.lastIntValue=10*r.lastIntValue+(n-48),r.advance();return r.pos!==t};function cv(r){return r>=48&&r<=57}At.regexp_eatHexDigits=function(r){var t=r.pos,n=0;for(r.lastIntValue=0;q9(n=r.current());)r.lastIntValue=16*r.lastIntValue+K9(n),r.advance();return r.pos!==t};function q9(r){return r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102}function K9(r){return r>=65&&r<=70?10+(r-65):r>=97&&r<=102?10+(r-97):r-48}At.regexp_eatLegacyOctalEscapeSequence=function(r){if(this.regexp_eatOctalDigit(r)){var t=r.lastIntValue;if(this.regexp_eatOctalDigit(r)){var n=r.lastIntValue;t<=3&&this.regexp_eatOctalDigit(r)?r.lastIntValue=t*64+n*8+r.lastIntValue:r.lastIntValue=t*8+n}else r.lastIntValue=t;return!0}return!1};At.regexp_eatOctalDigit=function(r){var t=r.current();return X9(t)?(r.lastIntValue=t-48,r.advance(),!0):(r.lastIntValue=0,!1)};function X9(r){return r>=48&&r<=55}At.regexp_eatFixedHexDigits=function(r,t){var n=r.pos;r.lastIntValue=0;for(var s=0;s<t;++s){var i=r.current();if(!q9(i))return r.pos=n,!1;r.lastIntValue=16*r.lastIntValue+K9(i),r.advance()}return!0};var RT=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new iv(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},En=ys.prototype;En.next=function(r){!r&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new RT(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};En.getToken=function(){return this.next(),new RT(this)};typeof Symbol<"u"&&(En[Symbol.iterator]=function(){var r=this;return{next:function(){var t=r.getToken();return{done:t.type===te.eof,value:t}}}});En.nextToken=function(){var r=this.curContext();if((!r||!r.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(te.eof);if(r.override)return r.override(this);this.readToken(this.fullCharCodeAtPos())};En.readToken=function(r){return vu(r,this.options.ecmaVersion>=6)||r===92?this.readWord():this.getTokenFromCode(r)};En.fullCharCodeAtPos=function(){var r=this.input.charCodeAt(this.pos);if(r<=55295||r>=56320)return r;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?r:(r<<10)+t-56613888};En.skipBlockComment=function(){var r=this.options.onComment&&this.curPosition(),t=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(n===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var s=void 0,i=t;(s=b9(this.input,i,this.pos))>-1;)++this.curLine,i=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,n),t,this.pos,r,this.curPosition())};En.skipLineComment=function(r){for(var t=this.pos,n=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=r);this.pos<this.input.length&&!Md(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+r,this.pos),t,this.pos,n,this.curPosition())};En.skipSpace=function(){e:for(;this.pos<this.input.length;){var r=this.input.charCodeAt(this.pos);switch(r){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(r>8&&r<14||r>=5760&&v9.test(String.fromCharCode(r)))++this.pos;else break e}}};En.finishToken=function(r,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=r,this.value=t,this.updateContext(n)};En.readToken_dot=function(){var r=this.input.charCodeAt(this.pos+1);if(r>=48&&r<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&r===46&&t===46?(this.pos+=3,this.finishToken(te.ellipsis)):(++this.pos,this.finishToken(te.dot))};En.readToken_slash=function(){var r=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):r===61?this.finishOp(te.assign,2):this.finishOp(te.slash,1)};En.readToken_mult_modulo_exp=function(r){var t=this.input.charCodeAt(this.pos+1),n=1,s=r===42?te.star:te.modulo;return this.options.ecmaVersion>=7&&r===42&&t===42&&(++n,s=te.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(te.assign,n+1):this.finishOp(s,n)};En.readToken_pipe_amp=function(r){var t=this.input.charCodeAt(this.pos+1);if(t===r){if(this.options.ecmaVersion>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(te.assign,3)}return this.finishOp(r===124?te.logicalOR:te.logicalAND,2)}return t===61?this.finishOp(te.assign,2):this.finishOp(r===124?te.bitwiseOR:te.bitwiseAND,1)};En.readToken_caret=function(){var r=this.input.charCodeAt(this.pos+1);return r===61?this.finishOp(te.assign,2):this.finishOp(te.bitwiseXOR,1)};En.readToken_plus_min=function(r){var t=this.input.charCodeAt(this.pos+1);return t===r?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||$a.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(te.incDec,2):t===61?this.finishOp(te.assign,2):this.finishOp(te.plusMin,1)};En.readToken_lt_gt=function(r){var t=this.input.charCodeAt(this.pos+1),n=1;return t===r?(n=r===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+n)===61?this.finishOp(te.assign,n+1):this.finishOp(te.bitShift,n)):t===33&&r===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(n=2),this.finishOp(te.relational,n))};En.readToken_eq_excl=function(r){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(te.equality,this.input.charCodeAt(this.pos+2)===61?3:2):r===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(te.arrow)):this.finishOp(r===61?te.eq:te.prefix,1)};En.readToken_question=function(){var r=this.options.ecmaVersion;if(r>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(te.questionDot,2)}if(t===63){if(r>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(te.assign,3)}return this.finishOp(te.coalesce,2)}}return this.finishOp(te.question,1)};En.readToken_numberSign=function(){var r=this.options.ecmaVersion,t=35;if(r>=13&&(++this.pos,t=this.fullCharCodeAtPos(),vu(t,!0)||t===92))return this.finishToken(te.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+wu(t)+"'")};En.getTokenFromCode=function(r){switch(r){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(te.parenL);case 41:return++this.pos,this.finishToken(te.parenR);case 59:return++this.pos,this.finishToken(te.semi);case 44:return++this.pos,this.finishToken(te.comma);case 91:return++this.pos,this.finishToken(te.bracketL);case 93:return++this.pos,this.finishToken(te.bracketR);case 123:return++this.pos,this.finishToken(te.braceL);case 125:return++this.pos,this.finishToken(te.braceR);case 58:return++this.pos,this.finishToken(te.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(te.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(r);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(r);case 124:case 38:return this.readToken_pipe_amp(r);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(r);case 60:case 62:return this.readToken_lt_gt(r);case 61:case 33:return this.readToken_eq_excl(r);case 63:return this.readToken_question();case 126:return this.finishOp(te.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+wu(r)+"'")};En.finishOp=function(r,t){var n=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(r,n)};En.readRegexp=function(){for(var r,t,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var s=this.input.charAt(this.pos);if($a.test(s)&&this.raise(n,"Unterminated regular expression"),r)r=!1;else{if(s==="[")t=!0;else if(s==="]"&&t)t=!1;else if(s==="/"&&!t)break;r=s==="\\"}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var a=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(a);var u=this.regexpState||(this.regexpState=new zo(this));u.reset(n,i,o),this.validateRegExpFlags(u),this.validateRegExpPattern(u);var l=null;try{l=new RegExp(i,o)}catch{}return this.finishToken(te.regexp,{pattern:i,flags:o,value:l})};En.readInt=function(r,t,n){for(var s=this.options.ecmaVersion>=12&&t===void 0,i=n&&this.input.charCodeAt(this.pos)===48,a=this.pos,o=0,u=0,l=0,c=t??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),f=void 0;if(s&&h===95){i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),u===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),u=h;continue}if(h>=97?f=h-97+10:h>=65?f=h-65+10:h>=48&&h<=57?f=h-48:f=1/0,f>=r)break;u=h,o=o*r+f}return s&&u===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===a||t!=null&&this.pos-a!==t?null:o};function gte(r,t){return t?parseInt(r,8):parseFloat(r.replace(/_/g,""))}function Y9(r){return typeof BigInt!="function"?null:BigInt(r.replace(/_/g,""))}En.readRadixNumber=function(r){var t=this.pos;this.pos+=2;var n=this.readInt(r);return n==null&&this.raise(this.start+2,"Expected number in radix "+r),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(n=Y9(this.input.slice(t,this.pos)),++this.pos):vu(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(te.num,n)};En.readNumber=function(r){var t=this.pos;!r&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var n=this.pos-t>=2&&this.input.charCodeAt(t)===48;n&&this.strict&&this.raise(t,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!n&&!r&&this.options.ecmaVersion>=11&&s===110){var i=Y9(this.input.slice(t,this.pos));return++this.pos,vu(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(te.num,i)}n&&/[89]/.test(this.input.slice(t,this.pos))&&(n=!1),s===46&&!n&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!n&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),vu(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var a=gte(this.input.slice(t,this.pos),n);return this.finishToken(te.num,a)};En.readCodePoint=function(){var r=this.input.charCodeAt(this.pos),t;if(r===123){this.options.ecmaVersion<6&&this.unexpected();var n=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(n,"Code point out of bounds")}else t=this.readHexChar(4);return t};En.readString=function(r){for(var t="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===r)break;s===92?(t+=this.input.slice(n,this.pos),t+=this.readEscapedChar(!1),n=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Md(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(n,this.pos++),this.finishToken(te.string,t)};var Z9={};En.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(r){if(r===Z9)this.readInvalidTemplateToken();else throw r}this.inTemplateElement=!1};En.invalidStringToken=function(r,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Z9;this.raise(r,t)};En.readTmplToken=function(){for(var r="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(n===96||n===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===te.template||this.type===te.invalidTemplate)?n===36?(this.pos+=2,this.finishToken(te.dollarBraceL)):(++this.pos,this.finishToken(te.backQuote)):(r+=this.input.slice(t,this.pos),this.finishToken(te.template,r));if(n===92)r+=this.input.slice(t,this.pos),r+=this.readEscapedChar(!0),t=this.pos;else if(Md(n)){switch(r+=this.input.slice(t,this.pos),++this.pos,n){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:r+=`
`;break;default:r+=String.fromCharCode(n);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};En.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(te.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};En.readEscapedChar=function(r){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return wu(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),r){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(s,8);return i>255&&(s=s.slice(0,-1),i=parseInt(s,8)),this.pos+=s.length-1,t=this.input.charCodeAt(this.pos),(s!=="0"||t===56||t===57)&&(this.strict||r)&&this.invalidStringToken(this.pos-1-s.length,r?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return Md(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};En.readHexChar=function(r){var t=this.pos,n=this.readInt(16,r);return n===null&&this.invalidStringToken(t,"Bad character escape sequence"),n};En.readWord1=function(){this.containsEsc=!1;for(var r="",t=!0,n=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(md(i,s))this.pos+=i<=65535?1:2;else if(i===92){this.containsEsc=!0,r+=this.input.slice(n,this.pos);var a=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?vu:md)(o,s)||this.invalidStringToken(a,"Invalid Unicode escape"),r+=wu(o),n=this.pos}else break;t=!1}return r+this.input.slice(n,this.pos)};En.readWord=function(){var r=this.readWord1(),t=te.name;return this.keywords.test(r)&&(t=NT[r]),this.finishToken(t,r)};var yte="8.14.1";ys.acorn={Parser:ys,version:yte,defaultOptions:hE,Position:ig,SourceLocation:iv,getLineInfo:S9,Node:lv,TokenType:$n,tokTypes:te,keywordTypes:NT,TokContext:za,tokContexts:_r,isIdentifierChar:md,isIdentifierStart:vu,Token:RT,isNewLine:Md,lineBreak:$a,lineBreakG:Pee,nonASCIIwhitespace:v9};function Q9(r,t){return ys.parse(r,t)}function xte(r,t,n,s,i){n||(n=yt),function a(o,u,l){var c=l||o.type;n[c](o,u,a),t[c]&&t[c](o,u)}(r,s,i)}function bte(r,t,n,s,i){var a=[];n||(n=yt),function o(u,l,c){var h=c||u.type,f=u!==a[a.length-1];f&&a.push(u),n[h](u,l,o),t[h]&&t[h](u,l||a,a),f&&a.pop()}(r,s,i)}function OT(r,t,n){n(r,t)}function Sh(r,t,n){}var yt={};yt.Program=yt.BlockStatement=yt.StaticBlock=function(r,t,n){for(var s=0,i=r.body;s<i.length;s+=1){var a=i[s];n(a,t,"Statement")}};yt.Statement=OT;yt.EmptyStatement=Sh;yt.ExpressionStatement=yt.ParenthesizedExpression=yt.ChainExpression=function(r,t,n){return n(r.expression,t,"Expression")};yt.IfStatement=function(r,t,n){n(r.test,t,"Expression"),n(r.consequent,t,"Statement"),r.alternate&&n(r.alternate,t,"Statement")};yt.LabeledStatement=function(r,t,n){return n(r.body,t,"Statement")};yt.BreakStatement=yt.ContinueStatement=Sh;yt.WithStatement=function(r,t,n){n(r.object,t,"Expression"),n(r.body,t,"Statement")};yt.SwitchStatement=function(r,t,n){n(r.discriminant,t,"Expression");for(var s=0,i=r.cases;s<i.length;s+=1){var a=i[s];n(a,t)}};yt.SwitchCase=function(r,t,n){r.test&&n(r.test,t,"Expression");for(var s=0,i=r.consequent;s<i.length;s+=1){var a=i[s];n(a,t,"Statement")}};yt.ReturnStatement=yt.YieldExpression=yt.AwaitExpression=function(r,t,n){r.argument&&n(r.argument,t,"Expression")};yt.ThrowStatement=yt.SpreadElement=function(r,t,n){return n(r.argument,t,"Expression")};yt.TryStatement=function(r,t,n){n(r.block,t,"Statement"),r.handler&&n(r.handler,t),r.finalizer&&n(r.finalizer,t,"Statement")};yt.CatchClause=function(r,t,n){r.param&&n(r.param,t,"Pattern"),n(r.body,t,"Statement")};yt.WhileStatement=yt.DoWhileStatement=function(r,t,n){n(r.test,t,"Expression"),n(r.body,t,"Statement")};yt.ForStatement=function(r,t,n){r.init&&n(r.init,t,"ForInit"),r.test&&n(r.test,t,"Expression"),r.update&&n(r.update,t,"Expression"),n(r.body,t,"Statement")};yt.ForInStatement=yt.ForOfStatement=function(r,t,n){n(r.left,t,"ForInit"),n(r.right,t,"Expression"),n(r.body,t,"Statement")};yt.ForInit=function(r,t,n){r.type==="VariableDeclaration"?n(r,t):n(r,t,"Expression")};yt.DebuggerStatement=Sh;yt.FunctionDeclaration=function(r,t,n){return n(r,t,"Function")};yt.VariableDeclaration=function(r,t,n){for(var s=0,i=r.declarations;s<i.length;s+=1){var a=i[s];n(a,t)}};yt.VariableDeclarator=function(r,t,n){n(r.id,t,"Pattern"),r.init&&n(r.init,t,"Expression")};yt.Function=function(r,t,n){r.id&&n(r.id,t,"Pattern");for(var s=0,i=r.params;s<i.length;s+=1){var a=i[s];n(a,t,"Pattern")}n(r.body,t,r.expression?"Expression":"Statement")};yt.Pattern=function(r,t,n){r.type==="Identifier"?n(r,t,"VariablePattern"):r.type==="MemberExpression"?n(r,t,"MemberPattern"):n(r,t)};yt.VariablePattern=Sh;yt.MemberPattern=OT;yt.RestElement=function(r,t,n){return n(r.argument,t,"Pattern")};yt.ArrayPattern=function(r,t,n){for(var s=0,i=r.elements;s<i.length;s+=1){var a=i[s];a&&n(a,t,"Pattern")}};yt.ObjectPattern=function(r,t,n){for(var s=0,i=r.properties;s<i.length;s+=1){var a=i[s];a.type==="Property"?(a.computed&&n(a.key,t,"Expression"),n(a.value,t,"Pattern")):a.type==="RestElement"&&n(a.argument,t,"Pattern")}};yt.Expression=OT;yt.ThisExpression=yt.Super=yt.MetaProperty=Sh;yt.ArrayExpression=function(r,t,n){for(var s=0,i=r.elements;s<i.length;s+=1){var a=i[s];a&&n(a,t,"Expression")}};yt.ObjectExpression=function(r,t,n){for(var s=0,i=r.properties;s<i.length;s+=1){var a=i[s];n(a,t)}};yt.FunctionExpression=yt.ArrowFunctionExpression=yt.FunctionDeclaration;yt.SequenceExpression=function(r,t,n){for(var s=0,i=r.expressions;s<i.length;s+=1){var a=i[s];n(a,t,"Expression")}};yt.TemplateLiteral=function(r,t,n){for(var s=0,i=r.quasis;s<i.length;s+=1){var a=i[s];n(a,t)}for(var o=0,u=r.expressions;o<u.length;o+=1){var l=u[o];n(l,t,"Expression")}};yt.TemplateElement=Sh;yt.UnaryExpression=yt.UpdateExpression=function(r,t,n){n(r.argument,t,"Expression")};yt.BinaryExpression=yt.LogicalExpression=function(r,t,n){n(r.left,t,"Expression"),n(r.right,t,"Expression")};yt.AssignmentExpression=yt.AssignmentPattern=function(r,t,n){n(r.left,t,"Pattern"),n(r.right,t,"Expression")};yt.ConditionalExpression=function(r,t,n){n(r.test,t,"Expression"),n(r.consequent,t,"Expression"),n(r.alternate,t,"Expression")};yt.NewExpression=yt.CallExpression=function(r,t,n){if(n(r.callee,t,"Expression"),r.arguments)for(var s=0,i=r.arguments;s<i.length;s+=1){var a=i[s];n(a,t,"Expression")}};yt.MemberExpression=function(r,t,n){n(r.object,t,"Expression"),r.computed&&n(r.property,t,"Expression")};yt.ExportNamedDeclaration=yt.ExportDefaultDeclaration=function(r,t,n){r.declaration&&n(r.declaration,t,r.type==="ExportNamedDeclaration"||r.declaration.id?"Statement":"Expression"),r.source&&n(r.source,t,"Expression")};yt.ExportAllDeclaration=function(r,t,n){r.exported&&n(r.exported,t),n(r.source,t,"Expression")};yt.ImportDeclaration=function(r,t,n){for(var s=0,i=r.specifiers;s<i.length;s+=1){var a=i[s];n(a,t)}n(r.source,t,"Expression")};yt.ImportExpression=function(r,t,n){n(r.source,t,"Expression")};yt.ImportSpecifier=yt.ImportDefaultSpecifier=yt.ImportNamespaceSpecifier=yt.Identifier=yt.PrivateIdentifier=yt.Literal=Sh;yt.TaggedTemplateExpression=function(r,t,n){n(r.tag,t,"Expression"),n(r.quasi,t,"Expression")};yt.ClassDeclaration=yt.ClassExpression=function(r,t,n){return n(r,t,"Class")};yt.Class=function(r,t,n){r.id&&n(r.id,t,"Pattern"),r.superClass&&n(r.superClass,t,"Expression"),n(r.body,t)};yt.ClassBody=function(r,t,n){for(var s=0,i=r.body;s<i.length;s+=1){var a=i[s];n(a,t)}};yt.MethodDefinition=yt.PropertyDefinition=yt.Property=function(r,t,n){r.computed&&n(r.key,t,"Expression"),r.value&&n(r.value,t,"Expression")};const vte=["setup","draw","preload","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized"],ym={fetchScript:async function(r){if(r.src)try{return await fetch(r.src).then(n=>n.text())}catch(t){return console.error("Error fetching script:",t),""}else return r.textContent},extractUserDefinedVariablesAndFuncs:function(r){const t={variables:[],functions:[]},n=-1;try{const s=Q9(r,{ecmaVersion:2021,sourceType:"module",locations:!0});xte(s,{VariableDeclarator(i){if(i.id.type==="Identifier"){const a=i.init&&["ArrowFunctionExpression","FunctionExpression"].includes(i.init.type)?"functions":"variables";t[a].push({name:i.id.name,line:i.loc.start.line+n})}},FunctionDeclaration(i){i.id&&i.id.type==="Identifier"&&t.functions.push({name:i.id.name,line:i.loc.start.line+n})},ClassDeclaration(i){i.id&&i.id.type==="Identifier"&&t.variables.push({name:i.id.name,line:i.loc.start.line+n})}})}catch(s){console.error("Error parsing code:",s)}return t},checkForConstsAndFuncs:function(r,t){const n=[...r.variables,...r.functions];function s(a,o,u){const l=`https://p5js.org/reference/p5/${o}`;return`${a} "${o}" on line ${u} is being redeclared and conflicts with a p5.js ${a.toLowerCase()}. p5.js reference: ${l}`}for(let{name:a,line:o}of n)if(qc[a]!==void 0){const l=s("Constant",a,o);return console.log(l),!0}const i=new Set(Object.getOwnPropertyNames(t.prototype).filter(a=>!a.startsWith("_")&&a!=="constructor"));for(let{name:a,line:o}of n)if(!vte.includes(a)&&i.has(a)){const u=s("Function",a,o);return console.log(u),!0}return!1},getUserCode:async function(){const r=document.querySelectorAll("script"),t=r[r.length-1];return await ym.fetchScript(t)},runFES:async function(r){const t=await ym.getUserCode(),n=ym.extractUserDefinedVariablesAndFuncs(t);ym.checkForConstsAndFuncs(n,r)}};function J9(r,t,n){n.presetup=async function(){r.disableFriendlyErrors||ym.runFES(r)}}typeof p5<"u"&&J9(p5,p5.prototype);function eB(r,t){const n=(s,i)=>{const a=Jt("fes.fileLoadError.suggestion",{filePath:i,url:"https://github.com/processing/p5.js/wiki/Local-server"});switch(s){case 0:return{message:Jt("fes.fileLoadError.image",{suggestion:a}),method:"loadImage"};case 1:return{message:Jt("fes.fileLoadError.xml",{suggestion:a}),method:"loadXML"};case 2:return{message:Jt("fes.fileLoadError.table",{suggestion:a}),method:"loadTable"};case 3:return{message:Jt("fes.fileLoadError.strings",{suggestion:a}),method:"loadStrings"};case 4:return{message:Jt("fes.fileLoadError.font",{suggestion:a}),method:"loadFont"};case 5:return{message:Jt("fes.fileLoadError.json",{suggestion:a}),method:"loadJSON"};case 6:return{message:Jt("fes.fileLoadError.bytes",{suggestion:a}),method:"loadBytes"};case 7:return{message:Jt("fes.fileLoadError.large"),method:"loadX"};case 8:return{message:Jt("fes.fileLoadError.gif"),method:"loadImage"}}};r._friendlyFileLoadError=function(s,i){const{message:a,method:o}=n(s,i);r._friendlyError(a,o,3)}}typeof p5<"u"&&eB(p5,p5.prototype);function wte(r){r.registerAddon(l9),r.registerAddon(c9),r.registerAddon(g9),r.registerAddon(J9),r.registerAddon(eB)}function tB(r,t){t.storeItem=function(n,s){typeof n!="string"&&console.log(`The argument that you passed to storeItem() - ${n} is not a string.`),n.endsWith("p5TypeID")&&console.log(`The argument that you passed to storeItem() - ${n} must not end with 'p5TypeID'.`),typeof s>"u"&&console.log("You cannot store undefined variables using storeItem().");let i=typeof s;switch(i){case"number":case"boolean":s=s.toString();break;case"object":s instanceof r.Color?(i="p5.Color",s=s.toString()):s instanceof r.Vector&&(i="p5.Vector",s=[s.x,s.y,s.z]),s=JSON.stringify(s);break}localStorage.setItem(n,s);const a=`${n}p5TypeID`;localStorage.setItem(a,i)},t.getItem=function(n){let s=localStorage.getItem(n);const i=localStorage.getItem(`${n}p5TypeID`);if(typeof i>"u")console.log(`Unable to determine type of item stored under ${n}in local storage. Did you save the item with something other than setItem()?`);else if(s!==null)switch(i){case"number":s=parseFloat(s);break;case"boolean":s=s==="true";break;case"object":s=JSON.parse(s);break;case"p5.Color":s=this.color(JSON.parse(s));break;case"p5.Vector":s=JSON.parse(s),s=this.createVector(...s);break}return s},t.clearStorage=function(){Object.keys(localStorage).forEach(s=>{s.endsWith("p5TypeID")&&this.removeItem(s.replace("p5TypeID",""))})},t.removeItem=function(n){typeof n!="string"&&console.log(`The argument that you passed to removeItem() - ${n} is not a string.`),localStorage.removeItem(n),localStorage.removeItem(`${n}p5TypeID`)}}typeof p5<"u"&&tB(p5,p5.prototype);function Ste(r){r.registerAddon(tB)}function nB(r,t){t.select=function(i,a){const u=this._getContainer(a).querySelector(i);return u?this._wrapElement(u):null},t.selectAll=function(i,a){const o=[],l=this._getContainer(a).querySelectorAll(i);if(l)for(let c=0;c<l.length;c++){const h=this._wrapElement(l[c]);o.push(h)}return o},t._getContainer=function(i){let a=document;return typeof i=="string"?a=document.querySelector(i)||document:i instanceof vn?a=i.elt:i instanceof HTMLElement&&(a=i),a},t._wrapElement=function(i){const a=Array.prototype.slice.call(i.children);if(i.tagName==="INPUT"&&i.type==="checkbox"){let o=new vn(i,this);return o.checked=function(...u){return u.length===0?this.elt.checked:(u[0]?this.elt.checked=!0:this.elt.checked=!1,this)},o}else return i.tagName==="VIDEO"||i.tagName==="AUDIO"?new Ym(i,this):i.tagName==="SELECT"?this.createSelect(new vn(i,this)):a.length>0&&a.every(function(o){return o.tagName==="INPUT"||o.tagName==="LABEL"})&&(i.tagName==="DIV"||i.tagName==="SPAN")?this.createRadio(new vn(i,this)):new vn(i,this)},t.createElement=function(i,a){const o=document.createElement(i);return typeof a<"u"&&(o.innerHTML=a),n(o,this)},t.removeElements=function(i){const a=u=>!(u.elt instanceof HTMLCanvasElement);this._elements.filter(a).map(u=>u.remove())};function n(i,a,o){(a._userNode?a._userNode:document.body).appendChild(i);const l=o?new Ym(i,a):new vn(i,a);return a._elements.push(l),l}t.createDiv=function(i=""){let a=document.createElement("div");return a.innerHTML=i,n(a,this)},t.createP=function(i=""){let a=document.createElement("p");return a.innerHTML=i,n(a,this)},t.createSpan=function(i=""){let a=document.createElement("span");return a.innerHTML=i,n(a,this)},t.createImg=function(){const i=document.createElement("img"),a=arguments;let o;return a.length>1&&typeof a[1]=="string"&&(i.alt=a[1]),a.length>2&&typeof a[2]=="string"&&(i.crossOrigin=a[2]),i.src=a[0],o=n(i,this),i.addEventListener("load",function(){o.width=i.offsetWidth||i.width,o.height=i.offsetHeight||i.height;const u=a[a.length-1];typeof u=="function"&&u(o)}),o},t.createA=function(i,a,o){const u=document.createElement("a");return u.href=i,u.innerHTML=a,o&&(u.target=o),n(u,this)},t.createSlider=function(i,a,o,u){const l=document.createElement("input");return l.type="range",l.min=i,l.max=a,u===0?l.step=1e-18:u&&(l.step=u),typeof o=="number"&&(l.value=o),n(l,this)},t.createButton=function(i,a){const o=document.createElement("button");return o.innerHTML=i,a&&(o.value=a),n(o,this)},t.createCheckbox=function(...i){const a=document.createElement("div"),o=document.createElement("input");o.type="checkbox";const u=document.createElement("label");u.appendChild(o),a.appendChild(u);const l=n(a,this);if(l.checked=function(...c){const h=l.elt.firstElementChild.getElementsByTagName("input")[0];if(h){if(c.length===0)return h.checked;c[0]?h.checked=!0:h.checked=!1}return l},this.value=function(c){return l.value=c,this},i[0]){l.value(i[0]);const c=document.createElement("span");c.innerHTML=i[0],u.appendChild(c)}return i[1]&&(o.checked=!0),l},t.createSelect=function(...i){let a,o=i[0];if(o instanceof vn&&o.elt instanceof HTMLSelectElement)a=o,this.elt=o.elt;else if(o instanceof HTMLSelectElement)a=n(o,this),this.elt=o;else{const u=document.createElement("select");o&&typeof o=="boolean"&&u.setAttribute("multiple","true"),a=n(u,this),this.elt=u}return a.option=function(u,l){let c;if(u!==void 0){for(let h=0;h<this.elt.length;h+=1)if(this.elt[h].textContent===u){c=h;break}if(c!==void 0)l===!1?this.elt.remove(c):this.elt[c].value=l;else{const h=document.createElement("option");h.textContent=u,h.value=l===void 0?u:l,this.elt.appendChild(h),this._pInst._elements.push(h)}}},a.selected=function(u){if(u!==void 0){for(let l=0;l<this.elt.length;l+=1)this.elt[l].value.toString()===u.toString()&&(this.elt.selectedIndex=l);return this}else if(this.elt.getAttribute("multiple")){let l=[];for(const c of this.elt.selectedOptions)l.push(c.value);return l}else return this.elt.value},a.disable=function(u){if(typeof u=="string")for(let l=0;l<this.elt.length;l++)this.elt[l].value.toString()===u&&(this.elt[l].disabled=!0,this.elt[l].selected=!1);else this.elt.disabled=!0;return this},a.enable=function(u){if(typeof u=="string")for(let l=0;l<this.elt.length;l++)this.elt[l].value.toString()===u&&(this.elt[l].disabled=!1,this.elt[l].selected=!1);else{this.elt.disabled=!1;for(let l=0;l<this.elt.length;l++)this.elt[l].disabled=!1,this.elt[l].selected=!1}return this},a};let s=0;t.createRadio=function(...i){let a,o,u;const l=i[0];l instanceof vn&&(l.elt instanceof HTMLDivElement||l.elt instanceof HTMLSpanElement)?(a=l,this.elt=l.elt):l instanceof HTMLDivElement||l instanceof HTMLSpanElement?(a=n(l,this),this.elt=l,o=l,typeof i[1]=="string"&&(u=i[1])):(typeof l=="string"&&(u=l),o=document.createElement("div"),a=n(o,this),this.elt=o),a._name=u||`radioOption_${s++}`;const c=p=>p instanceof HTMLInputElement&&p.type==="radio",h=p=>p instanceof HTMLLabelElement,f=p=>p instanceof HTMLSpanElement;return a._getOptionsArray=function(){return Array.from(this.elt.children).filter(p=>c(p)||h(p)&&c(p.firstElementChild)).map(p=>c(p)?p:p.firstElementChild)},a.option=function(p,g){let y;for(const S of a._getOptionsArray())if(S.value===p){y=S;break}y===void 0&&(y=document.createElement("input"),y.setAttribute("type","radio"),y.setAttribute("value",p)),y.setAttribute("name",a._name);let x;h(y.parentElement)?x=y.parentElement:(x=document.createElement("label"),x.insertAdjacentElement("afterbegin",y));let v;return f(x.lastElementChild)?v=x.lastElementChild:(v=document.createElement("span"),y.insertAdjacentElement("afterend",v)),v.innerHTML=g===void 0?p:g,this.elt.appendChild(x),y},a.remove=function(p){for(const g of a._getOptionsArray())if(g.value===p){h(g.parentElement)?g.parentElement.remove():g.remove();return}},a.value=function(){let p="";for(const g of a._getOptionsArray())if(g.checked){p=g.value;break}return p},a.selected=function(p){let g=null;if(p===void 0){for(const y of a._getOptionsArray())if(y.checked){g=y;break}}else{a._getOptionsArray().forEach(y=>{y.checked=!1,y.removeAttribute("checked")});for(const y of a._getOptionsArray())y.value===p&&(y.setAttribute("checked",!0),y.checked=!0,g=y)}return g},a.disable=function(p=!0){for(const g of a._getOptionsArray())g.setAttribute("disabled",p)},a},t.createColorPicker=function(i){const a=document.createElement("input");let o;a.type="color",i?i instanceof r.Color?a.value=i.toString("#rrggbb"):(this.push(),this.colorMode("rgb"),a.value=this.color(i).toString("#rrggbb"),this.pop()):a.value="#000000",o=n(a,this);const u=this;return o.color=function(){u.push(),i&&i.mode&&u.colorMode(i.mode,...i!=null&&i.maxes?i.maxes[i.mode]||[]:[]);const l=u.color(this.elt.value);return u.pop(),l},o},t.createInput=function(i="",a="text"){let o=document.createElement("input");return o.setAttribute("value",i),o.setAttribute("type",a),n(o,this)},t.createFileInput=function(i,a=!1){const o=function(l){for(const c of l.target.files)fl._load(c,i)};if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){console.log("The File APIs are not fully supported in this browser. Cannot create element.");return}const u=document.createElement("input");return u.setAttribute("type","file"),a&&u.setAttribute("multiple",!0),u.addEventListener("change",o,!1),n(u,this)}}typeof p5<"u"&&nB(p5,p5.prototype);function Cte(r){r.registerAddon(nB),r.registerAddon(G6),r.registerAddon(l8),r.registerAddon(U6)}function rB(r,t){t.deviceOrientation=window.innerWidth/window.innerHeight>1?"landscape":"portrait",t.accelerationX=0,t.accelerationY=0,t.accelerationZ=0,t.pAccelerationX=0,t.pAccelerationY=0,t.pAccelerationZ=0,t._updatePAccelerations=function(){this.pAccelerationX=this.accelerationX,this.pAccelerationY=this.accelerationY,this.pAccelerationZ=this.accelerationZ},t.rotationX=0,t.rotationY=0,t.rotationZ=0,t.pRotationX=0,t.pRotationY=0,t.pRotationZ=0;let n=0,s=0,i=0,a="clockwise",o="clockwise",u="clockwise";t.pRotateDirectionX=void 0,t.pRotateDirectionY=void 0,t.pRotateDirectionZ=void 0,t._updatePRotations=function(){this.pRotationX=this.rotationX,this.pRotationY=this.rotationY,this.pRotationZ=this.rotationZ},t.turnAxis=void 0;let l=.5,c=30;t.setMoveThreshold=function(h){l=h},t.setShakeThreshold=function(h){c=h},t._ondeviceorientation=function(h){this._updatePRotations(),this.rotationX=this._fromDegrees(h.beta),this.rotationY=this._fromDegrees(h.gamma),this.rotationZ=this._fromDegrees(h.alpha),this._handleMotion()},t._ondevicemotion=function(h){this._updatePAccelerations(),this.accelerationX=h.acceleration.x*2,this.accelerationY=h.acceleration.y*2,this.accelerationZ=h.acceleration.z*2,this._handleMotion()},t._handleMotion=function(){window.orientation===90||window.orientation===-90?this.deviceOrientation="landscape":window.orientation===0?this.deviceOrientation="portrait":window.orientation===void 0&&(this.deviceOrientation="undefined");const h=this._isGlobal?window:this;if(typeof h.deviceMoved=="function"&&(Math.abs(this.accelerationX-this.pAccelerationX)>l||Math.abs(this.accelerationY-this.pAccelerationY)>l||Math.abs(this.accelerationZ-this.pAccelerationZ)>l)&&h.deviceMoved(),typeof h.deviceTurned=="function"){const f=this._toDegrees(this.rotationX)+180,p=this._toDegrees(this.pRotationX)+180;let g=n+180;f-p>0&&f-p<270||f-p<-270?a="clockwise":(f-p<0||f-p>270)&&(a="counter-clockwise"),a!==this.pRotateDirectionX&&(g=f),Math.abs(f-g)>90&&Math.abs(f-g)<270&&(g=f,this.turnAxis="X",h.deviceTurned()),this.pRotateDirectionX=a,n=g-180;const y=this._toDegrees(this.rotationY)+180,x=this._toDegrees(this.pRotationY)+180;let v=s+180;y-x>0&&y-x<270||y-x<-270?o="clockwise":(y-x<0||y-this.pRotationY>270)&&(o="counter-clockwise"),o!==this.pRotateDirectionY&&(v=y),Math.abs(y-v)>90&&Math.abs(y-v)<270&&(v=y,this.turnAxis="Y",h.deviceTurned()),this.pRotateDirectionY=o,s=v-180;const S=this._toDegrees(this.rotationZ),w=this._toDegrees(this.pRotationZ);S-w>0&&S-w<270||S-w<-270?u="clockwise":(S-w<0||S-w>270)&&(u="counter-clockwise"),u!==this.pRotateDirectionZ&&(i=S),Math.abs(S-i)>90&&Math.abs(S-i)<270&&(i=S,this.turnAxis="Z",h.deviceTurned()),this.pRotateDirectionZ=u,this.turnAxis=void 0}if(typeof h.deviceShaken=="function"){let f,p;this.pAccelerationX!==null&&(f=Math.abs(this.accelerationX-this.pAccelerationX),p=Math.abs(this.accelerationY-this.pAccelerationY)),f+p>c&&h.deviceShaken()}}}typeof p5<"u"&&rB(p5,p5.prototype);function _te(r){return["Alt","Shift","Control","Meta"].includes(r)||typeof r!="string"?!1:r.length>1}function sB(r,t){t.keyIsPressed=!1,t.code=null,t.key="",t.keyCode=0,t._onkeydown=function(n){if(this._downKeys[n.code])return;this.keyIsPressed=!0,this.keyCode=n.which,this.key=n.key,this.code=n.code,this._downKeyCodes[n.code]=!0,this._downKeys[n.key]=!0;const s=this._isGlobal?window:this;typeof s.keyPressed=="function"&&!n.charCode&&s.keyPressed(n)===!1&&n.preventDefault()},t._onkeyup=function(n){const s=this._isGlobal?window:this;if(typeof s.keyReleased=="function"&&s.keyReleased(n)===!1&&n.preventDefault(),delete this._downKeyCodes[n.code],delete this._downKeys[n.key],!this._areDownKeys())this.keyIsPressed=!1,this.key="",this.code=null;else{const i=Object.keys(this._downKeyCodes).pop();this.code=i;const a=Object.keys(this._downKeys).pop();this.key=a}},t._onkeypress=function(n){if(n.which===this._lastKeyCodeTyped&&n.repeat)return;this._lastKeyCodeTyped=n.which,this.key=n.key||String.fromCharCode(n.which)||n.which;const s=this._isGlobal?window:this;typeof s.keyTyped=="function"&&s.keyTyped(n)===!1&&n.preventDefault()},t._onblur=function(n){this._downKeys={}},t.keyIsDown=function(n){return _te(n)?this._downKeyCodes[n]||this._downKeys[n]||!1:this._downKeys[n]||this._downKeyCodes[n]||!1},t._areDownKeys=function(){for(const n in this._downKeys)if(this._downKeys.hasOwnProperty(n)&&this._downKeys[n]===!0)return!0;return!1}}typeof p5<"u"&&sB(p5,p5.prototype);function iB(r,t){t.movedX=0,t.movedY=0,t._hasMouseInteracted=!1,t.mouseX=0,t.mouseY=0,t.pmouseX=0,t.pmouseY=0,t.winMouseX=0,t.winMouseY=0,t.pwinMouseX=0,t.pwinMouseY=0,t.mouseButton={left:!1,right:!1,center:!1},t.touches=[],t._activePointers=new Map,t.mouseIsPressed=!1,t._updatePointerCoords=function(i){if(this._curElement!==null){const a=this._curElement.elt,o=a.scrollWidth/this.width||1,u=a.scrollHeight/this.height||1;if(i.pointerType=="touch"){const c=[];for(const h of this._activePointers.values())c.push(s(a,o,u,h));this.touches=c}const l=n(a,o,u,i);this.movedX=i.movementX||0,this.movedY=i.movementY||0,this.mouseX=l.x,this.mouseY=l.y,this.winMouseX=l.winX,this.winMouseY=l.winY,this._hasMouseInteracted||(this._updateMouseCoords(),this._hasMouseInteracted=!0)}},t._updateMouseCoords=function(){this.pmouseX=this.mouseX,this.pmouseY=this.mouseY,this.pwinMouseX=this.winMouseX,this.pwinMouseY=this.winMouseY,this._pmouseWheelDeltaY=this._mouseWheelDeltaY};function n(i,a,o,u){const l=i.getBoundingClientRect();return{x:(u.clientX-l.left)/a,y:(u.clientY-l.top)/o,winX:u.clientX,winY:u.clientY}}function s(i,a,o,u){const l=i.getBoundingClientRect();return{x:(u.clientX-l.left)/a,y:(u.clientY-l.top)/o,winX:u.clientX,winY:u.clientY,id:u.pointerId}}t._setMouseButton=function(i){this.mouseButton.left=Array.from(this._activePointers.values()).some(a=>(a.buttons&1)!==0),this.mouseButton.center=Array.from(this._activePointers.values()).some(a=>(a.buttons&4)!==0),this.mouseButton.right=Array.from(this._activePointers.values()).some(a=>(a.buttons&2)!==0)},t._onpointermove=function(i){const a=this._isGlobal?window:this;let o;this._updatePointerCoords(i),this._activePointers.set(i.pointerId,i),this._setMouseButton(i),!this.mouseIsPressed&&typeof a.mouseMoved=="function"?(o=a.mouseMoved(i),o===!1&&i.preventDefault()):this.mouseIsPressed&&typeof a.mouseDragged=="function"&&(o=a.mouseDragged(i),o===!1&&i.preventDefault())},t._onpointerdown=function(i){const a=this._isGlobal?window:this;let o;this.mouseIsPressed=!0,this._activePointers.set(i.pointerId,i),this._setMouseButton(i),this._updatePointerCoords(i),typeof a.mousePressed=="function"&&(o=a.mousePressed(i),o===!1&&i.preventDefault())},t._onpointerup=function(i){const a=this._isGlobal?window:this;let o;this.mouseIsPressed=!1,this._activePointers.delete(i.pointerId),this._setMouseButton(i),this._updatePointerCoords(i),typeof a.mouseReleased=="function"&&(o=a.mouseReleased(i),o===!1&&i.preventDefault())},t._ondragend=t._onpointerup,t._ondragover=t._onpointermove,t._onclick=function(i){const a=this._isGlobal?window:this;typeof a.mouseClicked=="function"&&a.mouseClicked(i)===!1&&i.preventDefault()},t._ondblclick=function(i){const a=this._isGlobal?window:this;typeof a.doubleClicked=="function"&&a.doubleClicked(i)===!1&&i.preventDefault()},t._mouseWheelDeltaY=0,t._pmouseWheelDeltaY=0,t._onwheel=function(i){const a=this._isGlobal?window:this;this._mouseWheelDeltaY=i.deltaY,typeof a.mouseWheel=="function"&&(i.delta=i.deltaY,a.mouseWheel(i)===!1&&i.preventDefault())},t.requestPointerLock=function(){const i=this._curElement.elt;return i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock,i.requestPointerLock?(i.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},t.exitPointerLock=function(){document.exitPointerLock()}}typeof p5<"u"&&iB(p5,p5.prototype);function Ete(r){r.registerAddon(rB),r.registerAddon(sB),r.registerAddon(iB)}function Dte(r){r.registerAddon(xT),r.registerAddon(bT),r.registerAddon(u8),r.registerAddon(gT),r.registerAddon(vT),r.registerAddon(ET)}class Tte{constructor(t){this.columns=[],this.rows=[]}toString(t=","){let n=this.rows.map(s=>s.arr);return this.columns.some(s=>s===null)||(n=[this.columns,...n]),_Q(n,{separator:t})}addRow(t){const n=t||new p5.TableRow;if(typeof n.arr>"u"||typeof n.obj>"u")throw new Error(`invalid TableRow: ${n}`);return n.table=this,this.rows.push(n),n}removeRow(t){this.rows[t].table=null;const n=this.rows.splice(t+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(n)}getRow(t){return this.rows[t]}getRows(){return this.rows}findRow(t,n){if(typeof n=="string"){for(let s=0;s<this.rows.length;s++)if(this.rows[s].obj[this.columns.indexOf(n)]===t)return this.rows[s]}else for(let s=0;s<this.rows.length;s++)if(this.rows[s].arr[n]===t)return this.rows[s];return null}findRows(t,n){const s=[];if(typeof n=="string")for(let i=0;i<this.rows.length;i++)this.rows[i].obj[this.columns.indexOf(n)]===t&&s.push(this.rows[i]);else for(let i=0;i<this.rows.length;i++)this.rows[i].arr[n]===t&&s.push(this.rows[i]);return s}matchRow(t,n){if(typeof n=="number"){for(let s=0;s<this.rows.length;s++)if(this.rows[s].arr[n].match(t))return this.rows[s]}else for(let s=0;s<this.rows.length;s++)if(this.rows[s].obj[this.columns.indexOf(n)].match(t))return this.rows[s];return null}matchRows(t,n){const s=[];if(typeof n=="number")for(let i=0;i<this.rows.length;i++)this.rows[i].arr[n].match(t)&&s.push(this.rows[i]);else for(let i=0;i<this.rows.length;i++)this.rows[i].obj[this.columns.indexOf(n)].match(t)&&s.push(this.rows[i]);return s}getColumn(t){const n=[];if(typeof t=="string")for(let s=0;s<this.rows.length;s++)n.push(this.rows[s].obj[this.columns.indexOf(t)]);else for(let s=0;s<this.rows.length;s++)n.push(this.rows[s].arr[t]);return n}clearRows(){delete this.rows,this.rows=[]}addColumn(t){const n=t||null;this.columns.push(n)}getColumnCount(){return this.columns.length}getRowCount(){return this.rows.length}removeTokens(t,n){const s=o=>o.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),i=[];for(let o=0;o<t.length;o++)i.push(s(t.charAt(o)));const a=new RegExp(i.join("|"),"g");if(typeof n>"u")for(let o=0;o<this.columns.length;o++)for(let u=0;u<this.rows.length;u++){let l=this.rows[u].arr[o];l=l.replace(a,""),this.rows[u].arr[o]=l,this.rows[u].obj[this.columns[o]]=l}else if(typeof n=="string")for(let o=0;o<this.rows.length;o++){let u=this.rows[o].obj[n];u=u.replace(a,""),this.rows[o].obj[n]=u;const l=this.columns.indexOf(n);this.rows[o].arr[l]=u}else for(let o=0;o<this.rows.length;o++){let u=this.rows[o].arr[n];u=u.replace(a,""),this.rows[o].arr[n]=u,this.rows[o].obj[this.columns[n]]=u}}trim(t){const n=new RegExp(" ","g");if(typeof t>"u")for(let s=0;s<this.columns.length;s++)for(let i=0;i<this.rows.length;i++){let a=this.rows[i].arr[s];a=a.replace(n,""),this.rows[i].arr[s]=a,this.rows[i].obj[this.columns[s]]=a}else if(typeof t=="string")for(let s=0;s<this.rows.length;s++){let i=this.rows[s].obj[t];i=i.replace(n,""),this.rows[s].obj[t]=i;const a=this.columns.indexOf(t);this.rows[s].arr[a]=i}else for(let s=0;s<this.rows.length;s++){let i=this.rows[s].arr[t];i=i.replace(n,""),this.rows[s].arr[t]=i,this.rows[s].obj[this.columns[t]]=i}}removeColumn(t){let n,s;typeof t=="string"?(n=t,s=this.columns.indexOf(t)):(s=t,n=this.columns[t]);const i=this.columns.splice(s+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(i);for(let a=0;a<this.rows.length;a++){const o=this.rows[a].arr,u=o.splice(s+1,o.length);o.pop(),this.rows[a].arr=o.concat(u),delete this.rows[a].obj[n]}}set(t,n,s){this.rows[t].set(n,s)}setNum(t,n,s){this.rows[t].setNum(n,s)}setString(t,n,s){this.rows[t].setString(n,s)}get(t,n){return typeof n=="string"?this.rows[t].get(this.columns.indexOf(n)):this.rows[t].get(n)}getNum(t,n){return this.rows[t].getNum(n)}getString(t,n){return this.rows[t].getString(n)}getObject(t){const n={};let s,i,a;for(let o=0;o<this.rows.length;o++)if(s=this.rows[o].obj,typeof t=="string")if(i=this.columns.indexOf(t),i>=0)a=s[t],n[a]=s;else throw new Error(`This table has no column named "${t}"`);else n[o]=this.rows[o].obj;return n}getArray(){const t=[];for(let n=0;n<this.rows.length;n++)t.push(this.rows[n].arr);return t}}function aB(r,t){r.Table=Tte}typeof p5<"u"&&aB(p5,p5.prototype);class Nte{constructor(t=[]){let n=t;this.arr=n,this.obj=Object.fromEntries(n.entries()),this.table=null}set(t,n){if(typeof t=="string"){const s=this.table.columns.indexOf(t);if(s>=0)this.obj[t]=n,this.arr[s]=n;else throw new Error(`This table has no column named "${t}"`)}else if(t<this.table.columns.length){this.arr[t]=n;const s=this.table.columns[t];this.obj[s]=n}else throw new Error(`Column #${t} is out of the range of this table`)}setNum(t,n){const s=parseFloat(n);this.set(t,s)}setString(t,n){const s=n.toString();this.set(t,s)}get(t){return typeof t=="string"?this.obj[this.table.columns.indexOf(t)]:this.arr[t]}getNum(t){let n;if(typeof t=="string"?n=parseFloat(this.obj[this.table.columns.indexOf(t)]):n=parseFloat(this.arr[t]),n.toString()==="NaN")throw`Error: ${this.obj[t]} is NaN (Not a Number)`;return n}getString(t){return typeof t=="string"?this.obj[this.table.columns.indexOf(t)].toString():this.arr[t].toString()}}function oB(r,t){r.TableRow=Nte}typeof p5<"u"&&oB(p5,p5.prototype);function kte(r){r.registerAddon(T8),r.registerAddon(aB),r.registerAddon(oB),r.registerAddon(z6)}function uB(r,t){t.abs=Math.abs,t.ceil=Math.ceil,t.constrain=function(n,s,i){return Math.max(Math.min(n,i),s)},t.dist=function(...n){if(n.length===4)return Math.hypot(n[2]-n[0],n[3]-n[1]);if(n.length===6)return Math.hypot(n[3]-n[0],n[4]-n[1],n[5]-n[2])},t.exp=Math.exp,t.floor=Math.floor,t.lerp=function(n,s,i){return i*(s-n)+n},t.log=Math.log,t.mag=function(n,s){return Math.hypot(n,s)},t.map=function(n,s,i,a,o,u){const l=(n-s)/(i-s)*(o-a)+a;return u?a<o?this.constrain(l,a,o):this.constrain(l,o,a):l},t.max=function(...n){const s=i=>{let a=-1/0;for(let o of i)a=Math.max(a,o);return a};return n[0]instanceof Array?s(n[0]):s(n)},t.min=function(...n){const s=i=>{let a=1/0;for(let o of i)a=Math.min(a,o);return a};return n[0]instanceof Array?s(n[0]):s(n)},t.norm=function(n,s,i){return this.map(n,s,i,0,1)},t.pow=Math.pow,t.round=function(n,s){if(!s)return Math.round(n);const i=Math.pow(10,s);return Math.round(n*i)/i},t.sq=n=>n*n,t.sqrt=Math.sqrt,t.fract=function(n){let s=0,i=Number(n);if(isNaN(i)||Math.abs(i)===1/0)return i;if(i<0&&(i=-i,s=1),String(i).includes(".")&&!String(i).includes("e")){let a=String(i);return a=+("0"+a.slice(a.indexOf("."))),Math.abs(s-a)}else return i<1?Math.abs(s-i):0}}typeof p5<"u"&&uB(p5,p5.prototype);function lB(r,t){let u=4,l=.5;const c=f=>.5*(1-Math.cos(f*Math.PI));let h;t.noise=function(f,p=0,g=0){if(h==null){h=new Array(4096);for(let $=0;$<4096;$++)h[$]=Math.random()}f<0&&(f=-f),p<0&&(p=-p),g<0&&(g=-g);let y=Math.floor(f),x=Math.floor(p),v=Math.floor(g),S=f-y,w=p-x,E=g-v,_,D,I=0,k=.5,A,N,F;for(let $=0;$<u;$++){let O=y+(x<<4)+(v<<8);_=c(S),D=c(w),A=h[O&4095],A+=_*(h[O+1&4095]-A),N=h[O+16&4095],N+=_*(h[O+16+1&4095]-N),A+=D*(N-A),O+=256,N=h[O&4095],N+=_*(h[O+1&4095]-N),F=h[O+16&4095],F+=_*(h[O+16+1&4095]-F),N+=D*(F-N),A+=c(E)*(N-A),I+=A*k,k*=l,y<<=1,S*=2,x<<=1,w*=2,v<<=1,E*=2,S>=1&&(y++,S--),w>=1&&(x++,w--),E>=1&&(v++,E--)}return I},t.noiseDetail=function(f,p){f>0&&(u=f),p>0&&(l=p)},t.noiseSeed=function(f){const p=(()=>{let v,S;return{setSeed(w){S=v=(w??Math.random()*4294967296)>>>0},getSeed(){return v},rand(){return S=(1664525*S+1013904223)%4294967296,S/4294967296}}})();p.setSeed(f),h=new Array(4096);for(let g=0;g<4096;g++)h[g]=p.rand()}}typeof p5<"u"&&lB(p5,p5.prototype);function cB(r,t){const n="_lcg_random_state";let o=0;t._lcg=function(u){return this[u]=(1664525*this[u]+1013904223)%4294967296,this[u]/4294967296},t._lcgSetSeed=function(u,l){this[u]=(l??Math.random()*4294967296)>>>0},t.randomSeed=function(u){this._lcgSetSeed(n,u),this._gaussian_previous=!1},t.random=function(u,l){let c;if(this[n]!=null?c=this._lcg(n):c=Math.random(),typeof u>"u")return c;if(typeof l>"u")return u instanceof Array?u[Math.floor(c*u.length)]:c*u;if(u>l){const h=u;u=l,l=h}return c*(l-u)+u},t.randomGaussian=function(u,l=1){let c,h,f,p;if(this._gaussian_previous)c=o,this._gaussian_previous=!1;else{do h=this.random(2)-1,f=this.random(2)-1,p=h*h+f*f;while(p>=1);p=Math.sqrt(-2*Math.log(p)/p),c=h*p,o=f*p,this._gaussian_previous=!0}const g=u||0;return c*l+g}}typeof p5<"u"&&cB(p5,p5.prototype);function hB(r,t){t.createVector=function(n,s,i){return this instanceof r?new r.Vector(this._fromRadians.bind(this),this._toRadians.bind(this),...arguments):new r.Vector(n,s,i)},t.createMatrix=function(...n){return new r.Matrix(...n)}}typeof p5<"u"&&hB(p5,p5.prototype);function Ate(r){r.registerAddon(uB),r.registerAddon(lB),r.registerAddon(cB),r.registerAddon(yT),r.registerAddon(hB),r.registerAddon(v6)}function fB(r,t){t.float=function(n){return n instanceof Array?n.map(parseFloat):parseFloat(n)},t.int=function(n,s=10){if(n===1/0||n==="Infinity")return 1/0;if(n===-1/0||n==="-Infinity")return-1/0;if(typeof n=="string")return parseInt(n,s);if(typeof n=="number")return n|0;if(typeof n=="boolean")return n?1:0;if(n instanceof Array)return n.map(i=>t.int(i,s))},t.str=function(n){return n instanceof Array?n.map(t.str):String(n)},t.boolean=function(n){if(typeof n=="number")return n!==0;if(typeof n=="string")return n.toLowerCase()==="true";if(typeof n=="boolean")return n;if(n instanceof Array)return n.map(t.boolean)},t.byte=function(n){const s=t.int(n,10);if(typeof s=="number")return(s+128)%256-128;if(s instanceof Array)return s.map(t.byte)},t.char=function(n){if(typeof n=="number"&&!isNaN(n))return String.fromCharCode(n);if(n instanceof Array)return n.map(t.char);if(typeof n=="string")return t.char(parseInt(n,10))},t.unchar=function(n){if(typeof n=="string"&&n.length===1)return n.charCodeAt(0);if(n instanceof Array)return n.map(t.unchar)},t.hex=function(n,s){if(s=s??(s=8),n instanceof Array)return n.map(i=>t.hex(i,s));if(n===1/0||n===-1/0)return(n===1/0?"F":"0").repeat(s);if(typeof n=="number"){n<0&&(n=4294967295+n+1);let i=Number(n).toString(16).toUpperCase();for(;i.length<s;)i=`0${i}`;return i.length>=s&&(i=i.substring(i.length-s,i.length)),i}},t.unhex=function(n){return n instanceof Array?n.map(t.unhex):parseInt(`0x${n}`,16)}}typeof p5<"u"&&fB(p5,p5.prototype);function dB(r,t){t.nf=function(o,u,l){return o instanceof Array?o.map(c=>n(c,u,l)):Object.prototype.toString.call(o)==="[object Arguments]"?o.length===3?this.nf(o[0],o[1],o[2]):o.length===2?this.nf(o[0],o[1]):this.nf(o[0]):n(o,u,l)};function n(o,u,l){let c=o<0;o=Math.abs(o);let[h,f]=o.toString().split(".");if(typeof l>"u"){h=h.padStart(u,"0");let p=f?h+"."+f:h;return c?"-"+p:p}else{[h,f]=o.toFixed(l).toString().split("."),h=h.padStart(u,"0");let g=typeof f>"u"?h:h+"."+f;return c?"-"+g:g}}t.nfc=function(o,u){return o instanceof Array?o.map(l=>s(l,u)):s(o,u)};function s(o,u){o=o.toString();const l=o.indexOf(".");let c=l!==-1?o.substring(l):"",h=l!==-1?o.substring(0,l):o;if(h=h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),u===0)c="";else if(typeof u<"u")if(u>c.length){c+=l===-1?".":"";const f=u-c.length+1;for(let p=0;p<f;p++)c+="0"}else c=c.substring(0,u+1);return h+c}t.nfp=function(...o){const u=t.nf.apply(this,o);return u instanceof Array?u.map(i):i(u)};function i(o){return parseFloat(o)>0?`+${o.toString()}`:o.toString()}t.nfs=function(...o){const u=t.nf.apply(this,o);return u instanceof Array?u.map(a):a(u)};function a(o){return parseFloat(o)>=0?` ${o.toString()}`:o.toString()}t.splitTokens=function(o,u){let l;if(typeof u<"u"){let c=u;const h=/\]/g.exec(c);let f=/\[/g.exec(c);f&&h?(c=c.slice(0,h.index)+c.slice(h.index+1),f=/\[/g.exec(c),c=c.slice(0,f.index)+c.slice(f.index+1),l=new RegExp(`[\\[${c}\\]]`,"g")):h?(c=c.slice(0,h.index)+c.slice(h.index+1),l=new RegExp(`[${c}\\]]`,"g")):f?(c=c.slice(0,f.index)+c.slice(f.index+1),l=new RegExp(`[${c}\\[]`,"g")):l=new RegExp(`[${c}]`,"g")}else l=/\s/g;return o.split(l).filter(c=>c)},t.shuffle=function(o,u){const l=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(o);o=u||l?o:o.slice();let c,h,f=o.length;for(;f>1;)c=this.random(0,1)*f|0,h=o[--f],o[f]=o[c],o[c]=h;return o}}typeof p5<"u"&&dB(p5,p5.prototype);function pB(r,t){t.day=function(){return new Date().getDate()},t.hour=function(){return new Date().getHours()},t.minute=function(){return new Date().getMinutes()},t.millis=function(){return this._millisStart===-1?0:window.performance.now()-this._millisStart},t.month=function(){return new Date().getMonth()+1},t.second=function(){return new Date().getSeconds()},t.year=function(){return new Date().getFullYear()}}typeof p5<"u"&&pB(p5,p5.prototype);function Ite(r){r.registerAddon(fB),r.registerAddon(dB),r.registerAddon(pB)}function mB(r,t){t.orbitControl=function(n,s,i,a){this._assert3d("orbitControl");const o=this._renderer.states.curCamera;typeof n>"u"&&(n=1),typeof s>"u"&&(s=n),typeof i>"u"&&(i=1),typeof a!="object"&&(a={}),this.contextMenuDisabled!==!0&&(this.canvas.oncontextmenu=()=>!1,this.contextMenuDisabled=!0),this.wheelDefaultDisabled!==!0&&(this.canvas.onwheel=()=>!1,this.wheelDefaultDisabled=!0);const{disableTouchActions:u=!0}=a;this.touchActionsDisabled!==!0&&u&&(this.canvas.style["touch-action"]="none",this.touchActionsDisabled=!0);const{freeRotation:l=!1}=a,c=[];this.touches.forEach(I=>{this._renderer.prevTouches.forEach(k=>{if(I.id===k.id){const A={x:I.x,y:I.y,px:k.x,py:k.y};c.push(A)}})}),this._renderer.prevTouches=this.touches;let h=0,f=0,p=0,g=0,y=0;const x=.85,v=.6,S=.15,w=.01,E=4e-4,_=this.height<this.width?this.height:this.width;let D=!1;if(c.length>0){if(D=c[0].x>0&&c[0].x<this.width&&c[0].y>0&&c[0].y<this.height,c.length===1){const I=c[0];f=-n*(I.x-I.px)/_,p=s*(I.y-I.py)/_}else{const I=c[0],k=c[1],A=Math.hypot(I.x-k.x,I.y-k.y),N=Math.hypot(I.px-k.px,I.py-k.py);h=-(A-N)*i*E,g=.5*(I.x+k.x)-.5*(I.px+k.px),y=.5*(I.y+k.y)-.5*(I.py+k.py)}this.touches.length>0?D&&(this._renderer.executeRotateAndMove=!0,this._renderer.executeZoom=!0):(this._renderer.executeRotateAndMove=!1,this._renderer.executeZoom=!1)}else D=this.mouseX>0&&this.mouseX<this.width&&this.mouseY>0&&this.mouseY<this.height,this._mouseWheelDeltaY!==0?(h=Math.sign(this._mouseWheelDeltaY)*i,h*=w,this._mouseWheelDeltaY=0,D&&(this._renderer.executeZoom=!0)):this._renderer.executeZoom=!1,this.mouseIsPressed?(this.mouseButton.left?(f=-n*this.movedX/_,p=s*this.movedY/_):this.mouseButton.right&&(g=this.movedX,y=this.movedY*o.yScale),D&&(this._renderer.executeRotateAndMove=!0)):this._renderer.executeRotateAndMove=!1;if(h!==0&&this._renderer.executeZoom&&(this._renderer.zoomVelocity+=h),Math.abs(this._renderer.zoomVelocity)>.001?(l?o._orbitFree(0,0,this._renderer.zoomVelocity):o._orbit(0,0,this._renderer.zoomVelocity),o.projMatrix.mat4[15]!==0&&(o.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity),o.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity),this._renderer.states.setValue("uPMatrix",this._renderer.states.uPMatrix.clone()),this._renderer.states.uPMatrix.mat4[0]=o.projMatrix.mat4[0],this._renderer.states.uPMatrix.mat4[5]=o.projMatrix.mat4[5]),this._renderer.zoomVelocity*=x):this._renderer.zoomVelocity=0,(f!==0||p!==0)&&this._renderer.executeRotateAndMove&&this._renderer.rotateVelocity.add(f*v,p*v),this._renderer.rotateVelocity.magSq()>1e-6?(l?o._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0):o._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0),this._renderer.rotateVelocity.mult(x)):this._renderer.rotateVelocity.set(0,0),(g!==0||y!==0)&&this._renderer.executeRotateAndMove){const I=g*2/this.width,k=-y*2/this.height;this._renderer.moveVelocity.add(I*S,k*S)}if(this._renderer.moveVelocity.magSq()>1e-6){const I=o._getLocalAxes(),k=o.eyeX-o.centerX,A=o.eyeY-o.centerY,N=o.eyeZ-o.centerZ,F=Math.sqrt(k*k+A*A+N*N);let $=new Ee(o.centerX,o.centerY,o.centerZ);$=o.cameraMatrix.multiplyPoint($),$=this._renderer.states.uPMatrix.multiplyAndNormalizePoint($),$.x-=this._renderer.moveVelocity.x,$.y-=this._renderer.moveVelocity.y;let O,M;const B=this._renderer.states.uPMatrix.mat4;B[15]===0?(O=(B[8]+$.x)/B[0]*F,M=(B[9]+$.y)/B[5]*F):(O=($.x-B[12])/B[0],M=($.y-B[13])/B[5]),o.setPosition(o.eyeX+O*I.x[0]+M*I.y[0],o.eyeY+O*I.x[1]+M*I.y[1],o.eyeZ+O*I.x[2]+M*I.y[2]),this._renderer.moveVelocity.mult(x)}else this._renderer.moveVelocity.set(0,0);return this},t.debugMode=function(...n){this._assert3d("debugMode");for(let s=r.lifecycleHooks.postdraw.length-1;s>=0;s--)(r.lifecycleHooks.postdraw[s].toString()===this._grid().toString()||r.lifecycleHooks.postdraw[s].toString()===this._axesIcon().toString())&&r.lifecycleHooks.postdraw.splice(s,1);n[0]===m6?r.lifecycleHooks.postdraw.push(this._grid(n[1],n[2],n[3],n[4],n[5])):n[0]===g6?r.lifecycleHooks.postdraw.push(this._axesIcon(n[1],n[2],n[3],n[4])):(r.lifecycleHooks.postdraw.push(this._grid(n[0],n[1],n[2],n[3],n[4])),r.lifecycleHooks.postdraw.push(this._axesIcon(n[5],n[6],n[7],n[8])))},t.noDebugMode=function(){this._assert3d("noDebugMode");for(let n=r.lifecycleHooks.postdraw.length-1;n>=0;n--)(r.lifecycleHooks.postdraw[n].toString()===this._grid().toString()||r.lifecycleHooks.postdraw[n].toString()===this._axesIcon().toString())&&r.lifecycleHooks.postdraw.splice(n,1)},t._grid=function(n,s,i,a,o){typeof n>"u"&&(n=this.width/2),typeof s>"u"&&(s=Math.round(n/30)<4?4:Math.round(n/30)),typeof i>"u"&&(i=0),typeof a>"u"&&(a=0),typeof o>"u"&&(o=0);const u=n/s,l=n/2;return function(){this.push(),this.stroke(this._renderer.states.curStrokeColor[0]*255,this._renderer.states.curStrokeColor[1]*255,this._renderer.states.curStrokeColor[2]*255),this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.uModelMatrix.reset();for(let c=0;c<=s;c++)this.beginShape(this.LINES),this.vertex(-l+i,a,c*u-l+o),this.vertex(+l+i,a,c*u-l+o),this.endShape();for(let c=0;c<=s;c++)this.beginShape(this.LINES),this.vertex(c*u-l+i,a,-l+o),this.vertex(c*u-l+i,a,+l+o),this.endShape();this.pop()}},t._axesIcon=function(n,s,i,a){return typeof n>"u"&&(n=this.width/20>40?this.width/20:40),typeof s>"u"&&(s=-this.width/4),typeof i>"u"&&(i=s),typeof a>"u"&&(a=s),()=>{this.push(),this._renderer.states.setValue("uModelMatrix",this._renderer.states.uModelMatrix.clone()),this._renderer.states.uModelMatrix.reset(),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(s,i,a),this.vertex(s+n,i,a),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(s,i,a),this.vertex(s,i+n,a),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(s,i,a),this.vertex(s,i,a+n),this.endShape(),this.pop()}}}typeof p5<"u"&&mB(p5,p5.prototype);async function $te(r){try{return(await fetch(r,{method:"HEAD"})).ok}catch{return!1}}function gB(r,t){t.loadModel=async function(h,f,p,g,y){let x=!1,v=!1;typeof f=="object"?(p=f.normalize||!1,g=f.successCallback,y=f.failureCallback,f=f.fileType||f,x=f.flipU||!1,v=f.flipV||!1):(typeof arguments[arguments.length-1]=="function"&&(typeof arguments[arguments.length-2]=="function"?(g=arguments[arguments.length-2],y=arguments[arguments.length-1]):g=arguments[arguments.length-1]),typeof f=="string"?typeof p!="boolean"&&(p=!1):typeof f=="boolean"?(p=f,f=h.slice(-4)):(f=h.slice(-4),p=!1)),f.toLowerCase()!==".obj"&&f.toLowerCase()!==".stl"&&(f=".obj");const S=new Ts(void 0,void 0,void 0,this._renderer);S.gid=`${h}|${p}`;async function w(E){const _=[];for(let D of E){const I=D.match(/^mtllib (.+)/);if(I){let k="";const A=I[1],N=h.split("/");N.length>1?(N.pop(),k=N.join("/")+"/"+A):k=A,_.push($te(k).then(F=>F?n(k):(console.warn(`MTL file not found or error in parsing; proceeding without materials: ${k}`),{})).catch(F=>(console.warn(`Error loading MTL file: ${k}`,F),{})))}}try{const D=await Promise.all(_);return Object.assign({},...D)}catch{return{}}}try{if(f.match(/\.stl$/i)){const{data:E}=await Wi(h,"arrayBuffer");return i(S,E),p&&S.normalize(),x&&S.flipU(),v&&S.flipV(),S._makeTriangleEdges(),g?g(S):S}else if(f.match(/\.obj$/i)){const{data:E}=await Wi(h,"text"),_=E.split(`
`),D=await w(_);return s(S,_,D),p&&S.normalize(),x&&S.flipU(),v&&S.flipV(),S._makeTriangleEdges(),g?g(S):S}}catch(E){if(r._friendlyFileLoadError(3,h),y)return y(E);throw E}};async function n(h){let f=null,p={};const{data:g}=await Wi(h,"text"),y=g.split(`
`);for(let x=0;x<y.length;++x){const v=y[x].trim().split(/\s+/);v[0]==="newmtl"?(f=v[1],p[f]={}):v[0]==="Kd"?p[f].diffuseColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="Ka"?p[f].ambientColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="Ks"?p[f].specularColor=[parseFloat(v[1]),parseFloat(v[2]),parseFloat(v[3])]:v[0]==="map_Kd"&&(p[f].texturePath=v[1])}return p}function s(h,f,p={}){const g={v:[],vt:[],vn:[]},y={};let x=null,v=!1,S=!1;for(let w=0;w<f.length;++w){const E=f[w].trim().split(/\b\s+/);if(E.length>0){if(E[0]==="usemtl")x=E[1];else if(E[0]==="v"||E[0]==="vn"){const _=new Ee(parseFloat(E[1]),parseFloat(E[2]),parseFloat(E[3]));g[E[0]].push(_)}else if(E[0]==="vt"){const _=[parseFloat(E[1]),1-parseFloat(E[2])];g[E[0]].push(_)}else if(E[0]==="f")for(let _=3;_<E.length;++_){const D=[],I=[1,_-1,_];for(let k=0;k<I.length;++k){const A=E[I[k]];let N=A.split("/");for(let F=0;F<N.length;F++)N[F]=parseInt(N[F])-1;if(y[A]||(y[A]={}),y[A][x]===void 0){const F=h.vertices.length;if(h.vertices.push(g.v[N[0]].copy()),h.uvs.push(g.vt[N[1]]?g.vt[N[1]].slice():[0,0]),h.vertexNormals.push(g.vn[N[2]]?g.vn[N[2]].copy():new Ee),y[A][x]=F,D.push(F),x&&p[x]&&p[x].diffuseColor){v=!0;const $=p[x].diffuseColor;h.vertexColors.push($[0]),h.vertexColors.push($[1]),h.vertexColors.push($[2]),h.vertexColors.push(1)}else S=!0}else D.push(y[A][x])}D[0]!==D[1]&&D[0]!==D[2]&&D[1]!==D[2]&&h.faces.push(D)}}}if(h.vertexNormals.length===0&&h.computeNormals(),v===S)throw new Error("Model coloring is inconsistent. Either all vertices should have colors or none should.");return h}function i(h,f){if(a(f))u(h,f);else{const p=new DataView(f);if(!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)"),h;const x=new TextDecoder("utf-8").decode(p).split(`
`);l(h,x)}return h}function a(h){const f=new DataView(h),p=[115,111,108,105,100];for(let g=0;g<5;g++)if(o(p,f,g))return!1;return!0}function o(h,f,p){for(let g=0,y=h.length;g<y;g++)if(h[g]!==f.getUint8(p+g,!1))return!1;return!0}function u(h,f){const p=new DataView(f),g=p.getUint32(80,!0);let y,x,v,S=!1,w,E,_,D;for(let A=0;A<70;A++)p.getUint32(A,!1)===1129270351&&p.getUint8(A+4)===82&&p.getUint8(A+5)===61&&(S=!0,w=[],E=p.getUint8(A+6)/255,_=p.getUint8(A+7)/255,D=p.getUint8(A+8)/255);const I=84,k=12*4+2;for(let A=0;A<g;A++){const N=I+A*k,F=p.getFloat32(N,!0),$=p.getFloat32(N+4,!0),O=p.getFloat32(N+8,!0);if(S){const B=p.getUint16(N+48,!0);(B&32768)===0?(y=(B&31)/31,x=(B>>5&31)/31,v=(B>>10&31)/31):(y=E,x=_,v=D)}const M=new Ee(F,$,O);for(let B=1;B<=3;B++){const U=N+B*12,V=new Ee(p.getFloat32(U,!0),p.getFloat32(U+4,!0),p.getFloat32(U+8,!0));h.vertices.push(V),h.vertexNormals.push(M),S&&w.push(y,x,v)}h.faces.push([3*A,3*A+1,3*A+2]),h.uvs.push([0,0],[0,0],[0,0])}return h}function l(h,f){let p="",g=[],y,x;for(let v=0;v<f.length;++v){const S=f[v].trim(),w=S.split(" ");for(let E=0;E<w.length;++E)w[E]===""&&w.splice(E,1);if(w.length!==0)switch(p){case"":if(w[0]!=="solid"){console.error(S),console.error(`Invalid state "${w[0]}", should be "solid"`);return}else p="solid";break;case"solid":if(w[0]!=="facet"||w[1]!=="normal"){console.error(S),console.error(`Invalid state "${w[0]}", should be "facet normal"`);return}else y=new Ee(parseFloat(w[2]),parseFloat(w[3]),parseFloat(w[4])),h.vertexNormals.push(y,y,y),p="facet normal";break;case"facet normal":if(w[0]!=="outer"||w[1]!=="loop"){console.error(S),console.error(`Invalid state "${w[0]}", should be "outer loop"`);return}else p="vertex";break;case"vertex":if(w[0]==="vertex")x=new Ee(parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3])),h.vertices.push(x),h.uvs.push([0,0]),g.push(h.vertices.indexOf(x));else if(w[0]==="endloop")h.faces.push(g),g=[],p="endloop";else{console.error(S),console.error(`Invalid state "${w[0]}", should be "vertex" or "endloop"`);return}break;case"endloop":if(w[0]!=="endfacet"){console.error(S),console.error(`Invalid state "${w[0]}", should be "endfacet"`);return}else p="endfacet";break;case"endfacet":if(w[0]!=="endsolid")if(w[0]==="facet"&&w[1]==="normal")y=new Ee(parseFloat(w[2]),parseFloat(w[3]),parseFloat(w[4])),h.vertexNormals.push(y,y,y),p="facet normal";else{console.error(S),console.error(`Invalid state "${w[0]}", should be "endsolid" or "facet normal"`);return}break;default:console.error(`Invalid state "${p}"`);break}}return h}t.model=function(h,f=1){this._assert3d("model"),this._renderer.model(h,f)};let c=0;t.createModel=function(h,f=" ",p){let g=!1,y,x,v=!1,S=!1;p&&typeof p=="object"?(g=p.normalize||!1,y=p.successCallback,x=p.failureCallback,v=p.flipU||!1,S=p.flipV||!1):typeof p=="boolean"?(g=p,y=arguments[3],x=arguments[4]):(y=typeof arguments[2]=="function"?arguments[2]:void 0,x=arguments[3]);const w=new r.Geometry;if(w.gid=`${f}|${g}|${c++}`,f.match(/\.stl$/i))try{let _=new TextEncoder().encode(h).buffer;i(w,_)}catch(E){x?x(E):r._friendlyError("Error during parsing: "+E.message);return}else if(f.match(/\.obj$/i))try{const E=h.split(`
`);s(w,E)}catch(E){x?x(E):r._friendlyError("Error during parsing: "+E.message);return}else r._friendlyFileLoadError(3,h),x?x():r._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.");return g&&w.normalize(),v&&w.flipU(),S&&w.flipV(),w._makeTriangleEdges(),typeof y=="function"&&y(w),w}}typeof p5<"u"&&gB(p5,p5.prototype);const _i={IDEOGRAPHIC:"ideographic",_CTX_MIDDLE:"middle",_TEXT_BOUNDS:"_textBoundsSingle",_FONT_BOUNDS:"_fontBoundsSingle",HANGING:"hanging",START:"start",END:"end"};function yB(r,t){const s="#000000",i=/\r?\n/g,a=/,\s+/,o=/^".*"$/,u=/\t/g,l="fontVariationSettings",c=["wght","wdth","ital","slnt","opsz"],h=new RegExp(`(?:${c.join("|")})`);["text","textAlign","textAscent","textDescent","textLeading","textMode","textFont","textSize","textStyle","textWidth","textWrap","textBounds","textDirection","textProperty","textProperties","fontBounds","fontWidth","fontAscent","fontDescent","textWeight"].forEach(w=>{t[w]=function(...E){if(!(w in Pt.prototype))throw Error(`Renderer2D.prototype.${w} is not defined.`);return this._renderer[w](...E)},r.Graphics.prototype[w]=function(...E){return this._renderer[w](...E)}});const p={textAlign:{default:t.LEFT,type:"Context2d"},textBaseline:{default:t.BASELINE,type:"Context2d"},textFont:{default:{family:"sans-serif"}},textLeading:{default:15},textSize:{default:12},textWrap:{default:t.WORD},fontStretch:{default:t.NORMAL,isShorthand:!0},fontWeight:{default:t.NORMAL,isShorthand:!0},lineHeight:{default:t.NORMAL,isShorthand:!0},fontVariant:{default:t.NORMAL,isShorthand:!0},fontStyle:{default:t.NORMAL,isShorthand:!0},direction:{default:"inherit"}},g=["font","direction","fontKerning","fontStretch","fontVariantCaps","letterSpacing","textAlign","textBaseline","textRendering","wordSpacing"],y=Object.keys(p).filter(w=>p[w].isShorthand),x=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"];let v,S;if(Pt.prototype.text=function(w,E,_,D,I){let k=this.textDrawingContext().textBaseline;({x:E,y:_,width:D,height:I}=this._handleRectMode(E,_,D,I));let A=this._processLines(w,D,I);A=this._positionLines(E,_,D,I,A),A.forEach(N=>this._renderText(N.text,N.x,N.y)),this.textDrawingContext().textBaseline=k},Pt.prototype.textBounds=function(w,E,_,D,I){return this._computeBounds(_i._TEXT_BOUNDS,w,E,_,D,I).bounds},Pt.prototype.fontBounds=function(w,E,_,D,I){return this._computeBounds(_i._FONT_BOUNDS,w,E,_,D,I).bounds},Pt.prototype.textWidth=function(w){let E=this._processLines(w);return Math.max(...E.map(_=>this._textWidthSingle(_)))},Pt.prototype.fontWidth=function(w){let E=this._processLines(w);return Math.max(...E.map(_=>this._fontWidthSingle(_)))},Pt.prototype.textAscent=function(w=""){return w.length?this.textDrawingContext().measureText(w).actualBoundingBoxAscent:this.fontAscent()},Pt.prototype.fontAscent=function(){return this.textDrawingContext().measureText("_").fontBoundingBoxAscent},Pt.prototype.textDescent=function(w=""){return w.length?this.textDrawingContext().measureText(w).actualBoundingBoxDescent:this.fontDescent()},Pt.prototype.fontDescent=function(){return this.textDrawingContext().measureText("_").fontBoundingBoxDescent},Pt.prototype.textAlign=function(w,E){return typeof w<"u"?(this.states.setValue("textAlign",w),typeof E<"u"&&(E===t.CENTER&&(E=_i._CTX_MIDDLE),this.states.setValue("textBaseline",E)),this._applyTextProperties()):{horizontal:this.states.textAlign,vertical:this.states.textBaseline}},Pt.prototype._currentTextFont=function(){return this.states.textFont.font||this.states.textFont.family},Pt.prototype.textFont=function(w,E,_){var I;if(arguments.length===0)return this._currentTextFont();let D=w;if(w instanceof r.Font?D=w.face.family:w.data instanceof Uint8Array?(D=w.name.fontFamily,(I=w.name)!=null&&I.fontSubfamily&&(D+="-"+w.name.fontSubfamily)):typeof w=="string"&&typeof E>"u"&&/[.0-9]+(%|em|p[xt])/.test(D)&&({family:D,size:E}=this._directSetFontString(D)),typeof D!="string")throw Error("null font in textFont()");return arguments.length===2&&typeof E=="object"&&(_=E,E=void 0),this.states.setValue("textFont",{font:w,family:D,size:E}),typeof E<"u"&&this._setTextSize(E),typeof _=="object"&&this.textProperties(_),this._applyTextProperties()},Pt.prototype._directSetFontString=function(w,E=0){E&&console.log('_directSetFontString"'+w+'"');let _=y.reduce((k,A)=>(k[A]=p[A].default,k),{}),D=this._cachedDiv(_);D.style.font=w;let I=getComputedStyle(D);return y.forEach(k=>{this.states[k]=I[k],E&&console.log("  this.states."+k+'="'+I[k]+'"')}),{family:I.fontFamily,size:I.fontSize}},Pt.prototype.textLeading=function(w){return typeof w=="number"?(this.states.setValue("leadingSet",!0),this.states.setValue("textLeading",w),this._applyTextProperties()):this.states.textLeading},Pt.prototype.textWeight=function(w){if(typeof w=="number"){this.states.setValue("fontWeight",w),this._applyTextProperties(),r.prototype._isSafari()||this._setCanvasStyleProperty("font-variation-settings",`"wght" ${w}`);return}return this.states.fontWeight},Pt.prototype.textSize=function(w){return typeof w<"u"?(this._setTextSize(w),this._applyTextProperties()):this.states.textSize},Pt.prototype.textStyle=function(w){return typeof w<"u"?(this.states.setValue("fontStyle",w),this._applyTextProperties()):this.states.fontStyle},Pt.prototype.textWrap=function(w){return w===t.WORD||w===t.CHAR?(this.states.setValue("textWrap",w),this._pInst):this.states.textWrap},Pt.prototype.textDirection=function(w){return typeof w<"u"?(this.states.setValue("direction",w),this._applyTextProperties()):this.states.direction},Pt.prototype.textProperty=function(w,E,_){let D=!1,I=(_==null?void 0:_.debug)||!1;if(typeof E>"u"){let k=this.textProperties();if(w in k)return k[w];throw Error('Unknown text option "'+w+'"')}return w in this.states&&this.states[w]!==E?(this.states[w]=E,D=!0,I&&console.log("this.states."+w+'="'+options[w]+'"')):w in this.textDrawingContext()?(this._setContextProperty(w,E,I),D=!0):w in this.textCanvas().style?(this._setCanvasStyleProperty(w,E,I),D=!0):console.warn('Ignoring unknown text option: "'+w+`"
`),D?this._applyTextProperties():this._pInst},Pt.prototype.textProperties=function(w){if(typeof w<"u")return Object.keys(w).forEach(_=>{this.textProperty(_,w[_])}),this._pInst;let E=this.textDrawingContext();return w=g.reduce((_,D)=>(_[D]=E[D],_),{}),Object.keys(p).forEach(_=>{var D;if(((D=p[_])==null?void 0:D.type)==="Context2d")w[_]=E[_];else if(_==="textFont"){let I=this._currentTextFont();typeof I=="object"&&"_pInst"in I&&(I=Object.assign({},I),delete I._pInst),w[_]=I}else w[_]=this.states[_]}),w},Pt.prototype.textMode=function(){},Pt.prototype._currentTextFont=function(){return this.states.textFont.font||this.states.textFont.family},Pt.prototype._computeBounds=function(w,E,_,D,I,k,A){let N=this.textDrawingContext(),F=N.textBaseline,{textLeading:$,textAlign:O}=this.states;({width:I,height:k}=this._rectModeAdjust(_,D,I,k));let M=this._processLines(E,I,k),B=M.map((V,Z)=>this[w].bind(this)(V,_,D+Z*$));M.length>1&&B.forEach(V=>V.x+=r.Renderer2D.prototype._xAlignOffset.call(this,O,I)),typeof k<"u"&&r.Renderer2D.prototype._yAlignOffset.call(this,B,k);let U=B[0];return M.length>1&&(U=this._aggregateBounds(B),A!=null&&A.ignoreRectMode||this._rectModeAlign(U,I||0,k||0)),N.textBaseline=F,{bounds:U,lines:M}},Pt.prototype._rectModeAdjust=function(w,E,_,D){if(typeof _<"u")switch(this.states.rectMode){case t.CENTER:break;case t.CORNERS:_-=w,D-=E;break;case t.RADIUS:_*=2,D*=2;break}return{x:w,y:E,width:_,height:D}},Pt.prototype._setCanvasStyleProperty=function(w,E,_){let D=E.toString();_&&console.log("canvas.style."+w+'="'+D+'"'),w===l&&this._handleFontVariationSettings(D),this.textCanvas().style[w]=D,this.textCanvas().style[w]},Pt.prototype._handleFontVariationSettings=function(w,E=!1){typeof w=="object"&&(w=Object.keys(w).map(D=>D+" "+w[D]).join(", ")),w.split(a).forEach(D=>{D=D.replace(/["']/g,"");let I=h.exec(D);if(I&&I.length){let k=I[0],A=parseFloat(parseFloat(D.replace(k,"").trim()).toFixed(3));switch(k){case"wght":return E&&console.log("setting font-weight="+A),this.states.fontWeight!==A&&this.textWeight(A),A;case"wdth":break;case"ital":E&&console.log("setting font-style="+(A?"italic":"normal"));break;case"slnt":E&&console.log("setting font-style="+(A?"oblique":"normal"));break;case"opsz":E&&console.log("setting font-optical-size="+A);break}}})},Pt.prototype._setContextProperty=function(w,E,_=!1){if(this.textDrawingContext()[w]===E)return this._pInst;(v??(v=[])).push([w,E]),_&&console.log("queued context2d."+w+'="'+E+'"')},Pt.prototype._handleRectMode=function(w,E,_,D){let I=this.states.rectMode;if(typeof _<"u")switch(I){case t.RADIUS:_*=2,w-=_/2,typeof D<"u"&&(D*=2,E-=D/2);break;case t.CENTER:w-=_/2,typeof D<"u"&&(E-=D/2);break;case t.CORNERS:_-=w,typeof D<"u"&&(D-=E);break}return{x:w,y:E,width:_,height:D}},Pt.prototype._fontSizePx=function(w,{family:E}=this.states.textFont){if((A=>!isNaN(A)&&A.trim()!=="")(w))return parseFloat(w);let D=this._cachedDiv({fontSize:w});D.style.fontSize=w,D.style.fontFamily=E;let I=getComputedStyle(D).fontSize,k=parseFloat(I);if(typeof k!="number")throw Error("textSize: invalid font-size");return k},Pt.prototype._cachedDiv=function(w){if(typeof S>"u"){let E=document.createElement("div");E.ariaHidden="true",E.style.display="none",Object.entries(w).forEach(([_,D])=>{E.style[_]=D}),this.textCanvas().appendChild(E),S=E}return S},Pt.prototype._aggregateBounds=function(w){let E=Math.min(...w.map(k=>k.x)),_=Math.min(...w.map(k=>k.y)),D=Math.max(...w.map(k=>k.y+k.h)),I=Math.max(...w.map(k=>k.x+k.w));return{x:E,y:_,w:I-E,h:D-_}},Pt.prototype._processLines=function(w,E,_){typeof E<"u"&&this.textDrawingContext().textBaseline===t.BASELINE&&(this.drawingContext.textBaseline=t.TOP);let D=this._splitOnBreaks(w.toString()),I=D.length>1,k=typeof E<"u",A=k&&D.some($=>this._textWidthSingle($)>E),{textLeading:N,textWrap:F}=this.states;if((I||A)&&k&&(D=this._lineate(F,D,E)),k&&typeof _<"u"){if(typeof N>"u")throw Error("leading is required if height is specified");for(let $=0;$<D.length;$++)if(N*($+1)>_){D=D.slice(0,$);break}}return D},Pt.prototype._xAlignOffset=function(w,E){switch(w){case t.LEFT:return 0;case t.CENTER:return E/2;case t.RIGHT:return E;case _i.START:return 0;case _i.END:throw new Error("textBounds: END not yet supported for textAlign");default:return 0}},Pt.prototype._rectModeAlign=function(w,E,_){if(typeof E<"u"){switch(this.states.rectMode){case t.CENTER:w.x-=(E-w.w)/2,w.y-=(_-w.h)/2;break;case t.CORNERS:w.w+=w.x,w.h+=w.y;break;case t.RADIUS:w.x-=(E-w.w)/2,w.y-=(_-w.h)/2,w.w/=2,w.h/=2;break}return w}},Pt.prototype._rectModeAlignRevert=function(w,E,_){if(typeof E<"u"){switch(this.states.rectMode){case t.CENTER:w.x+=(E-w.w)/2,w.y+=(_-w.h)/2;break;case t.CORNERS:w.w-=w.x,w.h-=w.y;break;case t.RADIUS:w.x+=(E-w.w)/2,w.y+=(_-w.h)/2,w.w*=2,w.h*=2;break}return w}},Pt.prototype._textWidthSingle=function(w){let E=this.textDrawingContext().measureText(w),_=E.actualBoundingBoxLeft;return E.actualBoundingBoxRight+_},Pt.prototype._fontWidthSingle=function(w){return this.textDrawingContext().measureText(w).width},Pt.prototype._textBoundsSingle=function(w,E=0,_=0){let D=this.textDrawingContext().measureText(w),I=D.actualBoundingBoxAscent,k=D.actualBoundingBoxDescent,A=D.actualBoundingBoxLeft,N=D.actualBoundingBoxRight;return{x:E-A,y:_-I,w:N+A,h:I+k}},Pt.prototype._fontBoundsSingle=function(w,E=0,_=0){let D=this.textDrawingContext().measureText(w),I=D.fontBoundingBoxAscent,k=D.fontBoundingBoxDescent;return E-=this._xAlignOffset(this.states.textAlign,D.width),{x:E,y:_-I,w:D.width,h:I+k}},Pt.prototype._setTextSize=function(w){if(typeof w=="string"&&(w=this._fontSizePx(w)),typeof w=="number"){if(this.states.textSize!==w)return this.states.setValue("textSize",w),this.states.leadingSet||this.states.setValue("textLeading",this.states.textSize*1.275),!0}else console.warn("textSize: invalid size: "+w);return!1},Pt.prototype._lineate=function(w,E,_=1/0,D={}){let I=D.splitChar??(w===t.WORD?" ":""),k,A,N,F,$=[];for(let O=0;O<E.length;O++){k="",F=E[O].split(I);for(let M=0;M<F.length;M++)A=`${k+F[M]}`+I,N=this._textWidthSingle(A),k.length>0&&N>_?($.push(k.trim()),k=`${F[M]}`+I):k=A;$.push(k.trim())}return $},Pt.prototype._splitOnBreaks=function(w){return!w||w.length===0?[""]:w.replace(u,"  ").split(i)},Pt.prototype._parseFontFamily=function(w){return w.split(a).map(D=>(D=D.trim(),D.indexOf(" ")>-1&&!o.test(D)&&(D=`"${D}"`),D)).join(", ")},Pt.prototype._applyFontString=function(){let{textFont:w,textSize:E,lineHeight:_,fontStyle:D,fontWeight:I,fontVariant:k}=this.states,A=this.textDrawingContext(),N=this._parseFontFamily(w.family),F=D!==t.NORMAL?`${D} `:"",$=I!==t.NORMAL?`${I} `:"",O=k!==t.NORMAL?`${k} `:"",M=`${E}px`+(_!==t.NORMAL?`/${_} `:" "),B=`${F}${O}${$}${M}${N}`.trim();if(A.font=B,A.font!==B){let U=B,V=A.font;if(U!==V)return!1}return!0},Pt.prototype._applyTextProperties=function(w=!1){this._applyFontString();let E=this.textDrawingContext();E.direction=this.states.direction,E.textAlign=this.states.textAlign,E.textBaseline=this.states.textBaseline;let _=this.states.fontStretch;for(x.includes(_)&&E.fontStretch!==_&&(E.fontStretch=_);v!=null&&v.length;){let[D,I]=v.shift();w&&console.log('apply context property "'+D+'" = "'+I+'"'),E[D]=I,E[D]!==I&&(console.warn(`Unable to set '${D}' property on context2d. It may not be supported.`),console.log('Expected "'+I+'" but got: "'+E[D]+'"'))}return this._pInst},r.Renderer2D&&(r.Renderer2D.prototype.textCanvas=function(){return this.canvas},r.Renderer2D.prototype.textDrawingContext=function(){return this.drawingContext},r.Renderer2D.prototype._renderText=function(w,E,_,D,I){let k=this.states,A=this.textDrawingContext();_<I||_>=D||(this.push(),k.strokeColor&&k.strokeSet&&A.strokeText(w,E,_),!this._clipping&&k.fillColor&&(k.fillSet||this._setFill(s),A.fillText(w,E,_)),this.pop())},r.Renderer2D.prototype._positionLines=function(w,E,_,D,I){let{textLeading:k,textAlign:A}=this.states,N,F=new Array(I.length),$=typeof _>"u"?0:_,O=typeof D>"u"?0:D;for(let M=0;M<I.length;M++){switch(A){case _i.START:throw new Error("textBounds: START not yet supported for textAlign");case t.LEFT:N=w;break;case t.CENTER:N=w+$/2;break;case t.RIGHT:N=w+$;break;case _i.END:throw new Error("textBounds: END not yet supported for textAlign")}F[M]={text:I[M],x:N,y:E+M*k}}return this._yAlignOffset(F,O)},r.Renderer2D.prototype._yAlignOffset=function(w,E){if(typeof E>"u")throw Error("_yAlignOffset: height is required");let{textLeading:_,textBaseline:D}=this.states,I=0,k=w.length,A=E-_*(k-1);switch(D){case t.TOP:break;case t.BASELINE:break;case _i._CTX_MIDDLE:I=A/2;break;case t.BOTTOM:I=A;break;case _i.IDEOGRAPHIC:console.warn("textBounds: IDEOGRAPHIC not yet supported for textBaseline");break;case _i.HANGING:console.warn("textBounds: HANGING not yet supported for textBaseline");break}return w.forEach(N=>N.y+=I),w}),r.RendererGL){r.RendererGL.prototype.textCanvas=function(){return this._textCanvas||(this._textCanvas=document.createElement("canvas"),this._textCanvas.width=1,this._textCanvas.height=1,this._textCanvas.style.display="none",this.canvas.parentElement.insertBefore(this._textCanvas,this.canvas)),this._textCanvas},r.RendererGL.prototype.textDrawingContext=function(){if(!this._textDrawingContext){const E=this.textCanvas();this._textDrawingContext=E.getContext("2d")}return this._textDrawingContext};const w=r.RendererGL.prototype.remove;r.RendererGL.prototype.remove=function(){this._textCanvas&&this._textCanvas.parentElement.removeChild(this._textCanvas),w.call(this)},r.RendererGL.prototype._positionLines=function(E,_,D,I,k){let{textLeading:A,textAlign:N}=this.states;const F=k.map(U=>this._fontWidthSingle(U));let $,O=new Array(k.length),M=typeof D>"u"?Math.max(0,...F):D,B=typeof I>"u"?0:I;for(let U=0;U<k.length;U++){switch(N){case _i.START:throw new Error("textBounds: START not yet supported for textAlign");case t.LEFT:$=E;break;case t.CENTER:$=E+(M-F[U])/2-M/2+(D||0)/2;break;case t.RIGHT:$=E+M-F[U]-M+(D||0);break;case _i.END:throw new Error("textBounds: END not yet supported for textAlign")}O[U]={text:k[U],x:$,y:_+U*A}}return this._yAlignOffset(O,B)},r.RendererGL.prototype._yAlignOffset=function(E,_){var O;if(typeof _>"u")throw Error("_yAlignOffset: height is required");let{textLeading:D,textBaseline:I,textSize:k,textFont:A}=this.states,N=0,F=E.length,$=k*F+(D-k)*(F-1);switch(I){case t.TOP:N=k;break;case t.BASELINE:break;case _i._CTX_MIDDLE:N=-$/2+k+(_||0)/2;break;case t.BOTTOM:N=-($-k)+(_||0);break;default:console.warn(`${I} is not supported in WebGL mode.`);break}return N+=((O=this.states.textFont.font)==null?void 0:O._verticalAlign(k))||0,E.forEach(M=>M.y+=N),E}}}typeof p5<"u"&&yB(p5,p5.prototype);var _y={},WF;function Fte(){if(WF)return _y;WF=1,Object.defineProperty(_y,"__esModule",{value:!0});var r=function(){function t(){}return t.parse=function(n){for(var s=new Set,i=0,a=n;i<a.length;i++){var o=a[i];if(!t.REGEXP.test(o))throw new TypeError('"'+o+'" is invalid unicode-range.');var u=o.match(t.REGEXP),l=u[1],c=u[2],h=u[3];if(l){if(/\?[^?]+$/.test(l))throw new TypeError('"'+o+'" is invalid unicode-range.');if(l.includes("?"))for(var f=l.replace(/\?/g,"0"),p=l.replace(/\?/g,"F"),g=t.parse(["U+"+f+"-"+p]),y=0,x=g;y<x.length;y++){var v=x[y];s.add(v)}else s.add(parseInt(l,16))}if(c&&h)for(var S=parseInt(c,16),w=parseInt(h,16),v=S;v<=w;v++)s.add(v)}return Array.from(s).sort(function(E,_){return E-_})},t.stringify=function(n){for(var s=Array.from(new Set(n)).sort(function(c,h){return c-h}),i=[],a,o=0;o<s.length;o++){var u=s[o],l=s[o-1];a&&u-l!==1&&(i.push(t.rangeString(a,l)),a=u),a||(a=u),o===s.length-1&&(a===u?i.push(t.rangeString(u)):i.push(t.rangeString(a,u)))}return i},t.rangeString=function(n,s){return!s||n===s?"U+"+n.toString(16):"U+"+n.toString(16)+"-"+s.toString(16)},t.REGEXP=/^u\+(?:([0-9a-f]?[0-9a-f?]{1,5})|([0-9a-f]{1,6})-([0-9a-f]{1,6}))?$/i,t}();return _y.UnicodeRange=r,_y}var HF=Fte();const Rte=[{category:"control character",hexrange:["0000","001f"]},{category:"basic latin",hexrange:["0000","007f"]},{category:"latin-1 supplement",hexrange:["0080","00ff"]},{category:"latin extended-a",hexrange:["0100","017f"]},{category:"latin extended-b",hexrange:["0180","024f"]},{category:"ipa extensions",hexrange:["0250","02af"]},{category:"spacing modifier letters",hexrange:["02b0","02ff"]},{category:"combining diacritical marks",hexrange:["0300","036f"]},{category:"greek and coptic",hexrange:["0370","03ff"]},{category:"cyrillic",hexrange:["0400","04ff"]},{category:"cyrillic supplement",hexrange:["0500","052f"]},{category:"armenian",hexrange:["0530","058f"]},{category:"hebrew",hexrange:["0590","05ff"]},{category:"arabic",hexrange:["0600","06ff"]},{category:"syriac",hexrange:["0700","074f"]},{category:"arabic supplement",hexrange:["0750","077f"]},{category:"thaana",hexrange:["0780","07bf"]},{category:"nko",hexrange:["07c0","07ff"]},{category:"samaritan",hexrange:["0800","083f"]},{category:"mandaic",hexrange:["0840","085f"]},{category:"syriac supplement",hexrange:["0860","086f"]},{category:"arabic extended-b",hexrange:["0870","089f"]},{category:"arabic extended-a",hexrange:["08a0","08ff"]},{category:"devanagari",hexrange:["0900","097f"]},{category:"bengali",hexrange:["0980","09ff"]},{category:"gurmukhi",hexrange:["0a00","0a7f"]},{category:"gujarati",hexrange:["0a80","0aff"]},{category:"oriya",hexrange:["0b00","0b7f"]},{category:"tamil",hexrange:["0b80","0bff"]},{category:"telugu",hexrange:["0c00","0c7f"]},{category:"kannada",hexrange:["0c80","0cff"]},{category:"malayalam",hexrange:["0d00","0d7f"]},{category:"sinhala",hexrange:["0d80","0dff"]},{category:"thai",hexrange:["0e00","0e7f"]},{category:"lao",hexrange:["0e80","0eff"]},{category:"tibetan",hexrange:["0f00","0fff"]},{category:"myanmar",hexrange:["1000","109f"]},{category:"georgian",hexrange:["10a0","10ff"]},{category:"hangul jamo",hexrange:["1100","11ff"]},{category:"ethiopic",hexrange:["1200","137f"]},{category:"ethiopic supplement",hexrange:["1380","139f"]},{category:"cherokee",hexrange:["13a0","13ff"]},{category:"unified canadian aboriginal syllabics",hexrange:["1400","167f"]},{category:"ogham",hexrange:["1680","169f"]},{category:"runic",hexrange:["16a0","16ff"]},{category:"tagalog",hexrange:["1700","171f"]},{category:"hanunoo",hexrange:["1720","173f"]},{category:"buhid",hexrange:["1740","175f"]},{category:"tagbanwa",hexrange:["1760","177f"]},{category:"khmer",hexrange:["1780","17ff"]},{category:"mongolian",hexrange:["1800","18af"]},{category:"unified canadian aboriginal syllabics extended",hexrange:["18b0","18ff"]},{category:"limbu",hexrange:["1900","194f"]},{category:"tai le",hexrange:["1950","197f"]},{category:"new tai lue",hexrange:["1980","19df"]},{category:"khmer symbols",hexrange:["19e0","19ff"]},{category:"buginese",hexrange:["1a00","1a1f"]},{category:"tai tham",hexrange:["1a20","1aaf"]},{category:"combining diacritical marks extended",hexrange:["1ab0","1aff"]},{category:"balinese",hexrange:["1b00","1b7f"]},{category:"sundanese",hexrange:["1b80","1bbf"]},{category:"batak",hexrange:["1bc0","1bff"]},{category:"lepcha",hexrange:["1c00","1c4f"]},{category:"ol chiki",hexrange:["1c50","1c7f"]},{category:"cyrillic extended-c",hexrange:["1c80","1c8f"]},{category:"georgian extended",hexrange:["1c90","1cbf"]},{category:"sundanese supplement",hexrange:["1cc0","1ccf"]},{category:"vedic extensions",hexrange:["1cd0","1cff"]},{category:"phonetic extensions",hexrange:["1d00","1d7f"]},{category:"phonetic extensions supplement",hexrange:["1d80","1dbf"]},{category:"combining diacritical marks supplement",hexrange:["1dc0","1dff"]},{category:"latin extended additional",hexrange:["1e00","1eff"]},{category:"greek extended",hexrange:["1f00","1fff"]},{category:"general punctuation",hexrange:["2000","206f"]},{category:"superscripts and subscripts",hexrange:["2070","209f"]},{category:"currency symbols",hexrange:["20a0","20cf"]},{category:"combining diacritical marks for symbols",hexrange:["20d0","20ff"]},{category:"letterlike symbols",hexrange:["2100","214f"]},{category:"number forms",hexrange:["2150","218f"]},{category:"arrows",hexrange:["2190","21ff"]},{category:"mathematical operators",hexrange:["2200","22ff"]},{category:"miscellaneous technical",hexrange:["2300","23ff"]},{category:"control pictures",hexrange:["2400","243f"]},{category:"optical character recognition",hexrange:["2440","245f"]},{category:"enclosed alphanumerics",hexrange:["2460","24ff"]},{category:"box drawing",hexrange:["2500","257f"]},{category:"block elements",hexrange:["2580","259f"]},{category:"geometric shapes",hexrange:["25a0","25ff"]},{category:"miscellaneous symbols",hexrange:["2600","26ff"]},{category:"dingbats",hexrange:["2700","27bf"]},{category:"miscellaneous mathematical symbols-a",hexrange:["27c0","27ef"]},{category:"supplemental arrows-a",hexrange:["27f0","27ff"]},{category:"braille patterns",hexrange:["2800","28ff"]},{category:"supplemental arrows-b",hexrange:["2900","297f"]},{category:"miscellaneous mathematical symbols-b",hexrange:["2980","29ff"]},{category:"supplemental mathematical operators",hexrange:["2a00","2aff"]},{category:"miscellaneous symbols and arrows",hexrange:["2b00","2bff"]},{category:"glagolitic",hexrange:["2c00","2c5f"]},{category:"latin extended-c",hexrange:["2c60","2c7f"]},{category:"coptic",hexrange:["2c80","2cff"]},{category:"georgian supplement",hexrange:["2d00","2d2f"]},{category:"tifinagh",hexrange:["2d30","2d7f"]},{category:"ethiopic extended",hexrange:["2d80","2ddf"]},{category:"cyrillic extended-a",hexrange:["2de0","2dff"]},{category:"supplemental punctuation",hexrange:["2e00","2e7f"]},{category:"cjk radicals supplement",hexrange:["2e80","2eff"]},{category:"kangxi radicals",hexrange:["2f00","2fdf"]},{category:"ideographic description characters",hexrange:["2ff0","2fff"]},{category:"cjk symbols and punctuation",hexrange:["3000","303f"]},{category:"hiragana",hexrange:["3040","309f"]},{category:"katakana",hexrange:["30a0","30ff"]},{category:"bopomofo",hexrange:["3100","312f"]},{category:"hangul compatibility jamo",hexrange:["3130","318f"]},{category:"kanbun",hexrange:["3190","319f"]},{category:"bopomofo extended",hexrange:["31a0","31bf"]},{category:"cjk strokes",hexrange:["31c0","31ef"]},{category:"katakana phonetic extensions",hexrange:["31f0","31ff"]},{category:"enclosed cjk letters and months",hexrange:["3200","32ff"]},{category:"cjk compatibility",hexrange:["3300","33ff"]},{category:"cjk unified ideographs extension a",hexrange:["3400","4dbf"]},{category:"yijing hexagram symbols",hexrange:["4dc0","4dff"]},{category:"cjk unified ideographs",hexrange:["4e00","9fff"]},{category:"yi syllables",hexrange:["a000","a48f"]},{category:"yi radicals",hexrange:["a490","a4cf"]},{category:"lisu",hexrange:["a4d0","a4ff"]},{category:"vai",hexrange:["a500","a63f"]},{category:"cyrillic extended-b",hexrange:["a640","a69f"]},{category:"bamum",hexrange:["a6a0","a6ff"]},{category:"modifier tone letters",hexrange:["a700","a71f"]},{category:"latin extended-d",hexrange:["a720","a7ff"]},{category:"syloti nagri",hexrange:["a800","a82f"]},{category:"common indic number forms",hexrange:["a830","a83f"]},{category:"phags-pa",hexrange:["a840","a87f"]},{category:"saurashtra",hexrange:["a880","a8df"]},{category:"devanagari extended",hexrange:["a8e0","a8ff"]},{category:"kayah li",hexrange:["a900","a92f"]},{category:"rejang",hexrange:["a930","a95f"]},{category:"hangul jamo extended-a",hexrange:["a960","a97f"]},{category:"javanese",hexrange:["a980","a9df"]},{category:"myanmar extended-b",hexrange:["a9e0","a9ff"]},{category:"cham",hexrange:["aa00","aa5f"]},{category:"myanmar extended-a",hexrange:["aa60","aa7f"]},{category:"tai viet",hexrange:["aa80","aadf"]},{category:"meetei mayek extensions",hexrange:["aae0","aaff"]},{category:"ethiopic extended-a",hexrange:["ab00","ab2f"]},{category:"latin extended-e",hexrange:["ab30","ab6f"]},{category:"cherokee supplement",hexrange:["ab70","abbf"]},{category:"meetei mayek",hexrange:["abc0","abff"]},{category:"hangul syllables",hexrange:["ac00","d7af"]},{category:"hangul jamo extended-b",hexrange:["d7b0","d7ff"]},{category:"high surrogates",hexrange:["d800","db7f"]},{category:"high private use surrogates",hexrange:["db80","dbff"]},{category:"low surrogates",hexrange:["dc00","dfff"]},{category:"private use area",hexrange:["e000","f8ff"]},{category:"cjk compatibility ideographs",hexrange:["f900","faff"]},{category:"alphabetic presentation forms",hexrange:["fb00","fb4f"]},{category:"arabic presentation forms-a",hexrange:["fb50","fdff"]},{category:"variation selectors",hexrange:["fe00","fe0f"]},{category:"vertical forms",hexrange:["fe10","fe1f"]},{category:"combining half marks",hexrange:["fe20","fe2f"]},{category:"cjk compatibility forms",hexrange:["fe30","fe4f"]},{category:"small form variants",hexrange:["fe50","fe6f"]},{category:"arabic presentation forms-b",hexrange:["fe70","feff"]},{category:"halfwidth and fullwidth forms",hexrange:["ff00","ffef"]},{category:"specials",hexrange:["fff0","ffff"]},{category:"linear b syllabary",hexrange:["10000","1007f"]},{category:"linear b ideograms",hexrange:["10080","100ff"]},{category:"aegean numbers",hexrange:["10100","1013f"]},{category:"ancient greek numbers",hexrange:["10140","1018f"]},{category:"ancient symbols",hexrange:["10190","101cf"]},{category:"phaistos disc",hexrange:["101d0","101ff"]},{category:"lycian",hexrange:["10280","1029f"]},{category:"carian",hexrange:["102a0","102df"]},{category:"coptic epact numbers",hexrange:["102e0","102ff"]},{category:"old italic",hexrange:["10300","1032f"]},{category:"gothic",hexrange:["10330","1034f"]},{category:"old permic",hexrange:["10350","1037f"]},{category:"ugaritic",hexrange:["10380","1039f"]},{category:"old persian",hexrange:["103a0","103df"]},{category:"deseret",hexrange:["10400","1044f"]},{category:"shavian",hexrange:["10450","1047f"]},{category:"osmanya",hexrange:["10480","104af"]},{category:"osage",hexrange:["104b0","104ff"]},{category:"elbasan",hexrange:["10500","1052f"]},{category:"caucasian albanian",hexrange:["10530","1056f"]},{category:"vithkuqi",hexrange:["10570","105bf"]},{category:"linear a",hexrange:["10600","1077f"]},{category:"latin extended-f",hexrange:["10780","107bf"]},{category:"cypriot syllabary",hexrange:["10800","1083f"]},{category:"imperial aramaic",hexrange:["10840","1085f"]},{category:"palmyrene",hexrange:["10860","1087f"]},{category:"nabataean",hexrange:["10880","108af"]},{category:"hatran",hexrange:["108e0","108ff"]},{category:"phoenician",hexrange:["10900","1091f"]},{category:"lydian",hexrange:["10920","1093f"]},{category:"meroitic hieroglyphs",hexrange:["10980","1099f"]},{category:"meroitic cursive",hexrange:["109a0","109ff"]},{category:"kharoshthi",hexrange:["10a00","10a5f"]},{category:"old south arabian",hexrange:["10a60","10a7f"]},{category:"old north arabian",hexrange:["10a80","10a9f"]},{category:"manichaean",hexrange:["10ac0","10aff"]},{category:"avestan",hexrange:["10b00","10b3f"]},{category:"inscriptional parthian",hexrange:["10b40","10b5f"]},{category:"inscriptional pahlavi",hexrange:["10b60","10b7f"]},{category:"psalter pahlavi",hexrange:["10b80","10baf"]},{category:"old turkic",hexrange:["10c00","10c4f"]},{category:"old hungarian",hexrange:["10c80","10cff"]},{category:"hanifi rohingya",hexrange:["10d00","10d3f"]},{category:"rumi numeral symbols",hexrange:["10e60","10e7f"]},{category:"yezidi",hexrange:["10e80","10ebf"]},{category:"arabic extended-c",hexrange:["10ec0","10eff"]},{category:"old sogdian",hexrange:["10f00","10f2f"]},{category:"sogdian",hexrange:["10f30","10f6f"]},{category:"old uyghur",hexrange:["10f70","10faf"]},{category:"chorasmian",hexrange:["10fb0","10fdf"]},{category:"elymaic",hexrange:["10fe0","10fff"]},{category:"brahmi",hexrange:["11000","1107f"]},{category:"kaithi",hexrange:["11080","110cf"]},{category:"sora sompeng",hexrange:["110d0","110ff"]},{category:"chakma",hexrange:["11100","1114f"]},{category:"mahajani",hexrange:["11150","1117f"]},{category:"sharada",hexrange:["11180","111df"]},{category:"sinhala archaic numbers",hexrange:["111e0","111ff"]},{category:"khojki",hexrange:["11200","1124f"]},{category:"multani",hexrange:["11280","112af"]},{category:"khudawadi",hexrange:["112b0","112ff"]},{category:"grantha",hexrange:["11300","1137f"]},{category:"newa",hexrange:["11400","1147f"]},{category:"tirhuta",hexrange:["11480","114df"]},{category:"siddham",hexrange:["11580","115ff"]},{category:"modi",hexrange:["11600","1165f"]},{category:"mongolian supplement",hexrange:["11660","1167f"]},{category:"takri",hexrange:["11680","116cf"]},{category:"ahom",hexrange:["11700","1174f"]},{category:"dogra",hexrange:["11800","1184f"]},{category:"warang citi",hexrange:["118a0","118ff"]},{category:"dives akuru",hexrange:["11900","1195f"]},{category:"nandinagari",hexrange:["119a0","119ff"]},{category:"zanabazar square",hexrange:["11a00","11a4f"]},{category:"soyombo",hexrange:["11a50","11aaf"]},{category:"unified canadian aboriginal syllabics extended-a",hexrange:["11ab0","11abf"]},{category:"pau cin hau",hexrange:["11ac0","11aff"]},{category:"devanagari extended-a",hexrange:["11b00","11b5f"]},{category:"bhaiksuki",hexrange:["11c00","11c6f"]},{category:"marchen",hexrange:["11c70","11cbf"]},{category:"masaram gondi",hexrange:["11d00","11d5f"]},{category:"gunjala gondi",hexrange:["11d60","11daf"]},{category:"makasar",hexrange:["11ee0","11eff"]},{category:"kawi",hexrange:["11f00","11f5f"]},{category:"lisu supplement",hexrange:["11fb0","11fbf"]},{category:"tamil supplement",hexrange:["11fc0","11fff"]},{category:"cuneiform",hexrange:["12000","123ff"]},{category:"cuneiform numbers and punctuation",hexrange:["12400","1247f"]},{category:"early dynastic cuneiform",hexrange:["12480","1254f"]},{category:"cypro-minoan",hexrange:["12f90","12fff"]},{category:"egyptian hieroglyphs",hexrange:["13000","1342f"]},{category:"egyptian hieroglyph format controls",hexrange:["13430","1345f"]},{category:"anatolian hieroglyphs",hexrange:["14400","1467f"]},{category:"bamum supplement",hexrange:["16800","16a3f"]},{category:"mro",hexrange:["16a40","16a6f"]},{category:"tangsa",hexrange:["16a70","16acf"]},{category:"bassa vah",hexrange:["16ad0","16aff"]},{category:"pahawh hmong",hexrange:["16b00","16b8f"]},{category:"medefaidrin",hexrange:["16e40","16e9f"]},{category:"miao",hexrange:["16f00","16f9f"]},{category:"ideographic symbols and punctuation",hexrange:["16fe0","16fff"]},{category:"tangut",hexrange:["17000","187ff"]},{category:"tangut components",hexrange:["18800","18aff"]},{category:"khitan small script",hexrange:["18b00","18cff"]},{category:"tangut supplement",hexrange:["18d00","18d7f"]},{category:"kana extended-b",hexrange:["1aff0","1afff"]},{category:"kana supplement",hexrange:["1b000","1b0ff"]},{category:"kana extended-a",hexrange:["1b100","1b12f"]},{category:"small kana extension",hexrange:["1b130","1b16f"]},{category:"nushu",hexrange:["1b170","1b2ff"]},{category:"duployan",hexrange:["1bc00","1bc9f"]},{category:"shorthand format controls",hexrange:["1bca0","1bcaf"]},{category:"znamenny musical notation",hexrange:["1cf00","1cfcf"]},{category:"byzantine musical symbols",hexrange:["1d000","1d0ff"]},{category:"musical symbols",hexrange:["1d100","1d1ff"]},{category:"ancient greek musical notation",hexrange:["1d200","1d24f"]},{category:"kaktovik numerals",hexrange:["1d2c0","1d2df"]},{category:"mayan numerals",hexrange:["1d2e0","1d2ff"]},{category:"tai xuan jing symbols",hexrange:["1d300","1d35f"]},{category:"counting rod numerals",hexrange:["1d360","1d37f"]},{category:"mathematical alphanumeric symbols",hexrange:["1d400","1d7ff"]},{category:"sutton signwriting",hexrange:["1d800","1daaf"]},{category:"latin extended-g",hexrange:["1df00","1dfff"]},{category:"glagolitic supplement",hexrange:["1e000","1e02f"]},{category:"cyrillic extended-d",hexrange:["1e030","1e08f"]},{category:"nyiakeng puachue hmong",hexrange:["1e100","1e14f"]},{category:"toto",hexrange:["1e290","1e2bf"]},{category:"wancho",hexrange:["1e2c0","1e2ff"]},{category:"nag mundari",hexrange:["1e4d0","1e4ff"]},{category:"ethiopic extended-b",hexrange:["1e7e0","1e7ff"]},{category:"mende kikakui",hexrange:["1e800","1e8df"]},{category:"adlam",hexrange:["1e900","1e95f"]},{category:"indic siyaq numbers",hexrange:["1ec70","1ecbf"]},{category:"ottoman siyaq numbers",hexrange:["1ed00","1ed4f"]},{category:"arabic mathematical alphabetic symbols",hexrange:["1ee00","1eeff"]},{category:"mahjong tiles",hexrange:["1f000","1f02f"]},{category:"domino tiles",hexrange:["1f030","1f09f"]},{category:"playing cards",hexrange:["1f0a0","1f0ff"]},{category:"enclosed alphanumeric supplement",hexrange:["1f100","1f1ff"]},{category:"enclosed ideographic supplement",hexrange:["1f200","1f2ff"]},{category:"miscellaneous symbols and pictographs",hexrange:["1f300","1f5ff"]},{category:"emoticons (emoji)",hexrange:["1f600","1f64f"]},{category:"ornamental dingbats",hexrange:["1f650","1f67f"]},{category:"transport and map symbols",hexrange:["1f680","1f6ff"]},{category:"alchemical symbols",hexrange:["1f700","1f77f"]},{category:"geometric shapes extended",hexrange:["1f780","1f7ff"]},{category:"supplemental arrows-c",hexrange:["1f800","1f8ff"]},{category:"supplemental symbols and pictographs",hexrange:["1f900","1f9ff"]},{category:"chess symbols",hexrange:["1fa00","1fa6f"]},{category:"symbols and pictographs extended-a",hexrange:["1fa70","1faff"]},{category:"symbols for legacy computing",hexrange:["1fb00","1fbff"]},{category:"cjk unified ideographs extension b",hexrange:["20000","2a6df"]},{category:"cjk unified ideographs extension c",hexrange:["2a700","2b73f"]},{category:"cjk unified ideographs extension d",hexrange:["2b740","2b81f"]},{category:"cjk unified ideographs extension e",hexrange:["2b820","2ceaf"]},{category:"cjk unified ideographs extension f",hexrange:["2ceb0","2ebef"]},{category:"cjk unified ideographs extension i",hexrange:["2ebf0","2ee5f"]},{category:"cjk compatibility ideographs supplement",hexrange:["2f800","2fa1f"]},{category:"cjk unified ideographs extension g",hexrange:["30000","3134f"]},{category:"cjk unified ideographs extension h",hexrange:["31350","323af"]},{category:"tags",hexrange:["e0000","e007f"]},{category:"variation selectors supplement",hexrange:["e0100","e01ef"]},{category:"supplementary private use area-a",hexrange:["f0000","fffff"]},{category:"supplementary private use area-b",hexrange:["100000","10ffff"]}];function Vd(r){let t=r.length;for(;--t>=0;)r[t]=0}const Ote=3,Mte=258,xB=29,Lte=256,Bte=Lte+1+xB,bB=30,Pte=512,Vte=new Array((Bte+2)*2);Vd(Vte);const zte=new Array(bB*2);Vd(zte);const Ute=new Array(Pte);Vd(Ute);const Gte=new Array(Mte-Ote+1);Vd(Gte);const jte=new Array(xB);Vd(jte);const Wte=new Array(bB);Vd(Wte);const Hte=(r,t,n,s)=>{let i=r&65535|0,a=r>>>16&65535|0,o=0;for(;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0};var pE=Hte;const qte=()=>{let r,t=[];for(var n=0;n<256;n++){r=n;for(var s=0;s<8;s++)r=r&1?3988292384^r>>>1:r>>>1;t[n]=r}return t},Kte=new Uint32Array(qte()),Xte=(r,t,n,s)=>{const i=Kte,a=s+n;r^=-1;for(let o=s;o<a;o++)r=r>>>8^i[(r^t[o])&255];return r^-1};var mo=Xte,mE={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},vB={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Yte=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var Zte=function(r){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const s in n)Yte(n,s)&&(r[s]=n[s])}}return r},Qte=r=>{let t=0;for(let s=0,i=r.length;s<i;s++)t+=r[s].length;const n=new Uint8Array(t);for(let s=0,i=0,a=r.length;s<a;s++){let o=r[s];n.set(o,i),i+=o.length}return n},wB={assign:Zte,flattenChunks:Qte};let SB=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{SB=!1}const og=new Uint8Array(256);for(let r=0;r<256;r++)og[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;og[254]=og[254]=1;var Jte=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let t,n,s,i,a,o=r.length,u=0;for(i=0;i<o;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<o&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(n=65536+(n-55296<<10)+(s-56320),i++)),u+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(u),a=0,i=0;a<u;i++)n=r.charCodeAt(i),(n&64512)===55296&&i+1<o&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(n=65536+(n-55296<<10)+(s-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t};const ene=(r,t)=>{if(t<65534&&r.subarray&&SB)return String.fromCharCode.apply(null,r.length===t?r:r.subarray(0,t));let n="";for(let s=0;s<t;s++)n+=String.fromCharCode(r[s]);return n};var tne=(r,t)=>{const n=t||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,t));let s,i;const a=new Array(n*2);for(i=0,s=0;s<n;){let o=r[s++];if(o<128){a[i++]=o;continue}let u=og[o];if(u>4){a[i++]=65533,s+=u-1;continue}for(o&=u===2?31:u===3?15:7;u>1&&s<n;)o=o<<6|r[s++]&63,u--;if(u>1){a[i++]=65533;continue}o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|o&1023)}return ene(a,i)},nne=(r,t)=>{t=t||r.length,t>r.length&&(t=r.length);let n=t-1;for(;n>=0&&(r[n]&192)===128;)n--;return n<0||n===0?t:n+og[r[n]]>t?n:t},gE={string2buf:Jte,buf2string:tne,utf8border:nne};function rne(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var sne=rne;const Ey=16209,ine=16191;var ane=function(t,n){let s,i,a,o,u,l,c,h,f,p,g,y,x,v,S,w,E,_,D,I,k,A,N,F;const $=t.state;s=t.next_in,N=t.input,i=s+(t.avail_in-5),a=t.next_out,F=t.output,o=a-(n-t.avail_out),u=a+(t.avail_out-257),l=$.dmax,c=$.wsize,h=$.whave,f=$.wnext,p=$.window,g=$.hold,y=$.bits,x=$.lencode,v=$.distcode,S=(1<<$.lenbits)-1,w=(1<<$.distbits)-1;e:do{y<15&&(g+=N[s++]<<y,y+=8,g+=N[s++]<<y,y+=8),E=x[g&S];t:for(;;){if(_=E>>>24,g>>>=_,y-=_,_=E>>>16&255,_===0)F[a++]=E&65535;else if(_&16){D=E&65535,_&=15,_&&(y<_&&(g+=N[s++]<<y,y+=8),D+=g&(1<<_)-1,g>>>=_,y-=_),y<15&&(g+=N[s++]<<y,y+=8,g+=N[s++]<<y,y+=8),E=v[g&w];n:for(;;){if(_=E>>>24,g>>>=_,y-=_,_=E>>>16&255,_&16){if(I=E&65535,_&=15,y<_&&(g+=N[s++]<<y,y+=8,y<_&&(g+=N[s++]<<y,y+=8)),I+=g&(1<<_)-1,I>l){t.msg="invalid distance too far back",$.mode=Ey;break e}if(g>>>=_,y-=_,_=a-o,I>_){if(_=I-_,_>h&&$.sane){t.msg="invalid distance too far back",$.mode=Ey;break e}if(k=0,A=p,f===0){if(k+=c-_,_<D){D-=_;do F[a++]=p[k++];while(--_);k=a-I,A=F}}else if(f<_){if(k+=c+f-_,_-=f,_<D){D-=_;do F[a++]=p[k++];while(--_);if(k=0,f<D){_=f,D-=_;do F[a++]=p[k++];while(--_);k=a-I,A=F}}}else if(k+=f-_,_<D){D-=_;do F[a++]=p[k++];while(--_);k=a-I,A=F}for(;D>2;)F[a++]=A[k++],F[a++]=A[k++],F[a++]=A[k++],D-=3;D&&(F[a++]=A[k++],D>1&&(F[a++]=A[k++]))}else{k=a-I;do F[a++]=F[k++],F[a++]=F[k++],F[a++]=F[k++],D-=3;while(D>2);D&&(F[a++]=F[k++],D>1&&(F[a++]=F[k++]))}}else if((_&64)===0){E=v[(E&65535)+(g&(1<<_)-1)];continue n}else{t.msg="invalid distance code",$.mode=Ey;break e}break}}else if((_&64)===0){E=x[(E&65535)+(g&(1<<_)-1)];continue t}else if(_&32){$.mode=ine;break e}else{t.msg="invalid literal/length code",$.mode=Ey;break e}break}}while(s<i&&a<u);D=y>>3,s-=D,y-=D<<3,g&=(1<<y)-1,t.next_in=s,t.next_out=a,t.avail_in=s<i?5+(i-s):5-(s-i),t.avail_out=a<u?257+(u-a):257-(a-u),$.hold=g,$.bits=y};const Sf=15,qF=852,KF=592,XF=0,AC=1,YF=2,one=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),une=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lne=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cne=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),hne=(r,t,n,s,i,a,o,u)=>{const l=u.bits;let c=0,h=0,f=0,p=0,g=0,y=0,x=0,v=0,S=0,w=0,E,_,D,I,k,A=null,N;const F=new Uint16Array(Sf+1),$=new Uint16Array(Sf+1);let O=null,M,B,U;for(c=0;c<=Sf;c++)F[c]=0;for(h=0;h<s;h++)F[t[n+h]]++;for(g=l,p=Sf;p>=1&&F[p]===0;p--);if(g>p&&(g=p),p===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,u.bits=1,0;for(f=1;f<p&&F[f]===0;f++);for(g<f&&(g=f),v=1,c=1;c<=Sf;c++)if(v<<=1,v-=F[c],v<0)return-1;if(v>0&&(r===XF||p!==1))return-1;for($[1]=0,c=1;c<Sf;c++)$[c+1]=$[c]+F[c];for(h=0;h<s;h++)t[n+h]!==0&&(o[$[t[n+h]]++]=h);if(r===XF?(A=O=o,N=20):r===AC?(A=one,O=une,N=257):(A=lne,O=cne,N=0),w=0,h=0,c=f,k=a,y=g,x=0,D=-1,S=1<<g,I=S-1,r===AC&&S>qF||r===YF&&S>KF)return 1;for(;;){M=c-x,o[h]+1<N?(B=0,U=o[h]):o[h]>=N?(B=O[o[h]-N],U=A[o[h]-N]):(B=96,U=0),E=1<<c-x,_=1<<y,f=_;do _-=E,i[k+(w>>x)+_]=M<<24|B<<16|U|0;while(_!==0);for(E=1<<c-1;w&E;)E>>=1;if(E!==0?(w&=E-1,w+=E):w=0,h++,--F[c]===0){if(c===p)break;c=t[n+o[h]]}if(c>g&&(w&I)!==D){for(x===0&&(x=g),k+=f,y=c-x,v=1<<y;y+x<p&&(v-=F[y+x],!(v<=0));)y++,v<<=1;if(S+=1<<y,r===AC&&S>qF||r===YF&&S>KF)return 1;D=w&I,i[D]=g<<24|y<<16|k-a|0}}return w!==0&&(i[k+w]=c-x<<24|64<<16|0),u.bits=g,0};var Rm=hne;const fne=0,CB=1,_B=2,{Z_FINISH:ZF,Z_BLOCK:dne,Z_TREES:Dy,Z_OK:eh,Z_STREAM_END:pne,Z_NEED_DICT:mne,Z_STREAM_ERROR:ka,Z_DATA_ERROR:EB,Z_MEM_ERROR:DB,Z_BUF_ERROR:gne,Z_DEFLATED:QF}=vB,hv=16180,JF=16181,eR=16182,tR=16183,nR=16184,rR=16185,sR=16186,iR=16187,aR=16188,oR=16189,Kx=16190,iu=16191,IC=16192,uR=16193,$C=16194,lR=16195,cR=16196,hR=16197,fR=16198,Ty=16199,Ny=16200,dR=16201,pR=16202,mR=16203,gR=16204,yR=16205,FC=16206,xR=16207,bR=16208,Sr=16209,TB=16210,NB=16211,yne=852,xne=592,bne=15,vne=bne,vR=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function wne(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ch=r=>{if(!r)return 1;const t=r.state;return!t||t.strm!==r||t.mode<hv||t.mode>NB?1:0},kB=r=>{if(Ch(r))return ka;const t=r.state;return r.total_in=r.total_out=t.total=0,r.msg="",t.wrap&&(r.adler=t.wrap&1),t.mode=hv,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(yne),t.distcode=t.distdyn=new Int32Array(xne),t.sane=1,t.back=-1,eh},AB=r=>{if(Ch(r))return ka;const t=r.state;return t.wsize=0,t.whave=0,t.wnext=0,kB(r)},IB=(r,t)=>{let n;if(Ch(r))return ka;const s=r.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ka:(s.window!==null&&s.wbits!==t&&(s.window=null),s.wrap=n,s.wbits=t,AB(r))},$B=(r,t)=>{if(!r)return ka;const n=new wne;r.state=n,n.strm=r,n.window=null,n.mode=hv;const s=IB(r,t);return s!==eh&&(r.state=null),s},Sne=r=>$B(r,vne);let wR=!0,RC,OC;const Cne=r=>{if(wR){RC=new Int32Array(512),OC=new Int32Array(32);let t=0;for(;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(Rm(CB,r.lens,0,288,RC,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;Rm(_B,r.lens,0,32,OC,0,r.work,{bits:5}),wR=!1}r.lencode=RC,r.lenbits=9,r.distcode=OC,r.distbits=5},FB=(r,t,n,s)=>{let i;const a=r.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),s>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>s&&(i=s),a.window.set(t.subarray(n-s,n-s+i),a.wnext),s-=i,s?(a.window.set(t.subarray(n-s,n),0),a.wnext=s,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},_ne=(r,t)=>{let n,s,i,a,o,u,l,c,h,f,p,g,y,x,v=0,S,w,E,_,D,I,k,A;const N=new Uint8Array(4);let F,$;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ch(r)||!r.output||!r.input&&r.avail_in!==0)return ka;n=r.state,n.mode===iu&&(n.mode=IC),o=r.next_out,i=r.output,l=r.avail_out,a=r.next_in,s=r.input,u=r.avail_in,c=n.hold,h=n.bits,f=u,p=l,A=eh;e:for(;;)switch(n.mode){case hv:if(n.wrap===0){n.mode=IC;break}for(;h<16;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(n.wrap&2&&c===35615){n.wbits===0&&(n.wbits=15),n.check=0,N[0]=c&255,N[1]=c>>>8&255,n.check=mo(n.check,N,2,0),c=0,h=0,n.mode=JF;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){r.msg="incorrect header check",n.mode=Sr;break}if((c&15)!==QF){r.msg="unknown compression method",n.mode=Sr;break}if(c>>>=4,h-=4,k=(c&15)+8,n.wbits===0&&(n.wbits=k),k>15||k>n.wbits){r.msg="invalid window size",n.mode=Sr;break}n.dmax=1<<n.wbits,n.flags=0,r.adler=n.check=1,n.mode=c&512?oR:iu,c=0,h=0;break;case JF:for(;h<16;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(n.flags=c,(n.flags&255)!==QF){r.msg="unknown compression method",n.mode=Sr;break}if(n.flags&57344){r.msg="unknown header flags set",n.mode=Sr;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&n.wrap&4&&(N[0]=c&255,N[1]=c>>>8&255,n.check=mo(n.check,N,2,0)),c=0,h=0,n.mode=eR;case eR:for(;h<32;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.head&&(n.head.time=c),n.flags&512&&n.wrap&4&&(N[0]=c&255,N[1]=c>>>8&255,N[2]=c>>>16&255,N[3]=c>>>24&255,n.check=mo(n.check,N,4,0)),c=0,h=0,n.mode=tR;case tR:for(;h<16;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&n.wrap&4&&(N[0]=c&255,N[1]=c>>>8&255,n.check=mo(n.check,N,2,0)),c=0,h=0,n.mode=nR;case nR:if(n.flags&1024){for(;h<16;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&n.wrap&4&&(N[0]=c&255,N[1]=c>>>8&255,n.check=mo(n.check,N,2,0)),c=0,h=0}else n.head&&(n.head.extra=null);n.mode=rR;case rR:if(n.flags&1024&&(g=n.length,g>u&&(g=u),g&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(s.subarray(a,a+g),k)),n.flags&512&&n.wrap&4&&(n.check=mo(n.check,s,g,a)),u-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=sR;case sR:if(n.flags&2048){if(u===0)break e;g=0;do k=s[a+g++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k));while(k&&g<u);if(n.flags&512&&n.wrap&4&&(n.check=mo(n.check,s,g,a)),u-=g,a+=g,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=iR;case iR:if(n.flags&4096){if(u===0)break e;g=0;do k=s[a+g++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k));while(k&&g<u);if(n.flags&512&&n.wrap&4&&(n.check=mo(n.check,s,g,a)),u-=g,a+=g,k)break e}else n.head&&(n.head.comment=null);n.mode=aR;case aR:if(n.flags&512){for(;h<16;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(n.wrap&4&&c!==(n.check&65535)){r.msg="header crc mismatch",n.mode=Sr;break}c=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),r.adler=n.check=0,n.mode=iu;break;case oR:for(;h<32;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}r.adler=n.check=vR(c),c=0,h=0,n.mode=Kx;case Kx:if(n.havedict===0)return r.next_out=o,r.avail_out=l,r.next_in=a,r.avail_in=u,n.hold=c,n.bits=h,mne;r.adler=n.check=1,n.mode=iu;case iu:if(t===dne||t===Dy)break e;case IC:if(n.last){c>>>=h&7,h-=h&7,n.mode=FC;break}for(;h<3;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}switch(n.last=c&1,c>>>=1,h-=1,c&3){case 0:n.mode=uR;break;case 1:if(Cne(n),n.mode=Ty,t===Dy){c>>>=2,h-=2;break e}break;case 2:n.mode=cR;break;case 3:r.msg="invalid block type",n.mode=Sr}c>>>=2,h-=2;break;case uR:for(c>>>=h&7,h-=h&7;h<32;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){r.msg="invalid stored block lengths",n.mode=Sr;break}if(n.length=c&65535,c=0,h=0,n.mode=$C,t===Dy)break e;case $C:n.mode=lR;case lR:if(g=n.length,g){if(g>u&&(g=u),g>l&&(g=l),g===0)break e;i.set(s.subarray(a,a+g),o),u-=g,a+=g,l-=g,o+=g,n.length-=g;break}n.mode=iu;break;case cR:for(;h<14;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(n.nlen=(c&31)+257,c>>>=5,h-=5,n.ndist=(c&31)+1,c>>>=5,h-=5,n.ncode=(c&15)+4,c>>>=4,h-=4,n.nlen>286||n.ndist>30){r.msg="too many length or distance symbols",n.mode=Sr;break}n.have=0,n.mode=hR;case hR:for(;n.have<n.ncode;){for(;h<3;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.lens[O[n.have++]]=c&7,c>>>=3,h-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,F={bits:n.lenbits},A=Rm(fne,n.lens,0,19,n.lencode,0,n.work,F),n.lenbits=F.bits,A){r.msg="invalid code lengths set",n.mode=Sr;break}n.have=0,n.mode=fR;case fR:for(;n.have<n.nlen+n.ndist;){for(;v=n.lencode[c&(1<<n.lenbits)-1],S=v>>>24,w=v>>>16&255,E=v&65535,!(S<=h);){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(E<16)c>>>=S,h-=S,n.lens[n.have++]=E;else{if(E===16){for($=S+2;h<$;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(c>>>=S,h-=S,n.have===0){r.msg="invalid bit length repeat",n.mode=Sr;break}k=n.lens[n.have-1],g=3+(c&3),c>>>=2,h-=2}else if(E===17){for($=S+3;h<$;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}c>>>=S,h-=S,k=0,g=3+(c&7),c>>>=3,h-=3}else{for($=S+7;h<$;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}c>>>=S,h-=S,k=0,g=11+(c&127),c>>>=7,h-=7}if(n.have+g>n.nlen+n.ndist){r.msg="invalid bit length repeat",n.mode=Sr;break}for(;g--;)n.lens[n.have++]=k}}if(n.mode===Sr)break;if(n.lens[256]===0){r.msg="invalid code -- missing end-of-block",n.mode=Sr;break}if(n.lenbits=9,F={bits:n.lenbits},A=Rm(CB,n.lens,0,n.nlen,n.lencode,0,n.work,F),n.lenbits=F.bits,A){r.msg="invalid literal/lengths set",n.mode=Sr;break}if(n.distbits=6,n.distcode=n.distdyn,F={bits:n.distbits},A=Rm(_B,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,F),n.distbits=F.bits,A){r.msg="invalid distances set",n.mode=Sr;break}if(n.mode=Ty,t===Dy)break e;case Ty:n.mode=Ny;case Ny:if(u>=6&&l>=258){r.next_out=o,r.avail_out=l,r.next_in=a,r.avail_in=u,n.hold=c,n.bits=h,ane(r,p),o=r.next_out,i=r.output,l=r.avail_out,a=r.next_in,s=r.input,u=r.avail_in,c=n.hold,h=n.bits,n.mode===iu&&(n.back=-1);break}for(n.back=0;v=n.lencode[c&(1<<n.lenbits)-1],S=v>>>24,w=v>>>16&255,E=v&65535,!(S<=h);){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(w&&(w&240)===0){for(_=S,D=w,I=E;v=n.lencode[I+((c&(1<<_+D)-1)>>_)],S=v>>>24,w=v>>>16&255,E=v&65535,!(_+S<=h);){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}c>>>=_,h-=_,n.back+=_}if(c>>>=S,h-=S,n.back+=S,n.length=E,w===0){n.mode=yR;break}if(w&32){n.back=-1,n.mode=iu;break}if(w&64){r.msg="invalid literal/length code",n.mode=Sr;break}n.extra=w&15,n.mode=dR;case dR:if(n.extra){for($=n.extra;h<$;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=pR;case pR:for(;v=n.distcode[c&(1<<n.distbits)-1],S=v>>>24,w=v>>>16&255,E=v&65535,!(S<=h);){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if((w&240)===0){for(_=S,D=w,I=E;v=n.distcode[I+((c&(1<<_+D)-1)>>_)],S=v>>>24,w=v>>>16&255,E=v&65535,!(_+S<=h);){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}c>>>=_,h-=_,n.back+=_}if(c>>>=S,h-=S,n.back+=S,w&64){r.msg="invalid distance code",n.mode=Sr;break}n.offset=E,n.extra=w&15,n.mode=mR;case mR:if(n.extra){for($=n.extra;h<$;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){r.msg="invalid distance too far back",n.mode=Sr;break}n.mode=gR;case gR:if(l===0)break e;if(g=p-l,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){r.msg="invalid distance too far back",n.mode=Sr;break}g>n.wnext?(g-=n.wnext,y=n.wsize-g):y=n.wnext-g,g>n.length&&(g=n.length),x=n.window}else x=i,y=o-n.offset,g=n.length;g>l&&(g=l),l-=g,n.length-=g;do i[o++]=x[y++];while(--g);n.length===0&&(n.mode=Ny);break;case yR:if(l===0)break e;i[o++]=n.length,l--,n.mode=Ny;break;case FC:if(n.wrap){for(;h<32;){if(u===0)break e;u--,c|=s[a++]<<h,h+=8}if(p-=l,r.total_out+=p,n.total+=p,n.wrap&4&&p&&(r.adler=n.check=n.flags?mo(n.check,i,p,o-p):pE(n.check,i,p,o-p)),p=l,n.wrap&4&&(n.flags?c:vR(c))!==n.check){r.msg="incorrect data check",n.mode=Sr;break}c=0,h=0}n.mode=xR;case xR:if(n.wrap&&n.flags){for(;h<32;){if(u===0)break e;u--,c+=s[a++]<<h,h+=8}if(n.wrap&4&&c!==(n.total&4294967295)){r.msg="incorrect length check",n.mode=Sr;break}c=0,h=0}n.mode=bR;case bR:A=pne;break e;case Sr:A=EB;break e;case TB:return DB;case NB:default:return ka}return r.next_out=o,r.avail_out=l,r.next_in=a,r.avail_in=u,n.hold=c,n.bits=h,(n.wsize||p!==r.avail_out&&n.mode<Sr&&(n.mode<FC||t!==ZF))&&FB(r,r.output,r.next_out,p-r.avail_out),f-=r.avail_in,p-=r.avail_out,r.total_in+=f,r.total_out+=p,n.total+=p,n.wrap&4&&p&&(r.adler=n.check=n.flags?mo(n.check,i,p,r.next_out-p):pE(n.check,i,p,r.next_out-p)),r.data_type=n.bits+(n.last?64:0)+(n.mode===iu?128:0)+(n.mode===Ty||n.mode===$C?256:0),(f===0&&p===0||t===ZF)&&A===eh&&(A=gne),A},Ene=r=>{if(Ch(r))return ka;let t=r.state;return t.window&&(t.window=null),r.state=null,eh},Dne=(r,t)=>{if(Ch(r))return ka;const n=r.state;return(n.wrap&2)===0?ka:(n.head=t,t.done=!1,eh)},Tne=(r,t)=>{const n=t.length;let s,i,a;return Ch(r)||(s=r.state,s.wrap!==0&&s.mode!==Kx)?ka:s.mode===Kx&&(i=1,i=pE(i,t,n,0),i!==s.check)?EB:(a=FB(r,t,n,n),a?(s.mode=TB,DB):(s.havedict=1,eh))};var Nne=AB,kne=IB,Ane=kB,Ine=Sne,$ne=$B,Fne=_ne,Rne=Ene,One=Dne,Mne=Tne,Lne="pako inflate (from Nodeca project)",ou={inflateReset:Nne,inflateReset2:kne,inflateResetKeep:Ane,inflateInit:Ine,inflateInit2:$ne,inflate:Fne,inflateEnd:Rne,inflateGetHeader:One,inflateSetDictionary:Mne,inflateInfo:Lne};function Bne(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Pne=Bne;const RB=Object.prototype.toString,{Z_NO_FLUSH:Vne,Z_FINISH:zne,Z_OK:ug,Z_STREAM_END:MC,Z_NEED_DICT:LC,Z_STREAM_ERROR:Une,Z_DATA_ERROR:SR,Z_MEM_ERROR:Gne}=vB;function fv(r){this.options=wB.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(r&&r.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new sne,this.strm.avail_out=0;let n=ou.inflateInit2(this.strm,t.windowBits);if(n!==ug)throw new Error(mE[n]);if(this.header=new Pne,ou.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=gE.string2buf(t.dictionary):RB.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=ou.inflateSetDictionary(this.strm,t.dictionary),n!==ug)))throw new Error(mE[n])}fv.prototype.push=function(r,t){const n=this.strm,s=this.options.chunkSize,i=this.options.dictionary;let a,o,u;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?zne:Vne,RB.call(r)==="[object ArrayBuffer]"?n.input=new Uint8Array(r):n.input=r,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(s),n.next_out=0,n.avail_out=s),a=ou.inflate(n,o),a===LC&&i&&(a=ou.inflateSetDictionary(n,i),a===ug?a=ou.inflate(n,o):a===SR&&(a=LC));n.avail_in>0&&a===MC&&n.state.wrap>0&&r[n.next_in]!==0;)ou.inflateReset(n),a=ou.inflate(n,o);switch(a){case Une:case SR:case LC:case Gne:return this.onEnd(a),this.ended=!0,!1}if(u=n.avail_out,n.next_out&&(n.avail_out===0||a===MC))if(this.options.to==="string"){let l=gE.utf8border(n.output,n.next_out),c=n.next_out-l,h=gE.buf2string(n.output,l);n.next_out=c,n.avail_out=s-c,c&&n.output.set(n.output.subarray(l,l+c),0),this.onData(h)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(a===ug&&u===0)){if(a===MC)return a=ou.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};fv.prototype.onData=function(r){this.chunks.push(r)};fv.prototype.onEnd=function(r){r===ug&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wB.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function jne(r,t){const n=new fv(t);if(n.push(r),n.err)throw n.msg||mE[n.err];return n.result}var Wne=jne,Hne={inflate:Wne};const{inflate:qne}=Hne;var Kne=qne;const OB={inflate:Kne};var it={};it.parse=function(r){var t=it.B,n=function(_,D,I,k){var A=it.T,N={cmap:A.cmap,head:A.head,hhea:A.hhea,maxp:A.maxp,hmtx:A.hmtx,name:A.name,"OS/2":A.OS2,post:A.post,loca:A.loca,kern:A.kern,glyf:A.glyf,"CFF ":A.CFF,GSUB:A.GSUB,CBLC:A.CBLC,CBDT:A.CBDT,"SVG ":A.SVG,COLR:A.colr,CPAL:A.cpal,sbix:A.sbix,fvar:A.fvar,gvar:A.gvar,avar:A.avar,HVAR:A.HVAR},F={_data:_,_index:D,_offset:I};for(var $ in N){var O=it.findTable(_,$,I);if(O){var M=O[0],B=k[M];B==null&&(B=N[$].parseTab(_,M,O[1],F)),F[$]=k[M]=B}}return F};function s(_){var D=t.readUshort(_,12),I=t.readUint(_,16),k=new Uint8Array(I),A=12+D*16;t.writeASCII(k,0,"OTTO"),t.writeUshort(k,4,D);for(var N=44,F=0;F<D;F++){var $=t.readASCII(_,N,4),O=t.readUint(_,N+4),M=t.readUint(_,N+8),B=t.readUint(_,N+12);N+=20;var U=_.slice(O,O+M);M!=B&&(U=OB.inflate(U));var V=12+F*16;t.writeASCII(k,V,$),t.writeUint(k,V+8,A),t.writeUint(k,V+12,B),k.set(U,A),A+=B}return k}var i=new Uint8Array(r);let a;i[0]==119&&(a=i,i=s(i));var o={},u=t.readASCII(i,0,4);if(u=="ttcf"){var l=4;t.readUshort(i,l),l+=2,t.readUshort(i,l),l+=2;var c=t.readUint(i,l);l+=4;for(var h=[],f=0;f<c;f++){var p=t.readUint(i,l);l+=4,h.push(n(i,f,p,o))}return h}var g=n(i,0,0,o);g._compressedData=a;var y=g.fvar;if(y){for(var x=[g],f=0;f<y[1].length;f++){var v=y[1][f],S={};x.push(S);for(var w in g)S[w]=g[w];S._index=f;var E=S.name=JSON.parse(JSON.stringify(S.name));E.fontSubfamily=v[0],v[3]==null&&(v[3]=(E.fontFamily+"-"+E.fontSubfamily).replaceAll(" ","")),E.postScriptName=v[3]}return x}return[g]};it.findTable=function(r,t,n){for(var s=it.B,i=s.readUshort(r,n+4),a=n+12,o=0;o<i;o++){var u=s.readASCII(r,a,4);s.readUint(r,a+4);var l=s.readUint(r,a+8),c=s.readUint(r,a+12);if(u==t)return[l,c];a+=16}return null};it.T={};it.B={readFixed:function(r,t){return(r[t]<<8|r[t+1])+(r[t+2]<<8|r[t+3])/(256*256+4)},readF2dot14:function(r,t){var n=it.B.readShort(r,t);return n/16384},readInt:function(r,t){var n=it.B.t.uint8;return n[0]=r[t+3],n[1]=r[t+2],n[2]=r[t+1],n[3]=r[t],it.B.t.int32[0]},readInt8:function(r,t){var n=it.B.t.uint8;return n[0]=r[t],it.B.t.int8[0]},readShort:function(r,t){var n=it.B.t.uint16;return n[0]=r[t]<<8|r[t+1],it.B.t.int16[0]},readUshort:function(r,t){return r[t]<<8|r[t+1]},writeUshort:function(r,t,n){r[t]=n>>8&255,r[t+1]=n&255},readUshorts:function(r,t,n){for(var s=[],i=0;i<n;i++){var a=it.B.readUshort(r,t+i*2);s.push(a)}return s},readUint:function(r,t){var n=it.B.t.uint8;return n[3]=r[t],n[2]=r[t+1],n[1]=r[t+2],n[0]=r[t+3],it.B.t.uint32[0]},writeUint:function(r,t,n){r[t]=n>>24&255,r[t+1]=n>>16&255,r[t+2]=n>>8&255,r[t+3]=n>>0&255},readUint64:function(r,t){return it.B.readUint(r,t)*4294967296+it.B.readUint(r,t+4)},readASCII:function(r,t,n){for(var s="",i=0;i<n;i++)s+=String.fromCharCode(r[t+i]);return s},writeASCII:function(r,t,n){for(var s=0;s<n.length;s++)r[t+s]=n.charCodeAt(s)},readUnicode:function(r,t,n){for(var s="",i=0;i<n;i++){var a=r[t++]<<8|r[t++];s+=String.fromCharCode(a)}return s},_tdec:window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,t,n){var s=it.B._tdec;return s&&t==0&&n==r.length?s.decode(r):it.B.readASCII(r,t,n)},readBytes:function(r,t,n){for(var s=[],i=0;i<n;i++)s.push(r[t+i]);return s},readASCIIArray:function(r,t,n){for(var s=[],i=0;i<n;i++)s.push(String.fromCharCode(r[t+i]));return s},t:function(){var r=new ArrayBuffer(8);return{buff:r,int8:new Int8Array(r),uint8:new Uint8Array(r),int16:new Int16Array(r),uint16:new Uint16Array(r),int32:new Int32Array(r),uint32:new Uint32Array(r)}}()};it.T.CFF={parseTab:function(r,t,n){var s=it.B,i=it.T.CFF;r=new Uint8Array(r.buffer,t,n),t=0,r[t],t++,r[t],t++,r[t],t++,r[t],t++;var a=[];t=i.readIndex(r,t,a);for(var o=[],u=0;u<a.length-1;u++)o.push(s.readASCII(r,t+a[u],a[u+1]-a[u]));t+=a[a.length-1];var l=[];t=i.readIndex(r,t,l);for(var c=[],u=0;u<l.length-1;u++)c.push(i.readDict(r,t+l[u],t+l[u+1]));t+=l[l.length-1];var h=c[0],f=[];t=i.readIndex(r,t,f);for(var p=[],u=0;u<f.length-1;u++)p.push(s.readASCII(r,t+f[u],f[u+1]-f[u]));if(t+=f[f.length-1],i.readSubrs(r,t,h),h.CharStrings&&(h.CharStrings=i.readBytes(r,h.CharStrings)),h.ROS){t=h.FDArray;var g=[];t=i.readIndex(r,t,g),h.FDArray=[];for(var u=0;u<g.length-1;u++){var y=i.readDict(r,t+g[u],t+g[u+1]);i._readFDict(r,y,p),h.FDArray.push(y)}t+=g[g.length-1],t=h.FDSelect,h.FDSelect=[];var x=r[t];if(t++,x==3){var v=s.readUshort(r,t);t+=2;for(var u=0;u<v+1;u++)h.FDSelect.push(s.readUshort(r,t),r[t+2]),t+=3}else throw x}return h.charset&&(h.charset=i.readCharset(r,h.charset,h.CharStrings.length)),i._readFDict(r,h,p),h},_readFDict:function(r,t,n){var s=it.T.CFF,i;t.Private&&(i=t.Private[1],t.Private=s.readDict(r,i,i+t.Private[0]),t.Private.Subrs&&s.readSubrs(r,i+t.Private.Subrs,t.Private));for(var a in t)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)!=-1&&(t[a]=n[t[a]-426+35])},readSubrs:function(r,t,n){n.Subrs=it.T.CFF.readBytes(r,t);var s,i=n.Subrs.length+1;i<1240?s=107:i<33900?s=1131:s=32768,n.Bias=s},readBytes:function(r,t){it.B;var n=[];t=it.T.CFF.readIndex(r,t,n);for(var s=[],i=n.length-1,a=r.byteOffset+t,o=0;o<i;o++){var u=n[o];s.push(new Uint8Array(r.buffer,a+u,n[o+1]-u))}return s},tableSE:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],glyphByUnicode:function(r,t){for(var n=0;n<r.charset.length;n++)if(r.charset[n]==t)return n;return-1},glyphBySE:function(r,t){return t<0||t>255?-1:it.T.CFF.glyphByUnicode(r,it.T.CFF.tableSE[t])},readCharset:function(r,t,n){var s=it.B,i=[".notdef"],a=r[t];if(t++,a==0)for(var o=0;o<n;o++){var u=s.readUshort(r,t);t+=2,i.push(u)}else if(a==1||a==2)for(;i.length<n;){var u=s.readUshort(r,t);t+=2;var l=0;a==1?(l=r[t],t++):(l=s.readUshort(r,t),t+=2);for(var o=0;o<=l;o++)i.push(u),u++}else throw"error: format: "+a;return i},readIndex:function(r,t,n){var s=it.B,i=s.readUshort(r,t)+1;t+=2;var a=r[t];if(t++,a==1)for(var o=0;o<i;o++)n.push(r[t+o]);else if(a==2)for(var o=0;o<i;o++)n.push(s.readUshort(r,t+o*2));else if(a==3)for(var o=0;o<i;o++)n.push(s.readUint(r,t+o*3-1)&16777215);else if(a==4)for(var o=0;o<i;o++)n.push(s.readUint(r,t+o*4));else if(i!=1)throw"unsupported offset size: "+a+", count: "+i;return t+=i*a,t-1},getCharString:function(r,t,n){var s=it.B,i=r[t],a=r[t+1];r[t+2],r[t+3],r[t+4];var o=1,u=null,l=null;i<=20&&(u=i,o=1),i==12&&(u=i*100+a,o=2),21<=i&&i<=27&&(u=i,o=1),i==28&&(l=s.readShort(r,t+1),o=3),29<=i&&i<=31&&(u=i,o=1),32<=i&&i<=246&&(l=i-139,o=1),247<=i&&i<=250&&(l=(i-247)*256+a+108,o=2),251<=i&&i<=254&&(l=-(i-251)*256-a-108,o=2),i==255&&(l=s.readInt(r,t+1)/65535,o=5),n.val=l??"o"+u,n.size=o},readCharString:function(r,t,n){for(var s=t+n,i=it.B,a=[];t<s;){var o=r[t],u=r[t+1];r[t+2],r[t+3],r[t+4];var l=1,c=null,h=null;o<=20&&(c=o,l=1),o==12&&(c=o*100+u,l=2),(o==19||o==20)&&(c=o,l=2),21<=o&&o<=27&&(c=o,l=1),o==28&&(h=i.readShort(r,t+1),l=3),29<=o&&o<=31&&(c=o,l=1),32<=o&&o<=246&&(h=o-139,l=1),247<=o&&o<=250&&(h=(o-247)*256+u+108,l=2),251<=o&&o<=254&&(h=-(o-251)*256-u-108,l=2),o==255&&(h=i.readInt(r,t+1)/65535,l=5),a.push(h??"o"+c),t+=l}return a},readDict:function(r,t,n){for(var s=it.B,i={},a=[];t<n;){var o=r[t],u=r[t+1];r[t+2],r[t+3],r[t+4];var l=1,c=null,h=null;if(o==28&&(h=s.readShort(r,t+1),l=3),o==29&&(h=s.readInt(r,t+1),l=5),32<=o&&o<=246&&(h=o-139,l=1),247<=o&&o<=250&&(h=(o-247)*256+u+108,l=2),251<=o&&o<=254&&(h=-(o-251)*256-u-108,l=2),o==255)throw h=s.readInt(r,t+1)/65535,l=5,"unknown number";if(o==30){var f=[];for(l=1;;){var p=r[t+l];l++;var g=p>>4,y=p&15;if(g!=15&&f.push(g),y!=15&&f.push(y),y==15)break}for(var x="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],S=0;S<f.length;S++)x+=v[f[S]];h=parseFloat(x)}if(o<=21){var w=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"];if(c=w[o],l=1,o==12){var w=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold","","","LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend","","","","","","","ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"];c=w[u],l=2}}c!=null?(i[c]=a.length==1?a[0]:a,a=[]):a.push(h),t+=l}return i}};it.T.cmap={parseTab:function(r,t,n){var s={tables:[],ids:{},off:t};r=new Uint8Array(r.buffer,t,n),t=0;var i=it.B,a=i.readUshort,o=it.T.cmap;a(r,t),t+=2;var u=a(r,t);t+=2;for(var l=[],c=0;c<u;c++){var h=a(r,t);t+=2;var f=a(r,t);t+=2;var p=i.readUint(r,t);t+=4;var g="p"+h+"e"+f,y=l.indexOf(p);if(y==-1){y=s.tables.length;var x={};l.push(p);var v=x.format=a(r,p);v==0?x=o.parse0(r,p,x):v==4?x=o.parse4(r,p,x):v==6?x=o.parse6(r,p,x):v==12&&(x=o.parse12(r,p,x)),s.tables.push(x)}s.ids[g]!=null&&console.log("multiple tables for one platform+encoding: "+g),s.ids[g]=y}return s},parse0:function(r,t,n){var s=it.B;t+=2;var i=s.readUshort(r,t);t+=2,s.readUshort(r,t),t+=2,n.map=[];for(var a=0;a<i-6;a++)n.map.push(r[t+a]);return n},parse4:function(r,t,n){var s=it.B,i=s.readUshort,a=s.readUshorts,o=t;t+=2;var u=i(r,t);t+=2,i(r,t),t+=2;var l=i(r,t);t+=2;var c=l>>>1;n.searchRange=i(r,t),t+=2,n.entrySelector=i(r,t),t+=2,n.rangeShift=i(r,t),t+=2,n.endCount=a(r,t,c),t+=c*2,t+=2,n.startCount=a(r,t,c),t+=c*2,n.idDelta=[];for(var h=0;h<c;h++)n.idDelta.push(s.readShort(r,t)),t+=2;return n.idRangeOffset=a(r,t,c),t+=c*2,n.glyphIdArray=a(r,t,o+u-t>>1),n},parse6:function(r,t,n){var s=it.B;t+=2,s.readUshort(r,t),t+=2,s.readUshort(r,t),t+=2,n.firstCode=s.readUshort(r,t),t+=2;var i=s.readUshort(r,t);t+=2,n.glyphIdArray=[];for(var a=0;a<i;a++)n.glyphIdArray.push(s.readUshort(r,t)),t+=2;return n},parse12:function(r,t,n){var s=it.B,i=s.readUint;t+=4,i(r,t),t+=4,i(r,t),t+=4;var a=i(r,t)*3;t+=4;for(var o=n.groups=new Uint32Array(a),u=0;u<a;u+=3)o[u]=i(r,t+(u<<2)),o[u+1]=i(r,t+(u<<2)+4),o[u+2]=i(r,t+(u<<2)+8);return n}};it.T.CBLC={parseTab:function(r,t,n){var s=it.B,i=t;s.readUshort(r,t),t+=2,s.readUshort(r,t),t+=2;var a=s.readUint(r,t);t+=4;for(var o=[],u=0;u<a;u++){var l=s.readUint(r,t);t+=4,s.readUint(r,t),t+=4,s.readUint(r,t),t+=4,t+=4,t+=2*12,s.readUshort(r,t),t+=2,s.readUshort(r,t),t+=2,t+=4;for(var c=i+l,h=0;h<3;h++){var f=s.readUshort(r,c);c+=2;var p=s.readUshort(r,c);c+=2;var g=s.readUint(r,c);c+=4;var y=p-f+1,x=i+l+g,v=s.readUshort(r,x);if(x+=2,v!=1)throw v;var S=s.readUshort(r,x);x+=2;var w=s.readUint(r,x);x+=4;for(var E=[],_=0;_<y;_++){var D=s.readUint(r,x+_*4);E.push(w+D)}o.push([f,p,S,E])}}return o}};it.T.CBDT={parseTab:function(r,t,n){return it.B,new Uint8Array(r.buffer,r.byteOffset+t,n)}};it.T.glyf={parseTab:function(r,t,n,s){for(var i=[],a=s.maxp.numGlyphs,o=0;o<a;o++)i.push(null);return i},_parseGlyf:function(r,t){var n=it.B,s=r._data,i=r.loca;if(i[t]==i[t+1])return null;var a=it.findTable(s,"glyf",r._offset)[0]+i[t],o={};if(o.noc=n.readShort(s,a),a+=2,o.xMin=n.readShort(s,a),a+=2,o.yMin=n.readShort(s,a),a+=2,o.xMax=n.readShort(s,a),a+=2,o.yMax=n.readShort(s,a),a+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var u=0;u<o.noc;u++)o.endPts.push(n.readUshort(s,a)),a+=2;var l=n.readUshort(s,a);if(a+=2,s.length-a<l)return null;o.instructions=n.readBytes(s,a,l),a+=l;var c=o.endPts[o.noc-1]+1;o.flags=[];for(var u=0;u<c;u++){var h=s[a];if(a++,o.flags.push(h),(h&8)!=0){var f=s[a];a++;for(var p=0;p<f;p++)o.flags.push(h),u++}}o.xs=[];for(var u=0;u<c;u++){var g=(o.flags[u]&2)!=0,y=(o.flags[u]&16)!=0;g?(o.xs.push(y?s[a]:-s[a]),a++):y?o.xs.push(0):(o.xs.push(n.readShort(s,a)),a+=2)}o.ys=[];for(var u=0;u<c;u++){var g=(o.flags[u]&4)!=0,y=(o.flags[u]&32)!=0;g?(o.ys.push(y?s[a]:-s[a]),a++):y?o.ys.push(0):(o.ys.push(n.readShort(s,a)),a+=2)}for(var x=0,v=0,u=0;u<c;u++)x+=o.xs[u],v+=o.ys[u],o.xs[u]=x,o.ys[u]=v}else{var S=1,w=2,E=8,_=32,D=64,I=128,k=256;o.parts=[];var A;do{A=n.readUshort(s,a),a+=2;var N={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(N),N.glyphIndex=n.readUshort(s,a),a+=2,A&S){var F=n.readShort(s,a);a+=2;var $=n.readShort(s,a);a+=2}else{var F=n.readInt8(s,a);a++;var $=n.readInt8(s,a);a++}A&w?(N.m.tx=F,N.m.ty=$):(N.p1=F,N.p2=$),A&E?(N.m.a=N.m.d=n.readF2dot14(s,a),a+=2):A&D?(N.m.a=n.readF2dot14(s,a),a+=2,N.m.d=n.readF2dot14(s,a),a+=2):A&I&&(N.m.a=n.readF2dot14(s,a),a+=2,N.m.b=n.readF2dot14(s,a),a+=2,N.m.c=n.readF2dot14(s,a),a+=2,N.m.d=n.readF2dot14(s,a),a+=2)}while(A&_);if(A&k){var O=n.readUshort(s,a);a+=2,o.instr=[];for(var u=0;u<O;u++)o.instr.push(s[a]),a++}}return o}};it.T.head={parseTab:function(r,t,n){var s=it.B,i={};return s.readFixed(r,t),t+=4,i.fontRevision=s.readFixed(r,t),t+=4,s.readUint(r,t),t+=4,s.readUint(r,t),t+=4,i.flags=s.readUshort(r,t),t+=2,i.unitsPerEm=s.readUshort(r,t),t+=2,i.created=s.readUint64(r,t),t+=8,i.modified=s.readUint64(r,t),t+=8,i.xMin=s.readShort(r,t),t+=2,i.yMin=s.readShort(r,t),t+=2,i.xMax=s.readShort(r,t),t+=2,i.yMax=s.readShort(r,t),t+=2,i.macStyle=s.readUshort(r,t),t+=2,i.lowestRecPPEM=s.readUshort(r,t),t+=2,i.fontDirectionHint=s.readShort(r,t),t+=2,i.indexToLocFormat=s.readShort(r,t),t+=2,i.glyphDataFormat=s.readShort(r,t),t+=2,i}};it.T.hhea={parseTab:function(r,t,n){var s=it.B,i={};s.readFixed(r,t),t+=4;for(var a=["ascender","descender","lineGap","advanceWidthMax","minLeftSideBearing","minRightSideBearing","xMaxExtent","caretSlopeRise","caretSlopeRun","caretOffset","res0","res1","res2","res3","metricDataFormat","numberOfHMetrics"],o=0;o<a.length;o++){var u=a[o],l=u=="advanceWidthMax"||u=="numberOfHMetrics"?s.readUshort:s.readShort;i[u]=l(r,t+o*2)}return i}};it.T.hmtx={parseTab:function(r,t,n,s){for(var i=it.B,a=[],o=[],u=s.maxp.numGlyphs,l=s.hhea.numberOfHMetrics,c=0,h=0,f=0;f<l;)c=i.readUshort(r,t+(f<<2)),h=i.readShort(r,t+(f<<2)+2),a.push(c),o.push(h),f++;for(;f<u;)a.push(c),o.push(h),f++;return{aWidth:a,lsBearing:o}}};it.T.kern={parseTab:function(r,t,n,s){var i=it.B,a=it.T.kern,o=i.readUshort(r,t);if(o==1)return a.parseV1(r,t,n,s);var u=i.readUshort(r,t+2);t+=4;for(var l={glyph1:[],rval:[]},c=0;c<u;c++){t+=2;var n=i.readUshort(r,t);t+=2;var h=i.readUshort(r,t);t+=2;var f=h>>>8;f&=15,f==0&&(t=a.readFormat0(r,t,l))}return l},parseV1:function(r,t,n,s){var i=it.B,a=it.T.kern;i.readFixed(r,t);var o=i.readUint(r,t+4);t+=8;for(var u={glyph1:[],rval:[]},l=0;l<o;l++){i.readUint(r,t),t+=4;var c=i.readUshort(r,t);t+=2,i.readUshort(r,t),t+=2;var h=c&255;h==0&&(t=a.readFormat0(r,t,u))}return u},readFormat0:function(r,t,n){var s=it.B,i=s.readUshort,a=-1,o=i(r,t);i(r,t+2),i(r,t+4),i(r,t+6),t+=8;for(var u=0;u<o;u++){var l=i(r,t);t+=2;var c=i(r,t);t+=2;var h=s.readShort(r,t);t+=2,l!=a&&(n.glyph1.push(l),n.rval.push({glyph2:[],vals:[]}));var f=n.rval[n.rval.length-1];f.glyph2.push(c),f.vals.push(h),a=l}return t}};it.T.loca={parseTab:function(r,t,n,s){var i=it.B,a=[],o=s.head.indexToLocFormat,u=s.maxp.numGlyphs+1;if(o==0)for(var l=0;l<u;l++)a.push(i.readUshort(r,t+(l<<1))<<1);if(o==1)for(var l=0;l<u;l++)a.push(i.readUint(r,t+(l<<2)));return a}};it.T.maxp={parseTab:function(r,t,n){var s=it.B,i=s.readUshort,a={};return s.readUint(r,t),t+=4,a.numGlyphs=i(r,t),t+=2,a}};it.T.name={parseTab:function(r,t,n){var s=it.B,i={};s.readUshort(r,t),t+=2;var a=s.readUshort(r,t);t+=2;var o=s.readUshort(r,t);t+=2;for(var u=t-6+o,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=s.readUshort,h=0;h<a;h++){var f=c(r,t);t+=2;var p=c(r,t);t+=2;var g=c(r,t);t+=2;var y=c(r,t);t+=2;var x=c(r,t);t+=2;var v=c(r,t);t+=2;var S=u+v,w;f==0||f==3&&p==0||f==1&&p==25?w=s.readUnicode(r,S,x/2):p==0?w=s.readASCII(r,S,x):p==1||p==3||p==4||p==5||p==10?w=s.readUnicode(r,S,x/2):f==1?(w=s.readASCII(r,S,x),console.log("reading unknown MAC encoding "+p+" as ASCII")):(console.log("unknown encoding "+p+", platformID: "+f),w=s.readASCII(r,S,x));var E="p"+f+","+g.toString(16);i[E]==null&&(i[E]={});var _=l[y];_==null&&(_="_"+y),i[E][_]=w,i[E]._lang=g}var D=it.T.name.selectOne(i),I="fontFamily";if(D[I]==null)for(var k in i)i[k][I]!=null&&(D[I]=i[k][I]);return D},selectOne:function(r){var t="postScriptName";for(var n in r)if(r[n][t]!=null&&r[n]._lang==1033)return r[n];for(var n in r)if(r[n][t]!=null&&r[n]._lang==0)return r[n];for(var n in r)if(r[n][t]!=null&&r[n]._lang==3084)return r[n];for(var n in r)if(r[n][t]!=null)return r[n];var s;for(var n in r){s=r[n];break}return console.log("returning name table with languageID "+s._lang),s[t]==null&&s.ID!=null&&(s[t]=s.ID),s}};it.T.OS2={parseTab:function(r,t,n){var s=it.B,i=s.readUshort(r,t);t+=2;var a=it.T.OS2,o={};if(i==0)a.version0(r,t,o);else if(i==1)a.version1(r,t,o);else if(i==2||i==3||i==4)a.version2(r,t,o);else if(i==5)a.version5(r,t,o);else throw"unknown OS/2 table version: "+i;return o},version0:function(r,t,n){var s=it.B;return n.xAvgCharWidth=s.readShort(r,t),t+=2,n.usWeightClass=s.readUshort(r,t),t+=2,n.usWidthClass=s.readUshort(r,t),t+=2,n.fsType=s.readUshort(r,t),t+=2,n.ySubscriptXSize=s.readShort(r,t),t+=2,n.ySubscriptYSize=s.readShort(r,t),t+=2,n.ySubscriptXOffset=s.readShort(r,t),t+=2,n.ySubscriptYOffset=s.readShort(r,t),t+=2,n.ySuperscriptXSize=s.readShort(r,t),t+=2,n.ySuperscriptYSize=s.readShort(r,t),t+=2,n.ySuperscriptXOffset=s.readShort(r,t),t+=2,n.ySuperscriptYOffset=s.readShort(r,t),t+=2,n.yStrikeoutSize=s.readShort(r,t),t+=2,n.yStrikeoutPosition=s.readShort(r,t),t+=2,n.sFamilyClass=s.readShort(r,t),t+=2,n.panose=s.readBytes(r,t,10),t+=10,n.ulUnicodeRange1=s.readUint(r,t),t+=4,n.ulUnicodeRange2=s.readUint(r,t),t+=4,n.ulUnicodeRange3=s.readUint(r,t),t+=4,n.ulUnicodeRange4=s.readUint(r,t),t+=4,n.achVendID=s.readASCII(r,t,4),t+=4,n.fsSelection=s.readUshort(r,t),t+=2,n.usFirstCharIndex=s.readUshort(r,t),t+=2,n.usLastCharIndex=s.readUshort(r,t),t+=2,n.sTypoAscender=s.readShort(r,t),t+=2,n.sTypoDescender=s.readShort(r,t),t+=2,n.sTypoLineGap=s.readShort(r,t),t+=2,n.usWinAscent=s.readUshort(r,t),t+=2,n.usWinDescent=s.readUshort(r,t),t+=2,t},version1:function(r,t,n){var s=it.B;return t=it.T.OS2.version0(r,t,n),n.ulCodePageRange1=s.readUint(r,t),t+=4,n.ulCodePageRange2=s.readUint(r,t),t+=4,t},version2:function(r,t,n){var s=it.B,i=s.readUshort;return t=it.T.OS2.version1(r,t,n),n.sxHeight=s.readShort(r,t),t+=2,n.sCapHeight=s.readShort(r,t),t+=2,n.usDefault=i(r,t),t+=2,n.usBreak=i(r,t),t+=2,n.usMaxContext=i(r,t),t+=2,t},version5:function(r,t,n){var s=it.B.readUshort;return t=it.T.OS2.version2(r,t,n),n.usLowerOpticalPointSize=s(r,t),t+=2,n.usUpperOpticalPointSize=s(r,t),t+=2,t}};it.T.post={parseTab:function(r,t,n){var s=it.B,i={};return i.version=s.readFixed(r,t),t+=4,i.italicAngle=s.readFixed(r,t),t+=4,i.underlinePosition=s.readShort(r,t),t+=2,i.underlineThickness=s.readShort(r,t),t+=2,i}};it.T.SVG={parseTab:function(r,t,n){var s=it.B,i={entries:[],svgs:[]},a=t;s.readUshort(r,t),t+=2;var o=s.readUint(r,t);t+=4,s.readUint(r,t),t+=4,t=o+a;var u=s.readUshort(r,t);t+=2;for(var l=0;l<u;l++){var c=s.readUshort(r,t);t+=2;var h=s.readUshort(r,t);t+=2;var f=s.readUint(r,t);t+=4;var p=s.readUint(r,t);t+=4;var g=new Uint8Array(r.buffer,a+f+o,p);g[0]==31&&g[1]==139&&g[2]==8&&(g=OB.inflate(g));for(var y=s.readUTF8(g,0,g.length),x=c;x<=h;x++)i.entries[x]=i.svgs.length;i.svgs.push(y)}return i}};it.T.sbix={parseTab:function(r,t,n,s){for(var i=s.maxp.numGlyphs,a=t,o=it.B,u=o.readUint(r,t+4),l=[],c=u-1;c<u;c++)for(var h=a+o.readUint(r,t+8+c*4),f=0;f<i;f++){var p=o.readUint(r,h+4+f*4),g=o.readUint(r,h+4+f*4+4);if(p==g){l[f]=null;continue}var y=h+p,x=o.readASCII(r,y+4,4);if(x!="png ")throw x;l[f]=new Uint8Array(r.buffer,r.byteOffset+y+8,g-p-8)}return l}};it.T.colr={parseTab:function(r,t,n){var s=it.B,i=t;t+=2;var a=s.readUshort(r,t);t+=2;var o=s.readUint(r,t);t+=4;var u=s.readUint(r,t);t+=4;var l=s.readUshort(r,t);t+=2;for(var c={},h=i+o,f=0;f<a;f++)c["g"+s.readUshort(r,h)]=[s.readUshort(r,h+2),s.readUshort(r,h+4)],h+=6;var p=[];h=i+u;for(var f=0;f<l;f++)p.push(s.readUshort(r,h),s.readUshort(r,h+2)),h+=4;return[c,p]}};it.T.cpal={parseTab:function(r,t,n){var s=it.B,i=t,a=s.readUshort(r,t);if(t+=2,a==0){s.readUshort(r,t),t+=2,s.readUshort(r,t),t+=2;var o=s.readUshort(r,t);t+=2;var u=s.readUint(r,t);return t+=4,new Uint8Array(r.buffer,i+u,o*4)}else throw a}};it.T.GSUB={parseTab:function(r,t,n,s){var i=it.B,a=i.readUshort;i.readUint;var o=t;a(r,o),o+=2,a(r,o),o+=2,a(r,o),o+=2;var u=a(r,o);o+=2,a(r,o),o+=2,o=t+u;var l={},c=a(r,o);o+=2;for(var h=0;h<c;h++){var f=i.readASCII(r,o,4);o+=4,a(r,o),o+=2,l[f]=!0}return l}};it.T.fvar={parseTab:function(r,t,n,s){var i=s.name,a=t,o=it.B,u=[],l=[];a+=8;var c=o.readUshort(r,a);a+=2,a+=2;var h=o.readUshort(r,a);a+=2;var f=o.readUshort(r,a);a+=2;for(var p=0;p<c;p++){var g=o.readASCII(r,a,4),y=o.readFixed(r,a+4),x=o.readFixed(r,a+8),v=o.readFixed(r,a+12),S=o.readUshort(r,a+16),w=o.readUshort(r,a+18);u.push([g,y,x,v,S,i["_"+w]]),a+=20}for(var p=0;p<h;p++){for(var E=o.readUshort(r,a),_=null,S=o.readUshort(r,a+2),D=[],I=0;I<c;I++)D.push(o.readFixed(r,a+4+I*4));a+=4+c*4,(f&3)==2&&(_=o.readUshort(r,a),a+=2),l.push([i["_"+E],S,D,_])}return[u,l]}};it.T.gvar=function(){var r=32768,t=16384,n=8192,s=128,i=64,a=128,o=32768,u=it.B;function l(p,g,y){for(var x=[],v=0;v<y;v++)x.push(u.readF2dot14(p,g+v*2));return x}function c(p,g,y,x,v){for(var S=[],w=0;w<y;w++){var E=u.readUshort(p,g);g+=2;var _=u.readUshort(p,g),D=_&61440;_=_&4095,g+=2;var I=null,k=null,A=null;D&r&&(I=l(p,g,x),g+=x*2),D&t&&(k=l(p,g,x),g+=x*2),D&t&&(A=l(p,g,x),g+=x*2),S.push([E,_,D,k,I,A])}return S}function h(p,g,y){var x=p[g];if(g++,x==0)return[[],g];127<x&&(x=(x&127)<<8|p[g++]);for(var v=[],S=0;v.length<x;){var w=p[g];g++;var E=(w&a)!=0;w=(w&127)+1;for(var _=0;_<w;_++){var D=0;E?(D=u.readUshort(p,g),g+=2):(D=p[g],g++),S+=D,v.push(S)}}return[v,g]}function f(p,g,y,x){var v=g+4,S=u.readUshort(p,v);v+=2;var w=u.readUshort(p,v);v+=2;var E=u.readUint(p,v);v+=4;var _=u.readUshort(p,v);v+=2,u.readUshort(p,v),v+=2;var D=u.readUint(p,v);v+=4;for(var I=[],k=0;k<_+1;k++)I.push(u.readUint(p,v+k*4));var A=[],N=[],F=[];v=g+E;for(var k=0;k<w;k++){var $=l(p,v+k*S*2,S),O=[],M=[];A.push($),N.push(O),F.push(M);for(var B=0;B<S;B++)O[B]=Math.min($[B],0),M[B]=Math.max($[B],0)}for(var U=new Int8Array(p.buffer),V=[],k=0;k<_;k++){v=g+D+I[k];var Z=u.readUshort(p,v);v+=2;var J=Z&o;Z&=4095;var ne=u.readUshort(p,v);v+=2;var z=c(p,v,Z,S),X=[];V.push(X),v=g+D+I[k]+ne;var Y=null;if(J){var se=h(p,v);Y=se[0],v=se[1]}for(var ue=0;ue<Z;ue++){var fe=z[ue],de=v+fe[0],be=Y;if(fe[2]&n){var se=h(p,v);be=se[0],v=se[1]}for(var Me=[];v<de;){var _e=p[v++],Ne=(_e&63)+1;if(_e&s)for(var B=0;B<Ne;B++)Me.push(0);else if(_e&i){for(var B=0;B<Ne;B++)Me.push(u.readShort(p,v+B*2));v+=Ne*2}else{for(var B=0;B<Ne;B++)Me.push(U[v+B]);v+=Ne}}var ve=fe[1];if(X.push([[fe[3]?fe[3]:N[ve],fe[4]?fe[4]:A[ve],fe[5]?fe[5]:F[ve]],Me,be.length==0?null:be]),be.length!=0&&be.length*2!=Me.length)throw"e"}}return V}return{parseTab:f}}();it.T.avar={parseTab:function(r,t,n,s){var i=t,a=it.B,o=[];i+=6;var u=a.readUshort(r,i);i+=2;for(var l=0;l<u;l++){var c=a.readUshort(r,i);i+=2;var h=[];o.push(h);for(var f=0;f<c;f++){var p=a.readF2dot14(r,i),g=a.readF2dot14(r,i+2);i+=4,h.push(p,g)}}return o}};it.T.HVAR={parseTab:function(r,t,n,s){var i=t,a=t,o=it.B;i+=4;var u=o.readUint(r,i);i+=4;var l=o.readUint(r,i);i+=4;var c=o.readUint(r,i);i+=4;var h=o.readUint(r,i);if(i+=4,c!=0||h!=0)throw c;i=a+u;var f=i,U=o.readUshort(r,i);if(i+=2,U!=1)throw"e";var p=o.readUint(r,i);i+=4;var g=o.readUshort(r,i);i+=2;for(var y=[],x=0;x<g;x++)y.push(o.readUint(r,i+x*4));i+=g*4,i=f+p;var v=o.readUshort(r,i);i+=2;var S=o.readUshort(r,i);i+=2;for(var w=[],x=0;x<S;x++){var E=[[],[],[]];w.push(E);for(var _=0;_<v;_++)E[0].push(o.readF2dot14(r,i+0)),E[1].push(o.readF2dot14(r,i+2)),E[2].push(o.readF2dot14(r,i+4)),i+=6}for(var D=new Int8Array(r.buffer),I=[],x=0;x<y.length;x++){i=a+u+y[x];var k=[];I.push(k);var A=o.readUshort(r,i);i+=2;var N=o.readUshort(r,i);if(i+=2,N&32768)throw"e";var S=o.readUshort(r,i);i+=2;for(var F=[],_=0;_<S;_++)F.push(o.readUshort(r,i+_*2));i+=S*2;for(var $=0;$<A;$++){for(var O=[],M=0;M<S;M++)O.push(M<N?o.readShort(r,i):D[i]),i+=M<N?2:1;var B=new Array(w.length);B.fill(0),k.push(B);for(var _=0;_<F.length;_++)B[F[_]]=O[_]}}i=a+l;var U=r[i++];if(U!=0)throw"e";var V=r[i++],Z=o.readUshort(r,i);i+=2;for(var J=15,ne=48,z=((V&ne)>>4)+1,X=[],x=0;x<Z;x++){var Y=0;z==1?Y=r[i++]:(Y=o.readUshort(r,i),i+=2);var se=Y>>(V&J)+1,ue=Y&(1<<(V&J)+1)-1;X.push(I[se][ue])}return[w,X]}};it.U=function(){var r={MoveTo:function(A,N,F){A.cmds.push("M"),A.crds.push(N,F)},LineTo:function(A,N,F){A.cmds.push("L"),A.crds.push(N,F)},CurveTo:function(A,N,F,$,O,M,B){A.cmds.push("C"),A.crds.push(N,F,$,O,M,B)},qCurveTo:function(A,N,F,$,O){A.cmds.push("Q"),A.crds.push(N,F,$,O)},ClosePath:function(A){A.cmds.push("Z")}};function t(A,N,F,$){var O=N[F],M=N[F+1],B=A.kern;if(B){var U=B.glyph1.indexOf(O);if(U!=-1){var V=B.rval[U].glyph2.indexOf(M);if(V!=-1)return[0,0,B.rval[U].vals[V],0]}}return[0,0,0,0]}function n(A,N,F){F==null&&(F={}),F.ltr,F.fts;var $=F.axs;A.fvar&&$==null&&($=A.fvar[1][A._index][2]);var O=A.HVAR;$&&O&&($=p(A,$));for(var M=[],B=0;B<N.length;B++){var U=N.codePointAt(B);U>65535&&B++,M.push(l(A,U))}for(var V=[],B=0;B<M.length;B++){var Z=t(A,M,B),J=M[B],ne=A.hmtx.aWidth[J]+Z[2];if(O&&O[1][J])for(var z=O[1][J],X=0;X<O[0].length;X++)ne+=f(O[0][X],$)*z[X];V.push({g:J,cl:B,dx:0,dy:0,ax:ne,ay:0})}return V}function s(A,N,F){var $={cmds:[],crds:[]},O=0,M=0,B,U;F&&(B=F.clr,U=F.axs);for(var V=0;V<N.length;V++){for(var Z=N[V],J=c(A,Z.g,!1,U),ne=J.crds,z=0;z<ne.length;z+=2)$.crds.push(ne[z]+O+Z.dx),$.crds.push(ne[z+1]+M+Z.dy);B&&$.cmds.push(B);for(var z=0;z<J.cmds.length;z++)$.cmds.push(J.cmds[z]);var X=$.cmds.length;B&&X!=0&&$.cmds[X-1]!="X"&&$.cmds.push("X"),O+=Z.ax,M+=Z.ay}return{cmds:$.cmds,crds:$.crds}}function i(A,N,F){for(var $=0,O=~~(A.length/N);$+1!=O;){var M=$+(O-$>>>1);A[M*N]<=F?$=M:O=M}return $*N}for(var a=[9,10,11,12,13,32,133,160,5760,6158,8232,8233,8239,8288,12288,65279],o={},u=0;u<a.length;u++)o[a[u]]=1;for(var u=8192;u<=8205;u++)o[u]=1;function l(A,N){if(A._ctab==null){for(var F=A.cmap,$=-1,O=["p3e10","p0e4","p3e1","p1e0","p0e3","p0e1","p3e0","p3e5"],M=0;M<O.length;M++)if(F.ids[O[M]]!=null){$=F.ids[O[M]];break}if($==-1)throw"no familiar platform and encoding!";A._ctab=F.tables[$]}var B=A._ctab,U=B.format,V=-1;if(U==0)N>=B.map.length?V=0:V=B.map[N];else if(U==4){var Z=B.endCount;if(V=0,N<=Z[Z.length-1]){var J=i(Z,1,N);if(Z[J]<N&&J++,N>=B.startCount[J]){var ne=0;B.idRangeOffset[J]!=0?ne=B.glyphIdArray[N-B.startCount[J]+(B.idRangeOffset[J]>>1)-(B.idRangeOffset.length-J)]:ne=N+B.idDelta[J],V=ne&65535}}}else if(U==6){var z=N-B.firstCode,X=B.glyphIdArray;z<0||z>=X.length?V=0:V=X[z]}else if(U==12){var Y=B.groups;if(V=0,N<=Y[Y.length-2]){var M=i(Y,3,N);Y[M]<=N&&N<=Y[M+1]&&(V=Y[M+2]+(N-Y[M]))}}else throw"unknown cmap table format "+B.format;var se=A["SVG "],ue=A.loca;return V!=0&&A["CFF "]==null&&(se==null||se.entries[V]==null)&&ue&&ue[V]==ue[V+1]&&o[N]==null&&(V=0),V}function c(A,N,F,$){var O={cmds:[],crds:[]};A.fvar&&($==null&&($=A.fvar[1][A._index][2]),$=p(A,$));var M=A["SVG "],B=A["CFF "],U=A.COLR,V=A.CBLC,Z=A.CBDT,J=A.sbix,ne=window.UPNG,z=null;if(V&&ne)for(var X=0;X<V.length;X++)V[X][0]<=N&&N<=V[X][1]&&(z=V[X]);if(z||J&&J[N]){if(z&&z[2]!=17)throw"not a PNG";A.__tmp==null&&(A.__tmp={});var Y=A.__tmp["g"+N];if(Y==null){var se,ue;if(J)se=J[N],ue=se.length;else{var fe=z[3][N-z[0]]+5;ue=Z[fe+1]<<16|Z[fe+2]<<8|Z[fe+3],fe+=4,se=new Uint8Array(Z.buffer,Z.byteOffset+fe,ue)}for(var de="",X=0;X<ue;X++)de+=String.fromCharCode(se[X]);Y=A.__tmp["g"+N]="data:image/png;base64,"+btoa(de)}O.cmds.push(Y);var be=A.head.unitsPerEm*1.15,Me=Math.round(be),_e=Math.round(be),Ne=Math.round(-_e*.15);O.crds.push(0,_e+Ne,Me,_e+Ne,Me,Ne,0,Ne)}else if(M&&M.entries[N]){var ve=M.entries[N];if(ve!=null){if(typeof ve=="number"){var Pe=M.svgs[ve];if(typeof Pe=="string"){var et=new DOMParser,Ve=et.parseFromString(Pe,"image/svg+xml");Pe=M.svgs[ve]=Ve.getElementsByTagName("svg")[0]}ve=it.U.SVG.toPath(Pe,N),M.entries[N]=ve}O=ve}}else if(F!=!0&&U&&U[0]["g"+N]&&U[0]["g"+N][1]>1){let It=function(ut){var wt=ut.toString(16);return(wt.length==1?"0":"")+wt};for(var ft=It,re=A.CPAL,Q=U[0]["g"+N],X=0;X<Q[1];X++){var ce=Q[0]+X,xe=U[1][2*ce],Ge=U[1][2*ce+1]*4,Oe=c(A,xe,xe==N),lt="#"+It(re[Ge+2])+It(re[Ge+1])+It(re[Ge+0]);O.cmds.push(lt),O.cmds=O.cmds.concat(Oe.cmds),O.crds=O.crds.concat(Oe.crds),O.cmds.push("X")}}else if(B){var ot=B.Private,bt={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:ot?ot.defaultWidthX:0,open:!1};if(B.ROS){for(var Et=0;B.FDSelect[Et+2]<=N;)Et+=2;ot=B.FDArray[B.FDSelect[Et+1]].Private}I(B.CharStrings[N],bt,B,ot,O)}else A.glyf&&h(N,A,O,$);return{cmds:O.cmds,crds:O.crds}}function h(A,N,F,$){var O=N.glyf[A];O==null&&(O=N.glyf[A]=it.T.glyf._parseGlyf(N,A)),O!=null&&(O.noc>-1?y(O,N,A,F,$):x(O,N,A,F,$))}function f(A,N){N.length;for(var F=1,$=A[0],O=A[1],M=A[2],B=0;B<N.length;B++){var U=1;$[B]>O[B]||O[B]>M[B]||$[B]<0&&M[B]>0&&O[B]!=0||O[B]==0?U=1:N[B]<$[B]||N[B]>M[B]?U=0:N[B]==O[B]?U=1:N[B]<O[B]?U=(N[B]-$[B])/(O[B]-$[B]):U=(M[B]-N[B])/(M[B]-O[B]),F=F*U}return F}function p(A,N){for(var F=A.fvar,$=A.avar,O=F?F[0]:null,M=[],B=0;B<O.length;B++){var U=O[B][1],V=O[B][2],Z=O[B][3],J=Math.max(U,Math.min(Z,N[B]));if(J<V?M[B]=(V-J)/(U-V):J>V?M[B]=(J-V)/(Z-V):M[B]=0,$&&M[B]!=-1){for(var ne=$[B],z=0;z<ne.length&&!(ne[z]>=M[B]);z+=2);var X=(M[B]-ne[z-2])/(ne[z]-ne[z-2]);M[B]=X*ne[z+1]+(1-X)*ne[z-1]}}return M}function g(A,N,F,$,O){var M=F.length,B=new Array(M*2+8);B.fill(0);for(var U=0;U<M;U++){var V=0,Z=0,J=N.indexOf(U);if(J!=-1)V=A[J],Z=A[N.length+J];else{for(var ne=0;O[ne]<U;)ne++;for(var z=ne==0?0:O[ne-1]+1,X=O[ne],Y=-1,se=-1,ue=0;ue<N.length;ue++){var fe=N[ue];fe<z||fe>X||fe>=M||(Y=ue,se==-1&&(se=ue))}for(var ue=0;ue<N.length;ue++){var fe=N[ue];if(!(fe<z||fe>X||fe>=M)&&(fe<U&&(Y=ue),U<fe)){se=ue;break}}for(var de=0;de<2;de++){var be=de==0?F:$,Me=de*N.length,_e=0,Ne=be[N[Y]],ve=be[N[se]],Pe=be[U],et=A[Me+Y],Ve=A[Me+se];if(Ne==ve)et==Ve?_e=et:_e=0;else if(Pe<=Math.min(Ne,ve))Ne<ve?_e=et:_e=Ve;else if(Math.max(Ne,ve)<=Pe)Ne<ve?_e=Ve:_e=et;else{var re=(Pe-Ne)/(ve-Ne);_e=re*Ve+(1-re)*et}de==0?V=_e:Z=_e}}B[U]=V,B[M+4+U]=Z}return B}function y(A,N,F,$,O){var M=A.xs,B=A.ys;if(N.fvar&&O){M=M.slice(0),B=B.slice(0);for(var U=N.gvar,V=U?U[F]:null,Z=0;Z<V.length;Z++){var J=V[Z][0],ne=f(J,O);if(!(ne<1e-9)){var z=V[Z][1],X=V[Z][2];if(X&&(z=V[Z][1]=g(z,X,M,B,A.endPts),V[Z][2]=null),z.length==M.length*2+8)for(var Y=0;Y<M.length;Y++)M[Y]+=ne*z[Y],B[Y]+=ne*z[Y+M.length+4]}}}for(var se=0;se<A.noc;se++){for(var ue=se==0?0:A.endPts[se-1]+1,fe=A.endPts[se],Y=ue;Y<=fe;Y++){var de=Y==ue?fe:Y-1,be=Y==fe?ue:Y+1,Me=A.flags[Y]&1,_e=A.flags[de]&1,Ne=A.flags[be]&1,ve=M[Y],Pe=B[Y];if(Y==ue)if(Me)if(_e)r.MoveTo($,M[de],B[de]);else{r.MoveTo($,ve,Pe);continue}else _e?r.MoveTo($,M[de],B[de]):r.MoveTo($,Math.floor((M[de]+ve)*.5),Math.floor((B[de]+Pe)*.5));Me?_e&&r.LineTo($,ve,Pe):Ne?r.qCurveTo($,ve,Pe,M[be],B[be]):r.qCurveTo($,ve,Pe,Math.floor((ve+M[be])*.5),Math.floor((Pe+B[be])*.5))}r.ClosePath($)}}function x(A,N,F,$,O){var M=[0,0,0,0,0,0],B=[0,0,0,0,0,0],U=A.parts.length;if(N.fvar&&O)for(var V=N.gvar,Z=V?V[F]:null,J=0;J<Z.length;J++){var ne=Z[J][0],z=f(ne,O);if(!(z<1e-6)){var X=Z[J][1],Y=Z[J][2];if(Y==null)for(var se=0;se<U;se++)M[se]+=z*X[se],B[se]+=z*X[se+U+4];else for(var ue=0;ue<Y.length;ue++){var se=Y[ue];M[se]+=z*X[0],B[se]+=z*X[0+U]}}}for(var ue=0;ue<U;ue++){var fe={cmds:[],crds:[]},de=A.parts[ue];h(de.glyphIndex,N,fe,O);for(var be=de.m,Me=be.tx+M[ue],_e=be.ty+B[ue],se=0;se<fe.crds.length;se+=2){var Ne=fe.crds[se],ve=fe.crds[se+1];$.crds.push(Ne*be.a+ve*be.c+Me),$.crds.push(Ne*be.b+ve*be.d+_e)}for(var se=0;se<fe.cmds.length;se++)$.cmds.push(fe.cmds[se])}}function v(A,N){var F=A.cmds,$=A.crds;N==null&&(N=5);function O(et){return parseFloat(et.toFixed(N))}function M(et){for(var Ve=[],re=!1,Q="",ce=0;ce<et.length;ce++){var xe=et[ce],Ge=typeof xe=="number";if(!Ge){if(xe==Q&&xe.length==1&&xe!="m")continue;Q=xe}re&&Ge&&xe>=0&&Ve.push(" "),Ve.push(xe),re=Ge}return Ve.join("")}for(var B=[],U=0,V={M:2,L:2,Q:4,C:6},Z=0,J=0,ne=0,z=0,X=0,Y=0,se=0;se<F.length;se++){var ue=F[se],fe=V[ue]?V[ue]:0,de=[],be,Me,_e,Ne;if(ue=="L")be=$[U]-Z,Me=$[U+1]-J,_e=O(be+ne),Ne=O(Me+z),F[se+1]=="Z"&&$[U]==X&&$[U+1]==Y?(_e=be,Ne=Me):_e==0&&Ne==0||(_e==0?de.push("v",Ne):Ne==0?de.push("h",_e):de.push("l",_e,Ne));else{de.push(ue.toLowerCase());for(var ve=0;ve<fe;ve+=2)be=$[U+ve]-Z,Me=$[U+ve+1]-J,_e=O(be+ne),Ne=O(Me+z),de.push(_e,Ne)}fe!=0&&(ne+=be-_e,z+=Me-Ne);for(var Pe=de,ve=0;ve<Pe.length;ve++)B.push(Pe[ve]);fe!=0&&(U+=fe,Z=$[U-2],J=$[U-1]),ue=="M"&&(X=Z,Y=J),ue=="Z"&&(Z=X,J=Y)}return M(B)}function S(A){var N={cmds:[],crds:[]};return it.U.SVG.svgToPath(A,N),{cmds:N.cmds,crds:N.crds}}function w(A,N,F,$){for(var O=N>>1,M=F>>1,B=new Uint8Array(O*M*4),U=new Uint32Array(A.buffer),V=new Uint32Array(B.buffer),Z=0;Z<M;Z++)for(var J=0;J<O;J++){var ne=Z*O+J,z=(Z<<1)*N+(J<<1),X=U[z],Y=U[z+1],se=U[z+N],ue=U[z+N+1],fe=X>>>24,de=Y>>>24,be=se>>>24,Me=ue>>>24,_e=fe+de+be+Me;if(_e==1020){var Ne=(X>>>0&255)+(Y>>>0&255)+(se>>>0&255)+(ue>>>0&255)+2>>>2,ve=(X>>>8&255)+(Y>>>8&255)+(se>>>8&255)+(ue>>>8&255)+2>>>2,Pe=(X>>>16&255)+(Y>>>16&255)+(se>>>16&255)+(ue>>>16&255)+2>>>2;V[ne]=255<<24|Pe<<16|ve<<8|Ne}else if(_e==0)V[ne]=0;else{var Ne=(X>>>0&255)*fe+(Y>>>0&255)*de+(se>>>0&255)*be+(ue>>>0&255)*Me,ve=(X>>>8&255)*fe+(Y>>>8&255)*de+(se>>>8&255)*be+(ue>>>8&255)*Me,Pe=(X>>>16&255)*fe+(Y>>>16&255)*de+(se>>>16&255)*be+(ue>>>16&255)*Me,et=1/_e;Ne=~~(Ne*et+.5),ve=~~(ve*et+.5),Pe=~~(Pe*et+.5),V[ne]=_e+2>>>2<<24|Pe<<16|ve<<8|Ne}}return{buff:B,w:O,h:M}}var E,_;function D(A,N){for(var F=0,$=A.cmds,O=A.crds,M=0;M<$.length;M++){var B=$[M];if(B=="M")N.moveTo(O[F],O[F+1]),F+=2;else if(B=="L")N.lineTo(O[F],O[F+1]),F+=2;else if(B=="C")N.bezierCurveTo(O[F],O[F+1],O[F+2],O[F+3],O[F+4],O[F+5]),F+=6;else if(B=="Q")N.quadraticCurveTo(O[F],O[F+1],O[F+2],O[F+3]),F+=4;else if(B[0]=="d"){var U=window.UPNG,V=O[F],Z=O[F+1],J=O[F+2],ne=O[F+3],z=O[F+4],X=O[F+5],Y=O[F+6],se=O[F+7];if(F+=8,U==null){N.moveTo(V,Z),N.lineTo(J,ne),N.lineTo(z,X),N.lineTo(Y,se),N.closePath();continue}for(var ue=J-V,fe=ne-Z,de=Y-V,be=se-Z,Me=atob(B.slice(22)),_e=new Uint8Array(Me.length),Ne=0;Ne<Me.length;Ne++)_e[Ne]=Me.charCodeAt(Ne);for(var ve=U.decode(_e.buffer),Pe=ve.width,et=ve.height,Ve=new Uint8Array(U.toRGBA8(ve)[0]),re=N.getTransform(),Q=Math.sqrt(Math.abs(re.a*re.d-re.b*re.c))*Math.sqrt(de*de+be*be)/et;Q<.5;){var ce=w(Ve,Pe,et);Ve=ce.buff,Pe=ce.w,et=ce.h,Q*=2}E==null&&(E=document.createElement("canvas"),_=E.getContext("2d")),(E.width!=Pe||E.height!=et)&&(E.width=Pe,E.height=et),_.putImageData(new ImageData(new Uint8ClampedArray(Ve.buffer),Pe,et),0,0),N.save(),N.transform(ue,fe,de,be,V,Z),N.scale(1/Pe,1/et),N.drawImage(E,0,0),N.restore()}else if(B.charAt(0)=="#"||B.charAt(0)=="r")N.beginPath(),N.fillStyle=B;else if(B.charAt(0)=="O"&&B!="OX"){N.beginPath();var xe=B.split("-");N.lineWidth=parseFloat(xe[2]),N.lineCap=["butt","round","square"][parseFloat(xe[3])],N.lineJoin=["miter","round","bevel"][parseFloat(xe[4])],N.miterLimit=parseFloat(xe[5]),N.lineDashOffset=parseFloat(xe[6]),N.setLineDash(xe[7].split(",").map(parseFloat)),N.strokeStyle=xe[1]}else B=="Z"?N.closePath():B=="X"?N.fill():B=="OX"&&N.stroke()}}function I(A,N,F,$,O){for(var M=N.stack,B=N.nStems,U=N.haveWidth,V=N.width,Z=N.open,J=0,ne=N.x,z=N.y,X=0,Y=0,se=0,ue=0,fe=0,de=0,be=0,Me=0,_e=0,Ne=0,ve=it.T.CFF,Pe=$.nominalWidthX,et={val:0,size:0};J<A.length;){ve.getCharString(A,J,et);var Ve=et.val;if(J+=et.size,Ve=="o1"||Ve=="o18"){var re;re=M.length%2!==0,re&&!U&&(V=M.shift()+Pe),B+=M.length>>1,M.length=0,U=!0}else if(Ve=="o3"||Ve=="o23"){var re;re=M.length%2!==0,re&&!U&&(V=M.shift()+Pe),B+=M.length>>1,M.length=0,U=!0}else if(Ve=="o4")M.length>1&&!U&&(V=M.shift()+Pe,U=!0),Z&&r.ClosePath(O),z+=M.pop(),r.MoveTo(O,ne,z),Z=!0;else if(Ve=="o5")for(;M.length>0;)ne+=M.shift(),z+=M.shift(),r.LineTo(O,ne,z);else if(Ve=="o6"||Ve=="o7")for(var Q=M.length,ce=Ve=="o6",xe=0;xe<Q;xe++){var Ge=M.shift();ce?ne+=Ge:z+=Ge,ce=!ce,r.LineTo(O,ne,z)}else if(Ve=="o8"||Ve=="o24"){for(var Q=M.length,Oe=0;Oe+6<=Q;)X=ne+M.shift(),Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),ne=se+M.shift(),z=ue+M.shift(),r.CurveTo(O,X,Y,se,ue,ne,z),Oe+=6;Ve=="o24"&&(ne+=M.shift(),z+=M.shift(),r.LineTo(O,ne,z))}else{if(Ve=="o11")break;if(Ve=="o1234"||Ve=="o1235"||Ve=="o1236"||Ve=="o1237")Ve=="o1234"&&(X=ne+M.shift(),Y=z,se=X+M.shift(),ue=Y+M.shift(),_e=se+M.shift(),Ne=ue,fe=_e+M.shift(),de=ue,be=fe+M.shift(),Me=z,ne=be+M.shift(),r.CurveTo(O,X,Y,se,ue,_e,Ne),r.CurveTo(O,fe,de,be,Me,ne,z)),Ve=="o1235"&&(X=ne+M.shift(),Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),_e=se+M.shift(),Ne=ue+M.shift(),fe=_e+M.shift(),de=Ne+M.shift(),be=fe+M.shift(),Me=de+M.shift(),ne=be+M.shift(),z=Me+M.shift(),M.shift(),r.CurveTo(O,X,Y,se,ue,_e,Ne),r.CurveTo(O,fe,de,be,Me,ne,z)),Ve=="o1236"&&(X=ne+M.shift(),Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),_e=se+M.shift(),Ne=ue,fe=_e+M.shift(),de=ue,be=fe+M.shift(),Me=de+M.shift(),ne=be+M.shift(),r.CurveTo(O,X,Y,se,ue,_e,Ne),r.CurveTo(O,fe,de,be,Me,ne,z)),Ve=="o1237"&&(X=ne+M.shift(),Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),_e=se+M.shift(),Ne=ue+M.shift(),fe=_e+M.shift(),de=Ne+M.shift(),be=fe+M.shift(),Me=de+M.shift(),Math.abs(be-ne)>Math.abs(Me-z)?ne=be+M.shift():z=Me+M.shift(),r.CurveTo(O,X,Y,se,ue,_e,Ne),r.CurveTo(O,fe,de,be,Me,ne,z));else if(Ve=="o14"){if(M.length>0&&M.length!=4&&!U&&(V=M.shift()+F.nominalWidthX,U=!0),M.length==4){var lt=M.shift(),ot=M.shift(),bt=M.shift(),Et=M.shift(),ft=ve.glyphBySE(F,bt),It=ve.glyphBySE(F,Et);I(F.CharStrings[ft],N,F,$,O),N.x=lt,N.y=ot,I(F.CharStrings[It],N,F,$,O)}Z&&(r.ClosePath(O),Z=!1)}else if(Ve=="o19"||Ve=="o20"){var re;re=M.length%2!==0,re&&!U&&(V=M.shift()+Pe),B+=M.length>>1,M.length=0,U=!0,J+=B+7>>3}else if(Ve=="o21")M.length>2&&!U&&(V=M.shift()+Pe,U=!0),z+=M.pop(),ne+=M.pop(),Z&&r.ClosePath(O),r.MoveTo(O,ne,z),Z=!0;else if(Ve=="o22")M.length>1&&!U&&(V=M.shift()+Pe,U=!0),ne+=M.pop(),Z&&r.ClosePath(O),r.MoveTo(O,ne,z),Z=!0;else if(Ve=="o25"){for(;M.length>6;)ne+=M.shift(),z+=M.shift(),r.LineTo(O,ne,z);X=ne+M.shift(),Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),ne=se+M.shift(),z=ue+M.shift(),r.CurveTo(O,X,Y,se,ue,ne,z)}else if(Ve=="o26")for(M.length%2&&(ne+=M.shift());M.length>0;)X=ne,Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),ne=se,z=ue+M.shift(),r.CurveTo(O,X,Y,se,ue,ne,z);else if(Ve=="o27")for(M.length%2&&(z+=M.shift());M.length>0;)X=ne+M.shift(),Y=z,se=X+M.shift(),ue=Y+M.shift(),ne=se+M.shift(),z=ue,r.CurveTo(O,X,Y,se,ue,ne,z);else if(Ve=="o10"||Ve=="o29"){var ut=Ve=="o10"?$:F;if(M.length==0)console.log("error: empty stack");else{var wt=M.pop(),St=ut.Subrs[wt+ut.Bias];N.x=ne,N.y=z,N.nStems=B,N.haveWidth=U,N.width=V,N.open=Z,I(St,N,F,$,O),ne=N.x,z=N.y,B=N.nStems,U=N.haveWidth,V=N.width,Z=N.open}}else if(Ve=="o30"||Ve=="o31"){var Q,hr=M.length,Oe=0,qn=Ve=="o31";for(Q=hr&-3,Oe+=hr-Q;Oe<Q;)qn?(X=ne+M.shift(),Y=z,se=X+M.shift(),ue=Y+M.shift(),z=ue+M.shift(),Q-Oe==5?(ne=se+M.shift(),Oe++):ne=se,qn=!1):(X=ne,Y=z+M.shift(),se=X+M.shift(),ue=Y+M.shift(),ne=se+M.shift(),Q-Oe==5?(z=ue+M.shift(),Oe++):z=ue,qn=!0),r.CurveTo(O,X,Y,se,ue,ne,z),Oe+=4}else{if((Ve+"").charAt(0)=="o")throw console.log("Unknown operation: "+Ve,A),Ve;M.push(Ve)}}}N.x=ne,N.y=z,N.nStems=B,N.haveWidth=U,N.width=V,N.open=Z}function k(A,N){var F=function($){var O=0;return($&4294967168)==0?O=1:($&4294965248)==0?O=2:($&4294901760)==0?O=3:($&4292870144)==0&&(O=4),O};fetch(A).then(function($){return $.arrayBuffer()}).then(function($){return WebAssembly.instantiate($)}).then(function($){console.log("HB ready");var O=$.instance.exports,M=O.memory,B,U,V,Z,J,ne,z,X,Y;it.U.shapeHB=function(){var se=function(fe){for(var de=O.hb_buffer_get_length(fe),be=[],Me=O.hb_buffer_get_glyph_infos(fe,0)>>>2,_e=O.hb_buffer_get_glyph_positions(fe,0)>>>2,Ne=0;Ne<de;++Ne){var ve=Me+Ne*5,Pe=_e+Ne*5;be.push({g:U[ve+0],cl:U[ve+2],ax:V[Pe+0],ay:V[Pe+1],dx:V[Pe+2],dy:V[Pe+3]})}return be},ue;return function(fe,de,be){var Me=fe._data,_e=fe.name.postScriptName,Ne=be.ltr,ve=be.fts,Pe=be.axs;if(fe.fvar&&Pe==null&&(Pe=fe.fvar[1][fe._index][2]),B=new Uint8Array(M.buffer),U=new Uint32Array(M.buffer),V=new Int32Array(M.buffer),Z=new Float32Array(M.buffer),J!=_e&&(ne!=null&&(O.hb_blob_destroy(ne),O.free(z),O.hb_face_destroy(X),O.hb_font_destroy(Y)),z=O.malloc(Me.byteLength),B.set(Me,z),ne=O.hb_blob_create(z,Me.byteLength,2,0,0),X=O.hb_face_create(ne,fe._index),Y=O.hb_font_create(X),J=_e),window.TextEncoder==null){alert("Your browser is too old. Please, update it.");return}ue==null&&(ue=new window.TextEncoder("utf8"));var et=O.hb_buffer_create(),Ve=ue.encode(de),re=Ve.length,Q=O.malloc(re);B.set(Ve,Q),O.hb_buffer_add_utf8(et,Q,re,0,re),O.free(Q);var ce=it.B,xe=0;if(ve){xe=O.malloc(16*ve.length);for(var Ge=0;Ge<ve.length;Ge++){var Oe=ve[Ge],lt=xe+Ge*16,ot=lt>>>2;ce.writeASCII(B,lt,Oe[0].split("").reverse().join("")),U[ot+1]=Oe[1],U[ot+2]=Oe[2],U[ot+3]=Oe[3]}}var bt=0;if(Pe&&fe.fvar){var Et=fe.fvar[0];bt=O.malloc(8*Pe.length);for(var Ge=0;Ge<Pe.length;Ge++){var lt=bt+Ge*8,ot=lt>>>2;ce.writeASCII(B,lt,Et[Ge][0].split("").reverse().join("")),Z[ot+1]=Pe[Ge]}}Pe&&O.hb_font_set_variations(Y,bt,Pe.length),O.hb_buffer_set_direction(et,Ne?4:5),O.hb_buffer_guess_segment_properties(et),O.hb_shape(Y,et,xe,ve?ve.length:0);var ft=se(et);O.hb_buffer_destroy(et),ve&&O.free(xe),Pe&&O.free(bt);var It=ft.slice(0);Ne||It.reverse();for(var ut=0,wt=0,Ge=1;Ge<It.length;Ge++){for(var St=It[Ge],hr=St.cl;;){var qn=de.codePointAt(ut),sn=F(qn);if(wt+sn<=hr)wt+=sn,ut+=qn<=65535?1:2;else break}St.cl=ut}return ft}}(),N()})}return{shape:n,shapeToPath:s,codeToGlyph:l,glyphToPath:c,pathToSVG:v,SVGToPath:S,pathToContext:D,initHB:k}}();var BC={exports:{}},CR;function Xne(){return CR||(CR=1,function(r,t){(function(n,s){r.exports=s()})(self,()=>(()=>{var n={177:(i,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BezierPath=void 0;const u=o(558),l=o(188);a.BezierPath=class{constructor(c){this.samples=[],this.segments=c;const h=c.map(v=>v.getTotalLength()),f=[0];for(let v=1;v<h.length;v++)f.push(f[v-1]+h[v-1]);this._totalLength=f[f.length-1]+h[h.length-1];const p=c.map(v=>Math.max(4,Math.ceil(v.getTotalLength()/u.BezierSegment.sampleSpacing()))),g=p.reduce((v,S)=>v+S),y=1/g/10,x=this._totalLength/g;this.samples.push({dist:0,pt:this.segments[0].A,tan:this.segments[0].tangentAtParameter(0),segIdx:0,t:0}),c.forEach((v,S)=>{const w=p[S],E=(0,l.times)(w+1).map(k=>k/w),_=E.map(k=>v.pointAtParameter(k));let D;for(let k=0;k<4;k++){D=(0,l.times)(w).map(F=>Math.hypot(_[F+1].x-_[F].x,_[F+1].y-_[F].y));const A=D.map(F=>F-x);let N=0;for(let F=1;F<E.length-1;F++)N+=A[F-1],E[F]-=y*N,_[F]=v.pointAtParameter(E[F])}let I=0;_.slice(1).forEach((k,A)=>{I+=D[A],this.samples.push({dist:f[S]+I,pt:k,tan:this.segments[S].tangentAtParameter(E[A+1]),segIdx:S,t:E[A+1]})})}),this._jumps=[],this.segmentStartEnds=[{start:0,end:0}];for(let v=1;v<this.samples.length;v++){const S=this.samples[v-1],w=this.samples[v];if(w.segIdx===S.segIdx?this.segmentStartEnds[this.segmentStartEnds.length-1].end=w.dist:this.segmentStartEnds[w.segIdx]={start:w.dist,end:w.dist},S.segIdx!==w.segIdx&&(this.segments[S.segIdx].D.x!==this.segments[w.segIdx].A.x||this.segments[S.segIdx].D.y!==this.segments[w.segIdx].A.y)){const E=(S.dist+w.dist)/2,_={dist:E-1e-8,pt:this.segments[S.segIdx].D,tan:this.segments[S.segIdx].tangentAtParameter(1),segIdx:S.segIdx,t:1},D={dist:E+1e-8,pt:this.segments[w.segIdx].A,tan:this.segments[w.segIdx].tangentAtParameter(0),segIdx:w.segIdx,t:0};this._jumps.push(E),this.samples.splice(v,0,_,D),v+=2}}}jumps(){return[...this._jumps]}getTotalLength(){return this._totalLength}findClosestSampleIdx(c){let h=0,f=this.samples.length-1;for(;h<f;){const p=Math.floor((h+f)/2);if(this.samples[p].dist>c)f=p-1;else{if(!(this.samples[p].dist<c))return p;h=p+1}}return Math.max(0,Math.min(this.samples.length-1,Math.floor((h+f)/2)))}getPointAtLength(c,h=!1){if(c<=0)return this.samples[0].pt;if(c>=this._totalLength)return this.samples[this.samples.length-1].pt;const f=this.findClosestSampleIdx(c),p=this.samples[f].dist<c?Math.min(f+1,this.samples.length-1):Math.max(0,f-1),g=Math.abs(this.samples[p].dist-this.samples[f].dist)<1e-6?0:(c-this.samples[f].dist)/(this.samples[p].dist-this.samples[f].dist);if(h||this.samples[f].segIdx>this.samples[p].segIdx)return{x:(1-g)*this.samples[f].pt.x+g*this.samples[p].pt.x,y:(1-g)*this.samples[f].pt.y+g*this.samples[p].pt.y};if(this.samples[f].segIdx!==this.samples[p].segIdx){if(g<.5){const y=this.segments[this.samples[f].segIdx],x=2*g,v=(1-x)*this.samples[f].t+x;return y.pointAtParameter(v)}{const y=this.segments[this.samples[p].segIdx],x=2*(g-.5)*this.samples[p].t;return y.pointAtParameter(x)}}{const y=this.segments[this.samples[f].segIdx],x=(1-g)*this.samples[f].t+g*this.samples[p].t;return y.pointAtParameter(x)}}getAngleAtLength(c,h=!1){const f=this.getTangentAtLength(c,h);return Math.atan2(f.y,f.x)}getTangentAtLength(c,h=!1){if(c<=0)return this.samples[0].tan;if(c>=this._totalLength)return this.samples[this.samples.length-1].tan;const f=this.findClosestSampleIdx(c),p=this.samples[f].dist<c?Math.min(f+1,this.samples.length-1):Math.max(0,f-1),g=(c-this.samples[f].dist)/(this.samples[p].dist-this.samples[f].dist);if(h||this.samples[f].segIdx>this.samples[p].segIdx){let y=(1-g)*this.samples[f].tan.x+g*this.samples[p].tan.x,x=(1-g)*this.samples[f].tan.y+g*this.samples[p].tan.y;const v=Math.max(Math.hypot(y,x),1e-4);return y/=v,x/=v,{x:y,y:x}}if(this.samples[f].segIdx!==this.samples[p].segIdx){if(g<.5){const y=this.segments[this.samples[f].segIdx],x=2*g,v=(1-x)*this.samples[f].t+x;return y.tangentAtParameter(v)}{const y=this.segments[this.samples[p].segIdx],x=2*(g-.5)*this.samples[p].t;return y.tangentAtParameter(x)}}{const y=this.segments[this.samples[f].segIdx],x=(1-g)*this.samples[f].t+g*this.samples[p].t;return y.tangentAtParameter(x)}}}},558:(i,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BezierSegment=void 0;const u=o(188);class l{constructor(h,f,p,g){this._totalLength=void 0,this.A=h,this.B=f,this.C=p,this.D=g}static sampleSpacing(){return 2}tangentAtParameter(h){const f=Math.max(0,Math.min(1,h));if(f===0||f===1){let v,S;f===0?this.A.x===this.B.x&&this.A.y===this.B.y?(v=this.C.x-this.A.x,S=this.C.y-this.A.y):(v=this.B.x-this.A.x,S=this.B.y-this.A.y):this.D.x===this.C.x&&this.D.y===this.C.y?(v=this.D.x-this.B.x,S=this.D.y-this.B.y):(v=this.D.x-this.C.x,S=this.D.y-this.C.y);const w=Math.hypot(v,S);return Math.abs(w)>1e-4&&(v/=w,S/=w),{x:v,y:S}}const p=1-f;let g=3*this.D.x*Math.pow(f,2)-3*this.C.x*Math.pow(f,2)+6*this.C.x*p*f-6*this.B.x*p*f+3*this.B.x*Math.pow(p,2)-3*this.A.x*Math.pow(p,2),y=3*this.D.y*Math.pow(f,2)-3*this.C.y*Math.pow(f,2)+6*this.C.y*p*f-6*this.B.y*p*f+3*this.B.y*Math.pow(p,2)-3*this.A.y*Math.pow(p,2);const x=Math.hypot(g,y);return Math.abs(x)>1e-4&&(g/=x,y/=x),{x:g,y}}isLinear(){return this.A.x===this.B.x&&this.A.y===this.B.y&&this.C.x===this.D.x&&this.C.y===this.D.y}pointAtParameter(h){const f=Math.max(0,Math.min(1,h));return{x:Math.pow(1-f,3)*this.A.x+3*Math.pow(1-f,2)*f*this.B.x+3*(1-f)*Math.pow(f,2)*this.C.x+Math.pow(f,3)*this.D.x,y:Math.pow(1-f,3)*this.A.y+3*Math.pow(1-f,2)*f*this.B.y+3*(1-f)*Math.pow(f,2)*this.C.y+Math.pow(f,3)*this.D.y}}getTotalLength(){if(this._totalLength===void 0)if(this.isLinear())this._totalLength=Math.hypot(this.D.x-this.A.x,this.D.y-this.A.y);else{const h=Math.max(10,Math.ceil((Math.hypot(this.B.x-this.A.x,this.B.y-this.A.y)+Math.hypot(this.C.x-this.B.x,this.C.y-this.B.y)+Math.hypot(this.D.x-this.C.x,this.D.y-this.C.y))/l.sampleSpacing())),f=(0,u.times)(h).map(g=>this.pointAtParameter(g/(h-1)));let p=0;for(let g=1;g<f.length;g++)p+=Math.hypot(f[g].x-f[g-1].x,f[g].y-f[g-1].y);this._totalLength=p}return this._totalLength}}a.BezierSegment=l},729:(i,a,o)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createFromCommands=a.create=a.createFromElement=a.createFromCircle=a.createFromLine=a.createFromPath=void 0;const u=o(821),l=o(558),c={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};a.createFromPath=h=>{const f=function(y){const x=y.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").replace(/(\d)([A-Za-z])/g,"$1 $2").replace(/([A-Za-z])(\d)/g,"$1 $2").trim().split(/\s*,|\s+/),v=[];let S="",w={};for(;x.length>0;){let E=x.shift();c.hasOwnProperty(E)?S=E:x.unshift(E),w={type:S},c[S].forEach(_=>{E=x.shift(),w[_]=parseFloat(E)}),S==="M"?S="L":S==="m"&&(S="l"),v.push(w)}return v}(h.getAttribute("d"));if(f.length<2)throw new Error(`Path doesn't have enough commands: ${JSON.stringify(f)}`);if(f[0].type!=="M")throw new Error(`Path starts with ${f[0].type} instead of M!`);let p={x:f[0].x,y:f[0].y};f.shift();const g=[];for(;f.length>0;){const y=f.shift();if(y.type==="C")g.push(new l.BezierSegment(p,{x:y.x1,y:y.y1},{x:y.x2,y:y.y2},{x:y.x,y:y.y})),p={x:y.x,y:y.y};else if(y.type==="L")g.push(new l.BezierSegment(p,p,{x:y.x,y:y.y},{x:y.x,y:y.y})),p={x:y.x,y:y.y};else if(y.type==="H")g.push(new l.BezierSegment(p,p,{x:y.x,y:p.y},{x:y.x,y:p.y})),p={x:y.x,y:p.y};else if(y.type==="V")g.push(new l.BezierSegment(p,p,{x:p.x,y:y.y},{x:p.x,y:y.y})),p={x:p.x,y:y.y};else if(y.type!=="Z")throw new Error(`Unsupported path command ${y.type}; use only H, V, M, L, C, Z!`)}return new u.BezierPath(g)},a.createFromLine=h=>{const[f,p,g,y]=["x1","x2","y1","y2"].map(x=>parseFloat(h.getAttribute(x)||"0"));return new u.BezierPath([new l.BezierSegment({x:f,y:g},{x:f,y:g},{x:p,y},{x:p,y})])},a.createFromCircle=h=>{const[f,p,g]=["cx","cy","r"].map(x=>parseFloat(h.getAttribute(x)||"0")),y=1.3;return new u.BezierPath([new l.BezierSegment({x:f-g,y:p},{x:f-g,y:p-y*g},{x:f+g,y:p-y*g},{x:f+g,y:p}),new l.BezierSegment({x:f+g,y:p},{x:f+g,y:p+y*g},{x:f-g,y:p+y*g},{x:f-g,y:p})])},a.createFromElement=h=>{const f=h.tagName.toLowerCase();if(f==="path")return(0,a.createFromPath)(h);if(f==="line")return(0,a.createFromLine)(h);if(f==="circle")return(0,a.createFromCircle)(h);throw new Error(`Unsupported SVG tag: ${f}`)},a.create=h=>{const f=[];for(let p=1;p<h.length;p++){const g=h[p-1],y=h[p];f.push(new l.BezierSegment(g.pt,g.right||g.pt,y.left||y.pt,y.pt))}return new u.BezierPath(f)},a.createFromCommands=h=>{const f=h.slice();if(f.length<2)throw new Error(`Path doesn't have enough commands: ${JSON.stringify(f)}`);if(f[0].type!=="M")throw new Error(`Path starts with ${f[0].type} instead of M!`);let p={x:f[0].x,y:f[0].y},g=Object.assign({},p);const y=[];for(;f.length>0;){const x=f.shift();if(x.type==="M")g={x:x.x,y:x.y},p=g;else if(x.type==="C")y.push(new l.BezierSegment(p,{x:x.x1,y:x.y1},{x:x.x2,y:x.y2},{x:x.x,y:x.y})),p={x:x.x,y:x.y};else if(x.type==="L")x.x===p.x&&x.y===p.y||y.push(new l.BezierSegment(p,p,{x:x.x,y:x.y},{x:x.x,y:x.y})),p={x:x.x,y:x.y};else if(x.type==="H")x.x!==p.x&&y.push(new l.BezierSegment(p,p,{x:x.x,y:p.y},{x:x.x,y:p.y})),p={x:x.x,y:p.y};else if(x.type==="V")x.y!==p.y&&y.push(new l.BezierSegment(p,p,{x:p.x,y:x.y},{x:p.x,y:x.y})),p={x:p.x,y:x.y};else if(x.type==="Q")y.push(new l.BezierSegment(p,{x:p.x+.6666666666666666*(x.x1-p.x),y:p.y+.6666666666666666*(x.y1-p.y)},{x:x.x+.6666666666666666*(x.x1-x.x),y:x.y+.6666666666666666*(x.y1-x.y)},{x:x.x,y:x.y})),p={x:x.x,y:x.y};else{if(x.type!=="Z")throw new Error(`Unsupported path command ${x.type}; use only H, V, M, L, C, Z!`);Math.hypot(p.x-g.x,p.y-g.y)>0&&y.push(new l.BezierSegment(p,p,g,g))}}return new u.BezierPath(y)}},821:function(i,a,o){var u=this&&this.__createBinding||(Object.create?function(c,h,f,p){p===void 0&&(p=f);var g=Object.getOwnPropertyDescriptor(h,f);g&&!("get"in g?!h.__esModule:g.writable||g.configurable)||(g={enumerable:!0,get:function(){return h[f]}}),Object.defineProperty(c,p,g)}:function(c,h,f,p){p===void 0&&(p=f),c[p]=h[f]}),l=this&&this.__exportStar||function(c,h){for(var f in c)f==="default"||Object.prototype.hasOwnProperty.call(h,f)||u(h,c,f)};Object.defineProperty(a,"__esModule",{value:!0}),l(o(177),a),l(o(558),a),l(o(729),a),l(o(856),a)},856:(i,a)=>{Object.defineProperty(a,"__esModule",{value:!0})},188:(i,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.times=void 0,a.times=function(o){const u=[];for(let l=0;l<o;l++)u.push(l);return u}}},s={};return function i(a){var o=s[a];if(o!==void 0)return o.exports;var u=s[a]={exports:{}};return n[a].call(u.exports,u,u.exports,i),u.exports}(821)})())}(BC)),BC.exports}var Yne=Xne();const _R={M:2,L:2,C:6,Q:4},MB=["ttf","otf","woff"],Zne=new RegExp(`\\.(${MB.join("|")})`,"i"),Qne=new RegExp(`([^/]+)(\\.(?:${MB.join("|")}))`,"i"),LB="Sorry, only TTF, OTF and WOFF files are supported.",Jne=["weight","stretch","style"];class MT{constructor(t,n,s,i,a){if(!(n instanceof FontFace))throw Error("FontFace is required");this._pInst=t,this.name=s,this.path=i,this.data=a,this.face=n}static hasGlyphData(t){let{font:n}=t;return typeof n=="object"&&typeof n.data<"u"}fontBounds(t,n,s,i,a,o){var l;({width:i,height:a,options:o}=this._parseArgs(i,a,o));let u=((l=o==null?void 0:o.graphics)==null?void 0:l._renderer)||this._pInst._renderer;if(!u)throw Error("p5 or graphics required for fontBounds()");return u.fontBounds(t,n,s,i,a)}textBounds(t,n,s,i,a,o){var l;({width:i,height:a,options:o}=this._parseArgs(i,a,o));let u=((l=o==null?void 0:o.graphics)==null?void 0:l._renderer)||this._pInst._renderer;if(!u)throw Error("p5 or graphics required for fontBounds()");return u.textBounds(t,n,s,i,a)}textToPaths(t,n,s,i,a,o){if({width:i,height:a,options:o}=this._parseArgs(i,a,o),!this.data)throw Error('No font data available for "'+this.name+`"
Try downloading a local copy of the font file`);return this._lineateAndPathify(t,n,s,i,a,o).map(c=>c.glyphs).flat().map(c=>c.path.commands).flat()}textToPoints(t,n,s,i,a,o){return this.textToContours(t,n,s,i,a,o).reduce((l,c)=>(l.push(...c),l),[])}textToContours(t,n=0,s=0,i,a,o){({width:i,height:a,options:o}=this._parseArgs(i,a,o));const u=this.textToPaths(t,n,s,i,a,o),l=[];for(const c of u)c[0]==="M"&&l.push([]),l[l.length-1].push(c);return l.map(c=>nre(c,o,this))}textToModel(t,n,s,i,a,o){({width:i,height:a,options:o}=this._parseArgs(i,a,o));const u=(o==null?void 0:o.extrude)||0,l=this.textToContours(t,n,s,i,a,o),c=this._pInst.buildGeometry(()=>{if(u===0){this._pInst.beginShape(),this._pInst.normal(0,0,1);for(const h of l){this._pInst.beginContour();for(const{x:f,y:p}of h)this._pInst.vertex(f,p);this._pInst.endContour(this._pInst.CLOSE)}this._pInst.endShape()}else{for(const h of[1,-1]){this._pInst.beginShape();for(const f of l){this._pInst.beginContour();for(const{x:p,y:g}of f)this._pInst.vertex(p,g,h*u*.5);this._pInst.endContour(this._pInst.CLOSE)}this._pInst.endShape(),this._pInst.beginShape()}for(const h of l){this._pInst.beginShape(this._pInst.QUAD_STRIP);for(const f of h)for(const p of[-1,1])this._pInst.vertex(f.x,f.y,p*u*.5);this._pInst.endShape()}}});if(u!==0){c.computeNormals();for(const h of c.faces)if(h.every(f=>c.vertices[f].z<=-u*.5+.1)){for(const f of h)c.vertexNormals[f].set(0,0,-1);h.reverse()}}return c}variations(){var n;let t={};if(this.data){let s=(n=this.face)==null?void 0:n.axes;s&&s.forEach(i=>{t[i.tag]=i.value})}return Jne.forEach(s=>{let i=this.face[s];i!=="normal"&&(t[s]=t[s]||i)}),t}metadata(){var n;let t=((n=this.data)==null?void 0:n.name)||{};for(let s in this.face)/^load/.test(s)||(t[s]=t[s]||this.face[s]);return t}static async list(t=!1){if(t){console.log("There are",document.fonts.size,`font-faces
`);let n=0;for(let s of document.fonts.values()){console.log("FontFace: {");for(let i in s)console.log("  "+i+": "+s[i]);console.log(`}
`),s.status==="loaded"&&n++}console.log(n+" loaded")}return await Array.from(document.fonts)}_verticalAlign(t){var c,h,f;const{sCapHeight:n}=((c=this.data)==null?void 0:c["OS/2"])||{},{unitsPerEm:s=1e3}=((h=this.data)==null?void 0:h.head)||{},{ascender:i=0,descender:a=0}=((f=this.data)==null?void 0:f.hhea)||{},o=i/2;return((n||i+a)/2-o)*t/s}_lineateAndPathify(t,n,s,i,a,o={}){var x,v,S;let u=((x=o==null?void 0:o.graphics)==null?void 0:x._renderer)||this._pInst._renderer,l=u.drawingContext.textBaseline,{lines:c,bounds:h}=u._computeBounds(_i._FONT_BOUNDS,t,n,s,i,a,{ignoreRectMode:!0,...o});c=this._position(u,c,h,i,a);let f=((S=(v=this.data)==null?void 0:v.head)==null?void 0:S.unitsPerEm)||1e3,p=u.states.textSize/f;const g=this._currentAxes(u);let y=c.map(w=>this._lineToGlyphs(w,{scale:p,axs:g}));return u.drawingContext.textBaseline=l,y}_currentAxes(t){var s,i;let n;return(((i=(s=this.data)==null?void 0:s.fvar)==null?void 0:i.length)??0)>0&&(n=this.data.fvar[0].map(([o,u,l,c,h,f])=>{if(!t)return l;if(o==="wght")return t.states.fontWeight;if(o==="wdth")return 100;if(t.textCanvas().style.fontVariationSettings){const p=new RegExp(`\\b${o}s+(d+)`).exec(t.textCanvas().style.fontVariationSettings);return p?parseInt(p[1]):l}else return l})),n}_textToPathPoints(t,n,s,i,a,o){({width:i,height:a,options:o}=this._parseArgs(i,a,o));let u=this.textToPaths(t,n,s,i,a,o);const l=(p,g,y,x)=>{if(fn.dist(g.x,g.y,y.x,y.y)>x){let v={x:(g.x+y.x)/2,y:(g.y+y.y)/2};p.push(v),l(p,g,v,x),l(p,v,y,x)}};let c=[],{textSize:h}=this._pInst._renderer.states,f=h/this.data.head.unitsPerEm*500;for(let p=0;p<u.length;p++){let{type:g,data:y}=u[p];if(g!=="Z"){let x={x:y[y.length-2],y:y[y.length-1]};g==="L"&&c.length&&!(o!=null&&o.nodivide)>0&&l(c,c[c.length-1],x,f),c.push(x)}}return c}_parseArgs(t,n,s={}){return typeof t=="object"?(s=t,t=n=void 0):typeof n=="object"&&(s=n,n=void 0),{width:t,height:n,options:s}}_position(t,n,s,i,a){let{textAlign:o,textLeading:u}=t.states,c=this._measureTextDefault(t,"X").fontBoundingBoxAscent,h=(f,p)=>{let g=s.x,y=s.y+p*u+c,x=t._fontWidthSingle(f);if(o===Ti?g+=(s.w-x)/2:o===Cx&&(g+=s.w-x),typeof i<"u")switch(t.states.rectMode){case Ti:g-=i/2,y-=a/2;break;case Vm:g-=i,y-=a;break}return{text:f,x:g,y}};return n.map(h)}_lineToGlyphs(t,{scale:n=1,axs:s}={}){if(!this.data)throw Error('No font data available for "'+this.name+`"
Try downloading a local copy of the font file`);let i=it.U.shape(this.data,t.text,{axs:s});return t.glyphShapes=i,t.glyphs=this._shapeToPaths(i,t,{scale:n,axs:s}),t}_positionGlyphs(t,n){var l;let s=((l=n==null?void 0:n.graphics)==null?void 0:l._renderer)||this._pInst._renderer;const i=this._currentAxes(s),a=it.U.shape(this.data,t,{axs:i}),o=[];let u=0;for(const c of a)o.push({x:u,index:c.g,shape:c}),u+=c.ax;return o}_singleShapeToPath(t,{scale:n=1,x:s=0,y:i=0,lineX:a=0,lineY:o=0,axs:u}={}){let l=this.data,c=0,{g:h,ax:f,ay:p,dx:g,dy:y}=t,{crds:x,cmds:v}=it.U.glyphToPath(l,h,!0,u),S={path:{commands:[]}};for(let w=0;w<v.length;w++){let E=v[w],_=[E];if(E in _R){let D=_R[E];for(let I=0;I<D;I+=2){let k=x[I+c]+s+g,A=x[I+c+1]+i+y,N=a+k*n,F=o+A*-n;_.push(N),_.push(F)}c+=D}S.path.commands.push(_)}return{glyph:S,ax:f,ay:p}}_shapeToPaths(t,n,{scale:s=1,axs:i}={}){let a=0,o=0,u=[];if(t.length!==n.text.length)throw Error("Invalid shape data");for(let l=0;l<t.length;l++){const{glyph:c,ax:h,ay:f}=this._singleShapeToPath(t[l],{scale:s,x:a,y:o,lineX:n.x,lineY:n.y,axs:i});u.push(c),a+=h,o+=f}return u}_measureTextDefault(t,n){let{textAlign:s,textBaseline:i}=t.states,a=t.textDrawingContext();a.textAlign="left",a.textBaseline="alphabetic";let o=a.measureText(n);return a.textAlign=s,a.textBaseline=i,o}drawPaths(t,n,s){t.strokeStyle=(s==null?void 0:s.stroke)||t.strokeStyle,t.fillStyle=(s==null?void 0:s.fill)||t.fillStyle,t.beginPath(),n.forEach(([i,...a])=>{i==="M"?t.moveTo(...a):i==="L"?t.lineTo(...a):i==="C"?t.bezierCurveTo(...a):i==="Q"?t.quadraticCurveTo(...a):i==="Z"&&t.closePath()}),s!=null&&s.fill&&t.fill(),s!=null&&s.stroke&&t.stroke()}_pathsToCommands(t,n){let s=[];for(let i=0;i<t.length;i++){let a=t[i],{x:o,y:u,path:l}=a,{crds:c,cmds:h}=l;for(let f=0,p=0;p<h.length;p++){let g=h[p],y={type:g,data:[]};if(g=="M"||g=="L")y.data.push(o+c[f]*n,u+c[f+1]*-n),f+=2;else if(g=="C"){for(let x=0;x<6;x+=2)y.data.push(o+c[f+x]*n,u+c[f+x+1]*-n);f+=6}else if(g=="Q"){for(let x=0;x<4;x+=2)y.data.push(o+c[f+x]*n,u+c[f+x+1]*-n);f+=4}s.push(y)}}return s}}async function ky(r,t,n,s,i){let a=ere(t,n,s,i);return a.status!=="loaded"&&await a.load(),document.fonts.add(a),new MT(r,a,t,n,i)}function ere(r,t,n,s){var o;r.includes(" ")&&(r="'"+r+"'");let i=(s==null?void 0:s._compressedData)??(s==null?void 0:s._data);if(!i){if(!Zne.test(t))throw Error(LB);t.startsWith("url(")||(t="url("+t+")"),i=t}if((((o=s==null?void 0:s.fvar)==null?void 0:o.length)??0)>0){n=n||{};for(const[u,l,c,h,f,p]of s.fvar[0])u==="wght"?n.weight=`${l} ${h}`:u==="wdth"&&(n.stretch=`${l}% ${h}%`)}let a=new FontFace(r,i,n);if(a.status==="error")throw Error('Failed to create FontFace for "'+r+'"');return a}function tre(r,t){let n,s=r==null?void 0:r.name;if(s){if(s.fullName)return s.fullName;s.familyName&&(n=s.familyName)}if(!n){let i=Qne.exec(t);i&&i.length>=3?n=i[1]:n=t}return n.includes(" ")&&(n=n.replace(/ /g,"_")),n}function nre(r,t,n){const s=(p,g)=>{if(typeof p!="object")p=g;else for(const y in g)typeof p[y]>"u"&&(p[y]=g[y]);return p},i=(p,g)=>{const y=p.length;return p[g<0?g%y+y:g%y]},a=(p,g)=>{g=g||0;let y=0;for(let x=p.length-1;p.length>3&&x>=0;--x)collinear(i(p,x-1),i(p,x),i(p,x+1),g)&&(p.splice(x%p.length,1),y++);return y},o=Yne.createFromCommands(PB(r));let u=s(t,{sampleFactor:.1,simplifyThreshold:0});const l=Math.max(1,Math.ceil(o.getTotalLength()*u.sampleFactor));let c=[];const h=n._pInst.angleMode(),f=n._pInst.DEGREES;for(let p=0;p<l;p++){const g=o.getTotalLength()*(l===1?0:p/(l-1));c.push({...o.getPointAtLength(g),get angle(){const y=o.getAngleAtLength(g);return h===f?y*180/Math.PI:y},get alpha(){return this.angle}})}return u.simplifyThreshold&&a(c,u.simplifyThreshold),c}function rre(r){return(r.startsWith('"')||r.startsWith("'"))&&r.at(0)===r.at(-1)?r.slice(1,-1).replace(/\/(['"])/g,"$1"):r}function sre(...r){let t=r.shift();(typeof t!="string"||t.length===0)&&p5._friendlyError(LB,"p5.loadFont");let n;typeof r[0]=="string"&&(n=r.shift());let s,i,a;for(let o=0;o<r.length;o++){const u=r[o];typeof u=="function"?s?i=u:s=u:typeof u=="object"&&(a=u)}return{path:t,name:n,success:s,error:i,options:a}}function BB(r,t){r.Font=MT,t.parseFontData=async function(n){let s=n instanceof Uint8Array?n:await t.loadBytes(n);if(!s)throw Error("Failed to load font data");let i=it.parse(s);if(i.length===0||i[0].cmap===void 0)throw Error("parsing font data");return i[0]},t.loadFont=async function(...n){var f;let{path:s,name:i,success:a,error:o,options:{sets:u,...l}={}}=sre(...n),c=s.includes("@font-face");if(c||(f=(await fetch(s,{method:"HEAD"})).headers.get("content-type"))!=null&&f.startsWith("text/css")&&(c=!0,s=await fetch(s).then(y=>y.text())),c){const p=new CSSStyleSheet;await p.replace(s);const g=[];for(const D of p.cssRules)if(D instanceof CSSFontFaceRule){const I=D.style;let k=rre(I.getPropertyValue("font-family"));const A=I.getPropertyValue("src"),N={...l||{}};for(const F of I){if(F==="font-family"||F==="src")continue;const $=F.replace(/^font-/,"").split("-").map((O,M)=>M===0?O:`${O[0].toUpperCase()}${O.slice(1)}`).join("");N[$]=I.getPropertyValue(F)}g.push({name:k,src:A,fontDescriptors:N,loadWithData:async()=>{let F;try{const $=/url\(([^\)]+)\)/.exec(A);if($){let O=$[1];/^['"]/.exec(O)&&O.at(0)===O.at(-1)&&(O=O.slice(1,-1)),F=await t.parseFontData(O)}}catch{}return ky(this,k,A,N,F)},loadWithoutData:()=>ky(this,k,A,N)})}u=u||["latin"];const y=(u instanceof Array?u:[u]).map(D=>D.toLowerCase()),x=Rte.filter(D=>y.some(I=>D.category.includes(I)&&D.category.includes("ext")===I.includes("ext"))),v=new Set(HF.UnicodeRange.parse(x.map(D=>`U+${D.hexrange[0]}-${D.hexrange[1]}`)));let S=0,w=0,E;for(const D of g){if(!D.fontDescriptors.unicodeRange)continue;const k=[...new Set(HF.UnicodeRange.parse(D.fontDescriptors.unicodeRange.split(/,\s*/g))).values()].filter(F=>v.has(F)).length,A={style:"normal",weight:400,...l},N=Object.keys(D.fontDescriptors).filter(F=>D.fontDescriptors[F]===A[F]).length;(N>w||N===w&&k>=S)&&(w=N,S=k,E=D)}const _=E||g.at(-1);for(const D of g)D!==_&&D.loadWithoutData();return _==null?void 0:_.loadWithData()}let h;try{const p=await t.parseFontData(s);i=i||tre(p,s),h=await ky(this,i,s,l,p)}catch{let g=i||s.substring(s.lastIndexOf("/")+1).replace(/\.[^/.]+$/,"");console.warn(`WARN: No glyph data for '${g}', retrying as FontFace`);try{h=await ky(this,g,s,l)}catch(y){if(o)return o(y);throw y}}return a?a(h):h}}const PB=r=>r.map(t=>{const n=t[0];switch(n){case"Z":return{type:n};case"M":case"L":{const[,s,i]=t;return{type:n,x:s,y:i}}case"Q":{const[,s,i,a,o]=t;return{type:n,x1:s,y1:i,x:a,y:o}}case"C":{const[,s,i,a,o,u,l]=t;return{type:n,x1:s,y1:i,x2:a,y2:o,x:u,y:l}}default:throw new Error(`Unexpected path command: ${n}`)}});typeof p5<"u"&&BB(p5,p5.prototype);function ire(r,t){Ht.prototype.maxCachedGlyphs=function(){return 200},MT.prototype._getFontInfo=function(y){this._fontInfos=this._fontInfos||{};const x=JSON.stringify(y);if(this._fontInfos[x])return this._fontInfos[x];{const v=new g(this,{axs:y});return this._fontInfos[x]=v,v}};const n=9,s=n,i=64,a=64,o=64,u=64,l=64,c=64;class h{constructor(x,v){this.width=x,this.height=v,this.infos=[]}findImage(x){const v=this.width*this.height;if(x>v)throw new Error("font is too complex to render in 3D");let S,w;for(let _=this.infos.length-1;_>=0;--_){const D=this.infos[_];if(D.index+x<v){S=D,w=D.imageData;break}}if(!S){try{w=new ImageData(this.width,this.height)}catch{let D=document.getElementsByTagName("canvas")[0];const I=!D;D||(D=document.createElement("canvas"),D.style.display="none",document.body.appendChild(D));const k=D.getContext("2d");k&&(w=k.createImageData(this.width,this.height)),I&&document.body.removeChild(D)}S={index:0,imageData:w},this.infos.push(S)}const E=S.index;return S.index+=x,w._dirty=!0,{imageData:w,index:E}}}function f(y,x,v,S,w){const _=y.imageData.data;let D=y.index++*4;_[D++]=x,_[D++]=v,_[D++]=S,_[D++]=w}const p=Math.sqrt(3);class g{constructor(x,{axs:v}={}){this.font=x,this.axs=v,this.strokeImageInfos=new h(i,a),this.colDimImageInfos=new h(o,u),this.rowDimImageInfos=new h(o,u),this.colCellImageInfos=new h(l,c),this.rowCellImageInfos=new h(l,c),this.glyphInfos={}}getGlyphInfo(x){let v=this.glyphInfos[x.index];if(v)return v;const S=this.axs,{glyph:{path:{commands:w}}}=this.font._singleShapeToPath(x.shape,{axs:S});let E=1/0,_=-1/0,D=1/0,I=-1/0;for(const _e of w)for(let Ne=1;Ne<_e.length;Ne+=2)E=Math.min(E,_e[Ne]),_=Math.max(_,_e[Ne]),D=Math.min(D,_e[Ne+1]),I=Math.max(I,_e[Ne+1]);if(E>=_||D>=I||!w.length)return this.glyphInfos[x.index]={};const k=_-E,A=I-D,N=PB(w);let F;const $=[],O=[],M=[];for(F=n-1;F>=0;--F)M.push([]);for(F=s-1;F>=0;--F)O.push([]);function B(_e,Ne,ve){const Pe=$.length;$.push(ve);function et(lt,ot,bt){for(let Et=lt.length;Et-- >0;){const ft=lt[Et];ot>ft&&(ot=ft),bt<ft&&(bt=ft)}return{min:ot,max:bt}}const Ve=.5,re=et(_e,1,0),Q=Math.max(Math.floor(re.min*n-Ve),0),ce=Math.min(Math.ceil(re.max*n+Ve),n);for(let lt=Q;lt<ce;++lt)M[lt].push(Pe);const xe=et(Ne,1,0),Ge=Math.max(Math.floor(xe.min*s-Ve),0),Oe=Math.min(Math.ceil(xe.max*s+Ve),s);for(let lt=Ge;lt<Oe;++lt)O[lt].push(Pe)}function U(_e,Ne,ve){return _e<Ne?Ne:_e>ve?ve:_e}function V(_e){return U(255*_e,0,255)}class Z{constructor(Ne,ve,Pe,et){this.p0=Ne,this.c0=ve,this.c1=Pe,this.p1=et}toQuadratic(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:((this.c0.x+this.c1.x)*3-(this.p0.x+this.p1.x))/4,cy:((this.c0.y+this.c1.y)*3-(this.p0.y+this.p1.y))/4}}quadError(){return Ee.sub(Ee.sub(this.p1,this.p0),Ee.mult(Ee.sub(this.c1,this.c0),3)).mag()/2}split(Ne){const ve=Ee.lerp(this.p0,this.c0,Ne),Pe=Ee.lerp(this.c0,this.c1,Ne),et=Ee.lerp(ve,Pe,Ne);this.c1=Ee.lerp(this.c1,this.p1,Ne),this.c0=Ee.lerp(Pe,this.c1,Ne);const Ve=Ee.lerp(et,this.c0,Ne),re=new Z(this.p0,ve,et,Ve);return this.p0=Ve,re}splitInflections(){const Ne=Ee.sub(this.c0,this.p0),ve=Ee.sub(Ee.sub(this.c1,this.c0),Ne),Pe=Ee.sub(Ee.sub(Ee.sub(this.p1,this.c1),Ne),Ee.mult(ve,2)),et=[];let Ve=ve.x*Pe.y-ve.y*Pe.x;if(Ve!==0){let re=Ne.x*Pe.y-Ne.y*Pe.x,Q=Ne.x*ve.y-Ne.y*ve.x;const ce=re*re-4*Ve*Q;if(ce>=0){Ve<0&&(Ve=-Ve,re=-re,Q=-Q);const xe=Math.sqrt(ce),Ge=(-re-xe)/(2*Ve);let Oe=(-re+xe)/(2*Ve);Ge>0&&Ge<1&&(et.push(this.split(Ge)),Oe=1-(1-Oe)/(1-Ge)),Oe>0&&Oe<1&&et.push(this.split(Oe))}}return et.push(this),et}}function J(_e,Ne,ve,Pe,et,Ve,re,Q){const ce=new Z(new Ee(_e,Ne),new Ee(ve,Pe),new Ee(et,Ve),new Ee(re,Q)).splitInflections(),xe=[],Ge=30/p;for(let Oe of ce){const lt=[];let ot;for(;ot=Ge/Oe.quadError(),!(ot>=.5*.5*.5);){const bt=Math.pow(ot,1/3),Et=Oe.split(bt),ft=Oe.split(1-bt/(1-bt));xe.push(Et),lt.push(Oe),Oe=ft}ot<1&&xe.push(Oe.split(.5)),xe.push(Oe),Array.prototype.push.apply(xe,lt.reverse())}return xe}function ne(_e,Ne,ve,Pe){const et=(_e+ve)/2,Ve=(Ne+Pe)/2;B([_e,ve],[Ne,Pe],{x:_e,y:Ne,cx:et,cy:Ve})}function z(_e,Ne,ve,Pe){return Math.abs(ve-_e)<1e-5&&Math.abs(Pe-Ne)<1e-5}let X,Y,se,ue;for(const _e of N){const Ne=(_e.x-E)/k,ve=(_e.y-D)/A;if(!z(X,Y,Ne,ve)){switch(_e.type){case"M":{se=Ne,ue=ve;break}case"L":{ne(X,Y,Ne,ve);break}case"Q":{const Pe=(_e.x1-E)/k,et=(_e.y1-D)/A;B([X,Ne,Pe],[Y,ve,et],{x:X,y:Y,cx:Pe,cy:et});break}case"Z":{z(X,Y,se,ue)?$.push({x:X,y:Y}):(ne(X,Y,se,ue),$.push({x:se,y:ue}));break}case"C":{const Pe=(_e.x1-E)/k,et=(_e.y1-D)/A,Ve=(_e.x2-E)/k,re=(_e.y2-D)/A,Q=J(X,Y,Pe,et,Ve,re,Ne,ve);for(let ce=0;ce<Q.length;ce++){const xe=Q[ce].toQuadratic();B([xe.x,xe.x1,xe.cx],[xe.y,xe.y1,xe.cy],xe)}break}default:throw new Error(`unknown command type: ${_e.type}`)}X=Ne,Y=ve}}const fe=$.length,de=this.strokeImageInfos.findImage(fe),be=de.index;for(let _e=0;_e<fe;++_e){const Ne=$[_e];f(de,V(Ne.x),V(Ne.y),V(Ne.cx),V(Ne.cy))}function Me(_e,Ne,ve){const Pe=_e.length,et=Ne.findImage(Pe),Ve=et.index;let re=0;for(let ce=0;ce<Pe;++ce)re+=_e[ce].length;const Q=ve.findImage(re);for(let ce=0;ce<Pe;++ce){const xe=_e[ce],Ge=xe.length,Oe=Q.index;f(et,Oe>>7,Oe&127,Ge>>7,Ge&127);for(let lt=0;lt<Ge;++lt){const ot=xe[lt]+be;f(Q,ot>>7,ot&127,0,0)}}return{cellImageInfo:Q,dimOffset:Ve,dimImageInfo:et}}return v=this.glyphInfos[x.index]={glyph:x,uGlyphRect:[E,D,_,I],strokeImageInfo:de,strokes:$,colInfo:Me(M,this.colDimImageInfos,this.colCellImageInfos),rowInfo:Me(O,this.rowDimImageInfos,this.rowCellImageInfos)},v.uGridOffset=[v.colInfo.dimOffset,v.rowInfo.dimOffset],v}}Ht.prototype._renderText=function(y,x,v,S,w){var V,Z;if(!this.states.textFont||typeof this.states.textFont=="string"){console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.");return}if(v>=S||!this.states.fillColor)return;if(!r.Font.hasGlyphData(this.states.textFont)){console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts with glyph data are supported");return}this.push();const E=this.states.strokeColor,_=this.states.drawMode;this.states.setValue("strokeColor",null),this.states.setValue("drawMode",Tx);const{font:D}=this.states.textFont;if(!D)throw new Error("In WebGL mode, textFont() needs to be given the result of loadFont() instead of a font family name.");const I=D._currentAxes(this);let k=D._getFontInfo(I);const A={x,y:v},F=this.states.textSize/(((Z=(V=D.data)==null?void 0:V.head)==null?void 0:Z.unitsPerEm)||1e3);this.translate(A.x,A.y,0),this.scale(F,F,1);const $=this.GL,O=!this._defaultFontShader,M=this._getFontShader();M.init(),M.bindShader(),O&&(M.setUniform("uGridImageSize",[o,u]),M.setUniform("uCellsImageSize",[l,c]),M.setUniform("uStrokeImageSize",[i,a]),M.setUniform("uGridSize",[n,s]));const B=this.states.fillSet?this.states.curFillColor:[0,0,0,255];this._setGlobalUniforms(M),this._applyColorBlend(B);let U=this.geometryBufferCache.getGeometryByID("glyph");U||(U=this._textGeom=new Ts(1,1,function(){for(let J=0;J<=1;J++)for(let ne=0;ne<=1;ne++)this.vertices.push(new Ee(ne,J,0)),this.uvs.push(ne,J)},this),U.gid="glyph",U.computeFaces().computeNormals(),this.geometryBufferCache.ensureCached(U));for(const J of this.buffers.text)J._prepareBuffer(U,M);this._bindBuffer(this.geometryBufferCache.cache.glyph.indexBuffer,$.ELEMENT_ARRAY_BUFFER),M.setUniform("uMaterialColor",B),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.glyphDataCache=this.glyphDataCache||new Set;try{const J=D._positionGlyphs(y);for(const ne of J){const z=k.getGlyphInfo(ne);if(z.uGlyphRect){const X=z.rowInfo,Y=z.colInfo,se=[z.strokeImageInfo.imageData,X.cellImageInfo.imageData,X.dimImageInfo.imageData,Y.cellImageInfo.imageData,Y.dimImageInfo.imageData];for(const ue of se)this.glyphDataCache.delete(ue),this.glyphDataCache.add(ue);for(;this.glyphDataCache.size>this.maxCachedGlyphs();){const ue=this.glyphDataCache.values().next().value;this.glyphDataCache.delete(ue);const fe=this.textures.get(ue);fe&&(fe.remove(),this.textures.delete(ue))}M.setUniform("uSamplerStrokes",z.strokeImageInfo.imageData),M.setUniform("uSamplerRowStrokes",X.cellImageInfo.imageData),M.setUniform("uSamplerRows",X.dimImageInfo.imageData),M.setUniform("uSamplerColStrokes",Y.cellImageInfo.imageData),M.setUniform("uSamplerCols",Y.dimImageInfo.imageData),M.setUniform("uGridOffset",z.uGridOffset),M.setUniform("uGlyphRect",z.uGlyphRect),M.setUniform("uGlyphOffset",ne.x),M.bindTextures(),$.drawElements($.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)}}}finally{M.unbindShader(),this.states.setValue("strokeColor",E),this.states.setValue("drawMode",_),$.pixelStorei($.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.pop()}}}var PC={},VC={},ER;function are(){return ER||(ER=1,function(r){(function t(n){var s,i,a,o,u,l;function c(D){var I={},k,A;for(k in D)D.hasOwnProperty(k)&&(A=D[k],typeof A=="object"&&A!==null?I[k]=c(A):I[k]=A);return I}function h(D,I){var k,A,N,F;for(A=D.length,N=0;A;)k=A>>>1,F=N+k,I(D[F])?A=k:(N=F+1,A-=k+1);return N}s={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ChainExpression:"ChainExpression",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",PrivateIdentifier:"PrivateIdentifier",Program:"Program",Property:"Property",PropertyDefinition:"PropertyDefinition",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},a={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},o={},u={},l={},i={Break:o,Skip:u,Remove:l};function f(D,I){this.parent=D,this.key=I}f.prototype.replace=function(I){this.parent[this.key]=I},f.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function p(D,I,k,A){this.node=D,this.path=I,this.wrap=k,this.ref=A}function g(){}g.prototype.path=function(){var I,k,A,N,F,$;function O(M,B){if(Array.isArray(B))for(A=0,N=B.length;A<N;++A)M.push(B[A]);else M.push(B)}if(!this.__current.path)return null;for(F=[],I=2,k=this.__leavelist.length;I<k;++I)$=this.__leavelist[I],O(F,$.path);return O(F,this.__current.path),F},g.prototype.type=function(){var D=this.current();return D.type||this.__current.wrap},g.prototype.parents=function(){var I,k,A;for(A=[],I=1,k=this.__leavelist.length;I<k;++I)A.push(this.__leavelist[I].node);return A},g.prototype.current=function(){return this.__current.node},g.prototype.__execute=function(I,k){var A,N;return N=void 0,A=this.__current,this.__current=k,this.__state=null,I&&(N=I.call(this,k.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=A,N},g.prototype.notify=function(I){this.__state=I},g.prototype.skip=function(){this.notify(u)},g.prototype.break=function(){this.notify(o)},g.prototype.remove=function(){this.notify(l)},g.prototype.__initialize=function(D,I){this.visitor=I,this.root=D,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,I.fallback==="iteration"?this.__fallback=Object.keys:typeof I.fallback=="function"&&(this.__fallback=I.fallback),this.__keys=a,I.keys&&(this.__keys=Object.assign(Object.create(this.__keys),I.keys))};function y(D){return D==null?!1:typeof D=="object"&&typeof D.type=="string"}function x(D,I){return(D===s.ObjectExpression||D===s.ObjectPattern)&&I==="properties"}function v(D,I){for(var k=D.length-1;k>=0;--k)if(D[k].node===I)return!0;return!1}g.prototype.traverse=function(I,k){var A,N,F,$,O,M,B,U,V,Z,J,ne;for(this.__initialize(I,k),ne={},A=this.__worklist,N=this.__leavelist,A.push(new p(I,null,null,null)),N.push(new p(null,null,null,null));A.length;){if(F=A.pop(),F===ne){if(F=N.pop(),M=this.__execute(k.leave,F),this.__state===o||M===o)return;continue}if(F.node){if(M=this.__execute(k.enter,F),this.__state===o||M===o)return;if(A.push(ne),N.push(F),this.__state===u||M===u)continue;if($=F.node,O=$.type||F.wrap,Z=this.__keys[O],!Z)if(this.__fallback)Z=this.__fallback($);else throw new Error("Unknown node type "+O+".");for(U=Z.length;(U-=1)>=0;)if(B=Z[U],J=$[B],!!J){if(Array.isArray(J)){for(V=J.length;(V-=1)>=0;)if(J[V]&&!v(N,J[V])){if(x(O,Z[U]))F=new p(J[V],[B,V],"Property",null);else if(y(J[V]))F=new p(J[V],[B,V],null,null);else continue;A.push(F)}}else if(y(J)){if(v(N,J))continue;A.push(new p(J,B,null,null))}}}}},g.prototype.replace=function(I,k){var A,N,F,$,O,M,B,U,V,Z,J,ne,z;function X(Y){var se,ue,fe,de;if(Y.ref.remove()){for(ue=Y.ref.key,de=Y.ref.parent,se=A.length;se--;)if(fe=A[se],fe.ref&&fe.ref.parent===de){if(fe.ref.key<ue)break;--fe.ref.key}}}for(this.__initialize(I,k),J={},A=this.__worklist,N=this.__leavelist,ne={root:I},M=new p(I,null,null,new f(ne,"root")),A.push(M),N.push(M);A.length;){if(M=A.pop(),M===J){if(M=N.pop(),O=this.__execute(k.leave,M),O!==void 0&&O!==o&&O!==u&&O!==l&&M.ref.replace(O),(this.__state===l||O===l)&&X(M),this.__state===o||O===o)return ne.root;continue}if(O=this.__execute(k.enter,M),O!==void 0&&O!==o&&O!==u&&O!==l&&(M.ref.replace(O),M.node=O),(this.__state===l||O===l)&&(X(M),M.node=null),this.__state===o||O===o)return ne.root;if(F=M.node,!!F&&(A.push(J),N.push(M),!(this.__state===u||O===u))){if($=F.type||M.wrap,V=this.__keys[$],!V)if(this.__fallback)V=this.__fallback(F);else throw new Error("Unknown node type "+$+".");for(B=V.length;(B-=1)>=0;)if(z=V[B],Z=F[z],!!Z)if(Array.isArray(Z)){for(U=Z.length;(U-=1)>=0;)if(Z[U]){if(x($,V[B]))M=new p(Z[U],[z,U],"Property",new f(Z,U));else if(y(Z[U]))M=new p(Z[U],[z,U],null,new f(Z,U));else continue;A.push(M)}}else y(Z)&&A.push(new p(Z,z,null,new f(F,z)))}}return ne.root};function S(D,I){var k=new g;return k.traverse(D,I)}function w(D,I){var k=new g;return k.replace(D,I)}function E(D,I){var k;return k=h(I,function(N){return N.range[0]>D.range[0]}),D.extendedRange=[D.range[0],D.range[1]],k!==I.length&&(D.extendedRange[1]=I[k].range[0]),k-=1,k>=0&&(D.extendedRange[0]=I[k].range[1]),D}function _(D,I,k){var A=[],N,F,$,O;if(!D.range)throw new Error("attachComments needs range information");if(!k.length){if(I.length){for($=0,F=I.length;$<F;$+=1)N=c(I[$]),N.extendedRange=[0,D.range[0]],A.push(N);D.leadingComments=A}return D}for($=0,F=I.length;$<F;$+=1)A.push(E(c(I[$]),k));return O=0,S(D,{enter:function(M){for(var B;O<A.length&&(B=A[O],!(B.extendedRange[1]>M.range[0]));)B.extendedRange[1]===M.range[0]?(M.leadingComments||(M.leadingComments=[]),M.leadingComments.push(B),A.splice(O,1)):O+=1;if(O===A.length)return i.Break;if(A[O].extendedRange[0]>M.range[1])return i.Skip}}),O=0,S(D,{leave:function(M){for(var B;O<A.length&&(B=A[O],!(M.range[1]<B.extendedRange[0]));)M.range[1]===B.extendedRange[0]?(M.trailingComments||(M.trailingComments=[]),M.trailingComments.push(B),A.splice(O,1)):O+=1;if(O===A.length)return i.Break;if(A[O].extendedRange[0]>M.range[1])return i.Skip}}),D}return n.Syntax=s,n.traverse=S,n.replace=w,n.attachComments=_,n.VisitorKeys=a,n.VisitorOption=i,n.Controller=g,n.cloneEnvironment=function(){return t({})},n})(r)}(VC)),VC}var im={},zC={exports:{}},DR;function ore(){return DR||(DR=1,function(){function r(o){if(o==null)return!1;switch(o.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function t(o){if(o==null)return!1;switch(o.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function n(o){if(o==null)return!1;switch(o.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function s(o){return n(o)||o!=null&&o.type==="FunctionDeclaration"}function i(o){switch(o.type){case"IfStatement":return o.alternate!=null?o.alternate:o.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return o.body}return null}function a(o){var u;if(o.type!=="IfStatement"||o.alternate==null)return!1;u=o.consequent;do{if(u.type==="IfStatement"&&u.alternate==null)return!0;u=i(u)}while(u);return!1}zC.exports={isExpression:r,isStatement:n,isIterationStatement:t,isSourceElement:s,isProblematicIfStatement:a,trailingStatement:i}}()),zC.exports}var UC={exports:{}},TR;function VB(){return TR||(TR=1,function(){var r,t,n,s,i,a;t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},r={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function o(v){return 48<=v&&v<=57}function u(v){return 48<=v&&v<=57||97<=v&&v<=102||65<=v&&v<=70}function l(v){return v>=48&&v<=55}n=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function c(v){return v===32||v===9||v===11||v===12||v===160||v>=5760&&n.indexOf(v)>=0}function h(v){return v===10||v===13||v===8232||v===8233}function f(v){if(v<=65535)return String.fromCharCode(v);var S=String.fromCharCode(Math.floor((v-65536)/1024)+55296),w=String.fromCharCode((v-65536)%1024+56320);return S+w}for(s=new Array(128),a=0;a<128;++a)s[a]=a>=97&&a<=122||a>=65&&a<=90||a===36||a===95;for(i=new Array(128),a=0;a<128;++a)i[a]=a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===36||a===95;function p(v){return v<128?s[v]:t.NonAsciiIdentifierStart.test(f(v))}function g(v){return v<128?i[v]:t.NonAsciiIdentifierPart.test(f(v))}function y(v){return v<128?s[v]:r.NonAsciiIdentifierStart.test(f(v))}function x(v){return v<128?i[v]:r.NonAsciiIdentifierPart.test(f(v))}UC.exports={isDecimalDigit:o,isHexDigit:u,isOctalDigit:l,isWhiteSpace:c,isLineTerminator:h,isIdentifierStartES5:p,isIdentifierPartES5:g,isIdentifierStartES6:y,isIdentifierPartES6:x}}()),UC.exports}var GC={exports:{}},NR;function ure(){return NR||(NR=1,function(){var r=VB();function t(p){switch(p){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function n(p,g){return!g&&p==="yield"?!1:s(p,g)}function s(p,g){if(g&&t(p))return!0;switch(p.length){case 2:return p==="if"||p==="in"||p==="do";case 3:return p==="var"||p==="for"||p==="new"||p==="try";case 4:return p==="this"||p==="else"||p==="case"||p==="void"||p==="with"||p==="enum";case 5:return p==="while"||p==="break"||p==="catch"||p==="throw"||p==="const"||p==="yield"||p==="class"||p==="super";case 6:return p==="return"||p==="typeof"||p==="delete"||p==="switch"||p==="export"||p==="import";case 7:return p==="default"||p==="finally"||p==="extends";case 8:return p==="function"||p==="continue"||p==="debugger";case 10:return p==="instanceof";default:return!1}}function i(p,g){return p==="null"||p==="true"||p==="false"||n(p,g)}function a(p,g){return p==="null"||p==="true"||p==="false"||s(p,g)}function o(p){return p==="eval"||p==="arguments"}function u(p){var g,y,x;if(p.length===0||(x=p.charCodeAt(0),!r.isIdentifierStartES5(x)))return!1;for(g=1,y=p.length;g<y;++g)if(x=p.charCodeAt(g),!r.isIdentifierPartES5(x))return!1;return!0}function l(p,g){return(p-55296)*1024+(g-56320)+65536}function c(p){var g,y,x,v,S;if(p.length===0)return!1;for(S=r.isIdentifierStartES6,g=0,y=p.length;g<y;++g){if(x=p.charCodeAt(g),55296<=x&&x<=56319){if(++g,g>=y||(v=p.charCodeAt(g),!(56320<=v&&v<=57343)))return!1;x=l(x,v)}if(!S(x))return!1;S=r.isIdentifierPartES6}return!0}function h(p,g){return u(p)&&!i(p,g)}function f(p,g){return c(p)&&!a(p,g)}GC.exports={isKeywordES5:n,isKeywordES6:s,isReservedWordES5:i,isReservedWordES6:a,isRestrictedWord:o,isIdentifierNameES5:u,isIdentifierNameES6:c,isIdentifierES5:h,isIdentifierES6:f}}()),GC.exports}var kR;function lre(){return kR||(kR=1,function(){im.ast=ore(),im.code=VB(),im.keyword=ure()}()),im}var am={},jC={},Ay={},Iy={},AR;function cre(){if(AR)return Iy;AR=1;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Iy.encode=function(t){if(0<=t&&t<r.length)return r[t];throw new TypeError("Must be between 0 and 63: "+t)},Iy.decode=function(t){var n=65,s=90,i=97,a=122,o=48,u=57,l=43,c=47,h=26,f=52;return n<=t&&t<=s?t-n:i<=t&&t<=a?t-i+h:o<=t&&t<=u?t-o+f:t==l?62:t==c?63:-1},Iy}var IR;function zB(){if(IR)return Ay;IR=1;var r=cre(),t=5,n=1<<t,s=n-1,i=n;function a(u){return u<0?(-u<<1)+1:(u<<1)+0}function o(u){var l=(u&1)===1,c=u>>1;return l?-c:c}return Ay.encode=function(l){var c="",h,f=a(l);do h=f&s,f>>>=t,f>0&&(h|=i),c+=r.encode(h);while(f>0);return c},Ay.decode=function(l,c,h){var f=l.length,p=0,g=0,y,x;do{if(c>=f)throw new Error("Expected more digits in base 64 VLQ value.");if(x=r.decode(l.charCodeAt(c++)),x===-1)throw new Error("Invalid base64 digit: "+l.charAt(c-1));y=!!(x&i),x&=s,p=p+(x<<g),g+=t}while(y);h.value=o(p),h.rest=c},Ay}var WC={},$R;function Ag(){return $R||($R=1,function(r){function t(_,D,I){if(D in _)return _[D];if(arguments.length===3)return I;throw new Error('"'+D+'" is a required argument.')}r.getArg=t;var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,s=/^data:.+\,.+$/;function i(_){var D=_.match(n);return D?{scheme:D[1],auth:D[2],host:D[3],port:D[4],path:D[5]}:null}r.urlParse=i;function a(_){var D="";return _.scheme&&(D+=_.scheme+":"),D+="//",_.auth&&(D+=_.auth+"@"),_.host&&(D+=_.host),_.port&&(D+=":"+_.port),_.path&&(D+=_.path),D}r.urlGenerate=a;function o(_){var D=_,I=i(_);if(I){if(!I.path)return _;D=I.path}for(var k=r.isAbsolute(D),A=D.split(/\/+/),N,F=0,$=A.length-1;$>=0;$--)N=A[$],N==="."?A.splice($,1):N===".."?F++:F>0&&(N===""?(A.splice($+1,F),F=0):(A.splice($,2),F--));return D=A.join("/"),D===""&&(D=k?"/":"."),I?(I.path=D,a(I)):D}r.normalize=o;function u(_,D){_===""&&(_="."),D===""&&(D=".");var I=i(D),k=i(_);if(k&&(_=k.path||"/"),I&&!I.scheme)return k&&(I.scheme=k.scheme),a(I);if(I||D.match(s))return D;if(k&&!k.host&&!k.path)return k.host=D,a(k);var A=D.charAt(0)==="/"?D:o(_.replace(/\/+$/,"")+"/"+D);return k?(k.path=A,a(k)):A}r.join=u,r.isAbsolute=function(_){return _.charAt(0)==="/"||n.test(_)};function l(_,D){_===""&&(_="."),_=_.replace(/\/$/,"");for(var I=0;D.indexOf(_+"/")!==0;){var k=_.lastIndexOf("/");if(k<0||(_=_.slice(0,k),_.match(/^([^\/]+:\/)?\/*$/)))return D;++I}return Array(I+1).join("../")+D.substr(_.length+1)}r.relative=l;var c=function(){var _=Object.create(null);return!("__proto__"in _)}();function h(_){return _}function f(_){return g(_)?"$"+_:_}r.toSetString=c?h:f;function p(_){return g(_)?_.slice(1):_}r.fromSetString=c?h:p;function g(_){if(!_)return!1;var D=_.length;if(D<9||_.charCodeAt(D-1)!==95||_.charCodeAt(D-2)!==95||_.charCodeAt(D-3)!==111||_.charCodeAt(D-4)!==116||_.charCodeAt(D-5)!==111||_.charCodeAt(D-6)!==114||_.charCodeAt(D-7)!==112||_.charCodeAt(D-8)!==95||_.charCodeAt(D-9)!==95)return!1;for(var I=D-10;I>=0;I--)if(_.charCodeAt(I)!==36)return!1;return!0}function y(_,D,I){var k=v(_.source,D.source);return k!==0||(k=_.originalLine-D.originalLine,k!==0)||(k=_.originalColumn-D.originalColumn,k!==0||I)||(k=_.generatedColumn-D.generatedColumn,k!==0)||(k=_.generatedLine-D.generatedLine,k!==0)?k:v(_.name,D.name)}r.compareByOriginalPositions=y;function x(_,D,I){var k=_.generatedLine-D.generatedLine;return k!==0||(k=_.generatedColumn-D.generatedColumn,k!==0||I)||(k=v(_.source,D.source),k!==0)||(k=_.originalLine-D.originalLine,k!==0)||(k=_.originalColumn-D.originalColumn,k!==0)?k:v(_.name,D.name)}r.compareByGeneratedPositionsDeflated=x;function v(_,D){return _===D?0:_===null?1:D===null?-1:_>D?1:-1}function S(_,D){var I=_.generatedLine-D.generatedLine;return I!==0||(I=_.generatedColumn-D.generatedColumn,I!==0)||(I=v(_.source,D.source),I!==0)||(I=_.originalLine-D.originalLine,I!==0)||(I=_.originalColumn-D.originalColumn,I!==0)?I:v(_.name,D.name)}r.compareByGeneratedPositionsInflated=S;function w(_){return JSON.parse(_.replace(/^\)]}'[^\n]*\n/,""))}r.parseSourceMapInput=w;function E(_,D,I){if(D=D||"",_&&(_[_.length-1]!=="/"&&D[0]!=="/"&&(_+="/"),D=_+D),I){var k=i(I);if(!k)throw new Error("sourceMapURL could not be parsed");if(k.path){var A=k.path.lastIndexOf("/");A>=0&&(k.path=k.path.substring(0,A+1))}D=u(a(k),D)}return o(D)}r.computeSourceURL=E}(WC)),WC}var HC={},FR;function UB(){if(FR)return HC;FR=1;var r=Ag(),t=Object.prototype.hasOwnProperty,n=typeof Map<"u";function s(){this._array=[],this._set=n?new Map:Object.create(null)}return s.fromArray=function(a,o){for(var u=new s,l=0,c=a.length;l<c;l++)u.add(a[l],o);return u},s.prototype.size=function(){return n?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(a,o){var u=n?a:r.toSetString(a),l=n?this.has(a):t.call(this._set,u),c=this._array.length;(!l||o)&&this._array.push(a),l||(n?this._set.set(a,c):this._set[u]=c)},s.prototype.has=function(a){if(n)return this._set.has(a);var o=r.toSetString(a);return t.call(this._set,o)},s.prototype.indexOf=function(a){if(n){var o=this._set.get(a);if(o>=0)return o}else{var u=r.toSetString(a);if(t.call(this._set,u))return this._set[u]}throw new Error('"'+a+'" is not in the set.')},s.prototype.at=function(a){if(a>=0&&a<this._array.length)return this._array[a];throw new Error("No element indexed by "+a)},s.prototype.toArray=function(){return this._array.slice()},HC.ArraySet=s,HC}var qC={},RR;function hre(){if(RR)return qC;RR=1;var r=Ag();function t(s,i){var a=s.generatedLine,o=i.generatedLine,u=s.generatedColumn,l=i.generatedColumn;return o>a||o==a&&l>=u||r.compareByGeneratedPositionsInflated(s,i)<=0}function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return n.prototype.unsortedForEach=function(i,a){this._array.forEach(i,a)},n.prototype.add=function(i){t(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))},n.prototype.toArray=function(){return this._sorted||(this._array.sort(r.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},qC.MappingList=n,qC}var OR;function GB(){if(OR)return jC;OR=1;var r=zB(),t=Ag(),n=UB().ArraySet,s=hre().MappingList;function i(a){a||(a={}),this._file=t.getArg(a,"file",null),this._sourceRoot=t.getArg(a,"sourceRoot",null),this._skipValidation=t.getArg(a,"skipValidation",!1),this._sources=new n,this._names=new n,this._mappings=new s,this._sourcesContents=null}return i.prototype._version=3,i.fromSourceMap=function(o){var u=o.sourceRoot,l=new i({file:o.file,sourceRoot:u});return o.eachMapping(function(c){var h={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(h.source=c.source,u!=null&&(h.source=t.relative(u,h.source)),h.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(h.name=c.name)),l.addMapping(h)}),o.sources.forEach(function(c){var h=c;u!==null&&(h=t.relative(u,c)),l._sources.has(h)||l._sources.add(h);var f=o.sourceContentFor(c);f!=null&&l.setSourceContent(c,f)}),l},i.prototype.addMapping=function(o){var u=t.getArg(o,"generated"),l=t.getArg(o,"original",null),c=t.getArg(o,"source",null),h=t.getArg(o,"name",null);this._skipValidation||this._validateMapping(u,l,c,h),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),h!=null&&(h=String(h),this._names.has(h)||this._names.add(h)),this._mappings.add({generatedLine:u.line,generatedColumn:u.column,originalLine:l!=null&&l.line,originalColumn:l!=null&&l.column,source:c,name:h})},i.prototype.setSourceContent=function(o,u){var l=o;this._sourceRoot!=null&&(l=t.relative(this._sourceRoot,l)),u!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(l)]=u):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},i.prototype.applySourceMap=function(o,u,l){var c=u;if(u==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=o.file}var h=this._sourceRoot;h!=null&&(c=t.relative(h,c));var f=new n,p=new n;this._mappings.unsortedForEach(function(g){if(g.source===c&&g.originalLine!=null){var y=o.originalPositionFor({line:g.originalLine,column:g.originalColumn});y.source!=null&&(g.source=y.source,l!=null&&(g.source=t.join(l,g.source)),h!=null&&(g.source=t.relative(h,g.source)),g.originalLine=y.line,g.originalColumn=y.column,y.name!=null&&(g.name=y.name))}var x=g.source;x!=null&&!f.has(x)&&f.add(x);var v=g.name;v!=null&&!p.has(v)&&p.add(v)},this),this._sources=f,this._names=p,o.sources.forEach(function(g){var y=o.sourceContentFor(g);y!=null&&(l!=null&&(g=t.join(l,g)),h!=null&&(g=t.relative(h,g)),this.setSourceContent(g,y))},this)},i.prototype._validateMapping=function(o,u,l,c){if(u&&typeof u.line!="number"&&typeof u.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!u&&!l&&!c)){if(o&&"line"in o&&"column"in o&&u&&"line"in u&&"column"in u&&o.line>0&&o.column>=0&&u.line>0&&u.column>=0&&l)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:l,original:u,name:c}))}},i.prototype._serializeMappings=function(){for(var o=0,u=1,l=0,c=0,h=0,f=0,p="",g,y,x,v,S=this._mappings.toArray(),w=0,E=S.length;w<E;w++){if(y=S[w],g="",y.generatedLine!==u)for(o=0;y.generatedLine!==u;)g+=";",u++;else if(w>0){if(!t.compareByGeneratedPositionsInflated(y,S[w-1]))continue;g+=","}g+=r.encode(y.generatedColumn-o),o=y.generatedColumn,y.source!=null&&(v=this._sources.indexOf(y.source),g+=r.encode(v-f),f=v,g+=r.encode(y.originalLine-1-c),c=y.originalLine-1,g+=r.encode(y.originalColumn-l),l=y.originalColumn,y.name!=null&&(x=this._names.indexOf(y.name),g+=r.encode(x-h),h=x)),p+=g}return p},i.prototype._generateSourcesContent=function(o,u){return o.map(function(l){if(!this._sourcesContents)return null;u!=null&&(l=t.relative(u,l));var c=t.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)},i.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},i.prototype.toString=function(){return JSON.stringify(this.toJSON())},jC.SourceMapGenerator=i,jC}var om={},KC={},MR;function fre(){return MR||(MR=1,function(r){r.GREATEST_LOWER_BOUND=1,r.LEAST_UPPER_BOUND=2;function t(n,s,i,a,o,u){var l=Math.floor((s-n)/2)+n,c=o(i,a[l],!0);return c===0?l:c>0?s-l>1?t(l,s,i,a,o,u):u==r.LEAST_UPPER_BOUND?s<a.length?s:-1:l:l-n>1?t(n,l,i,a,o,u):u==r.LEAST_UPPER_BOUND?l:n<0?-1:n}r.search=function(s,i,a,o){if(i.length===0)return-1;var u=t(-1,i.length,s,i,a,o||r.GREATEST_LOWER_BOUND);if(u<0)return-1;for(;u-1>=0&&a(i[u],i[u-1],!0)===0;)--u;return u}}(KC)),KC}var XC={},LR;function dre(){if(LR)return XC;LR=1;function r(s,i,a){var o=s[i];s[i]=s[a],s[a]=o}function t(s,i){return Math.round(s+Math.random()*(i-s))}function n(s,i,a,o){if(a<o){var u=t(a,o),l=a-1;r(s,u,o);for(var c=s[o],h=a;h<o;h++)i(s[h],c)<=0&&(l+=1,r(s,l,h));r(s,l+1,h);var f=l+1;n(s,i,a,f-1),n(s,i,f+1,o)}}return XC.quickSort=function(s,i){n(s,i,0,s.length-1)},XC}var BR;function pre(){if(BR)return om;BR=1;var r=Ag(),t=fre(),n=UB().ArraySet,s=zB(),i=dre().quickSort;function a(c,h){var f=c;return typeof c=="string"&&(f=r.parseSourceMapInput(c)),f.sections!=null?new l(f,h):new o(f,h)}a.fromSourceMap=function(c,h){return o.fromSourceMap(c,h)},a.prototype._version=3,a.prototype.__generatedMappings=null,Object.defineProperty(a.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),a.prototype.__originalMappings=null,Object.defineProperty(a.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),a.prototype._charIsMappingSeparator=function(h,f){var p=h.charAt(f);return p===";"||p===","},a.prototype._parseMappings=function(h,f){throw new Error("Subclasses must implement _parseMappings")},a.GENERATED_ORDER=1,a.ORIGINAL_ORDER=2,a.GREATEST_LOWER_BOUND=1,a.LEAST_UPPER_BOUND=2,a.prototype.eachMapping=function(h,f,p){var g=f||null,y=p||a.GENERATED_ORDER,x;switch(y){case a.GENERATED_ORDER:x=this._generatedMappings;break;case a.ORIGINAL_ORDER:x=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var v=this.sourceRoot;x.map(function(S){var w=S.source===null?null:this._sources.at(S.source);return w=r.computeSourceURL(v,w,this._sourceMapURL),{source:w,generatedLine:S.generatedLine,generatedColumn:S.generatedColumn,originalLine:S.originalLine,originalColumn:S.originalColumn,name:S.name===null?null:this._names.at(S.name)}},this).forEach(h,g)},a.prototype.allGeneratedPositionsFor=function(h){var f=r.getArg(h,"line"),p={source:r.getArg(h,"source"),originalLine:f,originalColumn:r.getArg(h,"column",0)};if(p.source=this._findSourceIndex(p.source),p.source<0)return[];var g=[],y=this._findMapping(p,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(y>=0){var x=this._originalMappings[y];if(h.column===void 0)for(var v=x.originalLine;x&&x.originalLine===v;)g.push({line:r.getArg(x,"generatedLine",null),column:r.getArg(x,"generatedColumn",null),lastColumn:r.getArg(x,"lastGeneratedColumn",null)}),x=this._originalMappings[++y];else for(var S=x.originalColumn;x&&x.originalLine===f&&x.originalColumn==S;)g.push({line:r.getArg(x,"generatedLine",null),column:r.getArg(x,"generatedColumn",null),lastColumn:r.getArg(x,"lastGeneratedColumn",null)}),x=this._originalMappings[++y]}return g},om.SourceMapConsumer=a;function o(c,h){var f=c;typeof c=="string"&&(f=r.parseSourceMapInput(c));var p=r.getArg(f,"version"),g=r.getArg(f,"sources"),y=r.getArg(f,"names",[]),x=r.getArg(f,"sourceRoot",null),v=r.getArg(f,"sourcesContent",null),S=r.getArg(f,"mappings"),w=r.getArg(f,"file",null);if(p!=this._version)throw new Error("Unsupported version: "+p);x&&(x=r.normalize(x)),g=g.map(String).map(r.normalize).map(function(E){return x&&r.isAbsolute(x)&&r.isAbsolute(E)?r.relative(x,E):E}),this._names=n.fromArray(y.map(String),!0),this._sources=n.fromArray(g,!0),this._absoluteSources=this._sources.toArray().map(function(E){return r.computeSourceURL(x,E,h)}),this.sourceRoot=x,this.sourcesContent=v,this._mappings=S,this._sourceMapURL=h,this.file=w}o.prototype=Object.create(a.prototype),o.prototype.consumer=a,o.prototype._findSourceIndex=function(c){var h=c;if(this.sourceRoot!=null&&(h=r.relative(this.sourceRoot,h)),this._sources.has(h))return this._sources.indexOf(h);var f;for(f=0;f<this._absoluteSources.length;++f)if(this._absoluteSources[f]==c)return f;return-1},o.fromSourceMap=function(h,f){var p=Object.create(o.prototype),g=p._names=n.fromArray(h._names.toArray(),!0),y=p._sources=n.fromArray(h._sources.toArray(),!0);p.sourceRoot=h._sourceRoot,p.sourcesContent=h._generateSourcesContent(p._sources.toArray(),p.sourceRoot),p.file=h._file,p._sourceMapURL=f,p._absoluteSources=p._sources.toArray().map(function(I){return r.computeSourceURL(p.sourceRoot,I,f)});for(var x=h._mappings.toArray().slice(),v=p.__generatedMappings=[],S=p.__originalMappings=[],w=0,E=x.length;w<E;w++){var _=x[w],D=new u;D.generatedLine=_.generatedLine,D.generatedColumn=_.generatedColumn,_.source&&(D.source=y.indexOf(_.source),D.originalLine=_.originalLine,D.originalColumn=_.originalColumn,_.name&&(D.name=g.indexOf(_.name)),S.push(D)),v.push(D)}return i(p.__originalMappings,r.compareByOriginalPositions),p},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function u(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(h,f){for(var p=1,g=0,y=0,x=0,v=0,S=0,w=h.length,E=0,_={},D={},I=[],k=[],A,N,F,$,O;E<w;)if(h.charAt(E)===";")p++,E++,g=0;else if(h.charAt(E)===",")E++;else{for(A=new u,A.generatedLine=p,$=E;$<w&&!this._charIsMappingSeparator(h,$);$++);if(N=h.slice(E,$),F=_[N],F)E+=N.length;else{for(F=[];E<$;)s.decode(h,E,D),O=D.value,E=D.rest,F.push(O);if(F.length===2)throw new Error("Found a source, but no line and column");if(F.length===3)throw new Error("Found a source and line, but no column");_[N]=F}A.generatedColumn=g+F[0],g=A.generatedColumn,F.length>1&&(A.source=v+F[1],v+=F[1],A.originalLine=y+F[2],y=A.originalLine,A.originalLine+=1,A.originalColumn=x+F[3],x=A.originalColumn,F.length>4&&(A.name=S+F[4],S+=F[4])),k.push(A),typeof A.originalLine=="number"&&I.push(A)}i(k,r.compareByGeneratedPositionsDeflated),this.__generatedMappings=k,i(I,r.compareByOriginalPositions),this.__originalMappings=I},o.prototype._findMapping=function(h,f,p,g,y,x){if(h[p]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+h[p]);if(h[g]<0)throw new TypeError("Column must be greater than or equal to 0, got "+h[g]);return t.search(h,f,y,x)},o.prototype.computeColumnSpans=function(){for(var h=0;h<this._generatedMappings.length;++h){var f=this._generatedMappings[h];if(h+1<this._generatedMappings.length){var p=this._generatedMappings[h+1];if(f.generatedLine===p.generatedLine){f.lastGeneratedColumn=p.generatedColumn-1;continue}}f.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(h){var f={generatedLine:r.getArg(h,"line"),generatedColumn:r.getArg(h,"column")},p=this._findMapping(f,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositionsDeflated,r.getArg(h,"bias",a.GREATEST_LOWER_BOUND));if(p>=0){var g=this._generatedMappings[p];if(g.generatedLine===f.generatedLine){var y=r.getArg(g,"source",null);y!==null&&(y=this._sources.at(y),y=r.computeSourceURL(this.sourceRoot,y,this._sourceMapURL));var x=r.getArg(g,"name",null);return x!==null&&(x=this._names.at(x)),{source:y,line:r.getArg(g,"originalLine",null),column:r.getArg(g,"originalColumn",null),name:x}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(h){return h==null}):!1},o.prototype.sourceContentFor=function(h,f){if(!this.sourcesContent)return null;var p=this._findSourceIndex(h);if(p>=0)return this.sourcesContent[p];var g=h;this.sourceRoot!=null&&(g=r.relative(this.sourceRoot,g));var y;if(this.sourceRoot!=null&&(y=r.urlParse(this.sourceRoot))){var x=g.replace(/^file:\/\//,"");if(y.scheme=="file"&&this._sources.has(x))return this.sourcesContent[this._sources.indexOf(x)];if((!y.path||y.path=="/")&&this._sources.has("/"+g))return this.sourcesContent[this._sources.indexOf("/"+g)]}if(f)return null;throw new Error('"'+g+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(h){var f=r.getArg(h,"source");if(f=this._findSourceIndex(f),f<0)return{line:null,column:null,lastColumn:null};var p={source:f,originalLine:r.getArg(h,"line"),originalColumn:r.getArg(h,"column")},g=this._findMapping(p,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,r.getArg(h,"bias",a.GREATEST_LOWER_BOUND));if(g>=0){var y=this._originalMappings[g];if(y.source===p.source)return{line:r.getArg(y,"generatedLine",null),column:r.getArg(y,"generatedColumn",null),lastColumn:r.getArg(y,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},om.BasicSourceMapConsumer=o;function l(c,h){var f=c;typeof c=="string"&&(f=r.parseSourceMapInput(c));var p=r.getArg(f,"version"),g=r.getArg(f,"sections");if(p!=this._version)throw new Error("Unsupported version: "+p);this._sources=new n,this._names=new n;var y={line:-1,column:0};this._sections=g.map(function(x){if(x.url)throw new Error("Support for url field in sections not implemented.");var v=r.getArg(x,"offset"),S=r.getArg(v,"line"),w=r.getArg(v,"column");if(S<y.line||S===y.line&&w<y.column)throw new Error("Section offsets must be ordered and non-overlapping.");return y=v,{generatedOffset:{generatedLine:S+1,generatedColumn:w+1},consumer:new a(r.getArg(x,"map"),h)}})}return l.prototype=Object.create(a.prototype),l.prototype.constructor=a,l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){for(var c=[],h=0;h<this._sections.length;h++)for(var f=0;f<this._sections[h].consumer.sources.length;f++)c.push(this._sections[h].consumer.sources[f]);return c}}),l.prototype.originalPositionFor=function(h){var f={generatedLine:r.getArg(h,"line"),generatedColumn:r.getArg(h,"column")},p=t.search(f,this._sections,function(y,x){var v=y.generatedLine-x.generatedOffset.generatedLine;return v||y.generatedColumn-x.generatedOffset.generatedColumn}),g=this._sections[p];return g?g.consumer.originalPositionFor({line:f.generatedLine-(g.generatedOffset.generatedLine-1),column:f.generatedColumn-(g.generatedOffset.generatedLine===f.generatedLine?g.generatedOffset.generatedColumn-1:0),bias:h.bias}):{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(h){return h.consumer.hasContentsOfAllSources()})},l.prototype.sourceContentFor=function(h,f){for(var p=0;p<this._sections.length;p++){var g=this._sections[p],y=g.consumer.sourceContentFor(h,!0);if(y)return y}if(f)return null;throw new Error('"'+h+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(h){for(var f=0;f<this._sections.length;f++){var p=this._sections[f];if(p.consumer._findSourceIndex(r.getArg(h,"source"))!==-1){var g=p.consumer.generatedPositionFor(h);if(g){var y={line:g.line+(p.generatedOffset.generatedLine-1),column:g.column+(p.generatedOffset.generatedLine===g.line?p.generatedOffset.generatedColumn-1:0)};return y}}}return{line:null,column:null}},l.prototype._parseMappings=function(h,f){this.__generatedMappings=[],this.__originalMappings=[];for(var p=0;p<this._sections.length;p++)for(var g=this._sections[p],y=g.consumer._generatedMappings,x=0;x<y.length;x++){var v=y[x],S=g.consumer._sources.at(v.source);S=r.computeSourceURL(g.consumer.sourceRoot,S,this._sourceMapURL),this._sources.add(S),S=this._sources.indexOf(S);var w=null;v.name&&(w=g.consumer._names.at(v.name),this._names.add(w),w=this._names.indexOf(w));var E={source:S,generatedLine:v.generatedLine+(g.generatedOffset.generatedLine-1),generatedColumn:v.generatedColumn+(g.generatedOffset.generatedLine===v.generatedLine?g.generatedOffset.generatedColumn-1:0),originalLine:v.originalLine,originalColumn:v.originalColumn,name:w};this.__generatedMappings.push(E),typeof E.originalLine=="number"&&this.__originalMappings.push(E)}i(this.__generatedMappings,r.compareByGeneratedPositionsDeflated),i(this.__originalMappings,r.compareByOriginalPositions)},om.IndexedSourceMapConsumer=l,om}var YC={},PR;function mre(){if(PR)return YC;PR=1;var r=GB().SourceMapGenerator,t=Ag(),n=/(\r?\n)/,s=10,i="$$$isSourceNode$$$";function a(o,u,l,c,h){this.children=[],this.sourceContents={},this.line=o??null,this.column=u??null,this.source=l??null,this.name=h??null,this[i]=!0,c!=null&&this.add(c)}return a.fromStringWithSourceMap=function(u,l,c){var h=new a,f=u.split(n),p=0,g=function(){var w=_(),E=_()||"";return w+E;function _(){return p<f.length?f[p++]:void 0}},y=1,x=0,v=null;return l.eachMapping(function(w){if(v!==null)if(y<w.generatedLine)S(v,g()),y++,x=0;else{var E=f[p]||"",_=E.substr(0,w.generatedColumn-x);f[p]=E.substr(w.generatedColumn-x),x=w.generatedColumn,S(v,_),v=w;return}for(;y<w.generatedLine;)h.add(g()),y++;if(x<w.generatedColumn){var E=f[p]||"";h.add(E.substr(0,w.generatedColumn)),f[p]=E.substr(w.generatedColumn),x=w.generatedColumn}v=w},this),p<f.length&&(v&&S(v,g()),h.add(f.splice(p).join(""))),l.sources.forEach(function(w){var E=l.sourceContentFor(w);E!=null&&(c!=null&&(w=t.join(c,w)),h.setSourceContent(w,E))}),h;function S(w,E){if(w===null||w.source===void 0)h.add(E);else{var _=c?t.join(c,w.source):w.source;h.add(new a(w.originalLine,w.originalColumn,_,E,w.name))}}},a.prototype.add=function(u){if(Array.isArray(u))u.forEach(function(l){this.add(l)},this);else if(u[i]||typeof u=="string")u&&this.children.push(u);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+u);return this},a.prototype.prepend=function(u){if(Array.isArray(u))for(var l=u.length-1;l>=0;l--)this.prepend(u[l]);else if(u[i]||typeof u=="string")this.children.unshift(u);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+u);return this},a.prototype.walk=function(u){for(var l,c=0,h=this.children.length;c<h;c++)l=this.children[c],l[i]?l.walk(u):l!==""&&u(l,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(u){var l,c,h=this.children.length;if(h>0){for(l=[],c=0;c<h-1;c++)l.push(this.children[c]),l.push(u);l.push(this.children[c]),this.children=l}return this},a.prototype.replaceRight=function(u,l){var c=this.children[this.children.length-1];return c[i]?c.replaceRight(u,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(u,l):this.children.push("".replace(u,l)),this},a.prototype.setSourceContent=function(u,l){this.sourceContents[t.toSetString(u)]=l},a.prototype.walkSourceContents=function(u){for(var l=0,c=this.children.length;l<c;l++)this.children[l][i]&&this.children[l].walkSourceContents(u);for(var h=Object.keys(this.sourceContents),l=0,c=h.length;l<c;l++)u(t.fromSetString(h[l]),this.sourceContents[h[l]])},a.prototype.toString=function(){var u="";return this.walk(function(l){u+=l}),u},a.prototype.toStringWithSourceMap=function(u){var l={code:"",line:1,column:0},c=new r(u),h=!1,f=null,p=null,g=null,y=null;return this.walk(function(x,v){l.code+=x,v.source!==null&&v.line!==null&&v.column!==null?((f!==v.source||p!==v.line||g!==v.column||y!==v.name)&&c.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:l.line,column:l.column},name:v.name}),f=v.source,p=v.line,g=v.column,y=v.name,h=!0):h&&(c.addMapping({generated:{line:l.line,column:l.column}}),f=null,h=!1);for(var S=0,w=x.length;S<w;S++)x.charCodeAt(S)===s?(l.line++,l.column=0,S+1===w?(f=null,h=!1):h&&c.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:l.line,column:l.column},name:v.name})):l.column++}),this.walkSourceContents(function(x,v){c.setSourceContent(x,v)}),{code:l.code,map:c}},YC.SourceNode=a,YC}var VR;function gre(){return VR||(VR=1,am.SourceMapGenerator=GB().SourceMapGenerator,am.SourceMapConsumer=pre().SourceMapConsumer,am.SourceNode=mre().SourceNode),am}const yre="2.1.0",xre={version:yre};var zR;function bre(){return zR||(zR=1,function(r){(function(){var t,n,s,i,a,o,u,l,c,h,f,p,g,y,x,v,S,w,E,_,D,I,k,A,N,F;a=are(),o=lre(),t=a.Syntax;function $(L){return ge.Expression.hasOwnProperty(L.type)}function O(L){return ge.Statement.hasOwnProperty(L.type)}n={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,Coalesce:3,LogicalOR:4,LogicalAND:5,BitwiseOR:6,BitwiseXOR:7,BitwiseAND:8,Equality:9,Relational:10,BitwiseSHIFT:11,Additive:12,Multiplicative:13,Exponentiation:14,Await:15,Unary:15,Postfix:16,OptionalChaining:17,Call:18,New:19,TaggedTemplate:20,Member:21,Primary:22},s={"??":n.Coalesce,"||":n.LogicalOR,"&&":n.LogicalAND,"|":n.BitwiseOR,"^":n.BitwiseXOR,"&":n.BitwiseAND,"==":n.Equality,"!=":n.Equality,"===":n.Equality,"!==":n.Equality,is:n.Equality,isnt:n.Equality,"<":n.Relational,">":n.Relational,"<=":n.Relational,">=":n.Relational,in:n.Relational,instanceof:n.Relational,"<<":n.BitwiseSHIFT,">>":n.BitwiseSHIFT,">>>":n.BitwiseSHIFT,"+":n.Additive,"-":n.Additive,"*":n.Multiplicative,"%":n.Multiplicative,"/":n.Multiplicative,"**":n.Exponentiation};var M=1,B=2,U=4,V=8,Z=16,J=32,ne=64,z=B|U,X=M|B,Y=M|B|U,se=M,ue=U,fe=M|U,de=M,be=M|J,Me=0,_e=M|Z,Ne=M|V;function ve(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Pe(L,q){var W="";for(q|=0;q>0;q>>>=1,L+=L)q&1&&(W+=L);return W}function et(L){return/[\r\n]/g.test(L)}function Ve(L){var q=L.length;return q&&o.code.isLineTerminator(L.charCodeAt(q-1))}function re(L,q){var W;for(W in q)q.hasOwnProperty(W)&&(L[W]=q[W]);return L}function Q(L,q){var W,H;function ae(qe){return typeof qe=="object"&&qe instanceof Object&&!(qe instanceof RegExp)}for(W in q)q.hasOwnProperty(W)&&(H=q[W],ae(H)?ae(L[W])?Q(L[W],H):L[W]=Q({},H):L[W]=H);return L}function ce(L){var q,W,H,ae,qe;if(L!==L)throw new Error("Numeric literal whose value is NaN");if(L<0||L===0&&1/L<0)throw new Error("Numeric literal whose value is negative");if(L===1/0)return c?"null":h?"1e400":"1e+400";if(q=""+L,!h||q.length<3)return q;for(W=q.indexOf("."),!c&&q.charCodeAt(0)===48&&W===1&&(W=0,q=q.slice(1)),H=q,q=q.replace("e+","e"),ae=0,(qe=H.indexOf("e"))>0&&(ae=+H.slice(qe+1),H=H.slice(0,qe)),W>=0&&(ae-=H.length-W-1,H=+(H.slice(0,W)+H.slice(W+1))+""),qe=0;H.charCodeAt(H.length+qe-1)===48;)--qe;return qe!==0&&(ae-=qe,H=H.slice(0,qe)),ae!==0&&(H+="e"+ae),(H.length<q.length||f&&L>1e12&&Math.floor(L)===L&&(H="0x"+L.toString(16)).length<q.length)&&+H===L&&(q=H),q}function xe(L,q){return(L&-2)===8232?(q?"u":"\\u")+(L===8232?"2028":"2029"):L===10||L===13?(q?"":"\\")+(L===10?"n":"r"):String.fromCharCode(L)}function Ge(L){var q,W,H,ae,qe,Ze,Qe,ct;if(W=L.toString(),L.source){if(q=W.match(/\/([^/]*)$/),!q)return W;for(H=q[1],W="",Qe=!1,ct=!1,ae=0,qe=L.source.length;ae<qe;++ae)Ze=L.source.charCodeAt(ae),ct?(W+=xe(Ze,ct),ct=!1):(Qe?Ze===93&&(Qe=!1):Ze===47?W+="\\":Ze===91&&(Qe=!0),W+=xe(Ze,ct),ct=Ze===92);return"/"+W+"/"+H}return W}function Oe(L,q){var W;return L===8?"\\b":L===12?"\\f":L===9?"\\t":(W=L.toString(16).toUpperCase(),c||L>255?"\\u"+"0000".slice(W.length)+W:L===0&&!o.code.isDecimalDigit(q)?"\\0":L===11?"\\x0B":"\\x"+"00".slice(W.length)+W)}function lt(L){if(L===92)return"\\\\";if(L===10)return"\\n";if(L===13)return"\\r";if(L===8232)return"\\u2028";if(L===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function ot(L){var q,W,H,ae;for(ae=p==="double"?'"':"'",q=0,W=L.length;q<W;++q)if(H=L.charCodeAt(q),H===39){ae='"';break}else if(H===34){ae="'";break}else H===92&&++q;return ae+L+ae}function bt(L){var q="",W,H,ae,qe=0,Ze=0,Qe,ct;for(W=0,H=L.length;W<H;++W){if(ae=L.charCodeAt(W),ae===39)++qe;else if(ae===34)++Ze;else if(ae===47&&c)q+="\\";else if(o.code.isLineTerminator(ae)||ae===92){q+=lt(ae);continue}else if(!o.code.isIdentifierPartES5(ae)&&(c&&ae<32||!c&&!g&&(ae<32||ae>126))){q+=Oe(ae,L.charCodeAt(W+1));continue}q+=String.fromCharCode(ae)}if(Qe=!(p==="double"||p==="auto"&&Ze<qe),ct=Qe?"'":'"',!(Qe?qe:Ze))return ct+q+ct;for(L=q,q=ct,W=0,H=L.length;W<H;++W)ae=L.charCodeAt(W),(ae===39&&Qe||ae===34&&!Qe)&&(q+="\\"),q+=String.fromCharCode(ae);return q+ct}function Et(L){var q,W,H,ae="";for(q=0,W=L.length;q<W;++q)H=L[q],ae+=Array.isArray(H)?Et(H):H;return ae}function ft(L,q){if(!I)return Array.isArray(L)?Et(L):L;if(q==null){if(L instanceof i)return L;q={}}return q.loc==null?new i(null,null,I,L,q.name||null):new i(q.loc.start.line,q.loc.start.column,I===!0?q.loc.source||null:I,L,q.name||null)}function It(){return x||" "}function ut(L,q){var W,H,ae,qe;return W=ft(L).toString(),W.length===0?[q]:(H=ft(q).toString(),H.length===0?[L]:(ae=W.charCodeAt(W.length-1),qe=H.charCodeAt(0),(ae===43||ae===45)&&ae===qe||o.code.isIdentifierPartES5(ae)&&o.code.isIdentifierPartES5(qe)||ae===47&&qe===105?[L,It(),q]:o.code.isWhiteSpace(ae)||o.code.isLineTerminator(ae)||o.code.isWhiteSpace(qe)||o.code.isLineTerminator(qe)?[L,q]:[L,x,q]))}function wt(L){return[u,L]}function St(L){var q;q=u,u+=l,L(u),u=q}function hr(L){var q;for(q=L.length-1;q>=0&&!o.code.isLineTerminator(L.charCodeAt(q));--q);return L.length-1-q}function qn(L,q){var W,H,ae,qe,Ze,Qe,ct,Gt;for(W=L.split(/\r\n|[\r\n]/),Qe=Number.MAX_VALUE,H=1,ae=W.length;H<ae;++H){for(qe=W[H],Ze=0;Ze<qe.length&&o.code.isWhiteSpace(qe.charCodeAt(Ze));)++Ze;Qe>Ze&&(Qe=Ze)}for(typeof q<"u"?(ct=u,W[1][Qe]==="*"&&(q+=" "),u=q):(Qe&1&&--Qe,ct=u),H=1,ae=W.length;H<ae;++H)Gt=ft(wt(W[H].slice(Qe))),W[H]=I?Gt.join(""):Gt;return u=ct,W.join(`
`)}function sn(L,q){if(L.type==="Line"){if(Ve(L.value))return"//"+L.value;var W="//"+L.value;return A||(W+=`
`),W}return _.format.indent.adjustMultilineComment&&/[\n\r]/.test(L.value)?qn("/*"+L.value+"*/",q):"/*"+L.value+"*/"}function Pn(L,q){var W,H,ae,qe,Ze,Qe,ct,Gt,pn,ws,Br,oo,Rh,Ms;if(L.leadingComments&&L.leadingComments.length>0){if(qe=q,A){for(ae=L.leadingComments[0],q=[],Gt=ae.extendedRange,pn=ae.range,Br=k.substring(Gt[0],pn[0]),Ms=(Br.match(/\n/g)||[]).length,Ms>0?(q.push(Pe(`
`,Ms)),q.push(wt(sn(ae)))):(q.push(Br),q.push(sn(ae))),ws=pn,W=1,H=L.leadingComments.length;W<H;W++)ae=L.leadingComments[W],pn=ae.range,oo=k.substring(ws[1],pn[0]),Ms=(oo.match(/\n/g)||[]).length,q.push(Pe(`
`,Ms)),q.push(wt(sn(ae))),ws=pn;Rh=k.substring(pn[1],Gt[1]),Ms=(Rh.match(/\n/g)||[]).length,q.push(Pe(`
`,Ms))}else for(ae=L.leadingComments[0],q=[],w&&L.type===t.Program&&L.body.length===0&&q.push(`
`),q.push(sn(ae)),Ve(ft(q).toString())||q.push(`
`),W=1,H=L.leadingComments.length;W<H;++W)ae=L.leadingComments[W],ct=[sn(ae)],Ve(ft(ct).toString())||ct.push(`
`),q.push(wt(ct));q.push(wt(qe))}if(L.trailingComments)if(A)ae=L.trailingComments[0],Gt=ae.extendedRange,pn=ae.range,Br=k.substring(Gt[0],pn[0]),Ms=(Br.match(/\n/g)||[]).length,Ms>0?(q.push(Pe(`
`,Ms)),q.push(wt(sn(ae)))):(q.push(Br),q.push(sn(ae)));else for(Ze=!Ve(ft(q).toString()),Qe=Pe(" ",hr(ft([u,q,l]).toString())),W=0,H=L.trailingComments.length;W<H;++W)ae=L.trailingComments[W],Ze?(W===0?q=[q,l]:q=[q,Qe],q.push(sn(ae,Qe))):q=[q,wt(sn(ae))],W!==H-1&&!Ve(ft(q).toString())&&(q=[q,`
`]);return q}function P(L,q,W){var H,ae=0;for(H=L;H<q;H++)k[H]===`
`&&ae++;for(H=1;H<ae;H++)W.push(y)}function K(L,q,W){return q<W?["(",L,")"]:L}function ie(L){var q,W,H;for(H=L.split(/\r\n|\n/),q=1,W=H.length;q<W;q++)H[q]=y+u+H[q];return H}function le(L,q){var W,H,ae;return W=L[_.verbatim],typeof W=="string"?H=K(ie(W),n.Sequence,q):(H=ie(W.content),ae=W.precedence!=null?W.precedence:n.Sequence,H=K(H,ae,q)),ft(H,L)}function ge(){}ge.prototype.maybeBlock=function(L,q){var W,H,ae=this;return H=!_.comment||!L.leadingComments,L.type===t.BlockStatement&&H?[x,this.generateStatement(L,q)]:L.type===t.EmptyStatement&&H?";":(St(function(){W=[y,wt(ae.generateStatement(L,q))]}),W)},ge.prototype.maybeBlockSuffix=function(L,q){var W=Ve(ft(q).toString());return L.type===t.BlockStatement&&(!_.comment||!L.leadingComments)&&!W?[q,x]:W?[q,u]:[q,y,u]};function Xe(L){return ft(L.name,L)}function nt(L,q){return L.async?"async"+(q?It():x):""}function gt(L){var q=L.generator&&!_.moz.starlessGenerator;return q?"*"+x:""}function Ft(L){var q=L.value,W="";return q.async&&(W+=nt(q,!L.computed)),q.generator&&(W+=gt(q)?"*":""),W}ge.prototype.generatePattern=function(L,q,W){return L.type===t.Identifier?Xe(L):this.generateExpression(L,q,W)},ge.prototype.generateFunctionParams=function(L){var q,W,H,ae;if(ae=!1,L.type===t.ArrowFunctionExpression&&!L.rest&&(!L.defaults||L.defaults.length===0)&&L.params.length===1&&L.params[0].type===t.Identifier)H=[nt(L,!0),Xe(L.params[0])];else{for(H=L.type===t.ArrowFunctionExpression?[nt(L,!1)]:[],H.push("("),L.defaults&&(ae=!0),q=0,W=L.params.length;q<W;++q)ae&&L.defaults[q]?H.push(this.generateAssignment(L.params[q],L.defaults[q],"=",n.Assignment,Y)):H.push(this.generatePattern(L.params[q],n.Assignment,Y)),q+1<W&&H.push(","+x);L.rest&&(L.params.length&&H.push(","+x),H.push("..."),H.push(Xe(L.rest))),H.push(")")}return H},ge.prototype.generateFunctionBody=function(L){var q,W;return q=this.generateFunctionParams(L),L.type===t.ArrowFunctionExpression&&(q.push(x),q.push("=>")),L.expression?(q.push(x),W=this.generateExpression(L.body,n.Assignment,Y),W.toString().charAt(0)==="{"&&(W=["(",W,")"]),q.push(W)):q.push(this.maybeBlock(L.body,Ne)),q},ge.prototype.generateIterationForStatement=function(L,q,W){var H=["for"+(q.await?It()+"await":"")+x+"("],ae=this;return St(function(){q.left.type===t.VariableDeclaration?St(function(){H.push(q.left.kind+It()),H.push(ae.generateStatement(q.left.declarations[0],Me))}):H.push(ae.generateExpression(q.left,n.Call,Y)),H=ut(H,L),H=[ut(H,ae.generateExpression(q.right,n.Assignment,Y)),")"]}),H.push(this.maybeBlock(q.body,W)),H},ge.prototype.generatePropertyKey=function(L,q){var W=[];return q&&W.push("["),W.push(this.generateExpression(L,n.Assignment,Y)),q&&W.push("]"),W},ge.prototype.generateAssignment=function(L,q,W,H,ae){return n.Assignment<H&&(ae|=M),K([this.generateExpression(L,n.Call,ae),x+W+x,this.generateExpression(q,n.Assignment,ae)],n.Assignment,H)},ge.prototype.semicolon=function(L){return!S&&L&J?"":";"},ge.Statement={BlockStatement:function(L,q){var W,H,ae=["{",y],qe=this;return St(function(){L.body.length===0&&A&&(W=L.range,W[1]-W[0]>2&&(H=k.substring(W[0]+1,W[1]-1),H[0]===`
`&&(ae=["{"]),ae.push(H)));var Ze,Qe,ct,Gt;for(Gt=de,q&V&&(Gt|=Z),Ze=0,Qe=L.body.length;Ze<Qe;++Ze)A&&(Ze===0&&(L.body[0].leadingComments&&(W=L.body[0].leadingComments[0].extendedRange,H=k.substring(W[0],W[1]),H[0]===`
`&&(ae=["{"])),L.body[0].leadingComments||P(L.range[0],L.body[0].range[0],ae)),Ze>0&&!L.body[Ze-1].trailingComments&&!L.body[Ze].leadingComments&&P(L.body[Ze-1].range[1],L.body[Ze].range[0],ae)),Ze===Qe-1&&(Gt|=J),L.body[Ze].leadingComments&&A?ct=qe.generateStatement(L.body[Ze],Gt):ct=wt(qe.generateStatement(L.body[Ze],Gt)),ae.push(ct),Ve(ft(ct).toString())||A&&Ze<Qe-1&&L.body[Ze+1].leadingComments||ae.push(y),A&&Ze===Qe-1&&(L.body[Ze].trailingComments||P(L.body[Ze].range[1],L.range[1],ae))}),ae.push(wt("}")),ae},BreakStatement:function(L,q){return L.label?"break "+L.label.name+this.semicolon(q):"break"+this.semicolon(q)},ContinueStatement:function(L,q){return L.label?"continue "+L.label.name+this.semicolon(q):"continue"+this.semicolon(q)},ClassBody:function(L,q){var W=["{",y],H=this;return St(function(ae){var qe,Ze;for(qe=0,Ze=L.body.length;qe<Ze;++qe)W.push(ae),W.push(H.generateExpression(L.body[qe],n.Sequence,Y)),qe+1<Ze&&W.push(y)}),Ve(ft(W).toString())||W.push(y),W.push(u),W.push("}"),W},ClassDeclaration:function(L,q){var W,H;return W=["class"],L.id&&(W=ut(W,this.generateExpression(L.id,n.Sequence,Y))),L.superClass&&(H=ut("extends",this.generateExpression(L.superClass,n.Unary,Y)),W=ut(W,H)),W.push(x),W.push(this.generateStatement(L.body,be)),W},DirectiveStatement:function(L,q){return _.raw&&L.raw?L.raw+this.semicolon(q):ot(L.directive)+this.semicolon(q)},DoWhileStatement:function(L,q){var W=ut("do",this.maybeBlock(L.body,de));return W=this.maybeBlockSuffix(L.body,W),ut(W,["while"+x+"(",this.generateExpression(L.test,n.Sequence,Y),")"+this.semicolon(q)])},CatchClause:function(L,q){var W,H=this;return St(function(){var ae;L.param?(W=["catch"+x+"(",H.generateExpression(L.param,n.Sequence,Y),")"],L.guard&&(ae=H.generateExpression(L.guard,n.Sequence,Y),W.splice(2,0," if ",ae))):W=["catch"]}),W.push(this.maybeBlock(L.body,de)),W},DebuggerStatement:function(L,q){return"debugger"+this.semicolon(q)},EmptyStatement:function(L,q){return";"},ExportDefaultDeclaration:function(L,q){var W=["export"],H;return H=q&J?be:de,W=ut(W,"default"),O(L.declaration)?W=ut(W,this.generateStatement(L.declaration,H)):W=ut(W,this.generateExpression(L.declaration,n.Assignment,Y)+this.semicolon(q)),W},ExportNamedDeclaration:function(L,q){var W=["export"],H,ae=this;return H=q&J?be:de,L.declaration?ut(W,this.generateStatement(L.declaration,H)):(L.specifiers&&(L.specifiers.length===0?W=ut(W,"{"+x+"}"):L.specifiers[0].type===t.ExportBatchSpecifier?W=ut(W,this.generateExpression(L.specifiers[0],n.Sequence,Y)):(W=ut(W,"{"),St(function(qe){var Ze,Qe;for(W.push(y),Ze=0,Qe=L.specifiers.length;Ze<Qe;++Ze)W.push(qe),W.push(ae.generateExpression(L.specifiers[Ze],n.Sequence,Y)),Ze+1<Qe&&W.push(","+y)}),Ve(ft(W).toString())||W.push(y),W.push(u+"}")),L.source?W=ut(W,["from"+x,this.generateExpression(L.source,n.Sequence,Y),this.semicolon(q)]):W.push(this.semicolon(q))),W)},ExportAllDeclaration:function(L,q){return["export"+x,"*"+x,"from"+x,this.generateExpression(L.source,n.Sequence,Y),this.semicolon(q)]},ExpressionStatement:function(L,q){var W,H;function ae(Qe){var ct;return Qe.slice(0,5)!=="class"?!1:(ct=Qe.charCodeAt(5),ct===123||o.code.isWhiteSpace(ct)||o.code.isLineTerminator(ct))}function qe(Qe){var ct;return Qe.slice(0,8)!=="function"?!1:(ct=Qe.charCodeAt(8),ct===40||o.code.isWhiteSpace(ct)||ct===42||o.code.isLineTerminator(ct))}function Ze(Qe){var ct,Gt,pn;if(Qe.slice(0,5)!=="async"||!o.code.isWhiteSpace(Qe.charCodeAt(5)))return!1;for(Gt=6,pn=Qe.length;Gt<pn&&o.code.isWhiteSpace(Qe.charCodeAt(Gt));++Gt);return Gt===pn||Qe.slice(Gt,Gt+8)!=="function"?!1:(ct=Qe.charCodeAt(Gt+8),ct===40||o.code.isWhiteSpace(ct)||ct===42||o.code.isLineTerminator(ct))}return W=[this.generateExpression(L.expression,n.Sequence,Y)],H=ft(W).toString(),H.charCodeAt(0)===123||ae(H)||qe(H)||Ze(H)||E&&q&Z&&L.expression.type===t.Literal&&typeof L.expression.value=="string"?W=["(",W,")"+this.semicolon(q)]:W.push(this.semicolon(q)),W},ImportDeclaration:function(L,q){var W,H,ae=this;return L.specifiers.length===0?["import",x,this.generateExpression(L.source,n.Sequence,Y),this.semicolon(q)]:(W=["import"],H=0,L.specifiers[H].type===t.ImportDefaultSpecifier&&(W=ut(W,[this.generateExpression(L.specifiers[H],n.Sequence,Y)]),++H),L.specifiers[H]&&(H!==0&&W.push(","),L.specifiers[H].type===t.ImportNamespaceSpecifier?W=ut(W,[x,this.generateExpression(L.specifiers[H],n.Sequence,Y)]):(W.push(x+"{"),L.specifiers.length-H===1?(W.push(x),W.push(this.generateExpression(L.specifiers[H],n.Sequence,Y)),W.push(x+"}"+x)):(St(function(qe){var Ze,Qe;for(W.push(y),Ze=H,Qe=L.specifiers.length;Ze<Qe;++Ze)W.push(qe),W.push(ae.generateExpression(L.specifiers[Ze],n.Sequence,Y)),Ze+1<Qe&&W.push(","+y)}),Ve(ft(W).toString())||W.push(y),W.push(u+"}"+x)))),W=ut(W,["from"+x,this.generateExpression(L.source,n.Sequence,Y),this.semicolon(q)]),W)},VariableDeclarator:function(L,q){var W=q&M?Y:z;return L.init?[this.generateExpression(L.id,n.Assignment,W),x,"=",x,this.generateExpression(L.init,n.Assignment,W)]:this.generatePattern(L.id,n.Assignment,W)},VariableDeclaration:function(L,q){var W,H,ae,qe,Ze,Qe=this;W=[L.kind],Ze=q&M?de:Me;function ct(){for(qe=L.declarations[0],_.comment&&qe.leadingComments?(W.push(`
`),W.push(wt(Qe.generateStatement(qe,Ze)))):(W.push(It()),W.push(Qe.generateStatement(qe,Ze))),H=1,ae=L.declarations.length;H<ae;++H)qe=L.declarations[H],_.comment&&qe.leadingComments?(W.push(","+y),W.push(wt(Qe.generateStatement(qe,Ze)))):(W.push(","+x),W.push(Qe.generateStatement(qe,Ze)))}return L.declarations.length>1?St(ct):ct(),W.push(this.semicolon(q)),W},ThrowStatement:function(L,q){return[ut("throw",this.generateExpression(L.argument,n.Sequence,Y)),this.semicolon(q)]},TryStatement:function(L,q){var W,H,ae,qe;if(W=["try",this.maybeBlock(L.block,de)],W=this.maybeBlockSuffix(L.block,W),L.handlers)for(H=0,ae=L.handlers.length;H<ae;++H)W=ut(W,this.generateStatement(L.handlers[H],de)),(L.finalizer||H+1!==ae)&&(W=this.maybeBlockSuffix(L.handlers[H].body,W));else{for(qe=L.guardedHandlers||[],H=0,ae=qe.length;H<ae;++H)W=ut(W,this.generateStatement(qe[H],de)),(L.finalizer||H+1!==ae)&&(W=this.maybeBlockSuffix(qe[H].body,W));if(L.handler)if(Array.isArray(L.handler))for(H=0,ae=L.handler.length;H<ae;++H)W=ut(W,this.generateStatement(L.handler[H],de)),(L.finalizer||H+1!==ae)&&(W=this.maybeBlockSuffix(L.handler[H].body,W));else W=ut(W,this.generateStatement(L.handler,de)),L.finalizer&&(W=this.maybeBlockSuffix(L.handler.body,W))}return L.finalizer&&(W=ut(W,["finally",this.maybeBlock(L.finalizer,de)])),W},SwitchStatement:function(L,q){var W,H,ae,qe,Ze,Qe=this;if(St(function(){W=["switch"+x+"(",Qe.generateExpression(L.discriminant,n.Sequence,Y),")"+x+"{"+y]}),L.cases)for(Ze=de,ae=0,qe=L.cases.length;ae<qe;++ae)ae===qe-1&&(Ze|=J),H=wt(this.generateStatement(L.cases[ae],Ze)),W.push(H),Ve(ft(H).toString())||W.push(y);return W.push(wt("}")),W},SwitchCase:function(L,q){var W,H,ae,qe,Ze,Qe=this;return St(function(){for(L.test?W=[ut("case",Qe.generateExpression(L.test,n.Sequence,Y)),":"]:W=["default:"],ae=0,qe=L.consequent.length,qe&&L.consequent[0].type===t.BlockStatement&&(H=Qe.maybeBlock(L.consequent[0],de),W.push(H),ae=1),ae!==qe&&!Ve(ft(W).toString())&&W.push(y),Ze=de;ae<qe;++ae)ae===qe-1&&q&J&&(Ze|=J),H=wt(Qe.generateStatement(L.consequent[ae],Ze)),W.push(H),ae+1!==qe&&!Ve(ft(H).toString())&&W.push(y)}),W},IfStatement:function(L,q){var W,H,ae,qe=this;return St(function(){W=["if"+x+"(",qe.generateExpression(L.test,n.Sequence,Y),")"]}),ae=q&J,H=de,ae&&(H|=J),L.alternate?(W.push(this.maybeBlock(L.consequent,de)),W=this.maybeBlockSuffix(L.consequent,W),L.alternate.type===t.IfStatement?W=ut(W,["else ",this.generateStatement(L.alternate,H)]):W=ut(W,ut("else",this.maybeBlock(L.alternate,H)))):W.push(this.maybeBlock(L.consequent,H)),W},ForStatement:function(L,q){var W,H=this;return St(function(){W=["for"+x+"("],L.init?L.init.type===t.VariableDeclaration?W.push(H.generateStatement(L.init,Me)):(W.push(H.generateExpression(L.init,n.Sequence,z)),W.push(";")):W.push(";"),L.test&&(W.push(x),W.push(H.generateExpression(L.test,n.Sequence,Y))),W.push(";"),L.update&&(W.push(x),W.push(H.generateExpression(L.update,n.Sequence,Y))),W.push(")")}),W.push(this.maybeBlock(L.body,q&J?be:de)),W},ForInStatement:function(L,q){return this.generateIterationForStatement("in",L,q&J?be:de)},ForOfStatement:function(L,q){return this.generateIterationForStatement("of",L,q&J?be:de)},LabeledStatement:function(L,q){return[L.label.name+":",this.maybeBlock(L.body,q&J?be:de)]},Program:function(L,q){var W,H,ae,qe,Ze;for(qe=L.body.length,W=[w&&qe>0?`
`:""],Ze=_e,ae=0;ae<qe;++ae)!w&&ae===qe-1&&(Ze|=J),A&&(ae===0&&(L.body[0].leadingComments||P(L.range[0],L.body[ae].range[0],W)),ae>0&&!L.body[ae-1].trailingComments&&!L.body[ae].leadingComments&&P(L.body[ae-1].range[1],L.body[ae].range[0],W)),H=wt(this.generateStatement(L.body[ae],Ze)),W.push(H),ae+1<qe&&!Ve(ft(H).toString())&&(A&&L.body[ae+1].leadingComments||W.push(y)),A&&ae===qe-1&&(L.body[ae].trailingComments||P(L.body[ae].range[1],L.range[1],W));return W},FunctionDeclaration:function(L,q){return[nt(L,!0),"function",gt(L)||It(),L.id?Xe(L.id):"",this.generateFunctionBody(L)]},ReturnStatement:function(L,q){return L.argument?[ut("return",this.generateExpression(L.argument,n.Sequence,Y)),this.semicolon(q)]:["return"+this.semicolon(q)]},WhileStatement:function(L,q){var W,H=this;return St(function(){W=["while"+x+"(",H.generateExpression(L.test,n.Sequence,Y),")"]}),W.push(this.maybeBlock(L.body,q&J?be:de)),W},WithStatement:function(L,q){var W,H=this;return St(function(){W=["with"+x+"(",H.generateExpression(L.object,n.Sequence,Y),")"]}),W.push(this.maybeBlock(L.body,q&J?be:de)),W}},re(ge.prototype,ge.Statement),ge.Expression={SequenceExpression:function(L,q,W){var H,ae,qe;for(n.Sequence<q&&(W|=M),H=[],ae=0,qe=L.expressions.length;ae<qe;++ae)H.push(this.generateExpression(L.expressions[ae],n.Assignment,W)),ae+1<qe&&H.push(","+x);return K(H,n.Sequence,q)},AssignmentExpression:function(L,q,W){return this.generateAssignment(L.left,L.right,L.operator,q,W)},ArrowFunctionExpression:function(L,q,W){return K(this.generateFunctionBody(L),n.ArrowFunction,q)},ConditionalExpression:function(L,q,W){return n.Conditional<q&&(W|=M),K([this.generateExpression(L.test,n.Coalesce,W),x+"?"+x,this.generateExpression(L.consequent,n.Assignment,W),x+":"+x,this.generateExpression(L.alternate,n.Assignment,W)],n.Conditional,q)},LogicalExpression:function(L,q,W){return L.operator==="??"&&(W|=ne),this.BinaryExpression(L,q,W)},BinaryExpression:function(L,q,W){var H,ae,qe,Ze,Qe,ct;return Ze=s[L.operator],ae=L.operator==="**"?n.Postfix:Ze,qe=L.operator==="**"?Ze:Ze+1,Ze<q&&(W|=M),Qe=this.generateExpression(L.left,ae,W),ct=Qe.toString(),ct.charCodeAt(ct.length-1)===47&&o.code.isIdentifierPartES5(L.operator.charCodeAt(0))?H=[Qe,It(),L.operator]:H=ut(Qe,L.operator),Qe=this.generateExpression(L.right,qe,W),L.operator==="/"&&Qe.toString().charAt(0)==="/"||L.operator.slice(-1)==="<"&&Qe.toString().slice(0,3)==="!--"?(H.push(It()),H.push(Qe)):H=ut(H,Qe),L.operator==="in"&&!(W&M)?["(",H,")"]:(L.operator==="||"||L.operator==="&&")&&W&ne?["(",H,")"]:K(H,Ze,q)},CallExpression:function(L,q,W){var H,ae,qe;for(H=[this.generateExpression(L.callee,n.Call,X)],L.optional&&H.push("?."),H.push("("),ae=0,qe=L.arguments.length;ae<qe;++ae)H.push(this.generateExpression(L.arguments[ae],n.Assignment,Y)),ae+1<qe&&H.push(","+x);return H.push(")"),W&B?K(H,n.Call,q):["(",H,")"]},ChainExpression:function(L,q,W){n.OptionalChaining<q&&(W|=B);var H=this.generateExpression(L.expression,n.OptionalChaining,W);return K(H,n.OptionalChaining,q)},NewExpression:function(L,q,W){var H,ae,qe,Ze,Qe;if(ae=L.arguments.length,Qe=W&U&&!v&&ae===0?fe:se,H=ut("new",this.generateExpression(L.callee,n.New,Qe)),!(W&U)||v||ae>0){for(H.push("("),qe=0,Ze=ae;qe<Ze;++qe)H.push(this.generateExpression(L.arguments[qe],n.Assignment,Y)),qe+1<Ze&&H.push(","+x);H.push(")")}return K(H,n.New,q)},MemberExpression:function(L,q,W){var H,ae;return H=[this.generateExpression(L.object,n.Call,W&B?X:se)],L.computed?(L.optional&&H.push("?."),H.push("["),H.push(this.generateExpression(L.property,n.Sequence,W&B?Y:fe)),H.push("]")):(!L.optional&&L.object.type===t.Literal&&typeof L.object.value=="number"&&(ae=ft(H).toString(),ae.indexOf(".")<0&&!/[eExX]/.test(ae)&&o.code.isDecimalDigit(ae.charCodeAt(ae.length-1))&&!(ae.length>=2&&ae.charCodeAt(0)===48)&&H.push(" ")),H.push(L.optional?"?.":"."),H.push(Xe(L.property))),K(H,n.Member,q)},MetaProperty:function(L,q,W){var H;return H=[],H.push(typeof L.meta=="string"?L.meta:Xe(L.meta)),H.push("."),H.push(typeof L.property=="string"?L.property:Xe(L.property)),K(H,n.Member,q)},UnaryExpression:function(L,q,W){var H,ae,qe,Ze,Qe;return ae=this.generateExpression(L.argument,n.Unary,Y),x===""?H=ut(L.operator,ae):(H=[L.operator],L.operator.length>2?H=ut(H,ae):(Ze=ft(H).toString(),Qe=Ze.charCodeAt(Ze.length-1),qe=ae.toString().charCodeAt(0),((Qe===43||Qe===45)&&Qe===qe||o.code.isIdentifierPartES5(Qe)&&o.code.isIdentifierPartES5(qe))&&H.push(It()),H.push(ae))),K(H,n.Unary,q)},YieldExpression:function(L,q,W){var H;return L.delegate?H="yield*":H="yield",L.argument&&(H=ut(H,this.generateExpression(L.argument,n.Yield,Y))),K(H,n.Yield,q)},AwaitExpression:function(L,q,W){var H=ut(L.all?"await*":"await",this.generateExpression(L.argument,n.Await,Y));return K(H,n.Await,q)},UpdateExpression:function(L,q,W){return L.prefix?K([L.operator,this.generateExpression(L.argument,n.Unary,Y)],n.Unary,q):K([this.generateExpression(L.argument,n.Postfix,Y),L.operator],n.Postfix,q)},FunctionExpression:function(L,q,W){var H=[nt(L,!0),"function"];return L.id?(H.push(gt(L)||It()),H.push(Xe(L.id))):H.push(gt(L)||x),H.push(this.generateFunctionBody(L)),H},ArrayPattern:function(L,q,W){return this.ArrayExpression(L,q,W,!0)},ArrayExpression:function(L,q,W,H){var ae,qe,Ze=this;return L.elements.length?(qe=H?!1:L.elements.length>1,ae=["[",qe?y:""],St(function(Qe){var ct,Gt;for(ct=0,Gt=L.elements.length;ct<Gt;++ct)L.elements[ct]?(ae.push(qe?Qe:""),ae.push(Ze.generateExpression(L.elements[ct],n.Assignment,Y))):(qe&&ae.push(Qe),ct+1===Gt&&ae.push(",")),ct+1<Gt&&ae.push(","+(qe?y:x))}),qe&&!Ve(ft(ae).toString())&&ae.push(y),ae.push(qe?u:""),ae.push("]"),ae):"[]"},RestElement:function(L,q,W){return"..."+this.generatePattern(L.argument)},ClassExpression:function(L,q,W){var H,ae;return H=["class"],L.id&&(H=ut(H,this.generateExpression(L.id,n.Sequence,Y))),L.superClass&&(ae=ut("extends",this.generateExpression(L.superClass,n.Unary,Y)),H=ut(H,ae)),H.push(x),H.push(this.generateStatement(L.body,be)),H},MethodDefinition:function(L,q,W){var H,ae;return L.static?H=["static"+x]:H=[],L.kind==="get"||L.kind==="set"?ae=[ut(L.kind,this.generatePropertyKey(L.key,L.computed)),this.generateFunctionBody(L.value)]:ae=[Ft(L),this.generatePropertyKey(L.key,L.computed),this.generateFunctionBody(L.value)],ut(H,ae)},Property:function(L,q,W){return L.kind==="get"||L.kind==="set"?[L.kind,It(),this.generatePropertyKey(L.key,L.computed),this.generateFunctionBody(L.value)]:L.shorthand?L.value.type==="AssignmentPattern"?this.AssignmentPattern(L.value,n.Sequence,Y):this.generatePropertyKey(L.key,L.computed):L.method?[Ft(L),this.generatePropertyKey(L.key,L.computed),this.generateFunctionBody(L.value)]:[this.generatePropertyKey(L.key,L.computed),":"+x,this.generateExpression(L.value,n.Assignment,Y)]},ObjectExpression:function(L,q,W){var H,ae,qe,Ze=this;return L.properties.length?(H=L.properties.length>1,St(function(){qe=Ze.generateExpression(L.properties[0],n.Sequence,Y)}),!H&&!et(ft(qe).toString())?["{",x,qe,x,"}"]:(St(function(Qe){var ct,Gt;if(ae=["{",y,Qe,qe],H)for(ae.push(","+y),ct=1,Gt=L.properties.length;ct<Gt;++ct)ae.push(Qe),ae.push(Ze.generateExpression(L.properties[ct],n.Sequence,Y)),ct+1<Gt&&ae.push(","+y)}),Ve(ft(ae).toString())||ae.push(y),ae.push(u),ae.push("}"),ae)):"{}"},AssignmentPattern:function(L,q,W){return this.generateAssignment(L.left,L.right,"=",q,W)},ObjectPattern:function(L,q,W){var H,ae,qe,Ze,Qe,ct=this;if(!L.properties.length)return"{}";if(Ze=!1,L.properties.length===1)Qe=L.properties[0],Qe.type===t.Property&&Qe.value.type!==t.Identifier&&(Ze=!0);else for(ae=0,qe=L.properties.length;ae<qe;++ae)if(Qe=L.properties[ae],Qe.type===t.Property&&!Qe.shorthand){Ze=!0;break}return H=["{",Ze?y:""],St(function(Gt){var pn,ws;for(pn=0,ws=L.properties.length;pn<ws;++pn)H.push(Ze?Gt:""),H.push(ct.generateExpression(L.properties[pn],n.Sequence,Y)),pn+1<ws&&H.push(","+(Ze?y:x))}),Ze&&!Ve(ft(H).toString())&&H.push(y),H.push(Ze?u:""),H.push("}"),H},ThisExpression:function(L,q,W){return"this"},Super:function(L,q,W){return"super"},Identifier:function(L,q,W){return Xe(L)},ImportDefaultSpecifier:function(L,q,W){return Xe(L.id||L.local)},ImportNamespaceSpecifier:function(L,q,W){var H=["*"],ae=L.id||L.local;return ae&&H.push(x+"as"+It()+Xe(ae)),H},ImportSpecifier:function(L,q,W){var H=L.imported,ae=[H.name],qe=L.local;return qe&&qe.name!==H.name&&ae.push(It()+"as"+It()+Xe(qe)),ae},ExportSpecifier:function(L,q,W){var H=L.local,ae=[H.name],qe=L.exported;return qe&&qe.name!==H.name&&ae.push(It()+"as"+It()+Xe(qe)),ae},Literal:function(L,q,W){var H;if(L.hasOwnProperty("raw")&&D&&_.raw)try{if(H=D(L.raw).body[0].expression,H.type===t.Literal&&H.value===L.value)return L.raw}catch{}return L.regex?"/"+L.regex.pattern+"/"+L.regex.flags:typeof L.value=="bigint"?L.value.toString()+"n":L.bigint?L.bigint+"n":L.value===null?"null":typeof L.value=="string"?bt(L.value):typeof L.value=="number"?ce(L.value):typeof L.value=="boolean"?L.value?"true":"false":Ge(L.value)},GeneratorExpression:function(L,q,W){return this.ComprehensionExpression(L,q,W)},ComprehensionExpression:function(L,q,W){var H,ae,qe,Ze,Qe=this;return H=L.type===t.GeneratorExpression?["("]:["["],_.moz.comprehensionExpressionStartsWithAssignment&&(Ze=this.generateExpression(L.body,n.Assignment,Y),H.push(Ze)),L.blocks&&St(function(){for(ae=0,qe=L.blocks.length;ae<qe;++ae)Ze=Qe.generateExpression(L.blocks[ae],n.Sequence,Y),ae>0||_.moz.comprehensionExpressionStartsWithAssignment?H=ut(H,Ze):H.push(Ze)}),L.filter&&(H=ut(H,"if"+x),Ze=this.generateExpression(L.filter,n.Sequence,Y),H=ut(H,["(",Ze,")"])),_.moz.comprehensionExpressionStartsWithAssignment||(Ze=this.generateExpression(L.body,n.Assignment,Y),H=ut(H,Ze)),H.push(L.type===t.GeneratorExpression?")":"]"),H},ComprehensionBlock:function(L,q,W){var H;return L.left.type===t.VariableDeclaration?H=[L.left.kind,It(),this.generateStatement(L.left.declarations[0],Me)]:H=this.generateExpression(L.left,n.Call,Y),H=ut(H,L.of?"of":"in"),H=ut(H,this.generateExpression(L.right,n.Sequence,Y)),["for"+x+"(",H,")"]},SpreadElement:function(L,q,W){return["...",this.generateExpression(L.argument,n.Assignment,Y)]},TaggedTemplateExpression:function(L,q,W){var H=X;W&B||(H=se);var ae=[this.generateExpression(L.tag,n.Call,H),this.generateExpression(L.quasi,n.Primary,ue)];return K(ae,n.TaggedTemplate,q)},TemplateElement:function(L,q,W){return L.value.raw},TemplateLiteral:function(L,q,W){var H,ae,qe;for(H=["`"],ae=0,qe=L.quasis.length;ae<qe;++ae)H.push(this.generateExpression(L.quasis[ae],n.Primary,Y)),ae+1<qe&&(H.push("${"+x),H.push(this.generateExpression(L.expressions[ae],n.Sequence,Y)),H.push(x+"}"));return H.push("`"),H},ModuleSpecifier:function(L,q,W){return this.Literal(L,q,W)},ImportExpression:function(L,q,W){return K(["import(",this.generateExpression(L.source,n.Assignment,Y),")"],n.Call,q)}},re(ge.prototype,ge.Expression),ge.prototype.generateExpression=function(L,q,W){var H,ae;return ae=L.type||t.Property,_.verbatim&&L.hasOwnProperty(_.verbatim)?le(L,q):(H=this[ae](L,q,W),_.comment&&(H=Pn(L,H)),ft(H,L))},ge.prototype.generateStatement=function(L,q){var W,H;return W=this[L.type](L,q),_.comment&&(W=Pn(L,W)),H=ft(W).toString(),L.type===t.Program&&!w&&y===""&&H.charAt(H.length-1)===`
`&&(W=I?ft(W).replaceRight(/\s+$/,""):H.replace(/\s+$/,"")),ft(W,L)};function qt(L){var q;if(q=new ge,O(L))return q.generateStatement(L,de);if($(L))return q.generateExpression(L,n.Sequence,Y);throw new Error("Unknown node type: "+L.type)}function Vn(L,q){var W=ve(),H,ae;return q!=null?(typeof q.indent=="string"&&(W.format.indent.style=q.indent),typeof q.base=="number"&&(W.format.indent.base=q.base),q=Q(W,q),l=q.format.indent.style,typeof q.base=="string"?u=q.base:u=Pe(l,q.format.indent.base)):(q=W,l=q.format.indent.style,u=Pe(l,q.format.indent.base)),c=q.format.json,h=q.format.renumber,f=c?!1:q.format.hexadecimal,p=c?"double":q.format.quotes,g=q.format.escapeless,y=q.format.newline,x=q.format.space,q.format.compact&&(y=x=l=u=""),v=q.format.parentheses,S=q.format.semicolons,w=q.format.safeConcatenation,E=q.directive,D=c?null:q.parse,I=q.sourceMap,k=q.sourceCode,A=q.format.preserveBlankLines&&k!==null,_=q,I&&(r.browser?i=tY.sourceMap.SourceNode:i=gre().SourceNode),H=qt(L),I?(ae=H.toStringWithSourceMap({file:q.file,sourceRoot:q.sourceMapRoot}),q.sourceContent&&ae.map.setSourceContent(q.sourceMap,q.sourceContent),q.sourceMapWithCode?ae:ae.map.toString()):(ae={code:H.toString(),map:null},q.sourceMapWithCode?ae:ae.code)}N={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},F=ve().format,r.version=xre.version,r.generate=Vn,r.attachComments=a.attachComments,r.Precedence=Q({},n),r.browser=!1,r.FORMAT_MINIFY=N,r.FORMAT_DEFAULTS=F})()}(PC)),PC}var vre=bre();const wre=zD(vre);function jB(r,t){let n,s;const i=r.Shader.prototype.modify;r.Shader.prototype.modify=function(re,Q={parser:!0,srcLocations:!1}){if(re instanceof Function){let ce;if(Q.parser){const Oe=re.toString(),lt=Q9(Oe,{ecmaVersion:2021,locations:Q.srcLocations});bte(lt,u,void 0,{varyings:{}});const ot=wre.generate(lt);ce=new Function(ot.slice(ot.indexOf("{")+1,ot.lastIndexOf("}")).replaceAll(";",""))}else ce=re;const Ge=new se(ce,this,Q.srcLocations).generate();return i.call(this,Ge)}else return i.call(this,re)};function a(re){switch(re){case"+":return"add";case"-":return"sub";case"*":return"mult";case"/":return"div";case"%":return"mod";case"==":case"===":return"equalTo";case">":return"greaterThan";case">=":return"greaterThanEqualTo";case"<":return"lessThan";case"&&":return"and";case"||":return"or"}}function o(re){var Q,ce;return re.type==="CallExpression"&&((Q=re.callee)==null?void 0:Q.type)==="Identifier"&&((ce=re.callee)==null?void 0:ce.name.startsWith("uniform"))}const u={UnaryExpression(re,Q,ce){if(ce.some(o))return;const xe={type:"Literal",value:re.operator},Ge=Oe=>{Oe.type="CallExpression",Oe.callee={type:"Identifier",name:"unaryNode"},Oe.arguments=[Oe.argument,xe]};if(re.type==="MemberExpression"){const Oe=re.argument.property.name;[["x","y","z","w"],["r","g","b","a"],["s","t","p","q"]].some(bt=>[...Oe].every(Et=>bt.includes(Et)))&&re.argument.type==="MemberExpression"?(re.type="MemberExpression",re.object={type:"CallExpression",callee:{type:"Identifier",name:"unaryNode"},arguments:[re.argument.object,xe]},re.property={type:"Identifier",name:Oe}):Ge(re)}else Ge(re);delete re.argument,delete re.operator},VariableDeclarator(re,Q,ce){var xe,Ge;if(re.init.callee&&((xe=re.init.callee.name)!=null&&xe.startsWith("uniform"))){const Oe={type:"Literal",value:re.id.name};re.init.arguments.unshift(Oe)}if(re.init.callee&&((Ge=re.init.callee.name)!=null&&Ge.startsWith("varying"))){const Oe={type:"Literal",value:re.id.name};re.init.arguments.unshift(Oe),Q.varyings[re.id.name]=Oe}},Identifier(re,Q,ce){Q.varyings[re.name]&&!ce.some(xe=>xe.type==="AssignmentExpression"&&xe.left===re)&&(re.type="ExpressionStatement",re.expression={type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:re.name},property:{type:"Identifier",name:"getValue"}},arguments:[]})},ArrayExpression(re,Q,ce){const xe=JSON.parse(JSON.stringify(re));re.type="CallExpression",re.callee={type:"Identifier",name:"dynamicNode"},re.arguments=[xe]},AssignmentExpression(re,Q,ce){if(re.operator!=="="){const xe=a(re.operator.replace("=","")),Ge={type:"CallExpression",callee:{type:"MemberExpression",object:re.left,property:{type:"Identifier",name:xe}},arguments:[re.right]};re.operator="=",re.right=Ge}Q.varyings[re.left.name]&&(re.type="ExpressionStatement",re.expression={type:"CallExpression",callee:{type:"MemberExpression",object:{type:"Identifier",name:re.left.name},property:{type:"Identifier",name:"bridge"}},arguments:[re.right]})},BinaryExpression(re,Q,ce){if(ce.some(o))return;if(["Literal","ArrayExpression","Identifier"].includes(re.left.type)){const Ge={type:"CallExpression",callee:{type:"Identifier",name:"dynamicNode"},arguments:[re.left]};re.left=Ge}re.type="CallExpression",re.callee={type:"MemberExpression",object:re.left,property:{type:"Identifier",name:a(re.operator)}},re.arguments=[re.right]}};class l{constructor(Q,ce){if(new.target===l)throw new TypeError("Cannot construct BaseNode instances directly. This is an abstract class.");if(this.type=ce,this.componentNames=[],this.componentsChanged=!1,this.isInternal=Q,this.usedIn=[],this.dependsOn=[],this.srcLine=null,this.usedInConditional=!1,n.srcLocations===!0&&Q===!1)try{throw new Error("StackCapture")}catch(xe){const Ge=xe.stack.split(`
`);let Oe=5;B(this)&&Oe--,this.srcLine=Ge[Oe].trim()}}addVectorComponents(){if(this.type.startsWith("vec")){const Q=parseInt(this.type.slice(3));this.componentNames=["x","y","z","w"].slice(0,Q);const ce=this;for(let xe of this.componentNames){let Ge=new y(ce,xe,"float",!0);Object.defineProperty(this,xe,{get(){return Ge},set(Oe){this.componentsChanged=!0,X(this)?this.node.value=Oe:Ge=Oe}})}}}forceTemporaryVariable(){(!(O(this)&&z(this.parent))||!U(this))&&(this.useTemp=!0)}assertUsedInConditional(Q){this.usedInConditional=!0,this.usedIn.push(Q),this.forceTemporaryVariable()}isUsedInConditional(){return this.usedInConditional}checkConditionalDependencies(Q){Q.ifs.forEach(ce=>{const xe=()=>ce.usedInSatisfied.length>=1,Ge=()=>ce.dependsOn.length===ce.dependsOnSatisfied.length;ce.insertionPoint>-1||!ce.usedIn.length||(ce.dependsOn.some(Oe=>Oe.node===this)&&!ce.dependsOnSatisfied.includes(this)&&ce.dependsOnSatisfied.push(this),ce.usedIn.includes(this)&&!ce.usedInSatisfied.includes(this)&&ce.usedInSatisfied.push(this),Ge()&&xe()&&ce.saveState(Q,Ge(),xe()))})}toGLSLBase(Q){let ce;if(this.shouldUseTemporaryVariable()){let xe=Q.declarations.length;ce=this.getTemporaryVariable(Q);let Ge=Q.declarations.length-1-xe;Ge=Ge>0?Ge:void 0,this.dependsOn.forEach(Oe=>{if(Oe.isVector){const lt=Oe.originalComponents.map((ot,bt)=>ot===Oe.currentComponents[bt]);Q.updateComponents(Oe.node,Ge,lt)}else Q.updateComponents(Oe.node,Ge)})}else ce=this.toGLSL(Q);return this.checkConditionalDependencies(Q),ce}shouldUseTemporaryVariable(){if(this.componentsChanged||Z(this)||this.useTemp)return!0;if(this.isInternal||U(this)||V(this)||this.type==="sampler2D")return!1;let Q=0;return Q+=ne(this)*2,Q+=B(this)*2,Q+=M(this)*3,Q+=this.usedIn.length,Q>=4}getTemporaryVariable(Q){if(!this.temporaryVariable){this.temporaryVariable=`temp_${Q.getNextID()}`;let ce="";this.srcLine&&(ce+=`
// From ${this.srcLine}
`),ce+="  "+this.type+" "+this.temporaryVariable+" = "+this.toGLSL(Q)+";",Q.declarations.push(ce)}return this.temporaryVariable}add(Q){return Ne(this,this.enforceType(Q),"+")}sub(Q){return Ne(this,this.enforceType(Q),"-")}mult(Q){return Ne(this,this.enforceType(Q),"*")}div(Q){return Ne(this,this.enforceType(Q),"/")}mod(Q){return Ne(this,this.enforceType(Q),"%")}enforceType(Q){if(N(Q)){if(!Y(Q.type))throw new TypeError(`You've tried to perform an operation on a struct of type: ${Q.type}. Try accessing a member on that struct with '.'`);if(!Y(Q.type))throw new TypeError(`You've tried to perform an operation on a struct of type: ${Q.type}. Try accessing a member on that struct with '.'`);return($(this)||M(this))&&F(Q)?new h(Q):Q}else return typeof Q=="number"?F(this)?new c(Q):new h(Q):Array.isArray(Q)?et.dynamicVector(Q):et[this.type](Q)}toFloat(){if($(this))return this;if(F(this))return new h(this)}toGLSL(Q){throw new TypeError("Not supposed to call this function on BaseNode, which is an abstract class.")}}class c extends l{constructor(Q=0,ce=!1){super(ce,"int"),this.x=Q}toGLSL(Q){if(N(this.x)){let ce=this.x.toGLSLBase(Q);return F(this.x.type)?ce:`int(${ce})`}else return typeof this.x=="number"?`${Math.floor(this.x)}`:`int(${this.x})`}}class h extends l{constructor(Q=0,ce=!1,xe=!1){if(super(ce,"float"),Array.isArray(Q)&&(Q=Q[0]),xe){const{parent:Ge,name:Oe}=xe;this.name=Oe,this.parent=Ge}this.x=Q}toGLSL(Q){if(N(this.x)){let ce=this.x.toGLSLBase(Q);return $(this.x)?ce:`float(${ce})`}else return typeof this.x=="number"?`${this.x.toFixed(4)}`:`float(${this.x})`}}class f extends l{constructor(Q,ce,xe=!1){super(xe,ce),this.originalValues=de(Q,parseInt(ce.slice(3))),this.componentNames=["x","y","z","w"].slice(0,this.originalValues.length)}addVectorComponents(){const Q=this.originalValues;this.componentsChanged=!1,this.componentNames.forEach((ce,xe)=>{const Ge={name:ce,parent:this};let Oe=O(Q[xe])?Q[xe]:new h(Q[xe],!0,Ge);Object.defineProperty(this,ce,{get(){return Oe},set(lt){this.componentsChanged=!0,X(this)?this.node.value=lt:Oe=O(lt)?lt:new h(lt,!0,Ge)}})}),this.originalValues=this.componentNames.map(ce=>this[ce])}toGLSL(Q){if((!this.componentsChanged||!this.defined)&&!this.oldName){let ce=this.componentNames.map((xe,Ge)=>this.originalValues[Ge].toGLSLBase(Q)).join(", ");return this.defined=!0,`${this.type}(${ce})`}else return this.temporaryVariable}}class p extends l{constructor(Q,ce,xe,Ge=!1){let Oe;const lt=ot=>{let bt,Et=0;const ft=ce.every((It,ut)=>{const wt=k(It);let St=ot.args[ut];return St==="genType"&&((bt===void 0||bt==="float"&&wt.startsWith("vec"))&&(bt=wt),St=bt),Et+=wt===St,wt===St||wt==="float"&&St.startsWith("vec")});return{...ot,valid:ft,similarity:Et,genType:bt}};if(Array.isArray(xe)){let ot=xe.filter(Et=>Et.args.length===ce.length);if(ot.length===0){const Et=new Set,ft=[];xe.forEach(ut=>Et.add(ut.args.length)),Et.forEach(ut=>ft.push(`${ut}`));const It=ft.join(" or ");throw new Error(`Function '${Q}' has ${xe.length} variants which expect ${It} arguments, but ${ce.length} arguments were provided.`)}const bt=function(Et,ft){return ft=lt(ft),ft.valid&&(!Et||ft.similarity>Et.similarity)&&(Et=ft),Et};Oe=ot.reduce(bt,null)}else Oe=lt(xe);if(!Oe||!Oe.valid){const ot=ft=>`(${ft.map(It=>It).join(", ")})`,bt=Array.isArray(xe)?xe.map(ft=>ot(ft.args)).join(" or "):ot(xe.args),Et=ot(ce.map(ft=>k(ft)));throw new Error(`Function '${Q}' was called with wrong arguments. Most likely, you provided mixed lengths vectors as arguments.
Expected argument types: ${bt}
Provided argument types: ${Et}
All of the arguments with expected type 'genType' should have a matching type. If one of those is different, try to find where it was created.
        `)}if(ce.length!==Oe.args.length)throw new Error(`Function '${Q}' expects ${Oe.args.length} arguments, but ${ce.length} were provided.`);ce=ce.map((ot,bt)=>{if(N(ot))$(ot)&&Oe.args[bt]==="genType"&&Oe.genType!=="float"&&(ot=et[Oe.genType](ot));else{const Et=Oe.args[bt]==="genType"?Oe.genType:Oe.args[bt];ot=et[Et](ot)}return ot}),Oe.returnType==="genType"&&(Oe.returnType=Oe.genType),super(Ge,Oe.returnType),this.name=Q,this.args=ce,this.argumentTypes=Oe.args}deconstructArgs(Q){return this.args.map((xe,Ge)=>(F(xe)&&this.argumentTypes[Ge]!="float"&&(xe=xe.toFloat()),xe.toGLSLBase(Q),xe.toGLSLBase(Q))).join(", ")}toGLSL(Q){return`${this.name}(${this.deconstructArgs(Q)})`}}class g extends l{constructor(Q,ce,xe=!1){super(xe,ce),this.name=Q}toGLSL(Q){return`${this.name}`}}class y extends l{constructor(Q,ce,xe,Ge=!1){super(Ge,xe),this.parent=Q,this.componentName=ce,this.type=xe}toGLSL(Q){let ce=this.parent.toGLSLBase(Q);return!U(this.parent)&&!Z(this.parent)&&(ce=`(${ce})`),`${ce}.${this.componentName}`}}class x extends g{constructor(Q,ce,xe=!1){super(Q,ce,xe),this.timesChanged=0,this.tempVars=0}getValue(){const Q=n.context;if(!Q.varyings[this.name]||!this.timesChanged)return this;let ce=Q.varyings[this.name].splice(0,this.timesChanged),xe;return ce.forEach((Ge,Oe)=>{let{value:lt}=Ge;if(Q.declarations.push(`  ${this.name} = ${lt.toGLSLBase(Q)};`),Oe===ce.length-1){const ot=`${this.name}_${this.tempVars++}`;xe=_e(new g(ot,this.type,!0)),Q.declarations.push(`  ${this.type} ${ot} = ${this.name};`)}}),this.timesChanged=0,xe}bridge(Q){(!N(Q)||this.type.startsWith("vec")&&k(Q)==="float")&&(Q=et[this.type](Q)),n.registerVarying(this,Q),this.timesChanged+=1}}class v extends l{constructor(Q,ce,xe,Ge=!1){super(Ge,null),this.operator=xe,this.left=Q,this.right=ce;for(const Oe of[Q,ce])Oe.usedIn.push(this);this.type=this.determineType()}determineType(){if(["==",">",">=","<","<=","||","!","&&"].includes(this.operator))return"bool";if(this.left.type===this.right.type)return this.left.type;if(M(this.left)&&$(this.right))return this.left.type;if(M(this.right)&&$(this.left))return this.right.type;if($(this.left)&&F(this.right)||F(this.left)&&$(this.right))return"float";throw new Error("Incompatible types for binary operator")}processOperand(Q,ce){if(Q.temporaryVariable)return Q.temporaryVariable;let xe=Q.toGLSLBase(ce);return B(Q)&&!Q.temporaryVariable&&(xe=`(${xe})`),this.type==="float"&&F(Q)&&(xe=`float(${xe})`),xe}toGLSL(Q){const ce=this.processOperand(this.left,Q),xe=this.processOperand(this.right,Q);return`${ce} ${this.operator} ${xe}`}}class S extends v{constructor(Q,ce,xe){super(Q,ce,xe)}toGLSL(Q){return M(this)||$(this)?`mod(${this.left.toGLSLBase(Q)}, ${this.right.toGLSLBase(Q)})`:`${this.processOperand(Q,this.left)} % ${this.processOperand(Q,this.right)}`}}class w extends l{constructor(Q,ce,xe=!1){super(xe,Q.type),this.node=Q,this.operator=ce}toGLSL(Q){let ce=this.node.toGLSLBase(Q);return!U(this.node)&&!Z(this.node)&&!J(this.node)&&(ce=`(${ce})`),`${this.operator}${ce}`}}l.prototype.equalTo=function(re){return Ne(this,this.enforceType(re),"==")},l.prototype.greaterThan=function(re){return Ne(this,this.enforceType(re),">")},l.prototype.greaterThanEqualTo=function(re){return Ne(this,this.enforceType(re),">=")},l.prototype.lessThan=function(re){return Ne(this,this.enforceType(re),"<")},l.prototype.lessThanEqualTo=function(re){return Ne(this,this.enforceType(re),"<=")},l.prototype.not=function(){return new w(this.condition,"!",!0)},l.prototype.or=function(re){return new Ne(this,this.enforceType(re),"||",!0)},l.prototype.and=function(re){return new Ne(this,this.enforceType(re),"&&",!0)};function E(re){const Q=new D;return re(),s=null,Q}class _{constructor(Q,ce){this.dependsOn=[],this.usedIn=[],this.dependsOnSatisfied=[],this.usedInSatisfied=[],this.states=[],this.if(Q,ce),this.insertionPoint=-1,this.elseIfs=[],this.elseBranch=null,n.context.ifs.push(this)}if(Q,ce){this.condition=Q,this.conditionString=Q.toGLSL(n.context),this.ifBranch=E(ce),this.ifBranch.parent=this}elseIf(Q,ce){let xe=E(ce);return ce.parent=this,this.elseIfs.push({condition:Q,elseBranch:xe}),this}else(Q){return this.elseBranch=E(Q),this.elseBranch.parent=this,this}thenDiscard(){return new I(this.condition)}saveState(Q,ce,xe){this.states.push({line:Q.declarations.length,usedInSatisfied:ce,dependsOnSatisfied:xe}),this.insertionPoint=Q.declarations.length-1}toGLSL(Q){const ce=Q.declarations.length;this.dependsOn.forEach(lt=>Q.updateComponents(lt.node));const Ge=Q.declarations.length-ce;this.insertionPoint+=Ge;let Oe=[`
  if (${this.conditionString}) {`,`
    ${this.ifBranch.toGLSL(Q)}`,`
  }`];return this.elseIfs.length&&this.elseIfs.forEach(lt=>{let{condition:ot,elseBranch:bt}=lt;Oe.push(` else if (${ot.toGLSL(Q)}) {`),Oe.push(`
    ${bt.toGLSL(Q)}`),Oe.push(`
  }`)}),this.elseBranch&&(Oe.push(" else {"),Oe.push(`
    ${this.elseBranch.toGLSL(Q)}`),Oe.push(`
  }
`)),Oe.push(`
`),Oe.flat().join("")}}t.assign=function(re,Q){if(!s)throw new error('assign() is supposed to be used inside of conditional branchs. Use the "=" operator as normal otherwise.');s.assign(re,Q)};class D{constructor(){s=this,this.statements=[],this.assignments=[],this.dependsOn=[],this.declarations=[];let Q=null;Object.defineProperty(this,"parent",{get(){return Q},set(ce){ce.dependsOn.push(...this.dependsOn),Q=ce}})}assign(Q,ce){!N(ce)||ce.type!==Q.type?(ce=et[Q.type](ce),this.declarations.push(ce),this.assignments.push({node:Q})):this.assignments.push({node:Q,value:ce}),Q=Q.parent?Q.parent:Q,ce=ce.parent?ce.parent:ce,![Q,ce].some(xe=>this.dependsOn.some(Ge=>Ge.node===xe))&&(Q.assertUsedInConditional(this),this.dependsOn.push(ue(Q)),ce.shouldUseTemporaryVariable()&&(ce.assertUsedInConditional(this),this.dependsOn.push(ue(ce))))}toGLSL(Q){let ce=0;return this.assignments.forEach(({node:xe,value:Ge})=>{let Oe,lt;if(Ge)lt=Ge.toGLSLBase(Q);else{let ot=this.declarations[ce];ce++,ot.temporaryVariable=`temp_${Q.getNextID()}`,this.statements.push(`${ot.type} ${ot.temporaryVariable} = ${ot.toGLSL(Q)};`),lt=ot.toGLSLBase(Q)}U(xe)||Z(xe)?Oe=`${xe.toGLSLBase(Q)} = ${lt};`:O(xe)&&xe.name?Oe=`${xe.parent.toGLSLBase(Q)}.${xe.name} = ${lt};`:(xe.temporaryVariable=`temp_${Q.getNextID()}`,Oe=`${xe.type} ${xe.toGLSLBase(Q)} = ${lt};`),this.statements.push(Oe)}),this.statements.join(`
    `)}}class I{constructor(Q){this.condition=Q}toGLSL(Q){Q.discardConditions.push(`if (${this.condition}{discard;})`)}}function k(re){if(N(re))return re.type;if(Array.isArray(re)&&re.length>1)return`vec${re.length}`;if(typeof re=="number"||Array.isArray(re)&&re.length===1)return"float"}function A(re){let Q=0;if(Array.isArray(re))for(let ce of re)M(ce)?Q+=parseInt(ce.type.slice(3)):Q+=1;else M(re)&&(Q+=parseInt(val.type.slice(3)));if(![2,3,4].includes(Q))throw new Error(`You have attempted to construct a vector with ${Q} values. Only vec2, vec3, and vec4 types are supported.`);return Q}t.dynamicNode=function(re){if(N(re))return re;if(typeof re=="number")return new h(re);if(Array.isArray(re))return et.dynamicVector(re)},t.unaryNode=function(re,Q){return re=dynamicNode(re),_e(new w(re,Q))};function N(re){return re instanceof l}function F(re){return N(re)&&re.type==="int"}function $(re){return N(re)&&re.type==="float"}function O(re){return re instanceof h}function M(re){return N(re)&&(re.type==="vec2"||re.type==="vec3"||re.type==="vec4")}function B(re){return re instanceof v}function U(re){return re instanceof g||re instanceof y}function V(re){return re instanceof _||re instanceof D}function Z(re){return re.temporaryVariable}function J(re){return re instanceof h||re instanceof c||re instanceof f}function ne(re){return re instanceof p}function z(re){return re instanceof f}function X(re){return re instanceof w}function Y(re){return["int","float","vec2","vec3","vec4","sampler2D"].includes(re)}class se{constructor(Q,ce,xe){n=this,this.userCallback=Q,this.srcLocations=xe,this.cleanup=()=>{},this.generateHookOverrides(ce),this.output={vertexDeclarations:new Set,fragmentDeclarations:new Set,uniforms:{}},this.uniformNodes=[],this.resetGLSLContext(),this.isGenerating=!1}generate(){const Q=r.disableFriendlyErrors;return r.disableFriendlyErrors=!0,this.isGenerating=!0,this.userCallback(),this.output.vertexDeclarations=[...this.output.vertexDeclarations].join(`
`),this.output.fragmentDeclarations=[...this.output.fragmentDeclarations].join(`
`),this.isGenerating=!1,this.cleanup(),r.disableFriendlyErrors=Q,this.output}generateHookOverrides(Q){const ce={...Q.hooks.vertex,...Q.hooks.fragment},xe={};Object.keys(ce).forEach(Ge=>{const Oe=Q.hookTypes(Ge);this[Oe.name]=function(lt){const ot=[],bt=[];Oe.parameters.forEach(wt=>{if(Y(wt.type.typeName))ot.push(ve(wt.name,wt.type.typeName,!0));else{const hr={};wt.type.properties.forEach(qn=>{hr[qn.name]=ve(`${wt.name}.${qn.name}`,qn.type.typeName,!0)}),ot.push(hr)}const St=wt.type.qualifiers.length>0?wt.type.qualifiers.join(" "):"";bt.push(`${St} ${wt.type.typeName} ${wt.name}`.trim())});let Et=lt(...ot);const ft=Oe.returnType,It={};Y(ft.typeName)?(N(Et)?$(Et)&&ft.typeName.startsWith("vec")&&(Et=et[ft.typeName](Et)):Et=et[ft.typeName](Et),It.notAProperty=Et.toGLSLBase(this.context),this.context.updateComponents(Et)):Object.entries(Et).forEach(([wt,St])=>{St=dynamicNode(St),It[wt]=St.toGLSLBase(this.context),this.context.updateComponents(St)}),this.context.ifs.forEach(wt=>{if(wt.usedIn.length===0)return;const St=wt.toGLSL(this.context);this.context.declarations.splice(wt.insertionPoint,0,St)});let ut=[`(${bt.join(", ")}) {`,...this.context.declarations,`
  ${Oe.returnType.typeName} finalReturnValue;`];Object.entries(It).forEach(([wt,St])=>{const hr=ft.properties?`.${wt}`:"";ut.push(`  finalReturnValue${hr} = ${St};`)}),this.context.declarations=[];for(let wt in this.context.varyings){const St=this.context.varyings[wt],hr=[];St.forEach(qn=>{const{node:sn,value:Pn}=qn;hr.push(`  ${sn.name} = ${Pn.toGLSLBase(this.context)};`),hr.unshift(...this.context.declarations),sn.timesChanged=0}),ut.push(...hr)}ut.push("  return finalReturnValue;","}"),this.output[Ge]=ut.join(`
`),this.resetGLSLContext()},xe[Oe.name]=window[Oe.name],window[Oe.name]=function(lt){n[Oe.name](lt)}}),this.cleanup=()=>{for(const Ge in xe)window[Ge]=xe[Ge]}}registerVarying(Q,ce){Array.isArray(this.context.varyings[Q.name])||(this.context.varyings[Q.name]=[]),this.context.varyings[Q.name].push({node:Q,value:ce}),this.output.vertexDeclarations.add(`OUT ${Q.type} ${Q.name};`),this.output.fragmentDeclarations.add(`IN ${Q.type} ${Q.name};`)}resetGLSLContext(){this.uniformNodes.forEach(Q=>{Q.usedIn=[],Q.temporaryVariable=void 0}),this.context={id:0,getNextID(){return this.id++},declarations:[],varyings:[],ifs:[],updateComponents:function(Q,ce,xe){if(Q.componentsChanged){xe||(xe=Q.componentNames.map(()=>!0));const Ge=[];if(z(Q))Q.componentNames.forEach((Oe,lt)=>{if(xe[lt]&&Q[Oe]!==Q.originalValues[lt]){const ot=et.float(Q[Oe]),bt=`  ${Q.temporaryVariable}.${Oe} = ${ot.toGLSLBase(this)};`;Ge.push(bt)}});else{const Oe=Q.componentNames.map(bt=>Q[bt]),lt=et[Q.type](Oe),ot=`  ${Q.temporaryVariable} = ${lt.toGLSLBase(this)};`;Ge.push(ot)}ce?this.declarations.splice(ce,0,...Ge):this.declarations.push(...Ge),Q.componentsChanged=!1}}},this.uniformNodes=[]}}function ue(re){return M(re)?{node:re,isVector:!0,originalComponents:[...re.componentNames.map(Q=>re[Q])],get currentComponents(){return re.componentNames.map(Q=>re[Q])}}:{node:re,isVector:!1}}function fe(re){return re.map(Q=>ue(Q))}function de(re,Q){return Array.isArray(re)||(re=[re]),re=re.flat(),re=re.map(ce=>M(ce)?ce.componentNames.map(Ge=>ce[Ge]):ce).flat(),re.length===1&&!z(re[0])&&(re=Array(Q).fill(re[0])),re}function be(re){const Q=[["x","y","z","w"],["r","g","b","a"],["s","t","p","q"]].map(ce=>ce.slice(0,re));return{get(ce,xe,Ge){if(xe in ce)return Reflect.get(...arguments);for(const Oe of Q)if([...xe].every(lt=>Oe.includes(lt))){if(xe.length===1)return ce[Q[0][Oe.indexOf(xe[0])]];const lt=[...xe].map(bt=>{const Et=Oe.indexOf(bt),ft=Q[0][Et];return ce[ft]}),ot=`vec${xe.length}`;return et[ot](lt)}},set(ce,xe,Ge,Oe){for(const lt of Q){const ot=[...xe];if(ot.every(bt=>lt.includes(bt))){const bt=Array.isArray(Ge)?Ge:Array(xe.length).fill(Ge);return ot.forEach((Et,ft)=>{const It=lt.indexOf(Et),ut=Q[0][It];Reflect.set(ce,ut,bt[ft],Oe)}),!0}}return Reflect.set(...arguments)}}}t.If=function(re,Q){return new _(re,Q)},t.instanceID=function(){return ve("gl_InstanceID","int")},t.getTexture=function(...re){return Pe("getTexture",re,{args:["sampler2D","vec2"],returnType:"vec4",isp5Function:!0})};const Me={int:"Int",float:"Float",vec2:"Vector2",vec3:"Vector3",vec4:"Vector4",sampler2D:"Texture"};function _e(re,Q){if(re.type.startsWith("vec")||Q){const ce=parseInt(re.type.slice(3));re=new Proxy(re,be(ce)),re.addVectorComponents()}return re}function Ne(re,Q,ce,xe){let Ge;return ce==="%"?Ge=new S(re,Q):Ge=new v(re,Q,ce,xe),_e(Ge)}function ve(re,Q,ce){const xe=new g(re,Q,ce);return _e(xe)}function Pe(re,Q,ce,xe){let Ge=new p(re,Q,ce,xe);return Ge=_e(Ge),Ge.dependsOn=fe(Ge.args),Ge.args.map(lt=>lt.usedIn.filter(bt=>V(bt)).map(bt=>bt instanceof D?bt.parent:bt)).flat().forEach(lt=>lt.usedIn.push(Ge)),Ge}const et={int:re=>new c(re),float:re=>new h(re),vec2:re=>_e(new f(re,"vec2")),vec3:re=>_e(new f(re,"vec3")),vec4:re=>_e(new f(re,"vec4")),dynamicVector:function(re){const Q=A(re);return this[`vec${Q}`](re)}};for(const re in Me){const Q=Me[re],ce=`uniform${Q}`;if(se.prototype[ce]=function(...Oe){let[lt,...ot]=Oe;re.startsWith("vec")&&!(ot[0]instanceof Function)?(ot=de(ot,parseInt(re.slice(3))),this.output.uniforms[`${re} ${lt}`]=ot):this.output.uniforms[`${re} ${lt}`]=ot[0];const bt=ve(lt,re,!1);return this.uniformNodes.push(bt),bt},t[ce]=function(...Oe){return n[ce](...Oe)},re==="sampler2D")continue;const xe=`varying${Q}`;se.prototype[xe]=function(Oe){return _e(new x(Oe,re,!1))},t[xe]=function(Oe){return n[xe](Oe)};const Ge=t[re];t[re]=function(...Oe){if(n!=null&&n.isGenerating)return re.startsWith("vec")?Oe=de(Oe,parseInt(re.slice(3))):Oe=Oe[0],et[re](Oe);if(Ge)return Ge.apply(this,Oe);r._friendlyError(`It looks like you've called ${re} outside of a shader's modify() function.`)}}Object.entries({acos:{args:["genType"],returnType:"genType",isp5Function:!0},acosh:{args:["genType"],returnType:"genType",isp5Function:!1},asin:{args:["genType"],returnType:"genType",isp5Function:!0},asinh:{args:["genType"],returnType:"genType",isp5Function:!1},atan:[{args:["genType"],returnType:"genType",isp5Function:!1},{args:["genType","genType"],returnType:"genType",isp5Function:!1}],atanh:{args:["genType"],returnType:"genType",isp5Function:!1},cos:{args:["genType"],returnType:"genType",isp5Function:!0},cosh:{args:["genType"],returnType:"genType",isp5Function:!1},degrees:{args:["genType"],returnType:"genType",isp5Function:!0},radians:{args:["genType"],returnType:"genType",isp5Function:!0},sin:{args:["genType"],returnType:"genType",isp5Function:!0},sinh:{args:["genType"],returnType:"genType",isp5Function:!1},tan:{args:["genType"],returnType:"genType",isp5Function:!0},tanh:{args:["genType"],returnType:"genType",isp5Function:!1},abs:{args:["genType"],returnType:"genType",isp5Function:!0},ceil:{args:["genType"],returnType:"genType",isp5Function:!0},clamp:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},dFdx:{args:["genType"],returnType:"genType",isp5Function:!1},dFdy:{args:["genType"],returnType:"genType",isp5Function:!1},exp:{args:["genType"],returnType:"genType",isp5Function:!0},exp2:{args:["genType"],returnType:"genType",isp5Function:!1},floor:{args:["genType"],returnType:"genType",isp5Function:!0},fma:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},fract:{args:["genType"],returnType:"genType",isp5Function:!0},fwidth:{args:["genType"],returnType:"genType",isp5Function:!1},inversesqrt:{args:["genType"],returnType:"genType",isp5Function:!0},log:{args:["genType"],returnType:"genType",isp5Function:!0},log2:{args:["genType"],returnType:"genType",isp5Function:!1},max:[{args:["genType","genType"],returnType:"genType",isp5Function:!0},{args:["genType","float"],returnType:"genType",isp5Function:!0}],min:[{args:["genType","genType"],returnType:"genType",isp5Function:!0},{args:["genType","float"],returnType:"genType",isp5Function:!0}],mix:[{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},{args:["genType","genType","float"],returnType:"genType",isp5Function:!1}],pow:{args:["genType","genType"],returnType:"genType",isp5Function:!0},round:{args:["genType"],returnType:"genType",isp5Function:!0},roundEven:{args:["genType"],returnType:"genType",isp5Function:!1},smoothstep:[{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},{args:["float","float","genType"],returnType:"genType",isp5Function:!1}],sqrt:{args:["genType"],returnType:"genType",isp5Function:!0},step:{args:["genType","genType"],returnType:"genType",isp5Function:!1},trunc:{args:["genType"],returnType:"genType",isp5Function:!1},cross:{args:["vec3","vec3"],returnType:"vec3",isp5Function:!0},distance:{args:["genType","genType"],returnType:"float",isp5Function:!0},dot:{args:["genType","genType"],returnType:"float",isp5Function:!0},faceforward:{args:["genType","genType","genType"],returnType:"genType",isp5Function:!1},length:{args:["genType"],returnType:"float",isp5Function:!1},normalize:{args:["genType"],returnType:"genType",isp5Function:!0},reflect:{args:["genType","genType"],returnType:"genType",isp5Function:!1},refract:{args:["genType","genType","float"],returnType:"genType",isp5Function:!1},texture:{args:["sampler2D","vec2"],returnType:"vec4",isp5Function:!0}}).forEach(([re,Q])=>{if(Array.isArray(Q)?Q[0].isp5Function:Q.isp5Function){const xe=t[re];t[re]=function(...Ge){return n!=null&&n.isGenerating?Pe(re,Ge,Q):xe.apply(this,Ge)}}else t[re]=function(...xe){if(n!=null&&n.isGenerating)return new Pe(re,xe,Q);r._friendlyError(`It looks like you've called ${re} outside of a shader's modify() function.`)}})}typeof p5<"u"&&p5.registerAddon(jB);function Sre(r){U8(r,r.prototype),CT(r,r.prototype),mB(r,r.prototype),_T(r,r.prototype),gB(r,r.prototype),j8(r,r.prototype),ire(r,r.prototype),E8(r,r.prototype),_8(r,r.prototype),w8(r,r.prototype),C8(r,r.prototype),N8(r,r.prototype),K8(r,r.prototype),S8(r,r.prototype),vT(r,r.prototype),ET(r,r.prototype),jB(r,r.prototype)}function Cre(r){r.registerAddon(yB),r.registerAddon(BB)}const _re=()=>{if(typeof window._setupDone<"u"){console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import");return}if(!window.mocha){const r=new Event("p5Ready");window.dispatchEvent(r),(window.setup&&typeof window.setup=="function"||window.draw&&typeof window.draw=="function")&&!jn.instance&&new jn}},Ere=()=>new Promise((r,t)=>{document.readyState==="complete"?r():window.addEventListener("load",r,!1)}),Dre=typeof IS_MINIFIED>"u"?tee():Promise.resolve();yJ(jn);bJ(jn);vJ(jn);wte(jn);Ste(jn);Cte(jn);Ete(jn);Dte(jn);kte(jn);Ate(jn);Ite(jn);Sre(jn);Cre(jn);Promise.all([Ere(),Dre]).then(_re);function Tre({sketch:r}){const t=ht.useRef();return ht.useEffect(()=>{const n=new jn(r,t.current);return()=>n.remove()},[r]),Se.jsx("div",{ref:t})}function Nre(r){let t,n=0;const s=500;let i=12;const a=500,o=new Map,u=Array.from({length:i+1},(h,f)=>{const p=(f/i+.25)*r.TWO_PI;return{x:r.cos(p),y:r.sin(p)}});r.frameRate(30),r.setup=()=>{r.createCanvas(a,a,r.WEBGL),r.colorMode(r.HSL,1);for(let h=0;h<=100;h++){const f=h/50,p=[];c(.5,.5,1/2.5,f,p),o.set(f,p)}},r.draw=()=>{n+=r.deltaTime/(1e3/60)*2;const f=n%(2*s)/s;t=f<=1?f:2-f,r.clear(),r.strokeWeight(2);const g=Math.floor(t*100)/50,y=o.get(g);y&&y.forEach(({x1:x,y1:v,x2:S,y2:w,hue:E,light:_})=>{r.stroke(r.color(E,.75,_)),r.line(x,v,S,w)})};function l(h,f){return{x:r.cos(h*r.TWO_PI)*f,y:r.sin(h*r.TWO_PI)*f}}function c(h,f,p,g,y){const x=r.constrain(g,0,1);for(let v=0;v<i;v++){const w=v/i+.25;if(g>0){const _=p*(x*.5),D=l(w,_),I=p*(1-x*.5);c(h+D.x,f+D.y,I,g-1,y)}else{const E=u[v],_=u[(v+1)%i],D={x:E.x*p,y:E.y*p},I={x:_.x*p,y:_.y*p};y.push({x1:(h+D.x-.5)*a,y1:(f+D.y-.5)*a,x2:(h+I.x-.5)*a,y2:(f+I.y-.5)*a,hue:(.1+f*.06)%1,light:r.constrain((f-.5)*.8+.5,0,1)})}}}}/**
 * @license
 * Copyright (c) 2025, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const Ks="w",ya="b",Ds="p",yE="n",nx="b",xm="r",al="q",os="k",ZC="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class $y{constructor(t,n){Bt(this,"color");Bt(this,"from");Bt(this,"to");Bt(this,"piece");Bt(this,"captured");Bt(this,"promotion");Bt(this,"flags");Bt(this,"san");Bt(this,"lan");Bt(this,"before");Bt(this,"after");const{color:s,piece:i,from:a,to:o,flags:u,captured:l,promotion:c}=n,h=Vs(a),f=Vs(o);this.color=s,this.piece=i,this.from=h,this.to=f,this.san=t._moveToSan(n,t._moves({legal:!0})),this.lan=h+f,this.before=t.fen(),t._makeMove(n),this.after=t.fen(),t._undoMove(),this.flags="";for(const p in cn)cn[p]&u&&(this.flags+=mc[p]);l&&(this.captured=l),c&&(this.promotion=c,this.lan+=c)}isCapture(){return this.flags.indexOf(mc.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(mc.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(mc.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(mc.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(mc.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(mc.BIG_PAWN)>-1}}const Si=-1,mc={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},cn={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},xE={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},kre={WhiteTitle:null,BlackTitle:null,WhiteElo:null,BlackElo:null,WhiteUSCF:null,BlackUSCF:null,WhiteNA:null,BlackNA:null,WhiteType:null,BlackType:null,EventDate:null,EventSponsor:null,Section:null,Stage:null,Board:null,Opening:null,Variation:null,SubVariation:null,ECO:null,NIC:null,Time:null,UTCTime:null,UTCDate:null,TimeControl:null,SetUp:null,FEN:null,Termination:null,Annotator:null,Mode:null,PlyCount:null},Are={...xE,...kre},Zt={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},QC={b:[16,32,17,15],w:[-16,-32,-17,-15]},UR={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},Ire=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],$re=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],Fre={p:1,n:2,b:4,r:8,q:16,k:32},Rre="pnbrqkPNBRQK",GR=[yE,nx,xm,al],Ore=7,Mre=6,Lre=1,Bre=0,Fy={[os]:cn.KSIDE_CASTLE,[al]:cn.QSIDE_CASTLE},nl={w:[{square:Zt.a1,flag:cn.QSIDE_CASTLE},{square:Zt.h1,flag:cn.KSIDE_CASTLE}],b:[{square:Zt.a8,flag:cn.QSIDE_CASTLE},{square:Zt.h8,flag:cn.KSIDE_CASTLE}]},Pre={b:Lre,w:Mre},Vre=["1-0","0-1","1/2-1/2","*"];function Oc(r){return r>>4}function lg(r){return r&15}function WB(r){return"0123456789".indexOf(r)!==-1}function Vs(r){const t=lg(r),n=Oc(r);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function um(r){return r===Ks?ya:Ks}function zre(r){const t=r.split(/\s+/);if(t.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(t[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const s=parseInt(t[4],10);if(isNaN(s)||s<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(i.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let o=0;o<i.length;o++){let u=0,l=!1;for(let c=0;c<i[o].length;c++)if(WB(i[o][c])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};u+=parseInt(i[o][c],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[o][c]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};u+=1,l=!1}if(u!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(t[3][1]=="3"&&t[1]=="w"||t[3][1]=="6"&&t[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const a=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:o,regex:u}of a){if(!u.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${o} king`};if((t[0].match(u)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${o} kings`}}return Array.from(i[0]+i[7]).some(o=>o.toUpperCase()==="P")?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}function Ure(r,t){const n=r.from,s=r.to,i=r.piece;let a=0,o=0,u=0;for(let l=0,c=t.length;l<c;l++){const h=t[l].from,f=t[l].to,p=t[l].piece;i===p&&n!==h&&s===f&&(a++,Oc(n)===Oc(h)&&o++,lg(n)===lg(h)&&u++)}return a>0?o>0&&u>0?Vs(n):u>0?Vs(n).charAt(1):Vs(n).charAt(0):""}function rl(r,t,n,s,i,a=void 0,o=cn.NORMAL){const u=Oc(s);if(i===Ds&&(u===Ore||u===Bre))for(let l=0;l<GR.length;l++){const c=GR[l];r.push({color:t,from:n,to:s,piece:i,captured:a,promotion:c,flags:o|cn.PROMOTION})}else r.push({color:t,from:n,to:s,piece:i,captured:a,flags:o})}function jR(r){let t=r.charAt(0);return t>="a"&&t<="h"?r.match(/[a-h]\d.*[a-h]\d/)?void 0:Ds:(t=t.toLowerCase(),t==="o"?os:t)}function JC(r){return r.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function e_(r){return r.split(" ").slice(0,4).join(" ")}class Gre{constructor(t=ZC,{skipValidation:n=!1}={}){Bt(this,"_board",new Array(128));Bt(this,"_turn",Ks);Bt(this,"_header",{});Bt(this,"_kings",{w:Si,b:Si});Bt(this,"_epSquare",-1);Bt(this,"_halfMoves",0);Bt(this,"_moveNumber",0);Bt(this,"_history",[]);Bt(this,"_comments",{});Bt(this,"_castling",{w:0,b:0});Bt(this,"_positionCount",{});this.load(t,{skipValidation:n})}clear({preserveHeaders:t=!1}={}){this._board=new Array(128),this._kings={w:Si,b:Si},this._turn=Ks,this._castling={w:0,b:0},this._epSquare=Si,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=t?this._header:{...Are},this._positionCount={},this._header.SetUp=null,this._header.FEN=null}load(t,{skipValidation:n=!1,preserveHeaders:s=!1}={}){let i=t.split(/\s+/);if(i.length>=2&&i.length<6){const u=["-","-","0","1"];t=i.concat(u.slice(-(6-i.length))).join(" ")}if(i=t.split(/\s+/),!n){const{ok:u,error:l}=zre(t);if(!u)throw new Error(l)}const a=i[0];let o=0;this.clear({preserveHeaders:s});for(let u=0;u<a.length;u++){const l=a.charAt(u);if(l==="/")o+=8;else if(WB(l))o+=parseInt(l,10);else{const c=l<"a"?Ks:ya;this._put({type:l.toLowerCase(),color:c},Vs(o)),o++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=cn.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=cn.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=cn.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=cn.QSIDE_CASTLE),this._epSquare=i[3]==="-"?Si:Zt[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._updateSetup(t),this._incPositionCount(t)}fen(){var a,o;let t=0,n="";for(let u=Zt.a8;u<=Zt.h1;u++){if(this._board[u]){t>0&&(n+=t,t=0);const{color:l,type:c}=this._board[u];n+=l===Ks?c.toUpperCase():c.toLowerCase()}else t++;u+1&136&&(t>0&&(n+=t),u!==Zt.h1&&(n+="/"),t=0,u+=8)}let s="";this._castling[Ks]&cn.KSIDE_CASTLE&&(s+="K"),this._castling[Ks]&cn.QSIDE_CASTLE&&(s+="Q"),this._castling[ya]&cn.KSIDE_CASTLE&&(s+="k"),this._castling[ya]&cn.QSIDE_CASTLE&&(s+="q"),s=s||"-";let i="-";if(this._epSquare!==Si){const u=this._epSquare+(this._turn===Ks?16:-16),l=[u+1,u-1];for(const c of l){if(c&136)continue;const h=this._turn;if(((a=this._board[c])==null?void 0:a.color)===h&&((o=this._board[c])==null?void 0:o.type)===Ds){this._makeMove({color:h,from:c,to:this._epSquare,piece:Ds,captured:Ds,flags:cn.EP_CAPTURE});const f=!this._isKingAttacked(h);if(this._undoMove(),f){i=Vs(this._epSquare);break}}}}return[n,this._turn,s,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(t){this._history.length>0||(t!==ZC?(this._header.SetUp="1",this._header.FEN=t):(this._header.SetUp=null,this._header.FEN=null))}reset(){this.load(ZC)}get(t){return this._board[Zt[t]]}findPiece(t){var s;const n=[];for(let i=Zt.a8;i<=Zt.h1;i++){if(i&136){i+=7;continue}!this._board[i]||((s=this._board[i])==null?void 0:s.color)!==t.color||this._board[i].color===t.color&&this._board[i].type===t.type&&n.push(Vs(i))}return n}put({type:t,color:n},s){return this._put({type:t,color:n},s)?(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0):!1}_put({type:t,color:n},s){if(Rre.indexOf(t.toLowerCase())===-1||!(s in Zt))return!1;const i=Zt[s];if(t==os&&!(this._kings[n]==Si||this._kings[n]==i))return!1;const a=this._board[i];return a&&a.type===os&&(this._kings[a.color]=Si),this._board[i]={type:t,color:n},t===os&&(this._kings[n]=i),!0}remove(t){const n=this.get(t);return delete this._board[Zt[t]],n&&n.type===os&&(this._kings[n.color]=Si),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),n}_updateCastlingRights(){var s,i,a,o,u,l,c,h,f,p,g,y;const t=((s=this._board[Zt.e1])==null?void 0:s.type)===os&&((i=this._board[Zt.e1])==null?void 0:i.color)===Ks,n=((a=this._board[Zt.e8])==null?void 0:a.type)===os&&((o=this._board[Zt.e8])==null?void 0:o.color)===ya;(!t||((u=this._board[Zt.a1])==null?void 0:u.type)!==xm||((l=this._board[Zt.a1])==null?void 0:l.color)!==Ks)&&(this._castling.w&=-65),(!t||((c=this._board[Zt.h1])==null?void 0:c.type)!==xm||((h=this._board[Zt.h1])==null?void 0:h.color)!==Ks)&&(this._castling.w&=-33),(!n||((f=this._board[Zt.a8])==null?void 0:f.type)!==xm||((p=this._board[Zt.a8])==null?void 0:p.color)!==ya)&&(this._castling.b&=-65),(!n||((g=this._board[Zt.h8])==null?void 0:g.type)!==xm||((y=this._board[Zt.h8])==null?void 0:y.color)!==ya)&&(this._castling.b&=-33)}_updateEnPassantSquare(){var a,o;if(this._epSquare===Si)return;const t=this._epSquare+(this._turn===Ks?-16:16),n=this._epSquare+(this._turn===Ks?16:-16),s=[n+1,n-1];if(this._board[t]!==null||this._board[this._epSquare]!==null||((a=this._board[n])==null?void 0:a.color)!==um(this._turn)||((o=this._board[n])==null?void 0:o.type)!==Ds){this._epSquare=Si;return}const i=u=>{var l,c;return!(u&136)&&((l=this._board[u])==null?void 0:l.color)===this._turn&&((c=this._board[u])==null?void 0:c.type)===Ds};s.some(i)||(this._epSquare=Si)}_attacked(t,n,s){const i=[];for(let a=Zt.a8;a<=Zt.h1;a++){if(a&136){a+=7;continue}if(this._board[a]===void 0||this._board[a].color!==t)continue;const o=this._board[a],u=a-n;if(u===0)continue;const l=u+119;if(Ire[l]&Fre[o.type]){if(o.type===Ds){if(u>0&&o.color===Ks||u<=0&&o.color===ya)if(s)i.push(Vs(a));else return!0;continue}if(o.type==="n"||o.type==="k")if(s){i.push(Vs(a));continue}else return!0;const c=$re[l];let h=a+c,f=!1;for(;h!==n;){if(this._board[h]!=null){f=!0;break}h+=c}if(!f)if(s){i.push(Vs(a));continue}else return!0}}return s?i:!1}attackers(t,n){return n?this._attacked(n,Zt[t],!0):this._attacked(this._turn,Zt[t],!0)}_isKingAttacked(t){const n=this._kings[t];return n===-1?!1:this._attacked(um(t),n)}isAttacked(t,n){return this._attacked(n,Zt[t])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const t={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let s=0,i=0;for(let a=Zt.a8;a<=Zt.h1;a++){if(i=(i+1)%2,a&136){a+=7;continue}const o=this._board[a];o&&(t[o.type]=o.type in t?t[o.type]+1:1,o.type===nx&&n.push(i),s++)}if(s===2)return!0;if(s===3&&(t[nx]===1||t[yE]===1))return!0;if(s===t[nx]+2){let a=0;const o=n.length;for(let u=0;u<o;u++)a+=n[u];if(a===0||a===o)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:t=!1,square:n=void 0,piece:s=void 0}={}){const i=this._moves({square:n,piece:s});return t?i.map(a=>new $y(this,a)):i.map(a=>this._moveToSan(a,i))}_moves({legal:t=!0,piece:n=void 0,square:s=void 0}={}){var g;const i=s?s.toLowerCase():void 0,a=n==null?void 0:n.toLowerCase(),o=[],u=this._turn,l=um(u);let c=Zt.a8,h=Zt.h1,f=!1;if(i)if(i in Zt)c=h=Zt[i],f=!0;else return[];for(let y=c;y<=h;y++){if(y&136){y+=7;continue}if(!this._board[y]||this._board[y].color===l)continue;const{type:x}=this._board[y];let v;if(x===Ds){if(a&&a!==x)continue;v=y+QC[u][0],this._board[v]||(rl(o,u,y,v,Ds),v=y+QC[u][1],Pre[u]===Oc(y)&&!this._board[v]&&rl(o,u,y,v,Ds,void 0,cn.BIG_PAWN));for(let S=2;S<4;S++)v=y+QC[u][S],!(v&136)&&(((g=this._board[v])==null?void 0:g.color)===l?rl(o,u,y,v,Ds,this._board[v].type,cn.CAPTURE):v===this._epSquare&&rl(o,u,y,v,Ds,Ds,cn.EP_CAPTURE))}else{if(a&&a!==x)continue;for(let S=0,w=UR[x].length;S<w;S++){const E=UR[x][S];for(v=y;v+=E,!(v&136);){if(!this._board[v])rl(o,u,y,v,x);else{if(this._board[v].color===u)break;rl(o,u,y,v,x,this._board[v].type,cn.CAPTURE);break}if(x===yE||x===os)break}}}}if((a===void 0||a===os)&&(!f||h===this._kings[u])){if(this._castling[u]&cn.KSIDE_CASTLE){const y=this._kings[u],x=y+2;!this._board[y+1]&&!this._board[x]&&!this._attacked(l,this._kings[u])&&!this._attacked(l,y+1)&&!this._attacked(l,x)&&rl(o,u,this._kings[u],x,os,void 0,cn.KSIDE_CASTLE)}if(this._castling[u]&cn.QSIDE_CASTLE){const y=this._kings[u],x=y-2;!this._board[y-1]&&!this._board[y-2]&&!this._board[y-3]&&!this._attacked(l,this._kings[u])&&!this._attacked(l,y-1)&&!this._attacked(l,x)&&rl(o,u,this._kings[u],x,os,void 0,cn.QSIDE_CASTLE)}}if(!t||this._kings[u]===-1)return o;const p=[];for(let y=0,x=o.length;y<x;y++)this._makeMove(o[y]),this._isKingAttacked(u)||p.push(o[y]),this._undoMove();return p}move(t,{strict:n=!1}={}){let s=null;if(typeof t=="string")s=this._moveFromSan(t,n);else if(typeof t=="object"){const a=this._moves();for(let o=0,u=a.length;o<u;o++)if(t.from===Vs(a[o].from)&&t.to===Vs(a[o].to)&&(!("promotion"in a[o])||t.promotion===a[o].promotion)){s=a[o];break}}if(!s)throw typeof t=="string"?new Error(`Invalid move: ${t}`):new Error(`Invalid move: ${JSON.stringify(t)}`);const i=new $y(this,s);return this._makeMove(s),this._incPositionCount(i.after),i}_push(t){this._history.push({move:t,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(t){const n=this._turn,s=um(n);if(this._push(t),this._board[t.to]=this._board[t.from],delete this._board[t.from],t.flags&cn.EP_CAPTURE&&(this._turn===ya?delete this._board[t.to-16]:delete this._board[t.to+16]),t.promotion&&(this._board[t.to]={type:t.promotion,color:n}),this._board[t.to].type===os){if(this._kings[n]=t.to,t.flags&cn.KSIDE_CASTLE){const i=t.to-1,a=t.to+1;this._board[i]=this._board[a],delete this._board[a]}else if(t.flags&cn.QSIDE_CASTLE){const i=t.to+1,a=t.to-2;this._board[i]=this._board[a],delete this._board[a]}this._castling[n]=0}if(this._castling[n]){for(let i=0,a=nl[n].length;i<a;i++)if(t.from===nl[n][i].square&&this._castling[n]&nl[n][i].flag){this._castling[n]^=nl[n][i].flag;break}}if(this._castling[s]){for(let i=0,a=nl[s].length;i<a;i++)if(t.to===nl[s][i].square&&this._castling[s]&nl[s][i].flag){this._castling[s]^=nl[s][i].flag;break}}t.flags&cn.BIG_PAWN?n===ya?this._epSquare=t.to-16:this._epSquare=t.to+16:this._epSquare=Si,t.piece===Ds?this._halfMoves=0:t.flags&(cn.CAPTURE|cn.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===ya&&this._moveNumber++,this._turn=s}undo(){const t=this._undoMove();if(t){const n=new $y(this,t);return this._decPositionCount(n.after),n}return null}_undoMove(){const t=this._history.pop();if(t===void 0)return null;const n=t.move;this._kings=t.kings,this._turn=t.turn,this._castling=t.castling,this._epSquare=t.epSquare,this._halfMoves=t.halfMoves,this._moveNumber=t.moveNumber;const s=this._turn,i=um(s);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&cn.EP_CAPTURE){let a;s===ya?a=n.to-16:a=n.to+16,this._board[a]={type:Ds,color:i}}else this._board[n.to]={type:n.captured,color:i};if(n.flags&(cn.KSIDE_CASTLE|cn.QSIDE_CASTLE)){let a,o;n.flags&cn.KSIDE_CASTLE?(a=n.to+1,o=n.to-1):(a=n.to-2,o=n.to+1),this._board[a]=this._board[o],delete this._board[o]}return n}pgn({newline:t=`
`,maxWidth:n=0}={}){const s=[];let i=!1;for(const p in this._header)this._header[p]&&s.push(`[${p} "${this._header[p]}"]`+t),i=!0;i&&this._history.length&&s.push(t);const a=p=>{const g=this._comments[this.fen()];if(typeof g<"u"){const y=p.length>0?" ":"";p=`${p}${y}{${g}}`}return p},o=[];for(;this._history.length>0;)o.push(this._undoMove());const u=[];let l="";for(o.length===0&&u.push(a(""));o.length>0;){l=a(l);const p=o.pop();if(!p)break;if(!this._history.length&&p.color==="b"){const g=`${this._moveNumber}. ...`;l=l?`${l} ${g}`:g}else p.color==="w"&&(l.length&&u.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(p,this._moves({legal:!0})),this._makeMove(p)}if(l.length&&u.push(a(l)),u.push(this._header.Result||"*"),n===0)return s.join("")+u.join(" ");const c=function(){return s.length>0&&s[s.length-1]===" "?(s.pop(),!0):!1},h=function(p,g){for(const y of g.split(" "))if(y){if(p+y.length>n){for(;c();)p--;s.push(t),p=0}s.push(y),p+=y.length,s.push(" "),p++}return c()&&p--,p};let f=0;for(let p=0;p<u.length;p++){if(f+u[p].length>n&&u[p].includes("{")){f=h(f,u[p]);continue}f+u[p].length>n&&p!==0?(s[s.length-1]===" "&&s.pop(),s.push(t),f=0):p!==0&&(s.push(" "),f++),s.push(u[p]),f+=u[p].length}return s.join("")}header(...t){for(let n=0;n<t.length;n+=2)typeof t[n]=="string"&&typeof t[n+1]=="string"&&(this._header[t[n]]=t[n+1]);return this._header}setHeader(t,n){return this._header[t]=n??xE[t]??null,this.getHeaders()}removeHeader(t){return t in this._header?(this._header[t]=xE[t]||null,!0):!1}getHeaders(){const t={};for(const[n,s]of Object.entries(this._header))s!==null&&(t[n]=s);return t}loadPgn(t,{strict:n=!1,newlineChar:s=`\r?
`}={}){function i(E){return E.replace(/\\/g,"\\")}function a(E){const _={},D=E.split(new RegExp(i(s)));let I="",k="";for(let A=0;A<D.length;A++){const N=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;I=D[A].replace(N,"$1"),k=D[A].replace(N,"$2"),I.trim().length>0&&(_[I]=k)}return _}t=t.trim();const u=new RegExp("^(\\[((?:"+i(s)+")|.)*\\])((?:\\s*"+i(s)+"){2}|(?:\\s*"+i(s)+")*$)").exec(t),l=u&&u.length>=2?u[1]:"";this.reset();const c=a(l);let h="";for(const E in c)E.toLowerCase()==="fen"&&(h=c[E]),this.header(E,c[E]);if(!n)h&&this.load(h,{preserveHeaders:!0});else if(c.SetUp==="1"){if(!("FEN"in c))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(c.FEN,{preserveHeaders:!0})}function f(E){return Array.from(E).map(function(_){return _.charCodeAt(0)<128?_.charCodeAt(0).toString(16):encodeURIComponent(_).replace(/%/g,"").toLowerCase()}).join("")}function p(E){return E.length==0?"":decodeURIComponent("%"+(E.match(/.{1,2}/g)||[]).join("%"))}const g=function(E){return E=E.replace(new RegExp(i(s),"g")," "),`{${f(E.slice(1,E.length-1))}}`},y=function(E){if(E.startsWith("{")&&E.endsWith("}"))return p(E.slice(1,E.length-1))};let x=t.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${i(s)}]*)`,"g"),function(E,_,D){return _!==void 0?g(_):" "+g(`{${D.slice(1)}}`)}).replace(new RegExp(i(s),"g")," ");const v=/(\([^()]+\))+?/g;for(;v.test(x);)x=x.replace(v,"");x=x.replace(/\d+\.(\.\.)?/g,""),x=x.replace(/\.\.\./g,""),x=x.replace(/\$\d+/g,"");let S=x.trim().split(new RegExp(/\s+/));S=S.filter(E=>E!=="");let w="";for(let E=0;E<S.length;E++){const _=y(S[E]);if(_!==void 0){this._comments[this.fen()]=_;continue}const D=this._moveFromSan(S[E],n);if(D==null)if(Vre.indexOf(S[E])>-1)w=S[E];else throw new Error(`Invalid move in PGN: ${S[E]}`);else w="",this._makeMove(D),this._incPositionCount(this.fen())}w&&Object.keys(this._header).length&&this._header.Result!==w&&this.setHeader("Result",w)}_moveToSan(t,n){let s="";if(t.flags&cn.KSIDE_CASTLE)s="O-O";else if(t.flags&cn.QSIDE_CASTLE)s="O-O-O";else{if(t.piece!==Ds){const i=Ure(t,n);s+=t.piece.toUpperCase()+i}t.flags&(cn.CAPTURE|cn.EP_CAPTURE)&&(t.piece===Ds&&(s+=Vs(t.from)[0]),s+="x"),s+=Vs(t.to),t.promotion&&(s+="="+t.promotion.toUpperCase())}return this._makeMove(t),this.isCheck()&&(this.isCheckmate()?s+="#":s+="+"),this._undoMove(),s}_moveFromSan(t,n=!1){const s=JC(t);let i=jR(s),a=this._moves({legal:!0,piece:i});for(let p=0,g=a.length;p<g;p++)if(s===JC(this._moveToSan(a[p],a)))return a[p];if(n)return null;let o,u,l,c,h,f=!1;if(u=s.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),u?(o=u[1],l=u[2],c=u[3],h=u[4],l.length==1&&(f=!0)):(u=s.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),u&&(o=u[1],l=u[2],c=u[3],h=u[4],l.length==1&&(f=!0))),i=jR(s),a=this._moves({legal:!0,piece:o||i}),!c)return null;for(let p=0,g=a.length;p<g;p++)if(l){if((!o||o.toLowerCase()==a[p].piece)&&Zt[l]==a[p].from&&Zt[c]==a[p].to&&(!h||h.toLowerCase()==a[p].promotion))return a[p];if(f){const y=Vs(a[p].from);if((!o||o.toLowerCase()==a[p].piece)&&Zt[c]==a[p].to&&(l==y[0]||l==y[1])&&(!h||h.toLowerCase()==a[p].promotion))return a[p]}}else if(s===JC(this._moveToSan(a[p],a)).replace("x",""))return a[p];return null}ascii(){let t=`   +------------------------+
`;for(let n=Zt.a8;n<=Zt.h1;n++){if(lg(n)===0&&(t+=" "+"87654321"[Oc(n)]+" |"),this._board[n]){const s=this._board[n].type,a=this._board[n].color===Ks?s.toUpperCase():s.toLowerCase();t+=" "+a+" "}else t+=" . ";n+1&136&&(t+=`|
`,n+=8)}return t+=`   +------------------------+
`,t+="     a  b  c  d  e  f  g  h",t}perft(t){const n=this._moves({legal:!1});let s=0;const i=this._turn;for(let a=0,o=n.length;a<o;a++)this._makeMove(n[a]),this._isKingAttacked(i)||(t-1>0?s+=this.perft(t-1):s++),this._undoMove();return s}turn(){return this._turn}board(){const t=[];let n=[];for(let s=Zt.a8;s<=Zt.h1;s++)this._board[s]==null?n.push(null):n.push({square:Vs(s),type:this._board[s].type,color:this._board[s].color}),s+1&136&&(t.push(n),n=[],s+=8);return t}squareColor(t){if(t in Zt){const n=Zt[t];return(Oc(n)+lg(n))%2===0?"light":"dark"}return null}history({verbose:t=!1}={}){const n=[],s=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const i=n.pop();if(!i)break;t?s.push(new $y(this,i)):s.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return s}_getPositionCount(t){const n=e_(t);return this._positionCount[n]||0}_incPositionCount(t){const n=e_(t);this._positionCount[n]===void 0&&(this._positionCount[n]=0),this._positionCount[n]+=1}_decPositionCount(t){const n=e_(t);this._positionCount[n]===1?delete this._positionCount[n]:this._positionCount[n]-=1}_pruneComments(){const t=[],n={},s=i=>{i in this._comments&&(n[i]=this._comments[i])};for(;this._history.length>0;)t.push(this._undoMove());for(s(this.fen());;){const i=t.pop();if(!i)break;this._makeMove(i),s(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(t){this._comments[this.fen()]=t.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const t=this._comments[this.fen()];return delete this._comments[this.fen()],t}getComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>({fen:t,comment:this._comments[t]}))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map(t=>{const n=this._comments[t];return delete this._comments[t],{fen:t,comment:n}})}setCastlingRights(t,n){for(const i of[os,al])n[i]!==void 0&&(n[i]?this._castling[t]|=Fy[i]:this._castling[t]&=~Fy[i]);this._updateCastlingRights();const s=this.getCastlingRights(t);return(n[os]===void 0||n[os]===s[os])&&(n[al]===void 0||n[al]===s[al])}getCastlingRights(t){return{[os]:(this._castling[t]&Fy[os])!==0,[al]:(this._castling[t]&Fy[al])!==0}}moveNumber(){return this._moveNumber}}function jre(r,t){var n={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(n[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(n[s[i]]=r[s[i]]);return n}const cg="abcdefgh".split(""),rx={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},Wre={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Hre={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},qre=[7,6,5,4,3,2,1,0],Kre=[0,1,2,3,4,5,6,7],WR={wP:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),Se.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),Se.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),Se.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),Se.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),Se.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[Se.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),Se.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),Se.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),Se.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[Se.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),Se.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),Se.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),Se.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),Se.jsx("circle",{cx:"6",cy:"12",r:"2"}),Se.jsx("circle",{cx:"14",cy:"9",r:"2"}),Se.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),Se.jsx("circle",{cx:"31",cy:"9",r:"2"}),Se.jsx("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),Se.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),Se.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),Se.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),Se.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),Se.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),Se.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),Se.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),Se.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[Se.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),Se.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),Se.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),Se.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[Se.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),Se.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),Se.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),Se.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),Se.jsx("circle",{cx:"6",cy:"12",r:"2"}),Se.jsx("circle",{cx:"14",cy:"9",r:"2"}),Se.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),Se.jsx("circle",{cx:"31",cy:"9",r:"2"}),Se.jsx("circle",{cx:"39",cy:"12",r:"2"}),Se.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),Se.jsxs("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[Se.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),Se.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),Se.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),Se.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:Se.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[Se.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),Se.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),Se.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),Se.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),Se.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function bE(r,t,n){const s=t/8,i=r==="white"?Wre:Hre,a=r==="white"?qre:Kre,o=i[n[0]]*s+s/2,u=a[parseInt(n[1],10)-1]*s+s/2;return{x:o,y:u}}function HR(r){let t=!1;return Object.keys(rx).forEach(n=>{r[n]!==rx[n]&&(t=!0)}),Object.keys(r).forEach(n=>{rx[n]!==r[n]&&(t=!0)}),t}function Xre(r,t){const n={removed:{},added:{}};return Object.keys(r).forEach(s=>{t[s]!==r[s]&&(n.removed[s]=r[s])}),Object.keys(t).forEach(s=>{r[s]!==t[s]&&(n.added[s]=t[s])}),n}function qR(r){return r==="start"?rx:typeof r=="string"?Yre(r):r}function Yre(r){if(!Zre(r))return{};r=r.replace(/ .+$/,"");const t=r.split("/"),n={};let s=8;for(let i=0;i<8;i++){const a=t[i].split("");let o=0;for(let u=0;u<a.length;u++)if(a[u].search(/[1-8]/)!==-1){const l=parseInt(a[u],10);o=o+l}else{const l=cg[o]+s;n[l]=Jre(a[u]),o=o+1}s=s-1}return n}function Zre(r){r=r.replace(/ .+$/,""),r=Qre(r);const t=r.split("/");if(t.length!==8)return!1;for(let n=0;n<8;n++)if(t[n].length!==8||t[n].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function Qre(r){return r.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function Jre(r){return r.toLowerCase()===r?"b"+r.toUpperCase():"w"+r.toUpperCase()}const ese=(r,t=!0,n,s)=>{const[i,a]=ht.useState([]),[o,u]=ht.useState([]),[l,c]=ht.useState();ht.useEffect(()=>{Array.isArray(r)&&(h(),a(r==null?void 0:r.filter(y=>y[0]!==y[1])))},[r]),ht.useEffect(()=>{n==null||n(o)},[o]);function h(){u([]),c(void 0)}const f=(y,x)=>{t&&c([y,x,s])},p=[...o,...i];return{arrows:p,newArrow:l,clearArrows:h,drawNewArrow:f,setArrows:u,onArrowDrawEnd:(y,x)=>{if(y===x||!t)return;let v;const S=[y,x,s];p.every(([E,_])=>!(E===y&&_===x))?v=[...o,S]:v=o.filter(([E,_])=>!(E===y&&_===x)),c(void 0),u(v)}}},HB=ht.createContext({}),Au=()=>ht.useContext(HB),tse=ht.forwardRef(({allowDragOutsideBoard:r=!0,animationDuration:t=300,areArrowsAllowed:n=!0,arePiecesDraggable:s=!0,arePremovesAllowed:i=!1,autoPromoteToQueen:a=!1,boardOrientation:o="white",boardWidth:u,children:l,clearPremovesOnRightClick:c=!0,customArrows:h,customArrowColor:f="rgb(255,170,0)",customBoardStyle:p,customNotationStyle:g,customDarkSquareStyle:y={backgroundColor:"#B58863"},customDropSquareStyle:x={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:v={backgroundColor:"#F0D9B5"},customPieces:S,customPremoveDarkSquareStyle:w={backgroundColor:"#A42323"},customPremoveLightSquareStyle:E={backgroundColor:"#BD2828"},customSquare:_="div",customSquareStyles:D,dropOffBoardAction:I="snapback",id:k=0,isDraggablePiece:A=()=>!0,getPositionObject:N=()=>{},onArrowsChange:F=()=>{},onDragOverSquare:$=()=>{},onMouseOutSquare:O=()=>{},onMouseOverSquare:M=()=>{},onPieceClick:B=()=>{},onPieceDragBegin:U=()=>{},onPieceDragEnd:V=()=>{},onPieceDrop:Z=()=>!0,onPieceDropOffBoard:J=()=>{},onPromotionCheck:ne=(ve,Pe,et)=>(et==="wP"&&ve[1]==="7"&&Pe[1]==="8"||et==="bP"&&ve[1]==="2"&&Pe[1]==="1")&&Math.abs(ve.charCodeAt(0)-Pe.charCodeAt(0))<=1,onPromotionPieceSelect:z=()=>!0,onSparePieceDrop:X=()=>!0,onSquareClick:Y=()=>{},onSquareRightClick:se=()=>{},position:ue="start",promotionDialogVariant:fe="default",promotionToSquare:de=null,showBoardNotation:be=!0,showPromotionDialog:Me=!1,snapToCursor:_e=!0},Ne)=>{const[ve,Pe]=ht.useState(qR(ue)),[et,Ve]=ht.useState({removed:{},added:{}}),[re,Q]=ht.useState(void 0),[ce,xe]=ht.useState(Me&&!a),[Ge,Oe]=ht.useState(null),[lt,ot]=ht.useState(de),[bt,Et]=ht.useState([]),ft=ht.useRef(bt),[It,ut]=ht.useState(),[wt,St]=ht.useState(Object.assign(Object.assign({},WR),S)),[hr,qn]=ht.useState(!1),sn=ht.useRef(),[Pn,P]=ht.useState(!1),[K,ie]=ht.useState(null);ht.useImperativeHandle(Ne,()=>({clearPremoves(Qe=!0){q(Qe)}})),ht.useEffect(()=>{St(Object.assign(Object.assign({},WR),S))},[S]),ht.useEffect(()=>{xe(Me),ot(de)},[de,Me]),ht.useEffect(()=>{var Qe,ct,Gt;W();const pn=qR(ue),ws=Xre(ve,pn),Br=((Qe=Object.keys(ws.added))===null||Qe===void 0?void 0:Qe.length)<=2?(Gt=(ct=Object.entries(ws.added))===null||ct===void 0?void 0:ct[0])===null||Gt===void 0?void 0:Gt[1][0]:void 0;if(Pn)Pe(pn),P(!1),i&&Vn(Br),sn.current&&clearTimeout(sn.current);else if(hr)Pe(pn),P(!1),i&&Vn(Br);else{HR(pn)&&re!==void 0?Q(Br):HR(pn)?Q(void 0):Q("b"),Ve(ws),P(!0);const oo=setTimeout(()=>{Pe(pn),P(!1),i&&Vn(Br)},t);sn.current=oo}return qn(!1),N(pn),Xe(),()=>{clearTimeout(sn.current)}},[ue]);const{arrows:le,newArrow:ge,clearArrows:Xe,drawNewArrow:nt,onArrowDrawEnd:gt}=ese(h,n,F,f);function Ft(Qe,ct,Gt,pn){if(Qe===ct)return;if(Xe(),i&&Pn||i&&(re===Gt[0]||ft.current.filter(Br=>Br.piece[0]===Gt[0]).length>0)){const Br=[...ft.current];Br.push({sourceSq:Qe,targetSq:ct,piece:Gt}),ft.current=Br,Et([...Br]),W();return}if(!i&&Pn)return;const ws=Object.assign({},ve);qn(!!pn),Q(Gt[0]),Z.length?Z(Qe,ct,Gt)||(q(),qn(!1)):(delete ws[Qe],ws[ct]=Gt,Pe(ws)),W(),N(ws)}function qt(Qe){const ct=Object.assign({},ve);delete ct[Qe],Pe(ct),N(ct)}function Vn(Qe){if(ft.current.length===0)return;const ct=ft.current[0];if(ct.piece[0]!==void 0&&ct.piece[0]!==Qe&&Z.length)if(Q(ct.piece[0]),qn(!0),Z(ct.sourceSq,ct.targetSq,ct.piece)){const pn=[...ft.current];pn.shift(),ft.current=pn,Et([...pn])}else q()}function L(Qe,ct){if(!X(Qe,ct))return;const pn=Object.assign({},ve);pn[ct]=Qe,Pe(pn),N(pn)}function q(Qe=!0){Qe&&Q(void 0),ft.current=[],Et([])}function W(){Oe(null),ot(null),xe(!1)}function H(Qe){ut(Qe)}function ae(Qe){if(It){if(It===Qe){ut(void 0),c&&q(!1),se(Qe);return}}else ut(void 0)}function qe(){ut(void 0)}const Ze={allowDragOutsideBoard:r,animationDuration:t,arePiecesDraggable:s,arePremovesAllowed:i,arrows:le,autoPromoteToQueen:a,boardOrientation:o,boardWidth:u,chessPieces:wt,clearArrows:Xe,clearCurrentRightClickDown:qe,currentPosition:ve,currentRightClickDown:It,customArrowColor:f,customBoardStyle:p,customDarkSquareStyle:y,customDropSquareStyle:x,customLightSquareStyle:v,customNotationStyle:g,customPremoveDarkSquareStyle:w,customPremoveLightSquareStyle:E,customSquare:_,customSquareStyles:D,deletePieceFromSquare:qt,drawNewArrow:nt,dropOffBoardAction:I,handleSetPosition:Ft,handleSparePieceDrop:L,id:k,isDraggablePiece:A,isWaitingForAnimation:Pn,lastPieceColour:re,lastSquareDraggedOver:K,newArrow:ge,onArrowDrawEnd:gt,onDragOverSquare:$,onMouseOutSquare:O,onMouseOverSquare:M,onPieceClick:B,onPieceDragBegin:U,onPieceDragEnd:V,onPieceDrop:Z,onPieceDropOffBoard:J,onPromotionCheck:ne,onPromotionPieceSelect:z,onRightClickDown:H,onRightClickUp:ae,onSparePieceDrop:X,onSquareClick:Y,positionDifferences:et,premoves:bt,promoteFromSquare:Ge,promoteToSquare:lt,promotionDialogVariant:fe,setLastSquareDraggedOver:ie,setPromoteFromSquare:Oe,setPromoteToSquare:ot,setShowPromoteDialog:xe,showBoardNotation:be,showPromoteDialog:ce,snapToCursor:_e};return Se.jsx(HB.Provider,Object.assign({value:Ze},{children:l}))});function nse({row:r,col:t}){const{boardOrientation:n,boardWidth:s,customDarkSquareStyle:i,customLightSquareStyle:a,customNotationStyle:o}=Au(),u=a.backgroundColor,l=i.backgroundColor,c=t===0,h=r===7,f=c&&h;function p(){return n==="white"?8-r:r+1}function g(){return n==="black"?cg[7-t]:cg[t]}function y(){return Se.jsxs(Se.Fragment,{children:[Se.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:u}),XR(s,o))},{children:p()})),Se.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:u}),KR(s,o))},{children:g()}))]})}function x(){return Se.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:t%2!==0?l:u}),KR(s,o))},{children:g()}))}function v(){return Se.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},n==="black"?{color:r%2===0?l:u}:{color:r%2===0?l:u}),XR(s,o))},{children:p()}))}return f?y():h?x():c?v():null}const KR=(r,t)=>Object.assign({alignSelf:"flex-end",paddingLeft:r/8-r/48,fontSize:r/48},t),XR=(r,t)=>Object.assign({alignSelf:"flex-start",paddingRight:r/8-r/48,fontSize:r/48},t),qB=ht.createContext({dragDropManager:void 0});function pa(r){return"Minified Redux error #"+r+"; visit https://redux.js.org/Errors?code="+r+" for the full message or use the non-minified dev environment for full errors. "}var YR=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),ZR=function(){return Math.random().toString(36).substring(7).split("").join(".")},QR={INIT:"@@redux/INIT"+ZR(),REPLACE:"@@redux/REPLACE"+ZR()};function rse(r){if(typeof r!="object"||r===null)return!1;for(var t=r;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(r)===t}function KB(r,t,n){var s;if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(pa(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(pa(1));return n(KB)(r,t)}if(typeof r!="function")throw new Error(pa(2));var i=r,a=t,o=[],u=o,l=!1;function c(){u===o&&(u=o.slice())}function h(){if(l)throw new Error(pa(3));return a}function f(x){if(typeof x!="function")throw new Error(pa(4));if(l)throw new Error(pa(5));var v=!0;return c(),u.push(x),function(){if(v){if(l)throw new Error(pa(6));v=!1,c();var w=u.indexOf(x);u.splice(w,1),o=null}}}function p(x){if(!rse(x))throw new Error(pa(7));if(typeof x.type>"u")throw new Error(pa(8));if(l)throw new Error(pa(9));try{l=!0,a=i(a,x)}finally{l=!1}for(var v=o=u,S=0;S<v.length;S++){var w=v[S];w()}return x}function g(x){if(typeof x!="function")throw new Error(pa(10));i=x,p({type:QR.REPLACE})}function y(){var x,v=f;return x={subscribe:function(w){if(typeof w!="object"||w===null)throw new Error(pa(11));function E(){w.next&&w.next(h())}E();var _=v(E);return{unsubscribe:_}}},x[YR]=function(){return this},x}return p({type:QR.INIT}),s={dispatch:p,subscribe:f,getState:h,replaceReducer:g},s[YR]=y,s}function an(r,t,...n){if(sse()&&t===void 0)throw new Error("invariant requires an error message argument");if(!r){let s;if(t===void 0)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;s=new Error(t.replace(/%s/g,function(){return n[i++]})),s.name="Invariant Violation"}throw s.framesToPop=1,s}}function sse(){return typeof process<"u"&&!0}function ise(r,t,n){return t.split(".").reduce((s,i)=>s&&s[i]?s[i]:n||null,r)}function ase(r,t){return r.filter(n=>n!==t)}function XB(r){return typeof r=="object"}function ose(r,t){const n=new Map,s=a=>{n.set(a,n.has(a)?n.get(a)+1:1)};r.forEach(s),t.forEach(s);const i=[];return n.forEach((a,o)=>{a===1&&i.push(o)}),i}function use(r,t){return r.filter(n=>t.indexOf(n)>-1)}const LT="dnd-core/INIT_COORDS",dv="dnd-core/BEGIN_DRAG",BT="dnd-core/PUBLISH_DRAG_SOURCE",pv="dnd-core/HOVER",mv="dnd-core/DROP",gv="dnd-core/END_DRAG";function JR(r,t){return{type:LT,payload:{sourceClientOffset:t||null,clientOffset:r||null}}}const lse={type:LT,payload:{clientOffset:null,sourceClientOffset:null}};function cse(r){return function(n=[],s={publishSource:!0}){const{publishSource:i=!0,clientOffset:a,getSourceClientOffset:o}=s,u=r.getMonitor(),l=r.getRegistry();r.dispatch(JR(a)),hse(n,u,l);const c=pse(n,u);if(c==null){r.dispatch(lse);return}let h=null;if(a){if(!o)throw new Error("getSourceClientOffset must be defined");fse(o),h=o(c)}r.dispatch(JR(a,h));const p=l.getSource(c).beginDrag(u,c);if(p==null)return;dse(p),l.pinSource(c);const g=l.getSourceType(c);return{type:dv,payload:{itemType:g,item:p,sourceId:c,clientOffset:a||null,sourceClientOffset:h||null,isSourcePublic:!!i}}}}function hse(r,t,n){an(!t.isDragging(),"Cannot call beginDrag while dragging."),r.forEach(function(s){an(n.getSource(s),"Expected sourceIds to be registered.")})}function fse(r){an(typeof r=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function dse(r){an(XB(r),"Item must be an object.")}function pse(r,t){let n=null;for(let s=r.length-1;s>=0;s--)if(t.canDragSource(r[s])){n=r[s];break}return n}function mse(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function gse(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),s.forEach(function(i){mse(r,i,n[i])})}return r}function yse(r){return function(n={}){const s=r.getMonitor(),i=r.getRegistry();xse(s),wse(s).forEach((o,u)=>{const l=bse(o,u,i,s),c={type:mv,payload:{dropResult:gse({},n,l)}};r.dispatch(c)})}}function xse(r){an(r.isDragging(),"Cannot call drop while not dragging."),an(!r.didDrop(),"Cannot call drop twice during one drag operation.")}function bse(r,t,n,s){const i=n.getTarget(r);let a=i?i.drop(s,r):void 0;return vse(a),typeof a>"u"&&(a=t===0?{}:s.getDropResult()),a}function vse(r){an(typeof r>"u"||XB(r),"Drop result must either be an object or undefined.")}function wse(r){const t=r.getTargetIds().filter(r.canDropOnTarget,r);return t.reverse(),t}function Sse(r){return function(){const n=r.getMonitor(),s=r.getRegistry();Cse(n);const i=n.getSourceId();return i!=null&&(s.getSource(i,!0).endDrag(n,i),s.unpinSource()),{type:gv}}}function Cse(r){an(r.isDragging(),"Cannot call endDrag while not dragging.")}function vE(r,t){return t===null?r===null:Array.isArray(r)?r.some(n=>n===t):r===t}function _se(r){return function(n,{clientOffset:s}={}){Ese(n);const i=n.slice(0),a=r.getMonitor(),o=r.getRegistry(),u=a.getItemType();return Tse(i,o,u),Dse(i,a,o),Nse(i,a,o),{type:pv,payload:{targetIds:i,clientOffset:s||null}}}}function Ese(r){an(Array.isArray(r),"Expected targetIds to be an array.")}function Dse(r,t,n){an(t.isDragging(),"Cannot call hover while not dragging."),an(!t.didDrop(),"Cannot call hover after drop.");for(let s=0;s<r.length;s++){const i=r[s];an(r.lastIndexOf(i)===s,"Expected targetIds to be unique in the passed array.");const a=n.getTarget(i);an(a,"Expected targetIds to be registered.")}}function Tse(r,t,n){for(let s=r.length-1;s>=0;s--){const i=r[s],a=t.getTargetType(i);vE(a,n)||r.splice(s,1)}}function Nse(r,t,n){r.forEach(function(s){n.getTarget(s).hover(t,s)})}function kse(r){return function(){if(r.getMonitor().isDragging())return{type:BT}}}function Ase(r){return{beginDrag:cse(r),publishDragSource:kse(r),hover:_se(r),drop:yse(r),endDrag:Sse(r)}}class Ise{receiveBackend(t){this.backend=t}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const t=this,{dispatch:n}=this.store;function s(a){return(...o)=>{const u=a.apply(t,o);typeof u<"u"&&n(u)}}const i=Ase(this);return Object.keys(i).reduce((a,o)=>{const u=i[o];return a[o]=s(u),a},{})}dispatch(t){this.store.dispatch(t)}constructor(t,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const s=this.store.getState().refCount>0;this.backend&&(s&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!s&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}}function $se(r,t){return{x:r.x+t.x,y:r.y+t.y}}function YB(r,t){return{x:r.x-t.x,y:r.y-t.y}}function Fse(r){const{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:s}=r;return!t||!n||!s?null:YB($se(t,s),n)}function Rse(r){const{clientOffset:t,initialClientOffset:n}=r;return!t||!n?null:YB(t,n)}const Om=[],PT=[];Om.__IS_NONE__=!0;PT.__IS_ALL__=!0;function Ose(r,t){return r===Om?!1:r===PT||typeof t>"u"?!0:use(t,r).length>0}class Mse{subscribeToStateChange(t,n={}){const{handlerIds:s}=n;an(typeof t=="function","listener must be a function."),an(typeof s>"u"||Array.isArray(s),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;const a=()=>{const o=this.store.getState(),u=o.stateId;try{u===i||u===i+1&&!Ose(o.dirtyHandlerIds,s)||t()}finally{i=u}};return this.store.subscribe(a)}subscribeToOffsetChange(t){an(typeof t=="function","listener must be a function.");let n=this.store.getState().dragOffset;const s=()=>{const i=this.store.getState().dragOffset;i!==n&&(n=i,t())};return this.store.subscribe(s)}canDragSource(t){if(!t)return!1;const n=this.registry.getSource(t);return an(n,`Expected to find a valid source. sourceId=${t}`),this.isDragging()?!1:n.canDrag(this,t)}canDropOnTarget(t){if(!t)return!1;const n=this.registry.getTarget(t);if(an(n,`Expected to find a valid target. targetId=${t}`),!this.isDragging()||this.didDrop())return!1;const s=this.registry.getTargetType(t),i=this.getItemType();return vE(s,i)&&n.canDrop(this,t)}isDragging(){return!!this.getItemType()}isDraggingSource(t){if(!t)return!1;const n=this.registry.getSource(t,!0);if(an(n,`Expected to find a valid source. sourceId=${t}`),!this.isDragging()||!this.isSourcePublic())return!1;const s=this.registry.getSourceType(t),i=this.getItemType();return s!==i?!1:n.isDragging(this,t)}isOverTarget(t,n={shallow:!1}){if(!t)return!1;const{shallow:s}=n;if(!this.isDragging())return!1;const i=this.registry.getTargetType(t),a=this.getItemType();if(a&&!vE(i,a))return!1;const o=this.getTargetIds();if(!o.length)return!1;const u=o.indexOf(t);return s?u===o.length-1:u>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return Fse(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return Rse(this.store.getState().dragOffset)}constructor(t,n){this.store=t,this.registry=n}}const eO=typeof global<"u"?global:self,ZB=eO.MutationObserver||eO.WebKitMutationObserver;function QB(r){return function(){const n=setTimeout(i,0),s=setInterval(i,50);function i(){clearTimeout(n),clearInterval(s),r()}}}function Lse(r){let t=1;const n=new ZB(r),s=document.createTextNode("");return n.observe(s,{characterData:!0}),function(){t=-t,s.data=t}}const Bse=typeof ZB=="function"?Lse:QB;class Pse{enqueueTask(t){const{queue:n,requestFlush:s}=this;n.length||(s(),this.flushing=!0),n[n.length]=t}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:t}=this;for(;this.index<t.length;){const n=this.index;if(this.index++,t[n].call(),this.index>this.capacity){for(let s=0,i=t.length-this.index;s<i;s++)t[s]=t[s+this.index];t.length-=this.index,this.index=0}}t.length=0,this.index=0,this.flushing=!1},this.registerPendingError=t=>{this.pendingErrors.push(t),this.requestErrorThrow()},this.requestFlush=Bse(this.flush),this.requestErrorThrow=QB(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class Vse{call(){try{this.task&&this.task()}catch(t){this.onError(t)}finally{this.task=null,this.release(this)}}constructor(t,n){this.onError=t,this.release=n,this.task=null}}class zse{create(t){const n=this.freeTasks,s=n.length?n.pop():new Vse(this.onError,i=>n[n.length]=i);return s.task=t,s}constructor(t){this.onError=t,this.freeTasks=[]}}const JB=new Pse,Use=new zse(JB.registerPendingError);function Gse(r){JB.enqueueTask(Use.create(r))}const VT="dnd-core/ADD_SOURCE",zT="dnd-core/ADD_TARGET",UT="dnd-core/REMOVE_SOURCE",yv="dnd-core/REMOVE_TARGET";function jse(r){return{type:VT,payload:{sourceId:r}}}function Wse(r){return{type:zT,payload:{targetId:r}}}function Hse(r){return{type:UT,payload:{sourceId:r}}}function qse(r){return{type:yv,payload:{targetId:r}}}function Kse(r){an(typeof r.canDrag=="function","Expected canDrag to be a function."),an(typeof r.beginDrag=="function","Expected beginDrag to be a function."),an(typeof r.endDrag=="function","Expected endDrag to be a function.")}function Xse(r){an(typeof r.canDrop=="function","Expected canDrop to be a function."),an(typeof r.hover=="function","Expected hover to be a function."),an(typeof r.drop=="function","Expected beginDrag to be a function.")}function wE(r,t){if(t&&Array.isArray(r)){r.forEach(n=>wE(n,!1));return}an(typeof r=="string"||typeof r=="symbol",t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var wa;(function(r){r.SOURCE="SOURCE",r.TARGET="TARGET"})(wa||(wa={}));let Yse=0;function Zse(){return Yse++}function Qse(r){const t=Zse().toString();switch(r){case wa.SOURCE:return`S${t}`;case wa.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${r}`)}}function tO(r){switch(r[0]){case"S":return wa.SOURCE;case"T":return wa.TARGET;default:throw new Error(`Cannot parse handler ID: ${r}`)}}function nO(r,t){const n=r.entries();let s=!1;do{const{done:i,value:[,a]}=n.next();if(a===t)return!0;s=!!i}while(!s);return!1}class Jse{addSource(t,n){wE(t),Kse(n);const s=this.addHandler(wa.SOURCE,t,n);return this.store.dispatch(jse(s)),s}addTarget(t,n){wE(t,!0),Xse(n);const s=this.addHandler(wa.TARGET,t,n);return this.store.dispatch(Wse(s)),s}containsHandler(t){return nO(this.dragSources,t)||nO(this.dropTargets,t)}getSource(t,n=!1){return an(this.isSourceId(t),"Expected a valid source ID."),n&&t===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(t)}getTarget(t){return an(this.isTargetId(t),"Expected a valid target ID."),this.dropTargets.get(t)}getSourceType(t){return an(this.isSourceId(t),"Expected a valid source ID."),this.types.get(t)}getTargetType(t){return an(this.isTargetId(t),"Expected a valid target ID."),this.types.get(t)}isSourceId(t){return tO(t)===wa.SOURCE}isTargetId(t){return tO(t)===wa.TARGET}removeSource(t){an(this.getSource(t),"Expected an existing source."),this.store.dispatch(Hse(t)),Gse(()=>{this.dragSources.delete(t),this.types.delete(t)})}removeTarget(t){an(this.getTarget(t),"Expected an existing target."),this.store.dispatch(qse(t)),this.dropTargets.delete(t),this.types.delete(t)}pinSource(t){const n=this.getSource(t);an(n,"Expected an existing source."),this.pinnedSourceId=t,this.pinnedSource=n}unpinSource(){an(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(t,n,s){const i=Qse(t);return this.types.set(i,n),t===wa.SOURCE?this.dragSources.set(i,s):t===wa.TARGET&&this.dropTargets.set(i,s),i}constructor(t){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}}const eie=(r,t)=>r===t;function tie(r,t){return!r&&!t?!0:!r||!t?!1:r.x===t.x&&r.y===t.y}function nie(r,t,n=eie){if(r.length!==t.length)return!1;for(let s=0;s<r.length;++s)if(!n(r[s],t[s]))return!1;return!0}function rie(r=Om,t){switch(t.type){case pv:break;case VT:case zT:case yv:case UT:return Om;case dv:case BT:case gv:case mv:default:return PT}const{targetIds:n=[],prevTargetIds:s=[]}=t.payload,i=ose(n,s);if(!(i.length>0||!nie(n,s)))return Om;const o=s[s.length-1],u=n[n.length-1];return o!==u&&(o&&i.push(o),u&&i.push(u)),i}function sie(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function iie(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),s.forEach(function(i){sie(r,i,n[i])})}return r}const rO={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function aie(r=rO,t){const{payload:n}=t;switch(t.type){case LT:case dv:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case pv:return tie(r.clientOffset,n.clientOffset)?r:iie({},r,{clientOffset:n.clientOffset});case gv:case mv:return rO;default:return r}}function oie(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function Cf(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),s.forEach(function(i){oie(r,i,n[i])})}return r}const uie={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function lie(r=uie,t){const{payload:n}=t;switch(t.type){case dv:return Cf({},r,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case BT:return Cf({},r,{isSourcePublic:!0});case pv:return Cf({},r,{targetIds:n.targetIds});case yv:return r.targetIds.indexOf(n.targetId)===-1?r:Cf({},r,{targetIds:ase(r.targetIds,n.targetId)});case mv:return Cf({},r,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case gv:return Cf({},r,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return r}}function cie(r=0,t){switch(t.type){case VT:case zT:return r+1;case UT:case yv:return r-1;default:return r}}function hie(r=0){return r+1}function fie(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function die(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),s.forEach(function(i){fie(r,i,n[i])})}return r}function pie(r={},t){return{dirtyHandlerIds:rie(r.dirtyHandlerIds,{type:t.type,payload:die({},t.payload,{prevTargetIds:ise(r,"dragOperation.targetIds",[])})}),dragOffset:aie(r.dragOffset,t),refCount:cie(r.refCount,t),dragOperation:lie(r.dragOperation,t),stateId:hie(r.stateId)}}function mie(r,t=void 0,n={},s=!1){const i=gie(s),a=new Mse(i,new Jse(i)),o=new Ise(i,a),u=r(o,t,n);return o.receiveBackend(u),o}function gie(r){const t=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return KB(pie,r&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}function yie(r,t){if(r==null)return{};var n=xie(r,t),s,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(n[s]=r[s])}return n}function xie(r,t){if(r==null)return{};var n={},s=Object.keys(r),i,a;for(a=0;a<s.length;a++)i=s[a],!(t.indexOf(i)>=0)&&(n[i]=r[i]);return n}let sO=0;const sx=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var bie=ht.memo(function(t){var{children:n}=t,s=yie(t,["children"]);const[i,a]=vie(s);return ht.useEffect(()=>{if(a){const o=eP();return++sO,()=>{--sO===0&&(o[sx]=null)}}},[]),Se.jsx(qB.Provider,{value:i,children:n})});function vie(r){if("manager"in r)return[{dragDropManager:r.manager},!1];const t=wie(r.backend,r.context,r.options,r.debugMode),n=!r.context;return[t,n]}function wie(r,t=eP(),n,s){const i=t;return i[sx]||(i[sx]={dragDropManager:mie(r,t,n,s)}),i[sx]}function eP(){return typeof global<"u"?global:window}var Sie=function r(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var s,i,a;if(Array.isArray(t)){if(s=t.length,s!=n.length)return!1;for(i=s;i--!==0;)if(!r(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),s=a.length,s!==Object.keys(n).length)return!1;for(i=s;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=s;i--!==0;){var o=a[i];if(!r(t[o],n[o]))return!1}return!0}return t!==t&&n!==n};const th=typeof window<"u"?ht.useLayoutEffect:ht.useEffect;function tP(r,t,n){const[s,i]=ht.useState(()=>t(r)),a=ht.useCallback(()=>{const o=t(r);Sie(s,o)||(i(o),n&&n())},[s,r,n]);return th(a),[s,a]}function Cie(r,t,n){const[s,i]=tP(r,t,n);return th(function(){const o=r.getHandlerId();if(o!=null)return r.subscribeToStateChange(i,{handlerIds:[o]})},[r,i]),s}function nP(r,t,n){return Cie(t,r||(()=>({})),()=>n.reconnect())}function rP(r,t){const n=[...t||[]];return t==null&&typeof r!="function"&&n.push(r),ht.useMemo(()=>typeof r=="function"?r():r,n)}function _ie(r){return ht.useMemo(()=>r.hooks.dragSource(),[r])}function Eie(r){return ht.useMemo(()=>r.hooks.dragPreview(),[r])}let t_=!1,n_=!1;class Die{receiveHandlerId(t){this.sourceId=t}getHandlerId(){return this.sourceId}canDrag(){an(!t_,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return t_=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{t_=!1}}isDragging(){if(!this.sourceId)return!1;an(!n_,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return n_=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{n_=!1}}subscribeToStateChange(t,n){return this.internalMonitor.subscribeToStateChange(t,n)}isDraggingSource(t){return this.internalMonitor.isDraggingSource(t)}isOverTarget(t,n){return this.internalMonitor.isOverTarget(t,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(t){return this.internalMonitor.subscribeToOffsetChange(t)}canDragSource(t){return this.internalMonitor.canDragSource(t)}canDropOnTarget(t){return this.internalMonitor.canDropOnTarget(t)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.sourceId=null,this.internalMonitor=t.getMonitor()}}let r_=!1;class Tie{receiveHandlerId(t){this.targetId=t}getHandlerId(){return this.targetId}subscribeToStateChange(t,n){return this.internalMonitor.subscribeToStateChange(t,n)}canDrop(){if(!this.targetId)return!1;an(!r_,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return r_=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{r_=!1}}isOver(t){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,t):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.targetId=null,this.internalMonitor=t.getMonitor()}}function Nie(r,t,n){const s=n.getRegistry(),i=s.addTarget(r,t);return[i,()=>s.removeTarget(i)]}function kie(r,t,n){const s=n.getRegistry(),i=s.addSource(r,t);return[i,()=>s.removeSource(i)]}function SE(r,t,n,s){let i;if(i!==void 0)return!!i;if(r===t)return!0;if(typeof r!="object"||!r||typeof t!="object"||!t)return!1;const a=Object.keys(r),o=Object.keys(t);if(a.length!==o.length)return!1;const u=Object.prototype.hasOwnProperty.bind(t);for(let l=0;l<a.length;l++){const c=a[l];if(!u(c))return!1;const h=r[c],f=t[c];if(i=void 0,i===!1||i===void 0&&h!==f)return!1}return!0}function CE(r){return r!==null&&typeof r=="object"&&Object.prototype.hasOwnProperty.call(r,"current")}function Aie(r){if(typeof r.type=="string")return;const t=r.type.displayName||r.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}function Iie(r){return(t=null,n=null)=>{if(!ht.isValidElement(t)){const a=t;return r(a,n),a}const s=t;return Aie(s),$ie(s,n?a=>r(a,n):r)}}function sP(r){const t={};return Object.keys(r).forEach(n=>{const s=r[n];if(n.endsWith("Ref"))t[n]=r[n];else{const i=Iie(s);t[n]=()=>i}}),t}function iO(r,t){typeof r=="function"?r(t):r.current=t}function $ie(r,t){const n=r.ref;return an(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?ht.cloneElement(r,{ref:s=>{iO(n,s),iO(t,s)}}):ht.cloneElement(r,{ref:t})}class Fie{receiveHandlerId(t){this.handlerId!==t&&(this.handlerId=t,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(t){this.dragSourceOptionsInternal=t}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(t){this.dragPreviewOptionsInternal=t}reconnect(){const t=this.reconnectDragSource();this.reconnectDragPreview(t)}reconnectDragSource(){const t=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?t?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)),n):(this.lastConnectedDragSource=t,n):n}reconnectDragPreview(t=!1){const n=this.dragPreview,s=t||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(s&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}s&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!SE(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!SE(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(t){this.hooks=sP({dragSource:(n,s)=>{this.clearDragSource(),this.dragSourceOptions=s||null,CE(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,s)=>{this.clearDragPreview(),this.dragPreviewOptions=s||null,CE(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}}class Rie{get connectTarget(){return this.dropTarget}reconnect(){const t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(t){this.dropTargetOptionsInternal=t}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!SE(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(t){this.hooks=sP({dropTarget:(n,s)=>{this.clearDropTarget(),this.dropTargetOptions=s,CE(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}}function _h(){const{dragDropManager:r}=ht.useContext(qB);return an(r!=null,"Expected drag drop context"),r}function Oie(r,t){const n=_h(),s=ht.useMemo(()=>new Fie(n.getBackend()),[n]);return th(()=>(s.dragSourceOptions=r||null,s.reconnect(),()=>s.disconnectDragSource()),[s,r]),th(()=>(s.dragPreviewOptions=t||null,s.reconnect(),()=>s.disconnectDragPreview()),[s,t]),s}function Mie(){const r=_h();return ht.useMemo(()=>new Die(r),[r])}class Lie{beginDrag(){const t=this.spec,n=this.monitor;let s=null;return typeof t.item=="object"?s=t.item:typeof t.item=="function"?s=t.item(n):s={},s??null}canDrag(){const t=this.spec,n=this.monitor;return typeof t.canDrag=="boolean"?t.canDrag:typeof t.canDrag=="function"?t.canDrag(n):!0}isDragging(t,n){const s=this.spec,i=this.monitor,{isDragging:a}=s;return a?a(i):n===t.getSourceId()}endDrag(){const t=this.spec,n=this.monitor,s=this.connector,{end:i}=t;i&&i(n.getItem(),n),s.reconnect()}constructor(t,n,s){this.spec=t,this.monitor=n,this.connector=s}}function Bie(r,t,n){const s=ht.useMemo(()=>new Lie(r,t,n),[t,n]);return ht.useEffect(()=>{s.spec=r},[r]),s}function Pie(r){return ht.useMemo(()=>{const t=r.type;return an(t!=null,"spec.type must be defined"),t},[r])}function Vie(r,t,n){const s=_h(),i=Bie(r,t,n),a=Pie(r);th(function(){if(a!=null){const[u,l]=kie(a,i,s);return t.receiveHandlerId(u),n.receiveHandlerId(u),l}},[s,t,n,i,a])}function zie(r,t){const n=rP(r,t);an(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const s=Mie(),i=Oie(n.options,n.previewOptions);return Vie(n,s,i),[nP(n.collect,s,i),_ie(i),Eie(i)]}function Uie(r){const n=_h().getMonitor(),[s,i]=tP(n,r);return ht.useEffect(()=>n.subscribeToOffsetChange(i)),ht.useEffect(()=>n.subscribeToStateChange(i)),s}function Gie(r){return ht.useMemo(()=>r.hooks.dropTarget(),[r])}function jie(r){const t=_h(),n=ht.useMemo(()=>new Rie(t.getBackend()),[t]);return th(()=>(n.dropTargetOptions=r||null,n.reconnect(),()=>n.disconnectDropTarget()),[r]),n}function Wie(){const r=_h();return ht.useMemo(()=>new Tie(r),[r])}function Hie(r){const{accept:t}=r;return ht.useMemo(()=>(an(r.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}class qie{canDrop(){const t=this.spec,n=this.monitor;return t.canDrop?t.canDrop(n.getItem(),n):!0}hover(){const t=this.spec,n=this.monitor;t.hover&&t.hover(n.getItem(),n)}drop(){const t=this.spec,n=this.monitor;if(t.drop)return t.drop(n.getItem(),n)}constructor(t,n){this.spec=t,this.monitor=n}}function Kie(r,t){const n=ht.useMemo(()=>new qie(r,t),[t]);return ht.useEffect(()=>{n.spec=r},[r]),n}function Xie(r,t,n){const s=_h(),i=Kie(r,t),a=Hie(r);th(function(){const[u,l]=Nie(a,i,s);return t.receiveHandlerId(u),n.receiveHandlerId(u),l},[s,t,i,n,a.map(o=>o.toString()).join("|")])}function Yie(r,t){const n=rP(r,t),s=Wie(),i=jie(n.options);return Xie(n,s,i),[nP(n.collect,s,i),Gie(i)]}function iP(r){let t=null;return()=>(t==null&&(t=r()),t)}function Zie(r,t){return r.filter(n=>n!==t)}function Qie(r,t){const n=new Set,s=a=>n.add(a);r.forEach(s),t.forEach(s);const i=[];return n.forEach(a=>i.push(a)),i}class Jie{enter(t){const n=this.entered.length,s=i=>this.isNodeInDocument(i)&&(!i.contains||i.contains(t));return this.entered=Qie(this.entered.filter(s),[t]),n===0&&this.entered.length>0}leave(t){const n=this.entered.length;return this.entered=Zie(this.entered.filter(this.isNodeInDocument),t),n>0&&this.entered.length===0}reset(){this.entered=[]}constructor(t){this.entered=[],this.isNodeInDocument=t}}class eae{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(t=>{Object.defineProperty(this.item,t,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${t}" until the drop event.`),null}})})}loadDataTransfer(t){if(t){const n={};Object.keys(this.config.exposeProperties).forEach(s=>{const i=this.config.exposeProperties[s];i!=null&&(n[s]={value:i(t,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,n)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(t,n){return n===t.getSourceId()}endDrag(){}constructor(t){this.config=t,this.item={},this.initializeExposedProperties()}}const aP="__NATIVE_FILE__",oP="__NATIVE_URL__",uP="__NATIVE_TEXT__",lP="__NATIVE_HTML__";var aO=Object.freeze({__proto__:null,FILE:aP,HTML:lP,TEXT:uP,URL:oP});function s_(r,t,n){const s=t.reduce((i,a)=>i||r.getData(a),"");return s??n}const _E={[aP]:{exposeProperties:{files:r=>Array.prototype.slice.call(r.files),items:r=>r.items,dataTransfer:r=>r},matchesTypes:["Files"]},[lP]:{exposeProperties:{html:(r,t)=>s_(r,t,""),dataTransfer:r=>r},matchesTypes:["Html","text/html"]},[oP]:{exposeProperties:{urls:(r,t)=>s_(r,t,"").split(`
`),dataTransfer:r=>r},matchesTypes:["Url","text/uri-list"]},[uP]:{exposeProperties:{text:(r,t)=>s_(r,t,""),dataTransfer:r=>r},matchesTypes:["Text","text/plain"]}};function tae(r,t){const n=_E[r];if(!n)throw new Error(`native type ${r} has no configuration`);const s=new eae(n);return s.loadDataTransfer(t),s}function i_(r){if(!r)return null;const t=Array.prototype.slice.call(r.types||[]);return Object.keys(_E).filter(n=>{const s=_E[n];return s!=null&&s.matchesTypes?s.matchesTypes.some(i=>t.indexOf(i)>-1):!1})[0]||null}const nae=iP(()=>/firefox/i.test(navigator.userAgent)),cP=iP(()=>!!window.safari);class oO{interpolate(t){const{xs:n,ys:s,c1s:i,c2s:a,c3s:o}=this;let u=n.length-1;if(t===n[u])return s[u];let l=0,c=o.length-1,h;for(;l<=c;){h=Math.floor(.5*(l+c));const g=n[h];if(g<t)l=h+1;else if(g>t)c=h-1;else return s[h]}u=Math.max(0,c);const f=t-n[u],p=f*f;return s[u]+i[u]*f+a[u]*p+o[u]*f*p}constructor(t,n){const{length:s}=t,i=[];for(let g=0;g<s;g++)i.push(g);i.sort((g,y)=>t[g]<t[y]?-1:1);const a=[],o=[];let u,l;for(let g=0;g<s-1;g++)u=t[g+1]-t[g],l=n[g+1]-n[g],a.push(u),o.push(l/u);const c=[o[0]];for(let g=0;g<a.length-1;g++){const y=o[g],x=o[g+1];if(y*x<=0)c.push(0);else{u=a[g];const v=a[g+1],S=u+v;c.push(3*S/((S+v)/y+(S+u)/x))}}c.push(o[o.length-1]);const h=[],f=[];let p;for(let g=0;g<c.length-1;g++){p=o[g];const y=c[g],x=1/a[g],v=y+c[g+1]-p-p;h.push((p-y-v)*x),f.push(v*x*x)}this.xs=t,this.ys=n,this.c1s=c,this.c2s=h,this.c3s=f}}const rae=1;function hP(r){const t=r.nodeType===rae?r:r.parentElement;if(!t)return null;const{top:n,left:s}=t.getBoundingClientRect();return{x:s,y:n}}function Ry(r){return{x:r.clientX,y:r.clientY}}function sae(r){var t;return r.nodeName==="IMG"&&(nae()||!(!((t=document.documentElement)===null||t===void 0)&&t.contains(r)))}function iae(r,t,n,s){let i=r?t.width:n,a=r?t.height:s;return cP()&&r&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:a}}function aae(r,t,n,s,i){const a=sae(t),u=hP(a?r:t),l={x:n.x-u.x,y:n.y-u.y},{offsetWidth:c,offsetHeight:h}=r,{anchorX:f,anchorY:p}=s,{dragPreviewWidth:g,dragPreviewHeight:y}=iae(a,t,c,h),x=()=>{let I=new oO([0,.5,1],[l.y,l.y/h*y,l.y+y-h]).interpolate(p);return cP()&&a&&(I+=(window.devicePixelRatio-1)*y),I},v=()=>new oO([0,.5,1],[l.x,l.x/c*g,l.x+g-c]).interpolate(f),{offsetX:S,offsetY:w}=i,E=S===0||S,_=w===0||w;return{x:E?S:v(),y:_?w:x()}}let oae=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var t;return!((t=this.globalContext)===null||t===void 0)&&t.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var t;return((t=this.optionsArgs)===null||t===void 0?void 0:t.rootElement)||this.window}constructor(t,n){this.ownerDocument=null,this.globalContext=t,this.optionsArgs=n}};function uae(r,t,n){return t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}function uO(r){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{},s=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),s.forEach(function(i){uae(r,i,n[i])})}return r}class lae{profile(){var t,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((t=this.dragStartSourceIds)===null||t===void 0?void 0:t.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const t=this.rootElement;if(t!==void 0){if(t.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");t.__isReactDndBackendSetUp=!0,this.addEventListeners(t)}}teardown(){const t=this.rootElement;if(t!==void 0&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(t,n,s){return this.sourcePreviewNodeOptions.set(t,s),this.sourcePreviewNodes.set(t,n),()=>{this.sourcePreviewNodes.delete(t),this.sourcePreviewNodeOptions.delete(t)}}connectDragSource(t,n,s){this.sourceNodes.set(t,n),this.sourceNodeOptions.set(t,s);const i=o=>this.handleDragStart(o,t),a=o=>this.handleSelectStart(o);return n.setAttribute("draggable","true"),n.addEventListener("dragstart",i),n.addEventListener("selectstart",a),()=>{this.sourceNodes.delete(t),this.sourceNodeOptions.delete(t),n.removeEventListener("dragstart",i),n.removeEventListener("selectstart",a),n.setAttribute("draggable","false")}}connectDropTarget(t,n){const s=o=>this.handleDragEnter(o,t),i=o=>this.handleDragOver(o,t),a=o=>this.handleDrop(o,t);return n.addEventListener("dragenter",s),n.addEventListener("dragover",i),n.addEventListener("drop",a),()=>{n.removeEventListener("dragenter",s),n.removeEventListener("dragover",i),n.removeEventListener("drop",a)}}addEventListeners(t){t.addEventListener&&(t.addEventListener("dragstart",this.handleTopDragStart),t.addEventListener("dragstart",this.handleTopDragStartCapture,!0),t.addEventListener("dragend",this.handleTopDragEndCapture,!0),t.addEventListener("dragenter",this.handleTopDragEnter),t.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.addEventListener("dragover",this.handleTopDragOver),t.addEventListener("dragover",this.handleTopDragOverCapture,!0),t.addEventListener("drop",this.handleTopDrop),t.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(t){t.removeEventListener&&(t.removeEventListener("dragstart",this.handleTopDragStart),t.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),t.removeEventListener("dragend",this.handleTopDragEndCapture,!0),t.removeEventListener("dragenter",this.handleTopDragEnter),t.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),t.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),t.removeEventListener("dragover",this.handleTopDragOver),t.removeEventListener("dragover",this.handleTopDragOverCapture,!0),t.removeEventListener("drop",this.handleTopDrop),t.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const t=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(t);return uO({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const t=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(t);return uO({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}isDraggingNativeItem(){const t=this.monitor.getItemType();return Object.keys(aO).some(n=>aO[n]===t)}beginDragNativeItem(t,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=tae(t,n),this.currentNativeHandle=this.registry.addSource(t,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(t){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=t;const n=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var s;return(s=this.rootElement)===null||s===void 0?void 0:s.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},n)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var t;(t=this.window)===null||t===void 0||t.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(t,n){t.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}handleDragEnter(t,n){this.dragEnterTargetIds.unshift(n)}handleDragOver(t,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}handleDrop(t,n){this.dropTargetIds.unshift(n)}constructor(t,n,s){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=i=>{const a=this.sourceNodes.get(i);return a&&hP(a)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=i=>!!(i&&this.document&&this.document.body&&this.document.body.contains(i)),this.endDragIfSourceWasRemovedFromDOM=()=>{const i=this.currentDragSourceNode;i==null||this.isNodeInDocument(i)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=i=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(i||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=i=>{if(i.defaultPrevented)return;const{dragStartSourceIds:a}=this;this.dragStartSourceIds=null;const o=Ry(i);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(a||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:u}=i,l=i_(u);if(this.monitor.isDragging()){if(u&&typeof u.setDragImage=="function"){const h=this.monitor.getSourceId(),f=this.sourceNodes.get(h),p=this.sourcePreviewNodes.get(h)||f;if(p){const{anchorX:g,anchorY:y,offsetX:x,offsetY:v}=this.getCurrentSourcePreviewNodeOptions(),E=aae(f,p,o,{anchorX:g,anchorY:y},{offsetX:x,offsetY:v});u.setDragImage(p,E.x,E.y)}}try{u==null||u.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(i.target);const{captureDraggingState:c}=this.getCurrentSourcePreviewNodeOptions();c?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(l)this.beginDragNativeItem(l);else{if(u&&!u.types&&(i.target&&!i.target.hasAttribute||!i.target.hasAttribute("draggable")))return;i.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=i=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var a;(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}if(!this.enterLeaveCounter.enter(i.target)||this.monitor.isDragging())return;const{dataTransfer:u}=i,l=i_(u);l&&this.beginDragNativeItem(l,u)},this.handleTopDragEnter=i=>{const{dragEnterTargetIds:a}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=i.altKey,a.length>0&&this.actions.hover(a,{clientOffset:Ry(i)}),a.some(u=>this.monitor.canDropOnTarget(u))&&(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=i=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var a;(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}},this.handleTopDragOver=i=>{const{dragOverTargetIds:a}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none");return}this.altKeyPressed=i.altKey,this.lastClientOffset=Ry(i),this.scheduleHover(a),(a||[]).some(u=>this.monitor.canDropOnTarget(u))?(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?i.preventDefault():(i.preventDefault(),i.dataTransfer&&(i.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=i=>{this.isDraggingNativeItem()&&i.preventDefault(),this.enterLeaveCounter.leave(i.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=i=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var a;i.preventDefault(),(a=this.currentNativeSource)===null||a===void 0||a.loadDataTransfer(i.dataTransfer)}else i_(i.dataTransfer)&&i.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=i=>{const{dropTargetIds:a}=this;this.dropTargetIds=[],this.actions.hover(a,{clientOffset:Ry(i)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=i=>{const a=i.target;typeof a.dragDrop=="function"&&(a.tagName==="INPUT"||a.tagName==="SELECT"||a.tagName==="TEXTAREA"||a.isContentEditable||(i.preventDefault(),a.dragDrop()))},this.options=new oae(n,s),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new Jie(this.isNodeInDocument)}}let Oy;function cae(){return Oy||(Oy=new Image,Oy.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Oy}const hae=function(t,n,s){return new lae(t,n,s)};function lO({isPremovedPiece:r=!1,piece:t,square:n,squares:s}){const{animationDuration:i,arePiecesDraggable:a,boardWidth:o,boardOrientation:u,chessPieces:l,currentPosition:c,deletePieceFromSquare:h,dropOffBoardAction:f,id:p,isDraggablePiece:g,isWaitingForAnimation:y,onPieceClick:x,onPieceDragBegin:v,onPieceDragEnd:S,onPieceDropOffBoard:w,onPromotionCheck:E,positionDifferences:_}=Au(),[D,I]=ht.useState({opacity:1,zIndex:5,touchAction:"none",cursor:a&&g({piece:t,sourceSquare:n})?"-webkit-grab":"default"}),[{canDrag:k,isDragging:A},N,F]=zie(()=>({type:"piece",item:()=>(v(t,n),{piece:t,square:n,id:p}),end:(O,M)=>{S(t,n),!M.didDrop()&&(f==="trash"&&h(n),w==null||w(n,t))},collect:O=>({canDrag:g({piece:t,sourceSquare:n}),isDragging:!!O.isDragging()})}),[t,n,c,p]);F(cae(),{captureDraggingState:!0}),ht.useEffect(()=>{I(O=>Object.assign(Object.assign({},O),{opacity:A?0:1}))},[A]),ht.useEffect(()=>{var O;const M=(O=_.removed)===null||O===void 0?void 0:O[n];if(!_.added||!M)return;const B=Object.entries(_.added).find(([U,V])=>V===M||E(n,U,M));if(y&&M&&B&&!r){const U=n,V=B[0];if(U&&V){const Z=o/8;I(J=>Object.assign(Object.assign({},J),{transform:`translate(${(u==="black"?-1:1)*(V.charCodeAt(0)-U.charCodeAt(0))*Z}px, ${(u==="black"?-1:1)*(Number(U[1])-Number(V[1]))*Z}px)`,transition:`transform ${i}ms`,zIndex:6}))}}},[_]),ht.useEffect(()=>{const{sourceSq:O}=$();O&&I(M=>Object.assign(Object.assign({},M),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[c]),ht.useEffect(()=>{I(O=>Object.assign(Object.assign({},O),{cursor:a&&g({piece:t,sourceSquare:n})?"-webkit-grab":"default"}))},[n,c,a]);function $(){return{sourceSq:s[n]}}return Se.jsx("div",Object.assign({ref:a&&k?N:null,onClick:()=>x(t,n),"data-piece":t,style:D},{children:typeof l[t]=="function"?l[t]({squareWidth:o/8,isDragging:A,square:n}):Se.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:o/8,height:o/8,style:{display:"block"}},{children:Se.jsx("g",{children:l[t]})}))}))}function fae({square:r,squareColor:t,setSquares:n,squareHasPremove:s,children:i}){const a=ht.useRef(null),{autoPromoteToQueen:o,boardWidth:u,boardOrientation:l,clearArrows:c,currentPosition:h,currentRightClickDown:f,customBoardStyle:p,customDarkSquareStyle:g,customDropSquareStyle:y,customLightSquareStyle:x,customPremoveDarkSquareStyle:v,customPremoveLightSquareStyle:S,customSquare:w,customSquareStyles:E,drawNewArrow:_,handleSetPosition:D,handleSparePieceDrop:I,isWaitingForAnimation:k,lastPieceColour:A,lastSquareDraggedOver:N,onArrowDrawEnd:F,onDragOverSquare:$,onMouseOutSquare:O,onMouseOverSquare:M,onPieceDrop:B,onPromotionCheck:U,onRightClickDown:V,onRightClickUp:Z,onSquareClick:J,setLastSquareDraggedOver:ne,setPromoteFromSquare:z,setPromoteToSquare:X,setShowPromoteDialog:Y}=Au(),[{isOver:se},ue]=Yie(()=>({accept:"piece",drop:fe,collect:be=>({isOver:!!be.isOver()})}),[r,h,B,k,A]);function fe(be){if(be.isSpare){I(be.piece,r);return}U(be.square,r,be.piece)?o?D(be.square,r,be.piece[0]==="w"?"wQ":"bQ"):(z(be.square),X(r),Y(!0)):D(be.square,r,be.piece,!0)}ht.useEffect(()=>{if(a.current){const{x:be,y:Me}=a.current.getBoundingClientRect();n(_e=>Object.assign(Object.assign({},_e),{[r]:{x:be,y:Me}}))}},[u,l]);const de=Object.assign(Object.assign(Object.assign(Object.assign({},dae(r,l,p)),t==="black"?g:x),s&&(t==="black"?v:S)),se&&y);return Se.jsx("div",Object.assign({ref:ue,style:de,"data-square-color":t,"data-square":r,onTouchMove:be=>{var Me;const _e=be.touches[0],Ne=document.elementsFromPoint(_e.clientX,_e.clientY),ve=(Me=Ne==null?void 0:Ne.find(Pe=>Pe.getAttribute("data-square")))===null||Me===void 0?void 0:Me.getAttribute("data-square");ve&&ve!==N&&(ne(ve),$(ve))},onMouseOver:be=>{be.buttons===2&&f&&_(f,r),!(be.relatedTarget&&be.currentTarget.contains(be.relatedTarget))&&M(r)},onMouseOut:be=>{be.relatedTarget&&be.currentTarget.contains(be.relatedTarget)||O(r)},onMouseDown:be=>{be.button===2&&V(r)},onMouseUp:be=>{be.button===2&&(f&&F(f,r),Z(r))},onDragEnter:()=>$(r),onClick:()=>{const be=h[r];J(r,be),c()},onContextMenu:be=>{be.preventDefault()}},{children:typeof w=="string"?Se.jsx(w,Object.assign({ref:a,style:Object.assign(Object.assign(Object.assign({},hO(u)),cO),!s&&(E==null?void 0:E[r]))},{children:i})):Se.jsx(w,Object.assign({ref:a,square:r,squareColor:t,style:Object.assign(Object.assign(Object.assign({},hO(u)),cO),!s&&(E==null?void 0:E[r]))},{children:i}))}))}const cO={display:"flex",justifyContent:"center"},hO=r=>({width:r/8,height:r/8}),dae=(r,t,n)=>n!=null&&n.borderRadius?r==="a1"?t==="white"?{borderBottomLeftRadius:n.borderRadius}:{borderTopRightRadius:n.borderRadius}:r==="a8"?t==="white"?{borderTopLeftRadius:n.borderRadius}:{borderBottomRightRadius:n.borderRadius}:r==="h1"?t==="white"?{borderBottomRightRadius:n.borderRadius}:{borderTopLeftRadius:n.borderRadius}:r==="h8"?t==="white"?{borderTopRightRadius:n.borderRadius}:{borderBottomLeftRadius:n.borderRadius}:{}:{};function pae(){const[r,t]=ht.useState({}),{arePremovesAllowed:n,boardOrientation:s,boardWidth:i,currentPosition:a,id:o,premoves:u,showBoardNotation:l}=Au(),c=ht.useMemo(()=>{const h=[];return n?(u.forEach((f,p)=>{const{sourceSq:g,targetSq:y,piece:x}=f,v=h.find(S=>{var w;return S.piece===x&&((w=S.premovesRoute.at(-1))===null||w===void 0?void 0:w.targetSq)===g});v?v.premovesRoute.push({sourceSq:g,targetSq:y,index:p}):h.push({piece:x,premovesRoute:[{sourceSq:g,targetSq:y,index:p}]})}),h):[]},[u]);return Se.jsx("div",Object.assign({"data-boardid":o},{children:[...Array(8)].map((h,f)=>Se.jsx("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:i}},{children:[...Array(8)].map((p,g)=>{const y=s==="black"?cg[7-g]+(f+1):cg[g]+(8-f),x=g%2===f%2?"white":"black",v=u.find(w=>w.sourceSq===y||w.targetSq===y),S=c.filter(({premovesRoute:w})=>{var E;return((E=w.at(-1))===null||E===void 0?void 0:E.targetSq)===y}).sort((w,E)=>{var _,D;return((_=E.premovesRoute.at(-1))===null||_===void 0?void 0:_.index)-((D=w.premovesRoute.at(-1))===null||D===void 0?void 0:D.index)}).at(0);return Se.jsxs(fae,Object.assign({square:y,squareColor:x,setSquares:t,squareHasPremove:!!v},{children:[!v&&a[y]&&Se.jsx(lO,{piece:a[y],square:y,squares:r}),S&&Se.jsx(lO,{isPremovedPiece:!0,piece:S.piece,square:y,squares:r}),l&&Se.jsx(nse,{row:f,col:g})]}),`${g}${f}`)})}),f.toString()))}))}const mae=()=>{const{arrows:r,newArrow:t,boardOrientation:n,boardWidth:s,customArrowColor:i}=Au(),a=[...r,t].filter(Boolean);return Se.jsx("svg",Object.assign({width:s,height:s,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:a.map((o,u)=>{const[l,c,h]=o;if(l===c)return null;const f=bE(n,s,l),p=bE(n,s,c);let g=s/32;const y=u===r.length;r.some(E=>E[0]!==l&&E[1]===c)&&!y&&(g=s/16);const x=p.x-f.x,v=p.y-f.y,S=Math.hypot(v,x),w={x:f.x+x*(S-g)/S,y:f.y+v*(S-g)/S};return Se.jsxs(ht.Fragment,{children:[Se.jsx("marker",Object.assign({id:`arrowhead-${u}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:Se.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:h??i})})),Se.jsx("line",{x1:f.x,y1:f.y,x2:w.x,y2:w.y,opacity:y?"0.5":"0.65",stroke:h??i,strokeWidth:y?.9*s/40:s/40,markerEnd:`url(#arrowhead-${u})`})]},`${l}-${c}${y?"-active":""}`)})}))};function gae({option:r}){const[t,n]=ht.useState(!1),{boardWidth:s,chessPieces:i,customDarkSquareStyle:a,customLightSquareStyle:o,handleSetPosition:u,onPromotionPieceSelect:l,promoteFromSquare:c,promoteToSquare:h,promotionDialogVariant:f}=Au(),p=()=>{switch(r[1]){case"Q":return a.backgroundColor;case"R":return o.backgroundColor;case"N":return f==="default"?o.backgroundColor:a.backgroundColor;case"B":return f==="default"?a.backgroundColor:o.backgroundColor}};return Se.jsx("div",Object.assign({onClick:()=>{l(r,c??void 0,h??void 0)&&u(c,h,r,!0)},onMouseOver:()=>n(!0),onMouseOut:()=>n(!1),"data-piece":r,style:{cursor:"pointer",backgroundColor:t?p():`${p()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:typeof i[r]=="function"?Se.jsx("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:t?"scale(1)":"scale(0.85)"}},{children:i[r]({squareWidth:s/8,isDragging:!1})})):Se.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:s/8,height:s/8,style:{transition:"all 0.1s ease-out",transform:t?"scale(1)":"scale(0.85)"}},{children:Se.jsx("g",{children:i[r]})}))}))}function yae(){const{boardOrientation:r,boardWidth:t,promotionDialogVariant:n,promoteToSquare:s}=Au(),i=(s==null?void 0:s[1])==="1"?"b":"w",a=[`${i??"w"}Q`,`${i??"w"}R`,`${i??"w"}N`,`${i??"w"}B`],o={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-t/8}px, ${-t/8}px)`},vertical:{transform:`translate(${-t/16}px, ${-t/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*t/8}px)`,width:"100%",height:`${t/4}px`,top:0,backgroundColor:"white",left:0}},u=bE(r,t,s||"a8");return Se.jsx("div",Object.assign({style:Object.assign({position:"absolute",top:`${u==null?void 0:u.y}px`,left:`${u==null?void 0:u.x}px`,zIndex:1e3},o[n]),title:"Choose promotion piece"},{children:a.map(l=>Se.jsx(gae,{option:l},l))}))}const xae={whiteKing:Se.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:Se.jsx("g",{children:Se.jsx("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function bae({children:r}){try{return Se.jsx(Se.Fragment,{children:r})}catch(t){return console.log(t),Se.jsx(fP,{showError:!0})}}function fP({showError:r=!1}){return Se.jsxs("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[Se.jsx("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:xae.whiteKing})),r&&Se.jsx("h1",{children:"Something went wrong"})]}))}function vae(){const r=ht.useRef(null),{boardWidth:t,clearCurrentRightClickDown:n,onPromotionPieceSelect:s,setShowPromoteDialog:i,showPromoteDialog:a,customBoardStyle:o}=Au();return ht.useEffect(()=>{function u(l){r.current&&!r.current.contains(l.target)&&n()}return document.addEventListener("mouseup",u),()=>{document.removeEventListener("mouseup",u)}},[]),t?Se.jsx("div",Object.assign({style:{perspective:"1000px"}},{children:Se.jsxs("div",Object.assign({ref:r,style:Object.assign(Object.assign({position:"relative"},wae(t)),o)},{children:[Se.jsx(pae,{}),Se.jsx(mae,{}),a&&Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{onClick:()=>{i(!1),s==null||s()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:t,height:t}}),Se.jsx(yae,{})]})]}))})):Se.jsx(fP,{})}const wae=r=>({cursor:"default",height:r,width:r});var Cl;(function(r){r.mouse="mouse",r.touch="touch",r.keyboard="keyboard"})(Cl||(Cl={}));class Sae{get delay(){var t;return(t=this.args.delay)!==null&&t!==void 0?t:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var t;return(t=this.args.ignoreContextMenu)!==null&&t!==void 0?t:!1}get enableHoverOutsideTarget(){var t;return(t=this.args.enableHoverOutsideTarget)!==null&&t!==void 0?t:!1}get enableKeyboardEvents(){var t;return(t=this.args.enableKeyboardEvents)!==null&&t!==void 0?t:!1}get enableMouseEvents(){var t;return(t=this.args.enableMouseEvents)!==null&&t!==void 0?t:!1}get enableTouchEvents(){var t;return(t=this.args.enableTouchEvents)!==null&&t!==void 0?t:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var t,n,s,i;return(i=(s=(t=this.args)===null||t===void 0?void 0:t.delayTouchStart)!==null&&s!==void 0?s:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get delayMouseStart(){var t,n,s,i;return(i=(s=(t=this.args)===null||t===void 0?void 0:t.delayMouseStart)!==null&&s!==void 0?s:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&i!==void 0?i:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var t;if(!((t=this.context)===null||t===void 0)&&t.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var t;return((t=this.args)===null||t===void 0?void 0:t.rootElement)||this.document}constructor(t,n){this.args=t,this.context=n}}function Cae(r,t,n,s){return Math.sqrt(Math.pow(Math.abs(n-r),2)+Math.pow(Math.abs(s-t),2))}function _ae(r,t,n,s,i){if(!i)return!1;const a=Math.atan2(s-t,n-r)*180/Math.PI+180;for(let o=0;o<i.length;++o){const u=i[o];if(u&&(u.start==null||a>=u.start)&&(u.end==null||a<=u.end))return!0}return!1}const Eae={Left:1},Dae={Left:0};function a_(r){return r.button===void 0||r.button===Dae.Left}function Tae(r){return r.buttons===void 0||(r.buttons&Eae.Left)===0}function dP(r){return!!r.targetTouches}const Nae=1;function kae(r){const t=r.nodeType===Nae?r:r.parentElement;if(!t)return;const{top:n,left:s}=t.getBoundingClientRect();return{x:s,y:n}}function Aae(r,t){if(r.targetTouches.length===1)return Xx(r.targetTouches[0]);if(t&&r.touches.length===1&&r.touches[0].target===t.target)return Xx(r.touches[0])}function Xx(r,t){return dP(r)?Aae(r,t):{x:r.clientX,y:r.clientY}}const fO=(()=>{let r=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return r=!0,!0}}))}catch{}return r})(),lm={[Cl.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Cl.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Cl.keyboard]:{keydown:"keydown"}};class Mm{profile(){var t;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((t=this.dragOverTargetIds)===null||t===void 0?void 0:t.length)||0}}get document(){return this.options.document}setup(){const t=this.options.rootElement;t&&(an(!Mm.isSetUp,"Cannot have two Touch backends at the same time."),Mm.isSetUp=!0,this.addEventListener(t,"start",this.getTopMoveStartHandler()),this.addEventListener(t,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(t,"move",this.handleTopMove),this.addEventListener(t,"move",this.handleTopMoveCapture,!0),this.addEventListener(t,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(t,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(t,"keydown",this.handleCancelOnEscape,!0))}teardown(){const t=this.options.rootElement;t&&(Mm.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(t,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(t,"start",this.handleTopMoveStart),this.removeEventListener(t,"move",this.handleTopMoveCapture,!0),this.removeEventListener(t,"move",this.handleTopMove),this.removeEventListener(t,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(t,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(t,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(t,n,s,i=!1){const a=fO?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const u=lm[o][n];u&&t.addEventListener(u,s,a)})}removeEventListener(t,n,s,i=!1){const a=fO?{capture:i,passive:!1}:i;this.listenerTypes.forEach(function(o){const u=lm[o][n];u&&t.removeEventListener(u,s,a)})}connectDragSource(t,n){const s=this.handleMoveStart.bind(this,t);return this.sourceNodes.set(t,n),this.addEventListener(n,"start",s),()=>{this.sourceNodes.delete(t),this.removeEventListener(n,"start",s)}}connectDragPreview(t,n,s){return this.sourcePreviewNodeOptions.set(t,s),this.sourcePreviewNodes.set(t,n),()=>{this.sourcePreviewNodes.delete(t),this.sourcePreviewNodeOptions.delete(t)}}connectDropTarget(t,n){const s=this.options.rootElement;if(!this.document||!s)return()=>{};const i=a=>{if(!this.document||!s||!this.monitor.isDragging())return;let o;switch(a.type){case lm.mouse.move:o={x:a.clientX,y:a.clientY};break;case lm.touch.move:var u,l;o={x:((u=a.touches[0])===null||u===void 0?void 0:u.clientX)||0,y:((l=a.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const c=o!=null?this.document.elementFromPoint(o.x,o.y):void 0,h=c&&n.contains(c);if(c===n||h)return this.handleMove(a,t)};return this.addEventListener(this.document.body,"move",i),this.targetNodes.set(t,n),()=>{this.document&&(this.targetNodes.delete(t),this.removeEventListener(this.document.body,"move",i))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(t){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=t,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{t&&!t.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!t||!t.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(t.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(t,n,s){this.getSourceClientOffset=i=>{const a=this.sourceNodes.get(i);return a&&kae(a)},this.handleTopMoveStartCapture=i=>{a_(i)&&(this.moveStartSourceIds=[])},this.handleMoveStart=i=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(i)},this.handleTopMoveStart=i=>{if(!a_(i))return;const a=Xx(i);a&&(dP(i)&&(this.lastTargetTouchFallback=i.targetTouches[0]),this._mouseClientOffset=a),this.waitingForDelay=!1},this.handleTopMoveStartDelay=i=>{if(!a_(i))return;const a=i.type===lm.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,i),a),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(i,a)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(a)},this.handleTopMove=i=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:a,dragOverTargetIds:o}=this,u=this.options.enableHoverOutsideTarget,l=Xx(i,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&_ae(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&a&&Cae(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(a,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const c=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(c),this.actions.publishDragSource(),i.cancelable&&i.preventDefault();const h=(o||[]).map(y=>this.targetNodes.get(y)).filter(y=>!!y),f=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,h):this.document.elementsFromPoint(l.x,l.y),p=[];for(const y in f){if(!f.hasOwnProperty(y))continue;let x=f[y];for(x!=null&&p.push(x);x;)x=x.parentElement,x&&p.indexOf(x)===-1&&p.push(x)}const g=p.filter(y=>h.indexOf(y)>-1).map(y=>this._getDropTargetId(y)).filter(y=>!!y).filter((y,x,v)=>v.indexOf(y)===x);if(u)for(const y in this.targetNodes){const x=this.targetNodes.get(y);if(c&&x&&x.contains(c)&&g.indexOf(y)===-1){g.unshift(y);break}}g.reverse(),this.actions.hover(g,{clientOffset:l})},this._getDropTargetId=i=>{const a=this.targetNodes.keys();let o=a.next();for(;o.done===!1;){const u=o.value;if(i===this.targetNodes.get(u))return u;o=a.next()}},this.handleTopMoveEndCapture=i=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!Tae(i)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}i.cancelable&&i.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=i=>{i.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new Sae(s,n),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Cl.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Cl.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Cl.keyboard)}}const Iae=function(t,n={},s={}){return new Mm(t,n,s)},$ae=ht.createContext({isCustomDndProviderSet:!1}),Fae=({children:r})=>Se.jsx(Se.Fragment,{children:r}),Rae=({customDndBackend:r,customDndBackendOptions:t,children:n})=>{const[s,i]=ht.useState(),[a,o]=ht.useState(!1),[u,l]=ht.useState(!1),{isCustomDndProviderSet:c}=ht.useContext($ae);ht.useEffect(()=>{l("ontouchstart"in window),o(!0),i(window)},[]);const h=c?Fae:bie;return a?s?Se.jsx(h,Object.assign({backend:r||(u?Iae:hae),context:s,options:r?t:void 0},{children:n})):Se.jsx(Se.Fragment,{children:n}):null};function Oae({boardContainer:r}){const{boardWidth:t,chessPieces:n,id:s,snapToCursor:i,allowDragOutsideBoard:a}=Au(),o=Uie(p=>({item:p.getItem(),clientOffset:p.getClientOffset(),sourceClientOffset:p.getSourceClientOffset(),isDragging:p.isDragging()})),{isDragging:u,item:l,clientOffset:c,sourceClientOffset:h}=o,f=ht.useCallback((p,g)=>{if(!p||!g)return{display:"none"};let{x:y,y:x}=i?p:g;const v=t/8/2;if(i&&(y-=v,x-=v),!a){const{left:w,top:E}=r,_=w-v,D=E-v,I=w+t-v,k=E+t-v;y=Math.max(_,Math.min(y,I)),x=Math.max(D,Math.min(x,k))}const S=`translate(${y}px, ${x}px)`;return{transform:S,WebkitTransform:S,touchAction:"none"}},[t,a,i,r]);return u&&l.id===s?Se.jsx("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:Se.jsx("div",Object.assign({style:f(c,h)},{children:typeof n[l.piece]=="function"?n[l.piece]({squareWidth:t/8,isDragging:!0}):Se.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:t/8,height:t/8},{children:Se.jsx("g",{children:n[l.piece]})}))}))})):null}const Mae=ht.forwardRef((r,t)=>{const{customDndBackend:n,customDndBackendOptions:s,onBoardWidthChange:i}=r,a=jre(r,["customDndBackend","customDndBackendOptions","onBoardWidthChange"]),[o,u]=ht.useState(r.boardWidth),l=ht.useRef(null),c=ht.useRef(null),[h,f]=ht.useState({left:0,top:0}),p=ht.useMemo(()=>{var g;return(g=l.current)===null||g===void 0?void 0:g.getBoundingClientRect()},[l.current]);return ht.useEffect(()=>{o&&(i==null||i(o))},[o]),ht.useEffect(()=>{f({left:p!=null&&p.left?p==null?void 0:p.left:0,top:p!=null&&p.top?p==null?void 0:p.top:0})},[p]),ht.useEffect(()=>{var g;if(r.boardWidth===void 0&&(!((g=l.current)===null||g===void 0)&&g.offsetWidth)){const y=new ResizeObserver(()=>{var x;u((x=l.current)===null||x===void 0?void 0:x.offsetWidth)});return y.observe(l.current),()=>{y.disconnect()}}},[l.current]),Se.jsx(bae,{children:Se.jsxs("div",Object.assign({ref:c,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[Se.jsx("div",{ref:l,style:{width:"100%"}}),Se.jsx(Rae,Object.assign({customDndBackend:n,customDndBackendOptions:s},{children:o&&Se.jsxs(tse,Object.assign({boardWidth:o},a,{ref:t},{children:[Se.jsx(Oae,{boardContainer:h}),Se.jsx(vae,{})]}))}))]}))})});function Lae(){const[r]=ht.useState(new Gre("rnb1kbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")),[t,n]=ht.useState("rnb1kbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),[s,i]=ht.useState(!1),[a,o]=ht.useState(null),[u,l]=ht.useState("");ht.useEffect(()=>{if(!s){l("");return}const h=["",".","..","..."];let f=0;const p=setInterval(()=>{f=(f+1)%h.length,l(h[f])},500);return()=>clearInterval(p)},[s]);const c=async(h,f)=>{if(console.log(`White move from ${h} to ${f}`),r.move({from:h,to:f,promotion:"q"})){const g=r.fen();console.log(`Resulting FEN after white's move: ${g}`),n(g);try{i(!0),o(null);let y="https://personal-website-backend-huty.onrender.com";console.log(`Sending request to backend URL: ${y}/drawbot-move`);const v=await(await fetch(y+"/drawbot-move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:g})})).json();console.log("Backend response:",v),v&&v.move&&v.move.from&&v.move.to?(r.move({from:v.move.from,to:v.move.to,promotion:"q"}),n(r.fen()),console.log(`Applied drawbot move from ${v.move.from} to ${v.move.to}`)):(console.log("Drawbot move data invalid or missing"),o("No move returned."))}catch(y){console.error("Error fetching drawbot move:",y),o("Failed to reach drawbot.")}finally{i(!1)}return!0}return!1};return Se.jsx("div",{style:{display:"flex",justifyContent:"center"},children:Se.jsxs("div",{children:[s&&Se.jsxs("p",{children:["Thinking",u]}),a&&Se.jsx("p",{style:{color:"red"},children:a}),Se.jsx(Mae,{position:t,onPieceDrop:c,boardWidth:400})]})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae=1e-7,Pae=1e-4;class pP{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}let GT=class{refCount(t){return ji("refCount")}incRef(t){return ji("incRef")}timerAvailable(){return!0}time(t){return ji("time")}read(t){return ji("read")}readSync(t){return ji("readSync")}readToGPU(t,n){return ji("readToGPU")}numDataIds(){return ji("numDataIds")}disposeData(t,n){return ji("disposeData")}write(t,n,s){return ji("write")}move(t,n,s,i,a){return ji("move")}memory(){return ji("memory")}floatPrecision(){return ji("floatPrecision")}epsilon(){return this.floatPrecision()===32?Bae:Pae}dispose(){return ji("dispose")}};function ji(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(r){let t=r.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,If(r,t,n)}function nh(r,t,n){return Math.max(r,Math.min(t,n))}function jT(r){return r%2===0?r:r+1}function If(r,t,n){const s=r[t];r[t]=r[n],r[n]=s}function zae(r){let t=0;for(let n=0;n<r.length;n++)t+=r[n];return t}function oe(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function WT(r,t,n=""){oe(Bn(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function mP(r){oe(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function gd(r,t=[],n=!1){if(t==null&&(t=[]),Array.isArray(r)||Ao(r)&&!n)for(let s=0;s<r.length;++s)gd(r[s],t,n);else t.push(r);return t}function Je(r){if(r.length===0)return 1;let t=r[0];for(let n=1;n<r.length;n++)t*=r[n];return t}function Bn(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==t[n])return!1;return!0}function yd(r){return r%1===0}function EE(r){const t=Math.ceil(Math.sqrt(r));return[t,Math.ceil(r/t)]}function Zf(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function dO(r,t=i=>0,n,s=setTimeout){return new Promise((i,a)=>{let o=0;const u=()=>{if(r()){i();return}o++;const l=t(o);if(n!=null&&o>=n){a();return}s(u,l)};u()})}function gP(r,t){let n=1,s=-1;for(let a=0;a<r.length;++a)if(r[a]>=0)n*=r[a];else if(r[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(r[a]<0)throw Error(`Shapes can not be < 0. Found ${r[a]} at dim ${a}`);if(s===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${r}`);return r}if(n===0)throw Error(`Cannot infer the missing size in [${r}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=r.slice();return i[s]=t/n,i}function dn(r,t){const n=t.length;return r=r==null?t.map((s,i)=>i):[].concat(r),oe(r.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${r}`),oe(r.every(s=>yd(s)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(s=>s<0?n+s:s)}function zl(r,t){const n=[],s=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:dn(t,r).sort();let o=0;for(let u=0;u<r.length;++u){if(a!=null){if(a[o]===u&&r[u]!==1)throw new Error(`Can't squeeze axis ${u} since its dim '${r[u]}' is not 1`);(a[o]==null||a[o]>u)&&r[u]===1&&(n.push(r[u]),s.push(u)),a[o]<=u&&o++}r[u]!==1&&(n.push(r[u]),s.push(u))}return{newShape:n,keptDims:s}}function As(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else throw new Error(`Unknown data type ${r}`);return n}function ds(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else if(r==="string")n=new Array(t);else throw new Error(`Unknown data type ${r}`);return n}function Uae(r,t){for(let n=0;n<r.length;n++){const s=r[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function Gae(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function yP(r,t){return!(t==="complex64"||t==="float32"&&r!=="complex64"||t==="int32"&&r!=="float32"&&r!=="complex64"||t==="bool"&&r==="bool")}function Ao(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray}function DE(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function jae(r){if(r==null)return 0;let t=0;return r.forEach(n=>t+=n.length),t}function Ig(r){return typeof r=="string"||r instanceof String}function Wae(r){return typeof r=="boolean"}function TE(r){return typeof r=="number"}function $g(r){return Array.isArray(r)?$g(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array||r instanceof Uint8ClampedArray?"int32":TE(r)?"float32":Ig(r)?"string":Wae(r)?"bool":"float32"}function NE(r){return!!(r&&r.constructor&&r.call&&r.apply)}function kE(r,t){for(let n=t;n<r;++n)if(r%n===0)return n;return r}function Mt(r){const t=r.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=r[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*r[s+1];return n}function xP(r,t,n,s=!1){const i=new Array;if(t.length===1){const a=t[0]*(s?2:1);for(let o=0;o<a;o++)i[o]=n[r+o]}else{const a=t[0],o=t.slice(1),u=o.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<a;l++)i[l]=xP(r+l*u,o,n,s)}return i}function to(r,t,n=!1){if(r.length===0)return t[0];const s=r.reduce((i,a)=>i*a)*(n?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${r}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return xP(0,r,t,n)}function HT(r,t){const n=Us(r,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function Us(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${t}`)}function bP(r,t){const n=r.reduce((s,i)=>s*i,1);if(t==null||t==="float32")return to(r,new Float32Array(n));if(t==="int32")return to(r,new Int32Array(n));if(t==="bool")return to(r,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function vP(r){r.forEach(t=>{oe(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function Eo(r,t,n){if(t===0)return 0;if(t===1)return r[0];let s=r[r.length-1];for(let i=0;i<r.length-1;++i)s+=n[i]*r[i];return s}function zd(r,t,n){if(t===0)return[];if(t===1)return[r];const s=new Array(t);for(let i=0;i<s.length-1;++i)s[i]=Math.floor(r/n[i]),r-=s[i]*n[i];return s[s.length-1]=r,s}function wP(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pO="tfjsflags";let Hae=class{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=qae,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(Ke().getBool("IS_TEST")||Ke().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const i=this.urlFlags[t];Ke().getBool("IS_TEST")||Ke().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(wP(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);pO in t&&t[pO].split(",").forEach(s=>{const[i,a]=s.split(":");this.urlFlags[i]=Xae(i,a)})}};function qae(r){const t={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(Kae(t,s[0],s[1]),s.join("="))),t}function Kae(r,t,n){r[decodeURIComponent(t)]=decodeURIComponent(n||"")}function Xae(r,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${r}.`)}function Ke(){return SP}let SP=null;function Yae(r){SP=r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let o_;function CP(){if(o_==null){let r;if(typeof window<"u")r=window;else if(typeof global<"u")r=global;else if(typeof process<"u")r=process;else if(typeof self<"u")r=self;else throw new Error("Could not find a global object");o_=r}return o_}function Zae(){const r=CP();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function qT(r,t){const n=Zae();if(n.has(r))return n.get(r);{const s=t();return n.set(r,s),n.get(r)}}const xv="Abs",Fg="Acos",Rg="Acosh",Ud="Add",KT="AddN",XT="All",YT="Any",bv="ArgMax",vv="ArgMin",Og="Asin",Mg="Asinh",Lg="Atan",Bg="Atanh",Pg="Atan2",wv="AvgPool",ZT="AvgPoolGrad",Sv="AvgPool3D",QT="AvgPool3DGrad",Cv="BatchMatMul",_v="BatchToSpaceND",JT="Bincount",Qae="BroadcastTo",_P="BroadcastArgs",Vg="Cast",zg="Ceil",Ug="ClipByValue",e3="Complex",Ev="ComplexAbs",Dv="Concat",Tv="Conv2D",t3="Conv2DBackpropFilter",Nv="Conv2DBackpropInput",kv="Conv3D",n3="Conv3DBackpropFilterV2",r3="Conv3DBackpropInputV2",Gg="Cos",jg="Cosh",s3="Cumprod",Av="Cumsum",i3="CropAndResize",EP="DenseBincount",a3="DepthToSpace",Iv="DepthwiseConv2dNative",o3="DepthwiseConv2dNativeBackpropFilter",u3="DepthwiseConv2dNativeBackpropInput",DP="Diag",$v="Dilation2D",AE="Dilation2DBackpropInput",IE="Dilation2DBackpropFilter",Wg="RealDiv",TP="Einsum",Hg="Elu",l3="EluGrad",qg="Erf",Fv="Equal",Kg="Exp",Rv="ExpandDims",Xg="Expm1",c3="FFT",h3="Fill",f3="FlipLeftRight",Yg="Floor",Zg="FloorDiv",Ov="FusedBatchNorm",Mv="GatherV2",NP="GatherNd",Lv="Greater",Qg="GreaterEqual",Jg="Identity",d3="IFFT",p3="Imag",e0="IsFinite",t0="IsInf",n0="IsNan",Bv="LeakyRelu",Pv="Less",Vv="LessEqual",kP="LinSpace",r0="Log",s0="Log1p",zv="LogicalAnd",Uv="LogicalNot",Gv="LogicalOr",Jae="LogSoftmax",jv="LRN",m3="LRNGrad",Wv="Max",i0="Maximum",Hv="MaxPool",g3="MaxPoolGrad",qv="MaxPool3D",y3="MaxPool3DGrad",AP="MaxPoolWithArgmax",Kv="Mean",Xv="Min",a0="Minimum",Yv="MirrorPad",o0="Mod",IP="Multinomial",u0="Multiply",Zv="Neg",Qv="NotEqual",x3="NonMaxSuppressionV3",b3="NonMaxSuppressionV4",v3="NonMaxSuppressionV5",Jv="OnesLike",e2="OneHot",t2="Pack",n2="PadV2",l0="Pow",r2="Prelu",s2="Prod",$P="RaggedGather",FP="RaggedTensorToTensor",w3="Range",S3="Real",c0="Reciprocal",h0="Relu",i2="Reshape",a2="ResizeNearestNeighbor",C3="ResizeNearestNeighborGrad",o2="ResizeBilinear",_3="ResizeBilinearGrad",f0="Relu6",u2="Reverse",d0="Round",p0="Rsqrt",RP="ScatterNd",OP="SearchSorted",l2="Select",m0="Selu",c2="Slice",g0="Sin",y0="Sinh",x0="Sign",b0="Sigmoid",v0="Softplus",w0="Sqrt",h2="Sum",f2="SpaceToBatchND",d2="SplitV",p2="Softmax",MP="SparseFillEmptyRows",LP="SparseReshape",BP="SparseSegmentMean",PP="SparseSegmentSum",VP="SparseToDense",S0="SquaredDifference",E3="Square",D3="StridedSlice",zP="StringNGrams",UP="StringSplit",GP="StringToHashBucketFast",C0="Sub",_0="Tan",E0="Tanh",D0="Tile",T3="TopK",N3="Transform",Qf="Transpose",k3="Unique",m2="Unpack",g2="UnsortedSegmentSum",y2="ZerosLike",T0="Step",eoe="FromPixels",A3="RotateWithOffset",Yx="_FusedMatMul",Zx="FusedConv2D",jP="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(...r){Ke().getBool("IS_TEST")||Ke().getBool("PROD")||console.warn(...r)}function toe(...r){Ke().getBool("IS_TEST")||Ke().getBool("PROD")||console.log(...r)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qx=qT("kernelRegistry",()=>new Map),$E=qT("gradRegistry",()=>new Map);function mO(r,t){const n=HP(r,t);return Qx.get(n)}function gO(r){return $E.get(r)}function yO(r){const t=Qx.entries(),n=[];for(;;){const{done:s,value:i}=t.next();if(s)break;const[a,o]=i,[u]=a.split("_");u===r&&n.push(o)}return n}function WP(r){const{kernelName:t,backendName:n}=r,s=HP(t,n);Qx.has(s)&&Hi(`The kernel '${t}' for backend '${n}' is already registered`),Qx.set(s,r)}function noe(r){const{kernelName:t}=r;$E.has(t)&&Ke().getBool("DEBUG")&&Hi(`Overriding the gradient for '${t}'`),$E.set(t,r)}function HP(r,t){return`${t}_${r}`}var u_,xO;function roe(){if(xO)return u_;xO=1,u_=t;var r=null;try{r=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(F,$,O){this.low=F|0,this.high=$|0,this.unsigned=!!O}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(F){return(F&&F.__isLong__)===!0}t.isLong=n;var s={},i={};function a(F,$){var O,M,B;return $?(F>>>=0,(B=0<=F&&F<256)&&(M=i[F],M)?M:(O=u(F,(F|0)<0?-1:0,!0),B&&(i[F]=O),O)):(F|=0,(B=-128<=F&&F<128)&&(M=s[F],M)?M:(O=u(F,F<0?-1:0,!1),B&&(s[F]=O),O))}t.fromInt=a;function o(F,$){if(isNaN(F))return $?w:S;if($){if(F<0)return w;if(F>=y)return k}else{if(F<=-9223372036854776e3)return A;if(F+1>=x)return I}return F<0?o(-F,$).neg():u(F%g|0,F/g|0,$)}t.fromNumber=o;function u(F,$,O){return new t(F,$,O)}t.fromBits=u;var l=Math.pow;function c(F,$,O){if(F.length===0)throw Error("empty string");if(F==="NaN"||F==="Infinity"||F==="+Infinity"||F==="-Infinity")return S;if(typeof $=="number"?(O=$,$=!1):$=!!$,O=O||10,O<2||36<O)throw RangeError("radix");var M;if((M=F.indexOf("-"))>0)throw Error("interior hyphen");if(M===0)return c(F.substring(1),$,O).neg();for(var B=o(l(O,8)),U=S,V=0;V<F.length;V+=8){var Z=Math.min(8,F.length-V),J=parseInt(F.substring(V,V+Z),O);if(Z<8){var ne=o(l(O,Z));U=U.mul(ne).add(o(J))}else U=U.mul(B),U=U.add(o(J))}return U.unsigned=$,U}t.fromString=c;function h(F,$){return typeof F=="number"?o(F,$):typeof F=="string"?c(F,$):u(F.low,F.high,typeof $=="boolean"?$:F.unsigned)}t.fromValue=h;var f=65536,p=1<<24,g=f*f,y=g*g,x=y/2,v=a(p),S=a(0);t.ZERO=S;var w=a(0,!0);t.UZERO=w;var E=a(1);t.ONE=E;var _=a(1,!0);t.UONE=_;var D=a(-1);t.NEG_ONE=D;var I=u(-1,2147483647,!1);t.MAX_VALUE=I;var k=u(-1,-1,!0);t.MAX_UNSIGNED_VALUE=k;var A=u(0,-2147483648,!1);t.MIN_VALUE=A;var N=t.prototype;return N.toInt=function(){return this.unsigned?this.low>>>0:this.low},N.toNumber=function(){return this.unsigned?(this.high>>>0)*g+(this.low>>>0):this.high*g+(this.low>>>0)},N.toString=function($){if($=$||10,$<2||36<$)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(A)){var O=o($),M=this.div(O),B=M.mul(O).sub(this);return M.toString($)+B.toInt().toString($)}else return"-"+this.neg().toString($);for(var U=o(l($,6),this.unsigned),V=this,Z="";;){var J=V.div(U),ne=V.sub(J.mul(U)).toInt()>>>0,z=ne.toString($);if(V=J,V.isZero())return z+Z;for(;z.length<6;)z="0"+z;Z=""+z+Z}},N.getHighBits=function(){return this.high},N.getHighBitsUnsigned=function(){return this.high>>>0},N.getLowBits=function(){return this.low},N.getLowBitsUnsigned=function(){return this.low>>>0},N.getNumBitsAbs=function(){if(this.isNegative())return this.eq(A)?64:this.neg().getNumBitsAbs();for(var $=this.high!=0?this.high:this.low,O=31;O>0&&($&1<<O)==0;O--);return this.high!=0?O+33:O+1},N.isZero=function(){return this.high===0&&this.low===0},N.eqz=N.isZero,N.isNegative=function(){return!this.unsigned&&this.high<0},N.isPositive=function(){return this.unsigned||this.high>=0},N.isOdd=function(){return(this.low&1)===1},N.isEven=function(){return(this.low&1)===0},N.equals=function($){return n($)||($=h($)),this.unsigned!==$.unsigned&&this.high>>>31===1&&$.high>>>31===1?!1:this.high===$.high&&this.low===$.low},N.eq=N.equals,N.notEquals=function($){return!this.eq($)},N.neq=N.notEquals,N.ne=N.notEquals,N.lessThan=function($){return this.comp($)<0},N.lt=N.lessThan,N.lessThanOrEqual=function($){return this.comp($)<=0},N.lte=N.lessThanOrEqual,N.le=N.lessThanOrEqual,N.greaterThan=function($){return this.comp($)>0},N.gt=N.greaterThan,N.greaterThanOrEqual=function($){return this.comp($)>=0},N.gte=N.greaterThanOrEqual,N.ge=N.greaterThanOrEqual,N.compare=function($){if(n($)||($=h($)),this.eq($))return 0;var O=this.isNegative(),M=$.isNegative();return O&&!M?-1:!O&&M?1:this.unsigned?$.high>>>0>this.high>>>0||$.high===this.high&&$.low>>>0>this.low>>>0?-1:1:this.sub($).isNegative()?-1:1},N.comp=N.compare,N.negate=function(){return!this.unsigned&&this.eq(A)?A:this.not().add(E)},N.neg=N.negate,N.add=function($){n($)||($=h($));var O=this.high>>>16,M=this.high&65535,B=this.low>>>16,U=this.low&65535,V=$.high>>>16,Z=$.high&65535,J=$.low>>>16,ne=$.low&65535,z=0,X=0,Y=0,se=0;return se+=U+ne,Y+=se>>>16,se&=65535,Y+=B+J,X+=Y>>>16,Y&=65535,X+=M+Z,z+=X>>>16,X&=65535,z+=O+V,z&=65535,u(Y<<16|se,z<<16|X,this.unsigned)},N.subtract=function($){return n($)||($=h($)),this.add($.neg())},N.sub=N.subtract,N.multiply=function($){if(this.isZero())return S;if(n($)||($=h($)),r){var O=r.mul(this.low,this.high,$.low,$.high);return u(O,r.get_high(),this.unsigned)}if($.isZero())return S;if(this.eq(A))return $.isOdd()?A:S;if($.eq(A))return this.isOdd()?A:S;if(this.isNegative())return $.isNegative()?this.neg().mul($.neg()):this.neg().mul($).neg();if($.isNegative())return this.mul($.neg()).neg();if(this.lt(v)&&$.lt(v))return o(this.toNumber()*$.toNumber(),this.unsigned);var M=this.high>>>16,B=this.high&65535,U=this.low>>>16,V=this.low&65535,Z=$.high>>>16,J=$.high&65535,ne=$.low>>>16,z=$.low&65535,X=0,Y=0,se=0,ue=0;return ue+=V*z,se+=ue>>>16,ue&=65535,se+=U*z,Y+=se>>>16,se&=65535,se+=V*ne,Y+=se>>>16,se&=65535,Y+=B*z,X+=Y>>>16,Y&=65535,Y+=U*ne,X+=Y>>>16,Y&=65535,Y+=V*J,X+=Y>>>16,Y&=65535,X+=M*z+B*ne+U*J+V*Z,X&=65535,u(se<<16|ue,X<<16|Y,this.unsigned)},N.mul=N.multiply,N.divide=function($){if(n($)||($=h($)),$.isZero())throw Error("division by zero");if(r){if(!this.unsigned&&this.high===-2147483648&&$.low===-1&&$.high===-1)return this;var O=(this.unsigned?r.div_u:r.div_s)(this.low,this.high,$.low,$.high);return u(O,r.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?w:S;var M,B,U;if(this.unsigned){if($.unsigned||($=$.toUnsigned()),$.gt(this))return w;if($.gt(this.shru(1)))return _;U=w}else{if(this.eq(A)){if($.eq(E)||$.eq(D))return A;if($.eq(A))return E;var V=this.shr(1);return M=V.div($).shl(1),M.eq(S)?$.isNegative()?E:D:(B=this.sub($.mul(M)),U=M.add(B.div($)),U)}else if($.eq(A))return this.unsigned?w:S;if(this.isNegative())return $.isNegative()?this.neg().div($.neg()):this.neg().div($).neg();if($.isNegative())return this.div($.neg()).neg();U=S}for(B=this;B.gte($);){M=Math.max(1,Math.floor(B.toNumber()/$.toNumber()));for(var Z=Math.ceil(Math.log(M)/Math.LN2),J=Z<=48?1:l(2,Z-48),ne=o(M),z=ne.mul($);z.isNegative()||z.gt(B);)M-=J,ne=o(M,this.unsigned),z=ne.mul($);ne.isZero()&&(ne=E),U=U.add(ne),B=B.sub(z)}return U},N.div=N.divide,N.modulo=function($){if(n($)||($=h($)),r){var O=(this.unsigned?r.rem_u:r.rem_s)(this.low,this.high,$.low,$.high);return u(O,r.get_high(),this.unsigned)}return this.sub(this.div($).mul($))},N.mod=N.modulo,N.rem=N.modulo,N.not=function(){return u(~this.low,~this.high,this.unsigned)},N.and=function($){return n($)||($=h($)),u(this.low&$.low,this.high&$.high,this.unsigned)},N.or=function($){return n($)||($=h($)),u(this.low|$.low,this.high|$.high,this.unsigned)},N.xor=function($){return n($)||($=h($)),u(this.low^$.low,this.high^$.high,this.unsigned)},N.shiftLeft=function($){return n($)&&($=$.toInt()),($&=63)===0?this:$<32?u(this.low<<$,this.high<<$|this.low>>>32-$,this.unsigned):u(0,this.low<<$-32,this.unsigned)},N.shl=N.shiftLeft,N.shiftRight=function($){return n($)&&($=$.toInt()),($&=63)===0?this:$<32?u(this.low>>>$|this.high<<32-$,this.high>>$,this.unsigned):u(this.high>>$-32,this.high>=0?0:-1,this.unsigned)},N.shr=N.shiftRight,N.shiftRightUnsigned=function($){if(n($)&&($=$.toInt()),$&=63,$===0)return this;var O=this.high;if($<32){var M=this.low;return u(M>>>$|O<<32-$,O>>>$,this.unsigned)}else return $===32?u(O,0,this.unsigned):u(O>>>$-32,0,this.unsigned)},N.shru=N.shiftRightUnsigned,N.shr_u=N.shiftRightUnsigned,N.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},N.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},N.toBytes=function($){return $?this.toBytesLE():this.toBytesBE()},N.toBytesLE=function(){var $=this.high,O=this.low;return[O&255,O>>>8&255,O>>>16&255,O>>>24,$&255,$>>>8&255,$>>>16&255,$>>>24]},N.toBytesBE=function(){var $=this.high,O=this.low;return[$>>>24,$>>>16&255,$>>>8&255,$&255,O>>>24,O>>>16&255,O>>>8&255,O&255]},t.fromBytes=function($,O,M){return M?t.fromBytesLE($,O):t.fromBytesBE($,O)},t.fromBytesLE=function($,O){return new t($[0]|$[1]<<8|$[2]<<16|$[3]<<24,$[4]|$[5]<<8|$[6]<<16|$[7]<<24,O)},t.fromBytesBE=function($,O){return new t($[4]<<24|$[5]<<16|$[6]<<8|$[7],$[0]<<24|$[1]<<16|$[2]<<8|$[3],O)},u_}var qP=roe();const KP=zD(qP),soe=eY({__proto__:null,default:KP},[qP]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nc=KP||soe;function x2(r){return Nc.fromString(r,!0,16)}const XP=x2("c3a5c85c97cb3127"),Cc=x2("b492b66fbe98f273"),Zs=x2("9ae16a3b2f90404f");function FE(r){return r.xor(r.shru(47))}function YP(r,t,n){const s=r.slice(t,t+n);return Nc.fromBytes(Array.from(s),!0,!0)}function ar(r,t){return YP(r,t,8)}function bO(r,t){return YP(r,t,4)}function cs(r,t){return t===0?r:r.shru(t).or(r.shl(64-t))}function _l(r,t,n=x2("9ddfea08eb382d69")){let s=r.xor(t).mul(n);s=s.xor(s.shru(47));let i=t.xor(s).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function ioe(r,t,n,s,i,a){i=i.add(r),a=cs(a.add(i).add(s),21);const o=i;return i=i.add(t),i=i.add(n),a=a.add(cs(i,44)),[i.add(s),a.add(o)]}function My(r,t,n,s){return ioe(ar(r,t),ar(r,t+8),ar(r,t+16),ar(r,t+24),n,s)}function aoe(r,t=r.length){if(t>=8){const n=Zs.add(t*2),s=ar(r,0).add(Zs),i=ar(r,t-8),a=cs(i,37).mul(n).add(s),o=cs(s,25).add(i).mul(n);return _l(a,o,n)}if(t>=4){const n=Zs.add(t*2),s=bO(r,0);return _l(s.shl(3).add(t),bO(r,t-4),n)}if(t>0){const n=r[0],s=r[t>>1],i=r[t-1],a=n+(s<<8),o=t+(i<<2);return FE(Zs.mul(a).xor(XP.mul(o))).mul(Zs)}return Zs}function ooe(r,t=r.length){const n=Zs.add(t*2),s=ar(r,0).mul(Cc),i=ar(r,8),a=ar(r,t-8).mul(n),o=ar(r,t-16).mul(Zs);return _l(cs(s.add(i),43).add(cs(a,30)).add(o),s.add(cs(i.add(Zs),18)).add(a),n)}function uoe(r,t=r.length){const n=Zs.add(t*2),s=ar(r,0).mul(Zs),i=ar(r,8),a=ar(r,t-8).mul(n),o=ar(r,t-16).mul(Zs),u=cs(s.add(i),43).add(cs(a,30)).add(o),l=_l(u,s.add(cs(i.add(Zs),18)).add(a),n),c=ar(r,16).mul(n),h=ar(r,24),f=u.add(ar(r,t-32)).mul(n),p=l.add(ar(r,t-24)).mul(n);return _l(cs(c.add(h),43).add(cs(f,30)).add(p),c.add(cs(h.add(s),18)).add(f),n)}function loe(r,t=r.length){const n=Nc.fromNumber(81,!0);if(t<=32)return t<=16?aoe(r,t):ooe(r,t);if(t<=64)return uoe(r,t);let s=n,i=n.mul(Cc).add(113),a=FE(i.mul(Zs).add(113)).mul(Zs),o=[Nc.UZERO,Nc.UZERO],u=[Nc.UZERO,Nc.UZERO];s=s.mul(Zs).add(ar(r,0));let l=0;const c=(t-1>>6)*64,h=c+(t-1&63)-63;do s=cs(s.add(i).add(o[0]).add(ar(r,l+8)),37).mul(Cc),i=cs(i.add(o[1]).add(ar(r,l+48)),42).mul(Cc),s=s.xor(u[1]),i=i.add(o[0]).add(ar(r,l+40)),a=cs(a.add(u[0]),33).mul(Cc),o=My(r,l,o[1].mul(Cc),s.add(u[0])),u=My(r,l+32,a.add(u[1]),i.add(ar(r,l+16))),[a,s]=[s,a],l+=64;while(l!==c);const f=Cc.add(a.and(255).shl(1));return l=h,u[0]=u[0].add(t-1&63),o[0]=o[0].add(u[0]),u[0]=u[0].add(o[0]),s=cs(s.add(i).add(o[0]).add(ar(r,l+8)),37).mul(f),i=cs(i.add(o[1]).add(ar(r,l+48)),42).mul(f),s=s.xor(u[1].mul(9)),i=i.add(o[0].mul(9).add(ar(r,l+40))),a=cs(a.add(u[0]),33).mul(f),o=My(r,l,o[1].mul(f),s.add(u[0])),u=My(r,l+32,a.add(u[1]),i.add(ar(r,l+16))),[a,s]=[s,a],_l(_l(o[0],u[0],f).add(FE(i).mul(XP)).add(a),_l(o[1],u[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(r,t){return t==="string"?El(r):Eh([r],t)}function coe(r,t){return r instanceof Float32Array&&t==="float32"||r instanceof Int32Array&&t==="int32"||r instanceof Uint8Array&&t==="bool"}function Eh(r,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=gd(r)),Ke().getBool("DEBUG")&&Uae(r,t),coe(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){const n=new Uint8Array(r.length);for(let s=0;s<n.length;++s)Math.round(r[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function oi(){return Ke().platform.now()}function El(r,t="utf-8"){return t=t||"utf-8",Ke().platform.encode(r,t)}function Fl(r,t="utf-8"){return t=t||"utf-8",Ke().platform.decode(r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let hoe=class{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new doe)}profileKernel(t,n,s){let i;const a=()=>{i=s()};let o;const u=oi();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const c of i)c.dataSync();o=Promise.resolve({kernelMs:oi()-u})}if(Ke().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<i.length;c++){const h=i[c];h.data().then(f=>{foe(f,h.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:o.then(c=>c.kernelMs),extraInfo:o.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:i,inputs:a,extraInfo:o}=t;s.forEach(u=>{Promise.all([u.data(),i,o]).then(l=>{this.logger.logKernelProfile(n,u,l[0],l[1],a,l[2])})})}};function foe(r,t,n){if(t!=="float32")return!1;for(let s=0;s<r.length;s++){const i=r[s];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}let doe=class{logKernelProfile(t,n,s,i,a,o){const u=typeof i=="number"?Zf(`${i}ms`,9):i.error,l=Zf(t,25),c=n.rank,h=n.size,f=Zf(n.shape.toString(),14);let p="";for(const g in a){const y=a[g];if(y!=null){const x=y.shape||n.shape,v=x.length;p+=`${g}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${u}	%c${c}D ${f}	%c${h}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(r,t,n){const s={},i={};for(let l=0;l<t.length;l++)s[t[l].id]=!0;for(let l=0;l<r.length;l++){const c=r[l],h=c.inputs;for(const f in h){const p=h[f];let g=!1;for(let y=0;y<t.length;y++)if(s[p.id]){c.outputs.forEach(x=>s[x.id]=!0),g=!0,i[c.id]=!0;break}if(g)break}}const a={};a[n.id]=!0;const o={};for(let l=r.length-1;l>=0;l--){const c=r[l],h=c.inputs;for(let f=0;f<c.outputs.length;f++)if(a[c.outputs[f].id]){for(const p in h)a[h[p].id]=!0,o[c.id]=!0;break}}const u=[];for(let l=0;l<r.length;l++){const c=r[l];if(i[c.id]&&o[c.id]){const h={};for(const p in c.inputs){const g=c.inputs[p];s[g.id]&&(h[p]=g)}const f=Object.assign({},c);f.inputs=h,f.outputs=c.outputs,u.push(f)}}return u}function moe(r,t,n,s){for(let i=t.length-1;i>=0;i--){const a=t[i],o=[];if(a.outputs.forEach(l=>{const c=r[l.id];c!=null?o.push(c):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const u=a.gradient(o);for(const l in a.inputs){if(!(l in u))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(u)}.`);const c=n(()=>u[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=a.inputs[l];if(!Bn(c.shape,h.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(r[h.id]==null)r[h.id]=c;else{const f=r[h.id];r[h.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vO=20,cm=3,l_=7;function goe(r,t,n,s){const i=Mt(t),a=yoe(r,t,n,i),o=t.length,u=ix(r,t,n,i,a),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(u.map(c=>"    "+c).join(`
`)),l.join(`
`)}function yoe(r,t,n,s){const i=Je(t),a=s[s.length-1],o=new Array(a).fill(0),u=t.length,l=n==="complex64"?vm(r):r;if(u>1)for(let c=0;c<i/a;c++){const h=c*a;for(let f=0;f<a;f++)o[f]=Math.max(o[f],bm(l[h+f],0,n).length)}return o}function bm(r,t,n){let s;return Array.isArray(r)?s=`${parseFloat(r[0].toFixed(l_))} + ${parseFloat(r[1].toFixed(l_))}j`:Ig(r)?s=`'${r}'`:n==="bool"?s=ZP(r):s=parseFloat(r.toFixed(l_)).toString(),Zf(s,t)}function ZP(r){return r===0?"false":"true"}function ix(r,t,n,s,i,a=!0){const o=n==="complex64"?2:1,u=t[0],l=t.length;if(l===0){if(n==="complex64"){const x=vm(r);return[bm(x[0],0,n)]}return n==="bool"?[ZP(r[0])]:[r[0].toString()]}if(l===1){if(u>vO){const v=cm*o;let S=Array.from(r.slice(0,v)),w=Array.from(r.slice((u-cm)*o,u*o));return n==="complex64"&&(S=vm(S),w=vm(w)),["["+S.map((E,_)=>bm(E,i[_],n)).join(", ")+", ..., "+w.map((E,_)=>bm(E,i[u-cm+_],n)).join(", ")+"]"]}return["["+(n==="complex64"?vm(r):Array.from(r)).map((v,S)=>bm(v,i[S],n)).join(", ")+"]"]}const c=t.slice(1),h=s.slice(1),f=s[0]*o,p=[];if(u>vO){for(let x=0;x<cm;x++){const v=x*f,S=v+f;p.push(...ix(r.slice(v,S),c,n,h,i,!1))}p.push("...");for(let x=u-cm;x<u;x++){const v=x*f,S=v+f;p.push(...ix(r.slice(v,S),c,n,h,i,x===u-1))}}else for(let x=0;x<u;x++){const v=x*f,S=v+f;p.push(...ix(r.slice(v,S),c,n,h,i,x===u-1))}const g=l===2?",":"";p[0]="["+p[0]+g;for(let x=1;x<p.length-1;x++)p[x]=" "+p[x]+g;let y=`,
`;for(let x=2;x<l;x++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":y),p}function vm(r){const t=[];for(let n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zs=class{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=Je(t),s!=null){const i=s.length;oe(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||ds(n,this.size),this.strides=Mt(t)}set(t,...n){n.length===0&&(n=[0]),oe(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=t[t.length-1];for(let i=0;i<t.length-1;++i)s+=this.strides[i]*t[i];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return qa().makeTensor(this.values,this.shape,this.dtype)}},qa=null,$f=null;function xoe(r){qa=r}function boe(r){$f=r}let Ur=class{constructor(t,n,s,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Je(t),this.strides=Mt(t),this.dataId=s,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return $f.buffer(this.shape,this.dtype,t)}bufferSync(){return $f.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return to(this.shape,t,this.dtype==="complex64")}arraySync(){return to(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=qa().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>Fl(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),qa().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=qa().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Fl(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await qa().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(qa().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return $f.print(this,t)}clone(){return this.throwIfDisposed(),$f.clone(this)}toString(t=!1){const n=this.dataSync();return goe(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),$f.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),qa().makeVariable(this,t,n,s)}};Object.defineProperty(Ur,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});function Ye(){return qT("Tensor",()=>Ur)}Ye();let Jx=class extends Ur{constructor(t,n,s,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!Bn(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);qa().disposeTensor(this),this.dataId=t.dataId,qa().incRef(this,null)}dispose(){qa().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Jx,Symbol.hasInstance,{value:r=>r instanceof Ur&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wO;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(wO||(wO={}));var RE;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(RE||(RE={}));var OE;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(OE||(OE={}));var ME;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(ME||(ME={}));var LE;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(LE||(LE={}));const voe={float32:ME,int32:RE,bool:OE,complex64:LE};function $i(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${r} with ${t}`)}return voe[r][t]}function I3(r){return $i(r,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(r,t){if(r.dtype===t.dtype)return[r,t];const n=$i(r.dtype,t.dtype);return[r.cast(n),t.cast(n)]}function QP(r){const t=[];return JP(r,t,new Set),t}function JP(r,t,n){if(r==null)return;if(r instanceof Ur){t.push(r);return}if(!woe(r))return;const s=r;for(const i in s){const a=s[i];n.has(a)||(n.add(a),JP(a,t,n))}}function woe(r){return Array.isArray(r)||typeof r=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_(r){return r.kernelName!=null}let SO=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}},$3=class BE{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new SO}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(Hi(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new hoe(this.backendInstance),!0}setupRegisteredKernels(){yO(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){yO(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof GT)&&typeof s.then=="function"){const i=++this.pendingBackendInitId,a=s.then(o=>i<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,Hi(`Initialization of backend ${t} failed`),Hi(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Hi(`Initialization of backend ${t} failed`),Hi(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:i,asyncInit:a}=this.initializeBackend(s);if(a||i)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),i=s.backend,a=this.readSync(n),o=i.refCount(n);i.disposeData(n,!0),s.backend=t,t.move(n,a,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let i;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,s){t();try{const i=s();return n(),i}catch(i){throw n(),i}}nextTensorId(){return BE.nextTensorId++}nextVariableId(){return BE.nextVariableId++}clone(t){const n=Te.runKernel(Jg,{x:t}),s={x:t},i=o=>({x:()=>{const u="float32",l={x:o},c={dtype:u};return Te.runKernel(Vg,l,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],i,a,{}),n}runKernel(t,n,s){if(this.backendName==null&&this.backend,!(mO(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const i=this.backend.numDataIds();let a=0;s.forEach(l=>{a+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],u=i-n-a-o;if(u>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${u} data ids) after running '${t}'`)}runKernelFunc(t){let n,s=[];const i=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let u;this.backendName==null&&this.backend;let l;const c=c_(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(c_(t)){const{kernelName:y,inputs:x,attrs:v}=t;this.backendName==null&&this.backend;const S=mO(y,this.backendName);oe(S!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),u=()=>{const w=this.backend.numDataIds();l=S.kernelFunc({inputs:x,attrs:v,backend:this.backend});const E=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,w,E);const _=E.map(D=>D.rank!=null?D:this.makeTensorFromTensorInfo(D));if(i){const D=this.getTensorsForGradient(y,x,_);s=this.saveTensorsForBackwardMode(D)}return _}}else{const{forwardFunc:y}=t,x=v=>{i&&(s=v.map(S=>this.keep(this.clone(S))))};u=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,x));const S=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,v,S),S}}const{inputs:h,attrs:f}=t,p=c_(t)?null:t.backwardsFunc;let g;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=u():(g=this.profiler.profileKernel(c,h,()=>u()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(g),n=g.outputs)}),i&&this.addTapeNode(c,h,n,p,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(y=>h[y]!=null?h[y].shape:null),outputShapes:n.map(y=>y.shape),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const i=gO(t);if(i!=null){const a=i.inputsToSave||[],o=i.outputsToSave||[];let u;i.saveAllInputs?(oe(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),u=Object.keys(n).map(c=>n[c])):u=a.map(c=>n[c]);const l=s.filter((c,h)=>o[h]);return u.concat(l)}return[]}makeTensor(t,n,s,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",i=i||this.backend;let a=t;s==="string"&&Ig(t[0])&&(a=t.map(l=>El(l)));const o=i.write(a,n,s),u=new Ur(n,s,o,this.nextTensorId());if(this.trackTensor(u,i),s==="string"){const l=this.state.tensorInfo.get(o),c=jae(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return u}makeTensorFromDataId(t,n,s,i){s=s||"float32";const a={dataId:t,shape:n,dtype:s};return this.makeTensorFromTensorInfo(a,i)}makeTensorFromTensorInfo(t,n){const{dataId:s,shape:i,dtype:a}=t,o=new Ur(i,a,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(t,n=!0,s,i){s=s||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const a=new Jx(t,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*DE(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof Jx||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*DE(t.dtype);this.state.numBytes-=s}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,i,a,o){const u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:a},l=gO(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=c=>(c=c.map((h,f)=>{if(h==null){const p=s[f],g=Us(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return h}),i(c.length>1?c:c[0],a,o))),this.state.activeTape.push(u)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=QP(t),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!s.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===i.id&&this.track(a)})}gradients(t,n,s,i=!1){if(oe(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));oe(a instanceof Ur,()=>"The result y returned by f() must be a tensor.");const o=poe(this.state.activeTape,n,a);if(!i&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const u={};u[a.id]=s??Soe(a.shape),moe(u,o,c=>this.tidy(c),Coe);const l=n.map(c=>u[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(t){return oe(NE(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{oe(n.every(u=>u instanceof Ur),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const i={};n.forEach((u,l)=>{i[l]=u});const a=(u,l)=>(s=t(...n,l),oe(s.value instanceof Ur,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),oe(NE(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(u,l)=>{const c=s.gradFunc(u,l),h=Array.isArray(c)?c:[c];oe(h.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),oe(h.every(p=>p instanceof Ur),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return h.forEach((p,g)=>{f[g]=()=>p}),f};return this.runKernelFunc({forwardFunc:a,backwardsFunc:o,inputs:i})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=oi(),s=await this.backend.time(t);return s.wallMs=oi()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new SO;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};$3.nextTensorId=0;$3.nextVariableId=0;function Soe(r){const t=HT(Je(r),"float32");return Te.makeTensor(t,r,"float32")}function e7(){const r=CP();if(r._tfengine==null){const t=new Hae(r);r._tfengine=new $3(t)}return Yae(r._tfengine.ENV),xoe(()=>r._tfengine),r._tfengine}const Te=e7();function Coe(r,t){const n={a:r,b:t};return Te.runKernel(Ud,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(){return typeof navigator<"u"&&navigator!=null}function t7(r){if(r||_oe()){if(r||(r=navigator),r.product==="ReactNative")return!0;const t=r.userAgent||r.vendor||(typeof window<"u"?window.opera:"");if(!t){const n=r;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function n7(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fi=Ke();Fi.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Fi.registerFlag("IS_BROWSER",()=>n7());Fi.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Fi.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Fi.registerFlag("PROD",()=>!1);Fi.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Fi.getBool("DEBUG"));Fi.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Fi.registerFlag("IS_TEST",()=>!1);Fi.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Fi.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Fi.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Fi.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Fi.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2(r,t){let n=r;if(Ao(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];const s=[];for(;Array.isArray(n)||Ao(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(r)&&Ke().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&r7(r,s,[]),s}function r7(r,t,n){if(n=n||[],!Array.isArray(r)&&!Ao(r)){oe(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}oe(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${r.length} elements`),oe(r.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${r.length} elements`);const s=t.slice(1);for(let i=0;i<r.length;++i)r7(r[i],s,n.concat(i))}function CO(r,t,n,s){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==t||r==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${r} tensor, but got ${t} tensor`)}}function me(r,t,n,s="numeric"){if(r instanceof Ur)return CO(s,r.dtype,t,n),r;let i=$g(r);if(i!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(i=s),CO(s,i,t,n),r==null||!Ao(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const l=r==null?"null":r.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const a=b2(r,i);!Ao(r)&&!Array.isArray(r)&&(r=[r]);const u=i!=="string"?Eh(r,i):gd(r,[],!0);return Te.makeTensor(u,a,i)}function s7(r,t,n,s="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((a,o)=>me(a,`${t}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe="__op";function $e(r){const t=Object.keys(r);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=r[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Eoe;const i=(...a)=>{Te.startScope(n);try{const o=s(...a);return wP(o)&&console.error("Cannot return a Promise inside of tidy."),Te.endScope(o),o}catch(o){throw Te.endScope(null),o}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(r,t){const n=me(r,"real","complex"),s=me(t,"imag","complex");WT(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const i={real:n,imag:s};return Te.runKernel(e3,i)}const xd=$e({complex_:Doe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v2(r,t,n,s){if(s==null&&(s=$g(r)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ao(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){vP(t);const i=Je(t),a=Je(n);oe(i===a,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${a}`);for(let o=0;o<n.length;++o){const u=n[o],l=o===n.length-1?u!==Je(t.slice(o)):!0;oe(n[o]===t[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Ao(r)&&!Array.isArray(r)&&(r=[r]),t=t||n,r=s!=="string"?Eh(r,s):gd(r,[],!0),Te.makeTensor(r,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(r,t,n){const s=b2(r,n);return v2(r,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _O=4;async function EO(r,t){const n=[],s=[],i=Array.isArray(r)?r.map(o=>o.name):Object.keys(r);for(let o=0;o<i.length;++o){const u=i[o],l=Array.isArray(r)?r[o].tensor:r[u];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${u}': ${l.dtype}`);const c={name:u,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async f=>{const p=await l.bytes(),g=p.reduce((v,S)=>v+S.length,0)+_O*p.length,y=new Uint8Array(g);let x=0;for(let v=0;v<p.length;v++){const S=p[v],w=new Uint8Array(new Uint32Array([S.length]).buffer);y.set(w,x),x+=_O,y.set(S,x),x+=S.length}f(y)});s.push(h)}else s.push(l.data());t!=null&&(c.group=t),n.push(c)}const a=await Promise.all(s);return{data:Noe(a),specs:n}}function Noe(r){if(r===null)throw new Error(`Invalid input value: ${JSON.stringify(r)}`);let t=0;const n=[];r.forEach(a=>{if(t+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(t);let i=0;return n.forEach(a=>{s.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),s.buffer}const F3=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function DO(r){return F3?Buffer.byteLength(r):new Blob([r]).size}function koe(r){if(F3)return Buffer.from(r).toString("base64");const t=new Uint8Array(r);let n="";for(let s=0,i=t.length;s<i;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function Aoe(r){if(F3){const s=Buffer.from(r,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(r),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function Ioe(r){if(r.length===1)return r[0];let t=0;r.forEach(i=>{t+=i.byteLength});const n=new Uint8Array(t);let s=0;return r.forEach(i=>{n.set(new Uint8Array(i),s),s+=i.byteLength}),n.buffer}function i7(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:DO(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:DO(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let N0=class Ua{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Ua.instance==null&&(Ua.instance=new Ua),Ua.instance}static registerSaveRouter(t){Ua.getInstance().saveRouters.push(t)}static registerLoadRouter(t){Ua.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return Ua.getHandlers(t,"save")}static getLoadHandlers(t,n){return Ua.getHandlers(t,"load",n)}static getHandlers(t,n,s){const i=[];return(n==="load"?Ua.getInstance().loadRouters:Ua.getInstance().saveRouters).forEach(o=>{const u=o(t,s);u!==null&&i.push(u)}),i}};const $oe=r=>N0.getSaveHandlers(r);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE="tensorflowjs",VE=1,$c="models_store",gl="model_info_store";function a7(){if(!Ke().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window>"u"?self:window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function zE(r){const t=r.result;t.createObjectStore($c,{keyPath:"modelPath"}),t.createObjectStore(gl,{keyPath:"modelPath"})}let rh=class{constructor(t){if(this.indexedDB=a7(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,i)=>{const a=this.indexedDB.open(PE,VE);a.onupgradeneeded=()=>zE(a),a.onsuccess=()=>{const o=a.result;if(n==null){const u=o.transaction($c,"readonly"),c=u.objectStore($c).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=h=>(o.close(),i(c.error)),u.oncomplete=()=>o.close()}else{const u=i7(n),l=o.transaction(gl,"readwrite");let c=l.objectStore(gl);const h=c.put({modelPath:this.modelPath,modelArtifactsInfo:u});let f;h.onsuccess=()=>{f=o.transaction($c,"readwrite");const g=f.objectStore($c).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:u});g.onsuccess=()=>s({modelArtifactsInfo:u}),g.onerror=y=>{c=l.objectStore(gl);const x=c.delete(this.modelPath);x.onsuccess=()=>(o.close(),i(g.error)),x.onerror=v=>(o.close(),i(g.error))}},h.onerror=p=>(o.close(),i(h.error)),l.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},a.onerror=o=>i(a.error)})}};rh.URL_SCHEME="indexeddb://";const o7=r=>Ke().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(rh.URL_SCHEME)?Foe(r.slice(rh.URL_SCHEME.length)):null;N0.registerSaveRouter(o7);N0.registerLoadRouter(o7);function Foe(r){return new rh(r)}function Roe(r){return r.startsWith(rh.URL_SCHEME)?r.slice(rh.URL_SCHEME.length):r}let Ooe=class{constructor(){this.indexedDB=a7()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(PE,VE);s.onupgradeneeded=()=>zE(s),s.onsuccess=()=>{const i=s.result,a=i.transaction(gl,"readonly"),u=a.objectStore(gl).getAll();u.onsuccess=()=>{const l={};for(const c of u.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},u.onerror=l=>(i.close(),n(u.error)),a.oncomplete=()=>i.close()},s.onerror=i=>n(s.error)})}async removeModel(t){return t=Roe(t),new Promise((n,s)=>{const i=this.indexedDB.open(PE,VE);i.onupgradeneeded=()=>zE(i),i.onsuccess=()=>{const a=i.result,o=a.transaction(gl,"readwrite"),u=o.objectStore(gl),l=u.get(t);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const h=u.delete(t),f=()=>{c=a.transaction($c,"readwrite");const g=c.objectStore($c).delete(t);g.onsuccess=()=>n(l.result.modelArtifactsInfo),g.onerror=y=>s(l.error)};h.onsuccess=f,h.onerror=p=>(f(),a.close(),s(l.error))}},l.onerror=h=>(a.close(),s(l.error)),o.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},i.onerror=a=>s(i.error)})}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hu="/",Ff="tensorflowjs_models",u7="info",Moe="model_topology",Loe="weight_specs",Boe="weight_data",Poe="model_metadata";function l7(r){return{info:[Ff,r,u7].join(hu),topology:[Ff,r,Moe].join(hu),weightSpecs:[Ff,r,Loe].join(hu),weightData:[Ff,r,Boe].join(hu),modelMetadata:[Ff,r,Poe].join(hu)}}function c7(r){for(const t of Object.values(r))window.localStorage.removeItem(t)}function Voe(r){const t=r.split(hu);if(t.length<3)throw new Error(`Invalid key format: ${r}`);return t.slice(1,t.length-1).join(hu)}function zoe(r){return r.startsWith(sh.URL_SCHEME)?r.slice(sh.URL_SCHEME.length):r}let sh=class{constructor(t){if(!Ke().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=l7(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),i=i7(t);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,koe(t.weightData));const a={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw c7(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const u=JSON.parse(a);n.format=u.format,n.generatedBy=u.generatedBy,n.convertedBy=u.convertedBy,u.signature!=null&&(n.signature=u.signature),u.userDefinedMetadata!=null&&(n.userDefinedMetadata=u.userDefinedMetadata),u.modelInitializer!=null&&(n.modelInitializer=u.modelInitializer),u.trainingConfig!=null&&(n.trainingConfig=u.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Aoe(o),n}};sh.URL_SCHEME="localstorage://";const h7=r=>Ke().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(sh.URL_SCHEME)?Uoe(r.slice(sh.URL_SCHEME.length)):null;N0.registerSaveRouter(h7);N0.registerLoadRouter(h7);function Uoe(r){return new sh(r)}let Goe=class{constructor(){oe(Ke().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),oe(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Ff+hu,s=hu+u7;for(let i=0;i<this.LS.length;++i){const a=this.LS.key(i);if(a.startsWith(n)&&a.endsWith(s)){const o=Voe(a);t[o]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=zoe(t);const n=l7(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return c7(n),s}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TO="://";let NO=class sl{constructor(){this.managers={}}static getInstance(){return sl.instance==null&&(sl.instance=new sl),sl.instance}static registerManager(t,n){oe(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(TO)&&(t=t.slice(0,t.indexOf(TO))),oe(t.length>0,()=>"scheme must not be an empty string.");const s=sl.getInstance();oe(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=sl.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(sl.getInstance().managers)}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let joe=class{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(!window||!Ke().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const i=this.functionRefs[s.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}};if(Ke().get("IS_BROWSER")){Ke().setPlatform("browser",new joe);try{NO.registerManager(sh.URL_SCHEME,new Goe)}catch{}try{NO.registerManager(rh.URL_SCHEME,new Ooe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Woe={importFetch:()=>require("node-fetch")};let h_,Hoe=class{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return Ke().global.fetch!=null?Ke().global.fetch(t,n):(h_==null&&(h_=Woe.importFetch()),h_(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}};Ke().get("IS_NODE")&&!Ke().get("IS_BROWSER")&&Ke().setPlatform("node",new Hoe);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hn(r,t="float32",n){return t=t||"float32",vP(r),new zs(r,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(r,t){const n=me(r,"x","cast");if(!Gae(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},i={dtype:t};return Te.runKernel(Vg,s,i)}const _t=$e({cast_:qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(r){const n={x:me(r,"x","clone","string_or_numeric")};return Te.runKernel(Jg,n)}const Mc=$e({clone_:Koe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(r,t=!1){console.log(r.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */e7();const Yoe={buffer:hn,cast:_t,clone:Mc,print:Xoe};boe(Yoe);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(r,t,n=!1,s=!1){let i=me(r,"a","matMul"),a=me(t,"b","matMul");[i,a]=Rr(i,a);const o={a:i,b:a},u={transposeA:n,transposeB:s};return Te.runKernel(Cv,o,u)}const On=$e({matMul_:Zoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(r,t,n=1,s=0,i="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const o={indices:me(r,"indices","oneHot","int32")},u={dtype:i,depth:t,onValue:n,offValue:s};return Te.runKernel(e2,o,u)}const f7=$e({oneHot_:Qoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ol(){return Te}function kO(){return Te.memory()}function Ue(r,t){return Te.tidy(r,t)}function gn(r){QP(r).forEach(n=>n.dispose())}function Io(r){return Te.keep(r)}function d7(r,t,n=1){return Te.registerBackend(r,t,n)}function Joe(){return Te.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(r){const n={input:me(r,"input","imag")};return Te.runKernel(p3,n)}const R3=$e({imag_:eue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tue(r){const n={x:me(r,"x","neg")};return Te.runKernel(Zv,n)}const Wr=$e({neg_:tue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(r){const n={input:me(r,"input","real")};return Te.runKernel(S3,n)}const eb=$e({real_:nue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(r,t,n){const s=me(r,"x","transpose");if(t==null&&(t=s.shape.map((o,u)=>u).reverse()),oe(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(o=>{oe(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const i={x:s},a={perm:t};return s.dtype==="complex64"?Ue(()=>{let o=eb(s),u=R3(s);return o=Te.runKernel(Qf,{x:o},a),u=Te.runKernel(Qf,{x:u},a),n&&(u=Wr(u)),xd(o,u)}):Te.runKernel(Qf,i,a)}const _n=$e({transpose_:rue});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(r,t){const n=r.length,s=[];for(let i=0;i<n;i++){const a=n-1-i,o=r[a]||1;(t[t.length-1-i]||1)>1&&o===1&&s.unshift(a)}return s}function ss(r,t){const n=[];for(let s=0;s<t.length;s++){const i=r[r.length-s-1],a=t.length-s-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function nn(r,t){const n=[],s=Math.max(r.length,t.length);for(let i=0;i<s;i++){let a=r[r.length-i-1];a==null&&(a=1);let o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){const u=`Operands could not be broadcast together with shapes ${r} and ${t}.`;throw Error(u)}else n.unshift(a)}return n}function O3(r,t){const n=r.shape.length,s=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${n}`);if(Je(r.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${r.shape}.`);const i=t.shape,a=i[i.length-1];let o=1;for(let f=0;f<i.length-1;++f)o*=i[f];const u=r.shape,l=i.slice();l.pop();let c=1;for(let f=a;f<n;++f)c*=u[f],l.push(u[f]);const h=[...Mt(r.shape).map(f=>f/c),1].slice(0,a);return[l,o,c,h]}function p7(r,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${r}, sliceDim: ${s}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(r.length<s+(n.rank-i))throw new Error(a+` Output shape length < ${s+(n.rank-i)}`);if(n.rank!==i+r.length-s)throw new Error(a+` update.rank != ${i+r.length-s}`);for(let o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==r[o+s])throw new Error(a+` updates.shape[${o+i}] (${n.shape[o+i]}) != shape[${o+i}] (${r[o+i]})`)}function sue(r,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}p7(n,t,r)}function k0(r,t,n){const s=t.shape.length,i=s>1?t.shape[s-1]:1,a=n.length;let o=1;for(let f=i;f<a;++f)o*=n[f];const u=i<1?1:i,l=Je(t.shape)/u,c=[...Mt(n.slice(0,i)),1],h=Je(n);return{sliceRank:i,numUpdates:l,sliceSize:o,strides:c,outputSize:h}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UE=-2,iue=-1;function M3(r,t,n){const s=r.shape.length;oe(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),oe(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let i=0;i<s;++i)oe(t[i]+n[i]<=r.shape[i],()=>`Error in slice${s}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${r.shape[i]})`)}function aue(r){const t=[];let n=0;for(;r>0;)r&1&&t.push(n),r/=2,n++;return t}function L3(r,t,n){const s=[];for(let i=0;i<r.length;i++)s[i]=Math.ceil((t[i]-r[i])/n[i]);return s}function m7(r,t,n,s){const i=[...r];for(let a=i.length;a<s.length;a++)i.push(1);for(let a=0;a<n;a++)a===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function g7(r,t,n){return n<=r?n:n-(t-1)}function y7(r,t){const n=[];for(let s=0;s<r;s++)n.push(t+s);return n}function oue(r,t,n,s,i,a,o,u,l){const c=r.length;let h=new Array(c),f=new Array(c),p=new Array(c);if(t.length&&n>0){const g=t[0],y=n+1;h=x7(o,g,y,s,r),f=b7(u,g,y,i,r),p=m7(a,g,y,r)}else for(let g=0;g<c;g++)h[g]=w7(o,s,a,r,g,l),f[g]=S7(u,i,a,r,g,l),p[g]=v7(a,g,l);return{begin:h,end:f,strides:p}}function x7(r,t,n,s,i){const a=[...i],o=y7(n,t);for(let u=0;u<a.length;u++)if(o.indexOf(u)>-1)a[u]=0;else{const l=g7(t,n,u);let c=s[l];r&1<<l&&(c=0),a[u]=c}return a}function b7(r,t,n,s,i){const a=[...i],o=y7(n,t);for(let u=0;u<a.length;u++)if(o.indexOf(u)>-1)a[u]=Number.MAX_SAFE_INTEGER;else{const l=g7(t,n,u);let c=s[l];r&1<<l&&(c=Number.MAX_SAFE_INTEGER),a[u]=c}for(let u=0;u<a.length;u++){const l=i[u];a[u]<0&&(a[u]+=l),a[u]=nh(0,a[u],i[u])}return a}function v7(r,t,n){let s=r[t];return(n&1<<t||s==null)&&(s=1),s}function w7(r,t,n,s,i,a){let o=t[i];const u=n[i]||1;(r&1<<i||a&1<<i||o==null)&&(u>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=s[i];return o<0&&(o+=l),o=nh(0,o,l-1),o}function S7(r,t,n,s,i,a){let o=t[i];const u=n[i]||1;(r&1<<i||a&1<<i||o==null)&&(u>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=s[i];return o<0&&(o+=l),u>0?o=nh(0,o,l):o=nh(-1,o,l-1),o}function B3(r,t,n){let s=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){s=i;break}for(let i=s+1;i<n.length;i++)if(t[i]>0||n[i]!==r[i])return!1;return!0}function P3(r,t){let n=r.length>0?r[r.length-1]:1;for(let s=0;s<r.length-1;s++)n+=r[s]*t[s];return n}function w2(r,t,n){let s;const i=r.shape.length;typeof t=="number"?s=[t,...new Array(i-1).fill(0)]:t.length<i?s=t.concat(new Array(i-t.length).fill(0)):s=t.slice(),s.forEach(o=>{oe(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(i).fill(-1):typeof n=="number"?a=[n,...new Array(i-1).fill(-1)]:n.length<i?a=n.concat(new Array(i-n.length).fill(-1)):a=n,a=a.map((o,u)=>o>=0?o:(oe(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${u}.`),r.shape[u]-s[u])),[s,a]}function V3(r,t,n,s,i,a,o,u,l){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,o!=null&&(o&o-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:u,shrinkAxisMask:l};for(let E=0;E<f.dims;E++)h&&(1<<E&u)!==0&&f.numAddAxisAfterEllipsis++,1<<E&o&&(h=!0);h||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:r.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};uue(f,p);let g=!0,y=!0,x=!0;const v=[],S=[];for(let E=0;E<r.length;++E){if(p.strides[E]===0)throw Error(`strides[${E}] must be non-zero`);const _=!!(p.shrinkAxisMask&1<<E),D=r[E];if(D===-1){v.push(_?1:-1);continue}const I=[p.beginMask&1<<E,p.endMask&1<<E],k=[p.strides[E]>0?0:-1,p.strides[E]>0?D:D-1];if(_&&p.strides[E]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&p.strides[E]===1;const A=!!(p.beginMask&1<<E&&p.endMask&1<<E);if(p.beginValid&&p.endValid){if(_){const O=p.begin[E]<0?D+p.begin[E]:p.begin[E];if(p.begin[E]=O,p.end[E]=p.begin[E]+1,O<0||O>=D)throw Error(`slice index ${p.begin[E]} of dimension ${E} out of bounds.`)}else p.begin[E]=AO(p.begin[E],0,p.strides[E],D,I,k),p.end[E]=AO(p.end[E],1,p.strides[E],D,I,k);const $=p.strides[E]===1&&p.begin[E]===0&&p.end[E]===D;g=g&&$,y=y&&(E===0&&p.strides[E]===1||$)}else g=g&&p.strides[E]===1&&A,y=y&&(E===0&&p.strides[E]===1||A);let N,F=!1;if(p.beginValid&&p.endValid?(N=p.end[E]-p.begin[E],F=!0):_?(N=1,F=!0):A&&D>=0&&(p.strides[E]<0?N=-D:N=D,F=!0),F){let $;N===0||N<0!=p.strides[E]<0?$=0:$=Math.trunc(N/p.strides[E])+(N%p.strides[E]!==0?1:0),v.push($)}else v.push(-1)}for(let E=0;E<p.finalShapeGatherIndices.length;++E){const _=p.finalShapeGatherIndices[E];_>=0?S.push(v[_]):_===UE&&S.push(1)}return{finalShapeSparse:S.filter((E,_)=>p.finalShapeGatherIndices[_]!==UE),finalShape:S,isIdentity:g,sliceDim0:y,isSimpleSlice:x,begin:p.begin,end:p.end,strides:p.strides}}function uue(r,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=r.begin!=null,t.endValid=r.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<r.dims;s++)if(1<<s&r.ellipsisMask){const i=Math.min(t.dims-(r.dims-s)+1+r.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&r.newAxisMask)t.finalShapeGatherIndices.push(UE),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);r.begin!=null&&(t.begin[n]=r.begin[s]),r.end!=null&&(t.end[n]=r.end[s]),t.strides[n]=r.strides[s],r.beginMask&1<<s&&(t.beginMask|=1<<n),r.endMask&1<<s&&(t.endMask|=1<<n),r.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(iue),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[n]=s,n++}}function AO(r,t,n,s,i,a){if(i[t])return n>0?a[t]:a[t+1&1];{const o=r<0?s+r:r;return o<a[0]?a[0]:o>a[1]?a[1]:o}}const lue=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:M3,computeFlatOffset:P3,computeOutShape:L3,getNormalizedAxes:oue,isSliceContinous:B3,maskToAxes:aue,parseSliceParams:w2,sliceInfo:V3,startForAxis:w7,startIndicesWithElidedDims:x7,stopForAxis:S7,stopIndicesWithElidedDims:b7,stridesForAxis:v7,stridesWithElidedDims:m7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gd{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Ea{constructor(){this.classNameMap={}}static getMap(){return Ea.instance==null&&(Ea.instance=new Ea),Ea.instance}static register(t){Ea.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function at(r){oe(r.className!=null,()=>"Class being registered does not have the static className property defined."),oe(typeof r.className=="string",()=>"className is required to be a string, but got type "+typeof r.className),oe(r.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Ea.register(r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(r,t){let n=me(r,"a","add"),s=me(t,"b","add");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(Ud,i)}const pt=$e({add_:cue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(r,t){let n=me(r,"a","floorDiv"),s=me(t,"b","floorDiv");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(Zg,i)}const C7=$e({floorDiv_:hue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(r,t){let n=me(r,"a","div"),s=me(t,"b","div");if([n,s]=Rr(n,s),n.dtype==="int32"&&s.dtype==="int32")return C7(n,s);const i={a:n,b:s},a={};return Te.runKernel(Wg,i,a)}const Ut=$e({div_:fue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function due(r,t){let n=me(r,"a","mul"),s=me(t,"b","mul");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(u0,i)}const De=$e({mul_:due});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(r){const t=me(r,"x","abs");if(t.dtype==="complex64"){const n={x:t};return Te.runKernel(Ev,n)}else{const n={x:t};return Te.runKernel(xv,n)}}const Xs=$e({abs_:pue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mue(r){const n={x:me(r,"x","acos")};return Te.runKernel(Fg,n)}const gue=$e({acos_:mue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(r){const n={x:me(r,"x","acosh")};return Te.runKernel(Rg,n)}const xue=$e({acosh_:yue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bue(r,t=null,n=!1){const i={x:me(r,"x","all","bool")},a={axis:t,keepDims:n};return Te.runKernel(XT,i,a)}const _7=$e({all_:bue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(r,t=null,n=!1){const i={x:me(r,"x","any","bool")},a={axis:t,keepDims:n};return Te.runKernel(YT,i,a)}const GE=$e({any_:vue});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(r,t=0){const s={x:me(r,"x","argMax")},i={axis:t};return Te.runKernel(bv,s,i)}const hg=$e({argMax_:wue});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(r,t=0){const s={x:me(r,"x","argMin")},i={axis:t};return Te.runKernel(vv,s,i)}const Cue=$e({argMin_:Sue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(r){const n={x:me(r,"x","asin")};return Te.runKernel(Og,n)}const Eue=$e({asin_:_ue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Due(r){const n={x:me(r,"x","asinh")};return Te.runKernel(Mg,n)}const Tue=$e({asinh_:Due});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(r){const n={x:me(r,"x","atan")};return Te.runKernel(Lg,n)}const kue=$e({atan_:Nue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(r,t){let n=me(r,"a","atan2"),s=me(t,"b","atan2");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(Pg,i)}const Iue=$e({atan2_:Aue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(r){const n={x:me(r,"x","atanh")};return Te.runKernel(Bg,n)}const Fue=$e({atanh_:$ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0(r,t,n,s,i="NHWC",a){const o=r[3],u=[...t,o],l=$u(i);return Is(r,u,n,a,s,null,null,l)}function Ra(r,t,n,s,i,a,o="channelsLast"){const[u,l]=tb(t);let c;if(o==="channelsLast")c=[u,l,r[3],r[3]];else if(o==="channelsFirst")c=[u,l,r[1],r[1]];else throw new Error(`Unknown dataFormat ${o}`);return Is(r,c,n,s,i,a,!1,o)}function Iu(r,t,n,s,i,a,o="NDHWC"){const[u,l,c]=jE(t);let h,f;if(o==="NDHWC")f="channelsLast",h=[u,l,c,r[4],r[4]];else if(o==="NCDHW")f="channelsFirst",h=[u,l,c,r[1],r[1]];else throw new Error(`Unknown dataFormat ${o}`);return Gl(r,h,n,s,i,!1,f,a)}function Is(r,t,n,s,i,a,o=!1,u="channelsLast"){let[l,c,h,f]=[-1,-1,-1,-1];if(u==="channelsLast")[l,c,h,f]=r;else if(u==="channelsFirst")[l,f,c,h]=r;else throw new Error(`Unknown dataFormat ${u}`);const[p,g,,y]=t,[x,v]=tb(n),[S,w]=tb(s),E=Jf(p,S),_=Jf(g,w),{padInfo:D,outHeight:I,outWidth:k}=Mue(i,c,h,x,v,E,_,a,u),A=o?y*f:y;let N;return u==="channelsFirst"?N=[l,A,I,k]:u==="channelsLast"&&(N=[l,I,k,A]),{batchSize:l,dataFormat:u,inHeight:c,inWidth:h,inChannels:f,outHeight:I,outWidth:k,outChannels:A,padInfo:D,strideHeight:x,strideWidth:v,filterHeight:p,filterWidth:g,effectiveFilterHeight:E,effectiveFilterWidth:_,dilationHeight:S,dilationWidth:w,inShape:r,outShape:N,filterShape:t}}function Gl(r,t,n,s,i,a=!1,o="channelsLast",u){let[l,c,h,f,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,c,h,f,p]=r;else if(o==="channelsFirst")[l,p,c,h,f]=r;else throw new Error(`Unknown dataFormat ${o}`);const[g,y,x,,v]=t,[S,w,E]=jE(n),[_,D,I]=jE(s),k=Jf(g,_),A=Jf(y,D),N=Jf(x,I),{padInfo:F,outDepth:$,outHeight:O,outWidth:M}=Lue(i,c,h,f,S,w,E,k,A,N,u),B=a?v*p:v;let U;return o==="channelsFirst"?U=[l,B,$,O,M]:o==="channelsLast"&&(U=[l,$,O,M,B]),{batchSize:l,dataFormat:o,inDepth:c,inHeight:h,inWidth:f,inChannels:p,outDepth:$,outHeight:O,outWidth:M,outChannels:B,padInfo:F,strideDepth:S,strideHeight:w,strideWidth:E,filterDepth:g,filterHeight:y,filterWidth:x,effectiveFilterDepth:k,effectiveFilterHeight:A,effectiveFilterWidth:N,dilationDepth:_,dilationHeight:D,dilationWidth:I,inShape:r,outShape:U,filterShape:t}}function Rue(r,t,n,s,i){s==null&&(s=z3(r,t,n));const a=r[0],o=r[1],u=Lc((a-t+2*s)/n+1,i),l=Lc((o-t+2*s)/n+1,i);return[u,l]}function Oue(r,t,n,s,i,a){i==null&&(i=z3(r,t,s));const o=r[0],u=r[1],l=r[2],c=Lc((o-t+2*i)/s+1,a),h=Lc((u-t+2*i)/s+1,a),f=Lc((l-t+2*i)/s+1,a);return[c,h,f,n]}function z3(r,t,n,s=1){const i=Jf(t,s);return Math.floor((r[0]*(n-1)-n+i)/2)}function tb(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function jE(r){return typeof r=="number"?[r,r,r]:r}function Jf(r,t){return t<=1?r:r+(r-1)*(t-1)}function Mue(r,t,n,s,i,a,o,u,l){let c,h,f;if(typeof r=="number"){c={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const g=Rue([t,n],a,s,r,u);h=g[0],f=g[1]}else if(r==="same"){h=Math.ceil(t/s),f=Math.ceil(n/i);const p=Math.max(0,(h-1)*s+a-t),g=Math.max(0,(f-1)*i+o-n),y=Math.floor(p/2),x=p-y,v=Math.floor(g/2),S=g-v;c={top:y,bottom:x,left:v,right:S,type:"SAME"}}else if(r==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((t-a+1)/s),f=Math.ceil((n-o+1)/i);else if(typeof r=="object"){const p=l==="channelsLast"?r[1][0]:r[2][0],g=l==="channelsLast"?r[1][1]:r[2][1],y=l==="channelsLast"?r[2][0]:r[3][0],x=l==="channelsLast"?r[2][1]:r[3][1];c={top:p,bottom:g,left:y,right:x,type:p===0&&g===0&&y===0&&x===0?"VALID":"EXPLICIT"},h=Lc((t-a+p+g)/s+1,u),f=Lc((n-o+y+x)/i+1,u)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:c,outHeight:h,outWidth:f}}function Lue(r,t,n,s,i,a,o,u,l,c,h){let f,p,g,y;if(typeof r=="number"){f={top:r,bottom:r,left:r,right:r,front:r,back:r,type:r===0?"VALID":"NUMBER"};const v=Oue([t,n,s,1],u,1,i,r,h);p=v[0],g=v[1],y=v[2]}else if(r==="same"){p=Math.ceil(t/i),g=Math.ceil(n/a),y=Math.ceil(s/o);const x=(p-1)*i+u-t,v=(g-1)*a+l-n,S=(y-1)*o+c-s,w=Math.floor(x/2),E=x-w,_=Math.floor(v/2),D=v-_,I=Math.floor(S/2),k=S-I;f={top:_,bottom:D,left:I,right:k,front:w,back:E,type:"SAME"}}else if(r==="valid")f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-u+1)/i),g=Math.ceil((n-l+1)/a),y=Math.ceil((s-c+1)/o);else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:f,outDepth:p,outHeight:g,outWidth:y}}function Lc(r,t){if(!t)return Math.trunc(r);switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${t}`)}}function ih(r){const[t,n,s]=tb(r);return t===1&&n===1&&s===1}function Gs(r,t){return ih(r)||ih(t)}function $u(r){if(r==="NHWC")return"channelsLast";if(r==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${r}`)}function mi(r,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${r}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")oe(yd(t),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(i=>{oe(yd(i),()=>`Error in ${r}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${r}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(r,t){const s={x:me(r,"x","reshape","string_or_numeric")},i={shape:t};return Te.runKernel(i2,s,i)}const ke=$e({reshape_:Bue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(r,t,n,s,i){const a=me(r,"x","avgPool","float32"),o=1;oe(Gs(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let u=a,l=!1;a.rank===3&&(l=!0,u=ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),oe(u.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${u.rank}.`),mi("avgPool",s,i);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i};let f=Te.runKernel(wv,c,h);return f=_t(f,a.dtype),l?ke(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const U3=$e({avgPool_:Pue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(r,t,n,s,i,a="NDHWC"){const o=me(r,"x","avgPool3d","float32");let u=o,l=!1;o.rank===4&&(l=!0,u=ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),oe(u.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${u.rank}.`),oe(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),mi("avgPool3d",s,i);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i,dataFormat:a};let f=Te.runKernel(Sv,c,h);return f=_t(f,u.dtype),l?ke(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const zue=$e({avgPool3d_:Vue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(r,t=0){oe(r.length>=1,()=>"Pass at least one tensor to concat");const n=s7(r,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Mc(n[0]);const s=n,i={axis:t};return Te.runKernel(Dv,s,i)}const fi=$e({concat_:Uue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(r){const n={x:me(r,"x","sigmoid","float32")};return Te.runKernel(b0,n)}const jd=$e({sigmoid_:Gue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(r,t,n){const s=me(r,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const i={x:s},a={begin:t,size:n};return Te.runKernel(c2,i,a)}const or=$e({slice_:jue});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(r){const n={x:me(r,"x","tanh","float32")};return Te.runKernel(E0,n)}const G3=$e({tanh_:Wue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hue(r,t,n){const s=me(r,"x","batchToSpaceND"),i=t.reduce((u,l)=>u*l);oe(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),oe(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),oe(s.shape[0]%i===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const a={x:s},o={blockShape:t,crops:n};return Te.runKernel(_v,a,o)}const j3=$e({batchToSpaceND_:Hue});function que(r){let t;return r.rank===0||r.rank===1?t=ke(r,[1,1,1,r.size]):r.rank===2?t=ke(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?t=ke(r,[1,r.shape[0],r.shape[1],r.shape[2]]):t=r,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(r,t,n,s,i,a){a==null&&(a=.001);const o=me(r,"x","batchNorm"),u=me(t,"mean","batchNorm"),l=me(n,"variance","batchNorm");let c;i!=null&&(c=me(i,"scale","batchNorm"));let h;s!=null&&(h=me(s,"offset","batchNorm")),oe(u.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),oe(h==null||u.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),oe(c==null||u.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:que(o),scale:c,offset:h,mean:u,variance:l},g={varianceEpsilon:a},y=Te.runKernel(Ov,p,g);return ke(y,o.shape)}const S2=$e({batchNorm_:Kue});function Xue(r,t,n,s,i,a){const o=me(r,"x","batchNorm"),u=me(t,"mean","batchNorm"),l=me(n,"variance","batchNorm");let c;i!=null&&(c=me(i,"scale","batchNorm"));let h;return s!=null&&(h=me(s,"offset","batchNorm")),oe(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),oe(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${u.rank}.`),oe(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&oe(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),h!=null&&oe(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),S2(o,u,l,h,c,a)}const Yue=$e({batchNorm2d_:Xue});function Zue(r,t,n,s,i,a){const o=me(r,"x","batchNorm"),u=me(t,"mean","batchNorm"),l=me(n,"variance","batchNorm");let c;i!=null&&(c=me(i,"scale","batchNorm"));let h;return s!=null&&(h=me(s,"offset","batchNorm")),oe(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),oe(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${u.rank}.`),oe(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&oe(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),h!=null&&oe(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),S2(o,u,l,h,c,a)}const Que=$e({batchNorm3d_:Zue});function Jue(r,t,n,s,i,a){const o=me(r,"x","batchNorm"),u=me(t,"mean","batchNorm"),l=me(n,"variance","batchNorm");let c;i!=null&&(c=me(i,"scale","batchNorm"));let h;return s!=null&&(h=me(s,"offset","batchNorm")),oe(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),oe(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${u.rank}.`),oe(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&oe(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),h!=null&&oe(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),S2(o,u,l,h,c,a)}const ele=$e({batchNorm4d_:Jue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(r,t,n){const s=me(r,"x","bincount"),i=me(t,"weights","bincount");oe(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),oe(n>=0,()=>`size must be non-negative, but got ${n}.`),oe(i.size===s.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${i.shape}.`);const a={x:s,weights:i},o={size:n};return Te.runKernel(JT,a,o)}const nle=$e({bincount_:tle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rle(r,t){let n=me(r,"broadcastTo","x");const s=n.shape;if(t.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=ke(n,c)}const i=n.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(i[c]===t[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(a.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return Mc(n);const u={x:n},l={reps:a};return Te.runKernel(D0,u,l)}const Lm=$e({broadcastTo_:rle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sle(r){const n={x:me(r,"x","ceil","float32")};return Te.runKernel(zg,n)}const ile=$e({ceil_:sle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2(r,t,n){const s={shape:r,value:t,dtype:n};return Te.runKernel(h3,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ale(r,t,n){const s=me(r,"x","clipByValue");if(oe(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return C2(s.shape,t,s.dtype);const i={x:s},a={clipValueMin:t,clipValueMax:n};return Te.runKernel(Ug,i,a)}const Qi=$e({clipByValue_:ale});function ole(r){return fi(r,0)}const ule=$e({concat1d_:ole});function lle(r,t){return fi(r,t)}const cle=$e({concat2d_:lle});function hle(r,t){return fi(r,t)}const fle=$e({concat3d_:hle});function dle(r,t){return fi(r,t)}const ple=$e({concat4d_:dle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mle(r,t,n,s,i="NHWC",a=[1,1],o){const u=me(r,"x","conv2d","float32"),l=me(t,"filter","conv2d","float32");let c=u,h=!1;u.rank===3&&(h=!0,c=ke(u,[1,u.shape[0],u.shape[1],u.shape[2]])),oe(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),oe(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),mi("conv2d",s,o);const f=i==="NHWC"?c.shape[3]:c.shape[1];oe(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),oe(Gs(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const p={x:c,filter:l},g={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o},y=Te.runKernel(Tv,p,g);return h?ke(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const ah=$e({conv2d_:mle});function gle(r,t,n,s,i="NWC",a=1,o){const u=me(r,"x","conv1d"),l=me(t,"filter","conv1d");let c=u,h=!1;u.rank===2&&(h=!0,c=ke(u,[1,u.shape[0],u.shape[1]])),oe(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),oe(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),mi("conv1d",s,o),oe(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),oe(Gs(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),oe(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=ke(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=ke(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=ah(p,f,[1,n],s,"NHWC",[1,a],o);return h?ke(v,[v.shape[2],v.shape[3]]):ke(v,[v.shape[0],v.shape[2],v.shape[3]])}const E7=$e({conv1d_:gle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(r,t,n,s,i,a="NHWC",o){oe(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let u=r,l=t,c=!1;t.rank===3&&(c=!0,l=ke(t,[1,t.shape[0],t.shape[1],t.shape[2]]),u=[1,r[0],r[1],r[2]]),oe(u.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${u.length}.`),oe(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),oe(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const h=a==="NHWC"?u[3]:u[1],f=a==="NHWC"?l.shape[3]:l.shape[1];oe(h===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[2]}.`),oe(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),mi("conv2dDerInput",i,o);const p={dy:l,filter:n},g={strides:s,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:u},y=Te.runKernel(Nv,p,g);return c?ke(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const W3=$e({conv2DBackpropInput_:yle});function xle(r,t,n,s,i,a){const o=me(r,"x","conv2dTranspose"),u=me(t,"filter","conv2dTranspose");return W3(n,o,u,s,i,"NHWC",a)}const D7=$e({conv2dTranspose_:xle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(r,t,n,s,i="NDHWC",a=[1,1,1]){const o=me(r,"x","conv3d"),u=me(t,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),oe(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),oe(u.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${u.rank}.`),oe(l.shape[4]===u.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${u.shape[3]}.`),oe(Gs(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),oe(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`);const h={x:l,filter:u},f={strides:n,pad:s,dataFormat:i,dilations:a},p=Te.runKernel(kv,h,f);return c?ke(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const vle=$e({conv3d_:ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(r,t,n,s,i){oe(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let a=r,o=t,u=!1;t.rank===4&&(u=!0,o=ke(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,r[0],r[1],r[2],r[3]]);const l=a[4],c=o.shape[4];oe(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),oe(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),oe(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),oe(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),oe(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const h={dy:o,filter:n},f={pad:i,strides:s,inputShape:a},p=Te.runKernel(r3,h,f);return u?ke(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const T7=$e({conv3DBackpropInput_:wle});function Sle(r,t,n,s,i){const a=me(r,"x","conv3dTranspose"),o=me(t,"filter","conv3dTranspose");return T7(n,a,o,s,i)}const Cle=$e({conv3dTranspose_:Sle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _le(r){const n={x:me(r,"x","cos","float32")};return Te.runKernel(Gg,n)}const H3=$e({cos_:_le});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(r){const n={x:me(r,"x","cosh","float32")};return Te.runKernel(jg,n)}const N7=$e({cosh_:Ele});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(r,t=0,n=!1,s=!1){const a={x:me(r,"x","cumprod")},o={axis:t,exclusive:n,reverse:s};return Te.runKernel(s3,a,o)}const WE=$e({cumprod_:Dle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tle(r,t=0,n=!1,s=!1){const a={x:me(r,"x","cumsum")},o={axis:t,exclusive:n,reverse:s};return Te.runKernel(Av,a,o)}const k7=$e({cumsum_:Tle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(r,t,n="NHWC"){const s=me(r,"x","depthToSpace","float32"),i=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];oe(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),oe(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${s.shape}`),oe(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${s.shape}`),oe(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${s.shape}`);const u={x:s},l={blockSize:t,dataFormat:n};return Te.runKernel(a3,u,l)}const kle=$e({depthToSpace_:Nle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(r,t,n,s,i="NHWC",a=[1,1],o){const u=me(r,"x","depthwiseConv2d","float32"),l=me(t,"filter","depthwiseConv2d","float32");let c=u,h=!1;u.rank===3&&(h=!0,c=ke(u,[1,u.shape[0],u.shape[1],u.shape[2]])),oe(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),oe(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=i==="NHWC"?c.shape[3]:c.shape[1];oe(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),mi("depthwiseConv2d",s,o);const p={x:c,filter:l},g={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o},y=Te.runKernel(Iv,p,g);return h?ke(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const q3=$e({depthwiseConv2d_:Ale});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(r,t,n,s,i=[1,1],a="NHWC"){const o=me(r,"x","dilation2d"),u=me(t,"filter","dilation2d");oe(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),oe(u.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${u.rank}.`),oe(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=o,c=!1;o.rank===3&&(l=ke(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);const h={x:l,filter:u},f={strides:n,pad:s,dilations:i},p=Te.runKernel($v,h,f);return c?ke(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const $le=$e({dilation2d_:Ile});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(r,t){let n=me(r,"a","equal","string_or_numeric"),s=me(t,"b","equal","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Fv,i)}const $o=$e({equal_:Fle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rle(r,t,n){const s=me(t,"a","where"),i=me(n,"b","where"),a=me(r,"condition","where","bool"),o=nn(nn(a.shape,s.shape),i.shape),u=Lm(a,o),l=Lm(s,o),c=Lm(i,o),h={condition:u,t:l,e:c};return Te.runKernel(l2,h)}const Ri=$e({where_:Rle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ole(r){const n={x:me(r,"x","zerosLike")};return Te.runKernel(y2,n)}const Nn=$e({zerosLike_:Ole});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(r,t){let n=me(r,"a","div"),s=me(t,"b","div");[n,s]=Rr(n,s);const i=Ut(n,s),a=Nn(i),o=$o(s,a);return Ri(o,a,i)}const Lle=$e({divNoNan_:Mle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(r,t){const n=me(r,"t1","dot"),s=me(t,"t2","dot");oe((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const i=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(oe(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),n.rank===1&&s.rank===1){const o=ke(n,[1,-1]),u=ke(s,[-1,1]),l=On(o,u);return ke(l,[])}else if(n.rank===1&&s.rank===2){const o=ke(n,[1,-1]),u=ke(s,[s.shape[0],s.shape[1]]),l=On(o,u);return ke(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=ke(s,[-1,1]),u=On(n,o);return ke(u,[u.size])}else{const o=ke(s,[s.shape[0],s.shape[1]]);return On(n,o)}}const Ple=$e({dot_:Ble});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(r){const n={x:me(r,"x","elu","float32")};return Te.runKernel(Hg,n)}const _2=$e({elu_:Vle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(r){let t=me(r,"x","erf");oe(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=_t(t,"float32"));const n={x:t};return Te.runKernel(qg,n)}const Ule=$e({erf_:zle});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(r,t){for(let n=0;n<r.length;++n)if(r[r.length-n-1]!==t-1-n)return!1;return!0}function A7(r,t,n){const s=r.length+t.length,i=[];let a=0,o=0;for(let u=0;u<s;u++)n.indexOf(u)===-1?i.push(r[a++]):i.push(t[o++]);return i}function bs(r,t){const n=[],s=r.length;for(let a=0;a<s;a++)t.indexOf(a)===-1&&n.push(r[a]);const i=t.map(a=>r[a]);return[n,i]}function Hr(r,t){const n=t.map(s=>1);return A7(r,n,t)}function $s(r,t,n){oe(K3(t,n),()=>`${r} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function Dr(r,t){if(K3(r,t))return null;const n=[];for(let s=0;s<t;++s)r.indexOf(s)===-1&&n.push(s);return r.forEach(s=>n.push(s)),n}function jl(r){return r.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function Mr(r,t){const n=[];for(let s=t-r;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gle(r,t=null,n=!1){const i={x:me(r,"x","max")},a={reductionIndices:t,keepDims:n};return Te.runKernel(Wv,i,a)}const Do=$e({max_:Gle});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(r,t=null,n=!1){const i={x:me(r,"x","min")},a={axis:t,keepDims:n};return Te.runKernel(Xv,i,a)}const HE=$e({min_:jle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wle(r,t){let n=me(r,"base","pow"),s=me(t,"exp","pow");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(l0,i)}const vd=$e({pow_:Wle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ln(r,t){if((Ao(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Ao(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return v2(r,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(r){const n={x:me(r,"x","sqrt","float32")};return Te.runKernel(w0,n)}const ei=$e({sqrt_:Hle});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qle(r){const t=me(r,"x","square"),n={};return Te.runKernel("Square",{x:t},n)}const gr=$e({square_:qle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(r,t=null,n=!1){let s=me(r,"x","sum");s.dtype==="bool"&&(s=_t(s,"int32"));const i={x:s},a={axis:t,keepDims:n};return Te.runKernel(h2,i,a)}const Vt=$e({sum_:Kle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xle(r,t="euclidean",n=null,s=!1){r=me(r,"x","norm");const i=I7(r,t,n);let a=i.shape;if(s){const o=dn(n,r.shape);a=Hr(i.shape,o)}return ke(i,a)}function I7(r,t,n=null){if(r.rank===0)return Xs(r);if(r.rank!==1&&n===null)return I7(ke(r,[-1]),t,n);if(r.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Vt(Xs(r),n);if(t===1/0)return Do(Xs(r),n);if(t===-1/0)return HE(Xs(r),n);if(t==="euclidean"||t===2)return ei(Vt(vd(Xs(r),Ln(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return Do(Vt(Xs(r),n[0]),n[1]-1);if(t===1/0)return Do(Vt(Xs(r),n[1]),n[0]);if(t===-1/0)return HE(Vt(Xs(r),n[1]),n[0]);if(t==="fro"||t==="euclidean")return ei(Vt(gr(r),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const E2=$e({norm_:Xle});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yle(r,t=null,n=!1){return E2(r,"euclidean",t,n)}const Zle=$e({euclideanNorm_:Yle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(r){const n={x:me(r,"x","exp")};return Te.runKernel(Kg,n)}const Cu=$e({exp_:Qle});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jle(r,t=0){const n=me(r,"x","expandDims","string_or_numeric");oe(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},i={dim:t};return Te.runKernel(Rv,s,i)}const Sa=$e({expandDims_:Jle});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(r){const n={x:me(r,"x","expm1")};return Te.runKernel(Xg,n)}const tce=$e({expm1_:ece});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nce(r,t){const n=me(r,"x","tile","string_or_numeric");oe(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},i={reps:t};return Te.runKernel(D0,s,i)}const Za=$e({tile_:nce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(r,t,n,s="float32"){t==null&&(t=r);const i=hn([r,t],s),a=r<=t?r:t;for(let u=0;u<a;++u)i.set(1,u,u);const o=ke(i.toTensor(),[r,t]);if(n==null)return o;if(n.length===1)return Za(Sa(o,0),[n[0],1,1]);if(n.length===2)return Za(Sa(Sa(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Za(Sa(Sa(Sa(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const $7=$e({eye_:rce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sce(r){const n={x:me(r,"x","floor","float32")};return Te.runKernel(Yg,n)}const D2=$e({floor_:sce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(r,t,n=0,s=0){const i=me(r,"x","gather"),a=me(t,"indices","gather","int32"),o={x:i,indices:a},u={axis:n,batchDims:s};return Te.runKernel(Mv,o,u)}const X3=$e({gather_:ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(r,t){let n=me(r,"a","greater","string_or_numeric"),s=me(t,"b","greater","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Lv,i)}const Oa=$e({greater_:ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce(r,t){let n=me(r,"a","greaterEqual","string_or_numeric"),s=me(t,"b","greaterEqual","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Qg,i)}const Wd=$e({greaterEqual_:oce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(r){const n={x:me(r,"x","isFinite")};return Te.runKernel(e0,n)}const lce=$e({isFinite_:uce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(r){const n={x:me(r,"x","isInf")};return Te.runKernel(t0,n)}const hce=$e({isInf_:cce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fce(r){const n={x:me(r,"x","isNaN")};return Te.runKernel(n0,n)}const dce=$e({isNaN_:fce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(r,t=.2){const s={x:me(r,"x","leakyRelu")},i={alpha:t};return Te.runKernel(Bv,s,i)}const Y3=$e({leakyRelu_:pce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(r,t){let n=me(r,"a","less","string_or_numeric"),s=me(t,"b","less","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Pv,i)}const F7=$e({less_:mce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(r,t){let n=me(r,"a","lessEqual","string_or_numeric"),s=me(t,"b","lessEqual","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Vv,i)}const Hd=$e({lessEqual_:gce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(r,t=5,n=1,s=1,i=.5){const a=me(r,"x","localResponseNormalization");oe(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),oe(yd(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=a,u=!1;a.rank===3&&(u=!0,o=ke(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:o},c={depthRadius:t,bias:n,alpha:s,beta:i},h=Te.runKernel(jv,l,c);return u?ke(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const xce=$e({localResponseNormalization_:yce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(r){const n={x:me(r,"x","log","float32")};return Te.runKernel(r0,n)}const Fo=$e({log_:bce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(r){const n={x:me(r,"x","log1p")};return Te.runKernel(s0,n)}const R7=$e({log1p_:vce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wce(r,t){oe(NE(r),()=>"The f passed in variableGrads(f) must be a function"),oe(t==null||Array.isArray(t)&&t.every(c=>c instanceof Jx),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in Te.registeredVariables)t.push(Te.registeredVariables[c])}const s=n?t.filter(c=>!c.trainable):null,i=t.length;t=t.filter(c=>c.trainable),oe(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const a=!0,{value:o,grads:u}=Te.gradients(r,t,null,a);oe(u.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),oe(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return t.forEach((c,h)=>{u[h]!=null&&(l[c.name]=u[h])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:o,grads:l}}function wd(r){return Te.customGrad(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(r){const n={x:me(r,"x","softplus")};return Te.runKernel(v0,n)}const I0=$e({softplus_:Sce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(r){const t=me(r,"x","logSigmoid");return wd(s=>({value:Wr(I0(Wr(s))),gradFunc:o=>De(o,jd(Wr(s)))}))(t)}const _ce=$e({logSigmoid_:Cce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ece(r,t){let n=me(r,"a","sub"),s=me(t,"b","sub");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(C0,i)}const Kt=$e({sub_:Ece});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dce(r,t=-1){const n=me(r,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return wd((i,a)=>{const u=Do(i,t,!0),l=Kt(i,u),c=Kt(_t(l,"float32"),Fo(Vt(Cu(l),t,!0)));return a([c]),{value:c,gradFunc:(f,p)=>{const[g]=p,y=!0,x=Cu(g);return Kt(f,De(Vt(f,t,y),x))}}})(n)}const O7=$e({logSoftmax_:Dce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(r,t=null,n=!1){const s=me(r,"x","logSumExp"),i=dn(t,s.shape),a=Do(s,i,!0),o=Kt(s,a),u=Cu(o),l=Vt(u,i),c=Fo(l),h=pt(ke(a,c.shape),c);if(n){const f=Hr(h.shape,i);return ke(h,f)}return h}const Nce=$e({logSumExp_:Tce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(r,t){const n=me(r,"a","logicalAnd","bool"),s=me(t,"b","logicalAnd","bool");nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(zv,i)}const _u=$e({logicalAnd_:kce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ace(r){const n={x:me(r,"x","logicalNot","bool")};return Te.runKernel(Uv,n)}const Z3=$e({logicalNot_:Ace});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(r,t){const n=me(r,"a","logicalOr","bool"),s=me(t,"b","logicalOr","bool");nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Gv,i)}const M7=$e({logicalOr_:Ice});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(r,t){const n=me(r,"a","logicalXor","bool"),s=me(t,"b","logicalXor","bool");return nn(n.shape,s.shape),_u(M7(r,t),Z3(_u(r,t)))}const Fce=$e({logicalXor_:$ce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rce(r,t,n,s,i){const a=me(r,"x","maxPool"),o=1;let u=a,l=!1;a.rank===3&&(l=!0,u=ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),oe(u.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${u.rank}.`),oe(Gs(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),mi("maxPool",s,i);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i},f=Te.runKernel(Hv,c,h);return l?ke(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Q3=$e({maxPool_:Rce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(r,t=[1,1,1],n,s,i,a="NDHWC"){const o=me(r,"x","maxPool3d");let u=o,l=!1;o.rank===4&&(l=!0,u=ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),oe(u.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${u.rank}.`),oe(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),mi("maxPool3d",s,i);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i,dataFormat:a},f=Te.runKernel(qv,c,h);return l?ke(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Mce=$e({maxPool3d_:Oce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(r,t){let n=me(r,"a","maximum"),s=me(t,"b","maximum");[n,s]=Rr(n,s),n.dtype==="bool"&&(n=_t(n,"int32"),s=_t(s,"int32")),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(i0,i)}const Wl=$e({maximum_:Lce});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bce(r,t=null,n=!1){const i={x:me(r,"x","mean")},a={axis:t,keepDims:n};return Te.runKernel(Kv,i,a)}const jr=$e({mean_:Bce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(r,t="float32"){if(t==="complex64"){const s=hs(r,"float32"),i=hs(r,"float32");return xd(s,i)}const n=Us(Je(r),t);return Te.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dh(r,t="float32"){if(t==="complex64"){const s=Dh(r,"float32"),i=hs(r,"float32");return xd(s,i)}const n=HT(Je(r),t);return Te.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pce(r,t){let n=me(r,"a","minimum"),s=me(t,"b","minimum");[n,s]=Rr(n,s),n.dtype==="bool"&&(n=_t(n,"int32"),s=_t(s,"int32")),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(a0,i)}const J3=$e({minimum_:Pce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(r,t,n){oe(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=me(r,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");oe(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let u=0;u<s.rank;u++)oe(t[u].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),oe(t[u][0]>=0&&t[u][0]<=s.shape[u]-i&&t[u][1]>=0&&t[u][1]<=s.shape[u]-i,()=>`Padding in dimension ${u} cannot be greater than or equal to ${s.shape[u]-i} or less than 0 for input of shape ${s.shape}`);const a={paddings:t,mode:n},o={x:s};return Te.runKernel(Yv,o,a)}const zce=$e({mirrorPad_:Vce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uce(r,t){let n=me(r,"a","mod"),s=me(t,"b","mod");[n,s]=Rr(n,s);const i={a:n,b:s};return Te.runKernel(o0,i)}const Gce=$e({mod_:Uce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(r,t=null,n=!1){r=me(r,"x","moments");const s=dn(t,r.shape),i=jr(r,s,n);let a=i.shape;n||(a=Hr(i.shape,s));const o=gr(Kt(_t(r,"float32"),ke(i,a))),u=jr(o,s,n);return{mean:i,variance:u}}const eN=$e({moments_:jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(r,t){let n=me(r,"a","notEqual","string_or_numeric"),s=me(t,"b","notEqual","string_or_numeric");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s};return Te.runKernel(Qv,i)}const nb=$e({notEqual_:Wce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(r){const n={x:me(r,"x","onesLike")};return Te.runKernel(Jv,n)}const Aa=$e({onesLike_:Hce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qce(r,t,n=0){const s=me(r,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},a={x:s};return Te.runKernel(n2,a,i)}const tN=$e({pad_:qce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kce(r,t,n){const s=me(r,"x","spaceToBatchND");oe(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),oe(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),oe(s.shape.reduce((o,u,l)=>l>0&&l<=t.length?o&&(u+n[l-1][0]+n[l-1][1])%t[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:s},a={blockShape:t,paddings:n};return Te.runKernel(f2,i,a)}const nN=$e({spaceToBatchND_:Kce});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(r,t,n,s,i,a,o){i==null&&(i=[1,1]),a==null&&(a=1),s===0&&(s="valid");const u=me(r,"x","maxPool");let l=u,c=!1;u.rank===3&&(c=!0,l=ke(u,[1,u.shape[0],u.shape[1],u.shape[2]])),oe(Gs(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);const h=Ra(l.shape,t,a,i,s),f=[h.dilationHeight,h.dilationWidth];let p;s==="same"?p=Zce([h.filterHeight,h.filterWidth],f):p=[[0,0],[0,0]];const g=f[0]===1&&f[1]===1,[y,x]=Yce([h.inHeight,h.inWidth],f,p),v=g?s:"valid",S=g?l:nN(l,f,y),E=(n==="avg"?()=>U3(S,t,a,v,o):()=>Q3(S,t,a,v,o))(),_=g?E:j3(E,f,x);return c?ke(_,[_.shape[1],_.shape[2],_.shape[3]]):_}function Yce(r,t,n){const s=n.map(h=>h[0]),i=n.map(h=>h[1]),a=r.concat(s,i),o=t.map((h,f)=>(h-a[f]%h)%h),u=i.map((h,f)=>h+o[f]),l=t.map((h,f)=>[s[f],u[f]]),c=t.map((h,f)=>[0,o[f]]);return[l,c]}function Zce(r,t){const s=r.map((o,u)=>o+(o-1)*(t[u]-1)).map(o=>o-1),i=s.map(o=>Math.floor(o/2)),a=s.map((o,u)=>o-i[u]);return s.map((o,u)=>[i[u],a[u]])}const Qce=$e({pool_:Xce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(r,t){const n=me(r,"x","prelu"),s=me(t,"alpha","prelu"),i={x:n,alpha:s};return Te.runKernel(r2,i)}const rN=$e({prelu_:Jce});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(r,t=null,n=!1){let s=me(r,"x","prod");s.dtype==="bool"&&(s=_t(s,"int32"));const i={x:s},a={axis:t,keepDims:n};return Te.runKernel(s2,i,a)}const the=$e({prod_:ehe});var ax={exports:{}},nhe=ax.exports,IO;function rhe(){return IO||(IO=1,function(r){(function(t,n,s){function i(l){var c=this,h=u();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(l),c.s0<0&&(c.s0+=1),c.s1-=h(l),c.s1<0&&(c.s1+=1),c.s2-=h(l),c.s2<0&&(c.s2+=1),h=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var h=new i(l),f=c&&c.state,p=h.next;return p.int32=function(){return h.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&a(f,h),p.state=function(){return a(h,{})}),p}function u(){var l=4022871197,c=function(h){h=String(h);for(var f=0;f<h.length;f++){l+=h.charCodeAt(f);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(nhe,r)}(ax)),ax.exports}var ox={exports:{}},she=ox.exports,$O;function ihe(){return $O||($O=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},u===(u|0)?l.x=u:c+=u;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,l.next()}function a(u,l){return l.x=u.x,l.y=u.y,l.z=u.z,l.w=u.w,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})(she,r)}(ox)),ox.exports}var ux={exports:{}},ahe=ux.exports,FO;function ohe(){return FO||(FO=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,u===(u|0)?l.x=u:c+=u;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,h==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(u,l){return l.x=u.x,l.y=u.y,l.z=u.z,l.w=u.w,l.v=u.v,l.d=u.d,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(ahe,r)}(ux)),ux.exports}var lx={exports:{}},uhe=lx.exports,RO;function lhe(){return RO||(RO=1,function(r){(function(t,n,s){function i(u){var l=this;l.next=function(){var h=l.x,f=l.i,p,g;return p=h[f],p^=p>>>7,g=p^p<<24,p=h[f+1&7],g^=p^p>>>10,p=h[f+3&7],g^=p^p>>>3,p=h[f+4&7],g^=p^p<<7,p=h[f+7&7],p=p^p<<13,g^=p^p<<9,h[f]=g,l.i=f+1&7,g};function c(h,f){var p,g=[];if(f===(f|0))g[0]=f;else for(f=""+f,p=0;p<f.length;++p)g[p&7]=g[p&7]<<15^f.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],h.x=g,h.i=0,p=256;p>0;--p)h.next()}c(l,u)}function a(u,l){return l.x=u.x.slice(),l.i=u.i,l}function o(u,l){u==null&&(u=+new Date);var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.x&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(uhe,r)}(lx)),lx.exports}var cx={exports:{}},che=cx.exports,OO;function hhe(){return OO||(OO=1,function(r){(function(t,n,s){function i(u){var l=this;l.next=function(){var h=l.w,f=l.X,p=l.i,g,y;return l.w=h=h+1640531527|0,y=f[p+34&127],g=f[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=f[p]=y^g,l.i=p,y+(h^h>>>16)|0};function c(h,f){var p,g,y,x,v,S=[],w=128;for(f===(f|0)?(g=f,f=null):(f=f+"\0",g=0,w=Math.max(w,f.length)),y=0,x=-32;x<w;++x)f&&(g^=f.charCodeAt((x+32)%f.length)),x===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(v=v+1640531527|0,p=S[x&127]^=g+v,y=p==0?y+1:0);for(y>=128&&(S[(f&&f.length||0)&127]=-1),y=127,x=4*128;x>0;--x)g=S[y+34&127],p=S[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,S[y]=g^p;h.w=v,h.X=S,h.i=y}c(l,u)}function a(u,l){return l.i=u.i,l.w=u.w,l.X=u.X.slice(),l}function o(u,l){u==null&&(u=+new Date);var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.X&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(che,r)}(cx)),cx.exports}var hx={exports:{}},fhe=hx.exports,MO;function dhe(){return MO||(MO=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.next=function(){var f=l.b,p=l.c,g=l.d,y=l.a;return f=f<<25^f>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-f|0,l.b=f=f<<20^f>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,u===Math.floor(u)?(l.a=u/4294967296|0,l.b=u|0):c+=u;for(var h=0;h<c.length+20;h++)l.b^=c.charCodeAt(h)|0,l.next()}function a(u,l){return l.a=u.a,l.b=u.b,l.c=u.c,l.d=u.d,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(fhe,r)}(hx)),hx.exports}var fx={exports:{}};const phe={},mhe=Object.freeze(Object.defineProperty({__proto__:null,default:phe},Symbol.toStringTag,{value:"Module"})),L7=nY(mhe);var ghe=fx.exports,LO;function yhe(){return LO||(LO=1,function(r){(function(t,n,s){var i=256,a=6,o=52,u="random",l=s.pow(i,a),c=s.pow(2,o),h=c*2,f=i-1,p;function g(_,D,I){var k=[];D=D==!0?{entropy:!0}:D||{};var A=S(v(D.entropy?[_,E(n)]:_??w(),3),k),N=new y(k),F=function(){for(var $=N.g(a),O=l,M=0;$<c;)$=($+M)*i,O*=i,M=N.g(1);for(;$>=h;)$/=2,O/=2,M>>>=1;return($+M)/O};return F.int32=function(){return N.g(4)|0},F.quick=function(){return N.g(4)/4294967296},F.double=F,S(E(N.S),n),(D.pass||I||function($,O,M,B){return B&&(B.S&&x(B,N),$.state=function(){return x(N,{})}),M?(s[u]=$,O):$})(F,A,"global"in D?D.global:this==s,D.state)}function y(_){var D,I=_.length,k=this,A=0,N=k.i=k.j=0,F=k.S=[];for(I||(_=[I++]);A<i;)F[A]=A++;for(A=0;A<i;A++)F[A]=F[N=f&N+_[A%I]+(D=F[A])],F[N]=D;(k.g=function($){for(var O,M=0,B=k.i,U=k.j,V=k.S;$--;)O=V[B=f&B+1],M=M*i+V[f&(V[B]=V[U=f&U+O])+(V[U]=O)];return k.i=B,k.j=U,M})(i)}function x(_,D){return D.i=_.i,D.j=_.j,D.S=_.S.slice(),D}function v(_,D){var I=[],k=typeof _,A;if(D&&k=="object")for(A in _)try{I.push(v(_[A],D-1))}catch{}return I.length?I:k=="string"?_:_+"\0"}function S(_,D){for(var I=_+"",k,A=0;A<I.length;)D[f&A]=f&(k^=D[f&A]*19)+I.charCodeAt(A++);return E(D)}function w(){try{var _;return p&&(_=p.randomBytes)?_=_(i):(_=new Uint8Array(i),(t.crypto||t.msCrypto).getRandomValues(_)),E(_)}catch{var D=t.navigator,I=D&&D.plugins;return[+new Date,t,I,t.screen,E(n)]}}function E(_){return String.fromCharCode.apply(0,_)}if(S(s.random(),n),r.exports){r.exports=g;try{p=L7}catch{}}else s["seed"+u]=g})(typeof self<"u"?self:ghe,[],Math)}(fx)),fx.exports}var f_,BO;function xhe(){if(BO)return f_;BO=1;var r=rhe(),t=ihe(),n=ohe(),s=lhe(),i=hhe(),a=dhe(),o=yhe();return o.alea=r,o.xor128=t,o.xorwow=n,o.xorshift7=s,o.xor4096=i,o.tychei=a,f_=o,f_}var sN=xhe();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let B7=class{constructor(t,n,s,i,a){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=sN.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,s=!1;for(;!s;){let i,a,o;do i=2*this.random()-1,a=2*this.random()-1,o=i*i+a*a;while(o>=1||o===0);const u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*u,n=this.mean+this.stdDev*a*u,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}},bhe=class{constructor(t=0,n=1,s,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=sN.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vhe(r,t=0,n=1,s,i){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new B7(t,n,s,!1,i),o=hn(r,s);for(let u=0;u<o.values.length;u++)o.values[u]=a.nextValue();return o.toTensor()}const whe=$e({randomNormal_:vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function She(r,t=0,n=1,s="float32",i){const a=hn(r,s),o=new bhe(t,n,null,i);for(let u=0;u<a.values.length;u++)a.values[u]=o.nextValue();return a.toTensor()}const T2=$e({randomUniform_:She});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rb(r,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:r,stop:t,step:n,dtype:s};return Te.runKernel(w3,{},i)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Che(r){const n={x:me(r,"x","reciprocal")};return Te.runKernel(c0,n)}const _he=$e({reciprocal_:Che});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ehe(r){const n={x:me(r,"x","relu")};return Te.runKernel(h0,n)}const Th=$e({relu_:Ehe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(r){const n={x:me(r,"x","relu6")};return Te.runKernel(f0,n)}const P7=$e({relu6_:Dhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(r,t){const s={x:me(r,"x","reverse")},i={dims:t};return Te.runKernel(u2,s,i)}const oh=$e({reverse_:The});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(r){const n={x:me(r,"x","round")};return Te.runKernel(d0,n)}const V7=$e({round_:Nhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function khe(r){const n={x:me(r,"x","rsqrt","float32")};return Te.runKernel(p0,n)}const z7=$e({rsqrt_:khe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(r){const n={x:me(r,"x","selu")};return Te.runKernel(m0,n)}const U7=$e({selu_:Ahe});function Ihe(r,t,n,s,i,a=[1,1],o="NHWC"){const u=me(r,"x","separableConv2d"),l=me(t,"depthwiseFilter","separableConv2d"),c=me(n,"pointwiseFilter","separableConv2d");let h=u,f=!1;if(u.rank===3&&(f=!0,h=ke(u,[1,u.shape[0],u.shape[1],u.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");oe(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),oe(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),oe(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),oe(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),oe(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],g=l.shape[3];oe(c.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${c.shape[2]}.`);const y=q3(h,l,s,i,o,a),v=ah(y,c,1,"valid",o);return f?ke(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const G7=$e({separableConv2d_:Ihe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(r){const n={x:me(r,"x","sign")};return Te.runKernel(x0,n)}const Fhe=$e({sign_:$he});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(r){const n={x:me(r,"x","sin","float32")};return Te.runKernel(g0,n)}const j7=$e({sin_:Rhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ohe(r){const n={x:me(r,"x","sinh")};return Te.runKernel(y0,n)}const W7=$e({sinh_:Ohe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mhe(r,t,n){const s=me(r,"x","slice1d");return oe(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),or(s,[t],[n])}const iN=$e({slice1d_:Mhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(r,t,n){const s=me(r,"x","slice2d");return oe(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),or(s,t,n)}const H7=$e({slice2d_:Lhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(r,t,n){const s=me(r,"x","slice3d");return oe(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),or(s,t,n)}const aN=$e({slice3d_:Bhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Phe(r,t,n){const s=me(r,"x","slice4d");return oe(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),or(s,t,n)}const sb=$e({slice4d_:Phe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(r,t=-1){const n=me(r,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},i={dim:t};return Te.runKernel(p2,s,i)}const oN=$e({softmax_:Vhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zhe(r){oe(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const t={input:r};return Te.runKernel(c3,t)}const q7=$e({fft_:zhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uhe(r){oe(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const t={input:r};return Te.runKernel(d3,t)}const qE=$e({ifft_:Uhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(r){const t=r.shape[r.shape.length-1],n=r.size/t;let s;if(t<=2){const i=ke(r,[n,t]);s=qE(i)}else{const i=[n,2*(t-1)],a=ke(eb(r),[n,t]),o=ke(R3(r),[n,t]),u=oh(or(a,[0,1],[n,t-2]),1),l=De(oh(or(o,[0,1],[n,t-2]),1),Ln(-1)),c=fi([a,u],1),h=fi([o,l],1),f=ke(xd(c,h),[i[0],i[1]]);s=qE(f)}if(s=eb(s),r.rank===3&&r.shape[0]!==0){const i=s,a=r.shape[0];s=ke(s,[a,s.shape[0]/a,s.shape[1]]),i.dispose()}return s}const jhe=$e({irfft_:Ghe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(r,t,n=0){const i={x:me(r,"x","split")},a={numOrSizeSplits:t,axis:n};return Te.runKernel(d2,i,a)}const Xi=$e({split_:Whe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(r,t){oe(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let n=r.shape[r.shape.length-1];const s=r.size/n;let i;if(t!=null&&t<n){const y=r.shape.map(v=>0),x=r.shape.map(v=>v);x[r.shape.length-1]=t,i=or(r,y,x),n=t}else if(t!=null&&t>n){const y=r.shape.map(x=>x);y[r.shape.length-1]=t-n,i=fi([r,hs(y)],r.shape.length-1),n=t}else i=r;const a=Nn(i),o=ke(xd(i,a),[s,n]),u=q7(o),l=Math.floor(n/2)+1,c=eb(u),h=R3(u),f=Xi(c,[l,n-l],c.shape.length-1),p=Xi(h,[l,n-l],h.shape.length-1),g=i.shape.slice();return g[i.shape.length-1]=l,ke(xd(f[0],p[0]),g)}const qhe=$e({rfft_:Hhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(r,t){let n=me(r,"a","squaredDifference"),s=me(t,"b","squaredDifference");[n,s]=Rr(n,s),nn(n.shape,s.shape);const i={a:n,b:s},a={};return Te.runKernel(S0,i,a)}const Xhe=$e({squaredDifference_:Khe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(r,t){const n=me(r,"x","squeeze","string_or_numeric");return ke(n,zl(n.shape,t).newShape)}const $0=$e({squeeze_:Yhe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zhe(r,t=0){const n=s7(r,"tensors","stack","string_or_numeric");oe(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&oe(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,i={axis:t};return Te.runKernel(t2,s,i)}const uh=$e({stack_:Zhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(r,t=0){const s={x:me(r,"x","step")},i={alpha:t};return Te.runKernel(T0,s,i)}const F0=$e({step_:Qhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jhe(r,t,n,s,i=0,a=0,o=0,u=0,l=0){const h={x:me(r,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:s,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:u,shrinkAxisMask:l};return Te.runKernel(D3,h,f)}const efe=$e({stridedSlice_:Jhe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tfe(r){const n={x:me(r,"x","tan","float32")};return Te.runKernel(_0,n)}const nfe=$e({tan_:tfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qi(r,t){mP(r);const n=b2(r,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return v2(r,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_(r,t,n){if(mP(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=b2(r,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return v2(r,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(r,t=1,n=!0){const s=me(r,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const a={x:s},o={k:t,sorted:n},[u,l]=Te.runKernel(T3,a,o);return{values:u,indices:l}}const sfe=$e({topk_:rfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(r,t=0,n=1,s,i){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new B7(t,n,s,!0,i),o=hn(r,s);for(let u=0;u<o.values.length;u++)o.values[u]=a.nextValue();return o.toTensor()}const K7=$e({truncatedNormal_:ife});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(r,t=0){const n=me(r,"x","unique","string_or_numeric");oe(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},i={axis:t},[a,o]=Te.runKernel(k3,s,i);return{values:a,indices:o}}const ofe=$e({unique_:afe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ufe(r,t,n){const s=me(r,"x","unsortedSegmentSum"),i=me(t,"segmentIds","unsortedSegmentSum","int32");oe(yd(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:i},o={numSegments:n};return Te.runKernel(g2,a,o)}const X7=$e({unsortedSegmentSum_:ufe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(r,t=0){const n=me(r,"x","unstack","string_or_numeric");oe(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},i={axis:t};return Te.runKernel(m2,s,i)}const Sd=$e({unstack_:lfe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(r,t=!0,n,s){return Te.makeVariable(r,t,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(r,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const s=hn(r,"int32"),i=hn([n.length,r.length],"int32");for(let a=0;a<n.length;a++){const o=s.indexToLoc(n[a]),u=a*r.length;i.values.set(o,u)}return i.toTensor()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hfe(r,t){if(t==null)return r.shape.slice();if(Bn(r.shape,t))return t;if(r.shape.length===t.length){const n=[];for(let s=0;s<r.shape.length;s++)t[s]==null&&r.shape[s]!=null?n.push(r.shape[s]):n.push(t[s]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(r,t,n,s){const i=me(r,"x","dropout");if(oe(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),oe(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return r instanceof Ur?i.clone():i;const a=hfe(i,n),o=1-t,u=Ut(D2(pt(T2(a,0,1,"float32",s),o)),o);return De(i,u)}const dfe=$e({dropout_:ffe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(r,t,n,s,i,a="NHWC",o){let u=r;r.rank===3&&(u=ke(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=t;l.rank===3&&(l=ke(t,[1,t.shape[0],t.shape[1],t.shape[2]])),oe(u.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${u.shape}.`),oe(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),oe(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?u.shape[3]:u.shape[1],h=a==="NHWC"?l.shape[3]:l.shape[1];oe(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),oe(h===n[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${n[3]}).`),mi("conv2dDerFilter",i,o);const f={x:u,dy:l},p={strides:s,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return Te.runKernel(t3,f,p)}const uN=$e({conv2DBackpropFilter_:pfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(r,t,n){if(n==null||n==="linear")return r;if(n==="relu")return De(r,F0(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function cN(r,t){let n=t;const s=ss(r.shape,t.shape);return s.length>0&&(n=Vt(n,s)),ke(n,r.shape)}function hN(r,t,n,s){if(t==="linear")return r;if(t==="relu")return Th(r);if(t==="elu")return _2(r);if(t==="relu6")return P7(r);if(t==="prelu")return rN(r,n);if(t==="leakyrelu")return Y3(r,s);if(t==="sigmoid")return jd(r);throw new Error(`Unknown fused activation ${t}.`)}const fN=(r,t)=>!(r>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe({x:r,filter:t,strides:n,pad:s,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:u,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",fN(Te.state.gradientDepth,l)===!1){oe(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=ah(r,t,n,s,i,a,o);return u!=null&&(I=pt(I,u)),hN(I,l,c,h)}const f=me(r,"x","conv2d","float32"),p=me(t,"filter","conv2d","float32");let g=f,y=!1;f.rank===3&&(y=!0,g=ke(f,[1,f.shape[0],f.shape[1],f.shape[2]])),oe(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),oe(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),mi("fused conv2d",s,o);const x=i==="NHWC"?g.shape[3]:g.shape[1];oe(p.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${p.shape[2]}.`),oe(Gs(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const v=Is(g.shape,p.shape,n,a,s,o);let S;u!=null&&(S=me(u,"bias","fused conv2d"),[S]=Rr(S,f),i==="NHWC"?nn(v.outShape,S.shape):(oe(S.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${S.shape.length}.`),oe(S.shape.length===0||S.shape[0]===v.outChannels||S.shape[0]===1,()=>`Error in fused conv2d: bias shape (${S.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let w;if(c!=null){const I=c.shape;if(oe(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)oe(I[0]===1||I[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${v.outChannels}).`);else if(I.length===3)try{nn(I,v.outShape)}catch{const A=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(A)}w=me(c,"prelu weights","fused conv2d")}const E=(I,k)=>{oe(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[A,N,F,$]=k,O=lN(I,F,l);oe(ih(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const M=W3(N.shape,O,A,n,s),B=uN(N,O,A.shape,n,s),U=[M,B];if($!=null){const V=cN($,O);U.push(V)}return U},_={x:g,filter:p,bias:S,preluActivationWeights:w},D={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o,activation:l,leakyreluAlpha:h};return u==null?wd((k,A,N)=>{let F=Te.runKernel(Zx,_,D);return N([A,k,F]),y&&(F=ke(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:E}})(g,p):wd((k,A,N,F)=>{let $=Te.runKernel(Zx,_,D);return F([A,k,$,N]),y&&($=ke($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:E}})(g,p,S)}const gfe=$e({fusedConv2d_:mfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yfe(r,t,n,s,i,a=[1,1],o){let u=r;r.rank===3&&(u=ke(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=t;l.rank===3&&(l=ke(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:u,dy:l},h={strides:s,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return Te.runKernel(o3,c,h)}const xfe=$e({depthwiseConv2dNativeBackpropFilter_:yfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(r,t,n,s,i,a=[1,1],o){let u=t,l=!1;t.rank===3&&(l=!0,u=ke(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:u,filter:n},h={strides:s,pad:i,dimRoundingMode:o,dilations:a,inputShape:r},f=Te.runKernel(u3,c,h);return l?ke(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const vfe=$e({depthwiseConv2dNativeBackpropInput_:bfe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe({a:r,b:t,transposeA:n=!1,transposeB:s=!1,bias:i,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:u=.2}){if(fN(Te.state.gradientDepth,a)===!1){let $=On(r,t,n,s);return i!=null&&($=pt($,i)),hN($,a,o,u)}let l=me(r,"a","fused matMul"),c=me(t,"b","fused matMul");[l,c]=Rr(l,c);const h=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=Je(y),S=Je(x);oe(h===f,()=>`Error in fused matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const E=nn(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([p,g]),_=n?ke(l,[v,h,p]):ke(l,[v,p,h]),D=s?ke(c,[S,g,f]):ke(c,[S,f,g]);let I;i!=null&&(I=me(i,"bias","fused matMul"),[I]=Rr(I,l),nn(E,I.shape));let k;o!=null&&(k=me(o,"prelu weights","fused matMul"));const A=($,O)=>{const[M,B,U,V]=O,Z=lN(ke($,U.shape),U,a);let J,ne;if(!n&&!s?(J=On(Z,B,!1,!0),ne=On(M,Z,!0,!1)):!n&&s?(J=On(Z,B,!1,!1),ne=On(Z,M,!0,!1)):n&&!s?(J=On(B,Z,!1,!0),ne=On(M,Z,!1,!1)):(J=On(B,Z,!0,!0),ne=On(Z,M,!0,!0)),i!=null){const z=cN(V,Z);return[J,ne,z]}else return[J,ne]},N={a:_,b:D,bias:I,preluActivationWeights:k},F={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:u};return i==null?wd((O,M,B)=>{const U=Te.runKernel(Yx,N,F);return B([O,M,U]),{value:ke(U,E),gradFunc:A}})(_,D):wd((O,M,B,U)=>{const V=Te.runKernel(Yx,N,F);return U([O,M,V,B]),{value:ke(V,E),gradFunc:A}})(_,D,I)}const PO=$e({fusedMatMul_:wfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(r,t,n,s,i="bilinear",a=0){const o=me(r,"image","cropAndResize"),u=me(t,"boxes","cropAndResize","float32"),l=me(n,"boxInd","cropAndResize","int32"),c=u.shape[0];oe(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),oe(u.rank===2&&u.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${u.shape}.`),oe(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${u.shape}.`),oe(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),oe(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),oe(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const h={image:o,boxes:u,boxInd:l},f={method:i,extrapolationValue:a,cropSize:s};return Te.runKernel(i3,h,f)}const Cfe=$e({cropAndResize_:Sfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _fe(r){const t=me(r,"image","flipLeftRight","float32");oe(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return Te.runKernel(f3,n,{})}const Efe=$e({flipLeftRight_:_fe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dfe(r){const t=me(r,"image","grayscaleToRGB"),n=t.rank-1,s=t.shape[n];oe(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),oe(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,Za(t,i)}const Tfe=$e({grayscaleToRGB_:Dfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(r,t,n=0,s=.5){const i=me(r,"image","rotateWithOffset","float32");oe(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const a={image:i},o={radians:t,fillValue:n,center:s};return Te.runKernel(A3,a,o)}const kfe=$e({rotateWithOffset_:Nfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(r,t,n,s,i,a){s==null&&(s=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=r.shape[0];return n=Math.min(n,o),oe(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),oe(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),oe(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),oe(t.rank===1,()=>"scores must be a 1D tensor"),oe(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),oe(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:i,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY){const a=me(r,"boxes","nonMaxSuppression","float32"),o=me(t,"scores","nonMaxSuppression","float32"),u=qd(a,o,n,s,i);n=u.maxOutputSize,s=u.iouThreshold,i=u.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:i};return Te.runKernel(x3,{boxes:a,scores:o},l)}const Ife=$e({nonMaxSuppression_:Afe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(r,t,n){const s=Ffe(r,t,n),i=s<0?-(s+1):s;r.splice(i,0,t)}function Ffe(r,t,n){return Ofe(r,t,n||Rfe)}function Rfe(r,t){return r>t?1:r<t?-1:0}function Ofe(r,t,n){let s=0,i=r.length,a=0,o=!1;for(;s<i;){a=s+(i-s>>>1);const u=n(t,r[a]);u>0?s=a+1:(i=a,o=!u)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dN(r,t,n,s,i){return gN(r,t,n,s,i,0)}function pN(r,t,n,s,i,a){return gN(r,t,n,s,i,0,!1,a,!0)}function mN(r,t,n,s,i,a){return gN(r,t,n,s,i,a,!0)}function gN(r,t,n,s,i,a,o=!1,u=!1,l=!1){const c=[];for(let v=0;v<t.length;v++)t[v]>i&&c.push({score:t[v],boxIndex:v,suppressBeginIndex:0});c.sort(VO);const h=a>0?-.5/a:0,f=[],p=[];for(;f.length<n&&c.length>0;){const v=c.pop(),{score:S,boxIndex:w,suppressBeginIndex:E}=v;if(S<i)break;let _=!1;for(let D=f.length-1;D>=E;--D){const I=Mfe(r,w,f[D]);if(I>=s){_=!0;break}if(v.score=v.score*Lfe(s,h,I),v.score<=i)break}v.suppressBeginIndex=f.length,_||(v.score===S?(f.push(w),p.push(v.score)):v.score>i&&$fe(c,v,VO))}const g=f.length,y=n-g;u&&y>0&&(f.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const x={selectedIndices:f};return o&&(x.selectedScores=p),l&&(x.validOutputs=g),x}function Mfe(r,t,n){const s=r.subarray(t*4,t*4+4),i=r.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),u=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),g=(u-a)*(l-o),y=(f-c)*(p-h);if(g<=0||y<=0)return 0;const x=Math.max(a,c),v=Math.max(o,h),S=Math.min(u,f),w=Math.min(l,p),E=Math.max(S-x,0)*Math.max(w-v,0);return E/(g+y-E)}function Lfe(r,t,n){const s=Math.exp(t*n*n);return n<=r?s:0}function VO(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bfe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY){const a=me(r,"boxes","nonMaxSuppressionAsync"),o=me(t,"scores","nonMaxSuppressionAsync"),u=qd(a,o,n,s,i);n=u.maxOutputSize,s=u.iouThreshold,i=u.scoreThreshold;const l=await Promise.all([a.data(),o.data()]),c=l[0],h=l[1],{selectedIndices:f}=dN(c,h,n,s,i);return a!==r&&a.dispose(),o!==t&&o.dispose(),qi(f,"int32")}const Pfe=Bfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=me(r,"boxes","nonMaxSuppression"),u=me(t,"scores","nonMaxSuppression"),l=qd(o,u,n,s,i,a);n=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:o,scores:u},h={maxOutputSize:n,iouThreshold:s,scoreThreshold:i,softNmsSigma:a},f=Te.runKernel(v3,c,h);return{selectedIndices:f[0],selectedScores:f[1]}}const zfe=$e({nonMaxSuppressionWithScore_:Vfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ufe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=me(r,"boxes","nonMaxSuppressionAsync"),u=me(t,"scores","nonMaxSuppressionAsync"),l=qd(o,u,n,s,i,a);n=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([o.data(),u.data()]),h=c[0],f=c[1],{selectedIndices:p,selectedScores:g}=mN(h,f,n,s,i,a);return o!==r&&o.dispose(),u!==t&&u.dispose(),{selectedIndices:qi(p,"int32"),selectedScores:qi(g)}}const Gfe=Ufe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=me(r,"boxes","nonMaxSuppression"),u=me(t,"scores","nonMaxSuppression"),l=qd(o,u,n,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,p={boxes:o,scores:u},g={maxOutputSize:c,iouThreshold:h,scoreThreshold:f,padToMaxOutputSize:a},y=Te.runKernel(b3,p,g);return{selectedIndices:y[0],validOutputs:y[1]}}const Wfe=$e({nonMaxSuppressionPadded_:jfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Hfe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=me(r,"boxes","nonMaxSuppressionAsync"),u=me(t,"scores","nonMaxSuppressionAsync"),l=qd(o,u,n,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,[p,g]=await Promise.all([o.data(),u.data()]),{selectedIndices:y,validOutputs:x}=pN(p,g,c,h,f,a);return o!==r&&o.dispose(),u!==t&&u.dispose(),{selectedIndices:qi(y,"int32"),validOutputs:Ln(x,"int32")}}const qfe=Hfe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kfe(r,t,n=!1,s=!1){const i=me(r,"images","resizeBilinear");oe(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),oe(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),oe(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=i,o=!1;i.rank===3&&(o=!0,a=ke(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={images:a},l={alignCorners:n,halfPixelCenters:s,size:t},c=Te.runKernel(o2,u,l);return o?ke(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Z7=$e({resizeBilinear_:Kfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(r,t,n=!1,s=!1){const i=me(r,"images","resizeNearestNeighbor");oe(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),oe(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),oe(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),oe(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=i,o=!1;i.rank===3&&(o=!0,a=ke(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={images:a},l={alignCorners:n,halfPixelCenters:s,size:t},c=Te.runKernel(a2,u,l);return o?ke(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Q7=$e({resizeNearestNeighbor_:Xfe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yfe(r,t="binary",n=!1,s=.5){const i=me(r,"image","threshold"),a=.2989,o=.587,u=.114,l=i.shape[0]*i.shape[1];let c=De(qi([s]),255),h,f,p,g;if(oe(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),oe(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),oe(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),oe(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[h,f,p]=Xi(i,[1,1,1],-1);const v=De(h,a),S=De(f,o),w=De(p,u);g=pt(pt(v,S),w)}else g=r;if(t==="otsu"){const v=nle(_t(V7(g),"int32"),Toe([]),256);c=Zfe(v,l)}const y=n?Hd(g,c):Oa(g,c);return _t(De(y,255),"int32")}function Zfe(r,t){let n=qi([-1]),s=qi([0]),i=qi([0]),a,o,u,l,c,h;for(let f=0;f<r.size-1;f++){a=or(r,0,f+1),o=or(r,f+1),c=Ut(Vt(a),t),h=Ut(Vt(o),t);const p=Vt(De(a,rb(0,a.size)));u=Ut(p,Vt(a));const g=C2(o.shape,a.size),y=pt(rb(0,o.size),g),x=De(o,y);l=Ut(Vt(x),Vt(o));const v=Kt(u,l),S=Kt(u,l),w=De(c,h);i=De(De(w,v),S);const E=Oa(i,s);s=Ri(E,i,s),n=Ri(E,qi([f]),n)}return n}const Qfe=$e({threshold_:Yfe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jfe(r,t,n="nearest",s="constant",i=0,a){const o=me(r,"image","transform","float32"),u=me(t,"transforms","transform","float32");oe(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),oe(u.rank===2&&(u.shape[0]===o.shape[0]||u.shape[0]===1)&&u.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),oe(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:o,transforms:u},c={interpolation:n,fillMode:s,fillValue:i,outputShape:a};return Te.runKernel(N3,l,c)}const ede=$e({transform_:Jfe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(r,t,n){oe(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),oe(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const s=me(r,"a","bandPart");oe(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const i=s.shape,[a,o]=s.shape.slice(-2);if(!(t<=a))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);t<0&&(t=a),n<0&&(n=o);const u=ke(rb(0,a,1,"int32"),[-1,1]),l=rb(0,o,1,"int32"),c=Kt(u,l),h=_u(Hd(c,Ln(+t,"int32")),Wd(c,Ln(-n,"int32"))),f=hs([a,o],s.dtype);return ke(uh(Sd(ke(s,[-1,a,o])).map(p=>Ri(h,p,f))),i)}const nde=$e({bandPart_:tde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rde(r){let t;if(Array.isArray(r)){t=!1,oe(r!=null&&r.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=r[0].shape[0];for(let a=1;a<r.length;++a)oe(r[a].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${r[a].shape[0]} vs. ${i})`)}else t=!0,r=Xi(r,r.shape[0],0).map(i=>$0(i,[0]));oe(r.length<=r[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${r.length}) exceeds number of dimensions (${r[0].shape[0]}).`);const n=[],s=r;for(let i=0;i<r.length;++i)n.push(Te.tidy(()=>{let a=s[i];if(i>0)for(let o=0;o<i;++o){const u=De(Vt(De(n[o],a)),n[o]);a=Kt(a,u)}return Ut(a,E2(a,"euclidean"))}));return t?uh(n,0):n}const sde=$e({gramSchmidt_:rde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ide(r,t=!1){if(oe(r.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${r.rank}`),r.rank===2)return zO(r,t);{const n=r.shape.slice(0,r.shape.length-2).reduce((l,c)=>l*c),s=Sd(ke(r,[n,r.shape[r.shape.length-2],r.shape[r.shape.length-1]]),0),i=[],a=[];s.forEach(l=>{const[c,h]=zO(l,t);i.push(c),a.push(h)});const o=ke(uh(i,0),r.shape),u=ke(uh(a,0),r.shape);return[o,u]}}function zO(r,t=!1){return Te.tidy(()=>{oe(r.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${r.shape.length}D Tensor.`);const n=r.shape[0],s=r.shape[1];let i=$7(n),a=Mc(r);const o=d_([[1]],[1,1]);let u=Mc(o);const l=n>=s?s:n;for(let c=0;c<l;++c){const h=a,f=u,p=i;[u,a,i]=Te.tidy(()=>{const g=or(a,[c,c],[n-c,1]),y=E2(g),x=or(a,[c,c],[1,1]),v=Ri(Oa(x,0),d_([[-1]]),d_([[1]])),S=Kt(x,De(v,y)),w=Ut(g,S);w.shape[0]===1?u=Mc(o):u=fi([o,or(w,[1,0],[w.shape[0]-1,w.shape[1]])],0);const E=Wr(Ut(On(v,S),y)),_=or(a,[c,0],[n-c,s]),D=De(E,u),I=_n(u);if(c===0)a=Kt(_,On(D,On(I,_)));else{const N=Kt(_,On(D,On(I,_)));a=fi([or(a,[0,0],[c,s]),N],0)}const k=_n(D),A=or(i,[0,c],[n,i.shape[1]-c]);if(c===0)i=Kt(A,On(On(A,u),k));else{const N=Kt(A,On(On(A,u),k));i=fi([or(i,[0,0],[n,c]),N],1)}return[u,a,i]}),gn([h,f,p])}return!t&&n>s&&(i=or(i,[0,0],[n,s]),a=or(a,[0,0],[s,s])),[i,a]})}const ade=$e({qr_:ide});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ly={flipLeftRight:Efe,grayscaleToRGB:Tfe,resizeNearestNeighbor:Q7,resizeBilinear:Z7,rotateWithOffset:kfe,cropAndResize:Cfe,nonMaxSuppression:Ife,nonMaxSuppressionAsync:Pfe,nonMaxSuppressionWithScore:zfe,nonMaxSuppressionWithScoreAsync:Gfe,nonMaxSuppressionPadded:Wfe,nonMaxSuppressionPaddedAsync:qfe,threshold:Qfe,transform:ede},ode={bandPart:nde,gramSchmidt:sde,qr:ade};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hl extends Gd{minimize(t,n=!1,s){const{value:i,grads:a}=this.computeGradients(t,s);if(s!=null){const o=s.map(u=>({name:u.name,tensor:a[u.name]}));this.applyGradients(o)}else this.applyGradients(a);return gn(a),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return wce(t,n)}dispose(){this.iterations_!=null&&gn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ln(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Hl,Symbol.hasInstance,{value:r=>r.minimize!=null&&r.computeGradients!=null&&r.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yN extends Hl{constructor(t,n,s=null){super(),this.learningRate=t,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const a=Te.registeredVariables[s],o=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accum_grad`,variable:Ue(()=>Nn(a).variable(o))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${s}/accum_var`,variable:Ue(()=>Nn(a).variable(o))});const u=Array.isArray(t)?t[i].tensor:t[s];if(u==null)return;const l=this.accumulatedGrads[i].variable,c=this.accumulatedUpdates[i].variable;Ue(()=>{const h=pt(De(l,this.rho),De(gr(u),1-this.rho)),f=De(Ut(ei(pt(c,this.epsilon)),ei(pt(l,this.epsilon))),u),p=pt(De(c,this.rho),De(gr(f),1-this.rho));l.assign(h),c.assign(p);const g=pt(De(f,-this.learningRate),a);a.assign(g)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(gn(this.accumulatedGrads.map(t=>t.variable)),gn(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedUpdates=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}yN.className="Adadelta";at(yN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xN extends Hl{constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const a=Te.registeredVariables[s];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${s}/accumulator`,variable:Ue(()=>C2(a.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(t)?t[i].tensor:t[s];if(o==null)return;const u=this.accumulatedGrads[i].variable;Ue(()=>{const l=pt(u,gr(o));u.assign(l);const c=pt(De(Ut(o,ei(pt(l,Te.backend.epsilon()))),-this.learningRate),a);a.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&gn(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}xN.className="Adagrad";at(xN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bN extends Hl{constructor(t,n,s,i=null){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ue(()=>{this.accBeta1=Ln(n).variable(),this.accBeta2=Ln(s).variable()}),i==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);Ue(()=>{const s=Kt(1,this.accBeta1),i=Kt(1,this.accBeta2);n.forEach((a,o)=>{const u=Te.registeredVariables[a],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:Ue(()=>Nn(u).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${a}/v`,variable:Ue(()=>Nn(u).variable(l))});const c=Array.isArray(t)?t[o].tensor:t[a];if(c==null)return;const h=this.accumulatedFirstMoment[o].variable,f=this.accumulatedSecondMoment[o].variable,p=pt(De(h,this.beta1),De(c,1-this.beta1)),g=pt(De(f,this.beta2),De(gr(c),1-this.beta2)),y=Ut(p,s),x=Ut(g,i);h.assign(p),f.assign(g);const v=pt(De(Ut(y,pt(ei(x),this.epsilon)),-this.learningRate),u);u.assign(v)}),this.accBeta1.assign(De(this.accBeta1,this.beta1)),this.accBeta2.assign(De(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&gn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&gn(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),Ue(()=>{this.accBeta1.assign(vd(this.beta1,this.iterations_+1)),this.accBeta2.assign(vd(this.beta2,this.iterations_+1))});const n=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}bN.className="Adam";at(bN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vN extends Hl{constructor(t,n,s,i=null,a=0){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=i,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ue(()=>{this.iteration=Ln(0).variable(),this.accBeta1=Ln(n).variable()}),i==null&&(this.epsilon=Te.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);Ue(()=>{const s=Kt(1,this.accBeta1),i=Ut(-this.learningRate,pt(De(this.iteration,this.decay),1));n.forEach((a,o)=>{const u=Te.registeredVariables[a],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:Nn(u).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${a}/v`,variable:Nn(u).variable(l)});const c=Array.isArray(t)?t[o].tensor:t[a];if(c==null)return;const h=this.accumulatedFirstMoment[o].variable,f=this.accumulatedWeightedInfNorm[o].variable,p=pt(De(h,this.beta1),De(c,1-this.beta1)),g=De(f,this.beta2),y=Xs(c),x=Wl(g,y);h.assign(p),f.assign(x);const v=pt(De(Ut(i,s),Ut(p,pt(x,this.epsilon))),u);u.assign(v)}),this.iteration.assign(pt(this.iteration,1)),this.accBeta1.assign(De(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&gn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&gn(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}vN.className="Adamax";at(vN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N2 extends Hl{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const a=Array.isArray(t)?t[i].tensor:t[s];if(a==null)return;const o=Te.registeredVariables[s];Ue(()=>{const u=pt(De(this.c,a),o);o.assign(u)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=Io(Ln(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}N2.className="SGD";at(N2);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wN extends N2{constructor(t,n,s=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ln(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const a=Te.registeredVariables[s];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${s}/momentum`,variable:Ue(()=>Nn(a).variable(!1))});const o=this.accumulations[i].variable,u=Array.isArray(t)?t[i].tensor:t[s];u!=null&&Ue(()=>{let l;const c=pt(De(this.m,o),u);this.useNesterov?l=pt(De(this.c,pt(u,De(c,this.m))),a):l=pt(De(this.c,c),a),o.assign(c),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&gn(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}wN.className="Momentum";at(wN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SN extends Hl{constructor(t,n=.9,s=0,i=null,a=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=s,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,i==null&&(this.epsilon=Te.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,i)=>{const a=Te.registeredVariables[s],o=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${s}/rms`,variable:Ue(()=>Nn(a).variable(o))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${s}/momentum`,variable:Ue(()=>Nn(a).variable(o))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${s}/mg`,variable:Ue(()=>Nn(a).variable(o))});const u=Array.isArray(t)?t[i].tensor:t[s];if(u==null)return;const l=this.accumulatedMeanSquares[i].variable,c=this.accumulatedMoments[i].variable;Ue(()=>{const h=pt(De(l,this.decay),De(gr(u),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,p=pt(De(f,this.decay),De(u,1-this.decay)),g=Ut(De(u,this.learningRate),ei(Kt(h,pt(gr(p),this.epsilon)))),y=pt(De(c,this.momentum),g);l.assign(h),f.assign(p),c.assign(y);const x=Kt(a,y);a.assign(x)}else{const f=pt(De(l,this.decay),De(gr(u),1-this.decay)),p=pt(De(c,this.momentum),Ut(De(u,this.learningRate),ei(pt(f,this.epsilon))));l.assign(f),c.assign(p);const g=Kt(a,p);a.assign(g)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&gn(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&gn(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&gn(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.accumulatedMoments=t.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}SN.className="RMSProp";at(SN);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gc{static sgd(t){return new N2(t)}static momentum(t,n,s=!1){return new wN(t,n,s)}static rmsprop(t,n=.9,s=0,i=null,a=!1){return new SN(t,n,s,i,a)}static adam(t=.001,n=.9,s=.999,i=null){return new bN(t,n,s,i)}static adadelta(t=.001,n=.95,s=null){return new yN(t,n,s)}static adamax(t=.002,n=.9,s=.999,i=null,a=0){return new vN(t,n,s,i,a)}static adagrad(t,n=.1){return new xN(t,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _f={sgd:gc.sgd,momentum:gc.momentum,adadelta:gc.adadelta,adagrad:gc.adagrad,rmsprop:gc.rmsprop,adamax:gc.adamax,adam:gc.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:r=>r();function J7(){return new Promise(r=>ude(()=>r()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CN(r,t){const n=r[0].length;r.forEach((i,a)=>{oe(i.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),oe(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=r[0];r.forEach((i,a)=>{for(let o=0;o<n;o++)oe(o===t||i[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${a}] (${i}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function To(r,t){const n=r[0].slice();for(let s=1;s<r.length;s++)n[t]+=r[s][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ka;(function(r){r[r.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",r[r.VALUE_ROWIDS=1]="VALUE_ROWIDS",r[r.ROW_LENGTHS=2]="ROW_LENGTHS",r[r.ROW_SPLITS=3]="ROW_SPLITS",r[r.ROW_LIMITS=4]="ROW_LIMITS",r[r.ROW_STARTS=5]="ROW_STARTS"})(Ka||(Ka={}));function eV(r,t,n){let s=new Array;if(n==null&&t==null)return s;if(t==null)for(;s.length<r+n.length;)s.push(-1);else s=t.slice();if(n==null)return s;if(r+n.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${r+n.length}, but shape.rank = ${s.length}`);for(let i=1;i<n.length;++i){const a=n[i],o=s[s.length-n.length+i],u=s[o];if(a>=0)if(u>=0){if(u!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+r}] = ${a} but shape[${i+r}] = ${u}`)}else s[o]=a}return s}function tV(r){const t={FIRST_DIM_SIZE:Ka.FIRST_DIM_SIZE,VALUE_ROWIDS:Ka.VALUE_ROWIDS,ROW_LENGTHS:Ka.ROW_LENGTHS,ROW_SPLITS:Ka.ROW_SPLITS,ROW_LIMITS:Ka.ROW_LIMITS,ROW_STARTS:Ka.ROW_STARTS},n=[];for(const s of r)if(s in t)n.push(t[s]);else break;return n}function nV(r){return r.length===0?0:r[0]===Ka.FIRST_DIM_SIZE?r.length-1:r.length}function rV(r,t){if(r==null||t==null)return;const n=r.length,s=t.length;if(n>=s)throw new Error(`defaultValue.shape=${r} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let i=0;i<Math.min(n,s-1);++i){const a=r[i],o=t[i+1];if(a>=0&&o>=0&&a!==1&&a!==o)throw new Error(`defaultValue.shape=${r}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-r.length}] = ${a} but ragged tensor input.flatValues.shape[${i-r.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _N=30;function k2(r){return r<=_N?r:kE(r,Math.floor(Math.sqrt(r)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EN(r,t,n){const s=n*(typeof r=="number"?r:r[0]),i=t*(typeof r=="number"?r:r[1]);return[s,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0(r,t,n,s=!0){let i=[];if(s)i=i.concat(t.slice(0)),i.push(r[0]/n),i=i.concat(r.slice(1));else{i=i.concat(r[0]);const a=t.length;for(let o=0;o<a;++o)i=i.concat([r[o+1]/t[o],t[o]]);i=i.concat(r.slice(a+1))}return i}function O0(r,t,n=!0){const s=[];if(n){s.push(t);for(let i=t+1;i<r;++i)i<=2*t?(s.push(i),s.push(i-(t+1))):s.push(i)}else{const i=[],a=[];for(let o=1;o<r;++o)o>=t*2+1||o%2===1?a.push(o):i.push(o);s.push(...i),s.push(0),s.push(...a)}return s}function M0(r,t,n,s=!0){const i=[];s?i.push(r[0]/n):i.push(r[0]*n);for(let a=1;a<r.length;++a)a<=t.length?s?i.push(t[a-1]*r[a]):i.push(r[a]/t[a-1]):i.push(r[a]);return i}function DN(r,t){const n=[0];for(let s=0;s<t;++s)n.push(r[s][0]);return n}function TN(r,t,n){const s=r.slice(0,1);for(let i=0;i<n;++i)s.push(r[i+1]-t[i][0]-t[i][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A2=1.7580993408473768,I2=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN=.3275911,kN=.254829592,AN=-.284496736,IN=1.421413741,$N=-1.453152027,FN=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eu(r,t){if(r.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${r.length}, imag: ${t.length}.`);const n=new Float32Array(r.length*2);for(let s=0;s<n.length;s+=2)n[s]=r[s/2],n[s+1]=t[s/2];return n}function sV(r){const t=new Float32Array(r.length/2),n=new Float32Array(r.length/2);for(let s=0;s<r.length;s+=2)t[s/2]=r[s],n[s/2]=r[s+1];return{real:t,imag:n}}function iV(r){const t=Math.ceil(r.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let i=0;i<r.length;i+=4)n[Math.floor(i/4)]=r[i],s[Math.floor(i/4)]=r[i+1];return{real:n,imag:s}}function aV(r){const t=Math.floor(r.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let i=2;i<r.length;i+=4)n[Math.floor(i/4)]=r[i],s[Math.floor(i/4)]=r[i+1];return{real:n,imag:s}}function RN(r,t){const n=r[t*2],s=r[t*2+1];return{real:n,imag:s}}function oV(r,t,n,s){r[s*2]=t,r[s*2+1]=n}function uV(r,t){const n=new Float32Array(r/2),s=new Float32Array(r/2);for(let i=0;i<Math.ceil(r/2);i++){const a=(t?2:-2)*Math.PI*(i/r);n[i]=Math.cos(a),s[i]=Math.sin(a)}return{real:n,imag:s}}function lV(r,t,n){const s=(n?2:-2)*Math.PI*(r/t),i=Math.cos(s),a=Math.sin(s);return{real:i,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_="->",lde=/->/g,UO=",",GO="...";function ON(r,t){r=r.replace(/\s/g,"");const n=(r.length-r.replace(lde,"").length)/p_.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${p_}").`);const[s,i]=r.split(p_);oe(s.indexOf(GO)===-1,()=>`The ellipsis notation ("${GO}") is not supported yet.`);const a=s.split(UO),o=a.length;if(t!==o)throw new Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const u=[];for(let p=0;p<i.length;++p){const g=i[p];if(!a.some(y=>y.indexOf(g)!==-1))throw new Error(`Output subscripts contain the label ${g} not present in the input subscripts.`);u.indexOf(g)===-1&&u.push(g)}for(let p=0;p<s.length;++p){const g=s[p];u.indexOf(g)===-1&&g!==UO&&u.push(g)}const l=new Array(a.length);for(let p=0;p<o;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let g=0;g<a[p].length;++g)l[p].push(u.indexOf(a[p][g]))}const c=u.length,h=i.length,f=[];for(let p=h;p<c;++p)f.push(p);return{allDims:u,summedDims:f,idDims:l}}function MN(r,t){let n=new Array(r);n.fill(-1);for(let i=0;i<t.length;++i)n[t[i]]=i;const s=[];for(let i=0;i<r;++i)n[i]===-1&&s.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:s}}function LN(r,t,n){const s=new Array(r);for(let i=0;i<n.length;++i){const a=n[i].shape;for(let o=0;o<t[i].length;++o)s[t[i][o]]===void 0?s[t[i][o]]=a[o]:oe(s[t[i][o]]===a[o],()=>`Expected dimension ${s[t[i][o]]} at axis ${o} of input shaped ${JSON.stringify(a)}, but got dimension ${a[o]}`)}}function BN(r,t){const n=r,s=[];let i=0;r.length===0&&n.push(-1),i=r.length+1;for(let o=0;o<i;++o)s.push([]);const a=[];for(let o=0;o<n.length;++o){const u=n[o],l=cde(t,u);for(const c of l)a.indexOf(c)===-1&&(s[o].push(c),a.push(c))}return{path:n,steps:s}}function PN(r){return r.every((t,n)=>t===n)}function cde(r,t){const n=[];for(let s=0;s<r.length;++s)(r[s].length===0||r[s].indexOf(t)!==-1||t===-1)&&n.push(s);return n}function VN(r,t,n=0){let s=[];if(typeof t=="number")oe(r.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(r.shape[n]/t);else{const i=t.reduce((o,u)=>(u===-1&&(o+=1),o),0);oe(i<=1,()=>"There should be only one negative value in split array.");const a=t.indexOf(-1);if(a!==-1){const o=t.reduce((u,l)=>l>0?u+l:u);t[a]=r.shape[n]-o}oe(r.shape[n]===t.reduce((o,u)=>o+u),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(r){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${r}`}function hV(r,t){return`indices(${r}, 0) is invalid: ${t} < 0`}function fV(r,t,n){return`indices(${r}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(r,t){return`only one output dimension may be -1, not both ${r} and ${t}`}function pV(r,t){return`size ${r} must be non-negative, not ${t}`}function mV(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function gV(r,t){const n=Je(r),s=Je(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${r} outputShape= ${t}`}function yV(r,t){const n=Je(r),s=Je(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${r} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KE(){return"segment ids must be >= 0"}function xV(){return"segment ids are not increasing"}function bV(r,t){return`Segment id ${r} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function vV(r,t,n){return`Bad: indices[${r}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(r,t){let n=!1,s;for(r<=_N?(s=r,n=!0):s=kE(r,Math.floor(Math.sqrt(r)));!n;)s>t||s===r?n=!0:s=kE(r,s+1);return s}function SV(r,t,n){const s=[],i=r.length;for(let a=0;a<i;a++)a!==t?s.push(r[a]):s.push(n);return s}function zN(r,t,n,s){const i=t.shape.length,a=r.shape.length;if(s!==0&&(s<-i||s>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${s}`);if(s<0&&(s+=i),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let f=0;f<s;++f)if(r.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${r.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const o=r.shape[n],u=[];let l=1,c=1,h=1;for(let f=0;f<s;++f)u.push(r.shape[f]),l*=r.shape[f];for(let f=s;f<n;f++)u.push(r.shape[f]),c*=r.shape[f];for(let f=s;f<i;f++)u.push(t.shape[f]);for(let f=n+1;f<a;f++)u.push(r.shape[f]),h*=r.shape[f];return{batchSize:l,sliceSize:h,outerSize:c,dimSize:o,outputShape:u}}const hde=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:zN,computeOutShape:SV,segOpComputeOptimalWindowSize:wV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lh(r){try{return r.map(t=>Fl(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function CV(r){return r.map(t=>El(t))}const fde=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:kN,ERF_A2:AN,ERF_A3:IN,ERF_A4:$N,ERF_A5:FN,ERF_P:NN,PARALLELIZE_THRESHOLD:_N,get RowPartitionType(){return Ka},SELU_SCALE:I2,SELU_SCALEALPHA:A2,applyActivation:hN,assertAndGetBroadcastShape:nn,assertAxesAreInnerMostDims:$s,assertParamsConsistent:CN,assignToTypedArray:oV,axesAreInnerMostDims:K3,calculateShapes:k0,checkEinsumDimSizes:LN,checkPadOnDimRoundingMode:mi,combineLocations:A7,combineRaggedTensorToTensorShapes:eV,complexWithEvenIndex:iV,complexWithOddIndex:aV,computeConv2DInfo:Is,computeConv3DInfo:Gl,computeDefaultPad:z3,computeDilation2DInfo:A0,computeOptimalWindowSize:k2,computeOutAndReduceShapes:bs,computeOutShape:To,computePool2DInfo:Ra,computePool3DInfo:Iu,convertConv2DDataFormat:$u,decodeEinsumEquation:ON,eitherStridesOrDilationsAreOne:Gs,expandShapeToKeepDim:Hr,exponent:lV,exponents:uV,fromStringArrayToUint8:CV,fromUint8ToStringArray:lh,getAxesPermutation:Dr,getBroadcastDims:bd,getComplexWithIndex:RN,getEinsumComputePath:BN,getEinsumPermutation:MN,getFusedBiasGradient:cN,getFusedDyActivation:lN,getImageCenter:EN,getInnerMostAxes:Mr,getPermuted:O0,getRaggedRank:nV,getReductionAxes:ss,getReshaped:R0,getReshapedPermuted:M0,getRowPartitionTypesHelper:tV,getSliceBeginCoords:DN,getSliceSize:TN,getSparseFillEmptyRowsIndicesDenseShapeMismatch:cV,getSparseFillEmptyRowsNegativeIndexErrorMessage:hV,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:fV,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:mV,getSparseReshapeInputOutputMismatchErrorMessage:yV,getSparseReshapeInputOutputMultipleErrorMessage:gV,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:dV,getSparseReshapeNegativeOutputDimErrorMessage:pV,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:vV,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:KE,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:xV,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:bV,getUndoAxesPermutation:jl,isIdentityPermutation:PN,log:toe,mergeRealAndImagArrays:Eu,prepareAndValidate:O3,prepareSplitSize:VN,segment_util:hde,shouldFuse:fN,slice_util:lue,splitRealAndImagArrays:sV,tupleValuesAreOne:ih,upcastType:$i,validateDefaultValueShape:rV,validateInput:sue,validateUpdateShape:p7,warn:Hi},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _V={kernelName:xv,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,F0(_t(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde={kernelName:Fg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=gr(_t(n,"float32")),i=ei(Kt(Ln(1),s));return Wr(Ut(r,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde={kernelName:Rg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=ei(Kt(gr(_t(n,"float32")),1));return Ut(r,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mde={kernelName:Ud,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{let u=r;const l=ss(n.shape,i);return l.length>0&&(u=Vt(u,l)),ke(u,n.shape)},b:()=>{let u=r;const l=ss(s.shape,i);return l.length>0&&(u=Vt(u,l)),ke(u,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde={kernelName:KT,saveAllInputs:!0,gradFunc:(r,t)=>{const n={};return t.forEach((s,i)=>{n[i]=()=>r.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde={kernelName:bv,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Nn(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde={kernelName:vv,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Nn(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde={kernelName:Og,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,ei(Kt(Ln(1),gr(_t(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vde={kernelName:Mg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=ei(pt(Ln(1),gr(_t(n,"float32"))));return Ut(r,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wde={kernelName:Pg,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{const u=pt(gr(n),gr(s));let l=De(r,Ut(s,u));const c=ss(n.shape,i);return c.length>0&&(l=Vt(l,c)),ke(l,n.shape)},b:()=>{const u=pt(gr(n),gr(s));let l=Wr(De(r,Ut(n,u)));const c=ss(s.shape,i);return c.length>0&&(l=Vt(l,c)),ke(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sde={kernelName:Lg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,pt(gr(_t(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde={kernelName:Bg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,Kt(Ln(1),gr(_t(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(r,t,n,s,i,a){const o=me(r,"dy","avgPool3dGrad"),u=me(t,"input","avgPool3dGrad");let l=o,c=u,h=!1;u.rank===4&&(h=!0,l=ke(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=ke(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),oe(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),oe(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),mi("avgPool3dGrad",i,a);const f={dy:l,input:c},p={filterSize:n,strides:s,pad:i,dimRoundingMode:a},g=Te.runKernel(QT,f,p);return h?ke(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Ede=$e({avgPool3dGrad_:_de});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde={kernelName:Sv,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{filterSize:i,strides:a,pad:o,dimRoundingMode:u}=n;return{x:()=>Ede(r,s,i,a,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tde(r,t,n,s,i){const a=me(r,"dy","avgPoolGrad"),o=me(t,"input","avgPoolGrad");oe(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let u=o,l=a,c=!1;o.rank===3&&(c=!0,u=ke(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=ke(a,[1,a.shape[0],a.shape[1],a.shape[2]])),oe(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),oe(u.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${u.rank}.`);const h={dy:l,input:u},f={filterSize:n,strides:s,pad:i},p=Te.runKernel(ZT,h,f);return c?ke(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Nde=$e({avgPoolGrad_:Tde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kde={kernelName:wv,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{filterSize:i,strides:a,pad:o}=n;return{x:()=>Nde(r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ade={kernelName:Cv,inputsToSave:["a","b"],gradFunc:(r,t,n)=>{const[s,i]=t,{transposeA:a,transposeB:o}=n;return!a&&!o?{a:()=>On(r,i,!1,!0),b:()=>On(s,r,!0,!1)}:!a&&o?{a:()=>On(r,i,!1,!1),b:()=>On(r,s,!0,!1)}:a&&!o?{a:()=>On(i,r,!1,!0),b:()=>On(s,r,!1,!1)}:{a:()=>On(i,r,!0,!0),b:()=>On(r,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ide={kernelName:_v,gradFunc:(r,t,n)=>{const{blockShape:s,crops:i}=n;return{x:()=>nN(r,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $de={kernelName:Qae,gradFunc:(r,t,n)=>{const s=n,i=s.inputShape,a=s.shape,o=Array.from(a);for(let l=i.length-1;l>=0;l--)if(i[l]===a[l])o[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const u=[];for(let l=0;l<o.length;l++)o[l]>1&&u.push(l);return{x:()=>Vt(r,u,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fde={kernelName:Vg,gradFunc:r=>({x:()=>r.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rde={kernelName:zg,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode={kernelName:Ug,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>Ri(_u(Wd(s,i),Hd(s,a)),r,Nn(r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde={kernelName:Ev,inputsToSave:["x"],gradFunc:_V.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde={kernelName:Dv,saveAllInputs:!0,gradFunc:(r,t,n)=>{const s=t.map(l=>l.shape),{axis:i}=n,a=dn(i,t[0].shape)[0],o=s.map(l=>l[a]);return Xi(r,o,a).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bde={kernelName:Tv,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,{dilations:a,strides:o,pad:u,dataFormat:l}=n;return oe(ih(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>W3(s.shape,r,i,o,u,l),filter:()=>uN(s,r,i.shape,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde={kernelName:Nv,inputsToSave:["dy","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,{strides:a,pad:o,dataFormat:u,dimRoundingMode:l}=n;return{dy:()=>ah(r,i,a,o,u,1,l),filter:()=>uN(r,s,i.shape,a,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vde(r,t,n,s,i){let a=r;r.rank===4&&(a=ke(r,[1,r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));let o=t;o.rank===4&&(o=ke(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),oe(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),oe(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),oe(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),oe(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),oe(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const u={x:a,dy:o},l={strides:s,pad:i,filterShape:n};return Te.runKernel(n3,u,l)}const zde=$e({conv3DBackpropFilter_:Vde});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude={kernelName:kv,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:s,strides:i,pad:a}=n;oe(ih(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,u]=t;return{x:()=>T7(o.shape,r,u,i,a),filter:()=>zde(o,r,u.shape,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gde={kernelName:Gg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(Wr(j7(_t(n,"float32"))),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde={kernelName:jg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(W7(_t(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde={kernelName:Av,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{const u=Dr([i],s.rank);let l=k7(r,i,a,!o);return u!=null&&(l=_n(l,u)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hde={kernelName:Iv,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:s,strides:i,pad:a,dimRoundingMode:o}=n,u=s??[1,1];oe(ih(u),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${u}'`);const[l,c]=t;return oe(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),oe(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),oe(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),oe(Gs(i,u),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${u}'.`),mi("depthwiseConv2d",a,o),{x:()=>vfe(l.shape,r,c,i,a,u,o),filter:()=>xfe(l,r,c.shape,i,a,u,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qde={kernelName:$v,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,a={x:s,filter:i,dy:r},o={x:s,filter:i,dy:r};return{x:()=>Te.runKernel(AE,a,n),filter:()=>Te.runKernel(IE,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kde={kernelName:Hg,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t,s={dy:r,y:n};return{x:()=>Te.runKernel(l3,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde={kernelName:qg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,s=De(Cu(Wr(gr(n))),2/Math.sqrt(Math.PI));return{x:()=>De(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yde={kernelName:Kg,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zde={kernelName:Rv,inputsToSave:["input"],gradFunc:(r,t)=>{const[n]=t;return{input:()=>ke(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qde={kernelName:Xg,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,Cu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jde={kernelName:Yg,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe={kernelName:Zg,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{const u=Ut(r,_t(s,"float32")),l=ss(n.shape,i);return l.length>0?ke(Vt(u,l),n.shape):u},b:()=>{let u=De(r,_t(n,"float32"));const l=ss(s.shape,i);l.length>0&&(u=ke(Vt(u,l),s.shape));const c=gr(s);return Wr(Ut(u,_t(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tpe={kernelName:Ov,inputsToSave:["x","mean","variance","scale"],gradFunc:(r,t,n)=>{const{varianceEpsilon:s}=n,[i,a,o,u]=t,l=u??Ln(1),c=ss(a.shape,i.shape),h=[];if(a.rank===1){for(let _=0;_<i.shape.length-1;++_)h.push(i.shape[_]);h.push(1)}const f=Kt(i,a),p=De(r,l),g=z7(pt(o,Ln(s))),y=De(De(De(g,g),g),Ln(-.5));return{x:()=>a.rank===1?ke(De(De(r,Za(ke(g,[1,1,1,a.shape[0]]),h)),l),i.shape):ke(De(De(r,g),l),i.shape),mean:()=>{let _=De(De(g,Ln(-1)),p);return a.rank===1&&(_=Vt(_,c)),ke(_,a.shape)},variance:()=>{let _=De(De(y,f),p);return a.rank===1&&(_=Vt(_,c)),ke(_,a.shape)},scale:()=>{const _=De(f,g);let D=De(r,_);return a.rank===1&&(D=Vt(D,c)),ke(D,a.shape)},offset:()=>{let _=r;return a.rank===1&&(_=Vt(_,c)),ke(_,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const npe={kernelName:Mv,inputsToSave:["x","indices"],gradFunc:(r,t,n)=>{const[s,i]=t,{axis:a}=n,o=dn(a,s.shape)[0];return{x:()=>{const l=s.shape,c=i.size,h=l.slice(0,o),f=h.length,p=l.slice(a,l.length).slice(1),g=p.length,y=jO(0,f),x=jO(f+1,f+1+g),v=WO([h,[c],p]),S=ke(r,v),w=ke(i,[c]),E=WO([[f],y,x]),_=_n(S,E);let D=X7(_,w,s.shape[o]);const I=jl(E);return D=_n(D,I),D},indices:()=>i}}};function jO(r,t){const n=[];for(let s=r;s<t;++s)n.push(s);return n}function WO(r){const t=[];for(let n=0;n<r.length;++n)for(let s=0;s<r[n].length;++s)t.push(r[n][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe={kernelName:Qg,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>Nn(n),b:()=>Nn(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe={kernelName:Jg,gradFunc:r=>({x:()=>_t(r,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ipe={kernelName:e0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape={kernelName:t0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ope={kernelName:n0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const upe={kernelName:Bv,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{alpha:i}=n,a=Oa(s,0);return{x:()=>Ri(a,r,De(r,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe={kernelName:s0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,pt(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cpe={kernelName:r0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,_t(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hpe={kernelName:Jae,inputsToSave:[],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s]=t,{axis:i}=n;return{logits:()=>{const o=Cu(s);return Kt(r,De(Vt(r,i,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(r,t,n,s=5,i=1,a=1,o=.5){const u={x:r,y:t,dy:n},l={depthRadius:s,bias:i,alpha:a,beta:o};return Te.runKernel(m3,u,l)}const dpe=$e({localResponseNormalizationBackprop_:fpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe={kernelName:jv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{depthRadius:a,bias:o,alpha:u,beta:l}=n;return{x:()=>dpe(s,i,r,a,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EV(r,t,n,s){return t.rank<n.rank&&(t=ke(t,Hr(t.shape,s))),r.rank<n.rank&&(r=ke(r,Hr(r.shape,s))),{x:()=>De(r,_t($o(n,t),r.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HO={kernelName:Wv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const s=n,{reductionIndices:i}=s,a=t[0],o=t[1],u=dn(i,a.shape),l=EV(r,o,a,u);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mpe={kernelName:i0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>De(r,_t(Wd(n,s),"float32")),b:()=>De(r,_t(F7(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gpe(r,t,n,s,i,a,o){const u=me(r,"dy","maxPool3dGrad"),l=me(t,"input","maxPool3dGrad"),c=me(n,"output","maxPool3dGrad");let h=u,f=l,p=c,g=!1;l.rank===4&&(g=!0,h=ke(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=ke(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=ke(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),oe(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),oe(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),oe(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),mi("maxPool3dGrad",a,o);const y={dy:h,input:f,output:p},x={filterSize:s,strides:i,pad:a,dimRoundingMode:o},v=Te.runKernel(y3,y,x);return g?ke(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const ype=$e({maxPool3dGrad_:gpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe={kernelName:qv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{filterSize:a,strides:o,pad:u,dimRoundingMode:l}=n;return{x:()=>ype(r,s,i,a,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bpe(r,t,n,s,i,a,o){const u=me(r,"dy","maxPoolGrad"),l=me(t,"input","maxPoolGrad"),c=me(n,"output","maxPoolGrad");oe(l.rank===u.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${u.rank})`),oe(u.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),oe(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),mi("maxPoolGrad",a,o);const h={dy:u,input:l,output:c},f={filterSize:s,strides:i,pad:a,dimRoundingMode:o};return Te.runKernel(g3,h,f)}const vpe=$e({maxPoolGrad_:bpe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe={kernelName:Hv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{filterSize:a,strides:o,pad:u}=n;return{x:()=>vpe(r,s,i,a,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spe={kernelName:Kv,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{axis:i}=n,a=dn(i,s.shape),u=bs(s.shape,a)[1],l=Je(u);return{x:()=>{const h=s.shape.slice();a.forEach(g=>{h[g]=1});const f=ke(r,h);return Ut(De(f,Dh(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe={kernelName:Xv,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const s=n,{axis:i}=s,[a,o]=t,u=dn(i,a.shape),l=EV(r,o,a,u);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _pe={kernelName:a0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>De(r,_t(Hd(n,s),"float32")),b:()=>De(r,_t(Oa(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe={kernelName:Yv,inputsToSave:["x"],gradFunc:(r,t,n)=>{const s=t[0],{paddings:i}=n,a=i.map(o=>o[0]);return{x:()=>or(r,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe={kernelName:o0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{const u=ss(n.shape,i);return u.length>0?ke(Vt(r,u),n.shape):r},b:()=>{const u=De(r,Wr(D2(Ut(n,s)))),l=ss(s.shape,i);return l.length>0?ke(Vt(u,l),s.shape):u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe={kernelName:u0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{const u=De(r,_t(s,"float32")),l=ss(n.shape,i);return l.length>0?ke(Vt(u,l),n.shape):u},b:()=>{const u=De(r,_t(n,"float32")),l=ss(s.shape,i);return l.length>0?ke(Vt(u,l),s.shape):u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe={kernelName:Zv,gradFunc:r=>({x:()=>Wr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe={kernelName:e2,inputsToSave:["indices"],gradFunc:(r,t)=>{const n=t[0];return{indices:()=>hs(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ape={kernelName:Jv,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe={kernelName:t2,saveAllInputs:!0,gradFunc:(r,t,n)=>{const{axis:s}=n;return Sd(r,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qO={kernelName:n2,inputsToSave:["x"],gradFunc:(r,t,n)=>{const s=t[0],{paddings:i}=n,a=i.map(o=>o[0]);return{x:()=>or(r,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $pe={kernelName:l0,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(r,t)=>{const[n,s,i]=t,a=n,o=s,u=nn(a.shape,o.shape);return{a:()=>{const h=_t(o,"float32");let f=De(r,De(h,vd(a,Kt(h,Ln(1)))));const p=ss(a.shape,u);return p.length>0&&(f=Vt(f,p)),ke(f,a.shape)},b:()=>{const h=Oa(a,0),f=Ri(h,Fo(a),Nn(a));let p=De(r,De(i,f));const g=ss(o.shape,u);return g.length>0&&(p=Vt(p,g)),ke(p,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe={kernelName:r2,inputsToSave:["x","alpha"],gradFunc:(r,t)=>{const[n,s]=t,i=Oa(n,0);return{x:()=>Ri(i,r,De(r,s)),alpha:()=>{let a=Ri(i,Nn(r),De(r,n));const o=ss(s.shape,r.shape);return o.length>0&&(a=Vt(a,o)),ke(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(r,t,n){const s=r.shape.slice();s[n]=1;const i=ke(t,s),a=WE(r,n,!0,!1),o=WE(r,n,!0,!0),u=De(a,o);return De(i,u)}function Ope(r,t,n){const s=r.shape.length,i=s-n.length,a=Dr(n,s);let o=r;a!=null&&(o=_n(r,a));const u=o.shape.slice(),c=u.splice(s-n.length,n.length).reduce((p,g)=>p*g,1);u.push(c);const h=o.reshape(u);let f=Rpe(h,t,i);if(f=f.reshape(o.shape),a!=null){const p=jl(a);f=_n(f,p)}return f}const Mpe={kernelName:s2,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{axis:i}=n;let a=[];return i==null?a=s.shape.map((o,u)=>u):typeof i=="number"?a=[i]:a=i,{x:()=>Ope(s,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe={kernelName:Wg,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{const u=Ut(r,_t(s,"float32")),l=ss(n.shape,i);return l.length>0?ke(Vt(u,l),n.shape):u},b:()=>{let u=De(r,_t(n,"float32"));const l=ss(s.shape,i);l.length>0&&(u=ke(Vt(u,l),s.shape));const c=gr(s);return Wr(Ut(u,_t(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bpe={kernelName:c0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,Wr(gr(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ppe={kernelName:f0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,s=De(Hd(n,6),F0(n));return{x:()=>De(r,_t(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe={kernelName:h0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,_t(F0(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe={kernelName:i2,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>ke(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Upe={kernelName:o2,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[s]=t,i={dy:r,images:s};return{images:()=>Te.runKernel(_3,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gpe={kernelName:a2,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[s]=t,i={dy:r,images:s};return{images:()=>Te.runKernel(C3,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jpe={kernelName:u2,gradFunc:(r,t,n)=>{const{dims:s}=n,i=dn(s,r.shape);return{x:()=>oh(r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpe={kernelName:d0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hpe={kernelName:p0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Wr(Ut(r,De(vd(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe={kernelName:l2,inputsToSave:["condition"],gradFunc:(r,t)=>{const[n]=t;return{condition:()=>_t(Nn(n),"float32"),t:()=>De(r,_t(n,r.dtype)),e:()=>De(r,_t(Z3(n),r.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe={kernelName:m0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=Oa(n,Ln(0)),i=Ln(A2),a=Ln(I2),o=De(r,a),u=De(De(r,i),Cu(_t(n,"float32")));return Ri(s,o,u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe={kernelName:b0,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,De(n,Kt(Ln(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ype={kernelName:x0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe={kernelName:g0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(H3(_t(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qpe={kernelName:y0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(N7(_t(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jpe={kernelName:c2,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{begin:i,size:a}=n,o=s.shape,[u,l]=w2(s,i,a),c=[];for(let h=0;h<r.rank;h++)c.push([u[h],o[h]-u[h]-l[h]]);return{x:()=>tN(r,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eme={kernelName:p2,outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s]=t,{dim:i}=n,a=!0,o=De(r,s);return{logits:()=>Kt(o,De(Vt(o,[i],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme={kernelName:v0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,jd(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KO={kernelName:f2,gradFunc:(r,t,n)=>{const{blockShape:s,paddings:i}=n;return{x:()=>j3(r,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XO={kernelName:d2,gradFunc:(r,t,n)=>{const{axis:s}=n;return{x:()=>fi(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme={kernelName:w0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,De(ei(_t(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme={kernelName:E3,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(r,De(_t(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme={kernelName:S0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Ln(2);return{a:()=>De(r,De(i,Kt(n,s))),b:()=>De(r,De(i,Kt(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime={kernelName:T0,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame={kernelName:C0,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=nn(n.shape,s.shape);return{a:()=>{let u=r;const l=ss(n.shape,i);return l.length>0&&(u=Vt(u,l)),ke(u,n.shape)},b:()=>{let u=r;const l=ss(s.shape,i);return l.length>0&&(u=Vt(u,l)),ke(Wr(u),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ome={kernelName:h2,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,i=s.shape.slice(),{axis:a}=n;dn(a,s.shape).forEach(c=>{i[c]=1});const u=ke(r,i),l=De(u,Dh(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume={kernelName:_0,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Ut(r,gr(H3(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lme={kernelName:E0,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>De(Kt(Ln(1),gr(n)),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme={kernelName:D0,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{reps:i}=n;return{x:()=>{let o=Nn(s);if(s.rank===1)for(let u=0;u<i[0];++u)o=pt(o,or(r,[u*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)o=pt(o,or(r,[u*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)o=pt(o,or(r,[u*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)for(let h=0;h<i[3];++h)o=pt(o,or(r,[u*s.shape[0],l*s.shape[1],c*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hme={kernelName:Qf,gradFunc:(r,t,n)=>{const s=n,{perm:i}=s,a=jl(i);return{x:()=>_n(r,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fme={kernelName:m2,gradFunc:(r,t,n)=>{const s=n,{axis:i}=s;return{value:()=>uh(r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme={kernelName:g2,inputsToSave:["segmentIds"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>pme(r,n)}}};function pme(r,t){const n=Wl(t,Nn(t)),s=X3(r,n);let i=Wd(t,Ln(0,"int32"));const a=s.rank-i.rank;for(let u=0;u<a;++u)i=Sa(i,u+1);i=_u(i,Dh(s.shape,"bool"));const o=Nn(s);return Ri(i,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mme={kernelName:y2,gradFunc:r=>({x:()=>Nn(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme=[_V,dde,pde,mde,gde,yde,xde,bde,vde,wde,Sde,Cde,Dde,kde,Ade,Ide,$de,Fde,Rde,Ode,Mde,Lde,Pde,Bde,Ude,Gde,jde,Wde,Hde,qde,Lpe,Kde,Xde,Yde,Zde,Qde,epe,Jde,tpe,npe,rpe,spe,ipe,ape,ope,upe,lpe,cpe,hpe,ppe,HO,HO,mpe,xpe,wpe,Spe,Cpe,_pe,Epe,Dpe,Tpe,Npe,kpe,Ape,Ipe,qO,qO,$pe,Fpe,Mpe,Bpe,Ppe,Vpe,zpe,Upe,Gpe,jpe,Wpe,Hpe,qpe,Kpe,Xpe,Ype,Zpe,Qpe,Jpe,eme,tme,KO,KO,XO,XO,nme,sme,rme,ime,ame,ome,ume,lme,cme,hme,fme,dme,mme];for(const r of gme)noe(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.abs=function(){return this.throwIfDisposed(),Xs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.acos=function(){return this.throwIfDisposed(),gue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.acosh=function(){return this.throwIfDisposed(),xue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.add=function(r){return this.throwIfDisposed(),pt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.all=function(r,t){return this.throwIfDisposed(),_7(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.any=function(r,t){return this.throwIfDisposed(),GE(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.argMax=function(r){return this.throwIfDisposed(),hg(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.argMin=function(r){return this.throwIfDisposed(),Cue(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.asScalar=function(){return this.throwIfDisposed(),oe(this.size===1,()=>"The array must have only 1 element."),ke(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.asType=function(r){return this.throwIfDisposed(),_t(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.as1D=function(){return this.throwIfDisposed(),ke(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.as2D=function(r,t){return this.throwIfDisposed(),ke(this,[r,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.as3D=function(r,t,n){return this.throwIfDisposed(),ke(this,[r,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.as4D=function(r,t,n,s){return this.throwIfDisposed(),ke(this,[r,t,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.as5D=function(r,t,n,s,i){return this.throwIfDisposed(),ke(this,[r,t,n,s,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.asin=function(){return this.throwIfDisposed(),Eue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.asinh=function(){return this.throwIfDisposed(),Tue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.atan=function(){return this.throwIfDisposed(),kue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.atan2=function(r){return this.throwIfDisposed(),Iue(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.atanh=function(){return this.throwIfDisposed(),Fue(this)};Ye().prototype.avgPool=function(r,t,n,s){return this.throwIfDisposed(),U3(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.batchToSpaceND=function(r,t){return this.throwIfDisposed(),j3(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.batchNorm=function(r,t,n,s,i){return this.throwIfDisposed(),S2(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.broadcastTo=function(r){return this.throwIfDisposed(),Lm(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.cast=function(r){return this.throwIfDisposed(),_t(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.ceil=function(){return this.throwIfDisposed(),ile(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.clipByValue=function(r,t){return this.throwIfDisposed(),Qi(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.concat=function(r,t){return this.throwIfDisposed(),r instanceof Ur&&(r=[r]),fi([this,...r],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.conv1d=function(r,t,n,s,i,a){return this.throwIfDisposed(),E7(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.conv2dTranspose=function(r,t,n,s,i){return this.throwIfDisposed(),D7(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.conv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),ah(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.cos=function(){return this.throwIfDisposed(),H3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.cosh=function(){return this.throwIfDisposed(),N7(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.cumprod=function(r,t,n){return this.throwIfDisposed(),WE(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.cumsum=function(r,t,n){return this.throwIfDisposed(),k7(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.depthToSpace=function(r,t){return this.throwIfDisposed(),kle(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.depthwiseConv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),q3(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.dilation2d=function(r,t,n,s,i){return this.throwIfDisposed(),$le(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.divNoNan=function(r){return this.throwIfDisposed(),Lle(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.div=function(r){return this.throwIfDisposed(),Ut(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.dot=function(r){return this.throwIfDisposed(),Ple(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.elu=function(){return this.throwIfDisposed(),_2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.equal=function(r){return this.throwIfDisposed(),$o(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.erf=function(){return this.throwIfDisposed(),Ule(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.euclideanNorm=function(r,t){return this.throwIfDisposed(),Zle(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.exp=function(){return this.throwIfDisposed(),Cu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.expandDims=function(r){return this.throwIfDisposed(),Sa(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.expm1=function(){return this.throwIfDisposed(),tce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.fft=function(){return this.throwIfDisposed(),q7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.flatten=function(){return this.throwIfDisposed(),ke(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.floor=function(){return this.throwIfDisposed(),D2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.floorDiv=function(r){return this.throwIfDisposed(),C7(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.gather=function(r,t){return this.throwIfDisposed(),X3(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.greaterEqual=function(r){return this.throwIfDisposed(),Wd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.greater=function(r){return this.throwIfDisposed(),Oa(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.ifft=function(){return this.throwIfDisposed(),qE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.irfft=function(){return this.throwIfDisposed(),jhe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.isFinite=function(){return this.throwIfDisposed(),lce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.isInf=function(){return this.throwIfDisposed(),hce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.isNaN=function(){return this.throwIfDisposed(),dce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.leakyRelu=function(r){return this.throwIfDisposed(),Y3(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.lessEqual=function(r){return this.throwIfDisposed(),Hd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.less=function(r){return this.throwIfDisposed(),F7(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.localResponseNormalization=function(r,t,n,s){return this.throwIfDisposed(),xce(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logSigmoid=function(){return this.throwIfDisposed(),_ce(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logSoftmax=function(r){return this.throwIfDisposed(),O7(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logSumExp=function(r,t){return this.throwIfDisposed(),Nce(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.log=function(){return this.throwIfDisposed(),Fo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.log1p=function(){return this.throwIfDisposed(),R7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logicalAnd=function(r){return this.throwIfDisposed(),_u(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logicalNot=function(){return this.throwIfDisposed(),Z3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logicalOr=function(r){return this.throwIfDisposed(),M7(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.logicalXor=function(r){return this.throwIfDisposed(),Fce(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.matMul=function(r,t,n){return this.throwIfDisposed(),On(this,r,t,n)};Ye().prototype.maxPool=function(r,t,n,s){return this.throwIfDisposed(),Q3(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.max=function(r,t){return this.throwIfDisposed(),Do(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.maximum=function(r){return this.throwIfDisposed(),Wl(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.mean=function(r,t){return this.throwIfDisposed(),jr(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.min=function(r,t){return this.throwIfDisposed(),HE(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.minimum=function(r){return this.throwIfDisposed(),J3(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.mirrorPad=function(r,t){return this.throwIfDisposed(),zce(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.mod=function(r){return this.throwIfDisposed(),Gce(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.mul=function(r){return this.throwIfDisposed(),De(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.neg=function(){return this.throwIfDisposed(),Wr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.norm=function(r,t,n){return this.throwIfDisposed(),E2(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.notEqual=function(r){return this.throwIfDisposed(),nb(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.oneHot=function(r,t=1,n=0){return this.throwIfDisposed(),f7(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.onesLike=function(){return this.throwIfDisposed(),Aa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.pad=function(r,t){return this.throwIfDisposed(),tN(this,r,t)};Ye().prototype.pool=function(r,t,n,s,i,a){return this.throwIfDisposed(),Qce(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.pow=function(r){return this.throwIfDisposed(),vd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.prelu=function(r){return this.throwIfDisposed(),rN(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.prod=function(r,t){return this.throwIfDisposed(),the(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.reciprocal=function(){return this.throwIfDisposed(),_he(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.relu=function(){return this.throwIfDisposed(),Th(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.relu6=function(){return this.throwIfDisposed(),P7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.reshapeAs=function(r){return this.throwIfDisposed(),ke(this,r.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.reshape=function(r){return this.throwIfDisposed(),ke(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.resizeBilinear=function(r,t,n){return this.throwIfDisposed(),Z7(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.resizeNearestNeighbor=function(r,t,n){return this.throwIfDisposed(),Q7(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.reverse=function(r){return this.throwIfDisposed(),oh(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.rfft=function(){return this.throwIfDisposed(),qhe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.round=function(){return this.throwIfDisposed(),V7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.rsqrt=function(){return this.throwIfDisposed(),z7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.selu=function(){return this.throwIfDisposed(),U7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.separableConv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),G7(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sigmoid=function(){return this.throwIfDisposed(),jd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sign=function(){return this.throwIfDisposed(),Fhe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sin=function(){return this.throwIfDisposed(),j7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sinh=function(){return this.throwIfDisposed(),W7(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.slice=function(r,t){return this.throwIfDisposed(),or(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.softmax=function(r){return this.throwIfDisposed(),oN(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.softplus=function(){return this.throwIfDisposed(),I0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.spaceToBatchND=function(r,t){return this.throwIfDisposed(),nN(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.split=function(r,t){return this.throwIfDisposed(),Xi(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sqrt=function(){return this.throwIfDisposed(),ei(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.square=function(){return this.throwIfDisposed(),gr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.squaredDifference=function(r){return this.throwIfDisposed(),Xhe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.squeeze=function(r){return this.throwIfDisposed(),$0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.stack=function(r,t){this.throwIfDisposed();const n=r instanceof Ur?[this,r]:[this,...r];return uh(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.step=function(r){return this.throwIfDisposed(),F0(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.stridedSlice=function(r,t,n,s,i,a,o,u){return this.throwIfDisposed(),efe(this,r,t,n,s,i,a,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sub=function(r){return this.throwIfDisposed(),Kt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.sum=function(r,t){return this.throwIfDisposed(),Vt(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.tan=function(){return this.throwIfDisposed(),nfe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.tanh=function(){return this.throwIfDisposed(),G3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.tile=function(r){return this.throwIfDisposed(),Za(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.toBool=function(){return this.throwIfDisposed(),_t(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.toFloat=function(){return this.throwIfDisposed(),_t(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.toInt=function(){return this.throwIfDisposed(),_t(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.topk=function(r,t){return this.throwIfDisposed(),sfe(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.transpose=function(r){return this.throwIfDisposed(),_n(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.unique=function(r){return this.throwIfDisposed(),ofe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.unsortedSegmentSum=function(r,t){return this.throwIfDisposed(),X7(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.unstack=function(r){return this.throwIfDisposed(),Sd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.where=function(r,t){return this.throwIfDisposed(),Ri(r,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ye().prototype.zerosLike=function(){return this.throwIfDisposed(),Nn(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class xo extends Error{constructor(t){super(t),Object.setPrototypeOf(this,xo.prototype)}}class Da extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Da.prototype)}}class Ce extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Ce.prototype)}}class un extends Error{constructor(t){super(t),Object.setPrototypeOf(this,un.prototype)}}class UN extends Error{constructor(t){super(t),Object.setPrototypeOf(this,UN.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DV{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let n;return this.cache.has(t)&&(n=this.cache.get(t),this.cache.delete(t),this.cache.set(t,n)),n}put(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let n=0;n<this.maxEntries-t;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ch(r,t){if(Array.isArray(r)){let n=[];for(let s=0;s<t;s++)n=n.concat(r);return n}else{const n=new Array(t);return n.fill(r),n}}function bo(r,t){if(!r)throw new UN(t)}function YO(r,t){let n=0;for(const s of r)s===t&&n++;return n}function li(r){return r.length===1?r[0]:r}function mr(r){return Array.isArray(r)?r:[r]}function uu(r){const n=r.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function kc(r){return r.length<=1||r.indexOf("_")===-1?r:r.replace(/[_]+(\w|$)/g,(t,n)=>n.toUpperCase())}let ma={};function GN(r){if(r==null)return null;const t={};return t.className=r.getClassName(),t.config=r.getConfig(),t}function XE(r){if(!(r==null||typeof r!="object"))if(Array.isArray(r))r.forEach(t=>XE(t));else{const t=Object.keys(r);for(const n of t){const s=r[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?r[n]=s.value:XE(s))}}}function L0(r,t={},n={},s="object",i=!1){if(typeof r=="string"){const a=r;let o;if(a in n)o=n[a];else if(a in ma)o=ma[a];else if(o=t[a],o==null)throw new Ce(`Unknown ${s}: ${r}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const a=r;if(a.className==null||a.config==null)throw new Ce(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const o=a.className;let u,l;if(o in n?[u,l]=n[o]:o in ma?[u,l]=ma.className:o in t&&([u,l]=t[o]),u==null)throw new Ce(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const g of Object.keys(ma))c[g]=ma[g];for(const g of Object.keys(n))c[g]=n[g];const h=a.config;h.customObjects=c;const f=Object.assign({},ma);for(const g of Object.keys(n))ma[g]=n[g];XE(a.config);const p=l(u,a.config,n,i);return ma=Object.assign({},f),p}else{const c=Object.assign({},ma);for(const f of Object.keys(n))ma[f]=n[f];const h=new u(a.config);return ma=Object.assign({},c),h}}}function yme(r,t){return r<t?-1:r>t?1:0}function By(r,t){return-1*yme(r,t)}function Dl(r){if(r==null)return r;const t=[];for(const n of r)t.indexOf(n)===-1&&t.push(n);return t}function xme(r){if(r==null)throw new Ce(`Invalid value in obj: ${JSON.stringify(r)}`);for(const t in r)if(r.hasOwnProperty(t))return!1;return!0}function Nh(r,t,n){if(n!=null&&r.indexOf(n)<0)throw new Ce(`${n} is not a valid ${t}.  Valid values are ${r} or null/undefined.`)}function jN(r,t,n=0,s=1/0){return bo(n>=0),bo(s>=n),Array.isArray(r)&&r.length>=n&&r.length<=s&&r.every(i=>typeof i===t)}function ps(r,t){Array.isArray(r)?(oe(r.length>0,()=>`${t} is unexpectedly an empty array.`),r.forEach((n,s)=>ps(n,`element ${s+1} of ${t}`))):oe(Number.isInteger(r)&&r>0,()=>`Expected ${t} to be a positive integer, but got ${TV(r)}.`)}function TV(r){return r===null?"null":Array.isArray(r)?"["+r.map(t=>TV(t)).join(",")+"]":typeof r=="string"?`"${r}"`:`${r}`}function bme(r,t,n){let s=n!=null?n():oi(),i;return(...o)=>{const u=n!=null?n():oi();return u-s<t||(s=u,i=r(...o)),i}}function NV(r){return r==="relu"?"relu":r==="linear"?"linear":r==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let vme=0;function kV(){return vme++}const Py={};function $2(r=""){return r in Py||(Py[r]=0),Py[r]+=1,r+Py[r].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wme=["channelsFirst","channelsLast"],Sme=["nearest","bilinear"],Cme=["valid","same","causal"],_me=["max","avg"],Eme=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ef=new Map;function Lr(r){Nh(wme,"DataFormat",r)}function Dme(r){Nh(Sme,"InterpolationFormat",r)}function ta(r){Nh(Cme,"PaddingMode",r)}function AV(r){Nh(_me,"PoolMode",r)}const Bm=[],ZO="/";function Bc(r,t){Bm.push(r);try{const n=t();return Bm.pop(),n}catch(n){throw Bm.pop(),n}}function Tme(){return Bm.length===0?"":Bm.join(ZO)+ZO}function IV(r){if(!FV(r))throw new Error("Not a valid tensor name: '"+r+"'");return Tme()+r}function $V(r){if(!FV(r))throw new Error("Not a valid tensor name: '"+r+"'");Ef.has(r)||Ef.set(r,0);const t=Ef.get(r);if(Ef.set(r,Ef.get(r)+1),t>0){const n=`${r}_${t}`;return Ef.set(n,1),n}else return r}const Nme=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function FV(r){return!!r.match(Nme)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kme(r){return r===parseInt(r.toString(),10)}function Tl(r,t,n){t==null&&(t=0),n==null&&(n=r.length);let s=1;for(let i=t;i<n;++i)s*=r[i];return s}function Cd(r){if(r.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let n=0;n<r.length;n++){const s=r[n];s<t&&(t=s)}return t}function Rl(r){if(r.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let n=0;n<r.length;n++){const s=r[n];s>t&&(t=s)}return t}function ro(r,t){if(t<r)throw new Ce(`end (${t}) < begin (${r}) is forbidden.`);const n=[];for(let s=r;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let m_;function Jr(){return m_==null&&(m_=Joe().epsilon()),m_}function so(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function B0(r,t){return _t(r,t)}function P0(r,t=-1){const n=r.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),ke(r,n)}function Ame(r,t){return Ue(()=>{if(r.shape.length!==2)throw new Ce(`repeat() expects a rank-2 tensor, but received a rank-${r.shape.length} tensor.`);const n=P0(r,1);return YE(n,[1,t,1])})}function Ime(r){const t=[Tl(r.shape)];return ke(r,t)}function $me(r){if(r.rank<=1)throw new Ce(`batchFlatten requires a minimum rank of 2. Got rank: ${r.rank}.`);const t=[r.shape[0],Tl(r.shape,1)];return ke(r,t)}function Pc(r,t,n){return Ue(()=>{switch(r.rank){case 1:return iN(r,t,n);case 2:return H7(r,[t,0],[n,r.shape[1]]);case 3:return aN(r,[t,0,0],[n,r.shape[1],r.shape[2]]);case 4:return sb(r,[t,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3]]);case 5:return or(r,[t,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4]]);case 6:return or(r,[t,0,0,0,0,0],[n,r.shape[1],r.shape[2],r.shape[3],r.shape[4],r.shape[5]]);default:throw new Ce(`sliceAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}})}function g_(r,t,n){return Ue(()=>{switch(r.rank){case 1:return iN(r,t,n);case 2:return H7(r,[0,t],[r.shape[0],n]);case 3:return aN(r,[0,0,t],[r.shape[0],r.shape[1],n]);case 4:return sb(r,[0,0,0,t],[r.shape[0],r.shape[1],r.shape[2],n]);default:throw new Ce(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function Vy(r,t,n,s){return Ue(()=>{switch(r.rank){case 1:return iN(r,t,n);case 2:switch(s){case 1:return Pc(r,t,n);case 2:return g_(r,t,n);default:throw new Ce(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Pc(r,t,n);case 2:return aN(r,[0,t,0],[r.shape[0],n,r.shape[2]]);case 3:return g_(r,t,n);default:throw new Ce(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Pc(r,t,n);case 2:return sb(r,[0,t,0,0],[r.shape[0],n,r.shape[2],r.shape[3]]);case 3:return sb(r,[0,0,t,0],[r.shape[0],r.shape[1],n,r.shape[3]]);case 4:return g_(r,t,n);default:throw new Ce(`The axis is not within the rank of the tensor ${s}`)}default:throw new Ce(`sliceAlongLastAxis() received an unsupported tensor rank: ${r.rank}`)}})}function WN(r,t=-1){let n;return t<0&&(n=r[0].rank,n!==0?t=n:t=0),t===r[0].rank&&(t=-1),fi(r,t)}function QO(r,t){switch(r.rank){case 1:return ule([r,t]);case 2:return cle([r,t],0);case 3:return fle([r,t],0);case 4:return ple([r,t],0);default:throw new Ce(`concatAlongFirstAxis() received an unsupported tensor rank: ${r.rank}`)}}function YE(r,t){if(Array.isArray(t)||(t=[t]),r.rank!==t.length)throw new Ce(`The length of input n (${t.length}) does not match the number of dimensions in input x (${r.rank})`);return Za(r,t)}function F2(r,t=0,n=1,s,i){return whe(r,t,n,s,i)}function No(r,t,n,s){if(r.rank<2||t.rank<2)throw new un(`dot requires both inputs to be rank >= 2 but got x shape = ${r.shape} and y shape = ${t.shape}`);if(t.rank>=3){const i=r.shape.slice(-1)[0],a=t.shape.slice(-2)[0];if(i!==a)throw new un(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${r.shape} and  y shape = ${t.shape}`)}if(r.rank===2&&t.rank===2)return PO({a:r,b:t,transposeA:!1,transposeB:!1,bias:s?ZE(r.rank,s,so()):null,activation:n});{const i=r.shape.slice(),a=i.pop();r=ke(r,[-1,a]);const o=t.shape.slice(),u=o.pop(),l=o.pop(),c=[...o,u],h=Array.from({length:t.rank},(y,x)=>x===0?t.rank-2:x<=t.rank-2?x-1:x);t=ke(_n(t,h),[l,-1]);const f=[...i,...c];return ke(PO({a:r,b:t,transposeA:!1,transposeB:!1,bias:s?ZE(r.rank,s,so()):null,activation:n}),f)}}function RV(r,t,n){return Ue(()=>(Array.isArray(t)?t=qi(t,"int32"):t=_t(t,"int32"),X3(r,t,n)))}function V0(r){return De(r,r)}function ZE(r,t,n){const s=t.shape;if(t.rank!==1&&t.rank!==r)throw new Ce(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${r}`);if(r===5){if(n==="channelsFirst")return s.length===1?ke(t,[1,s[0],1,1,1]):ke(t,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?ke(t,[1,1,1,1,s[0]]):ke(t,[1].concat(s))}else if(r===4){if(n==="channelsFirst")return s.length===1?ke(t,[1,s[0],1,1]):ke(t,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?ke(t,[1,1,1,s[0]]):ke(t,[1].concat(s))}else if(r===3){if(n==="channelsFirst")return s.length===1?ke(t,[1,s[0],1]):ke(t,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?ke(t,[1,1,s[0]]):ke(t,[1].concat(s))}else if(r<3)return t;throw new Ce(`Unsupported input rank by biasAdd: ${t.rank}`)}function ao(r,t,n){return Ue(()=>(n==null&&(n=so()),Lr(n),pt(r,ZE(r.rank,t,n))))}function Fme(r,t=1){if(t!==1)throw new un(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return _2(r)}function Rme(r){return Ue(()=>Ut(r,pt(Xs(r),1)))}function OV(r,t,n,s){return Ue(()=>dfe(r,t,n,s))}function Ome(r){return Ue(()=>{const t=pt(.5,De(.2,r));return Qi(t,0,1)})}function z0(r,t,n=!1){return n?r():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Mme=["fanIn","fanOut","fanAvg"],Lme=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bme(r){Nh(Mme,"FanMode",r)}function Pme(r){Nh(Lme,"Distribution",r)}class Ma extends Gd{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class MV extends Ma{apply(t,n){return hs(t,n)}}MV.className="Zeros";at(MV);class HN extends Ma{apply(t,n){return Dh(t,n)}}HN.className="Ones";at(HN);class LV extends Ma{constructor(t){if(super(),typeof t!="object")throw new Ce(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new Ce(`config must have value set but got ${t}`);this.value=t.value}apply(t,n){return Ue(()=>De(Ln(this.value),Dh(t,n)))}getConfig(){return{value:this.value}}}LV.className="Constant";at(LV);class BV extends Ma{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,n){return T2(t,this.minval,this.maxval,n)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}BV.className="RandomUniform";at(BV);class PV extends Ma{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new un(`randomNormal does not support dType ${n}.`);return F2(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}PV.className="RandomNormal";at(PV);class VV extends Ma{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new un(`truncatedNormal does not support dType ${n}.`);return K7(t,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VV.className="TruncatedNormal";at(VV);let zV=class extends Ma{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,n){return Ue(()=>{if(t.length!==2||t[0]!==t[1])throw new Ce("Identity matrix initializer can only be used for 2D square matrices.");return De(this.gain,$7(t[0]))})}getConfig(){return{gain:this.gain}}};zV.className="Identity";at(zV);function Vme(r,t="channelsLast"){let n,s;if(Lr(t),r.length===2)n=r[0],s=r[1];else if([3,4,5].indexOf(r.length)!==-1){if(t==="channelsFirst"){const i=Tl(r,2);n=r[1]*i,s=r[0]*i}else if(t==="channelsLast"){const i=Tl(r,0,r.length-2);n=r[r.length-2]*i,s=r[r.length-1]*i}}else{const i=Tl(r);n=Math.sqrt(i),s=Math.sqrt(i)}return[n,s]}class Oi extends Ma{constructor(t){if(super(),t.scale<0)throw new Ce(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,Bme(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,Pme(this.distribution),this.seed=t.seed}apply(t,n){const s=Vme(t),i=s[0],a=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,i):this.mode==="fanOut"?o/=Math.max(1,a):o/=Math.max(1,(i+a)/2),this.distribution==="normal"){const u=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new un(`${this.getClassName()} does not support dType ${n}.`);return K7(t,0,u,n,this.seed)}else{const u=Math.sqrt(3*o);return T2(t,-u,u,n)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Oi.className="VarianceScaling";at(Oi);class qN extends Oi{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}qN.className="GlorotUniform";at(qN);class KN extends Oi{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}KN.className="GlorotNormal";at(KN);class XN extends Oi{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}XN.className="HeNormal";at(XN);class YN extends Oi{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}YN.className="HeUniform";at(YN);class ZN extends Oi{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}ZN.className="LeCunNormal";at(ZN);class QN extends Oi{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return Oi.className}}QN.className="LeCunNormal";at(QN);class UV extends Ma{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,this.seed!=null)throw new un("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,n){return Ue(()=>{if(t.length<2)throw new un("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const s=t[0]>t[1]?[t[1],t[0]]:t,i=F2(s,0,1,"float32");let a=ode.gramSchmidt(i);return t[0]>t[1]&&(a=_n(a)),De(this.gain,a)})}getConfig(){return{gain:this.gain,seed:this.seed}}}UV.className="Orthogonal";at(UV);const JO={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function eM(r,t={}){return L0(r,Ea.getMap().classNameMap,t,"initializer")}function Er(r){return GN(r)}function xr(r){if(typeof r=="string"){const t=r in JO?JO[r]:r;if(t==="GlorotNormal")return new KN;if(t==="GlorotUniform")return new qN;if(t==="HeNormal")return new XN;if(t==="HeUniform")return new YN;if(t==="LeCunNormal")return new ZN;if(t==="LeCunUniform")return new QN;{const n={};return n.className=t,n.config={},eM(n)}}else return r instanceof Ma?r:eM(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QE(r){return Array.isArray(r)&&Array.isArray(r[0])}function ib(r){return r.length===0?[]:Array.isArray(r[0])?r:[r]}function rn(r){let t;if(Array.isArray(r)){if(r.length!==1)throw new Ce(`Expected Tensor length to be 1; got ${r.length}`);t=r[0]}else t=r;return t}function Wn(r){if(Array.isArray(r)&&Array.isArray(r[0])){if(r.length===1)return r=r,r[0];throw new Ce(`Expected exactly 1 Shape; got ${r.length}`)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ab(r){let t=0;for(const n of r)n.shape.length===0?t+=1:t+=n.shape.reduce((s,i)=>s*i);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const tM="Variable";class zme{constructor(t,n="float32",s=tM,i=!0,a=null){this.dtype=n??"float32",this.shape=t.shape,this.id=kV(),s=s??tM,this.originalName=IV(s),this.name=$V(this.originalName),this.trainable_=i,this.constraint=a,this.val=cfe(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),Ume(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function Ume(r,t){if(r.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(r.shape)+" vs. "+JSON.stringify(t.shape))}function JE(r){return r.map(t=>t.read())}function JN(r){r.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class es{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Co{constructor(t,n,s,i,a,o,u){this.dtype=t,this.shape=n,this.sourceLayer=s,this.inputs=i,this.callArgs=a,this.outputTensorIndex=u,this.id=kV(),o!=null&&(this.originalName=IV(o),this.name=$V(this.originalName)),this.rank=n.length}}let Gme=0;class R2{constructor(t,n){this.callArgs=n,this.id=Gme++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const s of t.inboundLayers)s!=null&&s.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const n of this.inboundLayers)n!=null?t.push(n.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let jme=0;class Dn extends Gd{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=jme++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=t.name;if(!n){const s=this.getClassName();n=uu(s)+"_"+$2(s)}if(this.name=n,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let s;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){let a=null;t.batchSize!=null&&(a=t.batchSize),s=[a].concat(t.inputShape)}this.batchInputShape=s;let i=t.dtype;i==null&&(i=t.inputDType),i==null&&(i="float32"),this.dtype=i}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,n){return t.name+"_ib-"+n.toString()}getNodeAtIndex(t,n){if(this.inboundNodes.length===0)throw new Da(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=t)throw new Ce(`Asked to get ${n} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return li(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return li(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new xo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new xo(`Layer ${this.name} is not connected, no input to return.`);return li(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new xo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new xo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return li(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(n=>n.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=mr(t),this.inputSpec==null||this.inputSpec.length===0)return;const n=mr(this.inputSpec);if(t.length!==n.length)throw new Ce(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let s=0;s<t.length;s++){const i=t[s],a=n[s];if(a==null)continue;const o=i.rank;if(a.ndim!=null&&o!==a.ndim)throw new Ce(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${o}`);if(a.maxNDim!=null&&o>a.maxNDim)throw new Ce(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${o}`);if(a.minNDim!=null&&o<a.minNDim)throw new Ce(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${o}.`);if(a.dtype!=null&&i.dtype!==a.dtype)throw new Ce(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${i.dtype}.`);if(a.axes){const u=i.shape;for(const l in a.axes){const c=Number(l),h=a.axes[l],f=c>=0?u[c]:u[u.length+c];if(h!=null&&[h,null].indexOf(f)===-1)throw new Ce(`Input ${s} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${h} but got shape ${u}.`)}}if(a.shape!=null)for(let u=0;u<a.shape.length;++u){const l=a.shape[u],c=i.shape[u];if(l!=null&&c!=null&&l!==c)throw new Ce(`Input ${s} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${i.shape}.`)}}}call(t,n){return t}invokeCallHook(t,n){this._callHook!=null&&this._callHook(t,n)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,n){n=n||{},this.assertNotDisposed();const s=mr(t);let i=!0;for(const o of s)if(!(o instanceof Co)){i=!1;break}let a=!0;for(const o of s)if(o instanceof Co){a=!1;break}if(i===a)throw new Ce("Arguments to apply() must be all SymbolicTensors or all Tensors");return Bc(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const o=[];for(const u of mr(t))o.push(u.shape);this.build(li(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let o=this.call(t,n);const u=mr(o),l=[];for(let c of u)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(o=li(l),this.activityRegularizer!=null)throw new un("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=Wme(t),u=this.computeOutputShape(o);let l;const c=Hme(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?o[0]:o),u!=null&&u.length>0&&Array.isArray(u[0])?l=u.map((h,f)=>new Co(c,h,this,mr(t),n,this.name,f)):l=new Co(c,u,this,mr(t),n,this.name),this.addInboundNode(t,l,null,null,o,u,n),this._refCount++,this.activityRegularizer!=null)throw new un("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,i)=>{s!=null&&t[i]!=null&&t[i]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new xo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new xo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Da(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return ab(this.weights)}build(t){this.built=!0}getWeights(t=!1){return JE(t?this.trainableWeights:this.weights)}setWeights(t){Ue(()=>{const n=this.weights;if(n.length!==t.length)throw new Ce(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${n.length} weights. Provided weights: ${t}...`);if(n.length===0)return;const s=[],i=JE(n);for(let a=0;a<i.length;++a){const o=i[a],u=n[a],l=t[a];if(!Bn(o.shape,l.shape))throw new Ce(`Layer weight shape ${o.shape} not compatible with provided weight shape ${l.shape}`);s.push([u,l])}JN(s)})}addWeight(t,n,s,i,a,o,u,l){if(this._addedWeightNames.indexOf(t)!==-1)throw new Ce(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():xr("zeros"));const c=i.apply(n,s),h=new zme(c,s,t,o,u);return c.dispose(),a!=null&&this.addLoss(()=>a.apply(h.read())),o==null&&(o=!0),o?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=mr(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(t,n,s,i,a,o,u=null){const l=mr(t);n=mr(n),s=mr(s),i=mr(i),a=ib(a),o=ib(o);const c=[],h=[],f=[];for(const p of l)c.push(p.sourceLayer),h.push(p.nodeIndex),f.push(p.tensorIndex);new R2({outboundLayer:this,inboundLayers:c,nodeIndices:h,tensorIndices:f,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:i,inputShapes:a,outputShapes:o},u);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Wme(r){r=mr(r);const t=[];for(const n of r)t.push(n.shape);return li(t)}function Hme(r){return"float32"}function GV(r,t,n){if((t==null||n!=null&&n>0)&&(t=r.sourceLayer,n=r.nodeIndex),t.inboundNodes.length===0)return[r];{const s=t.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const i=[];for(let a=0;a<s.inboundLayers.length;a++){const o=s.inputTensors[a],u=s.inboundLayers[a],l=s.nodeIndices[a],c=GV(o,u,l);for(const h of c)i.indexOf(h)===-1&&i.push(h)}return i}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class U0 extends Dn{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:$2("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new Ce("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=t.batchInputShape;if(n==null){if(t.inputShape==null)throw new Ce("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new Ce("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=t.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const i=new Co(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new R2({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(t,n){throw new Ce(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}U0.className="InputLayer";at(U0);function qme(r){if(r.batchShape==null&&r.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(r.batchShape!=null&&r.shape!=null)throw new Ce("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=r.batchShape;r.shape!=null&&t==null&&(t=[null].concat(r.shape));let n=r.dtype;return n==null&&(n="float32"),new U0({batchInputShape:t,name:r.name,dtype:n,sparse:r.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kme(r,t){if(r.dtype==null||r.dtype===t.dtype)return t;try{return _t(t,r.dtype)}catch{throw new Ce(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${r.name}' (${r.dtype}).`)}}class yl{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof yl)for(const n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(t==null)return;for(const n of t)this.add(n.key,n.value)}}add(t,n,s){if(this.id2Value[t.id]==null)this.id2Value[t.id]=Kme(t,n),this.name2Id[t.name]=t.id,s!=null&&(this.id2Mask[t.id]=s);else throw new Ce(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Co){if(this.id2Value[t.id]==null)throw new Ce(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Ce(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[n]}}getMask(t){if(t instanceof Co){if(this.id2Value[t.id]==null)throw new Ce(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const n=this.name2Id[t];if(n==null)throw new Ce(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&gn(this.id2Mask)}}const ob=new DV,ub=new DV;function Xme(r){ob!=null&&ob.setMaxEntries(r),ub!=null&&ub.setMaxEntries(r)}function wm(r,t,n,s){const i=n==null?!1:n.training,a=Array.isArray(r),o=a?r:[r],u=o.map(y=>y.name),l=[],c=t.names();for(const y of u)c.indexOf(y)!==-1?l.push(t.getValue(y)):l.push(null);const h=u.join(",")+"|"+t.names().sort().join(",");let f=ob.get(h),p;if(f==null){const y=Yme(o,t);f=y.sorted,p=y.recipientCounts,ob.put(h,f),ub.put(h,p)}p={},i||Object.assign(p,ub.get(h));const g=new yl(t);for(let y=0;y<f.length;++y){const x=f[y],v=x.sourceLayer;if(v instanceof U0)continue;const S=[],w=[],E=[];let _=!1;for(const N of x.inputs){const F=g.getValue(N),$=g.getMask(N);S.push(F),w.push($),$!=null&&(_=!0),i||(p[N.name]--,p[N.name]===0&&!t.hasKey(N)&&u.indexOf(N.name)===-1&&!F.isDisposed&&N.sourceLayer.stateful!==!0&&E.push(F))}_&&(n=n||{},n.mask=w[0]);const D=mr(v.apply(S,n));let I=null;v.supportsMasking&&(I=v.computeMask(S,w));const k=Qme(x),A=Array.isArray(k)?k:[k];for(let N=0;N<A.length;++N){g.hasKey(A[N])||g.add(A[N],D[N],Array.isArray(I)?I[0]:I);const F=u.indexOf(A[N].name);F!==-1&&(l[F]=D[N])}i||gn(E)}return g.disposeMasks(),a?l:l[0]}function Yme(r,t){oe(r!=null&&r.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(r.length===1){const i=nM(r[0],t);n=i.sorted,s=i.recipientMap}else{const i=new Set;for(const a of r){const{sorted:o,recipientMap:u}=nM(a,t);for(const l of o)i.has(l.name)||(n.push(l),i.add(l.name));for(const l in u)s[l]==null&&(s[l]=new Set),u[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:Zme(s)}}function Zme(r){const t={};for(const n in r)t[n]=r[n].size;return t}function nM(r,t){const n=new Set,s=[],i={};for(const u of t.names())n.add(u);const a=[],o=[];for(a.push(r);a.length>0;){const u=a[a.length-1];if(n.has(u.name)){a.pop();continue}const l=o[o.length-1]===a.length-1;if(u.inputs.length===0||l)a.pop(),s.push(u),n.add(u.name),l&&o.pop();else{o.push(a.length-1);for(const c of u.inputs)i[c.name]==null&&(i[c.name]=new Set),i[c.name].add(u.name),!n.has(c.name)&&a.push(c)}}return{sorted:s,recipientMap:i}}function Qme(r){let t;if(r.sourceLayer.inboundNodes.length===1)t=r.sourceLayer.output;else{let n=null;for(let s=0;s<r.sourceLayer.inboundNodes.length;++s)for(const i of r.sourceLayer.inboundNodes[s].outputTensors)if(i.id===r.id){n=s;break}t=r.sourceLayer.getOutputAt(n)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jme=Ke();Jme.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Xme);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ek(r,t){return Ue(()=>ei(Vt(De(r,r),t,!0)))}class G0 extends Gd{getConfig(){return{}}}class jV extends G0{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Ue(()=>{const n=ek(t,this.axis),s=Qi(n,0,this.maxValue);return De(t,Ut(s,pt(Jr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}jV.className="MaxNorm";at(jV);class WV extends G0{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Ue(()=>Ut(t,pt(Jr(),ek(t,this.axis))))}getConfig(){return{axis:this.axis}}}WV.className="UnitNorm";at(WV);class HV extends G0{apply(t){return Th(t)}}HV.className="NonNeg";at(HV);class qV extends G0{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return Ue(()=>{const n=ek(t,this.axis),s=pt(De(this.rate,Qi(n,this.minValue,this.maxValue)),De(1-this.rate,n));return De(t,Ut(s,pt(Jr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qV.className="MinMaxNorm";at(qV);const rM={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ts(r){return GN(r)}function sM(r,t={}){return L0(r,Ea.getMap().classNameMap,t,"constraint")}function ns(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in rM?rM[r]:r,config:{}};return sM(n)}else return r instanceof G0?r:sM(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function yc(r){if(r==null)return;const t=[],n=[],s=[];for(const i in r){const a=r[i];if(typeof a!="number"){const o=a;t.push(o.data()),n.push(i),s.push(o)}}if(t.length>0){const i=await Promise.all(t);for(let a=0;a<i.length;++a)r[n[a]]=i[a][0];gn(s)}}function KV(r){if(r!=null)for(const t in r){const n=r[t];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var iM;(function(r){r[r.SILENT=0]="SILENT",r[r.VERBOSE=1]="VERBOSE"})(iM||(iM={}));const ege=125;class fg{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,n){}async onEpochEnd(t,n){}async onBatchBegin(t,n){}async onBatchEnd(t,n){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class tge{constructor(t,n=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=n}append(t){this.callbacks.push(t)}setParams(t){for(const n of this.callbacks)n.setParams(t)}setModel(t){for(const n of this.callbacks)n.setModel(t)}async onEpochBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(t,n)}async onEpochEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(t,n)}async onBatchBegin(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(t,n)}async onBatchEnd(t,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(t,n)}async onTrainBegin(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const n of this.callbacks)await n.onTrainEnd(t)}}class nge extends fg{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const i in n){const a=n[i];if(typeof a=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+a*s;else{let o;i in this.totals?o=this.totals[i]:this.totals[i]=0;const u=Ue(()=>pt(this.totals[i],De(a,s)));this.totals[i]=u,o!=null&&o.dispose()}}}async onEpochEnd(t,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:Ue(()=>{const i=De(Ut(1,this.seen),this.totals[s]);n[s]=i,this.totals[s].dispose(),Io(n[s])}))}}class rge extends fg{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,n){n==null&&(n={}),this.epoch.push(t);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const t=[],n=[],s=[];for(const a in this.history){const o=this.history[a];for(let u=0;u<o.length;++u)if(typeof o[u]!="number"){const l=o[u];t.push(l.data()),n.push(a),s.push(u)}}const i=await Promise.all(t);for(let a=0;a<i.length;++a)this.history[n[a]][s[a]].dispose(),this.history[n[a]][s[a]]=i[a][0]}}class sge extends fg{constructor(t,n){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||J7,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=ege),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");TE(this.yieldEvery)&&(this.maybeWait=bme(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,n,s){const i=[];this.yield!=null&&(await yc(s),i.push(this.yield(t,n,s))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(t,n){this.currentEpoch=t,this.epochBegin!=null&&(await yc(n),await this.epochBegin(t,n))}async onEpochEnd(t,n){const s=[];this.epochEnd!=null&&(await yc(n),s.push(this.epochEnd(t,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(t,n){this.batchBegin!=null&&(await yc(n),await this.batchBegin(t,n))}async onBatchEnd(t,n){const s=[];this.batchEnd!=null&&(await yc(n),s.push(this.batchEnd(t,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):TE(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,t,n)),await Promise.all(s)}async onTrainBegin(t){this.trainBegin!=null&&(await yc(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await yc(t),await this.trainEnd(t))}}function XV(r,t){return r==null&&(r={}),r instanceof fg?[r]:Array.isArray(r)&&r[0]instanceof fg?r:mr(r).map(s=>new sge(s,t))}class xa{constructor(){}static registerCallbackConstructor(t,n){oe(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),xa.checkForDuplicate(n),xa.constructors[t]==null&&(xa.constructors[t]=[]),xa.constructors[t].push(n)}static checkForDuplicate(t){for(const n in xa.constructors)xa.constructors[+n].forEach(i=>{if(i===t)throw new Ce("Duplicate callback constructor.")})}static clear(){xa.constructors={}}static createCallbacks(t){const n=[];for(const s in xa.constructors){const i=+s;t>=i&&n.push(...xa.constructors[i])}return n.map(s=>new s)}}xa.constructors={};function YV(r,t,n,s,i,a,o,u,l){const c=new rge,h=[new nge,...xa.createCallbacks(t)];r!=null&&h.push(...r),h.push(c);const f=new tge(h);return f.setParams({epochs:n,initialEpoch:s,samples:i,steps:a,batchSize:o,verbose:t,doValidation:u,metrics:l}),{callbackList:f,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yu(r,t={},n=!1){return L0(r,Ea.getMap().classNameMap,t,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lb(r,t){return Ue(()=>{r.dtype!=="float32"&&(r=_t(r,"float32"));const n=Vt(V0(r),t,!0),s=C2(n.shape,Jr()),i=ei(Wl(n,s));return Ut(r,i)})}function O2(r,t){return Ue(()=>jr(V0(Kt(t,r)),-1))}function tk(r,t){return Ue(()=>jr(Xs(Kt(t,r)),-1))}function nk(r,t){return Ue(()=>{const n=Kt(r,t),s=Qi(Xs(r),Jr(),Number.MAX_VALUE),i=Xs(Ut(n,s));return De(100,jr(i,-1))})}function ige(r,t){return Ue(()=>{const n=Qi(t,Jr(),Number.MAX_VALUE),s=Fo(pt(1,n)),i=Qi(r,Jr(),Number.MAX_VALUE),a=Fo(pt(1,i));return jr(V0(Kt(s,a)),-1)})}function age(r,t){return Ue(()=>{const n=Wl(0,Kt(1,De(r,t)));return jr(V0(n),-1)})}function oge(r,t){return Ue(()=>{const n=Wl(0,Kt(1,De(r,t)));return jr(n,-1)})}function uge(r,t){return Ue(()=>{const n=Vt(De(r,t),-1),s=Do(De(Kt(1,r),t),-1);return Wl(0,pt(1,Kt(s,n)))})}function lge(r,t){return Ue(()=>{const n=Math.log(2),s=Kt(t,r),i=Kt(pt(s,I0(De(-2,s))),n);return jr(i,-1)})}function dg(r,t,n=!1){return Ue(()=>{if(n)t=oN(t);else{const s=Vt(t,t.shape.length-1,!0);t=Ut(t,s)}return t=Qi(t,Jr(),1-Jr()),Wr(Vt(De(_t(r,"float32"),Fo(t)),t.shape.length-1))})}function cb(r,t,n=!1){return Ue(()=>{const s=_t(D2(Ime(r)),"int32");t=Qi(t,Jr(),1-Jr());const i=t.shape,a=ke(f7(s,i[i.length-1]),i);return dg(a,t,n)})}function cge(r,t){if(!Bn(r.shape,t.shape))throw new Ce(`logits and labels must have the same shape, but got shapes ${JSON.stringify(r.shape)} and ${JSON.stringify(t.shape)}`);return Ue(()=>{const n=Th(t),s=Wr(Xs(t));return pt(Kt(n,De(t,r)),R7(Cu(s)))})}function M2(r,t){return Ue(()=>{let n;return n=Qi(t,Jr(),1-Jr()),n=Fo(Ut(n,Kt(1,n))),jr(cge(r,n),-1)})}function hge(r,t){return Ue(()=>{const n=Qi(r,Jr(),1),s=Qi(t,Jr(),1);return Vt(De(r,Fo(Ut(n,s))),-1)})}function fge(r,t){return Ue(()=>{const n=Fo(pt(Jr(),t));return jr(Kt(t,De(r,n)),-1)})}function ZV(r,t){return Ue(()=>{const n=lb(r,-1),s=lb(t,-1),i=De(n,s);return Wr(Vt(i,-1))})}const hb={meanSquaredError:O2,meanAbsoluteError:tk,meanAbsolutePercentageError:nk,meanSquaredLogarithmicError:ige,squaredHinge:age,hinge:oge,categoricalHinge:uge,logcosh:lge,categoricalCrossentropy:dg,sparseCategoricalCrossentropy:cb,binaryCrossentropy:M2,kullbackLeiblerDivergence:hge,poisson:fge,cosineProximity:ZV};function y_(r){if(typeof r=="string"){if(r in hb)return hb[r];let t=`Unknown loss ${r}`;throw r.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${r}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Ce(t)}else return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QV(r,t){return Ue(()=>{const n=De(.5,Aa(t)),s=B0(Oa(t,n),r.dtype);return jr($o(r,s),-1)})}function JV(r,t){return Ue(()=>B0($o(hg(r,-1),hg(t,-1)),"float32"))}function dge(r,t){return Ue(()=>_t(Vt(_u($o(r,1),$o(t,1))),"float32"))}function pge(r,t){return Ue(()=>_t(Vt(_u($o(r,0),$o(t,1))),"float32"))}function mge(r,t){return Ue(()=>{const n=dge(r,t),s=pge(r,t),i=pt(n,s);return _t(Ri(Oa(i,0),Ut(n,i),0),"float32")})}function gge(r,t){return M2(r,t)}function yge(r,t){return r.rank===t.rank&&(r=$0(r,[r.rank-1])),t=hg(t,-1),t.dtype!==r.dtype&&(t=_t(t,r.dtype)),_t($o(r,t),"float32")}const xge=O2,bge=O2,vge=tk,wge=tk,Sge=nk,Cge=nk,ez=dg,_ge=ZV,tz=cb,fb={binaryAccuracy:QV,categoricalAccuracy:JV,precision:mge,categoricalCrossentropy:ez,sparseCategoricalCrossentropy:tz,mse:xge,MSE:bge,mae:vge,MAE:wge,mape:Sge,MAPE:Cge,cosine:_ge};function Ege(r){if(typeof r=="string"&&r in fb)return fb[r];if(typeof r!="string"&&r!=null)return r;throw new Ce(`Unknown metric ${r}`)}function zy(r){if(bo(r!==null,`Unknown LossOrMetricFn ${r}`),typeof r=="string")return r;{let t;for(const n of Object.keys(hb))if(hb[n]===r){t=n;break}if(t!==void 0)return t;for(const n of Object.keys(fb))if(fb[n]===r){t=n;break}return t!==void 0?t:r.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Dge(r){const t={Adagrad:()=>_f.adagrad(.01),Adadelta:()=>_f.adadelta(1,.95,Jr()),Adam:()=>_f.adam(.001,.9,.999,Jr()),Adamax:()=>_f.adamax(.002,.9,.999,Jr(),0),RMSProp:()=>_f.rmsprop(.001,.9,0,Jr()),SGD:()=>_f.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,r in t)return t[r]();throw new Ce(`Unknown Optimizer ${r}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const aM=1*1024*1024;function oM(r,t,n=!1){if(r==null||typeof r!="object"||Object.getPrototypeOf(r)!==Object.prototype||!eD(r))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(r);s.length>aM&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${aM}.`)}}function eD(r){if(r===null)return!0;if(typeof r=="object")if(Object.getPrototypeOf(r)===Object.prototype){const t=Object.keys(r);for(const n of t)if(typeof n!="string"||!eD(r[n]))return!1;return!0}else if(Array.isArray(r)){for(const t of r)if(!eD(t))return!1;return!0}else return!1;else{const t=typeof r;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tge(r,t,n,s=console.log){const i=kge(r),a=["Layer (type)","Input Shape","Output shape","Param #"];i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(h=>Math.floor(t*h)));let o;if(!i){a.push("Receives inputs"),o=[];for(const h in r.nodesByDepth)o.push(...r.nodesByDepth[h])}s("_".repeat(t)),db(a,n,s),s("=".repeat(t));const u=r.layers;for(let h=0;h<u.length;++h)i?Age(u[h],n,s):Ige(u[h],n,o,s),s((h===u.length-1?"=":"_").repeat(t));r.checkTrainableWeightsConsistency();const l=Nge(r),c=ab(r.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(t))}function Nge(r){let t;return r.collectedTrainableWeights!=null?t=ab(r.collectedTrainableWeights):t=ab(r.trainableWeights),t}function kge(r){let t=!0;const n=[],s=[];for(const i in r.nodesByDepth)n.push(r.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){t=!1;break}s.push(...i)}if(t)for(const i of r.layers){let a=!1;for(const o of i.inboundNodes)if(s.indexOf(o)!==-1)if(a){t=!1;break}else a=!0;if(!t)break}return t}function db(r,t,n=console.log){let s="";for(let i=0;i<r.length;++i)i>0&&(s=s.slice(0,s.length-1)+" "),s+=r[i],s=s.slice(0,t[i]),s+=" ".repeat(t[i]-s.length);n(s)}function Age(r,t,n){let s,i;try{i=r.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{s=JSON.stringify(r.outputShape)}catch{s="multiple"}const a=r.name,o=r.getClassName(),u=[`${a} (${o})`,i,s,r.countParams().toString()];db(u,t,n)}function Ige(r,t,n,s){let i,a;try{a=r.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{a="multiple"}try{i=JSON.stringify(r.outputShape)}catch{i="multiple"}const o=[];for(const f of r.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let p=0;p<f.inboundLayers.length;++p){const g=f.inboundLayers[p].name,y=f.nodeIndices[p],x=f.tensorIndices[p];o.push(`${g}[${y}][${x}]`)}const u=r.name,l=r.getClassName(),c=o.length===0?"":o[0],h=[`${u} (${l})`,a,i,r.countParams().toString(),c];db(h,t,s);for(let f=1;f<o.length;++f)db(["","","","",o[f]],t,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nz(r,t,n){return(r==="inboundNodes"||r==="outputLayers"||r==="inputLayers")&&t===0&&typeof n=="string"}function tD(r,t){if(r===null)return null;if(typeof r=="string")return kc(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],s=r.length;for(let i=0;i<s;++i){const a=r[i];nz(t,i,a)?n.push(a):n.push(tD(a,t))}return n}else{const n={};for(const s of Object.keys(r)){const i=r[s];if(s==="name"&&typeof i=="string")n[s]=i;else{const a=kc(s);n[a]=tD(i,a)}}return n}}function nD(r,t){if(r==null)return null;if(typeof r=="string")return uu(r);if(typeof r=="number"||typeof r=="boolean")return r;if(r instanceof Array){const n=[],s=r.length;for(let i=0;i<s;++i){const a=r[i];nz(t,i,a)?n.push(a):n.push(nD(a,t))}return n}else{const n={};for(const s of Object.keys(r)){const i=r[s],a=uu(s);(s==="name"||s==="className")&&typeof i=="string"?n[a]=i:n[a]=nD(i,s)}return n}}/** @license See the LICENSE file. */const rz="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ga extends Dn{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const w=this.getClassName().toLowerCase();this.name=$2(w)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Dl(this.inputs).length!==this.inputs.length)throw new Ce(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(w=>w.name)}`);Dl(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(w=>w.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const w of this.outputs){const E=w.sourceLayer,_=w.nodeIndex,D=w.tensorIndex;this.outputLayers.push(E),this.outputLayersNodeIndices.push(_),this.outputLayersTensorIndices.push(D)}for(const w of this.inputs){const E=w.sourceLayer,_=w.nodeIndex,D=w.tensorIndex;bo(_===0,"input layer has >1 nodes"),bo(D===0,"input layer has >1 tensors"),this.inputLayers.push(E),this.inputLayersNodeIndices.push(_),this.inputLayersTensorIndices.push(D)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let w=0;w<this.inputLayers.length;w++){const E=this.inputLayers[w];if(!(E instanceof U0))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${w} (0-based) originates from layer type ${E.getClassName()}.`);this.inputNames.push(E.name),this.feedInputShapes.push(E.batchInputShape),this.feedInputNames.push(E.name)}for(const w of this.outputLayers)this.outputNames.push(w.name);this.internalInputShapes=this.inputs.map(w=>w.shape),this.internalOutputShapes=this.outputs.map(w=>w.shape);const n={},s={},i={},a={},o={},u=[],l=(w,E,_,D,I,k)=>{(D==null||I==null||k==null)&&(D=w.sourceLayer,I=w.nodeIndex,k=w.tensorIndex);const A=D.inboundNodes[I];if(_.indexOf(A)!==-1)throw new Da(`The tensor ${w.name} at layer "${D.name}" is part of a cycle.`);if(E.indexOf(A)!==-1)return;this.containerNodes.add(Ga.nodeKey(D,I)),D.id in o||(o[D.id]=Object.keys(o).length),_.indexOf(A)===-1&&_.push(A);const N=A.inboundLayers.length;for(let F=0;F<N;F++){const $=A.inputTensors[F],O=A.inboundLayers[F],M=A.nodeIndices[F],B=A.tensorIndices[F];l($,E,_,O,M,B)}for(E.push(A);_.indexOf(A)>=0;)_.splice(_.indexOf(A),1);u.push(A)},c=[],h=[];for(const w of this.outputs)l(w,c,h);const f=u.slice().reverse();for(const w of f){s[w.id]=w,w.id in n||(n[w.id]=0);let E=n[w.id];const _=i[w.outboundLayer.id]==null?0:i[w.outboundLayer.id];E=Math.max(E,_),i[w.outboundLayer.id]=E,a[w.outboundLayer.id]=w.outboundLayer,n[w.id]=E;for(let D=0;D<w.inboundLayers.length;D++){const I=w.inboundLayers[D],k=w.nodeIndices[D],A=I.inboundNodes[k],N=n[A.id]==null?0:n[A.id];n[A.id]=Math.max(E+1,N),s[A.id]=A}}const p={};for(const w in n){const E=n[w];E in p||(p[E]=[]),p[E].push(s[w])}const g={};for(const w in i){const E=i[w];E in g||(g[E]=[]),g[E].push(a[w])}let y=Object.keys(g).map(w=>parseInt(w,10)).sort(By);this.layers=[];for(const w of y){const E=g[w];E.sort((_,D)=>{const I=o[_.id],k=o[D.id];return I<k?-1:I>k?1:0});for(const _ of E)_ instanceof Ga&&this.internalContainerRefs.push(_),this.layers.push(_)}this.layersByDepth=g,y=Object.keys(p).map(w=>parseInt(w,10)).sort(By);const x=this.inputs.slice(),v=[];for(const w of y)for(const E of p[w]){const _=E.outboundLayer;if(_!=null){for(const D of E.inputTensors)if(x.indexOf(D)===-1)throw new Da(`Graph disconnected: cannot obtain value for tensor ${D} at layer "${_.name}". The following previous layers were accessed without issue: ${v}`);for(const D of E.outputTensors)x.push(D);v.push(_.name)}}this.nodesByDepth=p;const S=this.layers.map(w=>w.name);for(const w of S){const E=S.filter(_=>_===w).length;if(E!==1)throw new Da(`The name "${w}" is used ${E} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(S))}this.outboundNodes=[],this.inboundNodes=[],new R2({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(w=>null),outputMasks:this.outputs.map(w=>null),inputShapes:this.inputs.map(w=>w.shape),outputShapes:this.outputs.map(w=>w.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)t.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)t.numDisposedVariables+=n.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Ce("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const n of this.layers)t=t.concat(n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.layers)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,n=!0){const s={};let i=0;for(const o of this.layers)for(const u of o.weights){if(s[u.originalName]!=null)throw new Ce(`Duplicate weight name: ${u.originalName}`);s[u.originalName]=u,i++}const a=[];for(const o in t){let u=o;if(s[o]==null){const l=o.split("/");u=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(s[u]!=null)a.push([s[u],t[o]]);else if(n)throw new Ce(`Provided weight data has no target variable: ${o}`);delete s[u]}if(n){const o=[];for(const u in s)o.push(u);if(o.length>0)throw new Ce(`${o.length} of ${i} weights are not set: ${o}`)}JN(a)}updatedConfig(){const t=this.getConfig(),n={};return n.className=this.getClassName(),n.config=t,n.kerasVersion=`tfjs-layers ${rz}`,n.backend="TensorFlow.js",n}toJSON(t,n=!0){const s=nD(this.updatedConfig());return n?JSON.stringify(s):s}call(t,n){return Ue(()=>{t=mr(t);const s=new yl;for(let i=0;i<this.inputs.length;++i)s.add(this.inputs[i],t[i]);return wm(this.outputs,s,n)})}computeMask(t,n){return Ue(()=>{t=mr(t);let s;return n==null?s=ch(null,t.length):s=mr(n),this.runInternalGraph(t,s)[1]})}computeOutputShape(t){const n=ib(t);if(n.length!==this.inputLayers.length)throw new Ce(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let u=0;u<n.length;u++){const l=this.inputLayers[u],c=n[u],h=l.name+"_0_0";s[h]=c}const i=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(By);if(i.length>1)for(const u of i){const l=this.nodesByDepth[u];for(const c of l){const h=c.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(h.id)!==-1)continue;const f=[];for(let x=0;x<c.inboundLayers.length;x++){const v=c.inboundLayers[x],S=c.nodeIndices[x],w=c.tensorIndices[x],E=`${v.name}_${S}_${w}`,_=s[E];f.push(_)}const p=h.computeOutputShape(li(f)),g=ib(p),y=h.inboundNodes.indexOf(c);for(let x=0;x<g.length;x++){const v=`${h.name}_${y}_${x}`;s[v]=g[x]}}}const a=[],o=[];for(let u=0;u<this.outputLayers.length;u++){const l=this.outputLayers[u],c=this.outputLayersNodeIndices[u],h=this.outputLayersTensorIndices[u],f=`${l.name}_${c}_${h}`;o.push(f)}for(let u=0;u<o.length;u++){const l=o[u];bo(l in s),a.push(s[l])}return li(a)}runInternalGraph(t,n){n==null&&(n=ch(null,t.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],h=t[l],f=n[l];s[c.id]=[h,f]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(By);for(const l of i){const c=this.nodesByDepth[l];for(const h of c){const f=h.outboundLayer,p=h.inputTensors,g=h.outputTensors,y=new Array;for(const x of p)x.id in s&&y.push(s[x.id]);if(y.length===p.length){let x={},v,S,w,E;if(h.callArgs!=null&&(x=h.callArgs),y.length===1){const[_,D]=y[0];x.mask==null&&(x.mask=D),w=mr(f.call(_,x)),E=mr(f.computeMask(_,D)),v=[_],S=[D]}else v=y.map(_=>_[0]),S=y.map(_=>_[1]),x.mask==null&&(x.mask=S),w=mr(f.call(v,x)),E=mr(f.computeMask(v,S));if(f.activityRegularizer)throw new un("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let _=0;_<g.length;++_){const D=g[_],I=w[_],k=E[_];s[D.id]=[I,k]}}}}const a=[],o=[],u=[];for(const l of this.outputs){bo(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,h]=s[l.id];u.push(c.shape),a.push(c),o.push(h)}return[a,o,u]}buildNodeConversionMap(t){const n={};let s;for(const i of this.layers){s=i instanceof Ga?1:0;for(let a=0;a<i.inboundNodes.length;a++){const o=Ga.nodeKey(i,a);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(t,n){if(n!=null){if(this.layers.length<=n)throw new Ce(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(t==null)throw new Ce("Provide either a layer name or layer index");for(const s of this.layers)if(s.name===t)return s;throw new Ce(`No such layer: ${t}`)}calculateLosses(){return Ue(()=>{const t=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const i=Ga.nodeKey(n,s);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){const t={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const u=o.getClassName(),l=o.getConfig(),c=[];for(let f=0;f<o.inboundNodes.length;f++){const p=o.inboundNodes[f],g=Ga.nodeKey(o,f);let y={};if(this.containerNodes.has(g)){if(p.callArgs)try{JSON.stringify(p.callArgs),y=p.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(p.inboundLayers.length>0){const x=[];for(let v=0;v<p.inboundLayers.length;v++){const S=p.inboundLayers[v],w=p.nodeIndices[v],E=p.tensorIndices[v],_=Ga.nodeKey(S,w);let D=n[_];D==null&&(D=0),x.push([S.name,D,E,y])}c.push(x)}}}const h={};h.name=o.name,h.className=u,h.config=l,h.inboundNodes=c,s.push(h)}t.layers=s;const i=[];for(let o=0;o<this.inputLayers.length;o++){const u=this.inputLayers[o],l=this.inputLayersNodeIndices[o],c=Ga.nodeKey(u,l);if(!this.containerNodes.has(c))continue;let h=n[c];h==null&&(h=0);const f=this.inputLayersTensorIndices[o];i.push([u.name,h,f])}t.inputLayers=i;const a=[];for(let o=0;o<this.outputLayers.length;o++){const u=this.outputLayers[o],l=this.outputLayersNodeIndices[o],c=Ga.nodeKey(u,l);if(!this.containerNodes.has(c))continue;let h=n[c];h==null&&(h=0);const f=this.outputLayersTensorIndices[o];a.push([u.name,h,f])}return t.outputLayers=a,t}static fromConfig(t,n,s={},i=!1){const a={},o={};function u(v,S){v.name in o?o[v.name].push(S):o[v.name]=[S]}function l(v,S){const w=[];let E;for(const _ of S){const D=_[0],I=_[1],k=_[2];if(E=_[3]==null?{}:_[3],!(D in a)){u(v,S);return}const A=a[D];if(A.inboundNodes.length<=I){u(v,S);return}const N=A.inboundNodes[I];w.push(N.outputTensors[k])}w.length>0&&v.apply(li(w),E)}function c(v){const S=v.name,w=yu(v,n.customObjects!=null?n.customObjects:{});w.setFastWeightInitDuringBuild(i),a[S]=w,v.inboundNodes.forEach(_=>{if(!(_ instanceof Array))throw new Ce(`Corrupted configuration, expected array for nodeData: ${_}`);u(w,_)})}const h=n.name,f=n.layers;for(const v of f)c(v);for(;!xme(o);)for(const v of f){const S=a[v.name];if(S.name in o){const w=o[S.name];delete o[S.name];for(const E of w)l(S,E)}}const p=[],g=[],y=n.inputLayers;for(const v of y){const S=v[0],w=v[1],E=v[2];bo(S in a);const D=a[S].inboundNodes[w].outputTensors;p.push(D[E])}const x=n.outputLayers;for(const v of x){const S=v[0],w=v[1],E=v[2];bo(S in a);const D=a[S].inboundNodes[w].outputTensors;g.push(D[E])}return new t({inputs:p,outputs:g,name:h})}get stateful(){if(this._stateful)throw new Ce("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Ue(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $ge(r,t,n){const s=t.length;if(r==null||Array.isArray(r)&&r.length===0)return t.map(i=>null);if(s===1)return Array.isArray(r)&&r.length===1?r:typeof r=="object"&&t[0]in r?[r[t[0]]]:[r];if(Array.isArray(r)){if(r.length!==s)throw new Error(`Provided ${n} is an array of ${r.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return r}else if(typeof r=="object"&&Object.keys(r).length>0&&typeof r[Object.keys(r)[0]]=="object"){const i=[];return t.forEach(a=>{a in r?i.push(r[a]):i.push(null)}),i}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(r)}`)}function sz(r,t){return $ge(r,t,"classWeight")}async function iz(r,t,n,s){if(n!=null){const i=Ue(()=>{if(r.shape.length===1)return Mc(r);if(r.shape.length===2){if(r.shape[1]>1)return hg(r,1);if(r.shape[1]===1)return ke(r,[r.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${r.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${r.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await i.data());gn(i);const o=[];return a.forEach(u=>{if(n[u]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${u} exists in the data but not in classWeight`);o.push(n[u])}),qi(o,"float32")}else return null}function Fge(r,t){return De(r,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Rge=32;function az(r,t){let n,s;const i=t;n=i.xs,s=i.ys,oe(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const a=uM("input",r.inputNames,n),o=uM("output",r.outputNames,s),u=a[0].shape[0];oe(a.length===r.inputs.length,()=>`LayersModel has ${r.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(r.inputNames)})`),oe(o.length===r.outputs.length,()=>`LayersModel has ${r.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(r.outputNames)})`);for(let l=0;l<a.length;l++)oe(a[l].shape[0]===u,()=>`Batch size mismatch: input ${r.inputNames[l]} has ${a[l].shape[0]}; expected  ${u} based on input ${r.inputNames[0]}.`);for(let l=0;l<o.length;l++)oe(o[l].shape[0]===u,()=>`Batch size mismatch: output ${r.outputNames[l]} has ${o[l].shape[0]}; expected  ${u} based on input ${r.inputNames[0]}.`);return{xs:a,ys:o}}function uM(r,t,n){if(n instanceof Ur)return[n];if(Array.isArray(n))return oe(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${r} keys ${t}.`),n;{const s=[];for(const i of t){if(n[i]==null)throw new Ce(`The feature data generated by the dataset lacks the required ${r} key '${i}'.`);s.push(n[i])}return s}}function Oge(r){if(r.length===3)throw new un("Validation with sample weights is not implemented yet.");return{xs:r[0],ys:r[1]}}async function Mge(r,t,n){const s=n.batchesPerEpoch!=null;if(oe(r.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),oe(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),oe(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),oe(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),oe(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;try{const i=n.validationData!=null;let a,o;if(i)if(lM(n.validationData))oe(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const v=Oge(n.validationData);a=v.xs,o=v.ys}const u=r.makeTrainFunction(),l=r.getDedupedMetricsNames();let c;i?c=l.slice().concat(l.map(v=>"val_"+v)):c=l.slice();const h=XV(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:p,history:g}=YV(h,f,n.epochs,null,null,Lge(t,n),null,i,c);p.setModel(r),r.history=g,await p.onTrainBegin(),r.stopTraining_=!1;let y=n.initialEpoch==null?0:n.initialEpoch,x=await t.iterator();for(;y<n.epochs;){const v={};await p.onEpochBegin(y);let S=0,w=0;for(s||(x=await t.iterator());!s||S<n.batchesPerEpoch;){const E=await x.next();if(s&&E.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${S} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(E.value!=null){const{xs:_,ys:D}=az(r,E.value),I={};I.batch=w,I.size=_[0].shape[0],await p.onBatchBegin(w,I);const k=[];if(n.classWeight!=null){const F=sz(n.classWeight,r.outputNames);for(let $=0;$<F.length;++$)k.push(await iz(D[$],null,F[$]))}const A=_.concat(D).concat(k),N=u(A);gn(A);for(let F=0;F<l.length;++F){const $=l[F],O=N[F];I[$]=O,Io(O)}await p.onBatchEnd(w,I),KV(I),w++,S++}if(s?S>=n.batchesPerEpoch:E.done){if(i){let _;lM(n.validationData)?_=mr(await r.evaluateDataset(n.validationData,{batches:n.validationBatches})):_=mr(r.evaluate(a,o,{batchSize:n.validationBatchSize==null?Rge:n.validationBatchSize,verbose:0}));for(let D=0;D<r.metricsNames.length;++D)v[`val_${r.metricsNames[D]}`]=_[D]}break}if(r.stopTraining_)break}if(await p.onEpochEnd(y,v),y++,r.stopTraining_)break}return await p.onTrainEnd(),await r.history.syncData(),r.history}finally{r.isTraining=!1}}function Lge(r,t){let n=null;return t.batchesPerEpoch!=null?n=t.batchesPerEpoch:Number.isFinite(r.size)&&(n=r.size),n}function lM(r){return typeof r.iterator=="function"}function Bge(r){return typeof r.next=="function"}async function Pge(r,t,n){n=n||{};const s=n.batches!=null,i=r.testFunction;let a=[];if(n.verbose>0)throw new un("Verbose mode is not implemented yet.");oe(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=Bge(t)?t:await t.iterator();let u=0,l=0;for(;!s||l<n.batches;){const c=await o.next();if(a=Ue(()=>{if(c.value){const{xs:h,ys:f}=az(r,c.value),p=h.concat(f),g=Ue(()=>i(p));if(gn(p),l===0)for(let x=0;x<g.length;++x)a.push(Ln(0));const y=p[0].shape[0];for(let x=0;x<g.length;++x){const v=g[x],S=a[x];a[x]=Ue(()=>pt(a[x],De(y,v))),l>0&&gn(S)}gn(g),u+=y,++l}return a}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<a.length;++c){const h=a[c];a[c]=Ut(a[c],u),gn(h)}return li(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rD(r){oe(r>0&&Number.isInteger(r),()=>`batchSize is required to be a positive integer, but got ${r}`)}function Sm(r,t,n){return r==null?[null]:Array.isArray(r)?r.map(s=>Pc(s,t,n-t)):Pc(r,t,n-t)}function rk(r,t){return Ue(()=>r==null?null:Array.isArray(r)?r.map(n=>rk(n,t)):RV(r,t.dtype==="int32"?t:_t(t,"int32")))}function sD(r,t){const n=[];let s=0,i=null;for(;s<r;)i=s+t,i>=r&&(i=r),n.push([s,i]),s=i;return n}async function Vge(r,t,n,s,i,a,o,u,l,c,h,f,p,g,y){i==null&&(i=32),a==null&&(a=1),h==null&&(h=!0),p==null&&(p=0);let x=!1;l!=null&&c!=null&&(x=!0);const v=r.checkNumSamples(n,i,g,"steps_per_epoch");let S;v!=null&&(S=ro(0,v)),o==null&&(o=1);const{callbackList:w,history:E}=YV(u,o,a,p,v,g,i,x,f);w.setModel(r),r.history=E,await w.onTrainBegin(),r.stopTraining_=!1;for(let _=p;_<a;++_){await w.onEpochBegin(_);const D={};{if(h==="batch")throw new un("batch shuffling is not implemneted yet");h&&Vae(S);const I=qi(S),k=sD(v,i);for(let A=0;A<k.length;++A){const N={};if(await w.onBatchBegin(A,N),Ue(()=>{const F=k[A][0],$=k[A][1],O=Pc(I,F,$-F);N.batch=A,N.size=$-F;const M=rk(n,O),B=t(M);for(let U=0;U<s.length;++U){const V=s[U],Z=B[U];N[V]=Z,Io(Z)}if(A===k.length-1&&x){const U=r.testLoop(l,c,i);for(let V=0;V<s.length;++V){const Z=s[V],J=U[V];Io(J),D["val_"+Z]=J}}}),await w.onBatchEnd(A,N),KV(N),r.stopTraining_)break}I.dispose()}if(await w.onEpochEnd(_,D),r.stopTraining_)break}return await w.onTrainEnd(),await r.history.syncData(),r.history}async function zge(r,t,n,s={}){if(r.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");r.isTraining=!0;let i,a,o,u,l,c,h,f,p;try{const g=s.batchSize==null?32:s.batchSize;rD(g);const x=await r.standardizeUserData(t,n,s.sampleWeight,s.classWeight,!1,g);i=x[0],a=x[1],p=x[2];let v=!1,S;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new un("validationData including sample weights is not supported yet."):new Ce(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const F=await r.standardizeUserData(l,c,null,null,!0,g);h=F[0],f=F[1],S=h.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const N=Math.floor(i[0].shape[0]*(1-s.validationSplit)),F=i[0].shape[0];h=Sm(i,N,F),o=i,i=Sm(i,0,N),f=Sm(a,N,F),u=a,a=Sm(a,0,N),S=h.concat(f)}else s.validationSteps!=null&&(v=!0);const w=i.concat(a).concat(p);r.checkTrainableWeightsConsistency();const E=r.makeTrainFunction(),_=r.getDedupedMetricsNames();let D,I;v?(r.makeTestFunction(),D=r.testFunction,I=_.slice().concat(_.map(N=>"val_"+N))):(D=null,S=[],I=_.slice());const k=XV(s.callbacks,s.yieldEvery);return await Vge(r,E,w,_,g,s.epochs,s.verbose,k,D,S,s.shuffle,I,s.initialEpoch,null,null)}finally{r.isTraining=!1,Xa(i,t),Xa(a,n),Xa(o,t),Xa(u,n),Xa(h,l),Xa(f,c),p!=null&&gn(p)}}function oz(r){const t=[];r instanceof Ur&&(r=[r]);for(let n=0;n<r.length;++n){const s=r[n];if(s.rank===1)t.push(P0(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(s)}}return t}function Xa(r,t){if(r==null)return;const n=[];if(t instanceof Ur)n.push(t.id);else if(Array.isArray(t))t.forEach(i=>n.push(i.id));else if(t!=null)for(const i in t){const a=t[i];n.push(a.id)}const s=[];if(r instanceof Ur)n.indexOf(r.id)===-1&&s.push(r);else if(Array.isArray(r))r.forEach(i=>{n.indexOf(i.id)===-1&&s.push(i)});else if(r!=null)for(const i in r){const a=r[i];n.indexOf(a.id)===-1&&s.push(a)}s.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uge(r){return r instanceof Ur}function iD(r){return Array.isArray(r)}function cM(r){return!Uge(r)&&!iD(r)}function hM(r,t,n,s=!0,i=""){if(t==null||t.length===0){if(r!=null){let o=!1;if(iD(r)&&r.length>0)o=!0;else if(cM(r)){for(const u in r)if(r.hasOwnProperty(u)){o=!0;break}}else o=!0;if(o)throw new Ce(`Error when checking model ${i} expected no data, but got ${r}`)}return[]}if(r==null)return t.map(o=>null);let a;if(cM(r)){r=r,a=[];for(const o of t){if(r[o]==null)throw new Ce(`No data provided for "${o}". Need data for each key in: ${t}`);a.push(r[o])}}else if(iD(r)){if(r=r,r.length!==t.length)throw new Ce(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${r}`);a=r}else{if(r=r,t.length>1)throw new Ce(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${r.shape}`);a=[r]}if(a=oz(a),n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const u=a[o];if(u.shape.length!==n[o].length)throw new Ce(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s). but got array with shape ${u.shape}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=u.shape[l],h=n[o][l];if(h!=null&&h>=0&&c!==h)throw new Ce(`${i} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${i} received an input with ${u.shape[0]} examples, each with shape [${u.shape.slice(1,u.shape.length)}] (tensor shape [${u.shape}])`)}}return a}function Gge(r,t,n){const s=Dl(r.map(a=>a.shape[0]));s.sort();const i=Dl(t.map(a=>a.shape[0]));if(i.sort(),s.length>1)throw new Ce(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(r.map(a=>a.shape))}`);if(i.length>1)throw new Ce(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(s.length>0&&i.length>0&&!Bn(s,i))throw new Ce(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${i[0]} target sample(s).`)}function jge(r,t,n){const s=[O2,M2,dg];for(let i=0;i<r.length;++i){const a=r[i],o=t[i],u=n[i];if(o!=null){if(o===dg&&a.shape[a.shape.length-1]===1)throw new Ce(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const l=a.shape.slice(1),c=u.slice(1);for(let h=0;h<l.length;++h){const f=l[h],p=c[h];if(p!=null&&f!==p)throw new Ce(`A target Tensor with shape ${a.shape} was passed for an output of shape ${u}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function fM(r,t,n,s=!0,i=""){let a;if(Array.isArray(r)){if(r.length!==t.length)throw new Ce(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${r.length} Tensors(s).`);a=r}else{if(t.length>1)throw new Ce(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(r.shape)}.`);a=[r]}if(n!=null)for(let o=0;o<t.length;++o){if(n[o]==null)continue;const u=a[o];if(u.shape.length!==n[o].length)throw new Ce(`Error when checking ${i}: expected ${t[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(u.shape)}`);for(let l=0;l<n[o].length;++l){if(l===0&&!s)continue;const c=u.shape[l],h=n[o][l];if(h!=null&&h!==c)throw new Ce(`Error when checking ${i}: expected ${t[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(u.shape)}.`)}}}function Wge(r,t){if(r==null||Array.isArray(r)&&r.length===0)return t.map(s=>[]);let n;if(typeof r=="string"||typeof r=="function")n=[r];else if(Array.isArray(r)||typeof r=="object")n=r;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${r}`);if(Array.isArray(n))return t.map(s=>n);{const s=[];for(const i of t){let a=n.hasOwnProperty(i)?n[i]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const Hge="layers-model";class ed extends Ga{constructor(t){super(t),this.isTraining=!1}summary(t,n,s=console.log){if(!this.built)throw new Ce("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Tge(this,t,n,s)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=Dge(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Hl))throw new Ce("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const o in t.loss)if(this.outputNames.indexOf(o)===-1)throw new Ce(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)t.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(y_(t.loss[o]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Ce(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);n=t.loss.map(u=>y_(u))}else{const o=y_(t.loss);this.outputs.forEach(u=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const u=this.internalOutputShapes[o],l=this.outputNames[o];this.feedOutputNames.push(l),this.feedOutputShapes.push(u),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Bc("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const u=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([u,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const i=Wge(t.metrics,this.outputNames),a=(o,u,l)=>{this.outputNames.length>1&&(u=this.outputNames[o]+"_"+u),this.metricsNames.push(u),this.metricsTensors.push([l,o])};Bc("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const u=i[o];(c=>{const h="";let f,p,g;for(const y of c){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const v=this.internalOutputShapes[o];v[v.length-1]===1||this.lossFunctions[o]===M2?["accuracy","acc"].indexOf(y)!==-1?p=QV:["crossentropy","ce"].indexOf(y)!==-1&&(p=gge):this.lossFunctions[o]===cb?["accuracy","acc"].indexOf(y)!==-1?p=yge:["crossentropy","ce"].indexOf(y)!==-1&&(p=tz):["accuracy","acc"].indexOf(y)!==-1?p=JV:["crossentropy","ce"].indexOf(y)!==-1&&(p=ez);let S;["accuracy","acc"].indexOf(y)!==-1?S="acc":["crossentropy","ce"].indexOf(y)!==-1&&(S="ce"),g=p,f=h+S}else g=Ege(y),f=h+zy(y);let x;Bc(f,()=>{x=g}),a(o,f,x)}})(u)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,n,s={}){const i=s.batchSize==null?32:s.batchSize;rD(i);const o=this.standardizeUserDataXY(t,n,!0,i);try{const u=o[0].concat(o[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,u,i,s.verbose,s.steps);return li(c)}finally{Xa(o[0],t),Xa(o[1],n)}}async evaluateDataset(t,n){return this.makeTestFunction(),Pge(this,t,n)}checkNumSamples(t,n,s,i="steps"){let a;if(s!=null){if(a=null,n!=null)throw new Ce(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(t!=null)Array.isArray(t)?a=t[0].shape[0]:a=t.shape[0];else throw new Ce(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return a}execute(t,n){if(Array.isArray(n)&&n.length===0)throw new Ce("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),i=s?n:[n],a=this.retrieveSymbolicTensors(i),o=new yl;if(t instanceof Ur&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Ce(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)o.add(this.inputs[l],t[l])}else for(const l of this.inputs){const c=t[l.name];if(c==null)throw new Ce(`No value is provided for the model's input ${l.name}`);o.add(l,c)}const u=wm(a,o);return s?u:u[0]}retrieveSymbolicTensors(t){const n=ch(null,t.length);let s=t.length;for(const i of this.layers){const a=Array.isArray(i.output)?i.output:[i.output],o=a.map(u=>u.name);for(let u=0;u<t.length;++u){const l=o.indexOf(t[u]);if(l!==-1&&(n[u]=a[l],s--),s===0)break}if(s===0)break}if(s>0){const i=[];throw n.forEach((a,o)=>{a==null&&i.push(t[o])}),new Ce(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(t,n=32,s=!1){return Ue(()=>{const i=this.checkNumSamples(t);if(s)throw new un("Verbose predictLoop() is not implemented yet.");const a=sD(i,n),o=this.outputs.map(u=>[]);for(let u=0;u<a.length;++u)Ue(()=>{const c=a[u][0],h=a[u][1],f=Sm(t,c,h),p=[];if(Array.isArray(f))for(let y=0;y<f.length;++y)p.push({key:this.inputs[y],value:f[y]});else p.push({key:this.inputs[0],value:f});const g=new yl(p);return wm(this.outputs,g)}).forEach((c,h)=>o[h].push(c));return li(o.map(u=>fi(u,0)))})}predict(t,n={}){const s=oz(t);fM(s,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return rD(i),this.predictLoop(s,i)}finally{Xa(s,t)}}predictOnBatch(t){fM(t,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,n)}standardizeUserDataXY(t,n,s=!0,i){if(this.optimizer_==null)throw new Da("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let o=0;o<this.feedOutputShapes.length;++o){const u=this.feedOutputShapes[o];this.feedLossFns[o]===cb?a.push(u.slice(0,u.length-1).concat([1])):a.push(u)}if(t=hM(t,this.feedInputNames,this.feedInputShapes,!1,"input"),n=hM(n,this.feedOutputNames,a,!1,"target"),Gge(t,n),jge(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&t[0].shape[0]%i!==0)throw new Ce(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${t[0].shape[0]} sample(s).`);return[t,n]}async standardizeUserData(t,n,s,i,a=!0,o){const[u,l]=this.standardizeUserDataXY(t,n,a,o);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(i!=null){const h=sz(i,this.outputNames);c=[];for(let f=0;f<h.length;++f)c.push(await iz(l[f],null,h[f]))}return[u,l,c]}testLoop(t,n,s,i=0,a){return Ue(()=>{const o=this.checkNumSamples(n,s,a,"steps"),u=[];if(i>0)throw new un("Verbose mode is not implemented yet.");if(a!=null)throw new un("steps mode in testLoop() is not implemented yet");{const l=sD(o,s),c=qi(ro(0,o));for(let h=0;h<l.length;++h){const f=l[h][0],p=l[h][1],g=Pc(c,f,p-f),y=rk(n,g),x=t(y);if(h===0)for(let v=0;v<x.length;++v)u.push(Ln(0));for(let v=0;v<x.length;++v){const S=x[v];u[v]=pt(u[v],De(p-f,S))}}for(let h=0;h<u.length;++h)u[h]=Ut(u[h],o)}return u})}getDedupedMetricsNames(){const t=this.metricsNames,n=[];for(let s=0;s<t.length;++s){const i=t[s];let a=i;if(YO(t,i)>1){const o=YO(t.slice(0,s),i);a+=`_${o}`}n.push(a)}return n}makeTrainFunction(){return t=>{const n=[],s=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],u=()=>{const f=[];for(let x=0;x<this.inputs.length;++x)f.push({key:this.inputs[x],value:s[x]});const p=new yl(f),g=wm(this.outputs,p,{training:!0});let y;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let S=v(i[x],g[x]);a[x]!=null&&(S=Fge(S,a[x]));const w=jr(S);n.push(w),x===0?y=S:y=pt(y,S)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=n[x];else{const S=this.metricsTensors[x][0],w=this.metricsTensors[x][1];v=jr(S(i[w],g[w]))}Io(v),o.push(v)}return y=jr(y),this.calculateLosses().forEach(x=>{y=pt(y,x)}),y},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(u,!0,l)].concat(o)}}makeTestFunction(){this.testFunction=t=>Ue(()=>{const n=[];let s;const i=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let c=0;c<this.inputs.length;++c)o.push({key:this.inputs[c],value:i[c]});const u=new yl(o),l=wm(this.outputs,u);for(let c=0;c<this.lossFunctions.length;++c){const h=this.lossFunctions[c],f=jr(h(a[c],l[c]));c===0?s=f:s=pt(s,f),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const h=this.metricsTensors[c][0],f=this.metricsTensors[c][1],p=jr(h(a[f],l[f]));n.push(p)}return n})}async fit(t,n,s={}){return zge(this,t,n,s)}async fitDataset(t,n){return Mge(this,t,n)}async trainOnBatch(t,n){const s=await this.standardizeUserData(t,n),i=s[0],a=s[1],u=this.makeTrainFunction()(i.concat(a)),l=[];for(const c of u){const h=await c.data();l.push(h[0])}return gn(u),Xa(s[0],t),Xa(s[1],n),li(l)}getNamedWeights(t){const n=[],s=t!=null&&t.trainableOnly,i=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let o=0;o<i.length;++o)s&&!i[o].trainable||n.push({name:i[o].originalName,tensor:a[o]});return n}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=kO().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=n-kO().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=uu(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(n=>uu(n))}else{const n=Object.keys(this.loss);t={};const s=this.loss;for(const i of n)if(typeof s[i]=="string")t[i]=uu(s[i]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[uu(zy(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>uu(zy(t)));{const t={};for(const n in this.metrics)t[n]=uu(zy(this.metrics[n]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=tD(t.optimizer_config),s=yu(n);let i;if(typeof t.loss=="string")i=kc(t.loss);else if(Array.isArray(t.loss))i=t.loss.map(o=>kc(o));else if(t.loss!=null){i={};for(const o in t.loss)i[o]=kc(t.loss[o])}let a;if(Array.isArray(t.metrics))a=t.metrics.map(o=>kc(o));else if(t.metrics!=null){a={};for(const o in t.metrics)a[o]=kc(t.metrics[o])}this.compile({loss:i,metrics:a,optimizer:s})}async save(t,n){if(typeof t=="string"){const c=$oe(t);if(c.length===0)throw new Ce(`Cannot find any save handlers for URL '${t}'`);if(c.length>1)throw new Ce(`Found more than one (${c.length}) save handlers for URL '${t}'`);t=c[0]}if(t.save==null)throw new Ce("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await EO(this.getNamedWeights(n)),u={modelTopology:this.toJSON(null,!1),format:Hge,generatedBy:`TensorFlow.js tfjs-layers v${rz}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){u.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:h,specs:f}=await EO(await this.optimizer.getWeights(),c);s.specs.push(...f),s.data=Ioe([s.data,h])}return this.userDefinedMetadata!=null&&(oM(this.userDefinedMetadata,this.name,!0),u.userDefinedMetadata=this.userDefinedMetadata),u.weightData=s.data,u.weightSpecs=s.specs,t.save(u)}setUserDefinedMetadata(t){oM(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}ed.className="Model";at(ed);class uz extends ed{}uz.className="Functional";at(uz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pg extends ed{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:$2("sequential_"),t.layers!=null)for(const n of t.layers)this.add(n)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new Ce(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const n=t instanceof pg||t instanceof ed;let s;if(n){if(s=t,s.outputs.length!==1)throw new Ce("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new Ce("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new Ce("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=qme({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(t.inboundNodes.length!==1)throw new Ce(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new Ce("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=GV(this.outputs[0])}this.inboundNodes=[],new R2({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ch(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=t.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,n){return this.model==null&&this.build(),this.model.call(t,n)}build(t){if(Wn(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ed({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,n,s=console.log){this.built||this.build(),super.summary(t,n,s)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,n,s={}){if(!this.built)throw new Da("The model needs to be compiled before being used.");return this.model.evaluate(t,n,s)}async evaluateDataset(t,n){if(!this.built)throw new Da("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,n)}predict(t,n={}){return this.model==null&&this.build(),this.model.predict(t,n)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,n,s={}){if(!this.built)throw new Da("The model needs to be compiled before being used.");return this.model.fit(t,n,s)}async fitDataset(t,n){if(!this.built)throw new Da("The model needs to be compiled before being used.");return this.model.fitDataset(t,n)}async trainOnBatch(t,n){return this.model.trainOnBatch(t,n)}static fromConfig(t,n,s={},i=!1){let a,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new Ce("Legacy serialization format not supported yet.");a=n}else oe(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,o=n;const u=new t(o);if(!(u instanceof pg))throw new un(`Sequential.fromConfig called on non-Sequential input: ${u}`);for(const l of a){const h=yu(l,void 0,i);i&&h.setFastWeightInitDuringBuild(!0),u.add(h)}return u}set stopTraining(t){if(this.model==null)throw new Ce("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new Ce("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),t.push(s)}return{name:this.name,layers:t}}}pg.className="Sequential";at(pg);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let gi=class extends Gd{getConfig(){return{}}},lz=class extends gi{apply(t,n=1){return Fme(t,n)}};lz.className="elu";at(lz);let cz=class extends gi{apply(t){return U7(t)}};cz.className="selu";at(cz);let hz=class extends gi{apply(t){return Th(t)}};hz.className="relu";at(hz);let fz=class extends gi{apply(t){return Ue(()=>J3(6,Th(t)))}};fz.className="relu6";at(fz);class dz extends gi{apply(t){return t}}dz.className="linear";at(dz);let pz=class extends gi{apply(t){return jd(t)}};pz.className="sigmoid";at(pz);class mz extends gi{apply(t){return Ome(t)}}mz.className="hardSigmoid";at(mz);let gz=class extends gi{apply(t){return I0(t)}};gz.className="softplus";at(gz);class yz extends gi{apply(t){return Rme(t)}}yz.className="softsign";at(yz);let xz=class extends gi{apply(t){return G3(t)}};xz.className="tanh";at(xz);let sk=class extends gi{apply(t,n=-1){return oN(t,n)}};sk.className="softmax";at(sk);let bz=class extends gi{apply(t,n=-1){return O7(t,n)}};bz.className="logSoftmax";at(bz);class vz extends gi{apply(t,n=1){return Ue(()=>De(jd(De(t,n)),t))}}vz.className="swish";at(vz);class wz extends gi{apply(t){return Ue(()=>De(t,G3(I0(t))))}}wz.className="mish";at(wz);function Ol(r){return r.getClassName()}function x_(r,t={}){return L0(r,Ea.getMap().classNameMap,t,"activation")}function Ml(r){if(r==null){const t={};return t.className="linear",t.config={},x_(t)}if(typeof r=="string"){const t={};return t.className=r,t.config={},x_(t)}else return r instanceof gi?r:x_(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qge(r){if(r!=null&&typeof r!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${r}`)}class Sz extends Gd{}class Cz extends Sz{constructor(t){super(),qge(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return Ue(()=>{let n=hs([1]);return this.hasL1&&(n=pt(n,Vt(De(this.l1,Xs(t))))),this.hasL2&&(n=pt(n,Vt(De(this.l2,V0(t))))),ke(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,n){return new t({l1:n.l1,l2:n.l2})}}Cz.className="L1L2";at(Cz);const dM={l1l2:"L1L2"};function er(r){return GN(r)}function pM(r,t={}){return L0(r,Ea.getMap().classNameMap,t,"regularizer")}function br(r){if(r==null)return null;if(typeof r=="string"){const n={className:r in dM?dM[r]:r,config:{}};return pM(n)}else return r instanceof Sz?r:pM(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _z extends Dn{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,n){t=rn(t);let s=Th(t);return this.maxValue!=null&&(s=Qi(s,0,this.maxValue)),s}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},n=super.getConfig();return Object.assign(t,n),t}}_z.className="ReLU";at(_z);class Ez extends Dn{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=rn(t);return Y3(s,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}}Ez.className="LeakyReLU";at(Ez);class Dz extends Dn{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=xr(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=br(t.alphaRegularizer),this.alphaConstraint=ns(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new Ce(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=Wn(t);const n=t.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let i=1;i<t.length;++i)s[i]=t[i];this.inputSpec=[new es({ndim:t.length,axes:s})],this.built=!0}call(t,n){return t=rn(t),rN(t,this.alpha.read())}getConfig(){const t={alphaInitializer:Er(this.alphaInitializer),alphaRegularizer:er(this.alphaRegularizer),alphaConstraint:ts(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(t,n),t}}Dz.className="PReLU";at(Dz);let Tz=class extends Dn{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new un(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,n){const s=rn(t);return _2(s)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},n=super.getConfig();return Object.assign(t,n),t}};Tz.className="ELU";at(Tz);class Nz extends Dn{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,n){const s=rn(t);return De(s,_t(Oa(s,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},n=super.getConfig();return Object.assign(t,n),t}}Nz.className="ThresholdedReLU";at(Nz);let kz=class extends Dn{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new sk().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,n){const s=rn(t);return this.softmax(s,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}};kz.className="Softmax";at(kz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function td(r,t,n){if(typeof r=="number")return ch(r,t);if(r.length!==t)throw new Ce(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${r.length} elements.`);for(let s=0;s<t;++s){const i=r[s];if(!kme(i))throw new Ce(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(r)} including a non-integer number ${i}`)}return r}function no(r,t,n,s,i=1){if(r==null)return r;const a=t+(t-1)*(i-1);let o;return n==="same"?o=r:o=r-a+1,Math.floor((o+s-1)/s)}function vo(r,t,n,s){if(r==null)return null;if(s==="valid")r=r*t+Rl([n-t,0]);else if(s==="same")r=r*t;else throw new Ce(`Unsupport padding mode: ${s}.`);return r}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ik(r,t){return Ue(()=>(Lr(t),t==="channelsFirst"?_n(r,[0,2,3,1]):r))}function Az(r,t){return Ue(()=>(Lr(t),t==="channelsFirst"?_n(r,[0,2,3,4,1]):r))}function Kge(r,t,n,s=1,i="valid",a,o=1){return Ue(()=>{if(a==null&&(a=so()),Lr(a),r.shape.length!==3)throw new Ce(`The input of a conv1dWithBias operation should be 3, but is ${r.shape.length} instead.`);if(t.shape.length!==3)throw new Ce(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Ce(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(a==="channelsFirst"&&(r=_n(r,[0,2,1])),i==="causal")throw new un("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let u=E7(r,t,s,i==="same"?"same":"valid","NWC",o);return n!=null&&(u=ao(u,n)),u})}function mM(r,t,n,s=[1,1],i="valid",a,o,u=null){return Ue(()=>{if(a==null&&(a=so()),Lr(a),r.rank!==3&&r.rank!==4)throw new Ce(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${r.rank}.`);if(t.rank!==3&&t.rank!==4)throw new Ce(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${r.rank}.`);let l=ik(r,a);if(i==="causal")throw new un("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=gfe({x:l,filter:t,strides:s,pad:i==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:u}),a==="channelsFirst"&&(l=_n(l,[0,3,1,2])),l})}function Xge(r,t,n,s=[1,1,1],i="valid",a,o){return Ue(()=>{if(a==null&&(a=so()),Lr(a),r.rank!==4&&r.rank!==5)throw new Ce(`conv3dWithBias expects input to be of rank 4 or 5, but received ${r.rank}.`);if(t.rank!==4&&t.rank!==5)throw new Ce(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${r.rank}.`);let u=Az(r,a);if(i==="causal")throw new un("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=vle(u,t,s,i==="same"?"same":"valid","NDHWC",o),n!=null&&(u=ao(u,n)),a==="channelsFirst"&&(u=_n(u,[0,4,1,2,3])),u})}class L2 extends Dn{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",L2.verifyArgs(n),this.rank=t,ps(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new un(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=td(n.kernelSize,t,"kernelSize"),this.strides=td(n.strides==null?1:n.strides,t,"strides"),this.padding=n.padding==null?"valid":n.padding,ta(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Lr(this.dataFormat),this.activation=Ml(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=xr(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=ns(n.biasConstraint),this.biasRegularizer=br(n.biasRegularizer),this.activityRegularizer=br(n.activityRegularizer),this.dilationRate=td(n.dilationRate==null?1:n.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Ce(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Ce(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Ce(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(bo("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!jN(t.kernelSize,"number",1,3))throw new Ce(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ol(this.activation),useBias:this.useBias,biasInitializer:Er(this.biasInitializer),biasRegularizer:er(this.biasRegularizer),activityRegularizer:er(this.activityRegularizer),biasConstraint:ts(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}class Kd extends L2{constructor(t,n){super(t,n),this.kernel=null,Kd.verifyArgs(n),this.filters=n.filters,ps(this.filters,"filters"),this.kernelInitializer=xr(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=ns(n.kernelConstraint),this.kernelRegularizer=br(n.kernelRegularizer)}build(t){t=Wn(t);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Ce(`The channel dimension of the input should be defined. Found ${t[n]}`);const s=t[n],i=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(t,n){return Ue(()=>{t=rn(t);let s;const i=this.bias==null?null:this.bias.read(),a=NV(this.activation.getClassName());if(a!=null&&this.rank===2)s=mM(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=Kge(t,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=mM(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Xge(t,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new un("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(t){t=Wn(t);const n=[],s=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<s.length;++a){const o=no(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(o)}let i=[t[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const t={filters:this.filters,kernelInitializer:Er(this.kernelInitializer),kernelRegularizer:er(this.kernelRegularizer),kernelConstraint:ts(this.kernelConstraint)},n=super.getConfig();return Object.assign(t,n),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new Ce(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}let ak=class Iz extends Kd{constructor(t){super(2,t),Iz.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!jN(t.kernelSize,"number",1,2))throw new Ce(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}};ak.className="Conv2D";at(ak);let ok=class $z extends Kd{constructor(t){super(3,t),$z.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new Ce(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}};ok.className="Conv3D";at(ok);class Fz extends ak{constructor(t){if(super(t),this.inputSpec=[new es({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Ce(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Wn(t),t.length!==4)throw new Ce("Input should have rank 4; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Ce("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],i=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new es({ndim:4,axes:{[n]:s}})],this.built=!0}call(t,n){return Ue(()=>{let s=rn(t);if(s.shape.length!==4)throw new Ce(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const i=s.shape,a=i[0];let o,u;this.dataFormat==="channelsFirst"?(o=2,u=3):(o=1,u=2);const l=i[o],c=i[u],h=this.kernelSize[0],f=this.kernelSize[1],p=this.strides[0],g=this.strides[1],y=vo(l,p,h,this.padding),x=vo(c,g,f,this.padding),v=[a,y,x,this.filters];this.dataFormat!=="channelsLast"&&(s=_n(s,[0,2,3,1]));let S=D7(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=_n(S,[0,3,1,2])),this.bias!=null&&(S=ao(S,this.bias.read(),this.dataFormat)),this.activation!=null&&(S=this.activation.apply(S)),S})}computeOutputShape(t){t=Wn(t);const n=t.slice();let s,i,a;this.dataFormat==="channelsFirst"?(s=1,i=2,a=3):(s=3,i=1,a=2);const o=this.kernelSize[0],u=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[i]=vo(n[i],l,o,this.padding),n[a]=vo(n[a],c,u,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Fz.className="Conv2DTranspose";at(Fz);class Rz extends ok{constructor(t){if(super(t),this.inputSpec=[new es({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Ce(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=Wn(t),t.length!==5)throw new Ce("Input should have rank 5; Received input shape: "+JSON.stringify(t));const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null)throw new Ce("The channel dimension of the inputs should be defined. Found `None`.");const s=t[n],i=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new es({ndim:5,axes:{[n]:s}})],this.built=!0}call(t,n){return Ue(()=>{let s=rn(t);if(s.shape.length!==5)throw new Ce(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const i=s.shape,a=i[0];let o,u,l;this.dataFormat==="channelsFirst"?(l=2,o=3,u=4):(l=1,o=2,u=3);const c=i[l],h=i[o],f=i[u],p=this.kernelSize[0],g=this.kernelSize[1],y=this.kernelSize[2],x=this.strides[0],v=this.strides[1],S=this.strides[2],w=vo(c,x,p,this.padding),E=vo(h,v,g,this.padding),_=vo(f,S,y,this.padding),D=[a,w,E,_,this.filters];this.dataFormat!=="channelsLast"&&(s=_n(s,[0,2,3,4,1]));let I=Cle(s,this.kernel.read(),D,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(I=_n(I,[0,4,1,2,3])),this.bias!==null&&(I=ao(I,this.bias.read(),this.dataFormat)),this.activation!==null&&(I=this.activation.apply(I)),I})}computeOutputShape(t){t=Wn(t);const n=t.slice();let s,i,a,o;this.dataFormat==="channelsFirst"?(s=1,i=2,a=3,o=4):(s=4,i=1,a=2,o=3);const u=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],h=this.strides[0],f=this.strides[1],p=this.strides[2];return n[s]=this.filters,n[i]=vo(n[i],h,u,this.padding),n[a]=vo(n[a],f,l,this.padding),n[o]=vo(n[o],p,c,this.padding),n}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}Rz.className="Conv3DTranspose";at(Rz);class Oz extends Kd{constructor(t,n){if(super(t,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new Ce("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new Ce("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new Ce(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=xr(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=br(n.depthwiseRegularizer),this.depthwiseConstraint=ns(n.depthwiseConstraint),this.pointwiseInitializer=xr(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=br(n.pointwiseRegularizer),this.pointwiseConstraint=ns(n.pointwiseConstraint)}build(t){if(t=Wn(t),t.length<this.rank+2)throw new Ce(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const n=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[n]==null||t[n]<0)throw new Ce(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[n])}`);const s=t[n],i=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let u=0;u<this.rank;++u)a.push(1);a.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new es({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(t,n){return Ue(()=>{t=rn(t);let s;if(this.rank===1)throw new un("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=_n(t,[0,2,3,1])),s=G7(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ao(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=_n(s,[0,3,1,2])),s})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=Er(this.depthwiseInitializer),t.pointwiseInitializer=Er(this.pointwiseInitializer),t.depthwiseRegularizer=er(this.depthwiseRegularizer),t.pointwiseRegularizer=er(this.pointwiseRegularizer),t.depthwiseConstraint=ts(this.depthwiseConstraint),t.pointwiseConstraint=ts(this.pointwiseConstraint),t}}Oz.className="SeparableConv";class Mz extends Oz{constructor(t){super(2,t)}}Mz.className="SeparableConv2D";at(Mz);class B2 extends Kd{constructor(t){super(1,t),B2.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!jN(t.kernelSize,"number",1,1))throw new Ce(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}B2.className="Conv1D";at(B2);class Lz extends Dn{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,n){return Ue(()=>{if(t=rn(t),this.dataFormat==="channelsLast"){const s=Vy(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Vy(s,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Vy(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Vy(s,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}Lz.className="Cropping2D";at(Lz);class Bz extends Dn{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Lr(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,Dme(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const n=t[2]==null?null:this.size[0]*t[2],s=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],n,s]}else{const n=t[1]==null?null:this.size[0]*t[1],s=t[2]==null?null:this.size[1]*t[2];return[t[0],n,s,t[3]]}}call(t,n){return Ue(()=>{let s=rn(t);const i=s.shape;if(this.dataFormat==="channelsFirst"){s=_n(s,[0,2,3,1]);const a=this.size[0]*i[2],o=this.size[1]*i[3],u=this.interpolation==="nearest"?Ly.resizeNearestNeighbor(s,[a,o]):Ly.resizeBilinear(s,[a,o]);return _n(u,[0,3,1,2])}else{const a=this.size[0]*i[1],o=this.size[1]*i[2];return this.interpolation==="nearest"?Ly.resizeNearestNeighbor(s,[a,o]):Ly.resizeBilinear(s,[a,o])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(t,n),t}}Bz.className="UpSampling2D";at(Bz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yge(r,t,n=[1,1],s="valid",i,a){return Ue(()=>{i==null&&(i=so()),Lr(i);let o=ik(r,i);if(r.rank!==4)throw new Ce(`Input for depthwiseConv2d is required to be 4-D, but is instead ${r.rank}-D`);if(t.rank!==4)throw new Ce(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=q3(o,t,n,s==="same"?"same":"valid","NHWC",a),i==="channelsFirst"&&(o=_n(o,[0,3,1,2])),o})}class Pz extends L2{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=xr(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=ns(t.depthwiseConstraint),this.depthwiseRegularizer=br(t.depthwiseRegularizer)}build(t){if(t=Wn(t),t.length<4)throw new Ce(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(t[n]==null||t[n]<0)throw new Ce(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[n]}).`);const s=t[n],i=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Ue(()=>{t=rn(t);let s=Yge(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ao(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(t){t=Wn(t);const n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=no(n,this.kernelSize[0],this.padding,this.strides[0]),o=no(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],i,a,o]:[t[0],a,o,i]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=Er(this.depthwiseInitializer),t.depthwiseRegularizer=er(this.depthwiseRegularizer),t.depthwiseConstraint=ts(this.depthwiseRegularizer),t}}Pz.className="DepthwiseConv2D";at(Pz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vz(r,t,n,s){if(Array.isArray(r)){if(t!=null||n!=null)throw new Ce("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=r.slice(r.length-s,r.length),r=r.slice(0,r.length-s)),r.length>1&&(t=r.slice(1,r.length)),r=r[0]}function i(a){return a==null||Array.isArray(a)?a:[a]}return t=i(t),n=i(n),{inputs:r,initialState:t,constants:n}}function zz(r,t,n,s=!1,i,a,o=!1,u=!1){return Ue(()=>{const l=t.shape.length;if(l<3)throw new Ce(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ro(2,l));t=_n(t,c),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=_t(_t(i,"bool"),"float32"),i.rank===l-1&&(i=Sa(i,-1)),i=_n(i,c)),s&&(t=oh(t,0),i!=null&&(i=oh(i,0)));const h=[];let f,p=n;const g=t.shape[0],y=Sd(t);let x;i!=null&&(x=Sd(i));for(let S=0;S<g;++S){const w=y[S],E=Ue(()=>r(w,p));if(i==null)f=E[0],p=E[1];else{const _=Ue(()=>{const D=x[S],I=Kt(Aa(D),D),k=pt(De(E[0],D),De(p[0],I)),A=p.map((N,F)=>pt(De(E[1][F],D),De(N,I)));return{output:k,newStates:A}});f=_.output,p=_.newStates}u&&h.push(f)}let v;return u&&(v=uh(h,1)),[f,v,p]})}class ql extends Dn{constructor(t){super(t);let n;if(t.cell==null)throw new Ce("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?n=new ck({cells:t.cell}):n=t.cell,n.stateSize==null)throw new Ce("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new es({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ro(0,t).map(n=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){QE(t)&&(t=t[0]),t=t;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let i;if(this.returnSequences?i=[t[0],t[1],s]:i=[t[0],s],this.returnState){const a=[];for(const o of n)a.push([t[0],o]);return[i].concat(a)}else return i}computeMask(t,n){return Ue(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(a=>null);return[s].concat(i)}else return s})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<t;++s)n.push(null);return n}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new un("Constants support is not implemented in RNN yet.");QE(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,s=t.slice(2);this.inputSpec[0]=new es({shape:[n,null,...s]});const i=[t[0]].concat(t.slice(2));this.cell.build(i);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!Bn(this.stateSpec.map(o=>o.shape[o.shape.length-1]),a))throw new Ce(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(o=>new es({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(t,n=!1){Ue(()=>{if(!this.stateful)throw new xo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new Ce("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>hs([s,i])):this.states_=[hs([s,this.cell.stateSize])];else if(t==null)gn(this.states_),this.keptStates!=null&&(gn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>hs([s,i])):this.states_[0]=hs([s,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Ce(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n===!0?this.keptStates.push(this.states_.slice()):gn(this.states_);for(let i=0;i<this.states_.length;++i){const a=t[i],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,u=[s,o];if(!Bn(a.shape,u))throw new Ce(`State ${i} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${a.shape}`);this.states_[i]=a}}this.states_=this.states_.map(i=>Io(i.clone()))})}apply(t,n){let s=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const a=Vz(t,s,i,this.numConstants);t=a.inputs,s=a.initialState,i=a.constants;let o=[],u=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new es({shape:c.shape}));u=u.concat(this.stateSpec)}if(i!=null&&(n.constants=i,o=o.concat(i),this.numConstants=i.length),o[0]instanceof Co){const c=[t].concat(o),h=this.inputSpec.concat(u),f=this.inputSpec;this.inputSpec=h;const p=super.apply(c,n);return this.inputSpec=f,p}else return super.apply(t,n)}call(t,n){return Ue(()=>{const s=n==null?null:n.mask,i=n==null?null:n.training;let a=n==null?null:n.initialState;t=rn(t),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(t));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==o)throw new Ce(`RNN Layer has ${o} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const u={training:i},c=zz((y,x)=>{const v=this.cell.call([y].concat(x),u);return[v[0],v.slice(1)]},t,a,this.goBackwards,s,null,this.unroll,this.returnSequences),h=c[0],f=c[1],p=c[2];this.stateful&&this.resetStates(p,i);const g=this.returnSequences?f:h;return this.returnState?[g].concat(p):g})}getInitialState(t){return Ue(()=>{let n=hs(t.shape);return n=Vt(n,[1,2]),n=P0(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?YE(n,[1,s]):n):this.cell.stateSize>1?[YE(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===ql.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign({},s,t,n)}static fromConfig(t,n,s={}){const i=n.cell,a=yu(i,s);return new t(Object.assign(n,{cell:a}))}}ql.className="RNN";at(ql);class P2 extends Dn{}class uk extends P2{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,ps(this.units,"units"),this.activation=Ml(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=br(t.kernelRegularizer),this.recurrentRegularizer=br(t.recurrentRegularizer),this.biasRegularizer=br(t.biasRegularizer),this.kernelConstraint=ns(t.kernelConstraint),this.recurrentConstraint=ns(t.recurrentConstraint),this.biasConstraint=ns(t.biasConstraint),this.dropout=Cd([1,Rl([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Cd([1,Rl([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Wn(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Ue(()=>{if(t=t,t.length!==2)throw new Ce(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let s=t[1];t=t[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ll({ones:()=>Aa(t),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ll({ones:()=>Aa(s),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let a;const o=this.dropoutMask,u=this.recurrentDropoutMask;o!=null?a=No(De(t,o),this.kernel.read()):a=No(t,this.kernel.read()),this.bias!=null&&(a=ao(a,this.bias.read())),u!=null&&(s=De(s,u));let l=pt(a,No(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ol(this.activation),useBias:this.useBias,kernelInitializer:Er(this.kernelInitializer),recurrentInitializer:Er(this.recurrentInitializer),biasInitializer:Er(this.biasInitializer),kernelRegularizer:er(this.kernelRegularizer),recurrentRegularizer:er(this.recurrentRegularizer),biasRegularizer:er(this.biasRegularizer),activityRegularizer:er(this.activityRegularizer),kernelConstraint:ts(this.kernelConstraint),recurrentConstraint:ts(this.recurrentConstraint),biasConstraint:ts(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,n)}}uk.className="SimpleRNNCell";at(uk);class Uz extends ql{constructor(t){t.cell=new uk(t),super(t)}call(t,n){return Ue(()=>{this.cell.dropoutMask!=null&&(gn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(gn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:s,training:i,initialState:a})})}static fromConfig(t,n){return new t(n)}}Uz.className="SimpleRNN";at(Uz);class lk extends P2{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Ce("GRUCell does not support reset_after parameter set to true.");this.units=t.units,ps(this.units,"units"),this.activation=Ml(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Ml(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=br(t.kernelRegularizer),this.recurrentRegularizer=br(t.recurrentRegularizer),this.biasRegularizer=br(t.biasRegularizer),this.kernelConstraint=ns(t.kernelConstraint),this.recurrentConstraint=ns(t.recurrentConstraint),this.biasConstraint=ns(t.biasConstraint),this.dropout=Cd([1,Rl([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Cd([1,Rl([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Wn(t);const n=t[t.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,n){return Ue(()=>{if(t=t,t.length!==2)throw new Ce(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training==null?!1:n.training;let i=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ll({ones:()=>Aa(t),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ll({ones:()=>Aa(i),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let u,l,c;0<this.dropout&&this.dropout<1&&(t=De(t,a[0]));let h=No(t,this.kernel.read());this.useBias&&(h=ao(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=De(i,o[0]));const f=this.recurrentKernel.read(),[p,g]=Xi(f,[2*this.units,this.units],f.rank-1),y=No(i,p),[x,v,S]=Xi(h,3,h.rank-1),[w,E]=Xi(y,2,y.rank-1);u=this.recurrentActivation.apply(pt(x,w)),l=this.recurrentActivation.apply(pt(v,E));const _=No(De(l,i),g);c=this.activation.apply(pt(S,_));const D=pt(De(u,i),De(pt(1,Wr(u)),c));return[D,D]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ol(this.activation),recurrentActivation:Ol(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Er(this.kernelInitializer),recurrentInitializer:Er(this.recurrentInitializer),biasInitializer:Er(this.biasInitializer),kernelRegularizer:er(this.kernelRegularizer),recurrentRegularizer:er(this.recurrentRegularizer),biasRegularizer:er(this.biasRegularizer),activityRegularizer:er(this.activityRegularizer),kernelConstraint:ts(this.kernelConstraint),recurrentConstraint:ts(this.recurrentConstraint),biasConstraint:ts(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,n)}}lk.className="GRUCell";at(lk);class Gz extends ql{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new lk(t),super(t)}call(t,n){return Ue(()=>{this.cell.dropoutMask!=null&&(gn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(gn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:s,training:i,initialState:a})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}Gz.className="GRU";at(Gz);class V2 extends P2{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,ps(this.units,"units"),this.activation=Ml(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=Ml(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=xr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=xr(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=xr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=br(t.kernelRegularizer),this.recurrentRegularizer=br(t.recurrentRegularizer),this.biasRegularizer=br(t.biasRegularizer),this.kernelConstraint=ns(t.kernelConstraint),this.recurrentConstraint=ns(t.recurrentConstraint),this.biasConstraint=ns(t.biasConstraint),this.dropout=Cd([1,Rl([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=Cd([1,Rl([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var n;t=Wn(t);const s=t[t.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,o=this.units;i=new(n=class extends Ma{apply(l,c){const h=a.apply([o]),f=new HN().apply([o]),p=a.apply([o*2]);return QO(QO(h,f),p)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,n){return Ue(()=>{const s=n.training==null?!1:n.training;if(t=t,t.length!==3)throw new Ce(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let i=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ll({ones:()=>Aa(t),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ll({ones:()=>Aa(i),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,u=this.recurrentDropoutMask;let l,c,h,f;0<this.dropout&&this.dropout<1&&(t=De(t,o[0]));let p=No(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=De(i,u[0])),p=pt(p,No(i,this.recurrentKernel.read())),this.useBias&&(p=ao(p,this.bias.read()));const[g,y,x,v]=Xi(p,4,p.rank-1);l=this.recurrentActivation.apply(g),c=this.recurrentActivation.apply(y),h=pt(De(c,a),De(l,this.activation.apply(x))),f=this.recurrentActivation.apply(v);const S=De(f,this.activation.apply(h));return[S,S,h]})}getConfig(){const t=super.getConfig(),n={units:this.units,activation:Ol(this.activation),recurrentActivation:Ol(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Er(this.kernelInitializer),recurrentInitializer:Er(this.recurrentInitializer),biasInitializer:Er(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:er(this.kernelRegularizer),recurrentRegularizer:er(this.recurrentRegularizer),biasRegularizer:er(this.biasRegularizer),activityRegularizer:er(this.activityRegularizer),kernelConstraint:ts(this.kernelConstraint),recurrentConstraint:ts(this.recurrentConstraint),biasConstraint:ts(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,n)}}V2.className="LSTMCell";at(V2);class jz extends ql{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new V2(t),super(t)}call(t,n){return Ue(()=>{this.cell.dropoutMask!=null&&(gn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(gn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:s,training:i,initialState:a})})}static fromConfig(t,n){return n.implmentation===0&&(n.implementation=1),new t(n)}}jz.className="LSTM";at(jz);class ck extends P2{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?t.push(...n.stateSize):t.push(n.stateSize);return t}call(t,n){return Ue(()=>{t=t;let s=t.slice(1);const i=[];for(const u of this.cells.slice().reverse())Array.isArray(u.stateSize)?i.push(s.splice(0,u.stateSize.length)):i.push(s.splice(0,1));i.reverse();const a=[];let o;for(let u=0;u<this.cells.length;++u){const l=this.cells[u];s=i[u],u===0?o=[t[0]].concat(s):o=[o[0]].concat(s),o=l.call(o,n),a.push(o.slice(1))}s=[];for(const u of a.slice().reverse())s.push(...u);return[o[0]].concat(s)})}build(t){QE(t)&&(t=t[0]),t=t;let n;this.cells.forEach((s,i)=>{Bc(`RNNCell_${i}`,()=>{s.build(t),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,t=[t[0],n]})}),this.built=!0}getConfig(){const t=super.getConfig(),n=a=>({className:a.getClassName(),config:a.getConfig()}),i={cells:this.cells.map(n)};return Object.assign({},t,i)}static fromConfig(t,n,s={}){const i=[];for(const a of n.cells)i.push(yu(a,s));return new t({cells:i})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const n of this.cells)t.push(...n.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const n of this.cells)t.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(t)}return t}getWeights(){const t=[];for(const n of this.cells)t.push(...n.weights);return JE(t)}setWeights(t){const n=[];for(const s of this.cells){const i=s.weights.length,a=t.splice(i);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],a[o]])}JN(n)}}ck.className="StackedRNNCells";at(ck);function Ll(r){const{ones:t,rate:n,training:s=!1,count:i=1,dropoutFunc:a}=r,o=()=>a!=null?a(t(),n):OV(t(),n),u=()=>z0(o,t,s);return!i||i<=1?Io(u().clone()):Array(i).fill(void 0).map(u).map(c=>Io(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Zge=function(r,t){var n={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(n[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(n[s[i]]=r[s[i]]);return n};class Wz extends ql{constructor(t){if(t.unroll)throw new un("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new un("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new es({ndim:5})]}call(t,n){return Ue(()=>{if(this.cell.dropoutMask!=null&&(gn(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(gn(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new Ce("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,i=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(t,{mask:s,training:i,initialState:a})})}computeOutputShape(t){let n=this.computeSingleOutputShape(t);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([t[0],...n.slice(-3)])]),n}getInitialState(t){return Ue(()=>{const{stateSize:n}=this.cell,s=t.shape,i=this.computeSingleOutputShape(s),a=[i[0],...i.slice(2)],o=hs(a);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(t,n=!1){Ue(()=>{if(!this.stateful)throw new xo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,i=this.computeSingleOutputShape(s),a=[i[0],...i.slice(2)];if(s[0]==null)throw new Ce("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>hs(a)):this.states_=[hs(a)];else if(t==null)gn(this.states_),this.keptStates!=null&&(gn(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>hs(a)):this.states_[0]=hs(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Ce(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);n?this.keptStates.push(this.states_.slice()):gn(this.states_);for(let u=0;u<this.states_.length;++u){const l=t[u],c=a;if(!Bn(l.shape,c))throw new Ce(`State ${u} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[u]=l}}this.states_=this.states_.map(u=>Io(u.clone()))})}computeSingleOutputShape(t){const{dataFormat:n,filters:s,kernelSize:i,padding:a,strides:o,dilationRate:u}=this.cell,l=n==="channelsFirst",c=t[l?3:2],h=t[l?4:3],f=no(c,i[0],a,o[0],u[0]),p=no(h,i[1],a,o[1],u[1]);return[...t.slice(0,2),...l?[s,f,p]:[f,p,s]]}}Wz.className="ConvRNN2D";class hk extends V2{constructor(t){const{filters:n,kernelSize:s,strides:i,padding:a,dataFormat:o,dilationRate:u}=t;super(Object.assign({},t,{units:n})),this.filters=n,ps(this.filters,"filters"),this.kernelSize=td(s,2,"kernelSize"),this.kernelSize.forEach(l=>ps(l,"kernelSize")),this.strides=td(i||1,2,"strides"),this.strides.forEach(l=>ps(l,"strides")),this.padding=a||"valid",ta(this.padding),this.dataFormat=o||"channelsLast",Lr(this.dataFormat),this.dilationRate=td(u||1,2,"dilationRate"),this.dilationRate.forEach(l=>ps(l,"dilationRate"))}build(t){var n;t=Wn(t);const s=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[s]==null)throw new Ce(`The channel dimension of the input should be defined. Found ${t[s]}`);const i=t[s],a=4,o=this.kernelSize.concat([i,this.filters*a]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const u=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",u,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,h=this.filters;l=new(n=class extends Ma{apply(p,g){const y=c.apply([h]),x=Dh([h]),v=c.apply([h*2]);return WN([y,x,v])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,n){return Ue(()=>{if(t.length!==3)throw new Ce(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const s=n.training||!1,i=t[0],a=t[1],o=t[2],u=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ll({ones:()=>Aa(i),rate:this.dropout,training:s,count:u,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(z,X,Y)=>!X||!X[Y]?z:De(X[Y],z);let h=c(i,l,0),f=c(i,l,1),p=c(i,l,2),g=c(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ll({ones:()=>Aa(a),rate:this.recurrentDropout,training:s,count:u,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let x=c(a,y,0),v=c(a,y,1),S=c(a,y,2),w=c(a,y,3);const E=3,[_,D,I,k]=Xi(this.kernel.read(),u,E),[A,N,F,$]=this.useBias?Xi(this.bias.read(),u):[null,null,null,null];h=this.inputConv(h,_,A,this.padding),f=this.inputConv(f,D,N,this.padding),p=this.inputConv(p,I,F,this.padding),g=this.inputConv(g,k,$,this.padding);const[O,M,B,U]=Xi(this.recurrentKernel.read(),u,E);x=this.recurrentConv(x,O),v=this.recurrentConv(v,M),S=this.recurrentConv(S,B),w=this.recurrentConv(w,U);const V=this.recurrentActivation.apply(pt(h,x)),Z=this.recurrentActivation.apply(pt(f,v)),J=pt(De(Z,o),De(V,this.activation.apply(pt(p,S)))),ne=De(this.recurrentActivation.apply(pt(g,w)),this.activation.apply(J));return[ne,ne,J]})}getConfig(){const t=super.getConfig(),{units:n}=t,s=Zge(t,["units"]),i={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},s,i)}inputConv(t,n,s,i){const a=ah(t,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ao(a,s,this.dataFormat):a}recurrentConv(t,n){return ah(t,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}hk.className="ConvLSTM2DCell";at(hk);class Hz extends Wz{constructor(t){const n=new hk(t);super(Object.assign({},t,{cell:n}))}static fromConfig(t,n){return new t(n)}}Hz.className="ConvLSTM2D";at(Hz);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fk extends Dn{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const n=t.shape,s=[];for(let i=0;i<this.noiseShape.length;++i)s.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return s}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,a=this.getNoiseShape(s);return z0(()=>OV(s,this.rate,a,this.seed),()=>s,i)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(t,n),t}dispose(){return super.dispose()}}fk.className="Dropout";at(fk);class qz extends fk{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const n=t.shape;return[n[0],1,n[2]]}}qz.className="SpatialDropout1D";at(qz);class Kz extends Dn{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let n=null;t.batchSize!=null&&(n=t.batchSize),this.batchInputShape=[n,t.inputDim]}this.units=t.units,ps(this.units,"units"),this.activation=Ml(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=xr(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=xr(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=ns(t.kernelConstraint),this.biasConstraint=ns(t.biasConstraint),this.kernelRegularizer=br(t.kernelRegularizer),this.biasRegularizer=br(t.biasRegularizer),this.activityRegularizer=br(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=Wn(t);const n=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(t){t=Wn(t);const n=t.slice();return n[n.length-1]=this.units,n}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t),i=NV(this.activation.getClassName());let a;return i!=null?a=No(s,this.kernel.read(),i,this.bias?this.bias.read():null):(a=No(s,this.kernel.read()),this.bias!=null&&(a=ao(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:Ol(this.activation),useBias:this.useBias,kernelInitializer:Er(this.kernelInitializer),biasInitializer:Er(this.biasInitializer),kernelRegularizer:er(this.kernelRegularizer),biasRegularizer:er(this.biasRegularizer),activityRegularizer:er(this.activityRegularizer),kernelConstraint:ts(this.kernelConstraint),biasConstraint:ts(this.biasConstraint)},n=super.getConfig();return Object.assign(t,n),t}}Kz.className="Dense";at(Kz);class Xz extends Dn{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Wn(t);for(const n of t.slice(1))if(n==null)throw new Ce(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],Tl(t,1)]}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);let s=rn(t);if(this.dataFormat==="channelsFirst"&&s.rank>1){const i=[0];for(let a=2;a<s.rank;++a)i.push(a);i.push(1),s=_n(s,i)}return $me(s)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(t,n),t}}Xz.className="Flatten";at(Xz);class Yz extends Dn{constructor(t){super(t),this.supportsMasking=!0,this.activation=Ml(t.activation)}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t);return this.activation.apply(s)})}getConfig(){const t={activation:Ol(this.activation)},n=super.getConfig();return Object.assign(t,n),t}}Yz.className="Activation";at(Yz);class Zz extends Dn{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,n){return Ue(()=>(t=rn(t),Ame(t,this.n)))}getConfig(){const t={n:this.n},n=super.getConfig();return Object.assign(t,n),t}}Zz.className="RepeatVector";at(Zz);let Qz=class extends Dn{constructor(t){super(t),this.targetShape=t.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,n){const s="Total size of new array must be unchanged.",i=n.slice();let a=1,o=null;for(let l=0;l<i.length;++l){const c=i[l];if(this.isUnknown(c))if(o===null)o=l;else throw new Ce("Can only specifiy one unknown dimension.");else a*=c}const u=Tl(t);if(o!==null){if(a===0||u%a!==0)throw new Ce(s);i[o]=u/a}else if(u!==a)throw new Ce(s);return i}computeOutputShape(t){let n=!1;for(let s=0;s<t.length;++s)if(this.isUnknown(t[s])){n=!0;break}return n?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t),i=s.shape,a=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return ke(s,a)})}getConfig(){const t={targetShape:this.targetShape},n=super.getConfig();return Object.assign(t,n),t}};Qz.className="Reshape";at(Qz);class Jz extends Dn{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const n=ro(1,t.dims.length+1);if(!Bn(t.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new es({ndim:this.dims.length+1})]}computeOutputShape(t){t=Wn(t);const n=t.slice();return this.dims.forEach((s,i)=>{n[i+1]=t[s]}),n}call(t,n){return _n(rn(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},n=super.getConfig();return Object.assign(t,n),t}}Jz.className="Permute";at(Jz);class eU extends Dn{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,t),n}computeMask(t,n){const s=rn(t);return GE(nb(s,this.maskValue),-1)}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t),o=GE(nb(s,this.maskValue),-1,!0);return De(s,_t(o,s.dtype))})}}eU.className="Masking";at(eU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tU extends Dn{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let n=null;t.batchSize!=null&&(n=t.batchSize),t.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(mr(t.inputLength))}this.inputDim=t.inputDim,ps(this.inputDim,"inputDim"),this.outputDim=t.outputDim,ps(this.outputDim,"outputDim"),this.embeddingsInitializer=xr(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=br(t.embeddingsRegularizer),this.activityRegularizer=br(t.activityRegularizer),this.embeddingsConstraint=ns(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,n){return Ue(()=>this.maskZero?(t=rn(t),nb(t,Nn(t))):null)}computeOutputShape(t){if(t=Wn(t),this.inputLength==null)return[...t,this.outputDim];const n=mr(this.inputLength);if(n.length!==t.length-1)throw new Ce(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let s=0;for(let i=0;i<n.length;++i){const a=n[i],o=t[i+1];if(a!=null&&o!=null&&a!==o)throw new Ce(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);a==null&&(n[s]=o),s++}}return[t[0],...n,this.outputDim]}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);let s=rn(t);s.dtype!=="int32"&&(s=B0(s,"int32"));const i=RV(this.embeddings.read(),ke(s,[s.size]));return ke(i,Wn(this.computeOutputShape(s.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Er(this.embeddingsInitializer),embeddingsRegularizer:er(this.embeddingsRegularizer),activityRegularizer:er(this.activityRegularizer),embeddingsConstraint:ts(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(t,n),t}}tU.className="Embedding";at(tU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kh extends Dn{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new un}computeElementwiseOpOutputShape(t,n){if(t==null||n==null)return null;if(t.length<n.length)return this.computeElementwiseOpOutputShape(n,t);if(n.length===0)return t;const s=t.slice(0,t.length-n.length);for(let i=0;i<n.length;++i){const a=t[t.length-n.length+i],o=n[i];if(a==null||o==null||a<0||o<0)s.push(null);else if(a===1)s.push(o);else if(o===1)s.push(a);else{if(a!==o)throw new Ce("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(n));s.push(a)}}return s}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Wn(t)]),t=t,t.length<2)throw new Ce(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let n=[];for(const a of t)a!=null&&a[0]!==null&&n.push(a[0]);if(n=Dl(n),n.length>1)throw new Ce(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let s=t[0]==null?null:t[0].slice(1);for(let a=1;a<t.length;++a){const o=t[a]==null?null:t[a].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const i=t.map(a=>a.length);t.indexOf(null)===-1&&Dl(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,n){return Ue(()=>{if(t=t,this.reshapeRequired){const s=[],i=t.map(a=>a.rank);if(i.indexOf(null)===-1){const a=Rl(i);for(let o of t){const u=o.rank;for(let l=0;l<a-u;++l)o=P0(o,1);s.push(o)}return this.mergeFunction(s)}else{let a=!1;for(const l of t){const c=l.rank;if(c==null){const h=l.shape,f=h[0],p=h.slice(1).concat([f]);let g=ke(l,[f].concat(Tl(h.slice(1))));g=_n(g,[1,0]),g=ke(g,p),s.push(g),a=!0}else if(c>1){const h=ro(1,c).concat([0]);s.push(_n(l,h)),a=!0}else s.push(l)}let o=this.mergeFunction(s);const u=o.rank;if(a){if(u==null){const l=o.shape,c=l.length,h=l[c-1],f=[h].concat(l.slice(0,l.length-1));o=ke(_n(ke(o,[-1,h]),[1,0]),f)}else if(u>1){const l=[u-1].concat(ro(0,u-1));o=_n(o,l)}}return o}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let n;t[0]==null?n=null:n=t[0].slice(1);for(let i=1;i<t.length;++i){const a=t[i]==null?null:t[i].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let s=[];for(const i of t)i!=null&&i[0]!==null&&s.push(i[0]);return s=Dl(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(t,n){return Ue(()=>{if(n==null)return null;if(!Array.isArray(n))throw new Ce("`mask` should be an Array");if(!Array.isArray(t))throw new Ce("`inputs` should be an Array");if(n.length!==t.length)throw new Ce(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:Sa(i,0));let s=n[0];for(let i=1;i<n.length-1;++i)s=_u(s,n[i]);return s})}}let nU=class extends kh{constructor(t){super(t)}mergeFunction(t){return Ue(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=pt(n,t[s]);return n})}};nU.className="Add";at(nU);let rU=class extends kh{constructor(t){super(t)}mergeFunction(t){return Ue(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=De(n,t[s]);return n})}};rU.className="Multiply";at(rU);class sU extends kh{constructor(t){super(t)}mergeFunction(t){return Ue(()=>{let n=t[0].clone();for(let s=1;s<t.length;++s)n=pt(n,t[s]);return De(1/t.length,n)})}}sU.className="Average";at(sU);let iU=class extends kh{constructor(t){super(t)}mergeFunction(t){return Ue(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=Wl(n,t[s]);return n})}};iU.className="Maximum";at(iU);let aU=class extends kh{constructor(t){super(t)}mergeFunction(t){return Ue(()=>{let n=t[0];for(let s=1;s<t.length;++s)n=J3(n,t[s]);return n})}};aU.className="Minimum";at(aU);class oU extends kh{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new Ce("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let n=!0;for(const i of t)if(i!=null){n=!1;break}if(n)return;const s=[];for(let i=0;i<t.length;++i){const a=t[i].slice();a.splice(this.axis,1);let o=!1;for(const u of s)if(Bn(u,a)){o=!0;break}o||s.push(a)}if(s.length>1)throw new Ce("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Ue(()=>WN(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new Ce("A `Concatenate` layer should be called on a list of inputs.");const n=t,s=n[0].slice(),i=this.axis<0?s.length+this.axis:this.axis;for(const a of n.slice(1)){if(s[i]==null||a[i]==null){s[i]=null;break}s[i]+=a[i]}return s}computeMask(t,n){if(n==null)return null;if(!Array.isArray(n))throw new Ce("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Ce("`inputs` should be an array for Concatenate");if(n.length!==t.length)throw new Ce(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${t.length})`);return Ue(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const i=[];for(let o=0;o<t.length;++o)n[o]==null?i.push(_t(Aa(t[o]),"bool")):n[o].rank<t[o].rank?i.push(Sa(n[o],-1)):i.push(n[o]);const a=fi(i,this.axis);return _7(a,-1,!1)})}getConfig(){const t={axis:this.axis},n=super.getConfig();return Object.assign(t,n),t}}oU.className="Concatenate";at(oU);function hm(r,t){for(;r<0;)r+=t;return r}function Qge(r,t,n){if(r.shape.length>3||t.shape.length>3)throw new un("batchDot is not implemented for tensors of 4D or higher rank yet");if(oe(r.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${r.shape.length}`),oe(r.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n=="number"&&(n=[n,n]),r.dtype==="complex64"||t.dtype==="complex64")throw new un("batchDot is not implemented for complex64-type Tensors yet.");const s=r.shape.length,i=t.shape.length;n==null&&(n=[s-1,i-2]);const a=n;return Ue(()=>{let o;if(s>i){o=s-i;const l=[];for(let c=0;c<o;++c)l.push(1);t=ke(t,t.shape.concat(l))}else if(i>s){o=i-s;const l=[];for(let c=0;c<o;++c)l.push(1);r=ke(r,r.shape.concat(l))}else o=0;let u;if(r.shape.length===2&&t.shape.length===2)a[0]===a[1]?u=Vt(De(r,t),a[0]):u=Vt(De(_n(r,[1,0]),t),a[1]);else{const l=a[0]!==r.shape.length-1,c=a[1]===t.shape.length-1;u=On(r,t,l,c)}if(o>0){let l;s>i?l=s+i-3:l=s-1;const c=[];for(let h=l;h<l+o;++h)c.push(h);u=$0(u,c)}return u.shape.length===1&&(u=Sa(u,1)),u})}class uU extends kh{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){oe(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0],s=t[1];if(n.length>3||s.length>3)throw new un("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,s);if(n[i[0]]!==s[i[1]])throw new Ce(`Dimension incompatibility: ${n[i[0]]} !== ${s[i[1]]}`)}mergeFunction(t){if(t.length!==2)throw new Ce(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let n=t[0],s=t[1],i;return Array.isArray(this.axes)?i=this.axes.map((a,o)=>hm(a,t[o].shape.length)):i=[hm(this.axes,n.shape.length),hm(this.axes,s.shape.length)],this.normalize&&(n=lb(n,i[0]),s=lb(s,i[1])),Qge(n,s,i)}interpretAxes(t,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[hm(this.axes,t.length),hm(this.axes,n.length)],s}computeOutputShape(t){oe(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=t[0].slice(),s=t[1].slice();if(n.length>3||s.length>3)throw new un("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,s);n.splice(i[0],1),s.splice(i[1],1),s.splice(0,1);const a=n.concat(s);return a.length===1&&a.push(1),a}computeMask(t,n){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(t,n),t}}uU.className="Dot";at(uU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lU extends Dn{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,t),n}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t);return z0(()=>pt(F2(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}lU.className="GaussianNoise";at(lU);class cU extends Dn{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return Ue(()=>{this.invokeCallHook(t,n);const s=rn(t);return this.rate>0&&this.rate<1?z0(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return De(s,F2(s.shape,1,a))},()=>s,n.training||!1):s})}}cU.className="GaussianDropout";at(cU);class hU extends Dn{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||rn(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),n={rate:this.rate};return Object.assign(n,t),n}call(t,n){return Ue(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(t);return z0(()=>{const a=rn(t),u=-1.6732632423543772*1.0507009873554805;let l=Wd(T2(s),this.rate);l=B0(l,"float32");const c=((1-this.rate)*(1+this.rate*u**2))**-.5,h=-c*u*this.rate,f=pt(De(a,l),De(pt(l,-1),u));return pt(De(f,c),h)},()=>rn(t),n.training||!1)}return t})}}hU.className="AlphaDropout";at(hU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mg(r,t,n,s,i,a=.001){let o;if(r.rank===2)o=Yue(r,t,n,s,i,a);else if(r.rank===3)o=Que(r,t,n,s,i,a);else if(r.rank===4)o=ele(r,t,n,s,i,a);else throw new un(`batchNormalization is not implemented for array of rank ${r.rank} yet`);return o}function Jge(r,t,n,s,i=.001){return Ue(()=>{const a=eN(r,s),o=a.mean,u=a.variance;return[mg(r,o,u,n,t,i),o,u]})}function e0e(r,t,n,s,i=.001){return Ue(()=>{const a=eN(r,s),o=a.mean,u=a.variance,l=[];for(const y of ro(0,r.rank))s.indexOf(y)!==-1?l.push(1):l.push(r.shape[y]);const c=ke(o,l),h=ke(u,l),f=t==null?null:ke(t,l),p=n==null?null:ke(n,l);return[mg(r,c,h,p,f,i),o,u]})}function t0e(r,t,n,s,i=.001){return Bn(s.slice().sort(),ro(0,r.rank-1))?Jge(r,t,n,s,i):e0e(r,t,n,s,i)}class fU extends Dn{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xr(t.betaInitializer||"zeros"),this.gammaInitializer=xr(t.gammaInitializer||"ones"),this.movingMeanInitializer=xr(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=xr(t.movingVarianceInitializer||"ones"),this.betaConstraint=ns(t.betaConstraint),this.gammaConstraint=ns(t.gammaConstraint),this.betaRegularizer=br(t.betaRegularizer),this.gammaRegularizer=br(t.gammaRegularizer)}build(t){t=Wn(t);const n=this.axis>=0?this.axis:this.axis+t.length,s=t[n];if(s==null)throw new Ce(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new es({ndim:t.length,axes:{[n]:s}})];const i=[s];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,n){return Ue(()=>{const s=n.training==null?!1:n.training,i=rn(t),a=i.shape,o=a.length,u=ro(0,o),l=this.axis>=0?this.axis:this.axis+o;u.splice(l,1);const c=ch(1,o);c[l]=a[l];const h=u.slice();h.sort();const f=!Bn(h,ro(0,o).slice(0,o-1)),p=()=>{if(f){const w=ke(this.movingMean.read(),c),E=ke(this.movingVariance.read(),c),_=this.center?ke(this.beta.read(),c):null,D=this.scale?ke(this.gamma.read(),c):null;return mg(i,w,E,_,D,this.epsilon)}else return mg(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[g,y,x]=t0e(i,this.gamma.read(),this.beta.read(),u,this.epsilon),v=(w,E,_)=>{Ue(()=>{const D=1-_,I=w.read(),k=De(Kt(I,E),D);w.write(Kt(I,k))})};return(()=>{v(this.movingMean,y,this.momentum),v(this.movingVariance,x,this.momentum)})(),g})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Er(this.betaInitializer),gammaInitializer:Er(this.gammaInitializer),movingMeanInitializer:Er(this.movingMeanInitializer),movingVarianceInitializer:Er(this.movingVarianceInitializer),betaRegularizer:er(this.betaRegularizer),gammaRegularizer:er(this.gammaRegularizer),betaConstraint:ts(this.betaConstraint),gammaConstraint:ts(this.gammaConstraint)},n=super.getConfig();return Object.assign(t,n),t}}fU.className="BatchNormalization";at(fU);class dU extends Dn{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=xr(t.betaInitializer||"zeros"),this.gammaInitializer=xr(t.gammaInitializer||"ones"),this.betaRegularizer=br(t.betaRegularizer),this.gammaRegularizer=br(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=Wn(t);const n=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(const a of this.axis)if(a<0||a>=n)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Dl(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>t[a]),i=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(t,n){const s=rn(t),i=s.shape,a=i.length;return Ue(()=>{let{mean:u,variance:l}=eN(s,this.axis,!0);const c=ch(1,a);for(const x of this.axis)c[x]=i[x];const h=x=>x!=null&&x.shape.length!==a?ke(x,c):x;let f=this.scale?h(this.gamma.read()):null,p=this.center?h(this.beta.read()):null;const g=[],y=[];for(let x=0;x<a;++x)this.axis.indexOf(x)!==-1?(g.push(i[x]),y.push(1)):(g.push(1),y.push(i[x]));return u=Za(u,g),l=Za(l,g),f!=null&&(f=Za(f,y)),p!=null&&(p=Za(p,y)),mg(s,u,l,p,f,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Er(this.betaInitializer),gammaInitializer:Er(this.gammaInitializer),betaRegularizer:er(this.betaRegularizer),gammaRegularizer:er(this.gammaRegularizer)},n=super.getConfig();return Object.assign(t,n),t}}dU.className="LayerNormalization";at(dU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n0e(r,t,n){return Ue(()=>{if(r.rank!==4)throw new Ce(`temporalPadding expects input tensor to be 4-D, but received a ${r.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new Ce("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=so()),n!=="channelsLast"&&n!=="channelsFirst")throw new Ce(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],t[0],t[1]]:s=[[0,0],t[0],t[1],[0,0]],tN(r,s)})}class pU extends Dn{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?so():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new Ce(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let n,s;if(typeof t.padding[0]=="number")n=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new Ce(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(n=t.padding[0],t.padding[1].length!==2)throw new Ce(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);s=t.padding[1]}this.padding=[n,s]}this.inputSpec=[new es({ndim:4})]}computeOutputShape(t){t=Wn(t);let n,s;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?n=t[2]+this.padding[0][0]+this.padding[0][1]:n=null,t[3]!=null&&t[3]>=0?s=t[3]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],t[1],n,s]):(t[1]!=null&&t[1]>=0?n=t[1]+this.padding[0][0]+this.padding[0][1]:n=null,t[2]!=null&&t[2]>=0?s=t[2]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],n,s,t[3]])}call(t,n){return Ue(()=>n0e(rn(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}pU.className="ZeroPadding2D";at(pU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function z2(r,t,n,s,i,a){return Ue(()=>{Lr(i),AV(a),ta(s),n==null&&(n=[1,1]),s==null&&(s="valid"),i==null&&(i=so()),a==null&&(a="max"),r=ik(r,i);let o;const u=s==="same"?"same":"valid";return a==="max"?o=Q3(r,t,n,u):o=U3(r,t,n,u),i==="channelsFirst"&&(o=_n(o,[0,3,1,2])),o})}function mU(r,t,n,s,i,a){return Ue(()=>{Lr(i),AV(a),ta(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),i==null&&(i=so()),a==null&&(a="max"),r=Az(r,i);let o;const u=s==="same"?"same":"valid";return a==="max"?o=Mce(r,t,n,u):o=zue(r,t,n,u),i==="channelsFirst"&&(o=_n(o,[0,4,1,2,3])),o})}class gU extends Dn{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new Ce(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(ps(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new Ce(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);ps(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,ta(this.padding),this.inputSpec=[new es({ndim:3})]}computeOutputShape(t){t=Wn(t);const n=no(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],n,t[2]]}call(t,n){return Ue(()=>{this.invokeCallHook(t,n),t=P0(rn(t),2);const s=this.poolingFunction(rn(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return $0(s,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(t,n),t}}class yU extends gU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),z2(t,n,s,i,a,"max")}}yU.className="MaxPooling1D";at(yU);class xU extends gU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),z2(t,n,s,i,a,"avg")}}xU.className="AveragePooling1D";at(xU);class bU extends Dn{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new Ce(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];ps(this.poolSize,"poolSize"),ps(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Lr(this.dataFormat),ta(this.padding),this.inputSpec=[new es({ndim:4})]}computeOutputShape(t){t=Wn(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2];return n=no(n,this.poolSize[0],this.padding,this.strides[0]),s=no(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s]:[t[0],n,s,t[3]]}call(t,n){return Ue(()=>(this.invokeCallHook(t,n),this.poolingFunction(rn(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class vU extends bU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),z2(t,n,s,i,a,"max")}}vU.className="MaxPooling2D";at(vU);class wU extends bU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),z2(t,n,s,i,a,"avg")}}wU.className="AveragePooling2D";at(wU);class SU extends Dn{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new Ce(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];ps(this.poolSize,"poolSize"),ps(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Lr(this.dataFormat),ta(this.padding),this.inputSpec=[new es({ndim:5})]}computeOutputShape(t){t=Wn(t);let n=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],i=this.dataFormat==="channelsFirst"?t[4]:t[3];return n=no(n,this.poolSize[0],this.padding,this.strides[0]),s=no(s,this.poolSize[1],this.padding,this.strides[1]),i=no(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],n,s,i]:[t[0],n,s,i,t[4]]}call(t,n){return Ue(()=>(this.invokeCallHook(t,n),this.poolingFunction(rn(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class CU extends SU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),mU(t,n,s,i,a,"max")}}CU.className="MaxPooling3D";at(CU);class _U extends SU{constructor(t){super(t)}poolingFunction(t,n,s,i,a){return Lr(a),ta(i),mU(t,n,s,i,a,"avg")}}_U.className="AveragePooling3D";at(_U);class EU extends Dn{constructor(t){super(t),this.inputSpec=[new es({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,n){throw new un}}class DU extends EU{constructor(t){super(t||{})}call(t,n){return Ue(()=>{const s=rn(t);return jr(s,1)})}}DU.className="GlobalAveragePooling1D";at(DU);class TU extends EU{constructor(t){super(t||{})}call(t,n){return Ue(()=>{const s=rn(t);return Do(s,1)})}}TU.className="GlobalMaxPooling1D";at(TU);class NU extends Dn{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Lr(this.dataFormat),this.inputSpec=[new es({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,n){throw new un}getConfig(){const t={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(t,n),t}}class kU extends NU{call(t,n){return Ue(()=>{const s=rn(t);return this.dataFormat==="channelsLast"?jr(s,[1,2]):jr(s,[2,3])})}}kU.className="GlobalAveragePooling2D";at(kU);class AU extends NU{call(t,n){return Ue(()=>{const s=rn(t);return this.dataFormat==="channelsLast"?Do(s,[1,2]):Do(s,[2,3])})}}AU.className="GlobalMaxPooling2D";at(AU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class IU extends Dn{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(t,n),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,n,s={}){const i=n.layer,a=yu(i,s);delete n.layer;const o={layer:a};return Object.assign(o,n),new t(o)}}class $U extends IU{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=Wn(t),t.length<3)throw new Ce(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const n=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=Wn(t);const n=[t[0]].concat(t.slice(2)),s=this.layer.computeOutputShape(n),i=t[1];return[s[0],i].concat(s.slice(1))}call(t,n){return Ue(()=>(t=rn(t),zz((o,u)=>[rn(this.layer.call(o,n)),[]],t,[],!1,null,null,!1,!0)[1]))}}$U.className="TimeDistributed";at($U);function r0e(r){Nh(Eme,"BidirectionalMergeMode",r)}const s0e="concat";class FU extends IU{constructor(t){super(t);const n=t.layer.getConfig(),s={};s.className=t.layer.getClassName(),s.config=n,this.forwardLayer=yu(s),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=t.layer.getClassName(),i.config=n,this.backwardLayer=yu(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?s0e:t.mergeMode,r0e(this.mergeMode),t.weights)throw new un("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const n=t.length,s=Math.floor(n/2);this.forwardLayer.setWeights(t.slice(0,s)),this.backwardLayer.setWeights(t.slice(s))}computeOutputShape(t){let n=this.forwardLayer.computeOutputShape(t);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,i,a;return this.returnState&&(a=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,i=[s]):this.mergeMode==null?i=[s,s.slice()]:i=[s],this.returnState?this.mergeMode==null?i.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):li(i)}apply(t,n){let s=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const a=Vz(t,s,i,this.numConstants);if(t=a.inputs,s=a.initialState,i=a.constants,Array.isArray(t)&&(s=t.slice(1),t=t[0]),(s==null||s.length===0)&&i==null)return super.apply(t,n);const o=[],u=[];if(s!=null){const c=s.length;if(c%2>0)throw new Ce("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const h=s.map(f=>new es({shape:f.shape}));this.forwardLayer.stateSpec=h.slice(0,c/2),this.backwardLayer.stateSpec=h.slice(c/2),u.push(...h)}if(i!=null)throw new un("Support for constants in Bidirectional layers is not implemented yet.");const l=o[0]instanceof Co;for(const c of o)if(c instanceof Co!==l)throw new Ce("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[t].concat(o),h=this.inputSpec.concat(u),f=this.inputSpec;this.inputSpec=h;const p=super.apply(c,n);return this.inputSpec=f,p}else return super.apply(t,n)}call(t,n){return Ue(()=>{const s=n.initialState;let i,a;if(s==null)i=this.forwardLayer.call(t,n),a=this.backwardLayer.call(t,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);i=this.forwardLayer.call(t,Object.assign(n,{initialState:l})),a=this.backwardLayer.call(t,Object.assign(n,{initialState:c}))}let o;this.returnState&&(Array.isArray(i)&&(o=i.slice(1).concat(a.slice(1))),i=i[0],a=a[0]),this.returnSequences&&(a=oh(a,1));let u;return this.mergeMode==="concat"?u=WN([i,a]):this.mergeMode==="sum"?u=pt(i,a):this.mergeMode==="ave"?u=De(.5,pt(i,a)):this.mergeMode==="mul"?u=De(i,a):this.mergeMode==null&&(u=[i,a]),this.returnState?this.mergeMode==null?u.concat(o):[u].concat(o):u})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Bc(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Bc(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(t,n),t}static fromConfig(t,n){const s=yu(n.layer);if(delete n.layer,n.numConstants!=null)throw new un("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=s,new t(i)}}FU.className="Bidirectional";at(FU);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class RU extends Dn{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(t,n),t}call(t,n){return Ue(()=>(t=rn(t),t.dtype!=="float32"&&(t=B0(t,"float32")),pt(De(t,this.scale),this.offset)))}}RU.className="Rescaling";at(RU);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i0e=Ke();i0e.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,r=>{r&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var gM;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_QINT16=15]="DT_QINT16",r[r.DT_QUINT16=16]="DT_QUINT16",r[r.DT_UINT16=17]="DT_UINT16",r[r.DT_COMPLEX128=18]="DT_COMPLEX128",r[r.DT_HALF=19]="DT_HALF",r[r.DT_RESOURCE=20]="DT_RESOURCE",r[r.DT_VARIANT=21]="DT_VARIANT",r[r.DT_UINT32=22]="DT_UINT32",r[r.DT_UINT64=23]="DT_UINT64",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",r[r.DT_QINT16_REF=115]="DT_QINT16_REF",r[r.DT_QUINT16_REF=116]="DT_QUINT16_REF",r[r.DT_UINT16_REF=117]="DT_UINT16_REF",r[r.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",r[r.DT_HALF_REF=119]="DT_HALF_REF",r[r.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",r[r.DT_VARIANT_REF=121]="DT_VARIANT_REF",r[r.DT_UINT32_REF=122]="DT_UINT32_REF",r[r.DT_UINT64_REF=123]="DT_UINT64_REF"})(gM||(gM={}));var yM;(function(r){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})(yM||(yM={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var xM;(function(r){r[r.FAIL=0]="FAIL",r[r.SHORTEST=1]="SHORTEST",r[r.LONGEST=2]="LONGEST"})(xM||(xM={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dt(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&oe(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0e=Y7;class U2 extends GT{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new pP(this,ol())}nextDataId(){return U2.nextDataId++}write(t,n,s){this.firstUse&&(this.firstUse=!1,Ke().get("IS_NODE")&&Hi(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:t,dtype:s,refCount:1}),i}makeTensorInfo(t,n,s){let i;if(n==="string"&&s!=null&&s.length>0&&Ig(s[0])){const a=s.map(o=>El(o));i=this.write(a,t,n)}else i=this.write(s,t,n);return{dataId:i,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,s,i,a){this.data.set(t,{values:n,dtype:i,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:s}=this.data.get(t);if(n==="complex64"){const i=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Eu(i,a)}return this.data.get(t).values}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(i=>Fl(i));return hn(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return hn(t.shape,t.dtype,n)}makeOutput(t,n,s){return ol().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=oi();return t(),{kernelMs:oi()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Dt([t],"where");const n=this.readSync(t.dataId);return a0e(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}U2.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OU(r){const t=new Float32Array(r.length);for(let n=0;n<r.length;++n)t[n]=Math.abs(r[n]);return t}const o0e=r=>{const{x:t}=r.inputs,n=r.backend;Dt(t,"abs");let s=new Float32Array(Je(t.shape));const i=n.data.get(t.dataId).values;return s=OU(i),n.makeOutput(s,t.shape,t.dtype)},u0e={kernelName:xv,backendName:"cpu",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(r){return(t,n,s,i,a)=>{const o=nn(t,n),u=o.length,l=Mt(o),c=Je(o),h=As(a,c),f=t.length,p=n.length,g=Mt(t),y=Mt(n),x=bd(t,o),v=bd(n,o);if(x.length+v.length===0)for(let S=0;S<h.length;++S)h[S]=r(s[S%s.length],i[S%i.length]);else for(let S=0;S<h.length;++S){const w=zd(S,u,l),E=w.slice(-f);x.forEach(k=>E[k]=0);const _=Eo(E,f,g),D=w.slice(-p);v.forEach(k=>D[k]=0);const I=Eo(D,p,y);h[S]=r(s[_],i[I])}return[h,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ki(r){const{inputs:t,backend:n}=r,{real:s,imag:i}=t,a=n.data.get(s.dataId).values,o=n.data.get(i.dataId).values,u=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(u.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",o)},u}const l0e={kernelName:e3,backendName:"cpu",kernelFunc:ki};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pb(r,t,n="float32"){if(n==="complex64"){const i=pb(r,t,"float32"),a=pb(r,t,"float32");return ki({inputs:{real:i,imag:a},backend:r})}const s=Us(Je(t),n);return r.makeTensorInfo(t,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ro(r){const{inputs:t,backend:n}=r,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const c0e={kernelName:Jg,backendName:"cpu",kernelFunc:Ro};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hh(r){const{inputs:t,backend:n}=r,{input:s}=t,i=n.data.get(s.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const h0e={kernelName:S3,backendName:"cpu",kernelFunc:hh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(r,t,n,s){if(s==="int32"){const i=Int32Array.from(r);return[t,"int32",i]}if(s==="bool"){const i=Eh([0],n),[a,o]=qr((u,l)=>u!==l?1:0)(t,[],r,i,"bool");return[o,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Bl(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{dtype:a}=s;if(a==="complex64"){if(i.dtype==="complex64")return Ro({inputs:{x:i},backend:n});const h=pb(n,i.shape,i.dtype),f=Bl({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),p=ki({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(i.dtype==="complex64"){const h=hh({inputs:{input:i},backend:n}),f=Bl({inputs:{x:h},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(h),f}if(!yP(i.dtype,a)){const h=Ro({inputs:{x:i},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:a}}const o=n.data.get(i.dataId).values,[u,l,c]=MU(o,i.shape,i.dtype,a);return n.makeTensorInfo(u,l,c)}const f0e={kernelName:Vg,backendName:"cpu",kernelFunc:Bl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vs(r,t,n,s){return n==null?({inputs:i,backend:a})=>{const{a:o,b:u}=i,l=a;Dt([o,u],r);const c=l.data.get(o.dataId).values,h=l.data.get(u.dataId).values,f=o.dtype==="string"?lh(c):c,p=o.dtype==="string"?lh(h):h,g=s||o.dtype,[y,x]=t(o.shape,u.shape,f,p,g);return l.makeTensorInfo(x,g,y)}:({inputs:i,backend:a})=>{const{a:o,b:u}=i,l=a;if(o.dtype==="complex64"||u.dtype==="complex64"){const c=Bl({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(c.dataId),f=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,g=l.data.get(f.dataId).values,y=l.data.get(p.dataId).values,x=Bl({inputs:{x:u},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(x.dataId),S=v.complexTensorInfos.real,w=v.complexTensorInfos.imag,E=l.data.get(S.dataId).values,_=l.data.get(w.dataId).values,[D,I,k]=n(o.shape,u.shape,g,y,E,_),A=l.makeTensorInfo(k,"float32",D),N=l.makeTensorInfo(k,"float32",I),F=ki({inputs:{real:A,imag:N},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(A),l.disposeIntermediateTensorInfo(N),F}else{const c=l.data.get(o.dataId).values,h=l.data.get(u.dataId).values,f=s||o.dtype,[p,g]=t(o.shape,u.shape,c,h,f);return l.makeTensorInfo(g,f,p)}}}function dk(r){return(t,n,s,i,a,o)=>{const u=nn(t,n),l=Je(u),c=u.length,h=Mt(u),f=As("float32",l),p=As("float32",l),g=bd(t,u),y=bd(n,u),x=Eu(s,i),v=Eu(a,o),S=t.length,w=Mt(t),E=n.length,_=Mt(n);if(g.length+y.length===0)for(let D=0;D<f.length;D++){const I=D%x.length,k=D%v.length,A=r(x[I*2],x[I*2+1],v[k*2],v[k*2+1]);f[D]=A.real,p[D]=A.imag}else for(let D=0;D<f.length;D++){const I=zd(D,c,h),k=I.slice(-S);g.forEach(O=>k[O]=0);const A=Eo(k,S,w),N=I.slice(-E);y.forEach(O=>N[O]=0);const F=Eo(N,E,_),$=r(x[A*2],x[A*2+1],v[F*2],v[F*2+1]);f[D]=$.real,p[D]=$.imag}return[f,p,u]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LU=qr((r,t)=>r+t),d0e=dk((r,t,n,s)=>({real:r+n,imag:t+s})),_d=vs(Ud,LU,d0e),p0e={kernelName:Ud,backendName:"cpu",kernelFunc:_d};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(r,t,n,s,i){const a=Je(s),o=Us(i,n);for(let u=0;u<r.length;u++){const l=r[u];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(a>0?o[l]+=t[u]:o[l]+=1)}return o}function BU(r,t,n,s=!1){const i=r.shape[0],a=r.shape[1],o=hn([i,n],t.dtype);for(let u=0;u<i;u++)for(let l=0;l<a;l++){const c=r.get(u,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?o.set(1,u,c):t.size>0?o.set(o.get(u,c)+t.get(u,l),u,c):o.set(o.get(u,c)+1,u,c))}return o}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(r){return(t,n,s)=>{const i=As(n,t.length);for(let a=0;a<t.length;++a)i[a]=r(t[a],s);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hn(r,t,n){return({inputs:s,attrs:i,backend:a})=>{const{x:o}=s;if(Dt(o,r),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const u=a,l=u.data.get(o.dataId).values,c=Je(o.shape),h=n||o.dtype,f=ds(h,c);for(let p=0;p<c;++p)f[p]=t(l[p],i);return u.makeTensorInfo(o.shape,h,f)}}function Xd(r,t,n){return({inputs:s,attrs:i,backend:a})=>{const{x:o}=s;if(Dt(o,r),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const u=a,l=u.data.get(o.dataId).values,c=n||o.dtype,h=t(l,c,i);return u.makeTensorInfo(o.shape,c,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PU=Kl(r=>Math.ceil(r)),m0e=Xd(zg,PU),g0e={kernelName:zg,backendName:"cpu",kernelFunc:m0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(r,t,n,s){const i=ds(n,Je(t));if(s&&n!=="string"){let a=0;r.forEach(o=>{const u=Je(o.shape);i.set(o.vals,a),a+=u})}else{let a=0;r.forEach(o=>{const u=n==="string"?lh(o.vals):o.vals;let l=0;for(let c=0;c<o.shape[0];++c){const h=c*t[1]+a;for(let f=0;f<o.shape[1];++f)i[h+f]=u[l++]}a+=o.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zU=qr((r,t)=>r===t?1:0),UU=vs(Fv,zU,null,"bool"),y0e={kernelName:Fv,backendName:"cpu",kernelFunc:UU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GU=Kl(r=>Math.exp(r)),jU=Xd(Kg,GU,"float32"),x0e={kernelName:Kg,backendName:"cpu",kernelFunc:jU};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WU=Kl(r=>Math.expm1(r)),b0e=Xd(Xg,WU),v0e={kernelName:Xg,backendName:"cpu",kernelFunc:b0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU=Kl(r=>Math.floor(r)),w0e=Xd(Yg,HU),S0e={kernelName:Yg,backendName:"cpu",kernelFunc:w0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(r,t,n,s,i,a,o,u,l){const c=hn([s,a],n);for(let h=0;h<s;h++){const f=[];let p=0;for(let g=0;g<i;g++){const y=r[h*i+g];p+=y*o[g],f.push(y)}if(p<0||p>=l/a)throw new Error(`Invalid indices: ${f} does not index into ${u}`);for(let g=0;g<a;g++)c.values[h*a+g]=t.get(...t.indexToLoc(p*a+g))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(r,t,n){const s=hn(n,r.dtype);for(let i=0;i<s.size;++i){const o=s.indexToLoc(i).slice(),u=o[0],l=o[2],c=t.locToIndex([u,l]);o[2]=t.values[c];const h=r.locToIndex(o);0<=h&&h<r.values.length&&(s.values[i]=r.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XU=qr((r,t)=>r>t?1:0),C0e=vs(Lv,XU,null,"bool"),_0e={kernelName:Lv,backendName:"cpu",kernelFunc:C0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU=qr((r,t)=>r>=t?1:0),E0e=vs(Qg,YU,null,"bool"),D0e={kernelName:Qg,backendName:"cpu",kernelFunc:E0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZU=qr((r,t)=>r<t?1:0),T0e=vs(Pv,ZU,null,"bool"),N0e={kernelName:Pv,backendName:"cpu",kernelFunc:T0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU=qr((r,t)=>r<=t?1:0),k0e=vs(Vv,QU,null,"bool"),A0e={kernelName:Vv,backendName:"cpu",kernelFunc:k0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(r,t,n){const s=(t-r)/(n-1),i=Us(n,"float32");i[0]=r;for(let a=1;a<i.length;a++)i[a]=i[a-1]+s;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eG=Kl(r=>Math.log(r)),I0e=Xd(r0,eG),$0e={kernelName:r0,backendName:"cpu",kernelFunc:I0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(r,t,n,s){const i=As(s,Je(n));for(let a=0;a<i.length;++a){const o=a*t;let u=r[o];for(let l=0;l<t;++l){const c=r[o+l];(Number.isNaN(c)||c>u)&&(u=c)}i[a]=u}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nG=qr((r,t)=>Math.max(r,t)),F0e=vs(i0,nG),R0e={kernelName:i0,backendName:"cpu",kernelFunc:F0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rG=qr((r,t)=>Math.min(r,t)),O0e=vs(a0,rG),M0e={kernelName:a0,backendName:"cpu",kernelFunc:O0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mk=qr((r,t)=>r*t),L0e=dk((r,t,n,s)=>({real:r*n-t*s,imag:r*s+t*n})),G2=vs(u0,mk,L0e),B0e={kernelName:u0,backendName:"cpu",kernelFunc:G2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(r,t,n){const s=Ul(-1,n);return mk([],t,s,r,n)}function P0e(r){const{inputs:t,backend:n}=r,{x:s}=t;Dt(s,"neg");const i=n.data.get(s.dataId).values,[a,o]=sG(i,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,a)}const V0e={kernelName:Zv,backendName:"cpu",kernelFunc:P0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iG=qr((r,t)=>r!==t?1:0),z0e=vs(Qv,iG,null,"bool"),U0e={kernelName:Qv,backendName:"cpu",kernelFunc:z0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gk(r,t,n,s,i){const a=t.length,o=Je(t),u=Mt(t),l=Mt(i),c=As(n,Je(i));for(let h=0;h<o;++h){const f=zd(h,a,u),p=new Array(f.length);for(let y=0;y<p.length;y++)p[y]=f[s[y]];const g=Eo(p,a,l);c[g]=r[h]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(r){const{inputs:t,attrs:n,backend:s}=r,{x:i}=t,{perm:a}=n;Dt(i,"transpose");const o=i.shape.length,u=new Array(o);for(let f=0;f<u.length;f++)u[f]=i.shape[a[f]];const l=s.data.get(i.dataId).values,c=gk(l,i.shape,i.dtype,a,u);return{dataId:s.write(c,u,i.dtype),shape:u,dtype:i.dtype}}const G0e={kernelName:Qf,backendName:"cpu",kernelFunc:di};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(r,t,n,s){const[i,a]=bs(r,s),o=$i(t,"int32"),u=Us(Je(i),o),l=Je(a);for(let c=0;c<u.length;++c){const h=c*l;let f=1;for(let p=0;p<l;++p)f*=n[h+p];u[c]=f}return{outVals:u,outShape:i,outDtype:o}}function j0e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;Dt(i,"prod");const u=i.shape.length,l=dn(a,i.shape),c=Dr(l,u);let h=l,f=i;const p=[];c!=null&&(f=di({inputs:{x:i},backend:n,attrs:{perm:c}}),p.push(f),h=Mr(h.length,u));const g=n.data.get(f.dataId).values,{outVals:y,outShape:x,outDtype:v}=aG(f.shape,f.dtype,g,h);let S=x;return o&&(S=Hr(x,l)),p.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(S,v,y)}const W0e={kernelName:s2,backendName:"cpu",kernelFunc:j0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H0e(r,t,n){r.forEach((s,i)=>{if(s<0||s>=n){const a=zd(i,t.length,Mt(t)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${n})`)}})}function q0e(r,t){for(let n=0;n<r.length;++n){const s=r[n],i=n===r.length-1?t:r[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>i)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function K0e(r,t,n,s){const i=[];let a=0;const o=t.length-1+n.length,u=new Array(o).fill(null).map(()=>[0]);q0e(n,s);let l=1;for(let c=0;c<t.length-1;++c){l*=t[c];const h=t[c+1];for(let f=1;f<l+1;++f)u[c].push(f*h)}for(let c=0;c<r.length;++c){let h=r[c],f=r[c]+1;for(let p=0;p<n.length;++p){const g=n[p],y=p+t.length-1;if(y>=0){const x=u[y],v=x[x.length-1]-g[h];for(let S=h;S<f;++S)u[y].push(g[S+1]+v)}h=g[h],f=g[f]}f!==h&&(i.push([h,f]),a+=f-h)}return{outSplits:u,valueSlices:i,numValues:a}}function X0e(r){const t=[];for(let n=0;n<r.length;++n){const s=r[n].length,i=ds("int32",s);t.push(i),r[n].forEach((a,o)=>i[o]=a)}return t}function bM(r,t){const n=r.slice(0,t);for(;n.length<t;)n.push(1);for(let s=t;s<r.length;s++)n[t-1]*=r[s];return n}function Y0e(r,t,n,s,i,a){const o=bM(t,2)[1],u=bM(a,2)[1];let l=0;for(const c of n)for(let h=c[0];h<c[1];++h){for(let f=0;f<s;++f)i[l*u+f]=r[h*o+f];++l}}function Z0e(r,t,n,s,i){const a=t.slice();a[0]=i;const o=ds(n,Je(a)),u=r.length,l=u===0?0:u/t[0];return Y0e(r,t,s,l,o,a),[o,a]}function oG(r,t,n,s,i,a,o,u){if(r.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const l=t[0][0]-1;if(H0e(a,o,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:h,valueSlices:f,numValues:p}=K0e(a,o,r,c),g=X0e(h),y=Z0e(n,s,i,f,p);return[g,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ga=Ka;class mb{constructor(t,n,s,i,a,o,u,l,c,h){this.shape=t,this.shapeShape=n,this.values=s,this.valuesShape=i,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=u,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=tV(h),this.raggedRank=nV(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===ga.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===ga.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case ga.VALUE_ROWIDS:return mb.getMaxWidthValueRowID(n);case ga.ROW_SPLITS:return mb.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${ga[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let s=0;for(let i=0;i<n-1;++i){const a=t[i+1]-t[i];a>s&&(s=a)}return s}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let s=0,i=t[0],a=0;for(let o=1;o<n;++o){const u=t[o];u!==i&&(i=u,a=Math.max(o-s,a),s=o)}return Math.max(n-s,a)}tensorShapeFromTensor(t,n,s=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return wM(t,s)}calculateOutputSize(t){const n=this.valuesShape,s=this.defaultValueShape;rV(s,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=eV(this.raggedRank,i,n);o[0]<0&&(o[0]=t);for(let u=1;u<=this.raggedRank;++u)o[u]<0&&(o[u]=this.getMaxWidth(u));return o}calculateFirstParentOutputIndex(t,n,s){const i=Math.min(t,s),a=[];let o=0;for(let u=0;u<i;++u,o+=n)a.push(o);for(let u=i;u<t;++u)a.push(-1);return oe(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,n,s,i){const a=t.length,o=[];for(let u=0;u<a-1;++u){const l=t[u+1]-t[u];let c=Math.min(i,l),h=n[u];h===-1&&(c=0);for(let f=0;f<c;++f)o.push(h),h+=s;for(let f=0;f<l-c;++f)o.push(-1)}if(a>0&&o.length!==t[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(t,n,s,i){const a=t.length,o=[];if(a===0)return[];let u=0,l=t[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];o.push(c);for(let h=1;h<a;++h){const f=t[h];if(f===l)c>=0&&(++u,u<i?c+=s:c=-1);else{if(u=0,l=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);c=n[f]}o.push(c)}if(o.length!==t.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(t,n,s,i){const a=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case ga.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,s,i);case ga.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,s,i);default:throw new Error(`Unsupported partition type: ${ga[o]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case ga.FIRST_DIM_SIZE:return t[0];case ga.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ga.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ga[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*s[l+1];const a=wM(s,!1),o=ds(this.valuesDType,Je(a));if(i[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,i[c],s[c]);this.setOutput(this.raggedRank,l,o,a)}return[a,o]}setOutput(t,n,s,i){if(s.length===0)return;const a=this.values,o=s;let u=i.slice();u=u.slice(t+1);const l=Je(u),c=n.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const y=this.defaultValueShape;Ue(()=>{const x=ke(h,y);h=Lm(x,u).dataSync()})}let f=0,p=0,g=0;for(let y=0;y<=c;++y){let x=y<c?n[y]:-1;if(x===g){++g;continue}if(p<g){const v=a.subarray(f*l),S=o.subarray(p*l),w=(g-p)*l;vM(S,v,w)}if(y>=c){const v=s.length;x=Math.floor(v/l)}if(x>g)if(this.defaultValue.length===1)o.subarray(g*l,x*l).fill(this.defaultValue[0]),g=x;else for(;x>g;){const v=o.slice(g*l);vM(v,h,l),++g}x<0?(f=y+1,p=g):(f=y,p=g,g=p+1)}}}function vM(r,t,n){for(let s=0;s<n;s++)r[s]=t[s]}function wM(r,t){const n=[];for(let s of r){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function uG(r,t,n,s,i,a,o,u,l,c){return new mb(r,t,n,s,i,a,o,u,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(r,t,n,s){const i=r===t,a=r<t&&n<0,o=t<r&&n>1;if(i||a||o)return Us(0,s);const u=Math.abs(Math.ceil((t-r)/n)),l=Us(u,s);t<r&&n===1&&(n=-1),l[0]=r;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cG=Kl(r=>1/Math.sqrt(r)),Q0e=Xd(p0,cG),J0e={kernelName:p0,backendName:"cpu",kernelFunc:Q0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vf(r,t,n,s,i,a,o,u,l,c){const h=[s/i,i],f=r.values,p=t.values;if(s===0)return hn(n,t.dtype);const g=hn(h,t.dtype);typeof l=="string"||typeof l=="number"?g.values.fill(l):typeof l=="boolean"&&g.values.fill(+l);for(let y=0;y<a;y++){const x=[];let v=0;for(let S=0;S<o;S++){const w=f[y*o+S];x.push(w),v+=w*u[S]}if(v<0||v>=s/i)throw new Error(`Invalid indices: ${x} does not index into ${n}`);for(let S=0;S<i;S++)c?g.values[v*i+S]+=p[y*i+S]:g.values[v*i+S]=t.rank===0?p[0]:p[y*i+S]}return g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e1e=Kl(r=>1/(1+Math.exp(-r))),hG=Hn(b0,r=>1/(1+Math.exp(-r))),t1e={kernelName:b0,backendName:"cpu",kernelFunc:hG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(r,t,n,s,i){const a=B3(s,t,n),o=Je(n),u=Mt(s);if(a){const f=P3(t,u);return i==="string"?r.slice(f,f+o):r.subarray(f,f+o)}const l=i==="string"?lh(r):r,c=hn(s,i,l),h=hn(n,i);for(let f=0;f<h.size;++f){const p=h.indexToLoc(f),g=p.map((y,x)=>y+t[x]);h.set(c.get(...g),...p)}return i==="string"?CV(h.values):h.values}function fh(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{begin:a,size:o}=s;Dt(i,"slice");const[u,l]=w2(i,a,o);M3(i,u,l);const c=n.data.get(i.dataId).values,h=fG(c,u,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,h)}const n1e={kernelName:c2,backendName:"cpu",kernelFunc:fh};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(r,t,n,s,i,a,o){const u=t[0],l=a[0],c=new Array(l),h=new Array(u),f=t[1];if(l===0){if(u!==0)throw new Error(cV(u));const v=ds(n,0),S=ds(i,0);return[v,[0,f],S,c,h]}let p=!0,g=0;const y=new Array(l).fill(0);for(let v=0;v<u;++v){const S=r[v*f];if(S<0)throw new Error(hV(v,S));if(S>=l)throw new Error(fV(v,S,l));++y[S],p=p&&S>=g,g=S}let x=!0;for(let v=0;v<l;++v){const S=y[v]===0;c[v]=S,x=x&&!S,y[v]=Math.max(y[v],1),v>0&&(y[v]+=y[v-1])}if(x&&p){const v=r,S=s;for(let w=0;w<u;++w)h[w]=w;return[v,[u,f],S,c,h]}else{const v=y[l-1],S=ds(n,v*f),w=ds(i,v),E=new Array(l).fill(0);for(let _=0;_<u;++_){const D=r[_*f],I=E[D],k=(D===0?0:y[D-1])+I;E[D]++;for(let A=0;A<f;++A)S[k*f+A]=r[_*f+A];w[k]=s[_],h[_]=k}for(let _=0;_<l;++_)if(E[_]===0){const I=_===0?0:y[_-1];S[I*f+0]=_;for(let k=1;k<f;++k)S[I*f+k]=0;w[I]=o}return[S,[v,f],w,c,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(r,t,n,s,i){const a=Je(s),o=t[0],u=i.length,l=[];let c=1,h=-1;for(let v=0;v<u;++v){const S=i[v];if(S===-1){if(h!==-1)throw new Error(dV(h,v));h=v,l.push(1)}else{if(S<0)throw new Error(pV(v,S));c*=S,l.push(S)}}if(h!==-1){if(c<=0)throw new Error(mV());const v=Math.trunc(a/c);if(c*v!==a)throw new Error(gV(s,l));l[h]=v}if(Je(l)!==a)throw new Error(yV(s,l));const p=s.length,g=[];if(p>0){g[p-1]=1;for(let v=p-2;v>=0;--v)g[v]=g[v+1]*s[v+1]}const y=[];if(u>0){y[u-1]=1;for(let v=u-2;v>=0;--v)y[v]=y[v+1]*l[v+1]}const x=ds(n,o*u);for(let v=0;v<o;++v){let S=0;for(let w=0;w<p;++w)S+=r[v*p+w]*g[w];for(let w=0;w<u;++w)x[v*u+w]=Math.trunc(S/y[w]),S%=y[w]}return[x,[o,u],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yk(r,t,n,s,i,a=!1,o=0){const u=s.length,l=[t[0],r.length/t[0]],c=l[1],f=u>0?i[u-1]+1:0;if(f<0)throw new Error(KE());const p=t.slice();p[0]=f;const g=p.reduce((E,_)=>E*_,1),y=ds(n,g);if(u===0)return f>0&&y.fill(o),[y,p];if(f<=0)throw new Error(KE());let x=0,v=1,S=0,w=i[x];for(;;){let E=0;if(v<u){if(E=i[v],w===E){++v;continue}if(w>=E)throw new Error(xV())}if(w<0||w>=f)throw new Error(bV(w,f));w>S&&y.fill(o,S*c,w*c);for(let _=x;_<v;++_){const D=s[_];if(D<0||D>=l[0])throw new Error(vV(_,s[_],l[0]));for(let I=0;I<c;I++)y[w*c+I]+=r[D*c+I]}if(a)for(let _=0;_<c;_++)y[w*c+_]/=v-x;if(x=v,++v,S=w+1,w=E,v>u)break}return S<f&&y.fill(o,S*c,f*c),[y,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=Kl(r=>Math.sqrt(r)),s1e=Hn(w0,r=>Math.sqrt(r)),i1e={kernelName:w0,backendName:"cpu",kernelFunc:s1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG=qr((r,t)=>{const n=r-t;return n*n}),a1e=vs(S0,mG),o1e={kernelName:S0,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(r,t,n,s){const i=hn(r,t.dtype);for(let a=0;a<i.size;a++){const o=i.indexToLoc(a),u=new Array(o.length);for(let l=0;l<u.length;l++)u[l]=o[l]*n[l]+s[l];i.set(t.get(...u),...o)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u1e{constructor(t,n,s,i,a,o){this.separator=El(t),this.nGramWidths=n,this.leftPad=El(s),this.rightPad=El(i),this.padWidth=a,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const s=this.getPadWidth(n);return Math.max(0,t+2*s-n+1)}createNGrams(t,n,s,i,a,o){for(let u=0;u<a;++u){const l=this.getPadWidth(o),c=Math.max(0,l-u),h=Math.max(0,l-(a-(u+1))),f=o-(c+h),p=n+(c>0?0:u-l);let g=0;g+=c*this.leftPad.length;for(let w=0;w<f;++w)g+=t[p+w].length;g+=h*this.rightPad.length;const y=c+h+f-1;g+=y*this.separator.length,s[i+u]=new Uint8Array(g);const x=s[i+u];let v=0;const S=w=>w.forEach(E=>x[v++]=E);for(let w=0;w<c;++w)S(this.leftPad),S(this.separator);for(let w=0;w<f-1;++w)S(t[p+w]),S(this.separator);if(f>0){S(t[p+f-1]);for(let w=0;w<h;++w)S(this.separator),S(this.rightPad)}else{for(let w=0;w<h-1;++w)S(this.rightPad),S(this.separator);S(this.rightPad)}}}compute(t,n){const s=t.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<i;++c){let h=n[c]>=l;if(h=h&&n[c]<=s,!h)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const a=i-1,o=ds("int32",i);if(s===0||i===0){const l=new Array(s);for(let c=0;c<=a;++c)o[c]=0;return[l,o]}o[0]=0;for(let l=1;l<=a;++l){const c=n[l]-n[l-1];let h=0;this.nGramWidths.forEach(f=>{h+=this.getNumNGrams(c,f)}),this.preserveShort&&c>0&&h===0&&(h=1),o[l]=o[l-1]+h}const u=new Array(o[a]);for(let l=0;l<a;++l){const c=n[l];let h=o[l];if(this.nGramWidths.forEach(f=>{const p=n[l+1]-n[l],g=this.getNumNGrams(p,f);this.createNGrams(t,c,u,h,g,f),h+=g}),this.preserveShort&&h===o[l]){const f=n[l+1]-n[l];if(f===0)continue;const p=f+2*this.padWidth;this.createNGrams(t,c,u,h,1,p)}}return[u,o]}}function yG(r,t,n,s,i,a,o,u){return new u1e(n,s,i,a,o,u).compute(r,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l1e(r,t,n,s){if(!r.length)return;if(t.length===0){for(let a=0;a<r.length;++a)s.push(r.subarray(a,a+1));return}if(t.length===1){const a=t[0];let o=r.indexOf(a);for(;o!==-1;){const u=r.subarray(0,o);(!n||u.length!==0)&&s.push(u),r=r.subarray(o+1),o=r.indexOf(a)}(!n||r.length!==0)&&s.push(r);return}let i=0;for(let a=0;a<r.length+1;a++)if(a===r.length||t.indexOf(r[a])!==-1){const o=r.subarray(i,a);(!n||o.length!==0)&&s.push(o),i=a+1}}function xG(r,t,n){const s=r.length,i=[];let a=0,o=0;const u=new Array(s);for(let p=0;p<s;++p){const g=i.length;l1e(r[p],t,n,i);const y=i.length-g;u[p]=y,a+=y,o=Math.max(o,y)}const l=ds("int32",a*2),c=new Array(a),h=[s,o];let f=0;for(let p=0;p<s;++p)for(let g=0;g<u[p];++g)l[f*2]=p,l[f*2+1]=g,c[f]=i[f],++f;return[l,c,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(r,t){const n=ds("int32",r.length);for(let s=0;s<r.length;++s)n[s]=loe(r[s]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG=qr((r,t)=>r-t),c1e=dk((r,t,n,s)=>({real:r-n,imag:t-s})),xk=vs(C0,vG,c1e),h1e={kernelName:C0,backendName:"cpu",kernelFunc:xk};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(r,t){const n=new Array(r.rank);for(let i=0;i<n.length;i++)n[i]=r.shape[i]*t[i];const s=hn(n,r.dtype);for(let i=0;i<s.values.length;++i){const a=s.indexToLoc(i),o=new Array(r.rank);for(let l=0;l<o.length;l++)o[l]=a[l]%r.shape[l];const u=r.locToIndex(o);s.values[i]=r.values[u]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cm=(r,t)=>{const n=t.value-r.value;return n===0?r.index-t.index:n};function SG(r,t,n=0,s=r.length-1){for(;s>n;){if(s-n>600){const u=s-n+1,l=t-n+1,c=Math.log(u),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(u-h)/u)*Math.sign(l-u/2),p=Math.max(n,Math.floor(t-l*h/u+f)),g=Math.min(s,Math.floor(t+(u-l)*h/u+f));SG(r,t,p,g)}const i=r[t];let a=n,o=s;for(If(r,n,t),Cm(r[s],i)>0&&If(r,n,s);a<o;){for(If(r,a,o),a++,o--;Cm(r[a],i)<0;)a=a+1;for(;Cm(r[o],i)>0;)o=o-1}Cm(r[n],i)===0?If(r,n,o):(o=o+1,If(r,o,s)),o<=t&&(n=o+1),t<=o&&(s=o-1)}}function CG(r,t,n,s,i){const a=t[t.length-1],[o,u]=[r.length/a,a],l=As(n,o*s),c=As("int32",o*s);for(let f=0;f<o;f++){const p=f*u,g=r.subarray(p,p+u);let y=new Array(g.length);g.forEach((w,E)=>y[E]={value:w,index:E}),s<y.length&&(SG(y,s),y=y.slice(0,s)),i&&y.sort(Cm);const x=f*s,v=l.subarray(x,x+s),S=c.subarray(x,x+s);for(let w=0;w<s;w++)v[w]=y[w].value,S[w]=y[w].index}const h=t.slice();return h[h.length-1]=s,[hn(h,n,l),hn(h,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(r,t,n,s){const i=dn(t,n)[0],a=[1,n[0],1];for(let y=0;y<i;y++)a[0]*=n[y];a[1]=n[i];for(let y=i+1;y<n.length;y++)a[2]*=n[y];const o={},u=new Int32Array(n[i]),l=new zs(a,s,r),c=[],h=a[0]===1&&a[2]===1;for(let y=0;y<n[i];y++){let x;if(h)x=r[y].toString();else{const v=[];for(let S=0;S<a[0];S++)for(let w=0;w<a[2];w++)v.push(l.get(S,y,w));x=v.join(",")}if(o[x]!==void 0)u[y]=o[x];else{const v=Object.keys(o).length;o[x]=v,u[y]=v,c.push(y)}}const f=a.slice();f[1]=Object.keys(o).length;const p=new zs(f,s);c.forEach((y,x)=>{for(let v=0;v<a[0];v++)for(let S=0;S<a[2];S++)p.set(l.get(v,y,S),v,x,S)});const g=n.slice();return g[i]=f[1],{outputValues:p.values,outputShape:g,indices:u}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1e=Object.freeze(Object.defineProperty({__proto__:null,addImpl:LU,bincountImpl:pk,bincountReduceImpl:BU,castImpl:MU,ceilImpl:PU,concatImpl:VU,equalImpl:zU,expImpl:GU,expm1Impl:WU,floorImpl:HU,gatherNdImpl:qU,gatherV2Impl:KU,greaterEqualImpl:YU,greaterImpl:XU,lessEqualImpl:QU,lessImpl:ZU,linSpaceImpl:JU,logImpl:eG,maxImpl:tG,maximumImpl:nG,minimumImpl:rG,multiplyImpl:mk,negImpl:sG,notEqualImpl:iG,prodImpl:aG,raggedGatherImpl:oG,raggedTensorToTensorImpl:uG,rangeImpl:lG,rsqrtImpl:cG,scatterImpl:Vf,sigmoidImpl:e1e,simpleAbsImpl:OU,sliceImpl:fG,sparseFillEmptyRowsImpl:dG,sparseReshapeImpl:pG,sparseSegmentReductionImpl:yk,sqrtImpl:r1e,squaredDifferenceImpl:mG,stridedSliceImpl:gG,stringNGramsImpl:yG,stringSplitImpl:xG,stringToHashBucketFastImpl:bG,subImpl:vG,tileImpl:wG,topKImpl:CG,transposeImpl:gk,uniqueImpl:_G},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */d7("cpu",()=>new U2,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=Hn(Hg,r=>r>=0?r:Math.exp(r)-1),d1e={kernelName:Hg,backendName:"cpu",kernelFunc:EG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{alpha:a}=s;Dt([i],"leakyRelu");const o=Je(i.shape),u=n.data.get(i.dataId).values,l=As("float32",o);for(let c=0;c<u.length;c++)l[c]=u[c]<0?a*u[c]:u[c];return n.makeTensorInfo(i.shape,"float32",l)}const p1e={kernelName:Bv,backendName:"cpu",kernelFunc:DG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1e=qr((r,t)=>r<0?t*r:r);function TG(r){const{inputs:t,backend:n}=r,{x:s,alpha:i}=t;Dt([s,i],"prelu");const a=n.data.get(s.dataId).values,o=n.data.get(i.dataId).values,[u,l]=m1e(s.shape,i.shape,a,o,"float32");return n.makeTensorInfo(l,"float32",u)}const g1e={kernelName:r2,backendName:"cpu",kernelFunc:TG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NG=Hn(h0,r=>Math.max(0,r)),y1e={kernelName:h0,backendName:"cpu",kernelFunc:NG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kG=Hn(f0,r=>Math.min(Math.max(0,r),6)),x1e={kernelName:f0,backendName:"cpu",kernelFunc:kG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gb(r,t,n,s,i){if(n==="linear")return Ro({inputs:{x:t},backend:r});if(n==="relu")return NG({inputs:{x:t},backend:r});if(n==="elu")return EG({inputs:{x:t},backend:r});if(n==="relu6")return kG({inputs:{x:t},backend:r});if(n==="prelu")return TG({inputs:{x:t,alpha:s},backend:r});if(n==="leakyrelu")return DG({inputs:{x:t},backend:r,attrs:{alpha:i}});if(n==="sigmoid")return hG({inputs:{x:t},backend:r});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{shape:a}=s,o=Je(i.shape),u=gP(a,o),l=Je(u);oe(o===l,()=>`The new shape (${u}) has ${l} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const c=n.data.get(i.dataId);if(c.complexTensorInfos!=null){const h=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;h.shape=u,f.shape=u}return{dataId:i.dataId,shape:u,dtype:i.dtype}}const b1e={kernelName:i2,backendName:"cpu",kernelFunc:lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(r){const{inputs:t,backend:n,attrs:s}=r,{a:i,b:a}=t,{transposeA:o,transposeB:u}=s;Dt([i,a],"matMul");const l=i.shape.length,c=a.shape.length,h=o?i.shape[l-2]:i.shape[l-1],f=u?a.shape[c-1]:a.shape[c-2],p=o?i.shape[l-1]:i.shape[l-2],g=u?a.shape[c-2]:a.shape[c-1],y=i.shape.slice(0,-2),x=a.shape.slice(0,-2),v=Je(y),S=Je(x),E=nn(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,g]);oe(h===f,()=>`Error in matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${o} and transposeB=${u} must match.`);const _=o?[v,h,p]:[v,p,h],D=u?[S,g,f]:[S,f,g],I=lr({inputs:{x:i},backend:n,attrs:{shape:_}}),k=lr({inputs:{x:a},backend:n,attrs:{shape:D}}),A=o?I.shape[1]:I.shape[2],N=o?I.shape[2]:I.shape[1],F=u?k.shape[1]:k.shape[2],$=Math.max(v,S),O=n.data.get(I.dataId).values,M=n.data.get(k.dataId).values,B=Mt(I.shape),U=Mt(k.shape),[V,Z,J]=o?[B[0],1,B[1]]:[B[0],B[1],1],[ne,z,X]=u?[1,U[1],U[0]]:[U[1],1,U[0]],Y=N*F,se=hn([$,N,F],I.dtype),ue=se.values,fe=n.blockSize;for(let de=0;de<$;de++)for(let be=0;be<N;be+=fe)for(let Me=0;Me<F;Me+=fe)for(let _e=0;_e<A;_e+=fe){const Ne=Math.min(be+fe,N),ve=Math.min(Me+fe,F),Pe=Math.min(_e+fe,A);for(let et=be;et<Ne;et++)for(let Ve=Me;Ve<ve;Ve++){let re=0;for(let Q=_e;Q<Pe;Q++){const ce=Math.min(de,v-1)*V,xe=Math.min(de,S-1)*X,Ge=O[ce+et*Z+Q*J],Oe=M[Q*ne+Ve*z+xe];re+=Ge*Oe}ue[de*Y+(et*F+Ve)]+=re}}return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(k),n.makeTensorInfo(E,se.dtype,se.values)}const v1e={kernelName:Cv,backendName:"cpu",kernelFunc:AG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w1e(r){const{inputs:t,backend:n,attrs:s}=r,{a:i,b:a,bias:o,preluActivationWeights:u}=t,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:f}=s;let p,g,y;const x=[];p=AG({inputs:{a:i,b:a},attrs:{transposeA:l,transposeB:c},backend:n}),o&&(g=_d({inputs:{a:p,b:o},backend:n}),x.push(p),p=g),h&&(y=gb(n,p,h,u,f),x.push(p),p=y);for(const S of x)n.disposeIntermediateTensorInfo(S);return p}const S1e={kernelName:Yx,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1e=Hn(Fg,r=>Math.acos(r)),_1e={kernelName:Fg,backendName:"cpu",kernelFunc:C1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1e=Hn(Rg,r=>Math.acosh(r)),D1e={kernelName:Rg,backendName:"cpu",kernelFunc:E1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T1e(r){const{inputs:t,backend:n}=r,s=t;Dt(t,"addN");const i=s.map(u=>n.data.get(u.dataId).values),a=hn(s[0].shape,s[0].dtype),o=a.values;for(let u=0;u<s.length;u++){const l=i[u];for(let c=0;c<o.length;c++)o[c]+=l[c]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const N1e={kernelName:KT,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;Dt(i,"all");const u=dn(a,i.shape);let l=u;const c=Dr(l,i.shape.length);let h=i;c!=null&&(h=di({inputs:{x:i},backend:n,attrs:{perm:c}}),l=Mr(l.length,i.shape.length)),$s("all",l,h.shape.length);const[f,p]=bs(h.shape,l),g=Je(p),y=Us(Je(f),h.dtype),x=n.data.get(h.dataId).values;for(let S=0;S<y.length;++S){const w=S*g;let E=x[w];for(let _=0;_<g;++_){const D=x[w+_];E=E&&D}y[S]=E}c!=null&&n.disposeIntermediateTensorInfo(h);const v=n.makeTensorInfo(f,h.dtype,y);if(o){const S=Hr(f,u),w=lr({inputs:{x:v},backend:n,attrs:{shape:S}});return n.disposeIntermediateTensorInfo(v),w}return v}const A1e={kernelName:XT,backendName:"cpu",kernelFunc:k1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;Dt(i,"any");const u=dn(a,i.shape);let l=u;const c=Dr(l,i.shape.length);let h=i;c!=null&&(h=di({inputs:{x:i},backend:n,attrs:{perm:c}}),l=Mr(l.length,i.shape.length)),$s("any",l,h.shape.length);const[f,p]=bs(h.shape,l),g=Je(p),y=Us(Je(f),h.dtype),x=n.data.get(h.dataId).values;for(let S=0;S<y.length;++S){const w=S*g;let E=x[w];for(let _=0;_<g;++_){const D=x[w+_];E=E||D}y[S]=E}c!=null&&n.disposeIntermediateTensorInfo(h);const v=n.makeTensorInfo(f,h.dtype,y);if(o){const S=Hr(f,u),w=lr({inputs:{x:v},backend:n,attrs:{shape:S}});return n.disposeIntermediateTensorInfo(v),w}return v}const $1e={kernelName:YT,backendName:"cpu",kernelFunc:I1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a}=s;Dt(i,"argMax");let o=dn(a,i.shape);const u=Dr(o,i.shape.length);let l=i;const c=[];u!=null&&(l=di({inputs:{x:i},backend:n,attrs:{perm:u}}),c.push(l),o=Mr(o.length,l.shape.length)),o=[o[0]],$s("argMax",o,l.shape.length);const[h,f]=bs(l.shape,o),p=Je(h),g=Us(p,"int32"),y=Je(f),x=n.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const S=v*y;let w=x[S],E=0;for(let _=0;_<y;++_){const D=x[S+_];D>w&&(w=D,E=_)}g[v]=E}return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(h,"int32",g)}const R1e={kernelName:bv,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a}=s;Dt(i,"argMin");let o=dn(a,i.shape);const u=Dr(o,i.shape.length);let l=i;const c=[];u!=null&&(l=di({inputs:{x:i},backend:n,attrs:{perm:u}}),c.push(l),o=Mr(o.length,l.shape.length)),o=[o[0]],$s("argMin",o,l.shape.length);const[h,f]=bs(l.shape,o),p=Je(h),g=Us(p,"int32"),y=Je(f),x=n.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const S=v*y;let w=x[S],E=0;for(let _=0;_<y;++_){const D=x[S+_];D<w&&(w=D,E=_)}g[v]=E}return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(h,"int32",g)}const M1e={kernelName:vv,backendName:"cpu",kernelFunc:O1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1e=Hn(Og,r=>Math.asin(r)),B1e={kernelName:Og,backendName:"cpu",kernelFunc:L1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P1e=Hn(Mg,r=>Math.asinh(r)),V1e={kernelName:Mg,backendName:"cpu",kernelFunc:P1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1e=Hn(Lg,r=>Math.atan(r)),U1e={kernelName:Lg,backendName:"cpu",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1e=qr((r,t)=>Math.atan2(r,t)),j1e=vs(Pg,G1e),W1e={kernelName:Pg,backendName:"cpu",kernelFunc:j1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H1e=Hn(Bg,r=>Math.atanh(r)),q1e={kernelName:Bg,backendName:"cpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bk(r,t,n,s,i,a){const o=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,h=i.effectiveFilterHeight,f=i.effectiveFilterWidth,p=i.padInfo.top,g=i.padInfo.left,y=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=hn(i.outShape,n),v=x.values,S=i.outShape[1]*i.outShape[2]*i.outShape[3],w=i.outShape[2]*i.outShape[3],E=i.outShape[3];for(let _=0;_<i.batchSize;++_){const D=_*S,I=_*s[0];for(let k=0;k<i.inChannels;++k)for(let A=0;A<i.outHeight;++A){const N=A*o-p,F=Math.max(0,N),$=Math.min(i.inHeight,h+N),O=D+A*w;for(let M=0;M<i.outWidth;++M){const B=M*u-g,U=Math.max(0,B),V=Math.min(i.inWidth,f+B);let Z=y,J=0,ne=0;for(let X=F;X<$;X+=l){const Y=I+X*s[1];for(let se=U;se<V;se+=c){const ue=Y+se*s[2],fe=r[ue+k];a==="max"&&fe>Z?Z=fe:a==="avg"&&(J+=fe,ne++)}if(isNaN(Z))break}const z=O+M*E+k;v[z]=a==="avg"?J/ne:Z}}}return x}function IG(r,t,n,s,i=!1,a=!1){const o=hn(s.outShape,"int32"),u=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,h=s.dilationWidth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,g=s.padInfo.top,y=s.padInfo.left,x=hn(t,n,r);for(let v=0;v<s.batchSize;++v)for(let S=0;S<s.inChannels;++S)for(let w=0;w<s.outHeight;++w){const E=w*u-g;let _=E;for(;_<0;)_+=c;const D=Math.min(s.inHeight,f+E);for(let I=0;I<s.outWidth;++I){const k=I*l-y;let A=k;for(;A<0;)A+=h;const N=Math.min(s.inWidth,p+k);let F=Number.NEGATIVE_INFINITY,$=-1;for(let O=_;O<D;O+=c){const M=O-E;for(let B=A;B<N;B+=h){const U=B-k,V=x.get(v,O,B,S);V>F&&(F=V,i?$=a?((v*s.inHeight+O)*s.inWidth+B)*s.inChannels+S:(O*s.inWidth+B)*s.inChannels+S:$=M*p+U)}}o.set($,v,w,I,S)}}return o}function $G(r,t,n,s,i,a){const o=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,h=i.dilationHeight,f=i.dilationWidth,p=i.effectiveFilterDepth,g=i.effectiveFilterHeight,y=i.effectiveFilterWidth,x=i.padInfo.front,v=i.padInfo.top,S=i.padInfo.left,w=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=hn(i.outShape,n),_=E.values,D=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],I=i.outShape[2]*i.outShape[3]*i.outShape[4],k=i.outShape[3]*i.outShape[4],A=i.outShape[4];for(let N=0;N<i.batchSize;++N){const F=N*D,$=N*s[0];for(let O=0;O<i.inChannels;++O)for(let M=0;M<i.outDepth;++M){const B=M*o-x;let U=B;for(;U<0;)U+=c;const V=Math.min(i.inDepth,p+B),Z=F+M*I;for(let J=0;J<i.outHeight;++J){const ne=J*u-v;let z=ne;for(;z<0;)z+=h;const X=Math.min(i.inHeight,g+ne),Y=Z+J*k;for(let se=0;se<i.outWidth;++se){const ue=se*l-S;let fe=ue;for(;fe<0;)fe+=f;const de=Math.min(i.inWidth,y+ue),be=Y+se*A;let Me=w,_e=0,Ne=0;for(let Pe=U;Pe<V;Pe+=c){const et=$+Pe*s[1];for(let Ve=z;Ve<X;Ve+=h){const re=et+Ve*s[2];for(let Q=fe;Q<de;Q+=f){const ce=re+Q*s[3],xe=r[ce+O];if(a==="max"&&xe>Me?Me=xe:a==="avg"&&(_e+=xe,Ne++),isNaN(Me))break}if(isNaN(Me))break}if(isNaN(Me))break}const ve=be+O;_[ve]=a==="avg"?_e/Ne:Me}}}}return E}function K1e(r,t){const n=hn(t.outShape,"int32"),s=t.strideDepth,i=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;for(let x=0;x<t.batchSize;++x)for(let v=0;v<t.inChannels;++v)for(let S=0;S<t.outDepth;++S){const w=S*s-p;let E=w;for(;E<0;)E+=o;const _=Math.min(t.inDepth,c+w);for(let D=0;D<t.outHeight;++D){const I=D*i-g;let k=I;for(;k<0;)k+=u;const A=Math.min(t.inHeight,h+I);for(let N=0;N<t.outWidth;++N){const F=N*a-y;let $=F;for(;$<0;)$+=l;const O=Math.min(t.inWidth,f+F);let M=Number.NEGATIVE_INFINITY,B=-1;for(let U=E;U<_;U+=o){const V=U-w;for(let Z=k;Z<A;Z+=u){const J=Z-I;for(let ne=$;ne<O;ne+=l){const z=ne-F,X=r.get(x,U,Z,ne,v);X>=M&&(M=X,B=V*h*f+J*h+z)}}}n.set(B,x,S,D,N,v)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t;Dt(i,"avgPool");const{filterSize:a,strides:o,pad:u,dimRoundingMode:l}=s,c=1;oe(Gs(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=Ra(i.shape,a,o,c,u,l);let f;if(h.filterWidth===1&&h.filterHeight===1&&Bn(h.inShape,h.outShape))f=Ro({inputs:{x:i},backend:n});else{const p=n.data.get(i.dataId).values,g=Mt(i.shape),y=bk(p,i.shape,i.dtype,g,h,"avg");f=n.makeTensorInfo(h.outShape,i.dtype,y.values)}return f}const Y1e={kernelName:wv,backendName:"cpu",kernelFunc:X1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{filterSize:a,strides:o,pad:u,dimRoundingMode:l,dataFormat:c}=s;Dt(i,"avgPool3d");const h=Iu(i.shape,a,o,1,u,l,c),f=n.data.get(i.dataId).values,p=$G(f,i.shape,i.dtype,Mt(i.shape),h,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const Q1e={kernelName:Sv,backendName:"cpu",kernelFunc:Z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,{filterSize:o,strides:u,pad:l,dimRoundingMode:c}=s;Dt([i,a],"avgPool3DGrad");const h=Iu(a.shape,o,u,1,l,c),f=h.strideDepth,p=h.strideHeight,g=h.strideWidth,y=h.filterDepth,x=h.filterHeight,v=h.filterWidth,S=h.dilationDepth,w=h.dilationHeight,E=h.dilationWidth,_=h.effectiveFilterDepth,D=h.effectiveFilterHeight,I=h.effectiveFilterWidth,k=_-1-h.padInfo.front,A=I-1-h.padInfo.left,N=D-1-h.padInfo.top,F=hn(a.shape,"float32"),$=1/(y*x*v),O=n.bufferSync(i);for(let M=0;M<h.batchSize;++M)for(let B=0;B<h.inChannels;++B)for(let U=0;U<h.inDepth;++U)for(let V=0;V<h.inHeight;++V)for(let Z=0;Z<h.inWidth;++Z){const J=U-k,ne=V-N,z=Z-A;let X=0;for(let Y=0;Y<_;Y+=S){const se=(J+Y)/f;if(!(se<0||se>=h.outDepth||Math.floor(se)!==se))for(let ue=0;ue<D;ue+=w){const fe=(ne+ue)/p;if(!(fe<0||fe>=h.outHeight||Math.floor(fe)!==fe))for(let de=0;de<I;de+=E){const be=(z+de)/g;if(be<0||be>=h.outWidth||Math.floor(be)!==be)continue;const Me=O.get(M,se,fe,be,B);X+=Me}}}F.set(X*$,M,U,V,Z,B)}return n.makeTensorInfo(F.shape,F.dtype,F.values)}const eye={kernelName:QT,backendName:"cpu",kernelFunc:J1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tye(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,o=a;Dt([i,a],"avgPoolGrad");const{filterSize:u,strides:l,pad:c}=s,h=Ra(o.shape,u,l,1,c),f=h.strideHeight,p=h.strideWidth,g=h.filterHeight,y=h.filterWidth,x=h.dilationHeight,v=h.dilationWidth,S=h.effectiveFilterHeight,w=h.effectiveFilterWidth,E=w-1-h.padInfo.left,_=S-1-h.padInfo.top,D=hn(o.shape,"float32"),I=1/(g*y),k=n.data.get(i.dataId).values,A=hn(i.shape,"float32",k);for(let N=0;N<h.batchSize;++N)for(let F=0;F<h.inChannels;++F)for(let $=0;$<h.inHeight;++$)for(let O=0;O<h.inWidth;++O){const M=$-_,B=O-E;let U=0;for(let V=0;V<S;V+=x){const Z=(M+V)/f;if(!(Z<0||Z>=h.outHeight||Math.floor(Z)!==Z))for(let J=0;J<w;J+=v){const ne=(B+J)/p;if(ne<0||ne>=h.outWidth||Math.floor(ne)!==ne)continue;const z=A.get(N,Z,ne,F);U+=z}}D.set(U*I,N,$,O,F)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const nye={kernelName:ZT,backendName:"cpu",kernelFunc:tye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,scale:a,offset:o,mean:u,variance:l}=t;oe(u.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),oe(o==null||u.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),oe(a==null||u.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Dt([i,u,l,a,o],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const h=n.data.get(i.dataId).values,f=n.data.get(u.dataId).values,p=n.data.get(l.dataId).values,g=a?n.data.get(a.dataId).values:new Float32Array([1]),y=o?n.data.get(o.dataId).values:new Float32Array([0]),x=new Float32Array(h.length),v=y.length,S=g.length,w=p.length,E=f.length;let _=0,D=0,I=0,k=0;for(let A=0;A<h.length;++A)x[A]=y[_++]+(h[A]-f[D++])*g[I++]/Math.sqrt(p[k++]+c),_>=v&&(_=0),D>=E&&(D=0),I>=S&&(I=0),k>=w&&(k=0);return n.makeTensorInfo(i.shape,i.dtype,x)}const sye={kernelName:Ov,backendName:"cpu",kernelFunc:rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockShape:a,crops:o}=s;Dt([i],"batchToSpaceND");const u=a.reduce((S,w)=>S*w),l=R0(i.shape,a,u),c=O0(l.length,a.length),h=M0(i.shape,a,u),f=DN(o,a.length),p=TN(h,o,a.length),g=lr({inputs:{x:i},backend:n,attrs:{shape:l}}),y=di({inputs:{x:g},backend:n,attrs:{perm:c}}),x=lr({inputs:{x:y},backend:n,attrs:{shape:h}}),v=fh({inputs:{x},backend:n,attrs:{begin:f,size:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),v}const aye={kernelName:_v,backendName:"cpu",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,weights:a}=t,{size:o}=s,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,c=pk(u,l,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}const uye={kernelName:JT,backendName:"cpu",kernelFunc:oye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lye(r){const{inputs:t,backend:n}=r,{s0:s,s1:i}=t,a=n.data.get(s.dataId).values,o=n.data.get(i.dataId).values,u=nn(Array.from(a),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}const cye={kernelName:_P,backendName:"cpu",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hye=Hn(Ug,(r,t)=>{const n=t;return r>n.clipValueMax?n.clipValueMax:r<n.clipValueMin?n.clipValueMin:r}),fye={kernelName:Ug,backendName:"cpu",kernelFunc:hye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye=r=>{const{x:t}=r.inputs,n=r.backend,s=new Float32Array(Je(t.shape)),i=n.data.get(t.dataId),a=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,u=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values;for(let c=0;c<u.length;c++){const h=u[c],f=l[c];s[c]=Math.hypot(h,f)}return n.makeOutput(s,t.shape,"float32")},pye={kernelName:Ev,backendName:"cpu",kernelFunc:dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ed(r){const{inputs:t,backend:n}=r,{input:s}=t,i=n.data.get(s.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const mye={kernelName:p3,backendName:"cpu",kernelFunc:Ed};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(r){const{inputs:t,backend:n,attrs:s}=r,{axis:i}=s,a=dn(i,t[0].shape)[0],o=t.map(x=>x.shape);CN(o,a);let u=To(t.map(x=>x.shape),a);if(Je(u)===0)return n.makeTensorInfo(u,t[0].dtype,[]);const l=t.filter(x=>Je(x.shape)>0);if(l.length===1)return Ro({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const x=l.map(_=>hh({inputs:{input:_},backend:n})),v=l.map(_=>Ed({inputs:{input:_},backend:n})),S=Dd({inputs:x,backend:n,attrs:{axis:a}}),w=Dd({inputs:v,backend:n,attrs:{axis:a}}),E=ki({inputs:{real:S,imag:w},backend:n});return x.forEach(_=>n.disposeIntermediateTensorInfo(_)),v.forEach(_=>n.disposeIntermediateTensorInfo(_)),n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(w),E}const c=l.map(x=>{const S=[-1,Je(x.shape.slice(a))];return lr({inputs:{x},backend:n,attrs:{shape:S}})}),h=c.map(x=>({vals:n.data.get(x.dataId).values,shape:x.shape}));u=To(c.map(x=>x.shape),1);const f=c[0].shape[0]===1,p=VU(h,u,t[0].dtype,f),g=To(l.map(x=>x.shape),a),y=n.makeTensorInfo(g,t[0].dtype,p);return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const gye={kernelName:Dv,backendName:"cpu",kernelFunc:Dd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dataFormat:l,dilations:c,dimRoundingMode:h}=s;Dt([i,a],"conv2d");const f=$u(l),p=Is(i.shape,a.shape,o,c,u,h,!1,f),g=p.filterHeight,y=p.filterWidth,x=p.dilationHeight,v=p.dilationWidth,S=p.padInfo.left,w=p.padInfo.top,E=p.dataFormat==="channelsLast",_=new zs(p.outShape,i.dtype),D=Mt(i.shape),I=Mt(a.shape),k=D[0],A=E?D[1]:D[2],N=E?D[2]:1,F=E?1:D[1],$=_.strides[0],O=E?_.strides[1]:_.strides[2],M=E?_.strides[2]:1,B=E?1:_.strides[1],U=n.data.get(i.dataId).values,V=n.data.get(a.dataId).values,Z=_.values;for(let J=0;J<p.batchSize;++J){const ne=J*k,z=J*$;for(let X=0;X<p.outHeight;++X){const Y=z+X*O,se=X*p.strideHeight-w;for(let ue=0;ue<g;++ue){const fe=se+ue*x;if(fe<0||fe>=p.inHeight)continue;const de=ue*I[0],be=ne+fe*A;for(let Me=0;Me<p.outWidth;++Me){const _e=Y+Me*M,Ne=Me*p.strideWidth-S;for(let ve=0;ve<y;++ve){const Pe=Ne+ve*v;if(Pe<0||Pe>=p.inWidth)continue;const et=de+ve*I[1],Ve=be+Pe*N;let re=et;for(let Q=0;Q<p.inChannels;++Q){const ce=U[Ve+Q*F];for(let xe=0;xe<p.outChannels;++xe)Z[_e+xe*B]+=ce*V[re+xe];re+=p.outChannels}}}}}}return n.makeTensorInfo(_.shape,_.dtype,Z)}const yye={kernelName:Tv,backendName:"cpu",kernelFunc:FG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,pad:u,dataFormat:l,dimRoundingMode:c,filterShape:h}=s;Dt([i,a],"conv2dBackpropFilter");const f=$u(l),p=Is(i.shape,h,o,1,u,c,!1,f),{strideHeight:g,strideWidth:y,filterHeight:x,filterWidth:v}=p,S=p.dataFormat==="channelsLast",w=new zs(p.filterShape,"float32"),E=p.padInfo.left,_=p.padInfo.top,D=n.data.get(i.dataId).values,I=n.data.get(a.dataId).values,k=new zs(i.shape,i.dtype,D),A=new zs(a.shape,a.dtype,I);for(let N=0;N<x;++N){const F=Math.max(0,Math.ceil((_-N)/g)),$=Math.min(p.outHeight,(p.inHeight+_-N)/g);for(let O=0;O<v;++O){const M=Math.max(0,Math.ceil((E-O)/y)),B=Math.min(p.outWidth,(p.inWidth+E-O)/y);for(let U=0;U<p.inChannels;++U)for(let V=0;V<p.outChannels;++V){let Z=0;for(let J=0;J<p.batchSize;++J)for(let ne=F;ne<$;++ne){const z=N+ne*g-_;for(let X=M;X<B;++X){const Y=O+X*y-E;S?Z+=k.get(J,z,Y,U)*A.get(J,ne,X,V):Z+=k.get(J,U,z,Y)*A.get(J,V,ne,X)}}w.set(Z,N,O,U,V)}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const bye={kernelName:t3,backendName:"cpu",kernelFunc:xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vye(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{inputShape:o,strides:u,pad:l,dataFormat:c,dimRoundingMode:h}=s;Dt([i,a],"conv2dBackpropInput");const f=Mt(a.shape),p=Mt(i.shape);let g=$u(c);const y=Is(o,a.shape,u,1,l,h,!1,g),x=new zs(y.inShape,"float32"),v=x.values,S=n.data.get(i.dataId).values,w=n.data.get(a.dataId).values,[E,_,D]=f,{batchSize:I,filterHeight:k,filterWidth:A,inChannels:N,inHeight:F,inWidth:$,outChannels:O,outHeight:M,outWidth:B,strideHeight:U,strideWidth:V}=y;g=y.dataFormat;const Z=k-1-y.padInfo.top,J=A-1-y.padInfo.left,ne=g==="channelsLast",z=x.strides[0],X=ne?x.strides[1]:x.strides[2],Y=ne?x.strides[2]:1,se=ne?1:x.strides[1],ue=p[0],fe=ne?p[1]:p[2],de=ne?p[2]:1,be=ne?1:p[1];for(let Me=0;Me<I;++Me)for(let _e=0;_e<N;++_e)for(let Ne=0;Ne<F;++Ne){const ve=Ne-Z,Pe=Math.max(0,Math.ceil(ve/U)),et=Math.min(M,(k+ve)/U);for(let Ve=0;Ve<$;++Ve){const re=Ve-J,Q=Math.max(0,Math.ceil(re/V)),ce=Math.min(B,(A+re)/V);let xe=0;for(let Oe=Pe;Oe<et;++Oe){const lt=Oe*U-ve;for(let ot=Q;ot<ce;++ot){const bt=ot*V-re,Et=ue*Me+fe*Oe+de*ot,ft=E*(k-1-lt)+_*(A-1-bt)+D*_e;for(let It=0;It<O;++It){const ut=S[Et+be*It],wt=w[ft+It];xe+=ut*wt}}}const Ge=z*Me+X*Ne+Y*Ve+se*_e;v[Ge]=xe}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const wye={kernelName:Nv,backendName:"cpu",kernelFunc:vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dilations:l}=s;Dt([i,a],"conv3d");const c=Gl(i.shape,a.shape,o,l,u),{filterDepth:h,filterHeight:f,filterWidth:p,dilationDepth:g,dilationHeight:y,dilationWidth:x,padInfo:v}=c,S=v.front,w=v.left,E=v.top,_=new zs(c.outShape,i.dtype),D=n.data.get(i.dataId).values,I=n.data.get(a.dataId).values,k=_.values,A=Mt(i.shape),N=Mt(a.shape);for(let F=0;F<c.batchSize;++F){const $=F*A[0],O=F*_.strides[0];for(let M=0;M<c.outDepth;++M){const B=O+M*_.strides[1],U=M*c.strideDepth-S;for(let V=0;V<h;++V){const Z=U+V*g;if(Z<0||Z>=c.inDepth)continue;const J=V*N[0],ne=$+Z*A[1];for(let z=0;z<c.outHeight;++z){const X=B+z*_.strides[2],Y=z*c.strideHeight-E;for(let se=0;se<f;++se){const ue=Y+se*y;if(ue<0||ue>=c.inHeight)continue;const fe=J+se*N[1],de=ne+ue*A[2];for(let be=0;be<c.outWidth;++be){const Me=X+be*c.outChannels,_e=be*c.strideWidth-w;for(let Ne=0;Ne<p;++Ne){const ve=_e+Ne*x;if(ve<0||ve>=c.inWidth)continue;const Pe=fe+Ne*N[2],et=de+ve*c.inChannels;let Ve=Pe;for(let re=0;re<c.inChannels;++re){const Q=D[et+re];for(let ce=0;ce<c.outChannels;++ce)k[Me+ce]+=Q*I[Ve+ce];Ve+=c.outChannels}}}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Cye={kernelName:kv,backendName:"cpu",kernelFunc:Sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,pad:u,filterShape:l}=s;Dt([i,a],"conv3dBackpropFilterV2");const c=Mt(i.shape),h=Mt(a.shape),f=Gl(i.shape,l,o,1,u),p=f.strideDepth,g=f.strideHeight,y=f.strideWidth,x=f.filterDepth,v=f.filterHeight,S=f.filterWidth,w=new zs(f.filterShape,"float32"),E=w.values,[_,D,I,k]=w.strides,A=n.data.get(a.dataId).values,[N,F,$,O]=h,M=n.data.get(i.dataId).values,[B,U,V,Z]=c,J=f.padInfo.front,ne=f.padInfo.left,z=f.padInfo.top;for(let X=0;X<x;++X){const Y=Math.max(0,Math.ceil((J-X)/p)),se=Math.min(f.outDepth,(f.inDepth+J-X)/p),ue=X*_;for(let fe=0;fe<v;++fe){const de=Math.max(0,Math.ceil((z-fe)/g)),be=Math.min(f.outHeight,(f.inHeight+z-fe)/g),Me=fe*D+ue;for(let _e=0;_e<S;++_e){const Ne=Math.max(0,Math.ceil((ne-_e)/y)),ve=Math.min(f.outWidth,(f.inWidth+ne-_e)/y),Pe=_e*I+Me;for(let et=0;et<f.inChannels;++et){const Ve=et*k+Pe;for(let re=0;re<f.outChannels;++re){let Q=0;for(let ce=0;ce<f.batchSize;++ce){const xe=ce*B,Ge=ce*N;for(let Oe=Y;Oe<se;++Oe){const ot=(X+Oe*p-J)*U+xe,bt=Oe*F+Ge;for(let Et=de;Et<be;++Et){const It=(fe+Et*g-z)*V+ot,ut=Et*$+bt;for(let wt=Ne;wt<ve;++wt){const hr=(_e+wt*y-ne)*Z+It,qn=wt*O+ut;Q+=M[hr+et]*A[qn+re]}}}}E[Ve+re]=Q}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Eye={kernelName:n3,backendName:"cpu",kernelFunc:_ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dye(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{pad:o,strides:u,inputShape:l}=s;Dt([i],"conv3dBackpropInputV2");const c=Mt(i.shape),h=Mt(a.shape),f=Gl(l,a.shape,u,1,o),p=new zs(f.inShape,"float32"),g=p.values,[y,x,v,S]=p.strides,w=n.data.get(i.dataId).values,[E,_,D,I]=c,k=n.data.get(a.dataId).values,[A,N,F,$]=h,{batchSize:O,filterDepth:M,filterHeight:B,filterWidth:U,inChannels:V,inDepth:Z,inHeight:J,inWidth:ne,outChannels:z,outDepth:X,outHeight:Y,outWidth:se,strideDepth:ue,strideHeight:fe,strideWidth:de}=f,be=M-1-f.padInfo.front,Me=B-1-f.padInfo.top,_e=U-1-f.padInfo.left;for(let Ne=0;Ne<O;++Ne)for(let ve=0;ve<V;++ve)for(let Pe=0;Pe<Z;++Pe){const et=Pe-be,Ve=Math.max(0,Math.ceil(et/ue)),re=Math.min(X,(M+et)/ue);for(let Q=0;Q<J;++Q){const ce=Q-Me,xe=Math.max(0,Math.ceil(ce/fe)),Ge=Math.min(Y,(B+ce)/fe);for(let Oe=0;Oe<ne;++Oe){const lt=Oe-_e,ot=Math.max(0,Math.ceil(lt/de)),bt=Math.min(se,(U+lt)/de);let Et=0;for(let ft=Ve;ft<re;++ft){const It=ft*ue-et;for(let ut=xe;ut<Ge;++ut){const wt=ut*fe-ce;for(let St=ot;St<bt;++St){const hr=St*de-lt,qn=E*Ne+_*ft+D*ut+I*St,sn=A*(M-1-It)+N*(B-1-wt)+F*(U-1-hr)+$*ve;for(let Pn=0;Pn<z;++Pn){const P=w[qn+Pn],K=k[sn+Pn];Et+=P*K}}}}g[y*Ne+x*Pe+v*Q+S*Oe+ve]=Et}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Tye={kernelName:r3,backendName:"cpu",kernelFunc:Dye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nye=Hn(Gg,r=>Math.cos(r)),kye={kernelName:Gg,backendName:"cpu",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye=Hn(jg,r=>Math.cosh(r)),Iye={kernelName:jg,backendName:"cpu",kernelFunc:Aye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(r){const{inputs:t,backend:n,attrs:s}=r,{image:i,boxes:a,boxInd:o}=t,{cropSize:u,method:l,extrapolationValue:c}=s,[h,f,p,g]=i.shape,y=a.shape[0],[x,v]=u,S=hn([y,x,v,g],"float32"),w=n.data.get(a.dataId).values,E=n.data.get(o.dataId).values,_=n.data.get(i.dataId).values,D=Mt(i.shape),I=Mt(S.shape);for(let k=0;k<y;k++){const A=k*4,N=w[A],F=w[A+1],$=w[A+2],O=w[A+3],M=E[k];if(M>=h)continue;const B=x>1?($-N)*(f-1)/(x-1):0,U=v>1?(O-F)*(p-1)/(v-1):0;for(let V=0;V<x;V++){const Z=x>1?N*(f-1)+V*B:.5*(N+$)*(f-1);if(Z<0||Z>f-1){for(let J=0;J<v;J++)for(let ne=0;ne<g;ne++){const z=ne+J*I[2]+V*I[1]+k*I[0];S.values[z]=c}continue}if(l==="bilinear"){const J=Math.floor(Z),ne=Math.ceil(Z),z=Z-J;for(let X=0;X<v;X++){const Y=v>1?F*(p-1)+X*U:.5*(F+O)*(p-1);if(Y<0||Y>p-1){for(let de=0;de<g;de++){const be=de+X*I[2]+V*I[1]+k*I[0];S.values[be]=c}continue}const se=Math.floor(Y),ue=Math.ceil(Y),fe=Y-se;for(let de=0;de<g;de++){let be=de+se*D[2]+J*D[1]+M*D[0];const Me=_[be];be=de+ue*D[2]+J*D[1]+M*D[0];const _e=_[be];be=de+se*D[2]+ne*D[1]+M*D[0];const Ne=_[be];be=de+ue*D[2]+ne*D[1]+M*D[0];const ve=_[be],Pe=Me+(_e-Me)*fe,et=Ne+(ve-Ne)*fe;be=de+X*I[2]+V*I[1]+k*I[0],S.values[be]=Pe+(et-Pe)*z}}}else for(let J=0;J<v;++J){const ne=v>1?F*(p-1)+J*U:.5*(F+O)*(p-1);if(ne<0||ne>p-1){for(let Y=0;Y<g;Y++){const se=Y+J*I[2]+V*I[1]+k*I[0];S.values[se]=c}continue}const z=Math.round(ne),X=Math.round(Z);for(let Y=0;Y<g;Y++){const se=Y+z*D[2]+X*D[1]+M*D[0],ue=Y+J*I[2]+V*I[1]+k*I[0];S.values[ue]=_[se]}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Fye={kernelName:i3,backendName:"cpu",kernelFunc:$ye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,exclusive:o,reverse:u}=s;Dt(i,"cumprod");const l=Dr([a],i.shape.length);let c=i;l!=null&&(c=di({inputs:{x:i},backend:n,attrs:{perm:l}}));const h=Mr(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const f=$i(c.dtype,"int32"),p=HT(Je(c.shape),f),g=n.data.get(c.dataId).values,y=c.shape[c.shape.length-1],x=u?(S,w)=>S+y-w-1:(S,w)=>S+w;for(let S=0;S<g.length;S+=y)for(let w=0;w<y;w++){const E=x(S,w);if(w===0)p[E]=o?1:g[E];else{const _=x(S,w-1);p[E]=o?g[_]*p[_]:g[E]*p[_]}}const v=n.makeTensorInfo(c.shape,f,p);if(l!=null){const S=jl(l),w=di({inputs:{x:v},backend:n,attrs:{perm:S}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(c),w}return v}const Oye={kernelName:s3,backendName:"cpu",kernelFunc:Rye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,exclusive:o,reverse:u}=s;Dt(i,"cumsum");const l=Dr([a],i.shape.length);let c=i;l!=null&&(c=di({inputs:{x:i},backend:n,attrs:{perm:l}}));const h=Mr(1,i.shape.length)[0];if(h!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${h}`);const f=$i(c.dtype,"int32"),p=Us(Je(c.shape),f),g=n.data.get(c.dataId).values,y=c.shape[c.shape.length-1],x=u?(S,w)=>S+y-w-1:(S,w)=>S+w;for(let S=0;S<g.length;S+=y)for(let w=0;w<y;w++){const E=x(S,w);if(w===0)p[E]=o?0:g[E];else{const _=x(S,w-1);p[E]=o?g[_]+p[_]:g[E]+p[_]}}const v=n.makeTensorInfo(c.shape,f,p);if(l!=null){const S=jl(l),w=di({inputs:{x:v},backend:n,attrs:{perm:S}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(c),w}return v}const Lye={kernelName:Av,backendName:"cpu",kernelFunc:Mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,weights:a}=t,{size:o,binaryOutput:u}=s;if(i.shape.length===1){const l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=pk(l,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,h)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(a),h=BU(l,c,o,u);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const Pye={kernelName:EP,backendName:"cpu",kernelFunc:Bye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockSize:a,dataFormat:o}=s;oe(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const u=i.shape[0],l=i.shape[1],c=i.shape[2],h=i.shape[3],f=l*a,p=c*a,g=h/(a*a),y=n.data.get(i.dataId).values,x=new Float32Array(u*f*p*g);let v=0;for(let S=0;S<u;++S)for(let w=0;w<f;++w){const E=Math.floor(w/a),_=w%a;for(let D=0;D<p;++D){const I=Math.floor(D/a),k=D%a,A=(_*a+k)*g;for(let N=0;N<g;++N){const $=N+A+h*(I+c*(E+l*S));x[v++]=y[$]}}}return n.makeTensorInfo([u,f,p,g],i.dtype,x)}const zye={kernelName:a3,backendName:"cpu",kernelFunc:Vye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dilations:l,dimRoundingMode:c}=s;Dt([i,a],"depthwiseConv2DNative");const h=Mt(i.shape),f=Mt(a.shape);let p=l;p==null&&(p=[1,1]),oe(Gs(o,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${p}'`);const g=Is(i.shape,a.shape,o,p,u,c,!0),{filterHeight:y,filterWidth:x,dilationHeight:v,dilationWidth:S,padInfo:w}=g,E=w.left,_=w.top,D=g.outChannels/g.inChannels,I=new zs(g.outShape,i.dtype),k=n.data.get(i.dataId).values,A=n.data.get(a.dataId).values,N=I.values;for(let F=0;F<g.batchSize;++F){const $=F*h[0],O=F*I.strides[0];for(let M=0;M<g.outHeight;++M){const B=O+M*I.strides[1],U=M*g.strideHeight-_;for(let V=0;V<y;++V){const Z=U+V*v;if(Z<0||Z>=g.inHeight)continue;const J=V*f[0],ne=$+Z*h[1];for(let z=0;z<g.outWidth;++z){const X=B+z*I.strides[2],Y=z*g.strideWidth-E;for(let se=0;se<x;++se){const ue=Y+se*S;if(ue<0||ue>=g.inWidth)continue;const fe=J+se*f[1],de=ne+ue*g.inChannels;let be=X,Me=fe;for(let _e=0;_e<g.inChannels;++_e){const Ne=k[de+_e];for(let ve=0;ve<D;++ve)N[be+ve]+=Ne*A[Me+ve];be+=D,Me+=D}}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Uye={kernelName:Iv,backendName:"cpu",kernelFunc:RG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,dilations:u,pad:l,dimRoundingMode:c,filterShape:h}=s;Dt([i,a],"depthwiseConv2dNativeBackpropFilter");const f=Is(i.shape,h,o,u,l,c,!0),{strideHeight:p,strideWidth:g,filterHeight:y,filterWidth:x}=f,v=new zs(f.filterShape,"float32"),S=f.padInfo.left,w=f.padInfo.top,E=f.outChannels/f.inChannels,_=n.data.get(i.dataId).values,D=new zs(i.shape,i.dtype,_),I=n.data.get(a.dataId).values,k=new zs(a.shape,a.dtype,I);for(let A=0;A<y;++A){const N=Math.max(0,Math.ceil((w-A)/p)),F=Math.min(f.outHeight,(f.inHeight+w-A)/p);for(let $=0;$<x;++$){const O=Math.max(0,Math.ceil((S-$)/g)),M=Math.min(f.outWidth,(f.inWidth+S-$)/g);for(let B=0;B<f.outChannels;++B){const U=Math.trunc(B/E),V=B%E;let Z=0;for(let J=0;J<f.batchSize;++J)for(let ne=N;ne<F;++ne){const z=A+ne*p-w;for(let X=O;X<M;++X){const Y=$+X*g-S;Z+=D.get(J,z,Y,U)*k.get(J,ne,X,B)}}v.set(Z,A,$,U,V)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const jye={kernelName:o3,backendName:"cpu",kernelFunc:Gye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{strides:o,dilations:u,pad:l,dimRoundingMode:c,inputShape:h}=s;Dt([i,a],"depthwiseConv2DNativeBackpropInput");const f=Mt(i.shape),p=Mt(a.shape),g=Is(h,a.shape,o,u,l,c,!0),y=new zs(g.inShape,"float32"),x=y.values,[v,S,w]=y.strides,E=n.data.get(i.dataId).values,[_,D,I]=f,k=n.data.get(a.dataId).values,[A,N,F]=p,{batchSize:$,filterHeight:O,filterWidth:M,inChannels:B,inHeight:U,inWidth:V,outChannels:Z,outHeight:J,outWidth:ne,strideHeight:z,strideWidth:X}=g,Y=O-1-g.padInfo.top,se=M-1-g.padInfo.left,ue=Z/B;for(let fe=0;fe<$;++fe)for(let de=0;de<B;++de)for(let be=0;be<U;++be){const Me=be-Y,_e=Math.max(0,Math.ceil(Me/z)),Ne=Math.min(J,(O+Me)/z);for(let ve=0;ve<V;++ve){const Pe=ve-se,et=Math.max(0,Math.ceil(Pe/X)),Ve=Math.min(ne,(M+Pe)/X);let re=0;for(let Q=_e;Q<Ne;++Q){const ce=Q*z-Me;for(let xe=et;xe<Ve;++xe){const Ge=xe*X-Pe,Oe=_*fe+D*Q+I*xe,lt=A*(O-1-ce)+N*(M-1-Ge)+F*de;for(let ot=0;ot<ue;++ot){const bt=de*ue+ot,Et=E[Oe+bt],ft=k[lt+ot];re+=Et*ft}}}x[v*fe+S*be+w*ve+de]=re}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Hye={kernelName:u3,backendName:"cpu",kernelFunc:Wye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qye(r){const{inputs:t,backend:n}=r,{x:s}=t,i=Je(s.shape),a=n.data.get(s.dataId).values,o=hn([i,i],s.dtype),u=o.values;for(let c=0;c<a.length;c++)u[c*i+c]=a[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Kye={kernelName:DP,backendName:"cpu",kernelFunc:qye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xye={kernelName:$v,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:s,filter:i}=r,{strides:a,pad:o,dilations:u}=n,l=t,c=l.data.get(s.dataId).values,h=s.shape.length,f=l.data.get(i.dataId).values,p=i.shape.length,{batchSize:g,inHeight:y,inWidth:x,inChannels:v,outHeight:S,outWidth:w,padInfo:E,strideHeight:_,strideWidth:D,filterHeight:I,filterWidth:k,dilationHeight:A,dilationWidth:N,outShape:F}=A0(s.shape,i.shape,a,o,"NHWC",u),$=Je(F),O=F.length,M=ds(s.dtype,$);for(let U=0;U<g;++U)for(let V=0;V<S;++V){const Z=V*_-E.top;for(let J=0;J<w;++J){const ne=J*D-E.left;for(let z=0;z<v;++z){let X=Number.MIN_SAFE_INTEGER;for(let se=0;se<I;++se){const ue=Z+se*A;if(ue>=0&&ue<y)for(let fe=0;fe<k;++fe){const de=ne+fe*N;if(de>=0&&de<x){const be=Eo([U,ue,de,z],h,Mt(s.shape)),Me=Eo([se,fe,z],p,Mt(i.shape)),_e=c[be]+f[Me];_e>X&&(X=_e)}}}const Y=Eo([U,V,J,z],O,Mt(F));M[Y]=X}}}return{dataId:l.write(Eh(M,s.dtype),F,s.dtype),shape:F,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yye={kernelName:IE,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:s,filter:i,dy:a}=r,{strides:o,pad:u,dilations:l}=n,c=t,h=to(s.shape,c.data.get(s.dataId).values),f=to(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:x,outHeight:v,outWidth:S,padInfo:w,strideHeight:E,strideWidth:_,filterHeight:D,filterWidth:I,dilationHeight:k,dilationWidth:A,outShape:N}=A0(s.shape,i.shape,o,u,"NHWC",l);oe(a.rank===N.length,()=>`Error in ${IE}, dy must have the same rank as output ${N.length}, but got ${a.rank}`);const F=to(N,c.data.get(a.dataId).values),$=bP(i.shape,i.dtype);for(let M=0;M<p;++M)for(let B=0;B<v;++B){const U=B*E-w.top;for(let V=0;V<S;++V){const Z=V*_-w.left;for(let J=0;J<x;++J){let ne=Number.MIN_SAFE_INTEGER,z=0,X=0;for(let Y=0;Y<D;++Y){const se=U+Y*k;if(se>=0&&se<g)for(let ue=0;ue<I;++ue){const fe=Z+ue*A;if(fe>=0&&fe<y){const de=h[M][se][fe][J]+f[Y][ue][J];de>ne&&(ne=de,z=Y,X=ue)}}}$[z][X][J]+=F[M][B][V][J]}}}return{dataId:c.write(Eh($,s.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zye={kernelName:AE,backendName:"cpu",kernelFunc:({inputs:r,backend:t,attrs:n})=>{const{x:s,filter:i,dy:a}=r,{strides:o,pad:u,dilations:l}=n,c=t,h=to(s.shape,c.data.get(s.dataId).values),f=to(i.shape,c.data.get(i.dataId).values),{batchSize:p,inHeight:g,inWidth:y,inChannels:x,outHeight:v,outWidth:S,padInfo:w,strideHeight:E,strideWidth:_,filterHeight:D,filterWidth:I,dilationHeight:k,dilationWidth:A,outShape:N}=A0(s.shape,i.shape,o,u,"NHWC",l);oe(a.rank===N.length,()=>`Error in ${AE}, dy must have the same rank as output ${N.length}, but got ${a.rank}`);const F=to(N,c.data.get(a.dataId).values),$=bP(s.shape,s.dtype);for(let M=0;M<p;++M)for(let B=0;B<v;++B){const U=B*E-w.top;for(let V=0;V<S;++V){const Z=V*_-w.left;for(let J=0;J<x;++J){let ne=Number.MIN_SAFE_INTEGER,z=U<0?0:U,X=Z<0?0:Z;for(let Y=0;Y<D;++Y){const se=U+Y*k;if(se>=0&&se<g)for(let ue=0;ue<I;++ue){const fe=Z+ue*A;if(fe>=0&&fe<y){const de=h[M][se][fe][J]+f[Y][ue][J];de>ne&&(ne=de,z=se,X=fe)}}}$[M][z][X][J]+=F[M][B][V][J]}}}return{dataId:c.write(Eh($,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j0(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;Dt(i,"sum");let u;i.dtype==="bool"?u=Bl({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):u=Ro({inputs:{x:i},backend:n});const l=u.shape.length,c=dn(a,u.shape),h=Dr(c,l);let f=c,p=u;h!=null&&(p=di({inputs:{x:u},backend:n,attrs:{perm:h}}),f=Mr(f.length,l)),$s("sum",f,p.shape.length);const[g,y]=bs(p.shape,f),x=$i(p.dtype,"int32");let v=pb(n,g,x);const S=Je(y),w=n.data.get(v.dataId).values,E=n.data.get(p.dataId).values;for(let _=0;_<w.length;++_){const D=_*S;let I=0;for(let k=0;k<S;++k)I+=E[D+k];w[_]=I}if(o){const _=Hr(v.shape,c),D=v;v=lr({inputs:{x:v},backend:n,attrs:{shape:_}}),n.disposeIntermediateTensorInfo(D)}return n.disposeIntermediateTensorInfo(u),h!=null&&n.disposeIntermediateTensorInfo(p),v}const Qye={kernelName:h2,backendName:"cpu",kernelFunc:j0};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jye(r){const{inputs:t,backend:n,attrs:s}=r,{equation:i}=s,a=t,{allDims:o,summedDims:u,idDims:l}=ON(i,a.length);LN(o.length,l,a);const{path:c,steps:h}=BN(u,l),f=h.length;let p=null,g=o.length;const y=[];for(let x=0;x<f;++x){for(const v of h[x]){const{permutationIndices:S,expandDims:w}=MN(g,l[v]);let E;PN(S)?E=a[v]:(E=di({inputs:{x:a[v]},backend:n,attrs:{perm:S}}),y.push(E));const _=E.shape.slice();for(let D=0;D<w.length;++D)_.splice(w[D],0,1);Bn(E.shape,_)||(E=lr({inputs:{x:E},backend:n,attrs:{shape:_}}),y.push(E)),p===null?p=E:(p=G2({inputs:{a:E,b:p},backend:n}),y.push(p))}x<f-1&&(c[x]>=0&&(p=j0({inputs:{x:p},backend:n,attrs:{axis:c[x]-(o.length-g),keepDims:!1}}),y.push(p)),g--)}for(const x of y)x!==p&&n.disposeIntermediateTensorInfo(x);return p}const exe={kernelName:TP,backendName:"cpu",kernelFunc:Jye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function txe(r){const{inputs:t,backend:n}=r,{dy:s,y:i}=t;Dt([s,i],"eluGrad");const a=new Float32Array(Je(i.shape)),o=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values;for(let l=0;l<o.length;++l){const c=o[l];c>=1?a[l]=u[l]:a[l]=u[l]*(c+1)}return n.makeTensorInfo(i.shape,"float32",a)}const nxe={kernelName:l3,backendName:"cpu",kernelFunc:txe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rxe=NN,sxe=kN,ixe=AN,axe=IN,oxe=$N,uxe=FN,lxe=Hn(qg,r=>{const t=Math.sign(r),n=Math.abs(r),s=1/(1+rxe*n);return t*(1-((((uxe*s+oxe)*s+axe)*s+ixe)*s+sxe)*s*Math.exp(-n*n))}),cxe={kernelName:qg,backendName:"cpu",kernelFunc:lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yb(r){const{inputs:t,backend:n,attrs:s}=r,{input:i}=t,{dim:a}=s,o=i.shape.length,u=i.shape.slice();let l=a;return a<0&&(oe(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+a+1),u.splice(l,0,1),lr({inputs:{x:i},backend:n,attrs:{shape:u}})}const hxe={kernelName:Rv,backendName:"cpu",kernelFunc:yb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fxe=qr((r,t)=>r/t),vk=vs(Wg,fxe),aD={kernelName:Wg,backendName:"cpu",kernelFunc:vk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(r,t,n){const s=r.shape,i=s[0],a=s[1],o=n.data.get(r.dataId),u=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,c=[i,a],h=Je(c),f=As("float32",h),p=As("float32",h);for(let v=0;v<i;v++){const S=fh({inputs:{x:u},backend:n,attrs:{begin:[v,0],size:[1,a]}}),w=fh({inputs:{x:l},backend:n,attrs:{begin:[v,0],size:[1,a]}}),E=ki({inputs:{real:S,imag:w},backend:n}),{real:_,imag:D}=dxe(E,t,n),I=Eu(_,D);for(let k=0;k<a;k++){const A=RN(I,k);f[v*a+k]=A.real,p[v*a+k]=A.imag}n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(E)}const g=n.makeTensorInfo(c,"float32",f),y=n.makeTensorInfo(c,"float32",p),x=ki({inputs:{real:g,imag:y},backend:n});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}function dxe(r,t,n){const s=Je(r.shape),i=n.data.get(r.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(pxe(s)){const u=oD(a,o,s,t,n),l=[r.shape[0],r.shape[1]];if(t){const c=n.makeTensorInfo(l,"float32",u.real),h=n.makeTensorInfo(l,"float32",u.imag),f=n.makeTensorInfo([],"float32",Ul(s,"float32")),p=Ro({inputs:{x:f},backend:n}),g=aD.kernelFunc({inputs:{a:c,b:f},backend:n}),y=aD.kernelFunc({inputs:{a:h,b:p},backend:n}),x=n.data.get(g.dataId).values,v=n.data.get(y.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),{real:x,imag:v}}return u}else{const u=Eu(a,o),l=mxe(u,s,t);return sV(l)}}function pxe(r){return(r&r-1)===0}function oD(r,t,n,s,i){if(n===1)return{real:r,imag:t};const a=Eu(r,t),o=n/2,u=iV(a),l=u.real,c=u.imag,h=[l.length],f=i.makeTensorInfo(h,"float32",l),p=i.makeTensorInfo(h,"float32",c),g=ki({inputs:{real:f,imag:p},backend:i}),y=aV(a),x=y.real,v=y.imag,S=[x.length],w=i.makeTensorInfo(S,"float32",x),E=i.makeTensorInfo(S,"float32",v),_=ki({inputs:{real:w,imag:E},backend:i}),D=oD(l,c,o,s,i),I=D.real,k=D.imag,A=[I.length],N=i.makeTensorInfo(A,"float32",I),F=i.makeTensorInfo(A,"float32",k),$=ki({inputs:{real:N,imag:F},backend:i}),O=oD(x,v,o,s,i),M=O.real,B=O.imag,U=[M.length],V=i.makeTensorInfo(U,"float32",M),Z=i.makeTensorInfo(U,"float32",B),J=ki({inputs:{real:V,imag:Z},backend:i}),ne=uV(n,s),z=[ne.real.length],X=i.makeTensorInfo(z,"float32",ne.real),Y=i.makeTensorInfo(z,"float32",ne.imag),se=ki({inputs:{real:X,imag:Y},backend:i}),ue=G2({inputs:{a:se,b:J},backend:i}),fe=_d({inputs:{a:$,b:ue},backend:i}),de=xk({inputs:{a:$,b:ue},backend:i}),be=hh({inputs:{input:fe},backend:i}),Me=hh({inputs:{input:de},backend:i}),_e=Ed({inputs:{input:fe},backend:i}),Ne=Ed({inputs:{input:de},backend:i}),ve=Dd({inputs:[be,Me],backend:i,attrs:{axis:0}}),Pe=Dd({inputs:[_e,Ne],backend:i,attrs:{axis:0}}),et=i.data.get(ve.dataId).values,Ve=i.data.get(Pe.dataId).values;return i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(g),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo($),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(Z),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Y),i.disposeIntermediateTensorInfo(se),i.disposeIntermediateTensorInfo(ue),i.disposeIntermediateTensorInfo(fe),i.disposeIntermediateTensorInfo(de),i.disposeIntermediateTensorInfo(be),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(Me),i.disposeIntermediateTensorInfo(Ne),i.disposeIntermediateTensorInfo(ve),i.disposeIntermediateTensorInfo(Pe),{real:et,imag:Ve}}function mxe(r,t,n){const s=new Float32Array(t*2);for(let i=0;i<t;i++){let a=0,o=0;for(let u=0;u<t;u++){const l=lV(i*u,t,n),c=RN(r,u);a+=c.real*l.real-c.imag*l.imag,o+=c.real*l.imag+c.imag*l.real}n&&(a/=t,o/=t),oV(s,a,o,i)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gxe(r){const{inputs:t,backend:n}=r,{input:s}=t,i=Je(s.shape),a=s.shape[s.shape.length-1],o=i/a,u=lr({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),l=OG(u,!1,n),c=lr({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),c}const yxe={kernelName:c3,backendName:"cpu",kernelFunc:gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wk(r){const{backend:t,attrs:n}=r,{shape:s,value:i,dtype:a}=n,o=a||$g(i),u=ds(o,Je(s));return bxe(u,i,o),t.makeTensorInfo(s,o,u)}const xxe={kernelName:h3,backendName:"cpu",kernelFunc:wk};function bxe(r,t,n){r.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vxe={kernelName:f3,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:s}=r,i=n,a=As(s.dtype,Je(s.shape)),[o,u,l,c]=s.shape,h=i.data.get(s.dataId).values;for(let p=0;p<o;p++){const g=p*l*u*c;for(let y=0;y<u;y++){const x=y*(l*c);for(let v=0;v<l;v++){const S=v*c;for(let w=0;w<c;w++){const E=Math.round(l-v-1),_=g+x+S+w;let D=h[_];if(E>=0&&E<l){const I=E*c,k=g+x+I+w;D=h[k]}a[_]=D}}}}return{dataId:i.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wxe=qr((r,t)=>Math.floor(r/t)),Sxe=vs(Zg,wxe,null,"int32"),Cxe={kernelName:Zg,backendName:"cpu",kernelFunc:Sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a,bias:o,preluActivationWeights:u}=t,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let x=FG({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p}});if(o){const v=x;if(h==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const S=lr({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});x=_d({inputs:{a:x,b:S},backend:n}),n.disposeIntermediateTensorInfo(S)}else x=_d({inputs:{a:x,b:o},backend:n});n.disposeIntermediateTensorInfo(v)}if(g){const v=x;if(h==="NCHW"&&g==="prelu"&&u.shape.length===1&&u.shape[0]!==1){const S=lr({inputs:{x:u},backend:n,attrs:{shape:[u.shape[0],1,1]}});x=gb(n,x,g,S,y),n.disposeIntermediateTensorInfo(S)}else x=gb(n,x,g,u,y);n.disposeIntermediateTensorInfo(v)}return x}const Exe={kernelName:Zx,backendName:"cpu",kernelFunc:_xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a,bias:o,preluActivationWeights:u}=t,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s;let x=RG({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p}});if(o){const v=x;x=_d({inputs:{a:x,b:o},backend:n}),n.disposeIntermediateTensorInfo(v)}if(g){const v=x;x=gb(n,x,g,u,y),n.disposeIntermediateTensorInfo(v)}return x}const Txe={kernelName:jP,backendName:"cpu",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nxe(r){const{inputs:t,backend:n}=r,{params:s,indices:i}=t,a=Je(s.shape),o=i.shape,u=o[o.length-1],[l,c,h,f]=O3(s,i);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const p=n.data.get(i.dataId).values,g=n.bufferSync(s),y=qU(p,g,s.dtype,c,u,h,f,s.shape,a);return n.makeTensorInfo(l,s.dtype,y.values)}const kxe={kernelName:NP,backendName:"cpu",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Axe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,indices:a}=t,{axis:o,batchDims:u}=s;Dt([i,a],"gatherV2");const l=dn(o,i.shape)[0],c=n.data.get(a.dataId).values,h=i.shape[l];for(let _=0;_<c.length;++_){const D=c[_];oe(D<=h-1&&D>=0,()=>`GatherV2: the index value ${D} is not in [0, ${h-1}]`)}let f=u;u==null&&(f=0);const p=Je(a.shape),g=zN(i,a,l,f),y=lr({inputs:{x:i},backend:n,attrs:{shape:[g.batchSize,g.outerSize,g.dimSize,g.sliceSize]}}),x=lr({inputs:{x:a},backend:n,attrs:{shape:[g.batchSize,p/g.batchSize]}}),v=[g.batchSize,g.outerSize,p/g.batchSize,g.sliceSize],S=n.bufferSync(x),w=n.bufferSync(y),E=KU(w,S,v);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(g.outputShape,E.dtype,E.values)}const Ixe={kernelName:Mv,backendName:"cpu",kernelFunc:Axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $xe(r){const{inputs:t,backend:n}=r,{input:s}=t,i=Je(s.shape),a=s.shape[s.shape.length-1],o=i/a,u=lr({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),l=OG(u,!0,n),c=lr({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),c}const Fxe={kernelName:d3,backendName:"cpu",kernelFunc:$xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rxe=Hn(e0,r=>Number.isFinite(r)?1:0,"bool"),Oxe={kernelName:e0,backendName:"cpu",kernelFunc:Rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mxe=Hn(t0,r=>Math.abs(r)===1/0?1:0,"bool"),Lxe={kernelName:t0,backendName:"cpu",kernelFunc:Mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bxe=Hn(n0,r=>Number.isNaN(r)?1:0,"bool"),Pxe={kernelName:n0,backendName:"cpu",kernelFunc:Bxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vxe(r){const{backend:t,attrs:n}=r,{start:s,stop:i,num:a}=n,o=JU(s,i,a);return t.makeTensorInfo([o.length],"float32",o)}const zxe={kernelName:kP,backendName:"cpu",kernelFunc:Vxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uxe=Hn(s0,r=>Math.log1p(r)),Gxe={kernelName:s0,backendName:"cpu",kernelFunc:Uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jxe=qr((r,t)=>r&&t),Wxe=vs(zv,jxe,null,"bool"),Hxe={kernelName:zv,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qxe=Hn(Uv,r=>r?0:1,"bool"),Kxe={kernelName:Uv,backendName:"cpu",kernelFunc:qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe=qr((r,t)=>r||t),Yxe=vs(Gv,Xxe,null,"bool"),Zxe={kernelName:Gv,backendName:"cpu",kernelFunc:Yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qxe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{depthRadius:a,bias:o,alpha:u,beta:l}=s;Dt(i,"LRN");const c=i.shape[3],h=c-1,f=n.data.get(i.dataId).values,p=Je(i.shape),g=new Float32Array(p);function y(x){const v=x%c;let S=x-v+Math.max(0,v-a);const w=x-v+Math.min(v+a,h);let E=0;for(;S<=w;S++){const _=f[S];E+=_*_}return E}for(let x=0;x<p;x++){const v=y(x),S=f[x]*Math.pow(o+u*v,-l);g[x]=S}return n.makeTensorInfo(i.shape,i.dtype,g)}const Jxe={kernelName:jv,backendName:"cpu",kernelFunc:Qxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,y:a,dy:o}=t,{depthRadius:u,bias:l,alpha:c,beta:h}=s;Dt(o,"LRNGrad");const f=Je(o.shape),p=o.shape[3],g=n.data.get(o.dataId).values,y=n.data.get(i.dataId).values,x=n.data.get(a.dataId).values,v=new Float32Array(f),S=f;for(let w=0;w<S;w++){const E=w%p,_=w-E+Math.max(0,E-u),D=w-E+Math.min(p,E+u+1);let I=0;for(let k=_;k<D;k++)I+=Math.pow(y[k],2);I=c*I+l;for(let k=_;k<D;k++){let A=-2*c*h*y[k]*x[w]/I;w===k&&(A+=Math.pow(I,-h)),A*=g[w],v[k]+=A}}return n.makeTensorInfo(o.shape,i.dtype,v)}const tbe={kernelName:m3,backendName:"cpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{reductionIndices:a,keepDims:o}=s,u=n;let l=i.shape;const c=l.length,h=dn(a,l);let f=h;const p=Dr(f,c);let g=u.data.get(i.dataId).values;if(p!=null){const _=new Array(c);for(let D=0;D<_.length;D++)_[D]=l[p[D]];g=gk(g,l,i.dtype,p,_),f=Mr(f.length,c),l=_}Dt(i,"max"),$s("max",f,c);const[y,x]=bs(l,f),v=Je(x),S=tG(g,v,y,i.dtype),w=u.write(S,y,i.dtype);let E=y;return o&&(E=Hr(y,h)),{dataId:w,shape:E,dtype:i.dtype}}const nbe={kernelName:Wv,backendName:"cpu",kernelFunc:MG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rbe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t;Dt(i,"maxPool");const{filterSize:a,strides:o,pad:u,dimRoundingMode:l}=s,c=1;oe(Gs(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=Ra(i.shape,a,o,c,u,l);let f;if(h.filterWidth===1&&h.filterHeight===1&&Bn(h.inShape,h.outShape))f=Ro({inputs:{x:i},backend:n});else{const p=n.data.get(i.dataId).values,g=Mt(i.shape),y=bk(p,i.shape,i.dtype,g,h,"max");f=n.makeTensorInfo(h.outShape,i.dtype,y.values)}return f}const sbe={kernelName:Hv,backendName:"cpu",kernelFunc:rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{filterSize:a,strides:o,pad:u,dimRoundingMode:l,dataFormat:c}=s;Dt(i,"maxPool3d");const h=Iu(i.shape,a,o,1,u,l,c),f=n.data.get(i.dataId).values,p=$G(f,i.shape,i.dtype,Mt(i.shape),h,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const abe={kernelName:qv,backendName:"cpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function obe(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,{filterSize:o,strides:u,pad:l,dimRoundingMode:c}=s;Dt([i,a],"maxPool3DGrad");const h=Iu(a.shape,o,u,1,l,c),f=n.bufferSync(a),p=K1e(f,h),g=h.strideDepth,y=h.strideHeight,x=h.strideWidth,v=h.dilationDepth,S=h.dilationHeight,w=h.dilationWidth,E=h.effectiveFilterDepth,_=h.effectiveFilterHeight,D=h.effectiveFilterWidth,I=E-1-h.padInfo.front,k=D-1-h.padInfo.left,A=_-1-h.padInfo.top,N=hn(a.shape,"float32"),F=n.bufferSync(i);for(let $=0;$<h.batchSize;++$)for(let O=0;O<h.inChannels;++O)for(let M=0;M<h.inDepth;++M)for(let B=0;B<h.inHeight;++B)for(let U=0;U<h.inWidth;++U){const V=M-I,Z=B-A,J=U-k;let ne=0;for(let z=0;z<E;z+=v){const X=(V+z)/g;if(!(X<0||X>=h.outDepth||Math.floor(X)!==X))for(let Y=0;Y<_;Y+=S){const se=(Z+Y)/y;if(!(se<0||se>=h.outHeight||Math.floor(se)!==se))for(let ue=0;ue<D;ue+=w){const fe=(J+ue)/x;if(fe<0||fe>=h.outWidth||Math.floor(fe)!==fe)continue;const de=E*_*D-1-p.get($,X,se,fe,O),be=z*_*D+Y*D+ue,Me=de===be?1:0;if(Me===0)continue;const _e=F.get($,X,se,fe,O);ne+=_e*Me}}}N.set(ne,$,M,B,U,O)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const ube={kernelName:y3,backendName:"cpu",kernelFunc:obe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a,output:o}=t,u=a;Dt([a,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:f}=s,p=Ra(u.shape,l,c,1,h,f),g=n.data.get(u.dataId).values,y=hn(p.outShape,u.dtype,IG(g,u.shape,u.dtype,p).values),x=p.strideHeight,v=p.strideWidth,S=p.dilationHeight,w=p.dilationWidth,E=p.effectiveFilterHeight,_=p.effectiveFilterWidth,D=_-1-p.padInfo.left,I=E-1-p.padInfo.top,k=hn(u.shape,"float32"),A=n.data.get(i.dataId).values,N=hn(i.shape,"float32",A);for(let F=0;F<p.batchSize;++F)for(let $=0;$<p.inChannels;++$)for(let O=0;O<p.inHeight;++O)for(let M=0;M<p.inWidth;++M){const B=O-I,U=M-D;let V=0;for(let Z=0;Z<E;Z+=S){const J=(B+Z)/x;if(!(J<0||J>=p.outHeight||Math.floor(J)!==J))for(let ne=0;ne<_;ne+=w){const z=(U+ne)/v;if(z<0||z>=p.outWidth||Math.floor(z)!==z)continue;const X=E*_-1-y.get(F,J,z,$),Y=Z*_+ne,se=X===Y?1:0;if(se===0)continue;const ue=N.get(F,J,z,$);V+=ue*se}}k.set(V,F,O,M,$)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const cbe={kernelName:g3,backendName:"cpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hbe(r,t,n,s,i){const a=Mt(t),o=bk(r,t,n,a,i,"max"),u=IG(r,t,n,i,!0,s);return[o.values,u.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fbe={kernelName:AP,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:s}=r,{filterSize:i,strides:a,pad:o,includeBatchInIndex:u}=t,l=n;Dt(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,h=Ra(s.shape,i,a,[1,1],o),[f,p]=hbe(c,s.shape,s.dtype,u,h),g=l.write(f,h.outShape,s.dtype),y=l.write(p,h.outShape,s.dtype);return[{dataId:g,shape:h.outShape,dtype:s.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dbe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s,u=dn(a,i.shape),c=bs(i.shape,u)[1],h=Je(c),f=[],p=n.makeTensorInfo([],"float32",new Float32Array([h]));f.push(p);const g=Bl({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});f.push(g);const y=vk({inputs:{a:g,b:p},backend:n});f.push(y);const x=j0({inputs:{x:y},backend:n,attrs:{axis:a,keepDims:o}});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),x}const pbe={kernelName:Kv,backendName:"cpu",kernelFunc:dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;Dt(i,"min");const u=dn(a,i.shape);let l=u;const c=Dr(l,i.shape.length);let h=i;c!=null&&(h=di({inputs:{x:i},backend:n,attrs:{perm:c}}),l=Mr(l.length,i.shape.length)),$s("min",l,h.shape.length);const[f,p]=bs(h.shape,l),g=Je(p),y=Us(Je(f),h.dtype),x=n.data.get(h.dataId).values;for(let S=0;S<y.length;++S){const w=S*g;let E=x[w];for(let _=0;_<g;++_){const D=x[w+_];(Number.isNaN(D)||D<E)&&(E=D)}y[S]=E}c!=null&&n.disposeIntermediateTensorInfo(h);const v=n.makeTensorInfo(f,h.dtype,y);if(o){const S=Hr(f,u),w=lr({inputs:{x:v},backend:n,attrs:{shape:S}});return n.disposeIntermediateTensorInfo(v),w}return v}const gbe={kernelName:Xv,backendName:"cpu",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{paddings:a,mode:o}=s;Dt(i,"mirrorPad");const u=a.map((E,_)=>E[0]+i.shape[_]+E[1]),l=a.map(E=>E[0]),c=a.map((E,_)=>E[0]+i.shape[_]),h=o==="reflect"?0:1,f=n.data.get(i.dataId).values,p=i.shape.length,g=Mt(i.shape),y=Je(u),x=u.length,v=Mt(u),S=As(i.dtype,y);for(let E=0;E<y;E++){let _=zd(E,x,v);for(let I=0;I<x;I++)_[I]<l[I]?_[I]=l[I]*2-_[I]-h:_[I]>=c[I]&&(_[I]=(c[I]-1)*2-_[I]+h);_=_.map((I,k)=>I-l[k]);const D=Eo(_,p,g);S[E]=f[D]}return{dataId:n.write(S,u,i.dtype),shape:u,dtype:i.dtype}}const xbe={kernelName:Yv,backendName:"cpu",kernelFunc:ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bbe=qr((r,t)=>{const n=r%t;return r<0&&t<0||r>=0&&t>=0?n:(n+t)%t}),vbe=vs(o0,bbe),wbe={kernelName:o0,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(r){const{inputs:t,backend:n,attrs:s}=r,{logits:i}=t,{dim:a}=s,o=i.shape.length;let u=a;if(u===-1&&(u=o-1),u!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${u}`);const l=dn([u],i.shape),c=MG({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),h=Hr(c.shape,l),f=lr({inputs:{x:c},backend:n,attrs:{shape:h}}),p=xk({inputs:{a:i,b:f},backend:n}),g=jU({inputs:{x:p},backend:n}),y=j0({inputs:{x:g},backend:n,attrs:{axis:l,keepDims:!1}}),x=lr({inputs:{x:y},backend:n,attrs:{shape:h}}),v=vk({inputs:{a:g,b:x},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),v}const Sbe={kernelName:p2,backendName:"cpu",kernelFunc:LG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(r){const{inputs:t,backend:n,attrs:s}=r,{logits:i}=t,{numSamples:a,seed:o,normalized:u}=s;Dt(i,"multinomial");const l=u?i:LG({inputs:{logits:i},backend:n,attrs:{dim:-1}}),c=l.shape[0],h=l.shape[1],f=n.data.get(l.dataId).values,p=[c,a],g=Us(Je(p),"int32");for(let y=0;y<c;++y){const x=y*h,v=new Float32Array(h-1);v[0]=f[x];for(let E=1;E<v.length;++E)v[E]=v[E-1]+f[x+E];const S=sN.alea(o.toString()),w=y*a;for(let E=0;E<a;++E){const _=S();g[w+E]=v.length;for(let D=0;D<v.length;D++)if(_<v[D]){g[w+E]=D;break}}}return u||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",g)}const _be={kernelName:IP,backendName:"cpu",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ebe=dN;function Dbe(r){const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l}=s;Dt(i,"NonMaxSuppression");const c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,{selectedIndices:f}=Ebe(c,h,o,u,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Tbe={kernelName:x3,backendName:"cpu",kernelFunc:Dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nbe=pN;function kbe(r){const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l,padToMaxOutputSize:c}=s;Dt(i,"NonMaxSuppressionPadded");const h=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,{selectedIndices:p,validOutputs:g}=Nbe(h,f,o,u,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const Abe={kernelName:b3,backendName:"cpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ibe=mN;function $be(r){const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l,softNmsSigma:c}=s;Dt(i,"NonMaxSuppressionWithScore");const h=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,p=o,g=u,y=l,x=c,{selectedIndices:v,selectedScores:S}=Ibe(h,f,p,g,y,x);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const Fbe={kernelName:v3,backendName:"cpu",kernelFunc:$be};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rbe(r){const{inputs:t,backend:n,attrs:s}=r,{indices:i}=t,{dtype:a,depth:o,onValue:u,offValue:l}=s;Dt(i,"oneHot");const c=Je(i.shape),h=new Float32Array(c*o);h.fill(l);const f=n.data.get(i.dataId).values;for(let p=0;p<c;++p)f[p]>=0&&f[p]<o&&(h[p*o+f[p]]=u);return n.makeTensorInfo([...i.shape,o],a,h)}const Obe={kernelName:e2,backendName:"cpu",kernelFunc:Rbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xb(r){const{inputs:t,backend:n}=r,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const i=hh({inputs:{input:s},backend:n}),a=xb({inputs:{x:i},backend:n}),o=Ed({inputs:{input:s},backend:n}),u=xb({inputs:{x:o},backend:n}),l=ki({inputs:{real:a,imag:u},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}else return wk({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const Mbe={kernelName:y2,backendName:"cpu",kernelFunc:xb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(r){const{inputs:t,backend:n}=r,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const i=hh({inputs:{input:s},backend:n}),a=BG({inputs:{x:i},backend:n}),o=Ed({inputs:{input:s},backend:n}),u=xb({inputs:{x:o},backend:n}),l=ki({inputs:{real:a,imag:u},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}else return wk({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const Lbe={kernelName:Jv,backendName:"cpu",kernelFunc:BG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(r){const{inputs:t,backend:n,attrs:s}=r,{axis:i}=s;if(t.length===1)return yb({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const a=t[0].shape,o=t[0].dtype;t.forEach(h=>{WT(a,h.shape,"All tensors passed to stack must have matching shapes"),oe(o===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const u=[],l=t.map(h=>{const f=yb({inputs:{input:h},backend:n,attrs:{dim:i}});return u.push(f),f}),c=Dd({inputs:l,backend:n,attrs:{axis:i}});return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const Bbe={kernelName:t2,backendName:"cpu",kernelFunc:PG};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{paddings:a,constantValue:o}=s;Dt(i,"pad");const u=a.map((w,E)=>w[0]+i.shape[E]+w[1]),l=a.map(w=>w[0]),c=n.data.get(i.dataId).values,h=Je(i.shape),f=i.shape.length,p=Mt(i.shape),g=Je(u),y=u.length,x=Mt(u),v=As(i.dtype,g);o!==0&&v.fill(o);for(let w=0;w<h;w++){const _=zd(w,f,p).map((I,k)=>I+l[k]),D=Eo(_,y,x);v[D]=c[w]}return{dataId:n.write(v,u,i.dtype),shape:u,dtype:i.dtype}}const VG={kernelName:n2,backendName:"cpu",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vbe=qr((r,t)=>Math.pow(r,t)),zbe=vs(l0,Vbe),Ube={kernelName:l0,backendName:"cpu",kernelFunc:zbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gbe(r){const{inputs:t,backend:n,attrs:s}=r,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:u}=s,l=i.map(S=>n.data.get(S.dataId).values),c=i.map(S=>S.shape),h=n.data.get(a.dataId).values,f=n.data.get(o.dataId).values,[p,g,y]=oG(l,c,h,a.shape,a.dtype,f,o.shape),x=p.map(S=>n.makeTensorInfo([S.length],"int32",S)),v=n.makeTensorInfo(y,a.dtype,g);return x.concat([v])}const jbe={kernelName:$P,backendName:"cpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(r){const{inputs:t,backend:n,attrs:s}=r,{shape:i,values:a,defaultValue:o,rowPartitionTensors:u}=t,{rowPartitionTypes:l}=s,c=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,f=n.data.get(o.dataId).values,p=u.map(v=>n.data.get(v.dataId).values),g=u.map(v=>v.shape),[y,x]=uG(c,i.shape,h,a.shape,a.dtype,f,o.shape,p,g,l);return n.makeTensorInfo(y,a.dtype,x)}const Hbe={kernelName:FP,backendName:"cpu",kernelFunc:Wbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qbe(r){const{backend:t,attrs:n}=r,{start:s,stop:i,dtype:a,step:o}=n,u=lG(s,i,o,a);return t.makeTensorInfo([u.length],a,u)}const Kbe={kernelName:w3,backendName:"cpu",kernelFunc:qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xbe=Hn(c0,r=>1/r),Ybe={kernelName:c0,backendName:"cpu",kernelFunc:Xbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zbe(r){const{inputs:t,backend:n,attrs:s}=r,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:u}=s;Dt(i,"resizeBilinear");const l=Mt(i.shape),[c,h]=u,[f,p,g,y]=i.shape,x=n.data.get(i.dataId).values,v=new Float32Array(Je([f,c,h,y])),S=[a&&c>1?p-1:p,a&&h>1?g-1:g],w=[a&&c>1?c-1:c,a&&h>1?h-1:h];let E=0;const _=S[0]/w[0],D=S[1]/w[1];for(let I=0;I<f;I++)for(let k=0;k<c;k++){let A;o?A=_*(k+.5)-.5:A=_*k;const N=Math.max(0,Math.floor(A)),F=A-N,$=Math.min(p-1,Math.ceil(A)),O=I*l[0]+N*l[1],M=I*l[0]+$*l[1];for(let B=0;B<h;B++){let U;o?U=D*(B+.5)-.5:U=D*B;const V=Math.max(0,Math.floor(U)),Z=U-V,J=Math.min(g-1,Math.ceil(U)),ne=O+V*l[2],z=M+V*l[2],X=O+J*l[2],Y=M+J*l[2];for(let se=0;se<y;se++){const ue=x[ne+se],fe=x[z+se],de=x[X+se],be=x[Y+se],Me=ue+(de-ue)*Z,_e=fe+(be-fe)*Z,Ne=Me+(_e-Me)*F;v[E++]=Ne}}}return n.makeTensorInfo([f,c,h,y],"float32",v)}const Qbe={kernelName:o2,backendName:"cpu",kernelFunc:Zbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(r){const{inputs:t,backend:n,attrs:s}=r,{images:i,dy:a}=t,{alignCorners:o}=s;Dt([a,i],"resizeBilinearGrad");const u=Mt(i.shape),[l,c,h,f]=i.shape,[,p,g]=a.shape,y=new Float32Array(l*c*h*f),x=[o&&p>1?c-1:c,o&&g>1?h-1:h],v=[o&&p>1?p-1:p,o&&g>1?g-1:g],S=x[0]/v[0],w=x[1]/v[1],E=n.data.get(a.dataId).values;let _=0;for(let D=0;D<l;D++){const I=D*u[0];for(let k=0;k<p;k++){const A=k*S,N=Math.floor(A),F=Math.min(Math.ceil(A),c-1),$=I+N*u[1],O=I+F*u[1],M=A-N,B=1-M;for(let U=0;U<g;U++){const V=U*w,Z=Math.floor(V),J=Math.min(Math.ceil(V),h-1),ne=V-Z,z=1-ne,X=$+Z*u[2],Y=$+J*u[2],se=O+Z*u[2],ue=O+J*u[2],fe=B*z,de=B*ne,be=M*z,Me=M*ne;for(let _e=0;_e<f;_e++){const Ne=E[_++];y[X+_e]+=Ne*fe,y[Y+_e]+=Ne*de,y[se+_e]+=Ne*be,y[ue+_e]+=Ne*Me}}}}return n.makeTensorInfo([l,h,c,f],"float32",y)}const eve={kernelName:_3,backendName:"cpu",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tve(r){const{inputs:t,backend:n,attrs:s}=r,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:u}=s;Dt(i,"resizeNearestNeighbor");const l=Mt(i.shape),[c,h]=u,[f,p,g,y]=i.shape,x=n.data.get(i.dataId).values,v=new Float32Array(f*c*h*y),S=[a&&c>1?p-1:p,a&&h>1?g-1:g],w=[a&&c>1?c-1:c,a&&h>1?h-1:h],E=S[0]/w[0],_=S[1]/w[1];let D=0;for(let I=0;I<f;I++){const k=I*l[0];for(let A=0;A<c;A++){const N=o?E*(A+.5):E*A;let F=Math.min(p-1,a?Math.round(N):Math.floor(N));o&&(F=Math.max(0,F));const $=k+F*l[1];for(let O=0;O<h;O++){const M=o?_*(O+.5):_*O;let B=Math.min(g-1,a?Math.round(M):Math.floor(M));o&&(B=Math.max(0,B));const U=$+B*l[2];for(let V=0;V<y;V++){const Z=x[U+V];v[D++]=Z}}}}return n.makeTensorInfo([f,c,h,y],i.dtype,v)}const nve={kernelName:a2,backendName:"cpu",kernelFunc:tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rve(r){const{inputs:t,backend:n,attrs:s}=r,{images:i,dy:a}=t,{alignCorners:o}=s;Dt([a,i],"resizeNearestNeighborGrad");const u=Mt(i.shape),l=Mt(a.shape),[c,h,f,p]=i.shape,[,g,y]=a.shape,x=new Float32Array(c*h*f*p),v=n.data.get(a.dataId).values,S=[o&&g>1?h-1:h,o&&y>1?f-1:f],w=[o&&g>1?g-1:g,o&&y>1?y-1:y],E=S[0]/w[0],_=S[1]/w[1],D=1/E,I=1/_,k=Math.ceil(D)*2+2,A=Math.ceil(I)*2+2;for(let N=0;N<c;N++){const F=N*u[0];for(let $=0;$<h;$++){const O=F+$*u[1],M=Math.floor($*D),B=Math.floor(M-k/2);for(let U=0;U<f;U++){const V=O+U*u[2],Z=Math.floor(U*I),J=Math.floor(Z-A/2);for(let ne=0;ne<p;ne++){let z=0;for(let X=0;X<k;X++){const Y=X+B;if(Y<0||Y>=g)continue;const se=F+Y*l[1],ue=Y*E,fe=Math.min(h-1,o?Math.round(ue):Math.floor(ue));if($===fe)for(let de=0;de<A;de++){const be=de+J;if(be<0||be>=y)continue;const Me=se+be*l[2],_e=be*_,Ne=Math.min(f-1,o?Math.round(_e):Math.floor(_e));U===Ne&&(z+=v[Me+ne])}}x[V+ne]=z}}}}return n.makeTensorInfo(i.shape,i.dtype,x)}const sve={kernelName:C3,backendName:"cpu",kernelFunc:rve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ive(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{dims:a}=s;Dt(i,"reverse");const o=i.shape.length,u=dn(a,i.shape);if(o===0)return Ro({inputs:{x:i},backend:n});const l=new zs(i.shape,i.dtype),c=n.bufferSync(i);for(let h=0;h<l.size;h++){const f=l.indexToLoc(h),p=f.slice();u.forEach(g=>p[g]=i.shape[g]-1-p[g]),l.set(c.get(...p),...f)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const ave={kernelName:u2,backendName:"cpu",kernelFunc:ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ove={kernelName:A3,backendName:"cpu",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:s}=r,{radians:i,fillValue:a,center:o}=t,u=n,l=As(s.dtype,Je(s.shape)),[c,h,f,p]=s.shape,[g,y]=EN(o,h,f),x=255,v=Math.sin(i),S=Math.cos(i),w=u.data.get(s.dataId).values;for(let _=0;_<c;_++){const D=_*f*h*p;for(let I=0;I<h;I++){const k=I*(f*p);for(let A=0;A<f;A++){const N=A*p;for(let F=0;F<p;F++){const $=[c,I,A,F],O=$[2],M=$[1];let B=(O-g)*S-(M-y)*v,U=(O-g)*v+(M-y)*S;B=Math.round(B+g),U=Math.round(U+y);let V=a;if(typeof a!="number"&&(F===3?V=x:V=a[F]),B>=0&&B<f&&U>=0&&U<h){const J=U*(f*p),ne=B*p,z=D+J+ne+F;V=w[z]}const Z=D+k+N+F;l[Z]=V}}}}return{dataId:u.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uve=Hn(d0,r=>{const t=Math.floor(r);return r-t<.5?Math.floor(r):r-t>.5?Math.ceil(r):t%2===0?t:t+1}),lve={kernelName:d0,backendName:"cpu",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cve(r){const{inputs:t,backend:n,attrs:s}=r,{indices:i,updates:a}=t,{shape:o}=s,{sliceRank:u,numUpdates:l,sliceSize:c,strides:h,outputSize:f}=k0(a,i,o),p=!0,g=n.bufferSync(i),y=n.bufferSync(a),x=Vf(g,y,o,f,c,l,u,h,0,p);return n.makeTensorInfo(o,x.dtype,x.values)}const hve={kernelName:RP,backendName:"cpu",kernelFunc:cve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fve(r,t){let n=0,s=r.length,i=0;for(;n<s;)i=Math.floor((n+s)/2),r[i]<t?n=i+1:s=i;return s}function dve(r,t){let n=0,s=r.length,i=0;for(;n<s;)i=Math.floor((n+s)/2),r[i]<=t?n=i+1:s=i;return s}function pve(r,t,n,s,i,a){const o=ds("int32",n*i);for(let u=0;u<n;++u){const l=r.slice(u*s,(u+1)*s),c=u*i;for(let h=0;h<i;++h)o[c+h]=a==="left"?fve(l,t[h+c]):dve(l,t[h+c])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mve(r){const{inputs:t,backend:n,attrs:s}=r,{sortedSequence:i,values:a}=t,{side:o}=s,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,c=pve(u,l,i.shape[0],i.shape[1],a.shape[1],o);return n.makeTensorInfo(a.shape,"int32",c)}const gve={kernelName:OP,backendName:"cpu",kernelFunc:mve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(r){const{inputs:t,backend:n}=r,{condition:s,t:i,e:a}=t;Dt([s,i,a],"select");const o=s.shape.length,u=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=$i(i.dtype,a.dtype),f=Us(Je(i.shape),h);let p=0;const g=o===0||o>1||i.shape.length===1?1:Je(i.shape.slice(1));for(let y=0;y<u.length;y++)for(let x=0;x<g;x++)u[y]===1?f[p++]=l[y]:f[p++]=c[y];return n.makeTensorInfo(i.shape,h,f)}const xve={kernelName:l2,backendName:"cpu",kernelFunc:yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bve=A2,vve=I2,wve=Hn(m0,r=>r>=0?vve*r:bve*(Math.exp(r)-1)),Sve={kernelName:m0,backendName:"cpu",kernelFunc:wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cve=Hn(x0,r=>r<0?-1:r>0?1:0),_ve={kernelName:x0,backendName:"cpu",kernelFunc:Cve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eve=Hn(g0,r=>Math.sin(r)),Dve={kernelName:g0,backendName:"cpu",kernelFunc:Eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tve=Hn(y0,r=>Math.sinh(r)),Nve={kernelName:y0,backendName:"cpu",kernelFunc:Tve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kve=11920928955078125e-23,SM=Math.log(kve)+2,Ave=Hn(v0,r=>{const t=r>-SM,n=r<SM,s=Math.exp(r);let i;return n?i=s:t?i=r:i=Math.log(1+s),i}),Ive={kernelName:v0,backendName:"cpu",kernelFunc:Ave};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ve(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockShape:a,paddings:o}=s;Dt([i],"spaceToBatchND");const u=Je(a),l=[[0,0]];l.push(...o);for(let I=1+a.length;I<i.shape.length;++I)l.push([0,0]);const c=VG.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),h=R0(c.shape,a,u,!1),f=O0(h.length,a.length,!1),p=M0(c.shape,a,u,!1),x=lr({inputs:{x:c},backend:n,attrs:{shape:h}}),w=di({inputs:{x},backend:n,attrs:{perm:f}}),D=lr({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(w),D}const Fve={kernelName:f2,backendName:"cpu",kernelFunc:$ve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(r){const{inputs:t,backend:n}=r,{indices:s,values:i,denseShape:a,defaultValue:o}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const u=n.data.get(s.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,h=n.data.get(o.dataId).values[0],[f,p,g,y,x]=dG(u,s.shape,s.dtype,l,i.dtype,c,h);return[n.makeTensorInfo(p,s.dtype,f),n.makeTensorInfo([p[0]],i.dtype,g),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),n.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const Ove={kernelName:MP,backendName:"cpu",kernelFunc:Rve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mve(r){const{inputs:t,backend:n}=r,{inputIndices:s,inputShape:i,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.data.get(i.dataId).values),u=n.data.get(s.dataId).values,l=Array.from(n.data.get(a.dataId).values),[c,h,f]=pG(u,s.shape,s.dtype,o,l);return[n.makeTensorInfo(h,s.dtype,c),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const Lve={kernelName:LP,backendName:"cpu",kernelFunc:Mve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bve(r){const{inputs:t,backend:n}=r,{data:s,indices:i,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[c,h]=yk(o,s.shape,s.dtype,u,l,!0);return n.makeTensorInfo(h,s.dtype,c)}const Pve={kernelName:BP,backendName:"cpu",kernelFunc:Bve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vve(r){const{inputs:t,backend:n}=r,{data:s,indices:i,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,u=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[c,h]=yk(o,s.shape,s.dtype,u,l);return n.makeTensorInfo(h,s.dtype,c)}const zve={kernelName:PP,backendName:"cpu",kernelFunc:Vve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uve(r){const{inputs:t,backend:n,attrs:s}=r,{sparseIndices:i,sparseValues:a,defaultValue:o}=t,{outputShape:u}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:f,outputSize:p}=k0(a,i,u),g=!1,y=n.bufferSync(i);let x;switch(a.dtype){case"bool":{const v=n.bufferSync(a),S=!!n.data.get(o.dataId).values[0];x=Vf(y,v,u,p,h,c,l,f,S,g);break}case"float32":{const v=n.bufferSync(a),S=n.data.get(o.dataId).values[0];x=Vf(y,v,u,p,h,c,l,f,S,g);break}case"int32":{const v=n.bufferSync(a),S=n.data.get(o.dataId).values[0];x=Vf(y,v,u,p,h,c,l,f,S,g);break}case"string":{const v=n.bufferSync(a),S=Fl(n.data.get(o.dataId).values[0]);x=Vf(y,v,u,p,h,c,l,f,S,g);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(u,x.dtype,x.values)}const Gve={kernelName:VP,backendName:"cpu",kernelFunc:Uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{numOrSizeSplits:a,axis:o}=s,u=dn(o,i.shape)[0],l=VN(i,a,u),c=new Array(i.shape.length).fill(0),h=i.shape.slice();return l.map(f=>{const p=[...h];p[u]=f;const g=fh({inputs:{x:i},backend:n,attrs:{begin:c,size:p}});return c[u]+=f,g})}const Wve={kernelName:d2,backendName:"cpu",kernelFunc:jve};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hve={kernelName:E3,backendName:"cpu",kernelFunc:({inputs:r,backend:t})=>{const{x:n}=r,s=t;Dt(n,"square");const i=s.data.get(n.dataId).values,a=new Float32Array(i.length);for(let u=0;u<i.length;++u){const l=i[u];a[u]=l*l}return{dataId:s.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qve=Hn(T0,(r,t)=>{const n=t;return isNaN(r)?NaN:r>0?1:n.alpha}),Kve={kernelName:T0,backendName:"cpu",kernelFunc:qve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xve(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{begin:a,end:o,strides:u,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s;Dt(i,"stridedSlice");const{finalShapeSparse:g,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:S,begin:w,end:E,strides:_}=V3(i.shape,a,o,u,l,c,h,f,p);let D;if(x)D=lr({inputs:{x:i},backend:n,attrs:{shape:y}});else if(v||S){oe(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const I=L3(w,E,_),k=fh({inputs:{x:i},backend:n,attrs:{begin:w,size:I}});D=lr({inputs:{x:k},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(k)}else{const I=n.bufferSync(i),k=gG(g,I,_,w);D=n.makeTensorInfo(y,k.dtype,k.values)}return D}const Yve={kernelName:D3,backendName:"cpu",kernelFunc:Xve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zve(r){const{inputs:t,backend:n,attrs:s}=r,{separator:i,nGramWidths:a,leftPad:o,rightPad:u,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:f}=t,p=n.data.get(h.dataId).values,g=n.data.get(f.dataId).values,[y,x]=yG(p,g,i,a,o,u,l,c);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(f.shape,"int32",x)]}const Qve={kernelName:zP,backendName:"cpu",kernelFunc:Zve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(r){const{inputs:t,backend:n,attrs:s}=r,{skipEmpty:i}=s,{input:a,delimiter:o}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const u=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values[0],[c,h,f]=xG(u,l,i),p=h.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const e2e={kernelName:UP,backendName:"cpu",kernelFunc:Jve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t2e(r){const{inputs:t,backend:n,attrs:s}=r,{numBuckets:i}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(a.dataId).values,u=bG(o,i);return n.makeTensorInfo(a.shape,"int32",u)}const n2e={kernelName:GP,backendName:"cpu",kernelFunc:t2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r2e=Hn(_0,r=>Math.tan(r)),s2e={kernelName:_0,backendName:"cpu",kernelFunc:r2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i2e=Hn(E0,r=>Math.tanh(r)),a2e={kernelName:E0,backendName:"cpu",kernelFunc:i2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o2e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{reps:a}=s;Dt(i,"tile");const o=wG(n.bufferSync(i),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const u2e={kernelName:D0,backendName:"cpu",kernelFunc:o2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l2e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{k:a,sorted:o}=s;Dt(i,"topk");const u=n.data.get(i.dataId).values,[l,c]=CG(u,i.shape,i.dtype,a,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const c2e={kernelName:T3,backendName:"cpu",kernelFunc:l2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2e(r){const{inputs:t,attrs:n,backend:s}=r,{image:i,transforms:a}=t,{interpolation:o,fillMode:u,fillValue:l,outputShape:c}=n,[h,f,p,g]=i.shape,[y,x]=c??[f,p],v=[h,y,x,g],S=Mt(i.shape),w=S[0],E=S[1],_=S[2],D=Mt(v),I=D[0],k=D[1],A=D[2],N=As(i.dtype,Je(v));N.fill(l);const F=s.data.get(i.dataId).values,$=s.data.get(a.dataId).values;for(let M=0;M<h;++M){const B=a.shape[0]===1?$:$.subarray(M*8,M*8+8);for(let U=0;U<y;++U)for(let V=0;V<x;++V)for(let Z=0;Z<g;++Z){let J;const ne=B[6]*V+B[7]*U+1;if(ne===0)continue;const z=(B[0]*V+B[1]*U+B[2])/ne,X=(B[3]*V+B[4]*U+B[5])/ne,Y=CM(z,p,u),se=CM(X,f,u);switch(o){case"nearest":J=y2e(F,f,p,w,E,_,M,se,Y,Z,l);break;case"bilinear":J=x2e(F,f,p,w,E,_,M,se,Y,Z,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ue=M*I+U*k+V*A+Z;N[ue]=J}return s.makeTensorInfo(v,i.dtype,N)}return{dataId:s.write(N,v,i.dtype),shape:i.shape,dtype:i.dtype}}const f2e={kernelName:N3,backendName:"cpu",kernelFunc:h2e};function CM(r,t,n){switch(n){case"reflect":return d2e(r,t);case"wrap":return p2e(r,t);case"nearest":return g2e(r,t);case"constant":default:return m2e(r)}}function d2e(r,t){let n=r;if(n<0)if(t<=1)n=0;else{const s=2*t;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-t?n+s:-n-1}else if(n>t-1)if(t<=1)n=0;else{const s=2*t;n-=s*Math.trunc(n/s),n>=t&&(n=s-n-1)}return nh(0,n,t-1)}function p2e(r,t){let n=r;if(n<0)if(t<=1)n=0;else{const s=t-1;n+=t*(Math.trunc(-n/s)+1)}else if(n>t-1)if(t<=1)n=0;else{const s=t-1;n-=t*Math.trunc(n/s)}return nh(0,n,t-1)}function m2e(r,t){return r}function g2e(r,t){return nh(0,r,t-1)}function _m(r,t,n,s,i,a,o,u,l,c,h){const f=o*s+u*i+l*a+c;return 0<=u&&u<t&&0<=l&&l<n?r[f]:h}function y2e(r,t,n,s,i,a,o,u,l,c,h){const f=Math.round(u),p=Math.round(l);return _m(r,t,n,s,i,a,o,f,p,c,h)}function x2e(r,t,n,s,i,a,o,u,l,c,h){const f=Math.floor(u),p=Math.floor(l),g=f+1,y=p+1,x=(y-l)*_m(r,t,n,s,i,a,o,f,p,c,h)+(l-p)*_m(r,t,n,s,i,a,o,f,y,c,h),v=(y-l)*_m(r,t,n,s,i,a,o,g,p,c,h)+(l-p)*_m(r,t,n,s,i,a,o,g,y,c,h);return(g-u)*x+(u-f)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2e(r){const{inputs:t,attrs:n,backend:s}=r,{axis:i}=n,{x:a}=t;Dt(a,"unique");const o=s.data.get(a.dataId).values,{outputValues:u,outputShape:l,indices:c}=_G(o,i,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,u),s.makeTensorInfo([c.length],"int32",c)]}const v2e={kernelName:k3,backendName:"cpu",kernelFunc:b2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w2e(r){const{inputs:t,backend:n,attrs:s}=r,{value:i}=t;let{axis:a}=s;a<0&&(a+=i.shape.length);const o=i.shape.length,u=i.shape[a],l=new Array(o-1);let c=0;for(let g=0;g<o;g++)g!==a&&(l[c++]=i.shape[g]);const h=new Array(o).fill(0),f=i.shape.slice();f[a]=1;const p=new Array(u);for(let g=0;g<p.length;g++){h[a]=g;const y=fh({inputs:{x:i},backend:n,attrs:{begin:h,size:f}});p[g]=lr({inputs:{x:y},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(y)}return p}const S2e={kernelName:m2,backendName:"cpu",kernelFunc:w2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C2e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,segmentIds:a}=t,{numSegments:o}=s;Dt(i,"unsortedSegmentSum");const u=i.shape.length,l=a.shape.length,c=[],h=[],f=u-l;let p=a;for(let y=0;y<f;++y){const x=yb({inputs:{input:p},backend:n,attrs:{dim:y+1}});p=x,h.push(x)}for(let y=0;y<o;++y){const x=Ul(y,"int32"),v=n.makeTensorInfo([],"int32",x),S=UU({inputs:{a:v,b:p},backend:n}),w=Bl({inputs:{x:S},backend:n,attrs:{dtype:"float32"}}),E=G2({inputs:{a:w,b:i},backend:n}),_=j0({inputs:{x:E},backend:n,attrs:{axis:0,keepDims:!1}});c.push(_),h.push(v),h.push(S),h.push(w),h.push(E),h.push(_)}const g=PG({inputs:c,backend:n,attrs:{axis:0}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const _2e={kernelName:g2,backendName:"cpu",kernelFunc:C2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E2e=[S1e,u0e,_1e,D1e,p0e,N1e,A1e,$1e,R1e,M1e,B1e,V1e,U1e,W1e,q1e,Y1e,Q1e,eye,nye,v1e,sye,aye,uye,cye,f0e,g0e,fye,l0e,pye,gye,yye,bye,wye,Cye,Eye,Tye,kye,Iye,Fye,Oye,Lye,Pye,zye,Uye,jye,Hye,Kye,Xye,Yye,Zye,exe,d1e,nxe,y0e,cxe,x0e,hxe,v0e,yxe,xxe,vxe,S0e,Cxe,Exe,Txe,kxe,Ixe,_0e,D0e,c0e,Fxe,mye,Oxe,Lxe,Pxe,p1e,N0e,A0e,zxe,$0e,Gxe,Hxe,Kxe,Zxe,Jxe,tbe,nbe,R0e,sbe,abe,ube,cbe,fbe,pbe,gbe,M0e,xbe,wbe,_be,B0e,V0e,Tbe,Abe,Fbe,U0e,Obe,Lbe,Bbe,VG,Ube,g1e,W0e,jbe,Hbe,Kbe,h0e,aD,Ybe,y1e,x1e,b1e,Qbe,eve,nve,sve,ave,ove,lve,J0e,hve,gve,xve,Sve,t1e,_ve,Dve,Nve,n1e,Sbe,Ive,Fve,Ove,Lve,Pve,zve,Gve,Wve,i1e,Hve,o1e,Kve,Yve,Qve,e2e,n2e,h1e,Qye,s2e,a2e,u2e,c2e,f2e,G0e,v2e,S2e,_2e,Mbe];for(const r of E2e)WP(r);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ac={},Uy={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function D2e(r,t){Ac[r]=t}function io(r,t){if(!(r in Ac)||t!=null){const s=N2e(r,t);if(s!==null)Ac[r]=s;else return console.log("Could not get context for WebGL version",r),null}const n=Ac[r];return n==null||n.isContextLost()?(delete Ac[r],io(r)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ac[r])}function T2e(r){if(typeof OffscreenCanvas<"u"&&r===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function N2e(r,t){if(r!==1&&r!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=t??T2e(r);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Ac[r]},!1),Ke().getBool("SOFTWARE_WEBGL_ENABLED")&&(Uy.failIfMajorPerformanceCaveat=!1),r===1?n.getContext("webgl",Uy)||n.getContext("experimental-webgl",Uy):n.getContext("webgl2",Uy)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gg;(function(r){r[r.DENSE=0]="DENSE",r[r.SHARED_BATCH=1]="SHARED_BATCH"})(gg||(gg={}));var Ki;(function(r){r[r.RENDER=0]="RENDER",r[r.UPLOAD=1]="UPLOAD",r[r.PIXELS=2]="PIXELS",r[r.DOWNLOAD=3]="DOWNLOAD"})(Ki||(Ki={}));var ks;(function(r){r[r.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",r[r.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",r[r.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",r[r.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",r[r.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ks||(ks={}));function W0(r,t){return[t,r]}function k2e(r,t){return r*t}function Gy(r){const t=Je(r),n=Math.ceil(t/4);return EE(n)}function Yd(r,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(r/2))]}function A2e(r,t){const[n,s]=Yd(r,t);return n*s*4}function Sk(r,t){const n=r;let s,i,a,o,u,l,c,h,f,p;return Ke().getNumber("WEBGL_VERSION")===2?(s=n.R32F,i=n.R16F,a=n.RGBA16F,o=n.RGBA32F,u=n.RED,c=4,h=1,f=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(s=r.RGBA,i=r.RGBA,a=r.RGBA,o=n.RGBA,u=r.RGBA,c=4,h=4,f=t!=null?t.HALF_FLOAT_OES:null,p=r.FLOAT,l=r.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:u,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:h,textureTypeHalfFloat:f,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tt(r,t){const n=t();return Ke().getBool("DEBUG")&&I2e(r),n}function I2e(r){const t=r.getError();if(t!==r.NO_ERROR)throw new Error("WebGL Error: "+O2e(r,t))}const $2e=596e-10,F2e=65504;function R2e(r){return!!(Ke().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||r===0||$2e<Math.abs(r)&&Math.abs(r)<F2e)}function O2e(r,t){switch(t){case r.NO_ERROR:return"NO_ERROR";case r.INVALID_ENUM:return"INVALID_ENUM";case r.INVALID_VALUE:return"INVALID_VALUE";case r.INVALID_OPERATION:return"INVALID_OPERATION";case r.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case r.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case r.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function jy(r,t){return Fu(r,()=>r.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function M2e(r,t){const n=Fu(r,()=>r.createShader(r.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Tt(r,()=>r.shaderSource(n,t)),Tt(r,()=>r.compileShader(n)),r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw console.log(r.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function L2e(r,t){const n=Fu(r,()=>r.createShader(r.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Tt(r,()=>r.shaderSource(n,t)),Tt(r,()=>r.compileShader(n)),Ke().get("ENGINE_COMPILE_ONLY"))return n;if(r.getShaderParameter(n,r.COMPILE_STATUS)===!1)throw zG(t,r.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const B2e=/ERROR: [0-9]+:([0-9]+):/g;function zG(r,t){const n=B2e.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(r);return}const s=+n[1],i=r.split(`
`),a=i.length.toString().length+2,o=i.map((f,p)=>Zf((p+1).toString(),a)+f);let u=0;for(let f=0;f<o.length;f++)u=Math.max(o[f].length,u);const l=o.slice(0,s-1),c=o.slice(s-1,s),h=o.slice(s);console.log(l.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${Zf(c[0],u)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function P2e(r){return Fu(r,()=>r.createProgram(),"Unable to create WebGLProgram.")}function V2e(r,t){if(Tt(r,()=>r.linkProgram(t)),!Ke().get("ENGINE_COMPILE_ONLY")&&r.getProgramParameter(t,r.LINK_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function b_(r,t){if(Tt(r,()=>r.validateProgram(t)),r.getProgramParameter(t,r.VALIDATE_STATUS)===!1)throw console.log(r.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function z2e(r,t){const n=Fu(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Tt(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),Tt(r,()=>r.bufferData(r.ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function U2e(r,t){const n=Fu(r,()=>r.createBuffer(),"Unable to create WebGLBuffer");return Tt(r,()=>r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n)),Tt(r,()=>r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,r.STATIC_DRAW)),n}function G2e(r){return Fu(r,()=>r.createTexture(),"Unable to create WebGLTexture.")}function j2e(r,t){const n=Ke().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(r<=0||t<=0){const s=`[${r}x${t}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(r>n||t>n){const s=`[${r}x${t}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+i+".")}}function W2e(r){return Fu(r,()=>r.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function _M(r,t,n,s,i,a,o){const u=r.getAttribLocation(t,n);return u===-1?!1:(Tt(r,()=>r.bindBuffer(r.ARRAY_BUFFER,s)),Tt(r,()=>r.vertexAttribPointer(u,i,r.FLOAT,!1,a,o)),Tt(r,()=>r.enableVertexAttribArray(u)),!0)}function H2e(r,t,n){Z2e(r,n),Tt(r,()=>r.activeTexture(r.TEXTURE0+n)),Tt(r,()=>r.bindTexture(r.TEXTURE_2D,t))}function q2e(r,t,n){return Fu(r,()=>r.getUniformLocation(t,n),'uniform "'+n+'" not present in program.')}function K2e(r,t,n){return r.getUniformLocation(t,n)}function X2e(r,t,n,s){Tt(r,()=>H2e(r,t,s)),Tt(r,()=>r.uniform1i(n,s))}function v_(r,t,n){Tt(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,n)),Tt(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0))}function EM(r,t){Tt(r,()=>r.bindFramebuffer(r.FRAMEBUFFER,t)),Tt(r,()=>r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0))}function Wy(r){const t=r.checkFramebufferStatus(r.FRAMEBUFFER);if(t!==r.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Y2e(r,t))}function Y2e(r,t){switch(t){case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case r.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function Fu(r,t,n){const s=Tt(r,()=>t());if(s==null)throw new Error(n);return s}function Z2e(r,t){const n=r.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=t+r.TEXTURE0;if(s<r.TEXTURE0||s>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Td(r,t=2){return Je(r.slice(0,r.length-t))}function Nd(r){if(r.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[r.length>1?r[r.length-2]:1,r[r.length-1]]}function w_(r){let t=[1,1,1];return r.length===0||r.length===1&&r[0]===1||(t=[Td(r),...Nd(r)]),t}function Q2e(r,t=!1){let n=Ke().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=Ke().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&Ke().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),t&&(n=n*2,s=s*2,r=r.map((u,l)=>l>=r.length-2?jT(r[l]):r[l]),r.length===1&&(r=[2,r[0]])),r.length!==2&&(r=zl(r).newShape);let i=Je(r),a=null;r.length<=1&&i<=n?a=[1,i]:r.length===2&&r[0]<=n&&r[1]<=n?a=r:r.length===3&&r[0]*r[1]<=n&&r[2]<=n?a=[r[0]*r[1],r[2]]:r.length===3&&r[0]<=n&&r[1]*r[2]<=n?a=[r[0],r[1]*r[2]]:r.length===4&&r[0]*r[1]*r[2]<=n&&r[3]<=n?a=[r[0]*r[1]*r[2],r[3]]:r.length===4&&r[0]<=n&&r[1]*r[2]*r[3]<=n&&(a=[r[0],r[1]*r[2]*r[3]]);const o=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||o)if(t){const u=Td(r);let l=2,c=2;r.length&&([l,c]=Nd(r)),i=u*(l/2)*(c/2),a=EE(i).map(h=>h*2)}else a=EE(i);return a}function Hy(r){return r%2===0}function bb(r,t){if(r=r.slice(-2),t=t.slice(-2),Bn(r,t)||!r.length||!t.length||r[0]===0||r[1]===0||t[0]===0||t[1]===0)return!0;if(r.length!==t.length){const n=r.slice(-1)[0],s=t.slice(-1)[0];if(n===s||Hy(n)&&Hy(s)&&(r[0]===1||t[0]===1))return!0}return r[1]===t[1]&&Hy(r[0])&&Hy(t[0])}let S_,C_;function J2e(r){if(S_==null){const t=io(r);S_=t.getParameter(t.MAX_TEXTURE_SIZE)}return S_}function ewe(r){if(C_==null){const t=io(r);C_=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,C_)}function twe(r){if(r===0)return 0;let t;const n=io(r);return Ta(n,"EXT_disjoint_timer_query_webgl2")&&r===2?t=2:Ta(n,"EXT_disjoint_timer_query")?t=1:t=0,t}function Ta(r,t){return r.getExtension(t)!=null}function DM(r){try{if(io(r)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function nwe(r){if(r===0)return!1;const t=io(r);if(r===1){if(!Ta(t,"OES_texture_float"))return!1}else if(!Ta(t,"EXT_color_buffer_float"))return!1;return uD(t)}function rwe(r){if(r===0)return!1;const t=io(r);if(r===1){if(!Ta(t,"OES_texture_float")||!Ta(t,"WEBGL_color_buffer_float"))return!1}else{if(Ta(t,"EXT_color_buffer_float"))return uD(t);const s="EXT_color_buffer_half_float";if(Ta(t,s)){const i=t.getExtension(s);return swe(t,i)}return!1}return uD(t)}function uD(r){const t=Sk(r),n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const o=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(n),r.deleteFramebuffer(a),o}function swe(r,t){const n=Sk(r,t),s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);const u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(s),r.deleteFramebuffer(o),u}function iwe(r){return r!==2?!1:io(r).fenceSync!=null}function H0(r,t){Array.isArray(r)||(r=[r]),r.forEach(n=>{n!=null&&oe(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $t=Ke();$t.registerFlag("HAS_WEBGL",()=>$t.getNumber("WEBGL_VERSION")>0);$t.registerFlag("WEBGL_VERSION",()=>DM(2)?2:DM(1)?1:0);$t.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);$t.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>$t.get("WEBGL_VERSION")===2);$t.registerFlag("WEBGL_CPU_FORWARD",()=>!0);$t.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);$t.registerFlag("WEBGL_PACK",()=>$t.getBool("HAS_WEBGL"));$t.registerFlag("WEBGL_PACK_NORMALIZATION",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_CLIP",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_PACK_REDUCE",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_LAZILY_UNPACK",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_CONV_IM2COL",()=>$t.getBool("WEBGL_PACK"));$t.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>J2e($t.getNumber("WEBGL_VERSION")));$t.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>ewe($t.getNumber("WEBGL_VERSION")));$t.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const r=$t.getNumber("WEBGL_VERSION");return r===0?0:twe(r)});$t.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>$t.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!t7());$t.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>nwe($t.getNumber("WEBGL_VERSION")));$t.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>$t.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:$t.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));$t.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>rwe($t.getNumber("WEBGL_VERSION")));$t.registerFlag("WEBGL_FENCE_API_ENABLED",()=>iwe($t.getNumber("WEBGL_VERSION")));$t.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>$t.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);$t.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${r}.`)});$t.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>t7()?1:-1,r=>{if(r<0&&r!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${r}.`)});$t.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);$t.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);$t.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);$t.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);$t.registerFlag("WEBGL_EXP_CONV",()=>!1);$t.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>$t.getBool("IS_TEST"));$t.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);$t.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);$t.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(){let r,t,n,s,i,a,o,u,l,c;return Ke().getNumber("WEBGL_VERSION")===2?(r="#version 300 es",t="in",n="out",s="in",i="texture",a="outputColor",o="out vec4 outputColor;",u=Ke().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(r="",t="attribute",n="varying",s="varying",i="texture2D",a="gl_FragColor",o="",u=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:r,attribute:t,varyingVs:n,varyingFs:s,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:u,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ah(r,t,n="index"){const s=Mt(t);return s.map((i,a)=>{const o=`int ${r[a]} = ${n} / ${i}`,u=a===s.length-1?`int ${r[a+1]} = ${n} - ${r[a]} * ${i}`:`index -= ${r[a]} * ${i}`;return`${o}; ${u};`}).join("")}function j2(r,t,n="index"){const s=Mt(t);return s.map((i,a)=>{const o=`int ${r[a]} = ${n} / outShapeStrides[${a}]`,u=a===s.length-1?`int ${r[a+1]} = ${n} - ${r[a]} * outShapeStrides[${a}]`:`index -= ${r[a]} * outShapeStrides[${a}]`;return`${o}; ${u};`}).join("")}function awe(r,t){const n=r.length,s=r.map(a=>`${t}[${a}]`),i=new Array(n-1);i[n-2]=s[n-1];for(let a=n-3;a>=0;--a)i[a]=`(${i[a+1]} * ${s[a+1]})`;return i}function owe(r,t,n="index"){const s=r.map((a,o)=>o),i=awe(s,t);return i.map((a,o)=>{const u=`int ${r[o]} = ${n} / ${i[o]}`,l=o===i.length-1?`int ${r[o+1]} = ${n} - ${r[o]} * ${i[o]}`:`index -= ${r[o]} * ${i[o]}`;return`${u}; ${l};`}).join("")}function Ck(r){const t=Mt(r).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function _k(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const UG=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:GG}=fde;function uwe(r,t,n){const s=[];if(r.forEach(g=>{const y=Je(g.shapeInfo.logicalShape);if(g.shapeInfo.isUniform?s.push(`uniform float ${g.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${g.name};`),s.push(`uniform int offset${g.name};`)),n.enableShapeUniforms){const{uniformShape:x}=Ek(n.packedInputs,g.shapeInfo.logicalShape,g.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${g.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${g.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${g.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${g.name}Shape;`);break}s.push(`uniform ivec2 ${g.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(g=>{s.push(`uniform ${g.type} ${g.name}${g.arrayIndex?`[${g.arrayIndex}]`:""};`)});const i=s.join(`
`),a=r.map(g=>lwe(g,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=t.texShape,u=ni(),l=fwe(u);let c,h,f=mwe(u);return t.isPacked?(c=cwe(t.logicalShape,o,n.enableShapeUniforms),h=pwe(u)):(c=hwe(t.logicalShape,o,n.enableShapeUniforms),h=dwe(u)),n.packedInputs&&(f+=bwe),[f,l,h,i,c,a,n.userCode].join(`
`)}function Zd(r,t=!1){const n=r.shapeInfo.logicalShape;switch(n.length){case 0:return Iwe(r,t);case 1:return Fwe(r,t);case 2:return Owe(r,t);case 3:return Lwe(r,t);case 4:return Pwe(r,t);case 5:return Vwe(r);case 6:return zwe(r);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function jG(r,t){switch(r.shapeInfo.logicalShape.length){case 0:return Awe(r);case 1:return $we(r,t);case 2:return Rwe(r,t);case 3:return Mwe(r,t);default:return Bwe(r,t)}}function lwe(r,t,n=!1,s){let i="";n?i+=jG(r,s):i+=Zd(r,s);const a=r.shapeInfo.logicalShape,o=t.logicalShape;return a.length<=o.length&&(n?i+=Uwe(r,t):i+=Gwe(r,t)),i}function cwe(r,t,n){switch(r.length){case 0:return WG();case 1:return vwe(r,t,n);case 2:return Nwe(r,t,n);case 3:return Swe(r,t,n);default:return _we(r,t,n)}}function hwe(r,t,n){switch(r.length){case 0:return WG();case 1:return wwe(r,t,n);case 2:return kwe(r,t,n);case 3:return Cwe(r,t,n);case 4:return Ewe(r,t,n);case 5:return Dwe(r,t);case 6:return Twe(r,t);default:throw new Error(`${r.length}-D output sampling is not yet supported`)}}function fwe(r){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${r.texture2D}(textureSampler, uv).r;
    }
  `}function dwe(r){return`
    void setOutput(float val) {
      ${r.output} = vec4(val, 0, 0, 0);
    }
  `}function pwe(r){return`
    void setOutput(vec4 val) {
      ${r.output} = val;
    }
  `}function mwe(r){return`${r.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${r.varyingFs} vec2 resultUV;
    ${r.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${r.defineSpecialNaN}
    ${r.defineSpecialInf}
    ${r.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${gwe}
    ${ywe}
    ${xwe}
  `}const gwe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ywe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,xwe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,bwe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function WG(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function vwe(r,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function wwe(r,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function Swe(r,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(r[2]/2),a=i*Math.ceil(r[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function Cwe(r,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${j2(["r","c","d"],r)}
    return ivec3(r, c, d);
  }
`;const s=Ah(["r","c","d"],r);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function _we(r,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(r[r.length-1]/2),a=i*Math.ceil(r[r.length-2]/2);let o=a,u="",l="b, r, c";for(let c=2;c<r.length-1;c++)o*=r[r.length-c-1],u=`
      int b${c} = index / ${o};
      index -= b${c} * ${o};
    `+u,l=`b${c}, `+l;return`
    ivec${r.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${u}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${r.length}(${l});
    }
  `}function Ewe(r,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${j2(["r","c","d","d2"],r)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Ah(["r","c","d","d2"],r);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Dwe(r,t){const n=Ah(["r","c","d","d2","d3"],r);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Twe(r,t){const n=Ah(["r","c","d","d2","d3","d4"],r);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Nwe(r,t,n){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Bn(r,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const i=Math.ceil(r[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function kwe(r,t,n){return Bn(r,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:r[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:r[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${r[1]};
      int c = index - r * ${r[1]};
      return ivec2(r, c);
    }
  `}function Ih(r){return`offset${r}`}function Awe(r){const t=r.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),s=ni();return`
    vec4 ${n}() {
      return ${s.texture2D}(${t}, halfCR);
    }
  `}function Iwe(r,t){const n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[i,a]=r.shapeInfo.texShape;if(i===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Ih(n);if(t)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[u,l]=r.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${u}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function $we(r,t){const n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=r.shapeInfo.texShape,a=ni();if(t)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function Fwe(r,t){const n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(r.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Qd(r)}
      }
    `;const i=r.shapeInfo.texShape,a=i[0],o=i[1];if(o===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const u=Ih(n);return o===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${u}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${u}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${u}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${u}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${u});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${o}, index + ${u});
      return sampleTexture(${n}, uv);
    }
  `}function Rwe(r,t){const n=r.shapeInfo.logicalShape,s=r.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),a=r.shapeInfo.texShape,o=a[0],u=a[1],l=ni();if(a!=null&&Bn(n,a))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${u}.0, ${o}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],h=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Owe(r,t){const n=r.shapeInfo.logicalShape,s=r.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),a=r.shapeInfo.texShape;if(a!=null&&Bn(n,a)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=a[0],g=a[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${g}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:u}=zl(n),l=o;if(l.length<n.length){const p=Jd(r,l),g=["row","col"];return`
      ${Zd(p,t)}
      float ${i}(int row, int col) {
        return ${i}(${ep(g,u)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Qd(r)}
      }
    `;const c=a[0],h=a[1],f=Ih(s);return h===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${c}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function Mwe(r,t){const n=r.shapeInfo.logicalShape,s=r.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),a=r.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const p=n.slice(1),g=[1,2],y=Jd(r,p),x=["b","row","col"];return`
        ${jG(y,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${ep(x,g)});
        }
      `}const u=ni();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `;const l=o[0],c=o[1],h=Math.ceil(n[2]/2),f=h*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${f}, ${h}, b, row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `}function Lwe(r,t){const n=r.shapeInfo.logicalShape,s=r.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[1]*n[2],o=n[2],{newShape:u,keptDims:l}=zl(n),c=u;if(c.length<n.length){const x=Jd(r,c),v=["row","col","depth"];return`
        ${Zd(x,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${ep(v,l)});
        }
      `}if(r.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${o}, 1)));
        ${Qd(r)}
      }
    `;const h=r.shapeInfo.texShape,f=h[0],p=h[1],g=r.shapeInfo.flatOffset;if(p===a&&g==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===o&&g==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=Ih(s);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${o} + depth + ${y};
        vec2 uv = uvFromFlat(${f}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function Bwe(r,t){const n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=ni();if(t)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const a=r.shapeInfo.logicalShape,o=a.length,u=r.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],c=l[0],h=l[1],f=Math.ceil(a[o-1]/2);let p=f*Math.ceil(a[o-2]/2),g="int b, int row, int col",y=`b * ${p} + (row / 2) * ${f} + (col / 2)`;for(let x=2;x<o-1;x++)g=`int b${x}, `+g,p*=a[o-x-1],y=`b${x} * ${p} + `+y;return`
    vec4 ${s}(${g}) {
      int index = ${y};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${c});
      return ${i.texture2D}(${n}, uv);
    }
  `}function Pwe(r,t){const n=r.shapeInfo.logicalShape,s=r.name,i="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[3],o=n[2]*a,u=n[1]*o,{newShape:l,keptDims:c}=zl(n);if(l.length<n.length){const w=Jd(r,l),E=["row","col","depth","depth2"];return`
      ${Zd(w,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${ep(E,c)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${u}, ${o}, ${a}, 1)));
        ${Qd(r)}
      }
    `;const h=r.shapeInfo.flatOffset,f=r.shapeInfo.texShape,p=f[0],g=f[1],y=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(g===u&&h==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${y}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(g===a&&h==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const S=Ih(s);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${S});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${o} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${g}, index + ${S});
      return sampleTexture(${s}, uv);
    }
  `}function Vwe(r){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],a=t[3]*i,o=t[2]*a,u=t[1]*o,{newShape:l,keptDims:c}=zl(t);if(l.length<t.length){const x=Jd(r,l),v=["row","col","depth","depth2","depth3"];return`
      ${Zd(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${ep(v,c)});
      }
    `}if(r.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${o}, ${a}, ${i})) +
          depth3;
        ${Qd(r)}
      }
    `;const h=r.shapeInfo.flatOffset,f=r.shapeInfo.texShape,p=f[0],g=f[1];if(g===u&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=Ih(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${o} + depth * ${a} +
          depth2 * ${i} + depth3 + ${y};
      vec2 uv = uvFromFlat(${p}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function zwe(r){const t=r.shapeInfo.logicalShape,n=r.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=zl(t);if(i.length<t.length){const v=Jd(r,i),S=["row","col","depth","depth2","depth3","depth4"];return`
      ${Zd(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${ep(S,a)});
      }
    `}const o=t[5],u=t[4]*o,l=t[3]*u,c=t[2]*l,h=t[1]*c;if(r.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${c}, ${l}, ${u})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Qd(r)}
      }
    `;const f=r.shapeInfo.flatOffset,p=r.shapeInfo.texShape,g=p[0],y=p[1];if(y===h&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${u}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(y===o&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${g}.0);
        return sampleTexture(${n}, uv);
      }
    `;const x=Ih(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${c} + depth * ${l} +
          depth2 * ${u} + depth3 * ${o} + depth4 + ${x};
      vec2 uv = uvFromFlat(${g}, ${y}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Qd(r){const t=r.name,n=Je(r.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function Uwe(r,t){const n=r.name,s=n.charAt(0).toUpperCase()+n.slice(1),i="get"+s+"AtOutCoords",a=r.shapeInfo.logicalShape.length,o=t.logicalShape.length,u=GG(r.shapeInfo.logicalShape,t.logicalShape),l=cr(o),c=o-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":o<2&&u.length>=1?h="coords = 0;":h=u.map(w=>`coords.${f[w+c]} = 0;`).join(`
`);let p="";o<2&&a>0?p="coords":p=r.shapeInfo.logicalShape.map((w,E)=>`coords.${f[E+c]}`).join(", ");let g="return outputValue;";const x=Je(r.shapeInfo.logicalShape)===1,S=Je(t.logicalShape)===1;if(a===1&&!x&&!S)g=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!S)o===1?g=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:g=`
        return vec4(outputValue.x);
      `;else if(u.length){const w=a-2,E=a-1;u.indexOf(w)>-1&&u.indexOf(E)>-1?g="return vec4(outputValue.x);":u.indexOf(w)>-1?g="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(E)>-1&&(g="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${p});
      ${g}
    }
  `}function Gwe(r,t){const n=r.name,s=n.charAt(0).toUpperCase()+n.slice(1),i="get"+s+"AtOutCoords",a=t.texShape,o=r.shapeInfo.texShape,u=r.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!r.shapeInfo.isUniform&&u===l&&r.shapeInfo.flatOffset==null&&Bn(o,a))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=cr(l),h=GG(r.shapeInfo.logicalShape,t.logicalShape),f=l-u;let p;const g=["x","y","z","w","u","v"];u===0?p="":l<2&&h.length>=1?p="coords = 0;":p=h.map(x=>`coords.${g[x+f]} = 0;`).join(`
`);let y="";return l<2&&u>0?y="coords":y=r.shapeInfo.logicalShape.map((x,v)=>`coords.${g[v+f]}`).join(", "),`
    float ${i}() {
      ${c} coords = getOutputCoords();
      ${p}
      return get${s}(${y});
    }
  `}function cr(r){if(r<=1)return"int";if(r===2)return"ivec2";if(r===3)return"ivec3";if(r===4)return"ivec4";if(r===5)return"ivec5";if(r===6)return"ivec6";throw Error(`GPU for rank ${r} is not yet supported`)}function Ek(r,t,n){const{newShape:s,keptDims:i}=zl(t),a=t.length,o=r&&a===3&&t[0]===1,u=o?t.slice(1):s,l=!r&&a>1&&!Bn(t,n)&&s.length<a||o;return{useSqueezeShape:l,uniformShape:l?u:t,keptDims:i}}function Jd(r,t){const n=JSON.parse(JSON.stringify(r));return n.shapeInfo.logicalShape=t,n}function ep(r,t){return t.map(n=>r[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jwe(r,t,n,s){const i=n.map((h,f)=>{const p={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(p.flatOffset=h.texData.slice.flatOffset),{name:t.variableNames[f],shapeInfo:p}}),a=i.map(h=>h.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},u=uwe(i,o,t),l=L2e(r.gl,u),c=r.createProgram(l);return Ke().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:u,webGLProgram:c,inShapeInfos:a,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:l,source:u,webGLProgram:c,inShapeInfos:a,outShapeInfo:o},HG(r,t,c))}function HG(r,t,n){const s={},i={},a={},o=[];let u,l,c,h=null,f=null;f=r.getUniformLocation(n,"NAN",!1),Ke().getNumber("WEBGL_VERSION")===1&&(h=r.getUniformLocation(n,"INFINITY",!1));const p=!1;for(let g=0;g<t.variableNames.length;g++){const y=t.variableNames[g];s[y]=r.getUniformLocation(n,y,p),s[`offset${y}`]=r.getUniformLocation(n,`offset${y}`,p),t.enableShapeUniforms&&(i[`${y}Shape`]=r.getUniformLocation(n,`${y}Shape`,p),a[`${y}TexShape`]=r.getUniformLocation(n,`${y}TexShape`,p))}return t.enableShapeUniforms&&(u=r.getUniformLocation(n,"outShape",p),c=r.getUniformLocation(n,"outShapeStrides",p),l=r.getUniformLocation(n,"outTexShape",p)),t.customUniforms&&t.customUniforms.forEach((g,y)=>{o[y]=r.getUniformLocation(n,g.name,p)}),{uniformLocations:s,customUniformLocations:o,infLoc:h,nanLoc:f,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:u,outShapeStridesLocation:c,outTexShapeLocation:l}}function TM(r,t){if(r.length!==t.length)throw Error(`Binary was compiled with ${r.length} inputs, but was executed with ${t.length} inputs`);r.forEach((n,s)=>{const i=n.logicalShape,a=t[s],o=a.shape;if(!Bn(i,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${o} must match`);if(n.isUniform&&a.isUniform)return;const u=n.texShape,l=a.isUniform?null:a.texData.texShape;if(!Bn(u,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${u} and ${l} must match`)})}function Wwe(r,t,n,s,i){t.program.enableShapeUniforms||(TM(t.inShapeInfos,n),TM([t.outShapeInfo],[s]));const a=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?r.setOutputPackedMatrixTexture(a.texture,o[0],o[1]):r.setOutputMatrixTexture(a.texture,o[0],o[1]),r.setProgram(t.webGLProgram),Ke().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&r.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&r.gl.uniform1f(t.nanLoc,NaN),n.forEach((l,c)=>{const h=t.program.variableNames[c],f=t.uniformLocations[h],p=t.uniformLocations[`offset${h}`],g=t.inShapesLocations[`${h}Shape`],y=t.inTexShapesLocations[`${h}TexShape`];if(g){const{uniformShape:x}=Ek(t.program.packedInputs,l.shape,l.texData.texShape);switch(x.length){case 1:r.gl.uniform1iv(g,new Int32Array(x));break;case 2:r.gl.uniform2iv(g,new Int32Array(x));break;case 3:r.gl.uniform3iv(g,new Int32Array(x));break;case 4:r.gl.uniform4iv(g,new Int32Array(x));break}}if(y&&r.gl.uniform2i(y,l.texData.texShape[0],l.texData.texShape[1]),f!=null){if(l.isUniform){if(Je(l.shape)<2)r.gl.uniform1f(f,l.uniformValues[0]);else{let x=l.uniformValues;x instanceof Float32Array||(x=new Float32Array(x)),r.gl.uniform1fv(f,x)}return}l.texData.slice!=null&&p!=null&&r.gl.uniform1i(p,l.texData.slice.flatOffset),r.setInputMatrixTexture(l.texData.texture.texture,f,c)}});const u=t.outShapeLocation;if(u)switch(s.shape.length){case 1:r.gl.uniform1iv(u,new Int32Array(s.shape));break;case 2:r.gl.uniform2iv(u,new Int32Array(s.shape));break;case 3:r.gl.uniform3iv(u,new Int32Array(s.shape));break;case 4:r.gl.uniform4iv(u,new Int32Array(s.shape));break}if(t.outShapeStridesLocation){const l=Mt(s.shape);switch(s.shape.length){case 2:r.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(l));break;case 3:r.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(l));break;case 4:r.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(l));break}}t.outTexShapeLocation&&r.gl.uniform2i(t.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),t.program.customUniforms&&i&&t.program.customUniforms.forEach((l,c)=>{const h=t.customUniformLocations[c],f=i[c];if(l.type==="float")r.gl.uniform1fv(h,f);else if(l.type==="vec2")r.gl.uniform2fv(h,f);else if(l.type==="vec3")r.gl.uniform3fv(h,f);else if(l.type==="vec4")r.gl.uniform4fv(h,f);else if(l.type==="int")r.gl.uniform1iv(h,f);else if(l.type==="ivec2")r.gl.uniform2iv(h,f);else if(l.type==="ivec3")r.gl.uniform3iv(h,f);else if(l.type==="ivec4")r.gl.uniform4iv(h,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}),r.executeProgram()}function Hwe(r,t,n){let s="";t.concat(n).forEach(o=>{const u=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(r.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:c,uniformShape:h,keptDims:f}=Ek(r.packedInputs,o.shape,l);let p="",g="",y="";if(h.length===1&&r.packedInputs){const D=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${D[0]>1}_${D[1]>1}`}else if(h.length===2&&!r.packedInputs)g=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!r.packedInputs){const D=Mt(h);y=`${D[0]===l[1]}_${D[D.length-1]===l[1]}`}const x=o.shape.length,v=h.length===2&&Bn(o.shape,l),S=Je(o.shape)===1,w=bd(o.shape,n.shape),E=!r.packedInputs&&x===n.shape.length&&Bn(l,n.texData.texShape),_=r.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${x}_${E}_${c?f:""}_${h.length}_${S}_${w}_${v}_${p}_${g}_${y}_${_}_${u}`}else{const l=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${l}_${u}`}});const i=r.userCode;let a=r.constructor.name;return a+="_"+s+"_"+i+`${Ke().getNumber("WEBGL_VERSION")}`,a}function ri(r){return Ke().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&r<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qwe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=gg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ni();this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?j2(["r","c","d"],t):Ah(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kwe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=gg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ni();this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?j2(["r","c","d"],t):Ah(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xwe{constructor(t){this.variableNames=["A"],this.outTexUsage=Ki.DOWNLOAD;const n=ni();this.outputShape=t,this.userCode=`
      ${UG}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ywe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ki.DOWNLOAD;const n=ni();this.outputShape=t,this.userCode=`
      ${UG}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zwe{constructor(t,n=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ni();this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length);let i="result";n&&(i="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?_k():Ck(t)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${s.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${s.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qwe{constructor(t,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ni();this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length);let i="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let u=0;u<=1;u++){const l=o*2+u;i+=`
          localCoords = coords;
          if(localCoords[2] + ${u} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${u};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?_k():Ck(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jwe(r){const t=ni(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return M2e(r,n)}function eSe(r){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return z2e(r,t)}function tSe(r){const t=new Uint16Array([0,1,2,2,1,3]);return U2e(r,t)}function q0(r,t,n,s,i,a){j2e(t,n);const o=G2e(r),u=r.TEXTURE_2D;return Tt(r,()=>r.bindTexture(u,o)),Tt(r,()=>r.texParameteri(u,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE)),Tt(r,()=>r.texParameteri(u,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE)),Tt(r,()=>r.texParameteri(u,r.TEXTURE_MIN_FILTER,r.NEAREST)),Tt(r,()=>r.texParameteri(u,r.TEXTURE_MAG_FILTER,r.NEAREST)),Ke().getNumber("WEBGL_VERSION")===1?Tt(r,()=>r.texImage2D(u,0,s,t,n,0,i,a,null)):Tt(r,()=>r.texStorage2D(u,1,s,t,n)),Tt(r,()=>r.bindTexture(r.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function qG(r){return r.internalFormatFloat}function nSe(r,t,n,s){const[i,a]=W0(t,n);return q0(r,i,a,qG(s),s.textureFormatFloat,r.FLOAT)}function KG(r){return r.internalFormatHalfFloat}function rSe(r,t,n,s){const[i,a]=W0(t,n);return q0(r,i,a,KG(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function XG(r){return r.downloadTextureFormat}function sSe(r,t,n,s){const[i,a]=W0(t,n);return q0(r,i,a,XG(s),r.RGBA,r.UNSIGNED_BYTE)}function YG(r){return r.internalFormatPackedFloat}function iSe(r,t,n,s){const[i,a]=Yd(t,n);return q0(r,i,a,YG(s),r.RGBA,r.FLOAT)}function ZG(r){return r.internalFormatPackedHalfFloat}function aSe(r,t,n,s){const[i,a]=Yd(t,n);return q0(r,i,a,ZG(s),r.RGBA,s.textureTypeHalfFloat)}function oSe(r,t,n){return Tt(r,()=>r.bindBuffer(r.ARRAY_BUFFER,n)),_M(r,t,"clipSpacePos",n,3,20,0)&&_M(r,t,"uv",n,2,20,12)}function uSe(r,t,n,s,i,a){Tt(r,()=>r.bindTexture(r.TEXTURE_2D,t));let o,u,l;i instanceof Uint8Array?(o=new Uint8Array(n*s*4),u=r.UNSIGNED_BYTE,l=r.RGBA):(o=new Float32Array(n*s*4),u=r.FLOAT,l=a.internalFormatPackedFloat),o.set(i),Ke().getNumber("WEBGL_VERSION")===2?Tt(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,n,s,r.RGBA,u,o)):Tt(r,()=>r.texImage2D(r.TEXTURE_2D,0,l,n,s,0,r.RGBA,u,o)),Tt(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function lSe(r,t,n){Tt(r,()=>r.bindTexture(r.TEXTURE_2D,t)),n.data instanceof Uint8Array?Ke().getNumber("WEBGL_VERSION")===2?Tt(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,n.width,n.height,r.RGBA,r.UNSIGNED_BYTE,n.data)):Tt(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n.width,n.height,0,r.RGBA,r.UNSIGNED_BYTE,n.data)):Ke().getNumber("WEBGL_VERSION")===2?Tt(r,()=>r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,n)):Tt(r,()=>r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,n)),Tt(r,()=>r.bindTexture(r.TEXTURE_2D,null))}function cSe(r,t,n,s){const i=r.createBuffer();Tt(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,i));const u=4*4*t*n;return Tt(r,()=>r.bufferData(r.PIXEL_PACK_BUFFER,u,r.STREAM_READ)),Tt(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,0)),Tt(r,()=>r.bindBuffer(r.PIXEL_PACK_BUFFER,null)),i}function hSe(r,t,n){const s=r,i=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,i),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),i}function fSe(r,t,n,s){const[i,a]=W0(t,n),o=4,u=new Uint8Array(k2e(t*n,o));return Tt(r,()=>r.readPixels(0,0,i,a,s.downloadTextureFormat,r.UNSIGNED_BYTE,u)),new Float32Array(u.buffer)}function dSe(r,t,n,s,i,a,o,u){const l=r,c=new Float32Array(A2e(a,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function pSe(r,t,n){const s=new Float32Array(t*n*4);return Tt(r,()=>r.readPixels(0,0,n,t,r.RGBA,r.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class __{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=Ke().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,D2e(n,t)):this.gl=io(n);let s="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Ke().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=jy(this.gl,a),Ta(this.gl,o))this.textureHalfFloatExtension=jy(this.gl,o);else if(Ke().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Ta(this.gl,i))this.colorBufferHalfFloatExtension=jy(this.gl,i);else if(Ke().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Ta(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Ta(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=eSe(this.gl),this.indexBuffer=tSe(this.gl),this.framebuffer=W2e(this.gl),this.textureConfig=Sk(this.gl,this.textureHalfFloatExtension)}get debug(){return Ke().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;Tt(t,()=>t.finish()),Tt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),Tt(t,()=>t.deleteFramebuffer(this.framebuffer)),Tt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),Tt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),Tt(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,n){return this.throwIfDisposed(),nSe(this.gl,t,n,this.textureConfig)}createFloat16MatrixTexture(t,n){return this.throwIfDisposed(),rSe(this.gl,t,n,this.textureConfig)}createUnsignedBytesMatrixTexture(t,n){return this.throwIfDisposed(),sSe(this.gl,t,n,this.textureConfig)}uploadPixelDataToTexture(t,n){this.throwIfDisposed(),lSe(this.gl,t,n)}uploadDenseMatrixToTexture(t,n,s,i){this.throwIfDisposed(),uSe(this.gl,t,n,s,i,this.textureConfig)}createFloat16PackedMatrixTexture(t,n){return this.throwIfDisposed(),aSe(this.gl,t,n,this.textureConfig)}createPackedMatrixTexture(t,n){return this.throwIfDisposed(),iSe(this.gl,t,n,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(EM(this.gl,this.framebuffer),this.outputTexture=null),Tt(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,n,s){return this.downloadMatrixDriver(t,()=>fSe(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(t,n,s,i,a,o){return dSe(this.gl,t,n,s,i,a,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,n){return hSe(this.gl,t,n)}createBufferFromTexture(t,n,s){this.bindTextureToFrameBuffer(t);const i=cSe(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let n,s;if(Ke().getBool("WEBGL_FENCE_API_ENABLED")){const i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),s=()=>{const o=i.clientWaitSync(a,0,0);return o===i.ALREADY_SIGNALED||o===i.CONDITION_SATISFIED},n=a}else Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(t,n,s){return this.downloadMatrixDriver(t,()=>pSe(this.gl,n,s))}createProgram(t){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Jwe(n));const s=P2e(n);return Tt(n,()=>n.attachShader(s,this.vertexShader)),Tt(n,()=>n.attachShader(s,t)),V2e(n,s),this.debug&&b_(n,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=oSe(n,this.program,this.vertexBuffer)),s}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&Tt(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&b_(this.gl,this.program),Tt(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,n,s=!0){return this.throwIfDisposed(),s?q2e(this.gl,t,n):K2e(this.gl,t,n)}getAttributeLocation(t,n){return this.throwIfDisposed(),Tt(this.gl,()=>this.gl.getAttribLocation(t,n))}getUniformLocationNoThrow(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)}setInputMatrixTexture(t,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),X2e(this.gl,t,n,s)}setOutputMatrixTexture(t,n,s){this.setOutputMatrixTextureDriver(t,s,n)}setOutputPackedMatrixTexture(t,n,s){this.throwIfDisposed();const[i,a]=Yd(n,s);this.setOutputMatrixTextureDriver(t,i,a)}setOutputMatrixWriteRegion(t,n,s,i){this.setOutputMatrixWriteRegionDriver(s,t,i,n)}setOutputPackedMatrixWriteRegion(t,n,s,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&b_(this.gl,this.program),Wy(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),Tt(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Tt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=jy(this.gl,Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(i.TIME_ELAPSED_EXT,a),a}const t=this.getQueryTimerExtensionWebGL1(),n=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n}endQuery(){if(Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await dO(()=>this.disposed||this.isQueryAvailable(t,Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(t,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,n){if(n===0)return!0;if(n===2){const s=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),i=s.getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(t){return new Promise(n=>{this.addItemToPoll(()=>t.isFencePassed(),()=>n())})}pollItems(){const t=mSe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=t;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,n){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in Ke().platform&&(s=Ke().platform.setTimeoutCustom.bind(Ke().platform)),dO(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),v_(this.gl,t,this.framebuffer),this.debug&&Wy(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(v_(this.gl,this.outputTexture,this.framebuffer),this.debug&&Wy(this.gl)):EM(this.gl,this.framebuffer)}downloadMatrixDriver(t,n){this.bindTextureToFrameBuffer(t);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(t,n,s){this.throwIfDisposed();const i=this.gl;v_(i,t,this.framebuffer),this.debug&&Wy(i),this.outputTexture=t,Tt(i,()=>i.viewport(0,0,n,s)),Tt(i,()=>i.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(t,n,s,i){this.throwIfDisposed(),Tt(this.gl,()=>this.gl.scissor(t,n,s,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function mSe(r){let t=0;for(;t<r.length&&r[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:gSe,bincountImpl:QG,bincountReduceImpl:ySe,castImpl:xSe,ceilImpl:bSe,concatImpl:vSe,equalImpl:wSe,expImpl:SSe,expm1Impl:CSe,floorImpl:_Se,gatherNdImpl:ESe,gatherV2Impl:DSe,greaterImpl:TSe,greaterEqualImpl:NSe,lessImpl:kSe,lessEqualImpl:ASe,linSpaceImpl:ISe,logImpl:$Se,maxImpl:FSe,maximumImpl:RSe,minimumImpl:OSe,multiplyImpl:MSe,negImpl:LSe,notEqualImpl:BSe,prodImpl:PSe,raggedGatherImpl:VSe,raggedTensorToTensorImpl:zSe,rangeImpl:USe,rsqrtImpl:GSe,scatterImpl:jSe,sigmoidImpl:WSe,simpleAbsImpl:JG,sliceImpl:HSe,sparseFillEmptyRowsImpl:qSe,sparseReshapeImpl:KSe,sparseSegmentReductionImpl:ej,sqrtImpl:XSe,stridedSliceImpl:YSe,stringNGramsImpl:ZSe,stringSplitImpl:QSe,stringToHashBucketFastImpl:JSe,subImpl:eCe,tileImpl:tCe,topKImpl:nCe,transposeImpl:Dk,uniqueImpl:rCe}=f1e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(r,t){return["x","y","z","w","u","v"].slice(0,t).map(n=>`${r}.${n}`)}function Qs(r,t){return t===1?[r]:tj(r,t)}function sCe(r,t){if(r===1)return"rc";let n="";for(let s=0;s<r;s++)n+=t[s],s<r-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iCe{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=ri(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Qs("rc",this.rank),s=cr(this.rank),i=this.getOutOfBoundsCondition(n),a=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(t){const n=[];for(let s=0;s<=1;s++)for(let i=0;i<=1;i++){let a=`${s===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)a=`${t[t.length-1-o]},`+a;n.push(a)}return n}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${t[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(t){if(this.rank===1)return"";const n=t.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${i};
    `}getOutput(t){const n=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nj{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length);let s="";for(let i=0;i<4;i++){let a="thisRC = rc;";i%2===1&&(a+="thisRC.z += 1;"),i>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${aCe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?_k():Ck(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${s}

        setOutput(result);
      }
    `}}function aCe(r,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?owe(["r","c","d"],"inputShape"):Ah(["r","c","d"],r)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oCe{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,n,s){const i=kM(n,s),a=AM(t,i,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const o=NM(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[a].shift();return this.usedTextures[a].push(l),l}let u;return i===ks.PACKED_2X2_FLOAT32?u=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===ks.PACKED_2X2_FLOAT16?u=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===ks.UNPACKED_FLOAT32?u=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===ks.UNPACKED_FLOAT16?u=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===ks.PACKED_4X1_UNSIGNED_BYTE&&(u=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(u),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),u}releaseTexture(t,n,s,i){if(this.freeTextures==null)return;const a=kM(s,i),o=AM(n,a,i);o in this.freeTextures||(this.freeTextures[o]=[]);const u=NM(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=Ke().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=u):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=u),this.numUsedTextures--;const c=this.usedTextures[o],h=c.indexOf(t);if(h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(h,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function uCe(r,t){const n=r;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===r.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function NM(r,t,n,s,i){const a=lCe(t,s);let o;if(i){const[l,c]=Yd(r[0],r[1]);o=l*c}else{const[l,c]=W0(r[0],r[1]);o=l*c}const u=uCe(n,a);return o*u}function lCe(r,t){switch(r){case ks.PACKED_2X2_FLOAT32:return YG(t);case ks.PACKED_2X2_FLOAT16:return ZG(t);case ks.UNPACKED_FLOAT32:return qG(t);case ks.UNPACKED_FLOAT16:return KG(t);case ks.PACKED_4X1_UNSIGNED_BYTE:return XG(t);default:throw new Error(`Unknown physical texture type ${r}`)}}function cCe(r){return Ke().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?r?ks.PACKED_2X2_FLOAT32:ks.UNPACKED_FLOAT32:r?ks.PACKED_2X2_FLOAT16:ks.UNPACKED_FLOAT16}function kM(r,t){if(r===Ki.UPLOAD)return ks.PACKED_2X2_FLOAT32;if(r===Ki.RENDER||r==null)return cCe(t);if(r===Ki.DOWNLOAD||r===Ki.PIXELS)return ks.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${r}`)}function AM(r,t,n){return`${r[0]}_${r[1]}_${t}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gu{constructor(t,n){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const La="if (isnan(x)) return x;",hCe="return x;",IM="return abs(x);",fCe="return (x >= 0.0) ? x : (exp(x) - 1.0);",dCe=La+`
  return (x < 0.0) ? 0.0 : x;
`,pCe=La+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Df="return x;",mCe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gCe="return x;",yCe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,xCe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,bCe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vCe="return 1.0 / (1.0 + exp(-1.0 * x));";class Fc{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wCe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length);const n=t.length,s=Qs("rc",n),i=cr(n),a=sCe(n,s),o=s.slice(-2),u=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${u}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SCe=Y7,CCe=1e-7,_Ce=1e-4,qy={};function ECe(r){return r in qy||(qy[r]={}),qy[r]}const DCe=Ke().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),TCe=600;function NCe(){return Ke().global.screen==null?1024:Ke().global.screen.height*Ke().global.screen.width*window.devicePixelRatio*TCe/1024/1024}class W2 extends GT{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Ke().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(t!=null){if(t instanceof __)n=t;else{const s=io(Ke().getNumber("WEBGL_VERSION"),t);n=new __(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=io(Ke().getNumber("WEBGL_VERSION"));n=new __(s),this.binaryCache=ECe(Ke().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new oCe(this.gpgpu),this.numMBBeforeWarning=NCe(),this.texData=new pP(this,ol())}nextDataId(){return W2.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(t,n,s){if((Ke().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Ke().getBool("DEBUG"))&&this.checkNumericalProblems(t),s==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:s,values:t,usage:Ki.UPLOAD,refCount:1}),i}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const n=this.texData.get(t);n.refCount++}decRef(t){if(this.texData.has(t)){const n=this.texData.get(t);n.refCount--}}move(t,n,s,i,a){if(Ke().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:s,dtype:i,values:n,usage:Ki.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const n=this.texData.get(t),{values:s,dtype:i,complexTensorInfos:a,slice:o,shape:u,isPacked:l}=n;if(o!=null){let p;l?p=new Fc(u,Df):p=new gu(u,Df);const g=this.runWebGLProgram(p,[{dataId:t,shape:u,dtype:i}],i),y=this.readSync(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(t);if(i==="string")return s;const c=this.activeTimers!=null;let h;c&&(h=oi());let f;if(i==="complex64"){const p=this.readSync(a.real.dataId),g=this.readSync(a.imag.dataId);f=Eu(p,g)}else f=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=oi()-h),this.convertAndCacheOnCPU(t,f)}async read(t){if(this.pendingRead.has(t)){const y=this.pendingRead.get(t);return new Promise(x=>y.push(x))}const n=this.texData.get(t),{values:s,shape:i,slice:a,dtype:o,complexTensorInfos:u,isPacked:l}=n;if(a!=null){let y;l?y=new Fc(i,Df):y=new gu(i,Df);const x=this.runWebGLProgram(y,[{dataId:t,shape:i,dtype:o}],o),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(t);if(Ke().getBool("DEBUG")&&!Ke().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Ke().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,h;if(o!=="complex64"&&Ke().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(t);const y=this.texData.get(h.dataId);c=this.gpgpu.createBufferFromTexture(y.texture.texture,...Gy(i))}this.pendingRead.set(t,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(o==="complex64"){const y=await Promise.all([this.read(u.real.dataId),this.read(u.imag.dataId)]),x=y[0],v=y[1];f=Eu(x,v)}else if(c==null)f=this.getValuesFromTexture(t);else{const y=Je(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(c,y)}if(h!=null&&this.disposeIntermediateTensorInfo(h),c!=null){const y=this.gpgpu.gl;Tt(y,()=>y.deleteBuffer(c))}const p=this.convertAndCacheOnCPU(t,f),g=this.pendingRead.get(t);return this.pendingRead.delete(t),g.forEach(y=>y(p)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&ol().removeDataId(t,this),this.pendingDeletes--),p}readToGPU(t,n={}){const s=this.texData.get(t),{values:i,shape:a,slice:o,dtype:u,isPacked:l,texture:c}=s;if(u==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let g;l?g=new Fc(a,Df):g=new gu(a,Df);const y=this.runWebGLProgram(g,[{dataId:t,shape:a,dtype:u}],u),x=this.readToGPU(y,n);return this.disposeIntermediateTensorInfo(y),x}if(c==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(t,n.customTexShape),f=ol().makeTensorFromTensorInfo(h),p=this.texData.get(h.dataId);return Object.assign({tensorRef:f},p.texture)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(i=>Fl(i));return hn(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return hn(t.shape,t.dtype,n)}checkNumericalProblems(t){if(t!=null)for(let n=0;n<t.length;n++){const s=t[n];if(!R2e(s))throw Ke().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:n,dtype:s,isPacked:i}=this.texData.get(t),a=Je(n);if(Ke().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(t),g=this.texData.get(p.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(g.texture.texture,...Gy(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),y}const o=Ke().getBool("WEBGL_PACK")&&i===!0,u=o?w_(n):n,l=o?new Ywe(u):new Xwe(u),c=this.runWebGLProgram(l,[{shape:u,dtype:s,dataId:t}],"float32"),h=this.texData.get(c.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),f}timerAvailable(){return Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const n=this.activeTimers,s=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=s,i=!0):this.activeTimers.push(s),this.activeTimers=s,t();const a=gd(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=gd(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);u.kernelMs=zae(l),u.getExtraProfileInfo=()=>l.map((c,h)=>({name:o[h],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else u.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,u})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:oi(),endMs:null}}endTimer(t){return Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=oi(),t)}async getQueryTime(t){if(Ke().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const n=t;return n.endMs-n.startMs}disposeData(t,n=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(n?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!n&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:s}=this.texData.get(t);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:n,dtype:s,texShape:i,usage:a,isPacked:o,slice:u}=this.texData.get(t),l=u&&u.origDataId||t,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,s),this.textureManager.releaseTexture(n,i,a,o)));const h=this.texData.get(t);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,n=DCe){return Ke().getBool("WEBGL_CPU_FORWARD")&&t.every(s=>this.texData.get(s.dataId).texture==null&&Je(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(t){Hi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=t.dataSync();return SCe(t.shape,n)}packedUnaryOp(t,n,s){const i=new Fc(t.shape,n),a=this.compileAndRun(i,[t],s);return ol().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const i=JG(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,i)}if(Ke().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,IM,t.dtype);const n=new gu(t.shape,IM),s=this.compileAndRun(n,[t]);return ol().makeTensorFromTensorInfo(s)}makeTensorInfo(t,n,s){let i;if(n==="string"&&s!=null&&s.length>0&&Ig(s[0])){const a=s.map(o=>El(o));i=this.write(a,t,n)}else i=this.write(s,t,n);return this.texData.get(i).usage=null,{dataId:i,shape:t,dtype:n}}makeOutput(t,n,s){return ol().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,s),this)}unpackTensor(t){const n=new wCe(t.shape);return this.runWebGLProgram(n,[t],t.dtype)}packTensor(t){const n=new iCe(t.shape);return this.runWebGLProgram(n,[t],t.dtype,null,!0)}packedReshape(t,n){const s=[Td(t.shape),...Nd(t.shape)],i={dtype:t.dtype,shape:s,dataId:t.dataId},a=[Td(n),...Nd(n)],o=new nj(a,s),u=!0,l=[s],c=this.runWebGLProgram(o,[i],t.dtype,l,u);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(t,n){const s=this.texData.get(t),{isPacked:i,shape:a,dtype:o}=s;if(n!=null){const p=Je(a),g=n[0]*n[1]*4;oe(p<=g,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const u=w_(a);let l;i?l=new Kwe(u):l=new qwe(u);const c=!0,h=[n??Gy(u)],f=this.runWebGLProgram(l,[{shape:u,dtype:o,dataId:t}],o,h,c,n);return{dtype:o,shape:a,dataId:f.dataId}}runWebGLProgram(t,n,s,i,a=!1,o){const u=this.makeTensorInfo(t.outputShape,s),l=this.texData.get(u.dataId);if(t.packedOutput&&(l.isPacked=!0),t.outPackingScheme===gg.DENSE){const S=o??Gy(t.outputShape);l.texShape=S.map(w=>w*2)}if(t.outTexUsage!=null&&(l.usage=t.outTexUsage),Je(u.shape)===0)return l.values=As(u.dtype,0),u;const c=[],h=n.map(S=>{if(S.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let w=this.texData.get(S.dataId);if(w.texture==null){if(!t.packedInputs&&Je(S.shape)<=Ke().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:S.shape,texData:null,isUniform:!0,uniformValues:w.values};t.packedInputs&&(w.isPacked=!0,w.shape=S.shape)}if(this.uploadToGPU(S.dataId),!!w.isPacked!=!!t.packedInputs)S=w.isPacked?this.unpackTensor(S):this.packTensor(S),c.push(S),w=this.texData.get(S.dataId);else if(w.isPacked&&!bb(w.shape,S.shape)){const E=S,_=S.shape;S.shape=w.shape,S=this.packedReshape(S,_),c.push(S),w=this.texData.get(S.dataId),E.shape=_}return{shape:S.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);const f={shape:u.shape,texData:l,isUniform:!1},p=Hwe(t,h,f),g=this.getAndSaveBinary(p,()=>jwe(this.gpgpu,t,h,f)),y=this.activeTimers!=null;let x;y&&(x=this.startTimer()),Ke().get("ENGINE_COMPILE_ONLY")||Wwe(this.gpgpu,g,h,f,i),c.forEach(S=>this.disposeIntermediateTensorInfo(S)),y&&(x=this.endTimer(x),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(x)}));const v=Ke().get("WEBGL_FLUSH_THRESHOLD");if(v>0){const S=oi();S-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=S)}if(!Ke().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const S=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),S}return u}compileAndRun(t,n,s,i,a=!1){return s=s||n[0].dtype,this.runWebGLProgram(t,n,s,i,a)}getAndSaveBinary(t,n){return t in this.binaryCache||(this.binaryCache[t]=n()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Ke().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ue(()=>{if(!Ke().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Ke().getBool("DEBUG");Ke().set("DEBUG",!1);const n=this.abs(Ln(1e-8)).dataSync()[0];if(Ke().set("DEBUG",t),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?CCe:_Ce}uploadToGPU(t){const n=this.texData.get(t),{shape:s,dtype:i,values:a,texture:o,usage:u,isPacked:l}=n;if(o!=null)return;const c=this.activeTimers!=null;let h;c&&(h=oi());let f=n.texShape;if(f==null&&(f=Q2e(s,l),n.texShape=f),a!=null){const p=w_(s);let g,y=f[1],x=f[0];const v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!v)&&([y,x]=Yd(f[0],f[1])),l?g=new Qwe(p,v):g=new Zwe(p,v);const S=v?[x,y]:f,w=this.makeTensorInfo(S,i),E=this.texData.get(w.dataId);v?E.usage=Ki.PIXELS:E.usage=Ki.UPLOAD,E.texShape=S,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),y,x,a);const _=[[x,y]],I=this.runWebGLProgram(g,[w],i,_,!0),k=this.texData.get(I.dataId);n.texShape=k.texShape,n.isPacked=k.isPacked,n.usage=k.usage,Ke().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(n.texture=k.texture,n.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(w),c&&(this.uploadWaitMs+=oi()-h)}else{const p=this.acquireTexture(f,u,i,l);n.texture=p}}convertAndCacheOnCPU(t,n){const s=this.texData.get(t),{dtype:i}=s;return this.releaseGPUData(t),n!=null&&(s.values=kCe(n,i)),s.values}acquireTexture(t,n,s,i){if(this.numBytesInGPU+=this.computeBytes(t,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,n,i)}computeBytes(t,n){return t[0]*t[1]*DE(n)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(n));return Promise.all(t)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(a){throw a}});t.push(s)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await J7(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(zG(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,t]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:s,infLoc:i,nanLoc:a,inShapesLocations:o,inTexShapesLocations:u,outShapeLocation:l,outShapeStridesLocation:c,outTexShapeLocation:h}=HG(this.gpgpu,t.program,t.webGLProgram);t.uniformLocations=n,t.customUniformLocations=s,t.infLoc=i,t.nanLoc=a,t.inShapesLocations=o,t.inTexShapesLocations=u,t.outShapeLocation=l,t.outShapeStridesLocation=c,t.outTexShapeLocation=h}}}W2.nextDataId=0;function kCe(r,t){if(t==="float32"||t==="complex64")return r;if(t==="int32"||t==="bool"){const n=t==="int32"?new Int32Array(r.length):new Uint8Array(r.length);for(let s=0;s<n.length;++s)n[s]=Math.round(r[s]);return n}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */n7()&&d7("webgl",()=>new W2,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tk=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class kd{constructor(t,n,s){this.variableNames=["A","B"],this.outputShape=nn(n,s),this.enableShapeUniforms=ri(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K0=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class X0{constructor(t,n,s,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=nn(n,s);const a=this.outputShape.length;this.enableShapeUniforms=ri(a);let o="";if(i)if(a===0||Je(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${cr(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Qs("coords",a);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mi(r){const{inputs:t,backend:n}=r,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const ACe={kernelName:Jg,backendName:"webgl",kernelFunc:Mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(r){const{inputs:t,backend:n}=r,{real:s,imag:i}=t,a=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(a.dataId),u=Mi({inputs:{x:s},backend:n}),l=Mi({inputs:{x:i},backend:n});return o.complexTensorInfos={real:u,imag:l},a}const ICe={kernelName:e3,backendName:"webgl",kernelFunc:Xl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rj="return (a < 0.) ? b * a : a;",sj=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function $Ce(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{alpha:a}=s,o=n.makeTensorInfo([],"float32",Ul(a,"float32")),u=Ke().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new X0(sj,i.shape,o.shape):new kd(rj,i.shape,o.shape),l=n.runWebGLProgram(u,[i,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const FCe={kernelName:Bv,backendName:"webgl",kernelFunc:$Ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ij="return (a < 0.) ? b * a : a;",aj=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function RCe(r){const{inputs:t,backend:n}=r,{x:s,alpha:i}=t,a=Ke().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new X0(aj,s.shape,i.shape):new kd(ij,s.shape,i.shape);return n.runWebGLProgram(a,[s,i],"float32")}const OCe={kernelName:r2,backendName:"webgl",kernelFunc:RCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tp="if (isnan(x)) return x;";function kn({opSnippet:r,packedOpSnippet:t,cpuKernelImpl:n,dtype:s}){return({inputs:i,backend:a})=>{const{x:o}=i,u=a,l=s||o.dtype;if(u.shouldExecuteOnCPU([o])&&n!=null){const f=u.texData.get(o.dataId),p=n(f.values,l);return u.makeTensorInfo(o.shape,l,p)}const c=Ke().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let h;return c?h=new Fc(o.shape,t):h=new gu(o.shape,r),u.runWebGLProgram(h,[o],l)}}function Fs({opSnippet:r,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:i,dtype:a}){return({inputs:o,backend:u})=>{const{a:l,b:c}=o,h=u;if(s&&l.dtype==="complex64"){const y=h.texData.get(l.dataId),x=h.texData.get(c.dataId),[v,S]=[[y.complexTensorInfos.real,x.complexTensorInfos.real],[y.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(E=>{const[_,D]=E,I={dataId:_.dataId,dtype:_.dtype,shape:l.shape},k={dataId:D.dataId,dtype:D.dtype,shape:c.shape},A=new kd(r,l.shape,c.shape);return h.runWebGLProgram(A,[I,k],$i(_.dtype,D.dtype))}),w=Xl({inputs:{real:v,imag:S},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(S),w}const f=a||$i(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||h.shouldExecuteOnCPU([l,c]))&&i!=null){const y=h.texData.get(l.dataId).values,x=h.texData.get(c.dataId).values,v=l.dtype==="string"?lh(y):y,S=l.dtype==="string"?lh(x):x,[w,E]=i(l.shape,c.shape,v,S,f),_=h.makeTensorInfo(E,f),D=h.texData.get(_.dataId);return D.values=w,_}const p=Ke().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let g;return p?g=new X0(t,l.shape,c.shape,n):g=new kd(r,l.shape,c.shape),h.runWebGLProgram(g,[l,c],f)}}function yg(r,t=!1){if(r==="linear")return t?gCe:hCe;if(r==="relu")return t?xCe:dCe;if(r==="elu")return t?yCe:fCe;if(r==="relu6")return t?bCe:pCe;if(r==="prelu")return t?aj:ij;if(r==="leakyrelu")return t?sj:rj;if(r==="sigmoid")return t?vCe:mCe;throw new Error(`Activation ${r} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oj{constructor(t,n,s,i=!1,a=!1,o=!1,u=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=ri(this.outputShape.length);const h=i?t[1]:t[2],f=Math.ceil(h/2),p=i?"i * 2, rc.y":"rc.y, i * 2",g=a?"rc.z, i * 2":"i * 2, rc.z",y=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",S="";u&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${u}
        }`:c?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${u}
        }`:v=`vec4 activation(vec4 x) {
          ${u}
        }`,S="result = activation(result);");const w=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let E="rc.x",_="rc.x";t[0]<n[0]?E=`int(min(float(rc.x), ${t[0]-1}.))`:n[0]<t[0]&&(_=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${f}; i++) {
          int batchA = ${E};
          int batchB = ${_};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${g});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${x[0]});
          result += (${y[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${w}

        ${S}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $M={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class FM{constructor(t,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=nn(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RM="return a * b;";function Nk(r){const{inputs:t,backend:n}=r,{a:s,b:i}=t,a=$i(s.dtype,i.dtype);if(s.dtype==="complex64"){const u=n.texData.get(s.dataId),l=n.texData.get(i.dataId),c=new FM($M.REAL,s.shape,i.shape),h=new FM($M.IMAG,s.shape,i.shape),f=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:s.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],p=n.runWebGLProgram(c,f,"float32"),g=n.runWebGLProgram(h,f,"float32"),y=Xl({inputs:{real:p,imag:g},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}if(n.shouldExecuteOnCPU([s,i])){const u=n.texData.get(s.dataId),l=n.texData.get(i.dataId),[c,h]=MSe(s.shape,i.shape,u.values,l.values,a),f=n.makeTensorInfo(h,a),p=n.texData.get(f.dataId);return p.values=c,f}let o;return Ke().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new X0(RM,s.shape,i.shape):o=new kd(RM,s.shape,i.shape),n.runWebGLProgram(o,[s,i],a)}const MCe={kernelName:u0,backendName:"webgl",kernelFunc:Nk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LCe(r,t,n){const s=[Td(r.shape),...Nd(r.shape)],i={dtype:r.dtype,shape:s,dataId:r.dataId},a=[Td(t),...Nd(t)],o=new nj(a,s),u=!0,l=[s],c=n.runWebGLProgram(o,[i],r.dtype,l,u);return{dataId:c.dataId,shape:t,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vt(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{shape:a}=s,o=n,u=Je(i.shape),l=gP(a,u),c=Je(l);oe(u===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${i.shape}) has ${u} elements. The new shape and old shape must have the same number of elements.`);const h=o.texData.get(i.dataId);return h.isPacked&&!bb(i.shape,l)&&!(h.texture!==null&&bb(h.shape,l))?LCe(i,l,o):(o.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const BCe={kernelName:i2,backendName:"webgl",kernelFunc:vt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OM{constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:i,inSize:a,outSize:o}=t;this.outputShape=[i,o];const u=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const f=1/n;c=`sumValue += dot(values * ${yd(f)?f.toPrecision(2):f}, ones);`}let h="";a%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${u};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PCe{constructor(t,n){this.variableNames=["x"];const{windowSize:s,batchSize:i,inSize:a,outSize:o}=t;this.outputShape=[i,o];let u="0.0",l="";n==="prod"?u="1.0":n==="min"?(u="1.0 / 1e-20",l="min"):n==="max"&&(u="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const h=Math.floor(s/4)*4,f=s%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,g="vec4";n==="all"?(u="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,g="bvec4"):n==="any"&&(u="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,g="bvec4");let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${u};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${u});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===2}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===3}) {
          ${g} values = ${g}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(r){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const n=t.length?t[t.length-1].outSize:r[1],s=k2(n);t.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return t}function $h(r,t,n,s){const i=VCe(r.shape);let a=r;for(let o=0;o<i.length;o++){const{inSize:u,windowSize:l,outSize:c}=i[o];let h,f;n==="mean"?h=o===0?new OM({windowSize:l,inSize:u,batchSize:r.shape[0],outSize:c},u):new OM({windowSize:l,inSize:u,batchSize:r.shape[0],outSize:c}):h=new PCe({windowSize:l,inSize:u,batchSize:r.shape[0],outSize:c},n),f=a,a=s.runWebGLProgram(h,[a],t),f.dataId!==r.dataId&&s.disposeIntermediateTensorInfo(f)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zCe{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let o=0;o<s.length;o++)s[o]=t[n[o]];this.outputShape=s,this.rank=s.length;const i=cr(this.rank),a=UCe(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function UCe(r){const t=r.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(t);for(let i=0;i<r.length;i++)s[r[i]]=n[i];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GCe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(t.length);for(let h=0;h<s.length;h++)s[h]=t[n[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=cr(this.rank),a=tj("rc",this.rank),o=new Array(this.rank);for(let h=0;h<n.length;h++)o[n[h]]=a[h];const u=`vec2(${o.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${u})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2(r,t,n){const s=Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new GCe(r.shape,t):new zCe(r.shape,t);return n.runWebGLProgram(s,[r],r.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(r,t,n,s){const i=t,a=r.shape.length,o=dn(i,r.shape);let u=o;const l=Dr(u,a),c=l!=null;let h=r;c&&(h=H2(r,l,s),u=Mr(u.length,a)),$s("sum",u,a);const[f,p]=bs(h.shape,u);let g=f;n&&(g=Hr(f,o));const y=Je(p),v=Je(r.shape)/y,S=vt({inputs:{x:h},attrs:{shape:[v,y]},backend:s}),w=I3(r.dtype),E=$h(S,w,"sum",s),_=vt({inputs:{x:E},attrs:{shape:g},backend:s});return s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(E),c&&s.disposeIntermediateTensorInfo(h),_}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s;return jCe(i,a,o,n)}const WCe={kernelName:h2,backendName:"webgl",kernelFunc:q2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{perm:a}=s,o=n,u=i.shape.length,l=new Array(u);for(let h=0;h<l.length;h++)l[h]=i.shape[a[h]];let c;if(o.shouldExecuteOnCPU([i])){const f=o.texData.get(i.dataId).values,p=Dk(f,i.shape,i.dtype,a,l);c=o.makeTensorInfo(l,i.dtype);const g=o.texData.get(c.dataId);g.values=p}else c=H2(i,a,o);return c}const HCe={kernelName:Qf,backendName:"webgl",kernelFunc:ti};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uj=1e3;function vb({a:r,b:t,transposeA:n,transposeB:s,backend:i,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:u=0,activation:l=null}){const c=r.shape.length,h=t.shape.length,f=n?r.shape[c-2]:r.shape[c-1],p=s?t.shape[h-1]:t.shape[h-2],g=n?r.shape[c-1]:r.shape[c-2],y=s?t.shape[h-2]:t.shape[h-1],x=r.shape.slice(0,-2),v=t.shape.slice(0,-2),S=Je(x),w=Je(v),_=nn(r.shape.slice(0,-2),t.shape.slice(0,-2)).concat([g,y]);oe(f===p,()=>`Error in matMul: inner shapes (${f}) and (${p}) of Tensors with shapes ${r.shape} and ${t.shape} and transposeA=${n} and transposeB=${s} must match.`);const D=n?[S,f,g]:[S,g,f],I=s?[w,y,p]:[w,p,y],k=vt({inputs:{x:r},backend:i,attrs:{shape:D}}),A=vt({inputs:{x:t},backend:i,attrs:{shape:I}}),N=[k,A],F=Math.max(S,w),$=n?k.shape[1]:k.shape[2],O=a!=null,M=o!=null,B=l==="leakyrelu",U=l!=null?yg(l,!0):null,V=O||M||B||U!=null;let Z;if((g===1||y===1)&&$>uj&&V===!1){let ne=k,z=A;n&&(ne=ti({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),N.push(ne)),s&&(z=ti({inputs:{x:A},backend:i,attrs:{perm:[0,2,1]}}),N.push(z));const X=y!==1,Y=y===1;let se=ne;X&&(se=vt({inputs:{x:ne},backend:i,attrs:{shape:[F,$,1]}}),N.push(se));const ue=y===1?2:1;let fe=z;Y&&(fe=vt({inputs:{x:z},backend:i,attrs:{shape:[F,1,$]}}),N.push(fe));const de=Nk({inputs:{a:se,b:fe},backend:i});Z=q2({inputs:{x:de},backend:i,attrs:{axis:ue,keepDims:!0}}),N.push(de)}else{const ne=$i(r.dtype,t.dtype),z=new oj(D,I,[F,g,y],n,s,O,U,M,B),X=[k,A];if(a!=null&&X.push(a),M&&X.push(o),B){const Y=i.makeTensorInfo([],"float32",Ul(u,"float32"));X.push(Y),N.push(Y)}Z=i.runWebGLProgram(z,X,ne)}const J=vt({inputs:{x:Z},backend:i,attrs:{shape:_}});N.push(Z);for(const ne of N)i.disposeIntermediateTensorInfo(ne);return J}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(r){const{inputs:t,backend:n,attrs:s}=r,{a:i,b:a,bias:o,preluActivationWeights:u}=t,{transposeA:l,transposeB:c,activation:h,leakyreluAlpha:f}=s;return vb({a:i,b:a,transposeA:l,transposeB:c,backend:n,bias:o,preluActivationWeights:u,leakyreluAlpha:f,activation:h})}const KCe={kernelName:Yx,backendName:"webgl",kernelFunc:qCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MM="return abs(x);";function XCe(r){const{inputs:t,backend:n}=r,{x:s}=t;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=n.texData.get(s.dataId),o=JG(a.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let i;return Ke().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Fc(s.shape,MM):i=new gu(s.shape,MM),n.runWebGLProgram(i,[s],s.dtype)}const YCe={kernelName:xv,backendName:"webgl",kernelFunc:XCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZCe=La+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,QCe=kn({opSnippet:ZCe}),JCe={kernelName:Fg,backendName:"webgl",kernelFunc:QCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_e=La+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,t_e=kn({opSnippet:e_e}),n_e={kernelName:Rg,backendName:"webgl",kernelFunc:t_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LM="return a + b;",r_e=Fs({opSnippet:LM,packedOpSnippet:LM,supportsComplex:!0,cpuKernelImpl:gSe}),s_e={kernelName:Ud,backendName:"webgl",kernelFunc:r_e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i_e{constructor(t,n){this.outputShape=[],this.outputShape=t,this.variableNames=n.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a_e{constructor(t,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dx(r){const{inputs:t,backend:n}=r,s=t;if(s.length===1)return Mi({inputs:{x:s[0]},backend:n});if(s.length>Ke().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=dx({inputs:s.slice(0,l),backend:n}),h=dx({inputs:s.slice(l),backend:n});return dx({inputs:[c,h],backend:n})}const i=s.map(l=>l.dtype).reduce((l,c)=>$i(l,c)),a=s.map(l=>l.shape),u=Ke().getBool("WEBGL_PACK")?new a_e(s[0].shape,a):new i_e(s[0].shape,a);return n.runWebGLProgram(u,s,i)}const o_e={kernelName:KT,backendName:"webgl",kernelFunc:dx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s,u=i.shape.length,l=dn(a,i.shape);let c=l;const h=Dr(c,u);let f=i;h!=null&&(f=ti({inputs:{x:i},backend:n,attrs:{perm:h}}),c=Mr(c.length,u)),$s("all",c,u);const[p,g]=bs(f.shape,c),y=Je(g),x=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),v=$h(x,x.dtype,"all",n);let S;if(o){const w=Hr(p,l);S=vt({inputs:{x:v},backend:n,attrs:{shape:w}})}else S=vt({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),h!=null&&n.disposeIntermediateTensorInfo(f),S}const l_e={kernelName:XT,backendName:"webgl",kernelFunc:u_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s,u=i.shape.length,l=dn(a,i.shape);let c=l;const h=Dr(c,u);let f=i;h!=null&&(f=ti({inputs:{x:i},backend:n,attrs:{perm:h}}),c=Mr(c.length,u)),$s("any",c,u);const[p,g]=bs(f.shape,c),y=Je(g),x=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),v=$h(x,x.dtype,"any",n);let S;if(o){const w=Hr(p,l);S=vt({inputs:{x:v},backend:n,attrs:{shape:w}})}else S=vt({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),h!=null&&n.disposeIntermediateTensorInfo(f),S}const h_e={kernelName:YT,backendName:"webgl",kernelFunc:c_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f_e{constructor(t,n,s){this.variableNames=["A"];const{windowSize:i,batchSize:a,outSize:o}=t;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];const u=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${u} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d_e{constructor(t,n,s,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,oe(t.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=t[t.length-1],o=Math.ceil(a/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");const u=this.outputShape,l=u.length,c=cr(l),h=Qs("coords",l);let f,p;if(o===1){p=l+1;const A=cr(p);f=`
        ${A} sourceLocR = ${A}(${h.join()}, 0);
        ++${h[l-1]};
        ${A} sourceLocG = ${A}(${h.join()}, 0);
        ++${h[l-2]};
        ${A} sourceLocA = ${A}(${h.join()}, 0);
        --${h[l-1]};
        ${A} sourceLocB = ${A}(${h.join()}, 0);
        --${h[l-2]};`}else p=l,f=`
        ${c} sourceLocR = coords;
        ++${h[l-1]};
        ${c} sourceLocG = coords;
        ++${h[l-2]};
        ${c} sourceLocA = coords;
        --${h[l-1]};
        ${c} sourceLocB = coords;
        --${h[l-2]};`;const g=["x","y","z","w","u","v"].slice(0,p),y="."+g[p-1],x=g.map(A=>"int "+A),v=Qs("sourceLocR",p-1).concat("inIdx.r"),S=Qs("sourceLocG",p-1).concat("inIdx.g"),w=Qs("sourceLocB",p-1).concat("inIdx.b"),E=Qs("sourceLocA",p-1).concat("inIdx.a"),_=s==="max"?"greaterThan":"lessThan",D=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${E.join()})));`,I=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${S.join()}) : 0.,
            hasNextRow ? getAChannel(${w.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${E.join()}) : 0.)`,k=i?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${g.join()}),
                                          vec2(${g.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${g.join()}),
                               vec2(${g.slice(-2).join()}));
      }
      ${k}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${u[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${u[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${D}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lj(r,t,n,s=null){let i=t.shape[0],a=t.shape[1];s!=null&&(i=s.shape[0],a=s.shape[1]);const o=k2(a),u={windowSize:o,inSize:a,batchSize:i,outSize:Math.ceil(a/o)},l=new f_e(u,n,s==null),c=[t];s!=null&&c.push(s);const h=r.runWebGLProgram(l,c,"int32");if(h.shape[1]===1)return h;const f=lj(r,t,n,h);return r.disposeIntermediateTensorInfo(h),f}function cj(r,t,n,s=null){const i=s!=null?s.shape:t.shape,a=i[i.length-1],o=k2(a),u=new d_e(i,o,n,s==null),l=s==null?[t]:[t,s],c=r.runWebGLProgram(u,l,"int32");if(c.shape.length===t.shape.length){const h=cj(r,t,n,c);return r.disposeIntermediateTensorInfo(c),h}return c}function hj(r,t,n,s){const i=[n];if($s("arg"+s.charAt(0).toUpperCase()+s.slice(1),i,t.shape.length),!Ke().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const a=[],o=r.texData.get(t.dataId),u=o!==null&&o.isPacked;let l=t;u&&(l=r.unpackTensor(t),a.push(l));const[c,h]=bs(l.shape,i),f=Je(h),p=vt({inputs:{x:l},backend:r,attrs:{shape:[-1,f]}});a.push(p);const g=lj(r,p,s);a.push(g);const y=vt({inputs:{x:g},backend:r,attrs:{shape:c}});return a.forEach(x=>r.disposeIntermediateTensorInfo(x)),y}return cj(r,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a}=s;let o=dn(a,i.shape);const u=Dr(o,i.shape.length);let l=i;const c=[];u!=null&&(l=ti({inputs:{x:i},backend:n,attrs:{perm:u}}),c.push(l),o=Mr(o.length,l.shape.length)),$s("argMax",[o[0]],l.shape.length);const h=hj(n,l,o[0],"max");return c.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const m_e={kernelName:bv,backendName:"webgl",kernelFunc:p_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a}=s;let o=dn(a,i.shape);const u=Dr(o,i.shape.length);let l=i;const c=[];u!=null&&(l=ti({inputs:{x:i},backend:n,attrs:{perm:u}}),c.push(l),o=Mr(o.length,l.shape.length)),$s("argMin",[o[0]],l.shape.length);const h=hj(n,l,o[0],"min");return c.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const y_e={kernelName:vv,backendName:"webgl",kernelFunc:g_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_e=La+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,b_e=kn({opSnippet:x_e}),v_e={kernelName:Og,backendName:"webgl",kernelFunc:b_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w_e=La+"return log(x + sqrt(x * x + 1.0));",S_e=kn({opSnippet:w_e}),C_e={kernelName:Mg,backendName:"webgl",kernelFunc:S_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __e=La+`
  return atan(x);
`,E_e=kn({opSnippet:__e}),D_e={kernelName:Lg,backendName:"webgl",kernelFunc:E_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_e=Tk+`
  return atan(a, b);
`,N_e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+K0+`
  return result;
`,k_e=Fs({opSnippet:T_e,packedOpSnippet:N_e}),A_e={kernelName:Pg,backendName:"webgl",kernelFunc:k_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_e=La+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,$_e=kn({opSnippet:I_e}),F_e={kernelName:Bg,backendName:"webgl",kernelFunc:$_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xg{constructor(t,n,s,i=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const x=n==="avg",v=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,S=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let w="0.0";if(x||(w="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec2 strides = ivec2(${u}, ${l});
        const ivec2 pads = ivec2(${g}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${A} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?a?v:S:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / count");const D=Math.floor(o/4)*4,I=o%4,k=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${u}, ${l});
      const ivec2 pads = ivec2(${g}, ${y});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${D}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${k}
          }

          int xC = xCCorner + ${D};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${k}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${k}
          }
        }
        setOutput(${_});
      }
    `}}class kk{constructor(t,n,s,i=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=t.filterWidth,u=t.strideDepth,l=t.strideHeight,c=t.strideWidth,h=t.dilationDepth,f=t.dilationHeight,p=t.dilationWidth,g=t.effectiveFilterDepth,y=t.effectiveFilterHeight,x=t.effectiveFilterWidth,v=t.padInfo.front,S=t.padInfo.top,w=t.padInfo.left;this.outputShape=t.outShape;const E=n==="avg";let _="0.0";if(E||(_="-1.0 / 1e-20"),s){const F=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${u}, ${l}, ${c});
        const ivec3 pads = ivec3(${v}, ${S}, ${w});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${g};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${F} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?a?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${y} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const D="max";let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(I="avgValue / count");const k=Math.floor(o/4)*4,A=o%4,N=`
      if (${E}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${D}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${u}, ${l}, ${c});
      const ivec3 pads = ivec3(${v}, ${S}, ${w});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${g};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${k}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${N}
            }

            int xC = xCCorner + ${k};
            if (${A===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${A===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${N}
            } else if (${A===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${N}
            }
          }
          setOutput(${I});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t;H0(i,"avgPool");const{filterSize:a,strides:o,pad:u,dimRoundingMode:l}=s,c=1;oe(Gs(o,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=Ra(i.shape,a,o,c,u,l);if(h.filterWidth===1&&h.filterHeight===1&&Bn(h.inShape,h.outShape))return Mi({inputs:{x:i},backend:n});const f=new xg(h,"avg",!1);return n.runWebGLProgram(f,[i],"float32")}const O_e={kernelName:wv,backendName:"webgl",kernelFunc:R_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{filterSize:a,strides:o,pad:u,dimRoundingMode:l,dataFormat:c}=s,h=[1,1,1],f=Iu(i.shape,a,o,h,u,l,c),p=new kk(f,"avg",!1);return n.runWebGLProgram(p,[i],"float32")}const L_e={kernelName:Sv,backendName:"webgl",kernelFunc:M_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B_e{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,i=t.strideHeight,a=t.strideWidth,o=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterHeight,c=t.effectiveFilterWidth,h=l-1-t.padInfo.top,f=c-1-t.padInfo.left,p=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${f});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${u}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class P_e{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,i=t.filterWidth,a=t.strideDepth,o=t.strideHeight,u=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,g=t.effectiveFilterWidth,y=f-1-t.padInfo.front,x=p-1-t.padInfo.top,v=g-1-t.padInfo.left,S=1/(n*s*i);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${x}, ${v});
      const float avgMultiplier = float(${S});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${g};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_e(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,o=a,{filterSize:u,strides:l,pad:c,dimRoundingMode:h}=s,f=[1,1,1],p=Iu(o.shape,u,l,f,c,h),g=new P_e(p);return n.runWebGLProgram(g,[i],o.dtype)}const z_e={kernelName:QT,backendName:"webgl",kernelFunc:V_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_e(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,o=a;H0([i,a],"avgPoolGrad");const{filterSize:u,strides:l,pad:c}=s,h=Ra(o.shape,u,l,1,c),f=new B_e(h);return n.runWebGLProgram(f,[i],o.dtype)}const G_e={kernelName:ZT,backendName:"webgl",kernelFunc:U_e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_e(r){const{inputs:t,backend:n,attrs:s}=r,{a:i,b:a}=t,{transposeA:o,transposeB:u}=s;return vb({a:i,b:a,transposeA:o,transposeB:u,backend:n})}const W_e={kernelName:Cv,backendName:"webgl",kernelFunc:j_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H_e{constructor(t,n,s,i,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],nn(t,n),nn(t,s);let u="0.0";i!=null&&(nn(t,i),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");let l="1.0";a!=null&&(nn(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${u};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q_e{constructor(t,n,s,i,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],nn(t,n),nn(t,s);let u="vec4(0.0)";i!=null&&(nn(t,i),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(nn(t,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${u};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_e=({inputs:r,backend:t,attrs:n})=>{const{x:s,mean:i,variance:a,offset:o,scale:u}=r;oe(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),oe(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),oe(u==null||i.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,i,a];let h=null;o!=null&&(h=o.shape,c.push(o));let f=null;u!=null&&(f=u.shape,c.push(u));const p=Ke().getBool("WEBGL_PACK_NORMALIZATION")?new q_e(s.shape,i.shape,a.shape,h,f,l):new H_e(s.shape,i.shape,a.shape,h,f,l);return t.runWebGLProgram(p,c,c[0].dtype)},X_e={kernelName:Ov,backendName:"webgl",kernelFunc:K_e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y_e{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const n=cr(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Z_e(this.rank);let i;const a=t.map((o,u)=>`sourceLoc.${lD[u]} = start[${u}] + coords.${lD[u]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${s}));
      }
    `}}const lD=["x","y","z","w","u","v"];function Z_e(r){if(r===1)return"sourceLoc";if(r<=6)return lD.slice(0,r).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q_e{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=cr(this.rank),s=Qs("coords",this.rank),i=Qs("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,o=`getChannel(getSource(${i.join()}), ${a})`,u=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${o};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${t[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${o};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${t.map((h,f)=>`start[${f}]`).join()});`:t.map((h,f)=>`${i[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${u}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_e(r,t,n,s){const i=s.texData.get(r.dataId),a=s.makeTensorInfo(n,r.dtype),o=s.texData.get(a.dataId);Object.assign(o,i),o.refCount=1,o.shape=n,o.dtype=r.dtype;let u=P3(t,Mt(r.shape));i.slice&&(u+=i.slice.flatOffset),o.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||r.dataId};const l=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,l+1),a}function np(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{begin:a,size:o}=s,[u,l]=w2(i,a,o);if(M3(i,u,l),Je(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=n.texData.get(i.dataId),p=HSe(f.values,u,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,p)}const{isPacked:c}=n.texData.get(i.dataId),h=B3(i.shape,u,l);if(c||!h){const f=Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Q_e(l):new Y_e(l),p=[u];return n.runWebGLProgram(f,[i],i.dtype,p)}return n.uploadToGPU(i.dataId),J_e(i,u,l,n)}const eEe={kernelName:c2,backendName:"webgl",kernelFunc:np};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tEe=r=>{const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockShape:a,crops:o}=s;oe(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const u=a.reduce((w,E)=>w*E),l=R0(i.shape,a,u),c=O0(l.length,a.length),h=M0(i.shape,a,u),f=DN(o,a.length),p=TN(h,o,a.length),g=[],y=vt({inputs:{x:i},backend:n,attrs:{shape:l}}),x=ti({inputs:{x:y},backend:n,attrs:{perm:c}}),v=vt({inputs:{x},backend:n,attrs:{shape:h}}),S=np({inputs:{x:v},backend:n,attrs:{begin:f,size:p}});return g.push(y),g.push(x),g.push(v),g.forEach(w=>n.disposeIntermediateTensorInfo(w)),S},nEe={kernelName:_v,backendName:"webgl",kernelFunc:tEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,weights:a}=t,{size:o}=s,u=n.readSync(i.dataId),l=n.readSync(a.dataId),c=QG(u,l,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,c)}const sEe={kernelName:JT,backendName:"webgl",kernelFunc:rEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iEe(r){const{inputs:t,backend:n}=r,{s0:s,s1:i}=t,a=n.readSync(s.dataId),o=n.readSync(i.dataId),u=nn(Array.from(a),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}const aEe={kernelName:_P,backendName:"webgl",kernelFunc:iEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oEe="return float(a != b);",fj=Fs({opSnippet:oEe,cpuKernelImpl:BSe,dtype:"bool"}),uEe={kernelName:Qv,backendName:"webgl",kernelFunc:fj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y0(r){const{inputs:t,backend:n}=r,{input:s}=t,i=n.texData.get(s.dataId);return Mi({inputs:{x:i.complexTensorInfos.real},backend:n})}const lEe={kernelName:S3,backendName:"webgl",kernelFunc:Y0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cEe="return float(int(x));";function hEe(r,t){const n=new gu(r.shape,cEe),s=t.runWebGLProgram(n,[r],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cD(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{dtype:a}=s;if(a==="complex64"){if(i.dtype==="complex64")return Mi({inputs:{x:i},backend:n});const o=hs(i.shape),u=cD({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=Xl({inputs:{real:u,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(u),l}if(i.dtype==="complex64"){const o=Y0({inputs:{input:i},backend:n}),u=cD({inputs:{x:o},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(o),u}if(!yP(i.dtype,a)){const o=Mi({inputs:{x:i},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:a}}if(n.shouldExecuteOnCPU([i])){const o=n.texData.get(i.dataId).values,[u,l,c]=xSe(o,i.shape,i.dtype,a);return n.makeTensorInfo(u,l,c)}if(a==="int32")return hEe(i,n);if(a==="bool"){const o=n.makeTensorInfo([],"bool",As("bool",1)),l=fj({inputs:{a:i,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const fEe={kernelName:Vg,backendName:"webgl",kernelFunc:cD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BM="return ceil(x);",dEe=kn({opSnippet:BM,packedOpSnippet:BM,cpuKernelImpl:bSe}),pEe={kernelName:zg,backendName:"webgl",kernelFunc:dEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mEe{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gEe{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{clipValueMin:a,clipValueMax:o}=s;let u;Ke().getBool("WEBGL_PACK_CLIP")?u=new gEe(i.shape):u=new mEe(i.shape);const l=[[a],[o]];return n.runWebGLProgram(u,[i],i.dtype,l)}const xEe={kernelName:Ug,backendName:"webgl",kernelFunc:yEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bEe{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PM(r,t){return{dataId:t.dataId,dtype:t.dtype,shape:r.shape}}function vEe(r){const{inputs:t,backend:n}=r,{x:s}=t,i=n.texData.get(s.dataId),a=new bEe(s.shape),o=[PM(s,i.complexTensorInfos.real),PM(s,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}const wEe={kernelName:Ev,backendName:"webgl",kernelFunc:vEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SEe{constructor(t){this.outputShape=[],this.outputShape=To(t,1),this.variableNames=t.map((o,u)=>`T${u}`);const n=new Array(t.length-1);n[0]=t[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+t[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const u=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${u}));`)}const i=n.length,a=n[n.length-1];s.push(`else setOutput(getT${i}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CEe{constructor(t,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=To(t,n);const s=this.outputShape,i=s.length,a=cr(i),o=Qs("coords",i),u=["x","y","z","w","u","v"].slice(0,i);this.variableNames=t.map((x,v)=>`T${v}`);const l=new Array(t.length-1);l[0]=t[0][n];for(let x=1;x<l.length;x++)l[x]=l[x-1]+t[x][n];const c=u[n],h=u.slice(-2),f=u.join();let p=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${h.join()}));
        }`;for(let x=1;x<l.length;x++){const v=l[x-1];p+=`
        if (${c} < ${l[x]}  && ${c} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${Ky(u,c,v)}),
            vec2(${Ky(h,c,v)}));
        }`}const g=l.length,y=l[l.length-1];p+=`
        return getChannel(
          getT${g}(${Ky(u,c,y)}),
          vec2(${Ky(h,c,y)}));`,this.userCode=`
      float getValue(${u.map(x=>"int "+x)}) {
        ${p}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[i-1]} = ${o[i-1]} + 1;
        if (${o[i-1]} < ${s[i-1]}) {
          result.g = getValue(${o});
        }

        ${o[i-2]} = ${o[i-2]} + 1;
        if (${o[i-2]} < ${s[i-2]}) {
          result.a = getValue(${o});
        }

        ${o[i-1]} = ${o[i-1]} - 1;
        if (${o[i-2]} < ${s[i-2]} &&
            ${o[i-1]} < ${s[i-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Ky(r,t,n){const s=r.indexOf(t);return r.map((a,o)=>o===s?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2(r){const{inputs:t,backend:n}=r,{input:s}=t,i=n.texData.get(s.dataId);return Mi({inputs:{x:i.complexTensorInfos.imag},backend:n})}const _Ee={kernelName:p3,backendName:"webgl",kernelFunc:K2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Em(r,t,n){const s=r[0].dtype;if(s==="complex64"){const f=r.map(v=>Y0({inputs:{input:v},backend:n})),p=r.map(v=>K2({inputs:{input:v},backend:n})),g=Em(f,t,n),y=Em(p,t,n),x=Xl({inputs:{real:g,imag:y},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}let i=n.shouldExecuteOnCPU(r);if(s==="string"&&(i=!0),i){const f=r.map(w=>{const _=[-1,Je(w.shape.slice(t))];return vt({inputs:{x:w},backend:n,attrs:{shape:_}})}),p=f.map(w=>({vals:n.readSync(w.dataId),shape:w.shape})),g=To(f.map(w=>w.shape),1),y=f[0].shape[0]===1,x=vSe(p,g,s,y),v=To(r.map(w=>w.shape),t),S=n.makeTensorInfo(v,s,x);return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),S}const a=Ke().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>a){const f=[];for(let g=0;g<r.length;g+=a){const y=r.slice(g,g+a);f.push(Em(y,t,n))}const p=Em(f,t,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return p}if(Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1){const f=new CEe(r.map(p=>p.shape),t);return n.runWebGLProgram(f,r,s)}const{tensors2D:o,outShape:u}=EEe(r,t,n),l=new SEe(o.map(f=>f.shape)),c=n.runWebGLProgram(l,o,s);o.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=vt({inputs:{x:c},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(c),h}function EEe(r,t,n){const s=To(r.map(a=>a.shape),t);return{tensors2D:r.map(a=>vt({inputs:{x:a},attrs:{shape:[-1,Je(a.shape.slice(t))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dj(r){const{inputs:t,backend:n,attrs:s}=r,{axis:i}=s,a=dn(i,t[0].shape)[0],o=t.map(c=>c.shape);CN(o,a);const u=To(t.map(c=>c.shape),a);if(Je(u)===0)return n.makeTensorInfo(u,t[0].dtype,[]);const l=t.filter(c=>Je(c.shape)>0);return l.length===1?Mi({inputs:{x:l[0]},backend:n}):Em(l,a,n)}const DEe={kernelName:Dv,backendName:"webgl",kernelFunc:dj};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pj{constructor(t,n=!1,s=null,i=!1,a=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const o=t.padInfo.top,u=t.padInfo.left,l=t.strideHeight,c=t.strideWidth,h=t.dilationHeight,f=t.dilationWidth,p=t.filterHeight,g=t.filterWidth,y=Math.floor(t.inChannels/4)*4,x=t.inChannels%4,v=t.dataFormat==="channelsLast",S=v?1:2,w=v?2:3,E=v?3:1;let _="",D="";s&&(i?_=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?_=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:_=`
          float activation(float x) {
            ${s}
          }
        `,D="result = activation(result);");const I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${_}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${o}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${E}];

        ivec2 xRCCorner =
            ivec2(coords[${S}], coords[${w}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${g}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${D}
        setOutput(result);
      }
    `}}class TEe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const n=t.padInfo.front,s=t.padInfo.top,i=t.padInfo.left,a=t.strideDepth,o=t.strideHeight,u=t.strideWidth,l=t.dilationDepth,c=t.dilationHeight,h=t.dilationWidth,f=t.filterDepth,p=t.filterHeight,g=t.filterWidth,y=Math.floor(t.inChannels/4)*4,x=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${o}, ${u});
      const ivec3 pads = ivec3(${n}, ${s}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${g}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mj{constructor(t,n=!1,s=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ri(this.outputShape.length);const o=t.padInfo.left,u=t.strideWidth,l=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,f=h;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<h;v++)p+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;p+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let v=0;v<h;v++)p+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(f+1)/2;v++){const S=v*2;if(p+=`
           xC = xCCorner + ${S*l};
           `,u===1){if(S<h&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }
               `,l===1&&S>0?p+=`
                 xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                   } else {
                     xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xC${S} = xTexelC${S};
                 `,S+1<h)){const w=o%2===0?jT(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${w};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                     xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${S+1}.zw = vec2(0.0);
                     }
                     xTexelC${S+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                     } else {
                      xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                     }
                     `:p+=`
                     xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                     `):w===1?p+=`
                     xC${S+1} = xTexelC${S};
                     `:p+=`
                     xCOffset = xC + ${w};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                       xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${S+1}.zw = vec2(0.0);
                       }
                       xTexelC${S+1}Ready = 1;
                     }

                     xC${S+1} = xTexelC${S+1};
                     `}}else S<h&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.0);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
               `,S+1<h&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(
                   xTexelC${S}.xy, xTexelC${S+1}.xy);
               `,S+1<h&&(p+=`
                   xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                 `)));S<h&&(p+=`
             wTexel = getW(r, ${S}, d1, d2);
             dotProd += xC${S}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${S}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,S+1<h&&(p+=`
               wTexel = getW(r, ${S+1}, d1, d2);
               dotProd += xC${S+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${S+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let g="",y="";s&&(i?g=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?g=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:g=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${g}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NEe{constructor(t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=ri(this.outputShape.length);const{dataFormat:s}=n,i=ni(),a=s==="channelsLast",o=a?1:2,u=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let c="";for(let h=0;h<=1;h++)for(let f=0;f<=1;f++)c+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${u}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wb(r,t){const n=r.length;return n>=3?t?[...r.slice(0,-3),r[n-3]*r[n-2],r[n-1]]:[...r.slice(0,-3),r[n-3],r[n-2]*r[n-1]]:!t&&n===1&&r[0]>1?[r[0],1]:null}function gj({x:r,filter:t,convInfo:n,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:u=null}){const l=r.shape,c=s.texData.get(r.dataId),h=n.inChannels,f=l[0]*l[1]*l[2],p=n.outChannels,g=n.dataFormat==="channelsLast",y=!1,x=!1;let v;const S=[];if(a!=null){const _=wb(a.shape,g);_!=null&&(a=vt({inputs:{x:a},backend:s,attrs:{shape:_}}),S.push(a))}if(i!=null){const _=wb(i.shape,g);_!=null&&(i=vt({inputs:{x:i},backend:s,attrs:{shape:_}}),S.push(i))}if(!((f===1||p===1)&&h>uj)&&c.isPacked&&g&&c.texture!=null&&l[2]%2!==0&&Bn(c.shape.slice(-3),l.slice(-3))){const _=l[0]*l[1]*(l[2]+1),D={dataId:r.dataId,shape:[1,_,n.inChannels],dtype:r.dtype},I=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,oe(bb(c.shape,D.shape),()=>`packed reshape ${c.shape} to ${D.shape} isn't free`);const k=vt({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});S.push(k);const A=vb({a:D,b:k,backend:s,transposeA:y,transposeB:x,bias:i,activation:u,preluActivationWeights:a,leakyreluAlpha:o}),N=s.texData.get(A.dataId);oe(N.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=I,N.shape=n.outShape,v=Mi({inputs:{x:A},backend:s}),v.shape=n.outShape,S.push(A)}else{const _=n.outHeight*n.outWidth,D=vt({inputs:{x:r},backend:s,attrs:{shape:g?[n.batchSize,_,n.inChannels]:[n.batchSize,n.inChannels,_]}}),I=vt({inputs:{x:t},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),k=vb({a:g?D:I,b:g?I:D,transposeA:!g,transposeB:x,backend:s,bias:i,activation:u,preluActivationWeights:a,leakyreluAlpha:o});v=vt({inputs:{x:k},backend:s,attrs:{shape:n.outShape}}),S.push(D),S.push(I),S.push(k)}for(const _ of S)s.disposeIntermediateTensorInfo(_);return v}function yj({x:r,filter:t,convInfo:n,backend:s,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:u=null}){const{filterWidth:l,filterHeight:c,inChannels:h,outWidth:f,outHeight:p,dataFormat:g}=n,y=g==="channelsLast",x=l*c*h,v=p*f,S=[n.batchSize,x,v],w=!0,E=!1,_=[];if(a!=null){const J=wb(a.shape,y);J!=null&&(a=vt({inputs:{x:a},backend:s,attrs:{shape:J}}),_.push(a))}if(i!=null){const J=wb(i.shape,y);J!=null&&(i=vt({inputs:{x:i},backend:s,attrs:{shape:J}}),_.push(i))}const D=vt({inputs:{x:t},backend:s,attrs:{shape:[1,x,Je(t.shape)/x]}});_.push(D);const I=new NEe(S,n),k=[r.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],A=s.runWebGLProgram(I,[r],"float32",k),N=vt({inputs:{x:A},backend:s,attrs:{shape:S}});_.push(A),_.push(N);const F=i!=null,$=a!=null,O=u==="leakyrelu",M=u?yg(u,!0):null,B=new oj(y?N.shape:D.shape,y?D.shape:N.shape,y?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],w,E,F,M,$,O),U=y?[N,D]:[D,N];if(i&&U.push(i),$&&U.push(a),O){const J=s.makeTensorInfo([],"float32",Ul(o,"float32"));U.push(J),_.push(J)}const V=s.runWebGLProgram(B,U,"float32"),Z=vt({inputs:{x:V},backend:s,attrs:{shape:n.outShape}});_.push(V);for(const J of _)s.disposeIntermediateTensorInfo(J);return Z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dataFormat:l,dilations:c,dimRoundingMode:h}=s,f=$u(l),p=Is(i.shape,a.shape,o,c,u,h,!1,f);let g;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))g=gj({x:i,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&f==="channelsLast"&&Ke().getBool("WEBGL_EXP_CONV")){const x=new mj(p),v=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];g=n.runWebGLProgram(x,[i,a],"float32",v)}else if(Ke().getBool("WEBGL_CONV_IM2COL"))g=yj({x:i,filter:a,convInfo:p,backend:n});else{const x=new pj(p);g=n.runWebGLProgram(x,[i,a],"float32")}const y=vt({inputs:{x:g},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(g),y}const AEe={kernelName:Tv,backendName:"webgl",kernelFunc:kEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IEe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,i=t.padInfo.top,a=t.padInfo.left,o=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              if (${o}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $Ee{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,i=t.strideHeight,a=t.strideWidth,o=t.dataFormat==="channelsLast",u=n-1-t.padInfo.top,l=s-1-t.padInfo.left,c=o?1:2,h=o?2:3,f=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${u}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class FEe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideDepth,s=t.strideHeight,i=t.strideWidth,a=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${u};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class REe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterDepth,s=t.filterHeight,i=t.filterWidth,a=t.strideDepth,o=t.strideHeight,u=t.strideWidth,l=n-1-t.padInfo.front,c=s-1-t.padInfo.top,h=i-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${u}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,pad:u,dataFormat:l,dimRoundingMode:c,filterShape:h}=s,f=$u(l),p=Is(i.shape,h,o,1,u,c,!1,f),g=new IEe(p);return n.runWebGLProgram(g,[i,a],"float32")}const MEe={kernelName:t3,backendName:"webgl",kernelFunc:OEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LEe(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{inputShape:o,strides:u,pad:l,dataFormat:c,dimRoundingMode:h}=s,f=$u(c),p=Is(o,a.shape,u,1,l,h,!1,f),g=new $Ee(p);return n.runWebGLProgram(g,[i,a],"float32")}const BEe={kernelName:Nv,backendName:"webgl",kernelFunc:LEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dilations:l}=s,c=Gl(i.shape,a.shape,o,l,u),h=new TEe(c);return n.runWebGLProgram(h,[i,a],"float32")}const VEe={kernelName:kv,backendName:"webgl",kernelFunc:PEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zEe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,pad:u,filterShape:l}=s,c=Gl(i.shape,l,o,1,u),h=new FEe(c);return n.runWebGLProgram(h,[i,a],"float32")}const UEe={kernelName:n3,backendName:"webgl",kernelFunc:zEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{pad:o,strides:u,inputShape:l}=s,c=Gl(l,a.shape,u,1,o),h=new REe(c);return n.runWebGLProgram(h,[i,a],"float32")}const jEe={kernelName:r3,backendName:"webgl",kernelFunc:GEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WEe=tp+`
  return cos(x);
`,HEe=kn({opSnippet:WEe}),qEe={kernelName:Gg,backendName:"webgl",kernelFunc:HEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KEe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,XEe=kn({opSnippet:KEe}),YEe={kernelName:jg,backendName:"webgl",kernelFunc:XEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZEe{constructor(t,n,s,i,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,u,l,c]=t,[h]=n,[f,p]=s;this.outputShape=[h,f,p,c];const g=i==="bilinear"?1:0,[y,x]=[`${u-1}.0`,`${l-1}.0`],[v,S,w]=f>1?[`${(u-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[E,_,D]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${E});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${S};
        float width_scale = ${_};

        float in_y = ${w};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${D};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${g} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QEe=r=>{const{inputs:t,backend:n,attrs:s}=r,{image:i,boxes:a,boxInd:o}=t,{cropSize:u,method:l,extrapolationValue:c}=s,h=new ZEe(i.shape,a.shape,u,l,c);return n.runWebGLProgram(h,[i,a,o],"float32")},JEe={kernelName:i3,backendName:"webgl",kernelFunc:QEe};var bg;(function(r){r.Prod="*",r.Sum="+"})(bg||(bg={}));class VM{constructor(t,n,s,i){this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,o=this.op===bg.Prod?"1.0":"0.0",u=s?o:`getX(${zM(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",h="";s?(c=i?`end != ${l-1}`:"end != 0",h=i?"end + 1":"end - 1"):(c=i?`end + pow2 < ${l}`:"end >= pow2",h=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${cr(a)} coords = getOutputCoords();
        int end = ${UM(a,"coords",this.op)};
        float val = ${u};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${h};
          ${UM(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${zM(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function zM(r,t,n){if(r===1)return`${t}`;if(r===2)return`${t}.x, ${t}.y`;if(r===3)return`${t}.x, ${t}.y, ${t}.z`;if(r===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${n} for rank ${r} is not yet supported`)}function UM(r,t,n){if(r===1)return`${t}`;if(r===2)return`${t}.y`;if(r===3)return`${t}.z`;if(r===4)return`${t}.w`;throw new Error(`Cumulative ${n} for rank ${r} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(r,t,n,s,i,a){const o=t.shape.length,u=Dr([s],o);let l=t;u!=null&&(l=ti({inputs:{x:t},backend:n,attrs:{perm:u}}));const c=Mr(1,o)[0];if(c!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${s}`);const h=l.shape[c];let f=Mi({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(h))-1;p++){const g=new VM(r,l.shape,!1,a),y=[[p]],x=f;f=n.runWebGLProgram(g,[f],f.dtype,y),n.disposeIntermediateTensorInfo(x)}if(i){const p=new VM(r,l.shape,i,a),g=f;f=n.runWebGLProgram(p,[f],f.dtype),n.disposeIntermediateTensorInfo(g)}if(u!=null){const p=jl(u),g=ti({inputs:{x:f},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(l),g}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,exclusive:o,reverse:u}=s;return xj(bg.Prod,i,n,a,o,u)}const tDe={kernelName:s3,backendName:"webgl",kernelFunc:eDe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,exclusive:o,reverse:u}=s;return xj(bg.Sum,i,n,a,o,u)}const rDe={kernelName:Av,backendName:"webgl",kernelFunc:nDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,weights:a}=t,{size:o,binaryOutput:u}=s;if(i.shape.length===1){const l=n.readSync(i.dataId),c=n.readSync(a.dataId),h=QG(l,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,h)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(a),h=ySe(l,c,o,u);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const iDe={kernelName:EP,backendName:"webgl",kernelFunc:sDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aDe{constructor(t,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockSize:a,dataFormat:o}=s,u=i.shape[0],l=o==="NHWC"?i.shape[1]:i.shape[2],c=o==="NHWC"?i.shape[2]:i.shape[3],h=o==="NHWC"?i.shape[3]:i.shape[1],f=l*a,p=c*a,g=h/(a*a),y=o==="NHWC"?[u,f,p,g]:[u,g,f,p],x=new aDe(y,a,o);return n.runWebGLProgram(x,[i],i.dtype)}const uDe={kernelName:a3,backendName:"webgl",kernelFunc:oDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bj{constructor(t,n=!1,s=null,i=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ri(this.outputShape.length);const o=t.filterHeight,u=t.filterWidth,l=t.outChannels/t.inChannels;let c="",h="";s&&(i?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${u}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vj{constructor(t,n=!1,s=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ri(this.outputShape.length);const o=t.outChannels/t.inChannels,u=t.padInfo.left,l=t.strideWidth,c=t.dilationWidth,h=t.filterHeight,f=t.filterWidth,p=f;let g=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<f;S++)g+=`
          vec4 xTexelC${S*2};
          int xTexelC${S*2}Ready;
          vec4 xTexelC${S*2+1};
          int xTexelC${S*2+1}Ready;
          vec4 xC${S};`;g+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let S=0;S<f;S++)g+=`
          xTexelC${S*2} = vec4(0.0);
          xTexelC${S*2}Ready = 0;
          xTexelC${S*2+1} = vec4(0.0);
          xTexelC${S*2+1}Ready = 0;
          xC${S} = vec4(0.0);`;g+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let S=0;S<(p+1)/2;S++){const w=S*2;if(g+=`
          xC = xCCorner + ${w*c};
          `,l===1){if(w<f&&(u%2===1?(g+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }
              `,c===1&&w>0?g+=`
                xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                `:g+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                  } else {
                    xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                  }
                  `):g+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xC${w} = xTexelC${w};
                `,w+1<f)){const E=u%2===0?jT(c):c;c%2===0&&u%2===1||c%2!==0&&u%2!==1?(g+=`
                  xCOffset = xC + imod(pads[1], 2) + ${E};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                    xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${w+1}.zw = vec2(0.0);
                    }
                    xTexelC${w+1}Ready = 1;
                  }
                  `,c>1?g+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                    } else {
                     xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                    }
                    `:g+=`
                    xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                    `):E===1?g+=`
                    xC${w+1} = xTexelC${w};
                    `:g+=`
                    xCOffset = xC + ${E};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                      xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${w+1}.zw = vec2(0.0);
                      }
                      xTexelC${w+1}Ready = 1;
                    }

                    xC${w+1} = xTexelC${w+1};
                    `}}else w<f&&(u%2===1?(g+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.0);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
              `,w+1<f&&(g+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                `)):(g+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(
                  xTexelC${w}.xy, xTexelC${w+1}.xy);
              `,w+1<f&&(g+=`
                  xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                `)));w<f&&(g+=`
            wTexel = getW(r, ${w}, d1, q);
            dotProd += xC${w} * vec4(wTexel.xz, wTexel.xz);
          `,w+1<f&&(g+=`
              wTexel = getW(r, ${w+1}, d1, q);
              dotProd += xC${w+1} * vec4(wTexel.xz, wTexel.xz);
            `))}g+=`
    }
  `,g+=`
      }
    `;let y="",x="";s&&(i?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${g}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dilations:l,dimRoundingMode:c}=s;let h=l;h==null&&(h=[1,1]),oe(Gs(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const f=Is(i.shape,a.shape,o,h,u,c,!0);let p;Ke().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?p=new vj(f):p=new bj(f);const g=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(p,[i,a],"float32",g)}const cDe={kernelName:Iv,backendName:"webgl",kernelFunc:lDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hDe{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const n=t.strideHeight,s=t.strideWidth,i=t.padInfo.top,a=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fDe{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const n=t.filterHeight,s=t.filterWidth,i=t.strideHeight,a=t.strideWidth,o=n-1-t.padInfo.top,u=s-1-t.padInfo.left,l=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,dy:a}=t,{strides:o,dilations:u,pad:l,dimRoundingMode:c,filterShape:h}=s,f=Is(i.shape,h,o,u,l,c,!0),p=new hDe(f);return n.runWebGLProgram(p,[i,a],"float32")}const pDe={kernelName:o3,backendName:"webgl",kernelFunc:dDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mDe(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,filter:a}=t,{strides:o,dilations:u,pad:l,dimRoundingMode:c,inputShape:h}=s,f=Is(h,a.shape,o,u,l,c,!0),p=new fDe(f);return n.runWebGLProgram(p,[i,a],"float32")}const gDe={kernelName:u3,backendName:"webgl",kernelFunc:mDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yDe{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDe(r){const{inputs:t,backend:n}=r,{x:s}=t,i=[...s.shape,...s.shape],a=Je(s.shape),o=vt({inputs:{x:s},backend:n,attrs:{shape:[a]}}),u=new yDe(a),l=n.runWebGLProgram(u,[o],o.dtype),c=vt({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const bDe={kernelName:DP,backendName:"webgl",kernelFunc:xDe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vDe{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:n,inWidth:s,padInfo:i,strideHeight:a,strideWidth:o,filterHeight:u,filterWidth:l,dilationHeight:c,dilationWidth:h}=t,{top:f,left:p}=i;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${o});
      const ivec2 pads = ivec2(${f}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${u}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wDe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a}=t,{strides:o,pad:u,dilations:l}=s,c=A0(i.shape,a.shape,o,u,"NHWC",l);let h;const f=new vDe(c);h=n.runWebGLProgram(f,[i,a],"float32");const p=vt({inputs:{x:h},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(h),p}const SDe={kernelName:$v,backendName:"webgl",kernelFunc:wDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(r){const{inputs:t,backend:n,attrs:s}=r,{equation:i}=s,a=t,{allDims:o,summedDims:u,idDims:l}=ON(i,a.length);LN(o.length,l,a);const{path:c,steps:h}=BN(u,l),f=h.length;let p=null,g=o.length;const y=[];for(let x=0;x<f;++x){for(const v of h[x]){const{permutationIndices:S,expandDims:w}=MN(g,l[v]);let E;PN(S)?E=a[v]:(E=ti({inputs:{x:a[v]},backend:n,attrs:{perm:S}}),y.push(E));const _=E.shape.slice();for(let D=0;D<w.length;++D)_.splice(w[D],0,1);Bn(E.shape,_)||(E=vt({inputs:{x:E},backend:n,attrs:{shape:_}}),y.push(E)),p===null?p=E:(p=Nk({inputs:{a:E,b:p},backend:n}),y.push(p))}x<f-1&&(c[x]>=0&&(p=q2({inputs:{x:p},backend:n,attrs:{axis:c[x]-(o.length-g),keepDims:!1}}),y.push(p)),g--)}for(const x of y)x!==p&&n.disposeIntermediateTensorInfo(x);return p}const _De={kernelName:TP,backendName:"webgl",kernelFunc:CDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EDe="return (x >= 0.0) ? x : (exp(x) - 1.0);",DDe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,TDe=kn({opSnippet:EDe,packedOpSnippet:DDe}),NDe={kernelName:Hg,backendName:"webgl",kernelFunc:TDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kDe="return (b >= 1.0) ? a : a * (b + 1.0);",ADe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,IDe=r=>{const{inputs:t,backend:n}=r,{dy:s,y:i}=t,a=Ke().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new X0(ADe,s.shape,i.shape):new kd(kDe,s.shape,i.shape);return n.runWebGLProgram(a,[s,i],s.dtype)},$De={kernelName:l3,backendName:"webgl",kernelFunc:IDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FDe=`
  return vec4(equal(a, b));
`,RDe="return float(a == b);",ODe=Fs({opSnippet:RDe,packedOpSnippet:FDe,dtype:"bool",cpuKernelImpl:wSe}),MDe={kernelName:Fv,backendName:"webgl",kernelFunc:ODe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LDe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${NN};
  float a1 = ${kN};
  float a2 = ${AN};
  float a3 = ${IN};
  float a4 = ${$N};
  float a5 = ${FN};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,BDe=kn({opSnippet:LDe}),PDe={kernelName:qg,backendName:"webgl",kernelFunc:BDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VDe=tp+`
  return exp(x);
`,zDe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wj=kn({opSnippet:VDe,packedOpSnippet:zDe,cpuKernelImpl:SSe,dtype:"float32"}),UDe={kernelName:Kg,backendName:"webgl",kernelFunc:wj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(r){const{inputs:t,attrs:n,backend:s}=r,{dim:i}=n,{input:a}=t,o=a.shape.length,u=a.shape.slice();let l=i;return i<0&&(oe(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),u.splice(l,0,1),vt({inputs:{x:a},backend:s,attrs:{shape:u}})}const GDe={kernelName:Rv,backendName:"webgl",kernelFunc:hD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GM="return exp(x) - 1.0;",jDe=kn({opSnippet:GM,packedOpSnippet:GM,cpuKernelImpl:CSe}),WDe={kernelName:Xg,backendName:"webgl",kernelFunc:jDe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jM{constructor(t,n,s){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${i}.0`:"1.0";let u;if(t==="real")u="return real * expR - imag * expI;";else if(t==="imag")u="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${u}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(r,t,n){const s=n.texData.get(r.dataId),i=Je(r.shape),a=r.shape[r.shape.length-1],o=i/a,u=vt({inputs:{x:r},backend:n,attrs:{shape:[o,a]}}),l=u.shape,c=new jM("real",l,t),h=new jM("imag",l,t),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(c,f,"float32"),g=n.runWebGLProgram(h,f,"float32"),y=Xl({inputs:{real:p,imag:g},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g);const x=vt({inputs:{x:y},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(y),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HDe(r){const{inputs:t,backend:n}=r,{input:s}=t;return Sj(s,!1,n)}const qDe={kernelName:c3,backendName:"webgl",kernelFunc:HDe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KDe{constructor(t,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z0(r){const{backend:t,attrs:n}=r,{shape:s,value:i}=n;let{dtype:a}=n;if(a=a||$g(i),a==="string"){const o=ds(a,Je(s));return o.fill(i),t.makeTensorInfo(s,a,o)}else{const o=new KDe(s,i),u=[[i]];return t.runWebGLProgram(o,[],a,u)}}const XDe={kernelName:h3,backendName:"webgl",kernelFunc:Z0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YDe{constructor(t){this.variableNames=["Image"],this.outputShape=[];const n=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZDe={kernelName:f3,backendName:"webgl",kernelFunc:({inputs:r,backend:t})=>{const{image:n}=r,s=t,i=new YDe(n.shape);return s.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WM="return floor(x);",QDe=kn({opSnippet:WM,packedOpSnippet:WM,cpuKernelImpl:_Se}),JDe={kernelName:Yg,backendName:"webgl",kernelFunc:QDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eTe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,tTe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,nTe=Fs({opSnippet:eTe,packedOpSnippet:tTe,dtype:"int32"}),rTe={kernelName:Zg,backendName:"webgl",kernelFunc:nTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sTe{constructor(t){this.variableNames=["A"];const n=ni(),[s,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iTe{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ni(),[s,i]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aTe={kernelName:eoe,backendName:"webgl",kernelFunc:oTe};let Tf,E_=Ke().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function oTe(r){const{inputs:t,backend:n,attrs:s}=r;let{pixels:i}=t;const{numChannels:a}=s,o=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,u=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,c]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=[c,l],f=[c,l,a];if(u||o){const x=Ke().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Tf==null||x!==E_)&&(E_=x,Tf=document.createElement("canvas").getContext("2d",{willReadFrequently:E_})),Tf.canvas.width=l,Tf.canvas.height=c,Tf.drawImage(i,0,0,l,c),i=Tf.canvas}const p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=Ki.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),i);const g=Ke().getBool("WEBGL_PACK")?new iTe(f):new sTe(f),y=n.runWebGLProgram(g,[p],"int32");return n.disposeData(p.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uTe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a,bias:o,preluActivationWeights:u}=t,{strides:l,pad:c,dataFormat:h,dilations:f,dimRoundingMode:p,activation:g,leakyreluAlpha:y}=s,x=$u(h),v=Is(i.shape,a.shape,l,f,c,p,!1,x);let S;const w=[],E=o!=null,_=u!=null,D=g==="leakyrelu",I=()=>{const A=[i,a],N=(F,$)=>{if($==="NCHW"&&F.shape.length===1&&F.shape[0]!==1){const O=vt({inputs:{x:F},backend:n,attrs:{shape:[F.shape[0],1,1]}});return w.push(O),O}return F};if(E&&A.push(N(o,h)),_&&A.push(N(u,h)),D){const F=n.makeTensorInfo([],"float32",Ul(y,"float32"));A.push(F),w.push(F)}return A};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))S=gj({x:i,filter:a,convInfo:v,backend:n,bias:o,activation:g,preluActivationWeights:u,leakyreluAlpha:y});else if(v.strideWidth<=2&&x==="channelsLast"&&Ke().getBool("WEBGL_EXP_CONV")){const A=g?yg(g,!0):null,N=new mj(v,E,A,_,D),F=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],$=I();S=n.runWebGLProgram(N,$,"float32",F)}else if(Ke().getBool("WEBGL_CONV_IM2COL"))S=yj({x:i,filter:a,convInfo:v,backend:n,bias:o,activation:g,preluActivationWeights:u,leakyreluAlpha:y});else{const A=g?yg(g,!1):null,N=new pj(v,E,A,_,D),F=I();S=n.runWebGLProgram(N,F,"float32")}const k=vt({inputs:{x:S},backend:n,attrs:{shape:v.outShape}});return w.push(S),w.forEach(A=>n.disposeIntermediateTensorInfo(A)),k}const lTe={kernelName:Zx,backendName:"webgl",kernelFunc:uTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cTe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,filter:a,bias:o,preluActivationWeights:u}=t,{strides:l,pad:c,dilations:h,dimRoundingMode:f,activation:p,leakyreluAlpha:g}=s,y=[];let x=h;x==null&&(x=[1,1]),oe(Gs(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const v=Is(i.shape,a.shape,l,x,c,f,!0),S=Ke().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,w=p?yg(p,S):null,E=[i,a],_=o!=null,D=u!=null,I=p==="leakyrelu";if(_&&E.push(o),D&&E.push(u),I){const F=n.makeTensorInfo([],"float32",Ul(g,"float32"));E.push(F),y.push(F)}let k;S?k=new vj(v,_,w,D,I):k=new bj(v,_,w,D,I);const A=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],N=n.runWebGLProgram(k,E,"float32",A);return y.forEach(F=>n.disposeIntermediateTensorInfo(F)),N}const hTe={kernelName:jP,backendName:"webgl",kernelFunc:cTe};class fTe{constructor(t,n,s,i){this.sliceDim=t,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=s;const a=cr(s.length);let o=`
    int index;`;for(let u=0;u<this.sliceDim;u++)o+=`
          index = round(getIndices(coords[0], ${u}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[u]};
          flattenIndex += index * ${this.strides[u]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(r){const{inputs:t,backend:n}=r,{params:s,indices:i}=t,a=i.shape,o=a[a.length-1],u=Je(s.shape),[l,c,h,f]=O3(s,i),p=vt({inputs:{x:i},backend:n,attrs:{shape:[c,o]}}),g=vt({inputs:{x:s},backend:n,attrs:{shape:[Je(s.shape)/h,h]}});if(n.shouldExecuteOnCPU([s,i])||s.dtype==="string"){const S=n.readSync(i.dataId),w=n.bufferSync(s),E=ESe(S,w,s.dtype,c,o,h,f,s.shape,u);return n.makeTensorInfo(l,s.dtype,E.values)}const y=new fTe(o,f,[c,h],s.shape),x=n.runWebGLProgram(y,[g,p],g.dtype),v=vt({inputs:{x},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),v}const pTe={kernelName:NP,backendName:"webgl",kernelFunc:dTe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mTe{constructor(t,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=cr(this.rank),i=gTe(t);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function gTe(r,t){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let i=0;i<r.length;i++)i===2?s.push("index"):s.push(`${n[i]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,indices:a}=t,{axis:o,batchDims:u}=s,l=dn(o,i.shape)[0];if(Ke().get("DEBUG")){const w=n.readSync(a.dataId),E=i.shape[l];for(let _=0;_<w.length;++_){const D=w[_];oe(D<=E-1&&D>=0,()=>`GatherV2: the index value ${D} is not in [0, ${E-1}]`)}}const c=zN(i,a,l,u),h=Je(a.shape),f=[],p=vt({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),g=vt({inputs:{x:a},backend:n,attrs:{shape:[c.batchSize,h/c.batchSize]}});f.push(p),f.push(g);const y=[c.batchSize,c.outerSize,h/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,a])||i.dtype==="string"){const w=n.bufferSync(g),E=n.bufferSync(p),_=DSe(E,w,y);return f.forEach(D=>n.disposeIntermediateTensorInfo(D)),n.makeTensorInfo(c.outputShape,_.dtype,_.values)}const x=new mTe(p.shape,y),v=n.runWebGLProgram(x,[p,g],p.dtype);f.push(v);const S=vt({inputs:{x:v},backend:n,attrs:{shape:c.outputShape}});return f.forEach(w=>n.disposeIntermediateTensorInfo(w)),S}const yTe={kernelName:Mv,backendName:"webgl",kernelFunc:Cj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xTe="return float(a > b);",bTe=`
  return vec4(greaterThan(a, b));
`,vTe=Fs({opSnippet:xTe,packedOpSnippet:bTe,cpuKernelImpl:TSe,dtype:"bool"}),wTe={kernelName:Lv,backendName:"webgl",kernelFunc:vTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const STe="return float(a >= b);",CTe=`
  return vec4(greaterThanEqual(a, b));
`,_Te=Fs({opSnippet:STe,packedOpSnippet:CTe,dtype:"bool",cpuKernelImpl:NSe}),ETe={kernelName:Qg,backendName:"webgl",kernelFunc:_Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DTe(r){const{inputs:t,backend:n}=r,{input:s}=t;return Sj(s,!0,n)}const TTe={kernelName:d3,backendName:"webgl",kernelFunc:DTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NTe="return float(!isnan(x) && !isinf(x));",kTe=kn({opSnippet:NTe,dtype:"bool"}),ATe={kernelName:e0,backendName:"webgl",kernelFunc:kTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe="return float(isinf(x));",$Te=kn({opSnippet:ITe,dtype:"bool"}),FTe={kernelName:t0,backendName:"webgl",kernelFunc:$Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RTe="return float(isnan(x));",OTe=kn({opSnippet:RTe,dtype:"bool"}),MTe={kernelName:n0,backendName:"webgl",kernelFunc:OTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LTe="return float(a < b);",BTe=`
  return vec4(lessThan(a, b));
`,PTe=Fs({opSnippet:LTe,packedOpSnippet:BTe,cpuKernelImpl:kSe,dtype:"bool"}),VTe={kernelName:Pv,backendName:"webgl",kernelFunc:PTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe="return float(a <= b);",UTe=`
  return vec4(lessThanEqual(a, b));
`,GTe=Fs({opSnippet:zTe,packedOpSnippet:UTe,cpuKernelImpl:ASe,dtype:"bool"}),jTe={kernelName:Vv,backendName:"webgl",kernelFunc:GTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WTe(r){const{backend:t,attrs:n}=r,{start:s,stop:i,num:a}=n,o=ISe(s,i,a);return t.makeTensorInfo([o.length],"float32",o)}const HTe={kernelName:kP,backendName:"webgl",kernelFunc:WTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qTe=tp+`
  return x < 0.0 ? 0./0. : log(x);
`,KTe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,XTe=kn({opSnippet:qTe,packedOpSnippet:KTe,cpuKernelImpl:$Se}),YTe={kernelName:r0,backendName:"webgl",kernelFunc:XTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZTe=tp+`
  return log(1.0 + x);
`,QTe=kn({opSnippet:ZTe}),JTe={kernelName:s0,backendName:"webgl",kernelFunc:QTe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e3e="return float(a >= 1.0 && b >= 1.0);",t3e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,n3e=Fs({opSnippet:e3e,packedOpSnippet:t3e,dtype:"bool"}),r3e={kernelName:zv,backendName:"webgl",kernelFunc:n3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s3e="return float(!(x >= 1.0));",i3e=kn({opSnippet:s3e}),a3e={kernelName:Uv,backendName:"webgl",kernelFunc:i3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o3e="return float(a >= 1.0 || b >= 1.0);",u3e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,l3e=Fs({opSnippet:o3e,packedOpSnippet:u3e,dtype:"bool"}),c3e={kernelName:Gv,backendName:"webgl",kernelFunc:l3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h3e{constructor(t,n,s,i,a){this.variableNames=["x"],this.outputShape=[];const o=n,u=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${u}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f3e{constructor(t,n,s,i,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,u=t[3]-1;this.outputShape=t;let l;const c=`float(${s}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${c})`:a===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${u}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d3e=r=>{const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{depthRadius:a,bias:o,alpha:u,beta:l}=s,c=Ke().getBool("WEBGL_PACK_NORMALIZATION")?new f3e(i.shape,a,o,u,l):new h3e(i.shape,a,o,u,l);return n.runWebGLProgram(c,[i],i.dtype)},p3e={kernelName:jv,backendName:"webgl",kernelFunc:d3e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m3e{constructor(t,n,s,i,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=s,this.alpha=i,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${a})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3e=r=>{const{inputs:t,backend:n,attrs:s}=r,{x:i,y:a,dy:o}=t,{depthRadius:u,bias:l,alpha:c,beta:h}=s,f=new m3e(i.shape,u,l,c,h);return n.runWebGLProgram(f,[i,a,o],i.dtype)},y3e={kernelName:m3,backendName:"webgl",kernelFunc:g3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x3e(r,t,n,s){const i=Je(t),o=Je(r.shape)/i,u=vt({inputs:{x:r},attrs:{shape:[o,i]},backend:s}),l=$h(u,r.dtype,"max",s),c=vt({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(u),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _j(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{reductionIndices:a,keepDims:o}=s,u=i.shape.length,l=dn(a,i.shape);let c=l;const h=Dr(c,u),f=h!=null,p=n.shouldExecuteOnCPU([i]);let g=i;if(f){if(p){const E=n.texData.get(g.dataId).values,_=new Array(u);for(let k=0;k<_.length;k++)_[k]=i.shape[h[k]];const D=Dk(E,i.shape,i.dtype,h,_);g=n.makeTensorInfo(_,i.dtype);const I=n.texData.get(g.dataId);I.values=D}else g=H2(i,h,n);c=Mr(c.length,u)}$s("max",c,u);const[y,x]=bs(g.shape,c);let v=y;o&&(v=Hr(y,l));let S;if(p){const E=n.texData.get(g.dataId).values,_=FSe(E,Je(x),v,i.dtype);S=n.makeTensorInfo(v,i.dtype);const D=n.texData.get(S.dataId);D.values=_}else S=x3e(g,x,v,n);return f&&n.disposeIntermediateTensorInfo(g),S}const b3e={kernelName:Wv,backendName:"webgl",kernelFunc:_j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3e=Tk+`
  return max(a, b);
`,w3e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+K0+`
  return result;
`,S3e=Fs({opSnippet:v3e,packedOpSnippet:w3e,cpuKernelImpl:RSe}),C3e={kernelName:i0,backendName:"webgl",kernelFunc:S3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t;H0(i,"maxPool");const{filterSize:a,strides:o,pad:u,dimRoundingMode:l}=s,c=1;oe(Gs(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const h=Ra(i.shape,a,o,c,u,l);if(h.filterWidth===1&&h.filterHeight===1&&Bn(h.inShape,h.outShape))return Mi({inputs:{x:i},backend:n});const f=new xg(h,"max",!1);return n.runWebGLProgram(f,[i],i.dtype)}const E3e={kernelName:Hv,backendName:"webgl",kernelFunc:_3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D3e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{filterSize:a,strides:o,pad:u,dataFormat:l,dimRoundingMode:c}=s,h=[1,1,1],f=Iu(i.shape,a,o,h,u,c,l),p=new kk(f,"max",!1);return n.runWebGLProgram(p,[i],i.dtype)}const T3e={kernelName:qv,backendName:"webgl",kernelFunc:D3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N3e{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideHeight,s=t.strideWidth,i=t.dilationHeight,a=t.effectiveFilterHeight,o=t.effectiveFilterWidth,u=a-1-t.padInfo.top,l=o-1-t.padInfo.left,c=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(${u}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class k3e{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const n=t.strideDepth,s=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,l=t.effectiveFilterDepth,c=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=l-1-t.padInfo.front,p=c-1-t.padInfo.top,g=h-1-t.padInfo.left,y=l*c*h-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${p}, ${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A3e(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a}=t,o=a,{filterSize:u,strides:l,pad:c,dimRoundingMode:h}=s,f=[1,1,1],p=Iu(o.shape,u,l,f,c,h),g=new kk(p,"max",!0),y=n.runWebGLProgram(g,[o],o.dtype),x=new k3e(p),v=n.runWebGLProgram(x,[i,y],o.dtype);return n.disposeIntermediateTensorInfo(y),v}const I3e={kernelName:y3,backendName:"webgl",kernelFunc:A3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3e(r){const{inputs:t,backend:n,attrs:s}=r,{dy:i,input:a,output:o}=t,u=a;H0([a,o],"maxPoolGrad");const{filterSize:l,strides:c,pad:h,dimRoundingMode:f}=s,p=Ra(u.shape,l,c,1,h,f),g=!0,y=new xg(p,"max",g),x=n.runWebGLProgram(y,[u],u.dtype),v=new N3e(p),S=n.runWebGLProgram(v,[i,x],u.dtype);return n.disposeIntermediateTensorInfo(x),S}const F3e={kernelName:g3,backendName:"webgl",kernelFunc:$3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(r,t,n,s){let i=new xg(n,"max",!1);const a=s.runWebGLProgram(i,[r],"float32");i=new xg(n,"max",!0,!0,t);const o=s.runWebGLProgram(i,[r],"float32");return[a,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O3e={kernelName:AP,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:s}=r,{filterSize:i,strides:a,pad:o,includeBatchInIndex:u}=t,l=n;oe(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];oe(Gs(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const h=Ra(s.shape,i,a,c,o),[f,p]=R3e(s,u,h,l);return[f,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3e(r,t,n,s){const i=Je(t),o=Je(r.shape)/i,u=vt({inputs:{x:r},attrs:{shape:[o,i]},backend:s}),l=$h(u,"float32","mean",s),c=vt({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(u),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3e={kernelName:Kv,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{x:s}=r,{keepDims:i,axis:a}=t,o=n,u=s.shape.length,l=dn(a,s.shape);let c=l;const h=Dr(c,u),f=h!=null,p=o.shouldExecuteOnCPU([s]),g=[];let y=s;if(f){if(p){const _=o.texData.get(y.dataId).values,D=new Array(u);for(let A=0;A<D.length;A++)D[A]=s.shape[h[A]];const I=Dk(_,s.shape,s.dtype,h,D);y=o.makeTensorInfo(D,s.dtype);const k=o.texData.get(y.dataId);k.values=I}else y=H2(s,h,o);g.push(y),c=Mr(c.length,u)}$s("sum",c,u);const[x,v]=bs(y.shape,c);let S=x;i&&(S=Hr(x,l));const w=M3e(y,v,S,o);for(const E of g)o.disposeIntermediateTensorInfo(E);return w}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s,u=i.shape.length,l=dn(a,i.shape);let c=l;const h=Dr(c,u);let f=i;h!=null&&(f=ti({inputs:{x:i},backend:n,attrs:{perm:h}}),c=Mr(c.length,i.shape.length)),$s("min",c,u);const[p,g]=bs(f.shape,c),y=Je(g),x=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),v=$h(x,x.dtype,"min",n);let S;if(o){const w=Hr(p,l);S=vt({inputs:{x:v},backend:n,attrs:{shape:w}})}else S=vt({inputs:{x:v},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),h!=null&&n.disposeIntermediateTensorInfo(f),S}const P3e={kernelName:Xv,backendName:"webgl",kernelFunc:B3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3e=Tk+`
  return min(a, b);
`,z3e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+K0+`
  return result;
`,U3e=Fs({opSnippet:V3e,packedOpSnippet:z3e,cpuKernelImpl:OSe}),G3e={kernelName:a0,backendName:"webgl",kernelFunc:U3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j3e{constructor(t,n,s){this.variableNames=["x"],this.outputShape=n.map((h,f)=>h[0]+t[f]+h[1]);const i=t.length,a=cr(i),o=n.map(h=>h[0]).join(","),u=n.map((h,f)=>h[0]+t[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c=s==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${o};
        int end = ${u};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${u});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W3e{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((y,x)=>y[0]+t[x]+y[1]);const i=t.length,a=cr(i),o=n.map(y=>y[0]).join(","),u=n.map((y,x)=>y[0]+t[x]).join(","),l=Qs("rc",i),c=Qs("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${c.slice(-2).join()})`,p=s==="reflect"?0:1;let g="";if(i===1){const y=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[i-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
      `}else{const y=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;g=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${c.join()}), ${f});
        ${l[i-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${c.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${y}
          result[2] = getChannel(getX(${c.join()}), ${f});
          ${l[i-1]} += 1;
          if(${h}) {
            ${y}
            result[3] = getChannel(getX(${c.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${u});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3e=({inputs:r,backend:t,attrs:n})=>{const{x:s}=r,{paddings:i,mode:a}=n,o=Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new W3e(s.shape,i,a):new j3e(s.shape,i,a);return t.runWebGLProgram(o,[s],s.dtype)},q3e={kernelName:Yv,backendName:"webgl",kernelFunc:H3e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K3e=`if (b == 0.0) return NAN;
  return mod(a, b);`,X3e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+K0+`
  return result;
`,Y3e=Fs({opSnippet:K3e,packedOpSnippet:X3e}),Z3e={kernelName:o0,backendName:"webgl",kernelFunc:Y3e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q3e{constructor(t,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3e=`
if (a == b) {
  return 1.0;
};
return a / b;`,eNe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,Ej=Fs({opSnippet:J3e,packedOpSnippet:eNe,checkOutOfBounds:!0}),tNe={kernelName:Wg,backendName:"webgl",kernelFunc:Ej};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HM="return a - b;",Dj=Fs({opSnippet:HM,packedOpSnippet:HM,supportsComplex:!0,cpuKernelImpl:eCe}),nNe={kernelName:C0,backendName:"webgl",kernelFunc:Dj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tj(r){const{inputs:t,backend:n,attrs:s}=r,{logits:i}=t,{dim:a}=s,o=dn([a],i.shape),u=_j({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=Hr(u.shape,o),c=vt({inputs:{x:u},backend:n,attrs:{shape:l}}),h=Dj({inputs:{a:i,b:c},backend:n}),f=wj({inputs:{x:h},backend:n}),p=q2({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),g=vt({inputs:{x:p},backend:n,attrs:{shape:l}}),y=Ej({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),y}const rNe={kernelName:p2,backendName:"webgl",kernelFunc:Tj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(r){const{inputs:t,backend:n,attrs:s}=r,{logits:i}=t,{numSamples:a,seed:o,normalized:u}=s,l=u?i:Tj({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=l.shape[0],h=l.shape[1],f=new Q3e(c,h,a),p=[[o]],g=n.runWebGLProgram(f,[l],"int32",p);return u||n.disposeIntermediateTensorInfo(l),g}const iNe={kernelName:IP,backendName:"webgl",kernelFunc:sNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aNe=La+`
  return -x;
`,oNe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function uNe(r){const{inputs:t,backend:n}=r,{x:s}=t;if(n.shouldExecuteOnCPU([s])){const a=n.texData.get(s.dataId),[o,u]=LSe(a.values,s.shape,s.dtype);return n.makeTensorInfo(u,s.dtype,o)}let i;return Ke().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new Fc(s.shape,oNe):i=new gu(s.shape,aNe),n.runWebGLProgram(i,[s],s.dtype)}const lNe={kernelName:Zv,backendName:"webgl",kernelFunc:uNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cNe=dN;function hNe(r){Hi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l}=s,c=n.readSync(i.dataId),h=n.readSync(a.dataId),{selectedIndices:f}=cNe(c,h,o,u,l);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const fNe={kernelName:x3,backendName:"webgl",kernelFunc:hNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dNe=pN;function pNe(r){Hi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l,padToMaxOutputSize:c}=s,h=n.readSync(i.dataId),f=n.readSync(a.dataId),{selectedIndices:p,validOutputs:g}=dNe(h,f,o,u,l,c);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([g]))]}const mNe={kernelName:b3,backendName:"webgl",kernelFunc:pNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gNe=mN;function yNe(r){Hi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:n,attrs:s}=r,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:u,scoreThreshold:l,softNmsSigma:c}=s,h=n.readSync(i.dataId),f=n.readSync(a.dataId),p=o,g=u,y=l,x=c,{selectedIndices:v,selectedScores:S}=gNe(h,f,p,g,y,x);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const xNe={kernelName:v3,backendName:"webgl",kernelFunc:yNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bNe{constructor(t,n,s,i){this.variableNames=["indices"],this.outputShape=[t,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vNe=r=>{const{inputs:t,backend:n,attrs:s}=r,{indices:i}=t,{dtype:a,depth:o,onValue:u,offValue:l}=s,c=Je(i.shape),h=new bNe(c,o,u,l),f=vt({inputs:{x:i},backend:n,attrs:{shape:[c]}}),p=n.runWebGLProgram(h,[f],a);n.disposeIntermediateTensorInfo(f);const g=[...i.shape,o],y=vt({inputs:{x:p},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(p),y},wNe={kernelName:e2,backendName:"webgl",kernelFunc:vNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sb(r){const{inputs:t,backend:n}=r,{x:s}=t;if(s.dtype==="complex64"){const i=Y0({inputs:{input:s},backend:n}),a=Sb({inputs:{x:i},backend:n}),o=K2({inputs:{input:s},backend:n}),u=Sb({inputs:{x:o},backend:n}),l=Xl({inputs:{real:a,imag:u},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}else return Z0({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const SNe={kernelName:y2,backendName:"webgl",kernelFunc:Sb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj(r){const{inputs:t,backend:n}=r,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const i=Y0({inputs:{input:s},backend:n}),a=Nj({inputs:{x:i},backend:n}),o=K2({inputs:{input:s},backend:n}),u=Sb({inputs:{x:o},backend:n}),l=Xl({inputs:{real:a,imag:u},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),l}else return Z0({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const CNe={kernelName:Jv,backendName:"webgl",kernelFunc:Nj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne(r){const{inputs:t,backend:n,attrs:s}=r,{axis:i}=s;if(t.length===1)return hD({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const a=t[0].shape,o=t[0].dtype;t.forEach(h=>{WT(a,h.shape,"All tensors passed to stack must have matching shapes"),oe(o===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const u=[],l=t.map(h=>{const f=hD({inputs:{input:h},backend:n,attrs:{dim:i}});return u.push(f),f}),c=dj({inputs:l,backend:n,attrs:{axis:i}});return u.forEach(h=>n.disposeIntermediateTensorInfo(h)),c}const ENe={kernelName:t2,backendName:"webgl",kernelFunc:_Ne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DNe{constructor(t,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,h)=>c[0]+t[h]+c[1]);const i=t.length,a=cr(i),o=n.map(c=>c[0]).join(","),u=n.map((c,h)=>c[0]+t[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${o};
        int end = ${u};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${u});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TNe{constructor(t,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((x,v)=>x[0]+t[v]+x[1]);const i=t.length,a=cr(i),o=n.map(x=>x[0]).join(","),u=n.map((x,v)=>x[0]+t[v]).join(","),l=Qs("rc",i),c=Qs("source",i),h=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${c.slice(-2).join()})`,p=[`${a} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${h}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${h}) {`],g=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let x=0,v=i===1?2:4;x<v;x++)y+=`
        ${p[x]}
        if (${g}) {
          result[${x}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${x}] = getChannel(getX(${c.join()}), ${f});
        }
      `;y+=i===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${u});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kj=r=>{const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{paddings:a,constantValue:o}=s;if(Je(i.shape)===0){const c=a.map((h,f)=>h[0]+i.shape[f]+h[1]);return Z0({backend:n,attrs:{shape:c,value:o,dtype:i.dtype}})}const u=Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TNe(i.shape,a,o):new DNe(i.shape,a,o),l=[[o]];return n.runWebGLProgram(u,[i],i.dtype,l)},NNe={kernelName:n2,backendName:"webgl",kernelFunc:kj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kNe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,ANe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+K0+`
  return result;
`,INe=Fs({opSnippet:kNe,packedOpSnippet:ANe}),$Ne={kernelName:l0,backendName:"webgl",kernelFunc:INe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{axis:a,keepDims:o}=s,u=i.shape.length,l=[],c=dn(a,i.shape);let h=c;const f=Dr(h,u);let p=i;f!=null&&(p=ti({inputs:{x:i},backend:n,attrs:{perm:f}}),h=Mr(h.length,u),l.push(p)),$s("prod",h,u);let g;if(n.shouldExecuteOnCPU([p])){const y=n.texData.get(p.dataId).values,{outVals:x,outShape:v,outDtype:S}=PSe(p.shape,p.dtype,y,h);g=n.makeTensorInfo(v,S,x)}else{const[y,x]=bs(p.shape,h),v=Je(x),S=vt({inputs:{x:p},backend:n,attrs:{shape:[-1,v]}}),w=I3(i.dtype),E=$h(S,w,"prod",n);g=vt({inputs:{x:E},backend:n,attrs:{shape:y}}),l.push(S),l.push(E)}if(o){l.push(g);const y=Hr(g.shape,c);g=vt({inputs:{x:g},backend:n,attrs:{shape:y}})}return l.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const RNe={kernelName:s2,backendName:"webgl",kernelFunc:FNe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(r){const{inputs:t,backend:n,attrs:s}=r,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:u}=s,l=i.map(S=>n.readSync(S.dataId)),c=i.map(S=>S.shape),h=n.readSync(a.dataId),f=n.readSync(o.dataId),[p,g,y]=VSe(l,c,h,a.shape,a.dtype,f,o.shape,u),x=p.map(S=>n.makeTensorInfo([S.length],"int32",S)),v=n.makeTensorInfo(y,a.dtype,g);return x.concat([v])}const MNe={kernelName:$P,backendName:"webgl",kernelFunc:ONe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(r){const{inputs:t,backend:n,attrs:s}=r,{shape:i,values:a,defaultValue:o,rowPartitionTensors:u}=t,{rowPartitionTypes:l}=s,c=n.readSync(i.dataId),h=n.readSync(a.dataId),f=n.readSync(o.dataId),p=u.map(v=>n.readSync(v.dataId)),g=u.map(v=>v.shape),[y,x]=zSe(c,i.shape,h,a.shape,a.dtype,f,o.shape,p,g,l);return n.makeTensorInfo(y,a.dtype,x)}const BNe={kernelName:FP,backendName:"webgl",kernelFunc:LNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aj=r=>{const{backend:t,attrs:n}=r,{start:s,stop:i,step:a,dtype:o}=n,u=USe(s,i,a,o);return t.makeTensorInfo([u.length],o,u)},PNe={kernelName:w3,backendName:"webgl",kernelFunc:Aj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VNe="return 1.0 / x;",zNe=kn({opSnippet:VNe}),UNe={kernelName:c0,backendName:"webgl",kernelFunc:zNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GNe=La+`
  return (x < 0.0) ? 0.0 : x;
`,jNe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,WNe=kn({opSnippet:GNe,packedOpSnippet:jNe}),HNe={kernelName:h0,backendName:"webgl",kernelFunc:WNe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qNe=La+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,KNe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XNe=kn({opSnippet:qNe,packedOpSnippet:KNe}),YNe={kernelName:f0,backendName:"webgl",kernelFunc:XNe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZNe{constructor(t,n,s,i,a){this.variableNames=["A"],this.outputShape=[];const[o,u,l,c]=t;this.outputShape=[o,n,s,c];const h=[i&&n>1?u-1:u,i&&s>1?l-1:l],f=[i&&n>1?n-1:n,i&&s>1?s-1:s];let p;a?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${u}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QNe{constructor(t,n,s,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,u,l,c]=t;this.outputShape=[o,n,s,c];const h=[i&&n>1?u-1:u,i&&s>1?l-1:l],f=[i&&n>1?n-1:n,i&&s>1?s-1:s];let p;a?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${u}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(r){const{inputs:t,backend:n,attrs:s}=r,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:u}=s,[l,c]=u,h=Ke().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new QNe(i.shape,l,c,a,o):new ZNe(i.shape,l,c,a,o);return n.runWebGLProgram(h,[i],"float32")}const eke={kernelName:o2,backendName:"webgl",kernelFunc:JNe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tke{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,a]=n,[,o,u]=t,l=[s&&o>1?i-1:i,s&&u>1?a-1:a],c=[s&&o>1?o-1:o,s&&u>1?u-1:u],h=l[0]/c[0],f=l[1]/c[1],p=1/h,g=1/f,y=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${u}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nke(r){const{inputs:t,backend:n,attrs:s}=r,{images:i,dy:a}=t,{alignCorners:o}=s,u=new tke(a.shape,i.shape,o);return n.runWebGLProgram(u,[a],a.dtype)}const rke={kernelName:_3,backendName:"webgl",kernelFunc:nke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ske{constructor(t,n,s,i,a){this.variableNames=["A"],this.outputShape=[];const[o,u,l,c]=t;this.outputShape=[o,n,s,c];const h=[i&&n>1?u-1:u,i&&s>1?l-1:l],f=[i&&n>1?n-1:n,i&&s>1?s-1:s],p=i?"0.5":"0.0";let g;a?g="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":g="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${u}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ike{constructor(t,n,s,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,u,l,c]=t;this.outputShape=[o,n,s,c];const h=[i&&n>1?u-1:u,i&&s>1?l-1:l],f=[i&&n>1?n-1:n,i&&s>1?s-1:s],p=i?"0.5":"0.0";let g;a?g="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":g="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${u}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${g};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ake(r){const{inputs:t,backend:n,attrs:s}=r,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:u}=s,[l,c]=u,h=Ke().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ike(i.shape,l,c,a,o):new ske(i.shape,l,c,a,o);return n.runWebGLProgram(h,[i],i.dtype)}const oke={kernelName:a2,backendName:"webgl",kernelFunc:ake};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uke{constructor(t,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,a]=n,[,o,u]=t,l=[s&&o>1?i-1:i,s&&u>1?a-1:a],c=[s&&o>1?o-1:o,s&&u>1?u-1:u],h=l[0]/c[0],f=l[1]/c[1],p=1/h,g=1/f,y=Math.ceil(p)*2+2,x=Math.ceil(g)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${g});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${u}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(r){const{inputs:t,backend:n,attrs:s}=r,{images:i,dy:a}=t,{alignCorners:o}=s,u=new uke(a.shape,i.shape,o);return n.runWebGLProgram(u,[a],a.dtype)}const cke={kernelName:C3,backendName:"webgl",kernelFunc:lke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hke{constructor(t,n){this.variableNames=["x"];const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=t,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const i=u=>n.indexOf(u)!==-1&&t[u]!==1?`${t[u]} - coords[${u}] - 1`:`coords[${u}]`,a=t.map((u,l)=>i(l)).join(","),o=cr(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fke{constructor(t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=t;const i=Qs("rc",s),a=`${i[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${i[s-2]} + 1 < ${this.outputShape[s-2]}`,u=cr(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${u} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${a}){
            result.g = ${c(i.slice())};
          }
          if(${o}) {
            result.b = ${h(i.slice())};
            if(${a}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(y){return p(y)}function c(y){return y[s-1]="("+y[s-1]+" + 1)",p(y)}function h(y){return y[s-2]="("+y[s-2]+" + 1)",p(y)}function f(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",p(y)}function p(y){const x=t.map((w,E)=>g(E,y)),v=x.join(","),S=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${S}))`}function g(y,x){return n.indexOf(y)!==-1&&t[y]!==1?`${t[y]} - ${x[y]} - 1`:`${x[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dke(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{dims:a}=s,o=i.shape.length,u=dn(a,i.shape);if(o===0)return Mi({inputs:{x:i},backend:n});const l=Ke().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fke(i.shape,u):new hke(i.shape,u);return n.runWebGLProgram(l,[i],i.dtype)}const pke={kernelName:u2,backendName:"webgl",kernelFunc:dke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mke{constructor(t,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=t[1],i=t[2];this.outputShape=t;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gke={kernelName:A3,backendName:"webgl",kernelFunc:({inputs:r,attrs:t,backend:n})=>{const{image:s}=r,{radians:i,fillValue:a,center:o}=t,u=n,l=new mke(s.shape,a),[c,h]=EN(o,s.shape[1],s.shape[2]),f=[[c,h,Math.sin(i),Math.cos(i)]];return u.runWebGLProgram(l,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yke=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,xke=kn({opSnippet:yke}),bke={kernelName:d0,backendName:"webgl",kernelFunc:xke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vke="return inversesqrt(x);",wke=kn({opSnippet:vke,cpuKernelImpl:GSe}),Ske={kernelName:p0,backendName:"webgl",kernelFunc:wke};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ij{constructor(t,n,s,i,a,o,u=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=cr(a.length),c=cr(o.length);let h="";s===1?h="i":s===2&&(h="i, j");const f=`getIndices(${h})`;let p="";i===1?p="i":i===2&&(p="i, coords[1]");const g=`getUpdates(${p})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${g};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(r){const{inputs:t,backend:n,attrs:s}=r,{indices:i,updates:a}=t,{shape:o}=s,{sliceRank:u,numUpdates:l,sliceSize:c,strides:h,outputSize:f}=k0(a,i,o),p=[f/c,c];if(f===0)return n.makeTensorInfo(o,i.dtype);const g=vt({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),y=vt({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),x=n.makeTensorInfo([],"float32",new Float32Array([0])),v=new Ij(l,u,g.shape.length,y.shape.length,h,p),S=n.runWebGLProgram(v,[y,g,x],y.dtype),w=vt({inputs:{x:S},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(x),w}const _ke={kernelName:RP,backendName:"webgl",kernelFunc:Cke};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eke{constructor(t,n,s,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,s];const a="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,u=Ke().getNumber("WEBGL_VERSION")===2?a:o,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${u}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(r){const{inputs:t,backend:n,attrs:s}=r,{sortedSequence:i,values:a}=t,{side:o}=s,u=new Eke(i.shape[0],i.shape[1],a.shape[1],o),l=[[i.shape[1]]];return n.runWebGLProgram(u,[i,a],"int32",l)}const Tke={kernelName:OP,backendName:"webgl",kernelFunc:Dke};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nke{constructor(t,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let i,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",i="resRC";else{const u=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let h=0;h<n.length;h++)c.push(`${u[h]}`),h<t&&l.push(`${u[h]}`);i=l.join(),a=c.join()}const o=cr(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kke(r){const{inputs:t,backend:n}=r,{condition:s,t:i,e:a}=t,o=new Nke(s.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[s,i,a],$i(i.dtype,a.dtype))}const Ake={kernelName:l2,backendName:"webgl",kernelFunc:kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ike=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${A2};
  float scale = ${I2};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,$ke=kn({opSnippet:Ike}),Fke={kernelName:m0,backendName:"webgl",kernelFunc:$ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rke=tp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Oke=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Mke=kn({opSnippet:Rke,packedOpSnippet:Oke,cpuKernelImpl:WSe}),Lke={kernelName:b0,backendName:"webgl",kernelFunc:Mke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bke=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Pke=kn({opSnippet:Bke}),Vke={kernelName:x0,backendName:"webgl",kernelFunc:Pke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zke=tp+`
  return sin(x);
`,Uke=kn({opSnippet:zke}),Gke={kernelName:g0,backendName:"webgl",kernelFunc:Uke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jke=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Wke=kn({opSnippet:jke}),Hke={kernelName:y0,backendName:"webgl",kernelFunc:Wke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qke=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Kke=kn({opSnippet:qke}),Xke={kernelName:v0,backendName:"webgl",kernelFunc:Kke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yke=r=>{const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{blockShape:a,paddings:o}=s;oe(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const u=a.reduce((S,w)=>S*w),l=[[0,0]];l.push(...o);for(let S=1+a.length;S<i.shape.length;++S)l.push([0,0]);const c=[],h=kj({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),f=R0(h.shape,a,u,!1),p=O0(f.length,a.length,!1),g=M0(h.shape,a,u,!1),y=vt({inputs:{x:h},backend:n,attrs:{shape:f}}),x=ti({inputs:{x:y},backend:n,attrs:{perm:p}}),v=vt({inputs:{x},backend:n,attrs:{shape:g}});return c.push(h),c.push(y),c.push(x),c.forEach(S=>n.disposeIntermediateTensorInfo(S)),v},Zke={kernelName:f2,backendName:"webgl",kernelFunc:Yke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qke(r){const{inputs:t,backend:n}=r,{indices:s,values:i,denseShape:a,defaultValue:o}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const u=n.readSync(s.dataId),l=n.readSync(i.dataId),c=n.readSync(a.dataId),h=n.readSync(o.dataId)[0],[f,p,g,y,x]=qSe(u,s.shape,s.dtype,l,i.dtype,c,h);return[n.makeTensorInfo(p,s.dtype,f),n.makeTensorInfo([p[0]],i.dtype,g),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),n.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const Jke={kernelName:MP,backendName:"webgl",kernelFunc:Qke};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eAe(r){const{inputs:t,backend:n}=r,{inputIndices:s,inputShape:i,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.readSync(i.dataId)),u=n.readSync(s.dataId),l=Array.from(n.readSync(a.dataId)),[c,h,f]=KSe(u,s.shape,s.dtype,o,l);return[n.makeTensorInfo(h,s.dtype,c),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const tAe={kernelName:LP,backendName:"webgl",kernelFunc:eAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nAe(r){const{inputs:t,backend:n}=r,{data:s,indices:i,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const o=n.readSync(s.dataId),u=n.readSync(i.dataId),l=n.readSync(a.dataId),[c,h]=ej(o,s.shape,s.dtype,u,l,!0);return n.makeTensorInfo(h,s.dtype,c)}const rAe={kernelName:BP,backendName:"webgl",kernelFunc:nAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sAe(r){const{inputs:t,backend:n}=r,{data:s,indices:i,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const o=n.readSync(s.dataId),u=n.readSync(i.dataId),l=n.readSync(a.dataId),[c,h]=ej(o,s.shape,s.dtype,u,l);return n.makeTensorInfo(h,s.dtype,c)}const iAe={kernelName:PP,backendName:"webgl",kernelFunc:sAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aAe(r){const{inputs:t,backend:n,attrs:s}=r,{sparseIndices:i,sparseValues:a,defaultValue:o}=t,{outputShape:u}=s,{sliceRank:l,numUpdates:c,sliceSize:h,strides:f,outputSize:p}=k0(a,i,u),g=!1;if(a.dtype==="string"){const S=n.bufferSync(i),w=n.bufferSync(a),E=Fl(n.readSync(o.dataId)[0]),_=jSe(S,w,u,p,h,c,l,f,E,g);return n.makeTensorInfo(u,_.dtype,_.values)}const y=new Ij(c,l,i.shape.length,a.shape.length,f,[p,1],g),x=n.runWebGLProgram(y,[a,i,o],a.dtype),v=vt({inputs:{x},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(x),v}const oAe={kernelName:VP,backendName:"webgl",kernelFunc:aAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uAe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{numOrSizeSplits:a,axis:o}=s,u=dn(o,i.shape)[0],l=VN(i,a,u),c=i.shape.length,h=new Array(c).fill(0),f=i.shape.slice();return l.map(p=>{const g=[...f];g[u]=p;const y=np({inputs:{x:i},backend:n,attrs:{begin:h,size:g}});return h[u]+=p,y})}const lAe={kernelName:d2,backendName:"webgl",kernelFunc:uAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qM="return sqrt(x);",cAe=kn({opSnippet:qM,packedOpSnippet:qM,cpuKernelImpl:XSe}),hAe={kernelName:w0,backendName:"webgl",kernelFunc:cAe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fAe="return x * x;",dAe=kn({opSnippet:fAe}),pAe={kernelName:E3,backendName:"webgl",kernelFunc:dAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KM="return (a - b) * (a - b);",mAe=Fs({opSnippet:KM,packedOpSnippet:KM}),gAe={kernelName:S0,backendName:"webgl",kernelFunc:mAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yAe({inputs:r,attrs:t,backend:n}){const{x:s}=r,i=La+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new gu(s.shape,i);return n.runWebGLProgram(a,[s],s.dtype)}const xAe={kernelName:T0,backendName:"webgl",kernelFunc:yAe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bAe{constructor(t,n,s){this.variableNames=["x"],this.outputShape=s;const i=s.length,a=cr(s.length),o=cr(s.length);let u="";if(i===1)u="coords * strides + begin";else{let l=0;u=s.map((c,h)=>(l++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${t});
      ${a} strides = ${a}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vAe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{begin:a,end:o,strides:u,beginMask:l,endMask:c,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s,{finalShapeSparse:g,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:S,begin:w,end:E,strides:_}=V3(i.shape,a,o,u,l,c,h,f,p);let D;if(x)D=vt({inputs:{x:i},backend:n,attrs:{shape:y}});else if(v||S){oe(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const k=L3(w,E,_),A=np({inputs:{x:i},backend:n,attrs:{begin:w,size:k}});D=vt({inputs:{x:A},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(A)}else if(n.shouldExecuteOnCPU([i])){const A=n.readSync(i.dataId),N=hn(i.shape,i.dtype,A),F=YSe(g,N,_,w);D=n.makeTensorInfo(y,i.dtype,F.values)}else{const A=new bAe(w,_,g);D=n.runWebGLProgram(A,[i],i.dtype)}const I=vt({inputs:{x:D},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(D),I}const wAe={kernelName:D3,backendName:"webgl",kernelFunc:vAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SAe(r){const{inputs:t,backend:n,attrs:s}=r,{separator:i,nGramWidths:a,leftPad:o,rightPad:u,padWidth:l,preserveShortSequences:c}=s,{data:h,dataSplits:f}=t,p=n.readSync(h.dataId),g=n.readSync(f.dataId),[y,x]=ZSe(p,g,i,a,o,u,l,c);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(f.shape,"int32",x)]}const CAe={kernelName:zP,backendName:"webgl",kernelFunc:SAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ae(r){const{inputs:t,backend:n,attrs:s}=r,{skipEmpty:i}=s,{input:a,delimiter:o}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const u=n.readSync(a.dataId),l=n.readSync(o.dataId)[0],[c,h,f]=QSe(u,l,i),p=h.length;return[n.makeTensorInfo([p,2],"int32",c),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const EAe={kernelName:UP,backendName:"webgl",kernelFunc:_Ae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DAe(r){const{inputs:t,backend:n,attrs:s}=r,{numBuckets:i}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(a.dataId),u=JSe(o,i);return n.makeTensorInfo(a.shape,"int32",u)}const TAe={kernelName:GP,backendName:"webgl",kernelFunc:DAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NAe="return tan(x);",kAe=kn({opSnippet:NAe}),AAe={kernelName:_0,backendName:"webgl",kernelFunc:kAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IAe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,$Ae=kn({opSnippet:IAe}),FAe={kernelName:E0,backendName:"webgl",kernelFunc:$Ae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RAe{constructor(t,n){this.variableNames=["A"];const s=new Array(t.length);for(let o=0;o<s.length;o++)s[o]=t[o]*n[o];this.outputShape=s,this.rank=s.length;const i=cr(this.rank),a=OAe(t);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function OAe(r){const t=r.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${r[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let i=0;i<r.length;i++)s.push(`imod(${n[i]}, ${r[i]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $j(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{reps:a}=s;if(i.dtype==="string"||i.shape.length>5){const l=n.readSync(i.dataId),c=i.dtype==="string"?l.map(p=>Fl(p)):l,h=hn(i.shape,i.dtype,c),f=tCe(h,a);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const o=new RAe(i.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}const MAe={kernelName:D0,backendName:"webgl",kernelFunc:$j};class LAe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class BAe{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(r,t){t!==null&&r.disposeIntermediateTensorInfo(t)}function XM(r){let t=1;for(;t<r;)t*=2;return t}function PAe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i}=t,{k:a,sorted:o}=s,u=Ke().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Ke().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,h=c[c.length-1];if(n.shouldExecuteOnCPU([i])||h<u||a>l){const F=n.readSync(i.dataId),[$,O]=nCe(F,c,i.dtype,a,o);return[n.makeTensorInfo($.shape,$.dtype,$.values),n.makeTensorInfo(O.shape,O.dtype,O.values)]}if(a===0)return c[c.length-1]=0,[n.makeTensorInfo(c,i.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(h===1)return[i,Z0({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const f=n.texData.get(i.dataId),p=f!==null&&f.isPacked,g=p?n.unpackTensor(i):i,x=Je(c)/h,v=vt({inputs:{x:g},attrs:{shape:[x,h]},backend:n});p&&xc(n,g);const S=XM(a),w=XM(h);let E=null;const _=()=>E===null?[v,v]:[v,E],D=(F,$,O)=>{const M=_(),B=new LAe(O),V=[[h],[E===null?1:0],[Number.NEGATIVE_INFINITY],[F],[$]],Z=E;E=n.runWebGLProgram(B,M,"int32",V),xc(n,Z)};for(let F=1;F<S;F*=2){const $=F*2;for(let O=F;O>=1;O/=2)D($,O,[x,w])}for(let F=w;F>S;F/=2){const $=_(),O=new BAe([x,F/2]),B=[[h],[E===null?1:0],[S]],U=E;E=n.runWebGLProgram(O,$,"int32",B),xc(n,U);const V=S/2,Z=V*2;for(let J=V;J>=1;J/=2)D(Z,J,E.shape)}let I=E;E=np({inputs:{x:E},backend:n,attrs:{begin:0,size:[x,a]}}),xc(n,I);let k=Cj({inputs:{x:v,indices:E},backend:n,attrs:{axis:1,batchDims:1}});xc(n,v);const A=c.slice(0,-1);A.push(a),I=E,E=vt({inputs:{x:E},attrs:{shape:A},backend:n}),xc(n,I);const N=k;return k=vt({inputs:{x:k},attrs:{shape:A},backend:n}),xc(n,N),[k,E]}const VAe={kernelName:T3,backendName:"webgl",kernelFunc:PAe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zAe{constructor(t,n,s,i,a,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const u=s==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${t}));

                if (${u} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UAe(r){const{inputs:t,backend:n,attrs:s}=r,{image:i,transforms:a}=t,{interpolation:o,fillMode:u,fillValue:l,outputShape:c}=s,[h,f,p,g]=i.shape,[y,x]=c??[f,p],v=[h,y,x,g],S=new zAe(f,p,o,u,l,v);return n.runWebGLProgram(S,[i,a],"float32")}const GAe={kernelName:N3,backendName:"webgl",kernelFunc:UAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe(r){const{inputs:t,attrs:n,backend:s}=r,{axis:i}=n,{x:a}=t;H0(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(a.dataId),{outputValues:u,outputShape:l,indices:c}=rCe(o,i,a.shape,a.dtype);return[s.makeTensorInfo(l,a.dtype,u),s.makeTensorInfo([c.length],"int32",c)]}const WAe={kernelName:k3,backendName:"webgl",kernelFunc:jAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HAe(r){const{inputs:t,backend:n,attrs:s}=r,{value:i}=t;let{axis:a}=s;a<0&&(a+=i.shape.length);const o=i,u=o.shape.length,l=i.shape[a],c=new Array(u-1);let h=0;for(let x=0;x<u;x++)x!==a&&(c[h++]=o.shape[x]);const f=[],p=new Array(u).fill(0),g=o.shape.slice();g[a]=1;const y=new Array(l);for(let x=0;x<y.length;x++){p[a]=x;const v=np({inputs:{x:o},backend:n,attrs:{begin:p,size:g}}),S=vt({inputs:{x:v},backend:n,attrs:{shape:c}});y[x]=S,f.push(v)}return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const qAe={kernelName:m2,backendName:"webgl",kernelFunc:HAe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KAe{constructor(t,n){this.variableNames=["x","segmentIds"];const s=t.windowSize,i=t.batchSize,a=t.inSize,o=t.numSegments,u=o*Math.ceil(a/s);this.outputShape=[i,u];const l="0.0",c="sumValue",h=Math.floor(s/4)*4,f=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let g="";a%s>0&&(g=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XAe(r){const{inputs:t,backend:n,attrs:s}=r,{x:i,segmentIds:a}=t,{numSegments:o}=s,u=i.shape.length,l=[];let c=0;const h=Dr([c],u);let f=i;h!=null&&(f=ti({inputs:{x:i},backend:n,attrs:{perm:h}}),l.push(f),c=Mr(1,u)[0]);const p=SV(f.shape,c,o),g=Je([f.shape[c]]),y=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,g]}});l.push(y);const x=I3(i.dtype),v=(_,D,I,k,A)=>{const N=_.shape[0],F=_.shape[1],$=wV(F,A),O={windowSize:$,inSize:F,batchSize:N,numSegments:A},M=new KAe(O,D),B=n.compileAndRun(M,[_,I],k);if(l.push(B),B.shape[1]===A)return B;const U=Aj({backend:n,attrs:{start:0,stop:A,step:1,dtype:"float32"}}),V=$j({inputs:{x:U},backend:n,attrs:{reps:[F/$]}});return l.push(U),l.push(V),v(B,D,V,k,A)},S=v(y,"unsortedSegmentSum",a,x,o),w=vt({inputs:{x:S},backend:n,attrs:{shape:p}});let E=w;if(h!=null){l.push(w);const _=jl(h);E=ti({inputs:{x:E},backend:n,attrs:{perm:_}})}return l.forEach(_=>n.disposeIntermediateTensorInfo(_)),E}const YAe={kernelName:g2,backendName:"webgl",kernelFunc:XAe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZAe=[KCe,YCe,JCe,n_e,s_e,o_e,l_e,h_e,m_e,y_e,v_e,C_e,D_e,A_e,F_e,O_e,L_e,z_e,G_e,W_e,X_e,nEe,sEe,aEe,fEe,pEe,xEe,ICe,wEe,DEe,AEe,MEe,BEe,VEe,UEe,jEe,qEe,YEe,JEe,tDe,rDe,iDe,uDe,cDe,pDe,gDe,bDe,SDe,_De,NDe,$De,MDe,PDe,UDe,GDe,WDe,qDe,XDe,ZDe,JDe,rTe,aTe,lTe,hTe,pTe,yTe,wTe,ETe,ACe,TTe,_Ee,ATe,FTe,MTe,FCe,VTe,jTe,HTe,YTe,JTe,r3e,a3e,c3e,p3e,y3e,b3e,C3e,E3e,T3e,I3e,F3e,O3e,L3e,P3e,G3e,q3e,Z3e,iNe,MCe,lNe,fNe,mNe,xNe,uEe,wNe,CNe,ENe,NNe,$Ne,OCe,RNe,MNe,BNe,PNe,lEe,tNe,UNe,HNe,YNe,BCe,eke,rke,oke,cke,pke,gke,bke,Ske,_ke,Tke,Ake,Fke,Lke,Vke,Gke,Hke,eEe,rNe,Xke,Zke,Jke,tAe,rAe,iAe,oAe,lAe,hAe,pAe,gAe,xAe,wAe,CAe,EAe,TAe,nNe,WCe,AAe,FAe,MAe,VAe,GAe,HCe,WAe,qAe,YAe,SNe];for(const r of ZAe)WP(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QAe=1e-7,JAe=1e-4;class eIe{decComplexRef(t){}time(t){return We("time")}read(t){return We("read")}readSync(t){return We("readSync")}numDataIds(){return We("numDataIds")}disposeData(t){return We("disposeData")}write(t,n,s){return We("write")}move(t,n,s,i){return We("move")}memory(){return We("memory")}floatPrecision(){return We("floatPrecision")}epsilon(){return this.floatPrecision()===32?QAe:JAe}batchMatMul(t,n,s,i){return We("batchMatMul")}fusedBatchMatMul({a:t,b:n,transposeA:s,transposeB:i,bias:a,activation:o,preluActivationWeights:u}){return We("fusedBatchMatMul")}slice(t,n,s){return We("slice")}stridedSlice(t,n,s,i){return We("stridedSlice")}unstack(t,n){return We("unstack")}reverse(t,n){return We("reverse")}concat(t,n){return We("concat")}neg(t){return We("neg")}add(t,n){return We("add")}addN(t){return We("addN")}subtract(t,n){return We("subtract")}multiply(t,n){return We("multiply")}realDivide(t,n){return We("realDivide")}floorDiv(t,n){return We("floorDiv")}sum(t,n){return We("sum")}prod(t,n){return We("prod")}unsortedSegmentSum(t,n,s){return We("unsortedSegmentSum")}argMin(t,n){return We("argMin")}argMax(t,n){return We("argMax")}equal(t,n){return We("equal")}notEqual(t,n){return We("notEqual")}less(t,n){return We("less")}lessEqual(t,n){return We("lessEqual")}greater(t,n){return We("greater")}greaterEqual(t,n){return We("greaterEqual")}logicalNot(t){return We("logicalNot")}logicalAnd(t,n){return We("logicalAnd")}logicalOr(t,n){return We("logicalOr")}where(t){return We("where")}select(t,n,s){return We("select")}topk(t,n,s){return We("topk")}min(t,n){return We("min")}minimum(t,n){return We("minimum")}mod(t,n){return We("mod")}max(t,n){return We("max")}maximum(t,n){return We("maximum")}all(t,n){return We("all")}any(t,n){return We("any")}squaredDifference(t,n){return We("squaredDifference")}ceil(t){return We("ceil")}floor(t){return We("floor")}round(t){return We("round")}sign(t){return We("sign")}isNaN(t){return We("isNaN")}isInf(t){return We("isInf")}isFinite(t){return We("isFinite")}pow(t,n){return We("pow")}exp(t){return We("exp")}expm1(t){return We("expm1")}softmax(t,n){return We("softmax")}log(t){return We("log")}log1p(t){return We("log1p")}sqrt(t){return We("sqrt")}rsqrt(t){return We("rsqrt")}square(t){return We("square")}reciprocal(t){return We("reciprocal")}relu(t){return We("relu")}relu6(t){return We("relu6")}prelu(t,n){return We("prelu")}elu(t){return We("elu")}eluDer(t,n){return We("eluDer")}selu(t){return We("selu")}int(t){return We("int")}clip(t,n,s){return We("clip")}abs(t){return We("abs")}complexAbs(t){return We("complexAbs")}sigmoid(t){return We("sigmoid")}softplus(t){return We("softplus")}sin(t){return We("sin")}cos(t){return We("cos")}tan(t){return We("tan")}asin(t){return We("asin")}acos(t){return We("acos")}atan(t){return We("atan")}atan2(t,n){return We("atan2")}sinh(t){return We("sinh")}cosh(t){return We("cosh")}tanh(t){return We("tanh")}asinh(t){return We("asinh")}acosh(t){return We("acosh")}atanh(t){return We("atanh")}erf(t){return We("erf")}step(t,n){return We("step")}fusedConv2d({input:t,filter:n,convInfo:s,bias:i,activation:a,preluActivationWeights:o}){return We("fusedConv2d")}conv2d(t,n,s){return We("conv2d")}conv2dDerInput(t,n,s){return We("conv2dDerInput")}conv2dDerFilter(t,n,s){return We("conv2dDerFilter")}fusedDepthwiseConv2D({input:t,filter:n,convInfo:s,bias:i,activation:a,preluActivationWeights:o}){return We("fusedDepthwiseConv2D")}depthwiseConv2D(t,n,s){return We("depthwiseConv2D")}depthwiseConv2DDerInput(t,n,s){return We("depthwiseConv2DDerInput")}depthwiseConv2DDerFilter(t,n,s){return We("depthwiseConv2DDerFilter")}conv3d(t,n,s){return We("conv3d")}conv3dDerInput(t,n,s){return We("conv3dDerInput")}conv3dDerFilter(t,n,s){return We("conv3dDerFilter")}maxPool(t,n){return We("maxPool")}maxPoolBackprop(t,n,s,i){return We("maxPoolBackprop")}avgPool(t,n){return We("avgPool")}avgPoolBackprop(t,n,s){return We("avgPoolBackprop")}avgPool3d(t,n){return We("avgPool3d")}avgPool3dBackprop(t,n,s){return We("avgPool3dBackprop")}maxPool3d(t,n){return We("maxPool3d")}maxPool3dBackprop(t,n,s,i){return We("maxPool3dBackprop")}reshape(t,n){return We("reshape")}cast(t,n){return We("cast")}tile(t,n){return We("tile")}pad(t,n,s){return We("pad")}transpose(t,n){return We("transpose")}gather(t,n,s,i=0){return We("gather")}gatherND(t,n){return We("gatherND")}scatterND(t,n,s){return We("scatterND")}batchToSpaceND(t,n,s){return We("batchToSpaceND")}spaceToBatchND(t,n,s){return We("spaceToBatchND")}resizeBilinear(t,n,s,i,a){return We("resizeBilinear")}resizeBilinearBackprop(t,n,s){return We("resizeBilinearBackprop")}resizeNearestNeighbor(t,n,s,i,a){return We("resizeNearestNeighbor")}resizeNearestNeighborBackprop(t,n,s){return We("resizeNearestNeighborBackprop")}batchNorm(t,n,s,i,a,o){return We("batchNorm")}localResponseNormalization4D(t,n,s,i,a){return We("localResponseNormalization4D")}LRNGrad(t,n,s,i,a,o,u){return We("LRNGrad")}multinomial(t,n,s,i){return We("multinomial")}oneHot(t,n,s,i){return We("oneHot")}cumsum(t,n,s,i){return We("cumsum")}nonMaxSuppression(t,n,s,i,a){return We("nonMaxSuppression")}fft(t){return We("fft")}ifft(t){return We("ifft")}complex(t,n){return We("complex")}real(t){return We("real")}imag(t){return We("imag")}cropAndResize(t,n,s,i,a,o){return We("cropAndResize")}depthToSpace(t,n,s){return We("depthToSpace")}split(t,n,s){return We("split")}sparseToDense(t,n,s,i){return We("sparseToDense")}diag(t){return We("diag")}fill(t,n,s){return We("fill")}onesLike(t){return We("onesLike")}zerosLike(t){return We("zerosLike")}linspace(t,n,s){return We("linspace")}dispose(){return We("dispose")}}function We(r){throw new Error(`'${r}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(r,t){if(!r)throw new Error(typeof t=="string"?t:t())}function js(r,t,n=""){ye(dh(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function Ak(r){ye(r!=null,()=>"The input to the tensor constructor must be a non-null value.")}function X2(r,t=[],n=!1){if(t==null&&(t=[]),Array.isArray(r)||Oo(r)&&!n)for(let s=0;s<r.length;++s)X2(r[s],t,n);else t.push(r);return t}function Ai(r){if(r.length===0)return 1;let t=r[0];for(let n=1;n<r.length;n++)t*=r[n];return t}function dh(r,t){if(r===t)return!0;if(r==null||t==null||r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==t[n])return!1;return!0}function Rs(r){return r%1===0}function px(r,t){return t<=r.length?r:r+" ".repeat(t-r.length)}function Uo(r,t){const n=t.length;return r=r==null?t.map((s,i)=>i):[].concat(r),ye(r.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${r}`),ye(r.every(s=>Rs(s)),()=>`All values in axis param must be integers but got axis ${r}`),r.map(s=>s<0?n+s:s)}function tIe(r,t){const n=[],s=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:Uo(t,r).sort();let o=0;for(let u=0;u<r.length;++u){if(a!=null){if(a[o]===u&&r[u]!==1)throw new Error(`Can't squeeze axis ${u} since its dim '${r[u]}' is not 1`);(a[o]==null||a[o]>u)&&r[u]===1&&(n.push(r[u]),s.push(u)),a[o]<=u&&o++}r[u]!==1&&(n.push(r[u]),s.push(u))}return{newShape:n,keptDims:s}}function nIe(r,t){let n=null;if(r==null||r==="float32")n=new Float32Array(t);else if(r==="int32")n=new Int32Array(t);else if(r==="bool")n=new Uint8Array(t);else if(r==="string")n=new Array(t);else throw new Error(`Unknown data type ${r}`);return n}function rIe(r,t){for(let n=0;n<r.length;n++){const s=r[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function sIe(r){return r==="bool"||r==="complex64"||r==="float32"||r==="int32"||r==="string"}function Oo(r){return r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array}function iIe(r){if(r==="float32"||r==="int32")return 4;if(r==="complex64")return 8;if(r==="bool")return 1;throw new Error(`Unknown dtype ${r}`)}function aIe(r){if(r==null)return 0;let t=0;return r.forEach(n=>t+=n.length),t}function Ik(r){return typeof r=="string"||r instanceof String}function oIe(r){return typeof r=="boolean"}function uIe(r){return typeof r=="number"}function $k(r){return Array.isArray(r)?$k(r[0]):r instanceof Float32Array?"float32":r instanceof Int32Array||r instanceof Uint8Array?"int32":uIe(r)?"float32":Ik(r)?"string":oIe(r)?"bool":"float32"}function YM(r){return!!(r&&r.constructor&&r.call&&r.apply)}function Fk(r){const t=r.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=r[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*r[s+1];return n}function Fj(r,t,n){const s=new Array;if(t.length===1){const i=t[0];for(let a=0;a<i;a++)s[a]=n[r+a]}else{const i=t[0],a=t.slice(1),o=a.reduce((u,l)=>u*l);for(let u=0;u<i;u++)s[u]=Fj(r+u*o,a,n)}return s}function fD(r,t){if(r.length===0)return t[0];const n=r.reduce((s,i)=>s*i);if(n===0)return[];if(n!==t.length)throw new Error(`[${r}] does not match the input size ${t.length}.`);return Fj(0,r,t)}function Rj(r,t){const n=Rk(r,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function Rk(r,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool")return new Uint8Array(r);throw new Error(`Unknown data type ${t}`)}function Oj(r){r.forEach(t=>{ye(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${r}].`)})}function vg(r){return r&&r.then&&typeof r.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZM="tfjsflags";class lIe{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${n}.`),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const i=this.urlFlags[t];console.warn(`Setting feature override from URL ${t}: ${i}.`),this.set(t,i)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(vg(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=cIe(this.global.location.search);ZM in t&&t[ZM].split(",").forEach(s=>{const[i,a]=s.split(":");this.urlFlags[i]=fIe(i,a)})}}function cIe(r){const t={};return r.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(hIe(t,s[0],s[1]),s.join("="))),t}function hIe(r,t,n){r[decodeURIComponent(t)]=decodeURIComponent(n||"")}function fIe(r,t){if(t=t.toLowerCase(),t==="true"||t==="false")return t==="true";if(`${+t}`===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${r}.`)}function yr(){return Mj}let Mj=null;function dIe(r){Mj=r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let D_;function Lj(){if(D_==null){let r;if(typeof window<"u")r=window;else if(typeof global<"u")r=global;else if(typeof process<"u")r=process;else if(typeof self<"u")r=self;else throw new Error("Could not find a global object");D_=r}return D_}function pIe(){const r=Lj();return r._tfGlobals==null&&(r._tfGlobals=new Map),r._tfGlobals}function Bj(r,t){const n=pIe();if(n.has(r))return n.get(r);{const s=t();return n.set(r,s),n.get(r)}}const Pj="Abs",Vj="Acos",zj="Acosh",Ok="Add",Uj="AddN",mIe="All",gIe="Any",Gj="ArgMax",jj="ArgMin",Wj="Asin",Hj="Asinh",qj="Atan",Kj="Atanh",Xj="Atan2",Yj="AvgPool",yIe="AvgPoolGrad",Zj="AvgPool3D",xIe="AvgPool3DGrad",Qj="BatchMatMul",Jj="BatchToSpaceND",bIe="Bincount",vIe="BroadcastTo",Mk="Cast",eW="Ceil",tW="ClipByValue",wIe="Complex",nW="ComplexAbs",rW="Concat",sW="Conv2D",SIe="Conv2DBackpropFilter",iW="Conv2DBackpropInput",aW="Conv3D",CIe="Conv3DBackpropFilterV2",_Ie="Conv3DBackpropInputV2",oW="Cos",uW="Cosh",lW="Cumsum",EIe="CropAndResize",DIe="DenseBincount",TIe="DepthToSpace",cW="DepthwiseConv2dNative",NIe="DepthwiseConv2dNativeBackpropFilter",kIe="DepthwiseConv2dNativeBackpropInput",hW="Dilation2D",AIe="Dilation2DBackpropInput",IIe="Dilation2DBackpropFilter",fW="RealDiv",dW="Elu",$Ie="EluGrad",pW="Erf",FIe="Equal",mW="Exp",gW="ExpandDims",yW="Expm1",RIe="FFT",OIe="Fill",MIe="FlipLeftRight",xW="Floor",bW="FloorDiv",vW="FusedBatchNorm",wW="GatherV2",LIe="GatherNd",BIe="Greater",SW="GreaterEqual",CW="Identity",PIe="IFFT",VIe="Imag",_W="IsFinite",EW="IsInf",DW="IsNan",TW="LeakyRelu",zIe="Less",UIe="LessEqual",GIe="LinSpace",NW="Log",kW="Log1p",jIe="LogicalAnd",WIe="LogicalNot",HIe="LogicalOr",qIe="LogSoftmax",AW="LRN",KIe="LRNGrad",IW="Max",$W="Maximum",FW="MaxPool",XIe="MaxPoolGrad",RW="MaxPool3D",YIe="MaxPool3DGrad",ZIe="MaxPoolWithArgmax",OW="Mean",MW="Min",LW="Minimum",BW="MirrorPad",PW="Mod",QIe="Multinomial",VW="Multiply",zW="Neg",JIe="NotEqual",e5e="NonMaxSuppressionV3",t5e="NonMaxSuppressionV4",n5e="NonMaxSuppressionV5",UW="OnesLike",GW="OneHot",jW="Pack",WW="PadV2",HW="Pow",qW="Prelu",r5e="Prod",s5e="Range",i5e="Real",KW="Reciprocal",XW="Relu",YW="Reshape",ZW="ResizeNearestNeighbor",a5e="ResizeNearestNeighborGrad",QW="ResizeBilinear",o5e="ResizeBilinearGrad",JW="Relu6",eH="Reverse",tH="Round",nH="Rsqrt",u5e="ScatterNd",rH="Select",sH="Selu",iH="Slice",aH="Sin",oH="Sinh",uH="Sign",lH="Sigmoid",cH="Softplus",hH="Sqrt",fH="Sum",dH="SpaceToBatchND",pH="SplitV",mH="Softmax",gH="SquaredDifference",l5e="Square",yH="Sub",c5e="SparseToDense",h5e="StridedSlice",xH="Tan",bH="Tanh",Lk="Tile",f5e="TopK",vH="Transpose",d5e="Unique",wH="Unpack",SH="UnsortedSegmentSum",CH="ZerosLike",_H="Step",QM="FromPixels",p5e="RotateWithOffset",JM="_FusedMatMul",eL="FusedConv2D",tL="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH=Bj("kernelRegistry",()=>new Map),dD=Bj("gradRegistry",()=>new Map);function DH(r,t){const n=g5e(r,t);return EH.get(n)}function nL(r){return dD.get(r)}function rL(r){const t=EH.entries(),n=[];for(;;){const{done:s,value:i}=t.next();if(s)break;const[a,o]=i,[u]=a.split("_");u===r&&n.push(o)}return n}function m5e(r){const{kernelName:t}=r;dD.has(t)&&yr().getBool("DEBUG")&&console.warn(`Overriding the gradient for '${t}'`),dD.set(t,r)}function g5e(r,t){return`${t}_${r}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y5e(r,t){return r instanceof Float32Array&&t==="float32"||r instanceof Int32Array&&t==="int32"||r instanceof Uint8Array&&t==="bool"}function TH(r,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(r)&&(r=X2(r)),yr().getBool("DEBUG")&&rIe(r,t),y5e(r,t))return r;if(t==null||t==="float32"||t==="complex64")return new Float32Array(r);if(t==="int32")return new Int32Array(r);if(t==="bool"){const n=new Uint8Array(r.length);for(let s=0;s<n.length;++s)Math.round(r[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function sL(){return yr().platform.now()}function x5e(r,t="utf-8"){return t=t||"utf-8",yr().platform.encode(r,t)}function iL(r,t="utf-8"){return t=t||"utf-8",yr().platform.decode(r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b5e{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new w5e)}profileKernel(t,n,s){let i;const a=()=>{i=s()},o=this.backendTimer.time(a);if(yr().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<i.length;l++){const c=i[l];c.data().then(h=>{v5e(h,c.dtype,t)})}return{kernelName:t,outputs:i,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:i,inputs:a,extraInfo:o}=t;s.forEach(u=>{Promise.all([u.data(),i,o]).then(l=>{this.logger.logKernelProfile(n,u,l[0],l[1],a,l[2])})})}}function v5e(r,t,n){if(t!=="float32")return!1;for(let s=0;s<r.length;s++){const i=r[s];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class w5e{logKernelProfile(t,n,s,i,a,o){const u=typeof i=="number"?px(`${i}ms`,9):i.error,l=px(t,25),c=n.rank,h=n.size,f=px(n.shape.toString(),14);let p="";for(const g in a){const y=a[g];if(y!=null){const x=y.shape||n.shape,v=x.length;p+=`${g}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${u}	%c${c}D ${f}	%c${h}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5e(r,t,n){const s={},i={};for(let l=0;l<t.length;l++)s[t[l].id]=!0;for(let l=0;l<r.length;l++){const c=r[l],h=c.inputs;for(const f in h){const p=h[f];let g=!1;for(let y=0;y<t.length;y++)if(s[p.id]){c.outputs.forEach(x=>s[x.id]=!0),g=!0,i[c.id]=!0;break}if(g)break}}const a={};a[n.id]=!0;const o={};for(let l=r.length-1;l>=0;l--){const c=r[l],h=c.inputs;for(let f=0;f<c.outputs.length;f++)if(a[c.outputs[f].id]){for(const p in h)a[h[p].id]=!0,o[c.id]=!0;break}}const u=[];for(let l=0;l<r.length;l++){const c=r[l];if(i[c.id]&&o[c.id]){const h={};for(const p in c.inputs){const g=c.inputs[p];s[g.id]&&(h[p]=g)}const f=Object.assign({},c);f.inputs=h,f.outputs=c.outputs,u.push(f)}}return u}function C5e(r,t,n,s){for(let i=t.length-1;i>=0;i--){const a=t[i],o=[];if(a.outputs.forEach(l=>{const c=r[l.id];c!=null?o.push(c):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const u=a.gradient(o);for(const l in a.inputs){if(!(l in u))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(u)}.`);const c=n(()=>u[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const h=a.inputs[l];if(!dh(c.shape,h.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${h.shape}'`);if(r[h.id]==null)r[h.id]=c;else{const f=r[h.id];r[h.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=20,fm=3,T_=7;function _5e(r,t,n,s){const i=Fk(t),a=E5e(r,t,n,i),o=t.length,u=mx(r,t,n,i,a),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(u.map(c=>"    "+c).join(`
`)),l.join(`
`)}function E5e(r,t,n,s){const i=Ai(t),a=s[s.length-1],o=new Array(a).fill(0),u=t.length,l=n==="complex64"?Tm(r):r;if(u>1)for(let c=0;c<i/a;c++){const h=c*a;for(let f=0;f<a;f++)o[f]=Math.max(o[f],Dm(l[h+f],0,n).length)}return o}function Dm(r,t,n){let s;return Array.isArray(r)?s=`${parseFloat(r[0].toFixed(T_))} + ${parseFloat(r[1].toFixed(T_))}j`:Ik(r)?s=`'${r}'`:n==="bool"?s=NH(r):s=parseFloat(r.toFixed(T_)).toString(),px(s,t)}function NH(r){return r===0?"false":"true"}function mx(r,t,n,s,i,a=!0){const o=n==="complex64"?2:1,u=t[0],l=t.length;if(l===0){if(n==="complex64"){const x=Tm(r);return[Dm(x[0],0,n)]}return n==="bool"?[NH(r[0])]:[r[0].toString()]}if(l===1){if(u>aL){const v=fm*o;let S=Array.from(r.slice(0,v)),w=Array.from(r.slice((u-fm)*o,u*o));return n==="complex64"&&(S=Tm(S),w=Tm(w)),["["+S.map((E,_)=>Dm(E,i[_],n)).join(", ")+", ..., "+w.map((E,_)=>Dm(E,i[u-fm+_],n)).join(", ")+"]"]}return["["+(n==="complex64"?Tm(r):Array.from(r)).map((v,S)=>Dm(v,i[S],n)).join(", ")+"]"]}const c=t.slice(1),h=s.slice(1),f=s[0]*o,p=[];if(u>aL){for(let x=0;x<fm;x++){const v=x*f,S=v+f;p.push(...mx(r.slice(v,S),c,n,h,i,!1))}p.push("...");for(let x=u-fm;x<u;x++){const v=x*f,S=v+f;p.push(...mx(r.slice(v,S),c,n,h,i,x===u-1))}}else for(let x=0;x<u;x++){const v=x*f,S=v+f;p.push(...mx(r.slice(v,S),c,n,h,i,x===u-1))}const g=l===2?",":"";p[0]="["+p[0]+g;for(let x=1;x<p.length-1;x++)p[x]=" "+p[x]+g;let y=`,
`;for(let x=2;x<l;x++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":y),p}function Tm(r){const t=[];for(let n=0;n<r.length;n+=2)t.push([r[n],r[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pD{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=Ai(t),s!=null){const i=s.length;ye(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||nIe(n,this.size),this.strides=Fk(t)}set(t,...n){n.length===0&&(n=[0]),ye(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const i of t){if(i<0||i>=this.shape[n]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=t[t.length-1];for(let i=0;i<t.length-1;++i)s+=this.strides[i]*t[i];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return So().makeTensor(this.values,this.shape,this.dtype)}}let So=null,Rf=null;function D5e(r){So=r}function T5e(r){Rf=r}class Re{constructor(t,n,s,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Ai(t),this.strides=Fk(t),this.dataId=s,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Rf.buffer(this.shape,this.dtype,t)}bufferSync(){return Rf.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return fD(this.shape,t)}arraySync(){return fD(this.shape,this.dataSync())}async data(){this.throwIfDisposed();const t=So().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>iL(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=So().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>iL(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await So().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(So().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Rf.print(this,t)}clone(){return this.throwIfDisposed(),Rf.clone(this)}toString(t=!1){const n=this.dataSync();return _5e(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Rf.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),So().makeVariable(this,t,n,s)}}Object.defineProperty(Re,Symbol.hasInstance,{value:r=>!!r&&r.data!=null&&r.dataSync!=null&&r.throwIfDisposed!=null});class mD extends Re{constructor(t,n,s,i){super(t.shape,t.dtype,t.dataId,i),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!dh(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);So().disposeTensor(this),this.dataId=t.dataId,So().incRef(this,null)}dispose(){So().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(mD,Symbol.hasInstance,{value:r=>r instanceof Re&&r.assign!=null&&r.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oL;(function(r){r.R0="R0",r.R1="R1",r.R2="R2",r.R3="R3",r.R4="R4",r.R5="R5",r.R6="R6"})(oL||(oL={}));var gD;(function(r){r.float32="float32",r.int32="int32",r.bool="int32",r.complex64="complex64"})(gD||(gD={}));var yD;(function(r){r.float32="float32",r.int32="int32",r.bool="bool",r.complex64="complex64"})(yD||(yD={}));var xD;(function(r){r.float32="float32",r.int32="float32",r.bool="float32",r.complex64="complex64"})(xD||(xD={}));var bD;(function(r){r.float32="complex64",r.int32="complex64",r.bool="complex64",r.complex64="complex64"})(bD||(bD={}));const N5e={float32:xD,int32:gD,bool:yD,complex64:bD};function k5e(r,t){if(r==="string"||t==="string"){if(r==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${r} with ${t}`)}return N5e[r][t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(r,t){if(r.dtype===t.dtype)return[r,t];const n=k5e(r.dtype,t.dtype);return[r.cast(n),t.cast(n)]}function A5e(r){const t=[];return kH(r,t,new Set),t}function kH(r,t,n){if(r==null)return;if(r instanceof Re){t.push(r);return}if(!I5e(r))return;const s=r;for(const i in s){const a=s[i];n.has(a)||(n.add(a),kH(a,t,n))}}function I5e(r){return Array.isArray(r)||typeof r=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uL{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Ad{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new uL}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(console.warn(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new b5e(this.backendInstance),!0}setupRegisteredKernels(){rL(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){rL(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof eIe)&&typeof s.then=="function"){const i=++this.pendingBackendInitId,a=s.then(o=>i<this.pendingBackendInitId?!1:(this.registry[t]=o,this.pendingBackendInit=null,!0)).catch(o=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,console.warn(`Initialization of backend ${t} failed`),console.warn(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return console.warn(`Initialization of backend ${t} failed`),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:i,asyncInit:a}=this.initializeBackend(s);if(a||i)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),i=s.backend,a=this.readSync(n);i.disposeData(n),s.backend=t,t.move(n,a,s.shape,s.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let i;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(t,n,s){t();try{const i=s();return n(),i}catch(i){throw n(),i}}nextTensorId(){return Ad.nextTensorId++}nextVariableId(){return Ad.nextVariableId++}clone(t){const n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),s={x:t},i=o=>({x:()=>{const u="float32",l={x:o},c={dtype:u};return Fe.runKernelFunc(h=>h.cast(o,u),l,null,Mk,c)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],i,a,{}),n}runKernel(t,n,s,i,a){return this.runKernelFunc(null,n,null,t,s,i,a)}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const i=this.backend.numDataIds();let a=0;s.forEach(l=>{a+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],u=i-n-a-o;if(u>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${u} data ids) after running '${t}'`)}runKernelFunc(t,n,s,i,a,o,u){let l,c=[];const h=this.isTapeOn();i==null&&(i=this.state.activeScope!=null?this.state.activeScope.name:"");const f=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let g;this.backendName==null&&this.backend;const y=DH(i,this.backendName);let x;if(y!=null)g=()=>{const S=this.backend.numDataIds();x=y.kernelFunc({inputs:n,attrs:a,backend:this.backend});const w=Array.isArray(x)?x:[x];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,S,w);const E=w.map(_=>{if(_.rank!=null)return _;const{dataId:D,shape:I,dtype:k}=_;return this.makeTensorFromDataId(D,I,k)});if(h){let _=this.getTensorsForGradient(i,n,E);if(_==null){u==null&&(u=[]);const D=E.filter((I,k)=>u[k]);_=(o||[]).slice().concat(D)}c=this.saveTensorsForBackwardMode(_)}return E};else{if(t==null)throw new Error(`Error running ${i}: Neither modular kernel nor forward func passed`);const S=w=>{h&&(c=w.map(E=>this.keep(this.clone(E))))};g=()=>{const w=this.backend.numDataIds();x=this.tidy(()=>t(this.backend,S));const E=Array.isArray(x)?x:[x];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(i,w,E),E}}let v;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?l=g():(v=this.profiler.profileKernel(i,n,()=>g()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(v),l=v.outputs)}),h&&this.addTapeNode(i,n,l,s,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:i,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(S=>n[S]!=null?n[S].shape:null),outputShapes:l.map(S=>S.shape),kernelTimeMs:v.timeMs,extraInfo:v.extraInfo}),Array.isArray(x)?l:l[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const i=nL(t);if(i!=null){const a=i.inputsToSave||[],o=i.outputsToSave||[];let u;i.saveAllInputs?(ye(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),u=Object.keys(n).map(c=>n[c])):u=a.map(c=>n[c]);const l=s.filter((c,h)=>o[h]);return u.concat(l)}return null}makeTensor(t,n,s,i){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",i=i||this.backend;let a=t;s==="string"&&Ik(t[0])&&(a=t.map(l=>x5e(l)));const o=i.write(a,n,s),u=new Re(n,s,o,this.nextTensorId());if(this.incRef(u,i),s==="string"){const l=this.state.tensorInfo.get(o),c=aIe(a);this.state.numBytes+=c-l.bytes,l.bytes=c}return u}makeTensorFromDataId(t,n,s,i){s=s||"float32";const a=new Re(n,s,t,this.nextTensorId());return this.incRef(a,i),a}makeVariable(t,n=!0,s,i){s=s||this.nextVariableId().toString(),i!=null&&i!==t.dtype&&(t=t.cast(i));const a=new mD(t,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}incRef(t,n){const s=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,s===0){this.state.numDataBuffers++;let i=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(i=t.size*iIe(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:i,refCount:0}),this.state.numBytes+=i}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof mD||this.track(t)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;const n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):(n.backend.decComplexRef(t.dataId),this.state.tensorInfo.get(t.dataId).refCount--)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,i,a,o){const u={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:a},l=nL(t);l!=null&&(i=l.gradFunc),i!=null&&(u.gradient=c=>(c=c.map((h,f)=>{if(h==null){const p=s[f],g=Rk(p.size,p.dtype);return this.makeTensor(g,p.shape,p.dtype)}return h}),i(c.length>1?c:c[0],a,o))),this.state.activeTape.push(u)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=A5e(t),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!s.has(o.id)&&o.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===i.id&&this.track(a)})}gradients(t,n,s,i=!1){if(ye(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));ye(a instanceof Re,()=>"The result y returned by f() must be a tensor.");const o=S5e(this.state.activeTape,n,a);if(!i&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const u={};u[a.id]=s??$5e(a.shape),C5e(u,o,c=>this.tidy(c),F5e);const l=n.map(c=>u[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const h of c.saved)h.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(t){return ye(YM(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{ye(n.every(a=>a instanceof Re),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const i={};return n.forEach((a,o)=>{i[o]=a}),this.runKernelFunc((a,o)=>(s=t(...n,o),ye(s.value instanceof Re,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ye(YM(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i,(a,o)=>{const u=s.gradFunc(a,o),l=Array.isArray(u)?u:[u];ye(l.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ye(l.every(h=>h instanceof Re),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const c={};return l.forEach((h,f)=>{c[f]=()=>h}),c})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const n=sL(),s=await this.backend.time(t);return s.wallMs=sL()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new uL;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ad.nextTensorId=0;Ad.nextVariableId=0;function $5e(r){const t=Rj(Ai(r),"float32");return Fe.makeTensor(t,r,"float32")}function AH(){const r=Lj();if(r._tfengine==null){const t=new lIe(r);r._tfengine=new Ad(t)}return dIe(r._tfengine.ENV),D5e(()=>r._tfengine),r._tfengine}const Fe=AH();function F5e(r,t){const n={a:r,b:t};return Fe.runKernel(Ok,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5e(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mo=yr();Mo.registerFlag("DEBUG",()=>!1,r=>{r&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Mo.registerFlag("IS_BROWSER",()=>R5e());Mo.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Mo.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Mo.registerFlag("PROD",()=>!1);Mo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Mo.getBool("DEBUG"));Mo.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Mo.registerFlag("IS_TEST",()=>!1);Mo.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0(r,t){let n=r;if(Oo(r))return t==="string"?[]:[r.length];if(!Array.isArray(r))return[];const s=[];for(;Array.isArray(n)||Oo(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(r)&&yr().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&IH(r,s,[]),s}function IH(r,t,n){if(n=n||[],!Array.isArray(r)&&!Oo(r)){ye(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}ye(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${r.length} elements`),ye(r.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${r.length} elements`);const s=t.slice(1);for(let i=0;i<r.length;++i)IH(r[i],s,n.concat(i))}function lL(r,t,n,s){if(r!=="string_or_numeric"){if(r==null)throw new Error("Expected dtype cannot be null.");if(r!=="numeric"&&r!==t||r==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${r} tensor, but got ${t} tensor`)}}function he(r,t,n,s="numeric"){if(r instanceof Re)return lL(s,r.dtype,t,n),r;let i=$k(r);if(i!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(i=s),lL(s,i,t,n),r==null||!Oo(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string"){const l=r==null?"null":r.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const a=Q0(r,i);!Oo(r)&&!Array.isArray(r)&&(r=[r]);const u=i!=="string"?TH(r,i):X2(r,[],!0);return Fe.makeTensor(u,a,i)}function $H(r,t,n,s="numeric"){if(!Array.isArray(r))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return r.map((a,o)=>he(a,`${t}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5e="__op";function Ie(r){const t=Object.keys(r);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=r[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+O5e;const i=(...a)=>{Fe.startScope(n);try{const o=s(...a);return vg(o)&&console.error("Cannot return a Promise inside of tidy."),Fe.endScope(o),o}catch(o){throw Fe.endScope(null),o}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M5e(r,t){const n=he(r,"real","complex"),s=he(t,"imag","complex");js(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const i={real:n,imag:s};return Fe.runKernel(wIe,i)}const ph=Ie({complex_:M5e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J0(r,t,n,s){if(s==null&&(s=$k(r)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Oo(r)&&!Array.isArray(r)&&typeof r!="number"&&typeof r!="boolean"&&typeof r!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Oj(t);const i=Ai(t),a=Ai(n);ye(i===a,()=>`Based on the provided shape, [${t}], the tensor should have ${i} values but has ${a}`);for(let o=0;o<n.length;++o){const u=n[o],l=o===n.length-1?u!==Ai(t.slice(o)):!0;ye(n[o]===t[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Oo(r)&&!Array.isArray(r)&&(r=[r]),t=t||n,r=s!=="string"?TH(r,s):X2(r,[],!0),Fe.makeTensor(r,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vc(r,t,n){const s=Q0(r,n);return J0(r,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cL={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hL=4;function L5e(r,t){const n={};let s,i=0;for(const a of t){const o=a.name,u=a.dtype,l=a.shape,c=Ai(l);let h;if("quantization"in a){const f=a.quantization;if(f.dtype==="uint8"||f.dtype==="uint16"){if(!("min"in f&&"scale"in f))throw new Error(`Weight ${a.name} with quantization ${f.dtype} doesn't have corresponding metadata min and scale.`)}else if(f.dtype==="float16"){if(u!=="float32")throw new Error(`Weight ${a.name} is quantized with ${f.dtype} which only supports weights of type float32 not ${u}.`)}else throw new Error(`Weight ${a.name} has unknown quantization dtype ${f.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=cL[f.dtype],g=r.slice(i,i+c*p),y=f.dtype==="uint8"?new Uint8Array(g):new Uint16Array(g);if(u==="float32")if(f.dtype==="uint8"||f.dtype==="uint16"){h=new Float32Array(y.length);for(let x=0;x<y.length;x++){const v=y[x];h[x]=v*f.scale+f.min}}else if(f.dtype==="float16")s===void 0&&(s=j5e()),h=s(y);else throw new Error(`Unsupported quantization type ${f.dtype} for weight type float32.`);else if(u==="int32"){if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error(`Unsupported quantization type ${f.dtype} for weight type int32.`);h=new Int32Array(y.length);for(let x=0;x<y.length;x++){const v=y[x];h[x]=Math.round(v*f.scale+f.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${u}`);i+=c*p}else if(u==="string"){const f=Ai(a.shape);h=[];for(let p=0;p<f;p++){const g=new Uint32Array(r.slice(i,i+hL))[0];i+=hL;const y=new Uint8Array(r.slice(i,i+g));h.push(y),i+=g}}else{const f=cL[u],p=r.slice(i,i+c*f);if(u==="float32")h=new Float32Array(p);else if(u==="int32")h=new Int32Array(p);else if(u==="bool")h=new Uint8Array(p);else if(u==="complex64"){h=new Float32Array(p);const g=new Float32Array(h.length/2),y=new Float32Array(h.length/2);for(let S=0;S<g.length;S++)g[S]=h[S*2],y[S]=h[S*2+1];const x=Vc(g,l,"float32"),v=Vc(y,l,"float32");n[o]=ph(x,v),x.dispose(),v.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${u}`);i+=c*f}u!=="complex64"&&(n[o]=Vc(h,l,u))}return n}const Bk=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function fL(r){return Bk?Buffer.byteLength(r):new Blob([r]).size}function B5e(r){if(Bk)return Buffer.from(r).toString("base64");const t=new Uint8Array(r);let n="";for(let s=0,i=t.length;s<i;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function P5e(r){if(Bk){const s=Buffer.from(r,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(r),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function V5e(r){if(r.length===1)return r[0];let t=0;r.forEach(i=>{t+=i.byteLength});const n=new Uint8Array(t);let s=0;return r.forEach(i=>{n.set(new Uint8Array(i),s),s+=i.byteLength}),n.buffer}function Pk(r){if(r.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:r.modelTopology==null?0:fL(JSON.stringify(r.modelTopology)),weightSpecsBytes:r.weightSpecs==null?0:fL(JSON.stringify(r.weightSpecs)),weightDataBytes:r.weightData==null?0:r.weightData.byteLength}}function z5e(){const r=n=>{let s=n<<13,i=0;for(;(s&8388608)===0;)i-=8388608,s<<=1;return s&=-8388609,i+=947912704,s|i},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=r(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function U5e(){const r=new Uint32Array(64);r[0]=0,r[31]=1199570944,r[32]=2147483648,r[63]=3347054592;for(let t=1;t<31;t++)r[t]=t<<23;for(let t=33;t<63;t++)r[t]=2147483648+(t-32<<23);return r}function G5e(){const r=new Uint32Array(64);for(let t=0;t<64;t++)r[t]=1024;return r[0]=r[32]=0,r}function j5e(){const r=z5e(),t=U5e(),n=G5e();return s=>{const i=new ArrayBuffer(4*s.length),a=new Uint32Array(i);for(let o=0;o<s.length;o++){const u=s[o],l=r[n[u>>10]+(u&1023)]+t[u>>10];a[o]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ls{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ls.instance==null&&(ls.instance=new ls),ls.instance}static registerSaveRouter(t){ls.getInstance().saveRouters.push(t)}static registerLoadRouter(t){ls.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return ls.getHandlers(t,"save")}static getLoadHandlers(t,n){return ls.getHandlers(t,"load",n)}static getHandlers(t,n,s){const i=[];return(n==="load"?ls.getInstance().loadRouters:ls.getInstance().saveRouters).forEach(o=>{const u=o(t,s);u!==null&&i.push(u)}),i}}const W5e=r=>ls.getSaveHandlers(r),H5e=(r,t)=>ls.getLoadHandlers(r,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vD="tensorflowjs",wD=1,Rc="models_store",xl="model_info_store";function FH(){if(!yr().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const r=typeof window>"u"?self:window,t=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB||r.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function SD(r){const t=r.result;t.createObjectStore(Rc,{keyPath:"modelPath"}),t.createObjectStore(xl,{keyPath:"modelPath"})}class mh{constructor(t){if(this.indexedDB=FH(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,i)=>{const a=this.indexedDB.open(vD,wD);a.onupgradeneeded=()=>SD(a),a.onsuccess=()=>{const o=a.result;if(n==null){const u=o.transaction(Rc,"readonly"),c=u.objectStore(Rc).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return o.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=h=>(o.close(),i(c.error)),u.oncomplete=()=>o.close()}else{const u=Pk(n),l=o.transaction(xl,"readwrite");let c=l.objectStore(xl);const h=c.put({modelPath:this.modelPath,modelArtifactsInfo:u});let f;h.onsuccess=()=>{f=o.transaction(Rc,"readwrite");const g=f.objectStore(Rc).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:u});g.onsuccess=()=>s({modelArtifactsInfo:u}),g.onerror=y=>{c=l.objectStore(xl);const x=c.delete(this.modelPath);x.onsuccess=()=>(o.close(),i(g.error)),x.onerror=v=>(o.close(),i(g.error))}},h.onerror=p=>(o.close(),i(h.error)),l.oncomplete=()=>{f==null?o.close():f.oncomplete=()=>o.close()}}},a.onerror=o=>i(a.error)})}}mh.URL_SCHEME="indexeddb://";const RH=r=>yr().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(mh.URL_SCHEME)?q5e(r.slice(mh.URL_SCHEME.length)):null;ls.registerSaveRouter(RH);ls.registerLoadRouter(RH);function q5e(r){return new mh(r)}function K5e(r){return r.startsWith(mh.URL_SCHEME)?r.slice(mh.URL_SCHEME.length):r}class X5e{constructor(){this.indexedDB=FH()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(vD,wD);s.onupgradeneeded=()=>SD(s),s.onsuccess=()=>{const i=s.result,a=i.transaction(xl,"readonly"),u=a.objectStore(xl).getAll();u.onsuccess=()=>{const l={};for(const c of u.result)l[c.modelPath]=c.modelArtifactsInfo;t(l)},u.onerror=l=>(i.close(),n(u.error)),a.oncomplete=()=>i.close()},s.onerror=i=>n(s.error)})}async removeModel(t){return t=K5e(t),new Promise((n,s)=>{const i=this.indexedDB.open(vD,wD);i.onupgradeneeded=()=>SD(i),i.onsuccess=()=>{const a=i.result,o=a.transaction(xl,"readwrite"),u=o.objectStore(xl),l=u.get(t);let c;l.onsuccess=()=>{if(l.result==null)return a.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const h=u.delete(t),f=()=>{c=a.transaction(Rc,"readwrite");const g=c.objectStore(Rc).delete(t);g.onsuccess=()=>n(l.result.modelArtifactsInfo),g.onerror=y=>s(l.error)};h.onsuccess=f,h.onerror=p=>(f(),a.close(),s(l.error))}},l.onerror=h=>(a.close(),s(l.error)),o.oncomplete=()=>{c==null?a.close():c.oncomplete=()=>a.close()}},i.onerror=a=>s(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fu="/",Of="tensorflowjs_models",OH="info",Y5e="model_topology",Z5e="weight_specs",Q5e="weight_data",J5e="model_metadata";function MH(r){return{info:[Of,r,OH].join(fu),topology:[Of,r,Y5e].join(fu),weightSpecs:[Of,r,Z5e].join(fu),weightData:[Of,r,Q5e].join(fu),modelMetadata:[Of,r,J5e].join(fu)}}function e$e(r){const t=r.split(fu);if(t.length<3)throw new Error(`Invalid key format: ${r}`);return t.slice(1,t.length-1).join(fu)}function t$e(r){return r.startsWith(gh.URL_SCHEME)?r.slice(gh.URL_SCHEME.length):r}class gh{constructor(t){if(!yr().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=MH(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),i=Pk(t);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,B5e(t.weightData));const a={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};return t.signature!=null&&(a.signature=t.signature),t.userDefinedMetadata!=null&&(a.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(a.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const u=JSON.parse(a);n.format=u.format,n.generatedBy=u.generatedBy,n.convertedBy=u.convertedBy,u.signature!=null&&(n.signature=u.signature),u.userDefinedMetadata!=null&&(n.userDefinedMetadata=u.userDefinedMetadata),u.modelInitializer!=null&&(n.modelInitializer=u.modelInitializer)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=P5e(o),n}}gh.URL_SCHEME="localstorage://";const LH=r=>yr().getBool("IS_BROWSER")&&!Array.isArray(r)&&r.startsWith(gh.URL_SCHEME)?n$e(r.slice(gh.URL_SCHEME.length)):null;ls.registerSaveRouter(LH);ls.registerLoadRouter(LH);function n$e(r){return new gh(r)}class r$e{constructor(){ye(yr().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ye(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=Of+fu,s=fu+OH;for(let i=0;i<this.LS.length;++i){const a=this.LS.key(i);if(a.startsWith(n)&&a.endsWith(s)){const o=e$e(a);t[o]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=t$e(t);const n=MH(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dL="://";class ll{constructor(){this.managers={}}static getInstance(){return ll.instance==null&&(ll.instance=new ll),ll.instance}static registerManager(t,n){ye(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(dL)&&(t=t.slice(0,t.indexOf(dL))),ye(t.length>0,()=>"scheme must not be an empty string.");const s=ll.getInstance();ye(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=this.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(this.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s$e{fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}}if(yr().get("IS_BROWSER")){yr().setPlatform("browser",new s$e);try{ll.registerManager(gh.URL_SCHEME,new r$e)}catch{}try{ll.registerManager(mh.URL_SCHEME,new X5e)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$e={importFetch:()=>require("node-fetch")};let N_;class a$e{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return yr().global.fetch!=null?yr().global.fetch(t,n):(N_==null&&(N_=i$e.importFetch()),N_(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}}yr().get("IS_NODE")&&yr().setPlatform("node",new a$e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wg(r,t="float32",n){return t=t||"float32",Oj(r),new pD(r,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$e(r,t){const n=he(r,"x","cast");if(!sIe(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},i={dtype:t};return Fe.runKernel(Mk,s,i)}const zt=Ie({cast_:o$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u$e(r){const n={x:he(r,"x","clone","string_or_numeric")};return Fe.runKernel(CW,n)}const Y2=Ie({clone_:u$e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$e(r,t=!1){console.log(r.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */AH();const c$e={buffer:wg,cast:zt,clone:Y2,print:l$e};T5e(c$e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(r,t,n,s){o(r),n=n??0,s=s??1,u(n,s);let i=0;const a=l=>(l.then(c=>{const h=n+ ++i/r.length*(s-n);return t(h),c}),l);function o(l){ye(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function u(l,c){ye(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),ye(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),ye(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(r.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function h$e(r,t){t==null&&(t={});const n=t.fetchFunc==null?yr().platform.fetch:t.fetchFunc,s=r.map(f=>n(f,t.requestInit,{isBinary:!0})),u=(t.onProgress==null?await Promise.all(s):await pL(s,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(u):await pL(u,t.onProgress,.5,1)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$e="application/octet-stream",d$e="application/json";class Vk{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(ye(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=yr().platform.fetch,ye(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&ye(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],i={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:s};t.signature!=null&&(i.signature=t.signature),t.userDefinedMetadata!=null&&(i.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(i.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(i)],{type:d$e}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:f$e}),"model.weights.bin");const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:Pk(t),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let x=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?x+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":x+=" Please make sure the server is serving valid JSON for this request.",new Error(x)}const s=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,o=n.convertedBy,u=n.format,l=n.signature,c=n.userDefinedMetadata;if(s==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);let h,f;i!=null&&([h,f]=await this.loadWeights(i));const p={modelTopology:s,weightSpecs:h,weightData:f,generatedBy:a,convertedBy:o,format:u};l!=null&&(p.signature=l),c!=null&&(p.userDefinedMetadata=c);const g=n.modelInitializer;return g&&(p.modelInitializer=g),p}async loadWeights(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,i]=p$e(n),a=this.weightPathPrefix||s,o=[];for(const h of t)o.push(...h.weights);const u=[],l=[];for(const h of t)for(const f of h.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):u.push(a+f+i);this.weightUrlConverter&&u.push(...await Promise.all(l));const c=await h$e(u,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,V5e(c)]}}Vk.URL_SCHEME_REGEX=/^https?:\/\//;function p$e(r){const t=r.lastIndexOf("/"),n=r.lastIndexOf("?"),s=r.substring(0,t),i=n>t?r.substring(n):"";return[s+"/",i]}function mL(r){return r.match(Vk.URL_SCHEME_REGEX)!=null}const BH=(r,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(r)?n=r.every(s=>mL(s)):n=mL(r),n)return PH(r,t)}return null};ls.registerSaveRouter(BH);ls.registerLoadRouter(BH);function PH(r,t){return new Vk(r,t)}function gL(r,t){return PH(r,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$e(r,t,n=!1,s=!1){let i=he(r,"a","matMul"),a=he(t,"b","matMul");[i,a]=Ar(i,a);const o={a:i,b:a},u={transposeA:n,transposeB:s};return Fe.runKernel(Qj,o,u)}const kr=Ie({matMul_:m$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$e(r,t,n=1,s=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:he(r,"indices","oneHot","int32")},o={depth:t,onValue:n,offValue:s};return Fe.runKernel(GW,a,o)}const VH=Ie({oneHot_:g$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$e(r,t){const n=he(r,"x","transpose");if(t==null&&(t=n.shape.map((a,o)=>o).reverse()),ye(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`),t.forEach(a=>{ye(a>=0&&a<n.rank,()=>`All entries in 'perm' must be between 0 and ${n.rank-1} but got ${t}`)}),n.rank<=1)return n.clone();const s={x:n},i={perm:t};return Fe.runKernel(vH,s,i)}const Id=Ie({transpose_:y$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x$e(r,t,n){if(Ak(r),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Q0(r,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return J0(r,t,s,n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Nf;function b$e(r,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(r==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,i=!1,a=!1,o=!1,u=!1;if(r.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&r instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)a=!0;else if(r.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&r instanceof ImageBitmap)u=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${r.constructor.name}`);if(i&&i&&r.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(DH(QM,Fe.backendName)!=null){const y={pixels:r},x={numChannels:t};return Fe.runKernel(QM,y,x)}const[c,h]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height];let f;o?f=r.getContext("2d").getImageData(0,0,c,h).data:s||n?f=r.data:(a||i||u)&&(Nf==null&&(Nf=document.createElement("canvas").getContext("2d")),Nf.canvas.width=c,Nf.canvas.height=h,Nf.drawImage(r,0,0,c,h),f=Nf.getImageData(0,0,c,h).data);let p;if(t===4)p=new Int32Array(f);else{const y=c*h;p=new Int32Array(y*t);for(let x=0;x<y;x++)for(let v=0;v<t;++v)p[x*t+v]=f[x*4+v]}return x$e(p,[h,c,t],"int32")}const zH=Ie({fromPixels_:b$e});function v$e(r,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${r}, sliceDim: ${s}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(r.length<s+(n.rank-i))throw new Error(a+` Output shape length < ${s+(n.rank-i)}`);if(n.rank!==i+r.length-s)throw new Error(a+` update.rank != ${i+r.length-s}`);for(let o=0;o<i;++o)if(n.shape[o]!==t.shape[o])throw new Error(a+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${t.shape[o]}).`);for(let o=0;o<n.rank-i;++o)if(n.shape[o+i]!==r[o+s])throw new Error(a+` updates.shape[${o+i}] (${n.shape[o+i]}) != shape[${o+i}] (${r[o+i]})`)}function w$e(r,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(r.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${r.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(r.size===0)throw new Error(`Updates specified for empty output. updates shape: ${r.shape}`)}v$e(n,t,r)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$e(r,t,n){let s;const i=r.shape.length;typeof t=="number"?s=[t,...new Array(i-1).fill(0)]:t.length<i?s=t.concat(new Array(i-t.length).fill(0)):s=t.slice(),s.forEach(o=>{ye(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(i).fill(-1):typeof n=="number"?a=[n,...new Array(i-1).fill(-1)]:n.length<i?a=n.concat(new Array(i-n.length).fill(-1)):a=n,a=a.map((o,u)=>o>=0?o:(ye(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${u}.`),r.shape[u]-s[u])),[s,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(r){yr().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(r+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Fn(r,t){return Fe.tidy(r,t)}function bl(r){return Fe.keep(r)}function C$e(){return Fe.backendName}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$e(r,t){let n=he(r,"a","add"),s=he(t,"b","add");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(Ok,i)}const ms=Ie({add_:_$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$e(r,t){let n=he(r,"a","floorDiv"),s=he(t,"b","floorDiv");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(bW,i)}const zk=Ie({floorDiv_:E$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D$e(r,t){let n=he(r,"a","div"),s=he(t,"b","div");if([n,s]=Ar(n,s),n.dtype==="int32"&&s.dtype==="int32")return zk(n,s);const i={a:n,b:s},a={};return Fe.runKernel(fW,i,a)}const tr=Ie({div_:D$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$e(r,t){let n=he(r,"a","mul"),s=he(t,"b","mul");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(VW,i)}const xt=Ie({mul_:T$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$e(r){const t=he(r,"x","abs");if(t.dtype==="complex64"){const n={x:t};return Fe.runKernel(nW,n)}else{const n={x:t};return Fe.runKernel(Pj,n)}}const go=Ie({abs_:N$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$e(r){const n={x:he(r,"x","acos")};return Fe.runKernel(Vj,n)}const UH=Ie({acos_:k$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A$e(r){const n={x:he(r,"x","acosh")};return Fe.runKernel(zj,n)}const GH=Ie({acosh_:A$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$e(r){ye(Array.isArray(r),()=>"The argument passed to tf.addN() must be a list of tensors"),ye(r.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${r.length}`);const t=r.map((i,a)=>he(i,`tensors${a}`,"addN")),n=t[0];t.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(i=>{if(!dh(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return Fe.runKernel(Uj,s)}const $$e=Ie({addN_:I$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F$e(r,t=null,n=!1){const i={x:he(r,"x","all","bool")},a={axis:t,keepDims:n};return Fe.runKernel(mIe,i,a)}const jH=Ie({all_:F$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$e(r,t=null,n=!1){const i={x:he(r,"x","any","bool")},a={axis:t,keepDims:n};return Fe.runKernel(gIe,i,a)}const WH=Ie({any_:R$e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O$e(r,t=0){const s={x:he(r,"x","argMax")},i={axis:t};return Fe.runKernel(Gj,s,i)}const HH=Ie({argMax_:O$e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$e(r,t=0){const s={x:he(r,"x","argMin")},i={axis:t};return Fe.runKernel(jj,s,i)}const qH=Ie({argMin_:M$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L$e(r){const n={x:he(r,"x","asin")};return Fe.runKernel(Wj,n)}const KH=Ie({asin_:L$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$e(r){const n={x:he(r,"x","asinh")};return Fe.runKernel(Hj,n)}const XH=Ie({asinh_:B$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P$e(r){const n={x:he(r,"x","atan")};return Fe.runKernel(qj,n)}const YH=Ie({atan_:P$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$e(r,t){let n=he(r,"a","atan2"),s=he(t,"b","atan2");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(Xj,i)}const ZH=Ie({atan2_:V$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z$e(r){const n={x:he(r,"x","atanh")};return Fe.runKernel(Kj,n)}const QH=Ie({atanh_:z$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U$e(r,t,n,s,i,a,o="channelsLast"){const[u,l]=Cb(t);let c;if(o==="channelsLast")c=[u,l,r[3],r[3]];else if(o==="channelsFirst")c=[u,l,r[1],r[1]];else throw new Error(`Unknown dataFormat ${o}`);return Uk(r,c,n,s,i,a,!1,o)}function Uk(r,t,n,s,i,a,o=!1,u="channelsLast"){let[l,c,h,f]=[-1,-1,-1,-1];if(u==="channelsLast")[l,c,h,f]=r;else if(u==="channelsFirst")[l,f,c,h]=r;else throw new Error(`Unknown dataFormat ${u}`);const[p,g,,y]=t,[x,v]=Cb(n),[S,w]=Cb(s),E=CD(p,S),_=CD(g,w),{padInfo:D,outHeight:I,outWidth:k}=W$e(i,c,h,x,v,E,_,a,u),A=o?y*f:y;let N;return u==="channelsFirst"?N=[l,A,I,k]:u==="channelsLast"&&(N=[l,I,k,A]),{batchSize:l,dataFormat:u,inHeight:c,inWidth:h,inChannels:f,outHeight:I,outWidth:k,outChannels:A,padInfo:D,strideHeight:x,strideWidth:v,filterHeight:p,filterWidth:g,effectiveFilterHeight:E,effectiveFilterWidth:_,dilationHeight:S,dilationWidth:w,inShape:r,outShape:N,filterShape:t}}function G$e(r,t,n,s,i){s==null&&(s=j$e(r,t,n));const a=r[0],o=r[1],u=_b((a-t+2*s)/n+1,i),l=_b((o-t+2*s)/n+1,i);return[u,l]}function j$e(r,t,n,s=1){const i=CD(t,s);return Math.floor((r[0]*(n-1)-n+i)/2)}function Cb(r){return typeof r=="number"?[r,r,r]:r.length===2?[r[0],r[1],1]:r}function CD(r,t){return t<=1?r:r+(r-1)*(t-1)}function W$e(r,t,n,s,i,a,o,u,l){let c,h,f;if(typeof r=="number"){c={top:r,bottom:r,left:r,right:r,type:r===0?"VALID":"NUMBER"};const g=G$e([t,n],a,s,r,u);h=g[0],f=g[1]}else if(r==="same"){h=Math.ceil(t/s),f=Math.ceil(n/i);const p=Math.max(0,(h-1)*s+a-t),g=Math.max(0,(f-1)*i+o-n),y=Math.floor(p/2),x=p-y,v=Math.floor(g/2),S=g-v;c={top:y,bottom:x,left:v,right:S,type:"SAME"}}else if(r==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((t-a+1)/s),f=Math.ceil((n-o+1)/i);else if(typeof r=="object"){const p=l==="channelsLast"?r[1][0]:r[2][0],g=l==="channelsLast"?r[1][1]:r[2][1],y=l==="channelsLast"?r[2][0]:r[3][0],x=l==="channelsLast"?r[2][1]:r[3][1];c={top:p,bottom:g,left:y,right:x,type:p===0&&g===0&&y===0&&x===0?"VALID":"EXPLICIT"},h=_b((t-a+p+g)/s+1,u),f=_b((n-o+y+x)/i+1,u)}else throw Error(`Unknown padding parameter: ${r}`);return{padInfo:c,outHeight:h,outWidth:f}}function _b(r,t){if(!t)return Math.trunc(r);switch(t){case"round":return Math.round(r);case"ceil":return Math.ceil(r);case"floor":return Math.floor(r);default:throw new Error(`Unknown roundingMode ${t}`)}}function yh(r){const[t,n,s]=Cb(r);return t===1&&n===1&&s===1}function na(r,t){return yh(r)||yh(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H$e(r,t){const s={x:he(r,"x","reshape","string_or_numeric")},i={shape:t};return Fe.runKernel(YW,s,i)}const He=Ie({reshape_:H$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q$e(r,t,n,s,i){const a=he(r,"x","avgPool","float32"),o=1;ye(na(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let u=a,l=!1;a.rank===3&&(l=!0,u=He(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ye(u.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${u.rank}.`),i!=null&&ye(Rs(s),()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i};let f=Fe.runKernel(Yj,c,h);return f=zt(f,a.dtype),l?He(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Gk=Ie({avgPool_:q$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K$e(r,t,n,s,i,a="NDHWC",o){o==null?o=[1,1,1]:Os("dilations is deprecated, this field will be gone in v3.0.0.");const u=he(r,"x","avgPool3d","float32");let l=u,c=!1;u.rank===4&&(c=!0,l=He(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),ye(l.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),ye(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),ye(na(n,o),()=>`Error in avgPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),i!=null&&ye(Rs(s),()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);const h={x:l},f={filterSize:t,strides:n,pad:s,dimRoundingMode:i,dataFormat:a,dilations:o};let p=Fe.runKernel(Zj,h,f);return p=zt(p,l.dtype),c?He(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const X$e=Ie({avgPool3d_:K$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$e(r,t=0){ye(r.length>=1,()=>"Pass at least one tensor to concat");const n=$H(r,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Y2(n[0]);const s=n,i={axis:t};return Fe.runKernel(rW,s,i)}const Ji=Ie({concat_:Y$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$e(r){const n={x:he(r,"x","sigmoid")};return Fe.runKernel(lH,n)}const e1=Ie({sigmoid_:Z$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$e(r,t,n){const s=he(r,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const i={x:s},a={begin:t,size:n};return Fe.runKernel(iH,i,a)}const Gr=Ie({slice_:Q$e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$e(r){const n={x:he(r,"x","tanh")};return Fe.runKernel(bH,n)}const JH=Ie({tanh_:J$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4e(r,t,n){const s=he(r,"x","batchToSpaceND"),i=t.reduce((u,l)=>u*l);ye(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),ye(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),ye(s.shape[0]%i===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`);const a={x:s},o={blockShape:t,crops:n};return Fe.runKernel(Jj,a,o)}const Z2=Ie({batchToSpaceND_:e4e});function t4e(r){let t;return r.rank===0||r.rank===1?t=He(r,[1,1,1,r.size]):r.rank===2?t=He(r,[1,1,r.shape[0],r.shape[1]]):r.rank===3?t=He(r,[1,r.shape[0],r.shape[1],r.shape[2]]):t=r,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4e(r,t,n,s,i,a){a==null&&(a=.001);const o=he(r,"x","batchNorm"),u=he(t,"mean","batchNorm"),l=he(n,"variance","batchNorm");let c;i!=null&&(c=he(i,"scale","batchNorm"));let h;s!=null&&(h=he(s,"offset","batchNorm")),ye(u.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ye(h==null||u.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ye(c==null||u.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:t4e(o),scale:c,offset:h,mean:u,variance:l},g={varianceEpsilon:a},y=Fe.runKernel(vW,p,g);return He(y,o.shape)}const _D=Ie({batchNorm_:n4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4e(r,t,n){const s=he(r,"x","bincount"),i=he(t,"weights","bincount");ye(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),ye(n>=0,()=>`size must be non-negative, but got ${n}.`),ye(i.size===s.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${i.shape}.`);const a={x:s,weights:i},o={size:n};return Fe.runKernel(bIe,a,o)}const s4e=Ie({bincount_:r4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4e(r,t){let n=he(r,"broadcastTo","x");const s=n.shape;if(t.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=He(n,c)}const i=n.shape,a=Array.from(t);for(let c=t.length-1;c>=0;c--)if(i[c]===t[c])a[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(a.map((c,h)=>c>1?h:-1).filter(c=>c>=0).length===0)return Y2(n);const u={x:n},l={reps:a};return Fe.runKernel(Lk,u,l)}const Eb=Ie({broadcastTo_:i4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4e(r){const n={x:he(r,"x","ceil")};return Fe.runKernel(eW,n)}const eq=Ie({ceil_:a4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4e(r,t,n){const s=he(r,"x","clipByValue");ye(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`);const i={x:s},a={clipValueMin:t,clipValueMax:n};return Fe.runKernel(tW,i,a)}const tq=Ie({clipByValue_:o4e});function u4e(r,t){return Ji(r,t)}const nq=Ie({concat2d_:u4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4e(r,t,n,s,i="NHWC",a=[1,1],o){const u=he(r,"x","conv2d"),l=he(t,"filter","conv2d");let c=u,h=!1;u.rank===3&&(h=!0,c=He(u,[1,u.shape[0],u.shape[1],u.shape[2]])),ye(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),ye(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),o!=null&&ye(Rs(s),()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`);const f=i==="NHWC"?c.shape[3]:c.shape[1];ye(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),ye(na(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const p={x:c,filter:l},g={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o},y=Fe.runKernel(sW,p,g);return h?He(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const rp=Ie({conv2d_:l4e});function c4e(r,t,n,s,i="NWC",a=1,o){const u=he(r,"x","conv1d"),l=he(t,"filter","conv1d");let c=u,h=!1;u.rank===2&&(h=!0,c=He(u,[1,u.shape[0],u.shape[1]])),ye(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),ye(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),o!=null&&ye(Rs(s),()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`),ye(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),ye(na(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),ye(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=He(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=He(c,[c.shape[0],1,c.shape[1],c.shape[2]]),v=rp(p,f,[1,n],s,"NHWC",[1,a],o);return h?He(v,[v.shape[2],v.shape[3]]):He(v,[v.shape[0],v.shape[2],v.shape[3]])}const rq=Ie({conv1d_:c4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4e(r,t,n,s,i,a="NHWC",o){ye(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let u=r,l=t,c=!1;t.rank===3&&(c=!0,l=He(t,[1,t.shape[0],t.shape[1],t.shape[2]]),u=[1,r[0],r[1],r[2]]),ye(u.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${u.length}.`),ye(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),ye(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const h=a==="NHWC"?u[3]:u[1],f=a==="NHWC"?l.shape[3]:l.shape[1];ye(h===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[2]}.`),ye(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),o!=null&&ye(Rs(i),()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`);const p={dy:l,filter:n},g={strides:s,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:u},y=Fe.runKernel(iW,p,g);return c?He(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const jk=Ie({conv2DBackpropInput_:h4e});function f4e(r,t,n,s,i,a){const o=he(r,"x","conv2dTranspose"),u=he(t,"filter","conv2dTranspose");return jk(n,o,u,s,i,"NHWC",a)}const sq=Ie({conv2dTranspose_:f4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4e(r,t,n,s,i="NDHWC",a=[1,1,1]){const o=he(r,"x","conv3d"),u=he(t,"filter","conv3d");let l=o,c=!1;o.rank===4&&(c=!0,l=He(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ye(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),ye(u.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${u.rank}.`),ye(l.shape[4]===u.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${u.shape[3]}.`),ye(na(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),ye(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`);const h={x:l,filter:u},f={strides:n,pad:s,dataFormat:i,dilations:a},p=Fe.runKernel(aW,h,f);return c?He(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const p4e=Ie({conv3d_:d4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m4e(r,t,n,s,i){ye(r.length===t.rank,()=>`Length of inShape (${r.length}) and rank of dy (${t.rank}) must match`);let a=r,o=t,u=!1;t.rank===4&&(u=!0,o=He(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,r[0],r[1],r[2],r[3]]);const l=a[4],c=o.shape[4];ye(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),ye(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),ye(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),ye(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),ye(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const h={dy:o,filter:n},f={pad:i,strides:s,inputShape:a},p=Fe.runKernel(_Ie,h,f);return u?He(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const g4e=Ie({conv3DBackpropInput_:m4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4e(r){const n={x:he(r,"x","cos")};return Fe.runKernel(oW,n)}const Q2=Ie({cos_:y4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4e(r){const n={x:he(r,"x","cosh")};return Fe.runKernel(uW,n)}const Wk=Ie({cosh_:x4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4e(r,t=0,n=!1,s=!1){const a={x:he(r,"x","cumsum")},o={axis:t,exclusive:n,reverse:s};return Fe.runKernel(lW,a,o)}const Hk=Ie({cumsum_:b4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4e(r,t,n,s=!1){const i=he(r,"x","denseBincount"),a=he(t,"weights","denseBincount");ye(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),ye(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),ye(n>=0,()=>`size must be non-negative, but got ${n}.`),ye(a.size===i.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`);const o={x:i,weights:a},u={size:n,binaryOutput:s};return Fe.runKernel(DIe,o,u)}const w4e=Ie({denseBincount_:v4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4e(r,t,n="NHWC"){const s=he(r,"x","depthToSpace"),i=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];ye(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${s.shape}`),ye(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${s.shape}`),ye(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${s.shape}`);const u={x:s},l={blockSize:t,dataFormat:n};return Fe.runKernel(TIe,u,l)}const iq=Ie({depthToSpace_:S4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4e(r,t,n,s,i="NHWC",a=[1,1],o){const u=he(r,"x","depthwiseConv2d"),l=he(t,"filter","depthwiseConv2d");let c=u,h=!1;u.rank===3&&(h=!0,c=He(u,[1,u.shape[0],u.shape[1],u.shape[2]])),ye(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),ye(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`),ye(c.shape[3]===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),o!=null&&ye(Rs(s),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`);const f={x:c,filter:l},p={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o},g=Fe.runKernel(cW,f,p);return h?He(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const t1=Ie({depthwiseConv2d_:C4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4e(r,t,n,s,i=[1,1],a="NHWC"){const o=he(r,"x","dilation2d"),u=he(t,"filter","dilation2d");ye(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),ye(u.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${u.rank}.`),ye(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=o,c=!1;o.rank===3&&(l=He(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);const h={x:l,filter:u},f={strides:n,pad:s,dilations:i},p=Fe.runKernel(hW,h,f);return c?He(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const aq=Ie({dilation2d_:_4e});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(r,t){const n=[];for(let s=0;s<t.length;s++){const i=r[r.length-s-1],a=t.length-s-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function Tr(r,t){const n=[],s=Math.max(r.length,t.length);for(let i=0;i<s;i++){let a=r[r.length-i-1];a==null&&(a=1);let o=t[t.length-i-1];if(o==null&&(o=1),a===1)n.unshift(o);else if(o===1)n.unshift(a);else if(a!==o){const u=`Operands could not be broadcast together with shapes ${r} and ${t}.`;throw Error(u)}else n.unshift(a)}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4e(r,t){let n=he(r,"a","equal"),s=he(t,"b","equal");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(FIe,i)}const n1=Ie({equal_:E4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4e(r,t,n){const s=he(t,"a","where"),i=he(n,"b","where"),a=he(r,"condition","where","bool"),o=Tr(s.shape,i.shape),u=Eb(s,o),l=Eb(i,o);a.rank===1&&ye(a.shape[0]===s.shape[0],()=>"The first dimension of `a` must match the size of `condition`."),a.rank!==1&&js(a.shape,l.shape,"Error in where: ");const c={condition:a,t:u,e:l};return Fe.runKernel(rH,c)}const Lo=Ie({where_:D4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4e(r){const n={x:he(r,"x","zerosLike")};return Fe.runKernel(CH,n)}const vr=Ie({zerosLike_:T4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4e(r,t){let n=he(r,"a","div"),s=he(t,"b","div");[n,s]=Ar(n,s);const i=tr(n,s),a=vr(i),o=n1(s,a);return Lo(o,a,i)}const oq=Ie({divNoNan_:N4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4e(r,t){const n=he(r,"t1","dot"),s=he(t,"t2","dot");ye((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const i=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(ye(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),n.rank===1&&s.rank===1){const o=He(n,[1,-1]),u=He(s,[-1,1]),l=kr(o,u);return He(l,[])}else if(n.rank===1&&s.rank===2){const o=He(n,[1,-1]),u=He(s,[s.shape[0],s.shape[1]]),l=kr(o,u);return He(l,[l.size])}else if(n.rank===2&&s.rank===1){const o=He(s,[-1,1]),u=kr(n,o);return He(u,[u.size])}else{const o=He(s,[s.shape[0],s.shape[1]]);return kr(n,o)}}const A4e=Ie({dot_:k4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4e(r){const n={x:he(r,"x","elu")};return Fe.runKernel(dW,n)}const qk=Ie({elu_:I4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4e(r){let t=he(r,"x","erf");ye(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=zt(t,"float32"));const n={x:t};return Fe.runKernel(pW,n)}const uq=Ie({erf_:$4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4e(r){const n={x:he(r,"x","exp")};return Fe.runKernel(mW,n)}const Du=Ie({exp_:F4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4e(r,t=0){const n=he(r,"x","expandDims","string_or_numeric");ye(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},i={dim:t};return Fe.runKernel(gW,s,i)}const Kk=Ie({expandDims_:R4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O4e(r){const n={x:he(r,"x","expm1")};return Fe.runKernel(yW,n)}const lq=Ie({expm1_:O4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M4e(r,t){const n=he(r,"x","tile","string_or_numeric");ye(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},i={reps:t};return Fe.runKernel(Lk,s,i)}const Xk=Ie({tile_:M4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4e(r,t,n){const s={shape:r,value:t,dtype:n};return Fe.runKernel(OIe,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4e(r){const n={x:he(r,"x","floor")};return Fe.runKernel(xW,n)}const Yk=Ie({floor_:B4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4e(r,t,n=0,s=0){const i=he(r,"x","gather"),a=he(t,"indices","gather","int32"),o={x:i,indices:a},u={axis:n,batchDims:s};return Fe.runKernel(wW,o,u)}const Db=Ie({gather_:P4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4e(r,t){let n=he(r,"a","greater"),s=he(t,"b","greater");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(BIe,i)}const Yl=Ie({greater_:V4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4e(r,t){let n=he(r,"a","greaterEqual"),s=he(t,"b","greaterEqual");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(SW,i)}const sp=Ie({greaterEqual_:z4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4e(r){const n={input:he(r,"input","imag")};return Fe.runKernel(VIe,n)}const Zk=Ie({imag_:U4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G4e(r){const n={x:he(r,"x","isFinite")};return Fe.runKernel(_W,n)}const j4e=Ie({isFinite_:G4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4e(r){const n={x:he(r,"x","isInf")};return Fe.runKernel(EW,n)}const H4e=Ie({isInf_:W4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4e(r){const n={x:he(r,"x","isNaN")};return Fe.runKernel(DW,n)}const K4e=Ie({isNaN_:q4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4e(r,t=.2){const s={x:he(r,"x","leakyRelu")},i={alpha:t};return Fe.runKernel(TW,s,i)}const Qk=Ie({leakyRelu_:X4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4e(r,t){let n=he(r,"a","less"),s=he(t,"b","less");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(zIe,i)}const J2=Ie({less_:Y4e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4e(r,t){let n=he(r,"a","lessEqual"),s=he(t,"b","lessEqual");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(UIe,i)}const ip=Ie({lessEqual_:Z4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4e(r,t,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:r,stop:t,num:n};return Fe.runKernel(GIe,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4e(r,t=5,n=1,s=1,i=.5){const a=he(r,"x","localResponseNormalization");ye(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),ye(Rs(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=a,u=!1;a.rank===3&&(u=!0,o=He(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:o},c={depthRadius:t,bias:n,alpha:s,beta:i},h=Fe.runKernel(AW,l,c);return u?He(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const cq=Ie({localResponseNormalization_:J4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eFe(r){const n={x:he(r,"x","log")};return Fe.runKernel(NW,n)}const r1=Ie({log_:eFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(r){const n={x:he(r,"x","log1p")};return Fe.runKernel(kW,n)}const hq=Ie({log1p_:tFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pl(r){return Fe.customGrad(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nFe(r){const n={x:he(r,"x","neg")};return Fe.runKernel(zW,n)}const Js=Ie({neg_:nFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rFe(r){const n={x:he(r,"x","softplus")};return Fe.runKernel(cH,n)}const Jk=Ie({softplus_:rFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(r){const t=he(r,"x","logSigmoid");return Pl(s=>({value:Js(Jk(Js(s))),gradFunc:o=>xt(o,e1(Js(s)))}))(t)}const iFe=Ie({logSigmoid_:sFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aFe(r,t=null,n=!1){const i={x:he(r,"x","max")},a={reductionIndices:t,keepDims:n};return Fe.runKernel(IW,i,a)}const zc=Ie({max_:aFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oFe(r,t){let n=he(r,"a","sub"),s=he(t,"b","sub");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(yH,i)}const nr=Ie({sub_:oFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uFe(r,t=null,n=!1){let s=he(r,"x","sum");s.dtype==="bool"&&(s=zt(s,"int32"));const i={x:s},a={axis:t,keepDims:n};return Fe.runKernel(fH,i,a)}const Cn=Ie({sum_:uFe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lFe(r,t=-1){const n=he(r,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Pl((i,a)=>{const u=zc(i,t,!0),l=nr(i,u),c=nr(zt(l,"float32"),r1(Cn(Du(l),t,!0)));return a([c]),{value:c,gradFunc:(f,p)=>{const[g]=p,y=!0,x=Du(g);return nr(f,xt(Cn(f,t,y),x))}}})(n)}const fq=Ie({logSoftmax_:lFe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cFe(r,t){for(let n=0;n<r.length;++n)if(r[r.length-n-1]!==t-1-n)return!1;return!0}function hFe(r,t,n){const s=r.length+t.length,i=[];let a=0,o=0;for(let u=0;u<s;u++)n.indexOf(u)===-1?i.push(r[a++]):i.push(t[o++]);return i}function fFe(r,t){const n=[],s=r.length;for(let a=0;a<s;a++)t.indexOf(a)===-1&&n.push(r[a]);const i=t.map(a=>r[a]);return[n,i]}function Tb(r,t){const n=t.map(s=>1);return hFe(r,n,t)}function dFe(r,t){if(cFe(r,t))return null;const n=[];for(let s=0;s<t;++s)r.indexOf(s)===-1&&n.push(s);return r.forEach(s=>n.push(s)),n}function dq(r){return r.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pFe(r,t=null,n=!1){const s=he(r,"x","logSumExp"),i=Uo(t,s.shape),a=zc(s,i,!0),o=nr(s,a),u=Du(o),l=Cn(u,i),c=r1(l),h=ms(He(a,c.shape),c);if(n){const f=Tb(h.shape,i);return He(h,f)}return h}const mFe=Ie({logSumExp_:pFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gFe(r,t){const n=he(r,"a","logicalAnd","bool"),s=he(t,"b","logicalAnd","bool");Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(jIe,i)}const $d=Ie({logicalAnd_:gFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yFe(r){const n={x:he(r,"x","logicalNot","bool")};return Fe.runKernel(WIe,n)}const ew=Ie({logicalNot_:yFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xFe(r,t){const n=he(r,"a","logicalOr","bool"),s=he(t,"b","logicalOr","bool");Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(HIe,i)}const eA=Ie({logicalOr_:xFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bFe(r,t){const n=he(r,"a","logicalXor","bool"),s=he(t,"b","logicalXor","bool");return Tr(n.shape,s.shape),$d(eA(r,t),ew($d(r,t)))}const vFe=Ie({logicalXor_:bFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wFe(r,t,n,s,i){const a=he(r,"x","maxPool"),o=1;let u=a,l=!1;a.rank===3&&(l=!0,u=He(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ye(u.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${u.rank}.`),ye(na(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),i!=null&&ye(Rs(s),()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);const c={x:u},h={filterSize:t,strides:n,pad:s,dimRoundingMode:i},f=Fe.runKernel(FW,c,h);return l?He(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const tA=Ie({maxPool_:wFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SFe(r,t=[1,1,1],n,s,i,a="NDHWC",o){o==null?o=[1,1,1]:Os("dilations is deprecated, this field will be gone in v3.0.0.");const u=he(r,"x","maxPool3d");let l=u,c=!1;u.rank===4&&(c=!0,l=He(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),ye(l.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),ye(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),ye(na(n,o),()=>`Error in maxPool3d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),i!=null&&ye(Rs(s),()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${i} but got pad ${s}.`);const h={x:l},f={filterSize:t,strides:n,pad:s,dimRoundingMode:i,dataFormat:a,dilations:o},p=Fe.runKernel(RW,h,f);return c?He(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const CFe=Ie({maxPool3d_:SFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Fe(r,t,n,s,i=!1){const o={x:he(r,"x","maxPoolWithArgmax")},u={filterSize:t,strides:n,pad:s,includeBatchInIndex:i},l=Fe.runKernel(ZIe,o,u);return{result:l[0],indexes:l[1]}}const EFe=Ie({maxPoolWithArgmax_:_Fe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DFe(r,t){let n=he(r,"a","maximum"),s=he(t,"b","maximum");[n,s]=Ar(n,s),n.dtype==="bool"&&(n=zt(n,"int32"),s=zt(s,"int32")),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel($W,i)}const tw=Ie({maximum_:DFe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TFe(r,t=null,n=!1){const i={x:he(r,"x","mean")},a={axis:t,keepDims:n};return Fe.runKernel(OW,i,a)}const pq=Ie({mean_:TFe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NFe(r,t=null,n=!1){const i={x:he(r,"x","min")},a={axis:t,keepDims:n};return Fe.runKernel(MW,i,a)}const Nb=Ie({min_:NFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kFe(r,t){let n=he(r,"a","minimum"),s=he(t,"b","minimum");[n,s]=Ar(n,s),n.dtype==="bool"&&(n=zt(n,"int32"),s=zt(s,"int32")),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(LW,i)}const nA=Ie({minimum_:kFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AFe(r,t,n){ye(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=he(r,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ye(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const i=n==="reflect"?1:0;for(let u=0;u<s.rank;u++)ye(t[u].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ye(t[u][0]>=0&&t[u][0]<=s.shape[u]-i&&t[u][1]>=0&&t[u][1]<=s.shape[u]-i,()=>`Padding in dimension ${u} cannot be greater than or equal to ${s.shape[u]-i} or less than 0 for input of shape ${s.shape}`);const a={paddings:t,mode:n},o={x:s};return Fe.runKernel(BW,o,a)}const mq=Ie({mirrorPad_:AFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IFe(r,t){let n=he(r,"a","mod"),s=he(t,"b","mod");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(PW,i)}const rA=Ie({mod_:IFe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Fe(r){const t=he(r,"x","square"),n={};return Fe.runKernel("Square",{x:t},n)}const gs=Ie({square_:$Fe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FFe(r,t,n,s=!1){const i=he(r,"logits","multinomial"),a=i.size,o=i.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const l={logits:o===1?He(i,[1,-1]):i},c={numSamples:t,seed:n,normalized:s},h=Fe.runKernel(QIe,l,c);return o===1?He(h,[h.size]):h}const RFe=Ie({multinomial_:FFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OFe(r,t){let n=he(r,"a","notEqual"),s=he(t,"b","notEqual");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s};return Fe.runKernel(JIe,i)}const sA=Ie({notEqual_:OFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fd(r,t="float32"){if(t==="complex64"){const s=Fd(r,"float32"),i=Fd(r,"float32");return ph(s,i)}const n=Rk(Ai(r),t);return Fe.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s1(r,t="float32"){if(t==="complex64"){const s=s1(r,"float32"),i=Fd(r,"float32");return ph(s,i)}const n=Rj(Ai(r),t);return Fe.makeTensor(n,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MFe(r){const n={x:he(r,"x","onesLike")};return Fe.runKernel(UW,n)}const gq=Ie({onesLike_:MFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LFe(r,t,n=0){const s=he(r,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},a={x:s};return Fe.runKernel(WW,a,i)}const iA=Ie({pad_:LFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BFe(r,t,n){const s=he(r,"x","spaceToBatchND");ye(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),ye(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),ye(s.shape.reduce((o,u,l)=>l>0&&l<=t.length?o&&(u+n[l-1][0]+n[l-1][1])%t[l-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const i={x:s},a={blockShape:t,paddings:n};return Fe.runKernel(dH,i,a)}const nw=Ie({spaceToBatchND_:BFe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PFe(r,t,n,s,i,a){i==null&&(i=[1,1]),a==null&&(a=1),s===0&&(s="valid");const o=he(r,"x","maxPool");let u=o,l=!1;o.rank===3&&(l=!0,u=He(o,[1,o.shape[0],o.shape[1],o.shape[2]])),ye(na(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);const c=U$e(u.shape,t,a,i,s),h=[c.dilationHeight,c.dilationWidth];let f;s==="same"?f=zFe([c.filterHeight,c.filterWidth],h):f=[[0,0],[0,0]];const p=h[0]===1&&h[1]===1,[g,y]=VFe([c.inHeight,c.inWidth],h,f),x=p?s:"valid",v=p?u:nw(u,h,g),w=(n==="avg"?()=>Gk(v,t,a,x):()=>tA(v,t,a,x))(),E=p?w:Z2(w,h,y);return l?He(E,[E.shape[1],E.shape[2],E.shape[3]]):E}function VFe(r,t,n){const s=n.map(h=>h[0]),i=n.map(h=>h[1]),a=r.concat(s,i),o=t.map((h,f)=>(h-a[f]%h)%h),u=i.map((h,f)=>h+o[f]),l=t.map((h,f)=>[s[f],u[f]]),c=t.map((h,f)=>[0,o[f]]);return[l,c]}function zFe(r,t){const s=r.map((o,u)=>o+(o-1)*(t[u]-1)).map(o=>o-1),i=s.map(o=>Math.floor(o/2)),a=s.map((o,u)=>o-i[u]);return s.map((o,u)=>[i[u],a[u]])}const UFe=Ie({pool_:PFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GFe(r,t){let n=he(r,"base","pow"),s=he(t,"exp","pow");[n,s]=Ar(n,s);const i={a:n,b:s};return Fe.runKernel(HW,i)}const ap=Ie({pow_:GFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jFe(r,t){const n=he(r,"x","prelu"),s=he(t,"alpha","prelu"),i={x:n,alpha:s};return Fe.runKernel(qW,i)}const aA=Ie({prelu_:jFe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WFe(r,t=null,n=!1){let s=he(r,"x","prod");s.dtype==="bool"&&(s=zt(s,"int32"));const i={x:s},a={axis:t,keepDims:n};return Fe.runKernel(r5e,i,a)}const oA=Ie({prod_:WFe});var gx={exports:{}},HFe=gx.exports,yL;function qFe(){return yL||(yL=1,function(r){(function(t,n,s){function i(l){var c=this,h=u();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=h(" "),c.s1=h(" "),c.s2=h(" "),c.s0-=h(l),c.s0<0&&(c.s0+=1),c.s1-=h(l),c.s1<0&&(c.s1+=1),c.s2-=h(l),c.s2<0&&(c.s2+=1),h=null}function a(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function o(l,c){var h=new i(l),f=c&&c.state,p=h.next;return p.int32=function(){return h.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&a(f,h),p.state=function(){return a(h,{})}),p}function u(){var l=4022871197,c=function(h){h=h.toString();for(var f=0;f<h.length;f++){l+=h.charCodeAt(f);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=o:this.alea=o})(HFe,r)}(gx)),gx.exports}var yx={exports:{}},KFe=yx.exports,xL;function XFe(){return xL||(xL=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},u===(u|0)?l.x=u:c+=u;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,l.next()}function a(u,l){return l.x=u.x,l.y=u.y,l.z=u.z,l.w=u.w,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor128=o})(KFe,r)}(yx)),yx.exports}var xx={exports:{}},YFe=xx.exports,bL;function ZFe(){return bL||(bL=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,u===(u|0)?l.x=u:c+=u;for(var h=0;h<c.length+64;h++)l.x^=c.charCodeAt(h)|0,h==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(u,l){return l.x=u.x,l.y=u.y,l.z=u.z,l.w=u.w,l.v=u.v,l.d=u.d,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorwow=o})(YFe,r)}(xx)),xx.exports}var bx={exports:{}},QFe=bx.exports,vL;function JFe(){return vL||(vL=1,function(r){(function(t,n,s){function i(u){var l=this;l.next=function(){var h=l.x,f=l.i,p,g;return p=h[f],p^=p>>>7,g=p^p<<24,p=h[f+1&7],g^=p^p>>>10,p=h[f+3&7],g^=p^p>>>3,p=h[f+4&7],g^=p^p<<7,p=h[f+7&7],p=p^p<<13,g^=p^p<<9,h[f]=g,l.i=f+1&7,g};function c(h,f){var p,g=[];if(f===(f|0))g[0]=f;else for(f=""+f,p=0;p<f.length;++p)g[p&7]=g[p&7]<<15^f.charCodeAt(p)+g[p+1&7]<<13;for(;g.length<8;)g.push(0);for(p=0;p<8&&g[p]===0;++p);for(p==8?g[7]=-1:g[p],h.x=g,h.i=0,p=256;p>0;--p)h.next()}c(l,u)}function a(u,l){return l.x=u.x.slice(),l.i=u.i,l}function o(u,l){u==null&&(u=+new Date);var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.x&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xorshift7=o})(QFe,r)}(bx)),bx.exports}var vx={exports:{}},eRe=vx.exports,wL;function tRe(){return wL||(wL=1,function(r){(function(t,n,s){function i(u){var l=this;l.next=function(){var h=l.w,f=l.X,p=l.i,g,y;return l.w=h=h+1640531527|0,y=f[p+34&127],g=f[p=p+1&127],y^=y<<13,g^=g<<17,y^=y>>>15,g^=g>>>12,y=f[p]=y^g,l.i=p,y+(h^h>>>16)|0};function c(h,f){var p,g,y,x,v,S=[],w=128;for(f===(f|0)?(g=f,f=null):(f=f+"\0",g=0,w=Math.max(w,f.length)),y=0,x=-32;x<w;++x)f&&(g^=f.charCodeAt((x+32)%f.length)),x===0&&(v=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,x>=0&&(v=v+1640531527|0,p=S[x&127]^=g+v,y=p==0?y+1:0);for(y>=128&&(S[(f&&f.length||0)&127]=-1),y=127,x=4*128;x>0;--x)g=S[y+34&127],p=S[y=y+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,S[y]=g^p;h.w=v,h.X=S,h.i=y}c(l,u)}function a(u,l){return l.i=u.i,l.w=u.w,l.X=u.X.slice(),l}function o(u,l){u==null&&(u=+new Date);var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(h.X&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.xor4096=o})(eRe,r)}(vx)),vx.exports}var wx={exports:{}},nRe=wx.exports,SL;function rRe(){return SL||(SL=1,function(r){(function(t,n,s){function i(u){var l=this,c="";l.next=function(){var f=l.b,p=l.c,g=l.d,y=l.a;return f=f<<25^f>>>7^p,p=p-g|0,g=g<<24^g>>>8^y,y=y-f|0,l.b=f=f<<20^f>>>12^p,l.c=p=p-g|0,l.d=g<<16^p>>>16^y,l.a=y-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,u===Math.floor(u)?(l.a=u/4294967296|0,l.b=u|0):c+=u;for(var h=0;h<c.length+20;h++)l.b^=c.charCodeAt(h)|0,l.next()}function a(u,l){return l.a=u.a,l.b=u.b,l.c=u.c,l.d=u.d,l}function o(u,l){var c=new i(u),h=l&&l.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var p=c.next()>>>11,g=(c.next()>>>0)/4294967296,y=(p+g)/(1<<21);while(y===0);return y},f.int32=c.next,f.quick=f,h&&(typeof h=="object"&&a(h,c),f.state=function(){return a(c,{})}),f}n&&n.exports?n.exports=o:this.tychei=o})(nRe,r)}(wx)),wx.exports}var k_={exports:{}},CL;function sRe(){return CL||(CL=1,function(r){(function(t,n){var s=this,i=256,a=6,o=52,u="random",l=n.pow(i,a),c=n.pow(2,o),h=c*2,f=i-1,p;function g(_,D,I){var k=[];D=D==!0?{entropy:!0}:D||{};var A=S(v(D.entropy?[_,E(t)]:_??w(),3),k),N=new y(k),F=function(){for(var $=N.g(a),O=l,M=0;$<c;)$=($+M)*i,O*=i,M=N.g(1);for(;$>=h;)$/=2,O/=2,M>>>=1;return($+M)/O};return F.int32=function(){return N.g(4)|0},F.quick=function(){return N.g(4)/4294967296},F.double=F,S(E(N.S),t),(D.pass||I||function($,O,M,B){return B&&(B.S&&x(B,N),$.state=function(){return x(N,{})}),M?(n[u]=$,O):$})(F,A,"global"in D?D.global:this==n,D.state)}n["seed"+u]=g;function y(_){var D,I=_.length,k=this,A=0,N=k.i=k.j=0,F=k.S=[];for(I||(_=[I++]);A<i;)F[A]=A++;for(A=0;A<i;A++)F[A]=F[N=f&N+_[A%I]+(D=F[A])],F[N]=D;(k.g=function($){for(var O,M=0,B=k.i,U=k.j,V=k.S;$--;)O=V[B=f&B+1],M=M*i+V[f&(V[B]=V[U=f&U+O])+(V[U]=O)];return k.i=B,k.j=U,M})(i)}function x(_,D){return D.i=_.i,D.j=_.j,D.S=_.S.slice(),D}function v(_,D){var I=[],k=typeof _,A;if(D&&k=="object")for(A in _)try{I.push(v(_[A],D-1))}catch{}return I.length?I:k=="string"?_:_+"\0"}function S(_,D){for(var I=_+"",k,A=0;A<I.length;)D[f&A]=f&(k^=D[f&A]*19)+I.charCodeAt(A++);return E(D)}function w(){try{var _;return p&&(_=p.randomBytes)?_=_(i):(_=new Uint8Array(i),(s.crypto||s.msCrypto).getRandomValues(_)),E(_)}catch{var D=s.navigator,I=D&&D.plugins;return[+new Date,s,I,s.screen,E(t)]}}function E(_){return String.fromCharCode.apply(0,_)}if(S(n.random(),t),r.exports){r.exports=g;try{p=L7}catch{}}})([],Math)}(k_)),k_.exports}var A_,_L;function iRe(){if(_L)return A_;_L=1;var r=qFe(),t=XFe(),n=ZFe(),s=JFe(),i=tRe(),a=rRe(),o=sRe();return o.alea=r,o.xor128=t,o.xorwow=n,o.xorshift7=s,o.xor4096=i,o.tychei=a,A_=o,A_}var yq=iRe();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aRe{constructor(t,n,s,i,a){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=yq.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let t,n,s=!1;for(;!s;){let i,a,o;do i=2*this.random()-1,a=2*this.random()-1,o=i*i+a*a;while(o>=1||o===0);const u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*i*u,n=this.mean+this.stdDev*a*u,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class oRe{constructor(t=0,n=1,s,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=yq.alea(i)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRe(r,t=0,n=1,s="float32",i){const a=wg(r,s),o=new oRe(t,n,null,i);for(let u=0;u<a.values.length;u++)a.values[u]=o.nextValue();return a.toTensor()}const lRe=Ie({randomUniform_:uRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cRe(r,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:r,stop:t,step:n,dtype:s};return Fe.runKernel(s5e,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hRe(r){const n={input:he(r,"input","real")};return Fe.runKernel(i5e,n)}const kb=Ie({real_:hRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fRe(r){const n={x:he(r,"x","reciprocal")};return Fe.runKernel(KW,n)}const xq=Ie({reciprocal_:fRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(r){const n={x:he(r,"x","relu")};return Fe.runKernel(XW,n)}const uA=Ie({relu_:dRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pRe(r){const n={x:he(r,"x","relu6")};return Fe.runKernel(JW,n)}const lA=Ie({relu6_:pRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRe(r,t){const s={x:he(r,"x","reverse")},i={dims:t};return Fe.runKernel(eH,s,i)}const Rd=Ie({reverse_:mRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gRe(r){const n={x:he(r,"x","round")};return Fe.runKernel(tH,n)}const bq=Ie({round_:gRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yRe(r){const n={x:he(r,"x","rsqrt")};return Fe.runKernel(nH,n)}const cA=Ie({rsqrt_:yRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(r,t){if((Oo(r)&&t!=="string"||Array.isArray(r))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Oo(r)&&!(r instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return J0(r,[],[],t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xRe(r){const n={x:he(r,"x","selu")};return Fe.runKernel(sH,n)}const vq=Ie({selu_:xRe});function bRe(r,t,n,s,i,a=[1,1],o="NHWC"){const u=he(r,"x","separableConv2d"),l=he(t,"depthwiseFilter","separableConv2d"),c=he(n,"pointwiseFilter","separableConv2d");let h=u,f=!1;if(u.rank===3&&(f=!0,h=He(u,[1,u.shape[0],u.shape[1],u.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ye(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),ye(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),ye(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),ye(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),ye(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const p=l.shape[2],g=l.shape[3];ye(c.shape[2]===p*g,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*g}, but got ${c.shape[2]}.`);const y=t1(h,l,s,i,o,a),v=rp(y,c,1,"valid",o);return f?He(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const vRe=Ie({separableConv2d_:bRe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wRe(r,t){const n=he(r,"x","setdiff1d"),s=he(t,"y","setdiff1d");ye(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),ye(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),ye(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const i=await n.data(),a=await s.data(),o=new Set(a);let u=0;for(let h=0;h<i.length;h++)o.has(i[h])||u++;const l=new pD([u],n.dtype),c=new pD([u],"int32");for(let h=0,f=0;h<i.length;h++)o.has(i[h])||(l.values[f]=i[h],c.values[f]=h,f++);return[l.toTensor(),c.toTensor()]}const SRe=wRe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CRe(r){const n={x:he(r,"x","sign")};return Fe.runKernel(uH,n)}const wq=Ie({sign_:CRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Re(r){const n={x:he(r,"x","sin")};return Fe.runKernel(aH,n)}const hA=Ie({sin_:_Re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(r){const n={x:he(r,"x","sinh")};return Fe.runKernel(oH,n)}const fA=Ie({sinh_:ERe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DRe(r,t=-1){const n=he(r,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},i={dim:t};return Fe.runKernel(mH,s,i)}const Sq=Ie({softmax_:DRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TRe(r){ye(r.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${r.dtype}.`);const t={input:r};return Fe.runKernel(RIe,t)}const dA=Ie({fft_:TRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(r){ye(r.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${r.dtype}.`);const t={input:r};return Fe.runKernel(PIe,t)}const Ab=Ie({ifft_:NRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kRe(r){const t=r.shape[r.shape.length-1],n=r.size/t;let s;if(t<=2){const i=He(r,[n,t]);s=Ab(i)}else{const i=[n,2*(t-1)],a=He(kb(r),[n,t]),o=He(Zk(r),[n,t]),u=Rd(Gr(a,[0,1],[n,t-2]),1),l=xt(Rd(Gr(o,[0,1],[n,t-2]),1),ur(-1)),c=Ji([a,u],1),h=Ji([o,l],1),f=He(ph(c,h),[i[0],i[1]]);s=Ab(f)}if(s=kb(s),r.rank===3&&r.shape[0]!==0){const i=s,a=r.shape[0];s=He(s,[a,s.shape[0]/a,s.shape[1]]),i.dispose()}return s}const Cq=Ie({irfft_:kRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(r,t,n=0){const i={x:he(r,"x","split")},a={numOrSizeSplits:t,axis:n};return Fe.runKernel(pH,i,a)}const Sg=Ie({split_:ARe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(r,t){ye(r.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${r.dtype}`);let n=r.shape[r.shape.length-1];const s=r.size/n;let i;if(t!=null&&t<n){const y=r.shape.map(v=>0),x=r.shape.map(v=>v);x[r.shape.length-1]=t,i=Gr(r,y,x),n=t}else if(t!=null&&t>n){const y=r.shape.map(x=>x);y[r.shape.length-1]=t-n,i=Ji([r,Fd(y)],r.shape.length-1),n=t}else i=r;const a=vr(i),o=He(ph(i,a),[s,n]),u=dA(o),l=Math.floor(n/2)+1,c=kb(u),h=Zk(u),f=Sg(c,[l,n-l],c.shape.length-1),p=Sg(h,[l,n-l],h.shape.length-1),g=i.shape.slice();return g[i.shape.length-1]=l,He(ph(f[0],p[0]),g)}const _q=Ie({rfft_:IRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Re(r){const n={x:he(r,"x","sqrt")};return Fe.runKernel(hH,n)}const Tu=Ie({sqrt_:$Re});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FRe(r,t){let n=he(r,"a","squaredDifference"),s=he(t,"b","squaredDifference");[n,s]=Ar(n,s),Tr(n.shape,s.shape);const i={a:n,b:s},a={};return Fe.runKernel(gH,i,a)}const pA=Ie({squaredDifference_:FRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RRe(r,t){const n=he(r,"x","squeeze");return He(n,tIe(n.shape,t).newShape)}const Ib=Ie({squeeze_:RRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ORe(r,t=0){const n=$H(r,"tensors","stack","string_or_numeric");ye(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&ye(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,i={axis:t};return Fe.runKernel(jW,s,i)}const xh=Ie({stack_:ORe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MRe(r,t=0){const s={x:he(r,"x","step")},i={alpha:t};return Fe.runKernel(_H,s,i)}const i1=Ie({step_:MRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRe(r,t,n,s,i=0,a=0,o=0,u=0,l=0){const h={x:he(r,"x","stridedSlice")},f={begin:t,end:n,strides:s,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:u,shrinkAxisMask:l};return Fe.runKernel(h5e,h,f)}const Eq=Ie({stridedSlice_:LRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BRe(r){const n={x:he(r,"x","tan")};return Fe.runKernel(xH,n)}const Dq=Ie({tan_:BRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ea(r,t){Ak(r);const n=Q0(r,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return J0(r,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(r,t,n){if(Ak(r),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Q0(r,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return J0(r,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(r,t=1,n=!0){const s=he(r,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=s.shape[s.shape.length-1];if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const a={x:s},o={k:t,sorted:n},[u,l]=Fe.runKernel(f5e,a,o);return{values:u,indices:l}}const Tq=Ie({topk_:PRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VRe(r,t=0,n=1,s,i){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new aRe(t,n,s,!0,i),o=wg(r,s);for(let u=0;u<o.values.length;u++)o.values[u]=a.nextValue();return o.toTensor()}const zRe=Ie({truncatedNormal_:VRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function URe(r,t=0){const n=he(r,"x","unique","string_or_numeric");ye(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},i={axis:t},[a,o]=Fe.runKernel(d5e,s,i);return{values:a,indices:o}}const DD=Ie({unique_:URe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GRe(r,t,n){const s=he(r,"x","unsortedSegmentSum"),i=he(t,"segmentIds","unsortedSegmentSum","int32");ye(Rs(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:i},o={numSegments:n};return Fe.runKernel(SH,a,o)}const Nq=Ie({unsortedSegmentSum_:GRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jRe(r,t=0){const n=he(r,"x","unstack","string_or_numeric");ye(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},i={axis:t};return Fe.runKernel(wH,s,i)}const Fh=Ie({unstack_:jRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WRe(r,t){const n=[];for(let a=0;a<t.length;a++)t[a]&&n.push(a);const s=wg(r,"int32"),i=wg([n.length,r.length],"int32");for(let a=0;a<n.length;a++){const o=s.indexToLoc(n[a]),u=a*r.length;i.values.set(o,u)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function HRe(r){const t=he(r,"condition","whereAsync","bool"),n=await t.data(),s=WRe(t.shape,n);return r!==t&&t.dispose(),s}const qRe=HRe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","notEqualStrict"),s=he(t,"b","notEqualStrict");return js(n.shape,s.shape,"Error in notEqualStrict: "),sA(n,s)}function XRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","lessStrict"),s=he(t,"b","lessStrict");return js(n.shape,s.shape,"Error in lessStrict: "),J2(n,s)}function YRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","equalStrict"),s=he(t,"b","equalStrict");return js(n.shape,s.shape,"Error in equalStrict: "),n1(n,s)}function ZRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","lessEqualStrict"),s=he(t,"b","lessEqualStrict");return js(n.shape,s.shape,"Error in lessEqualStrict: "),ip(n,s)}function QRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","greaterStrict"),s=he(t,"b","greaterStrict");return js(n.shape,s.shape,"Error in greaterStrict: "),Yl(n,s)}function JRe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","greaterEqualStrict"),s=he(t,"b","greaterEqualStrict");return js(n.shape,s.shape,"Error in greaterEqualStrict: "),sp(n,s)}const eOe=Ie({equalStrict_:YRe}),tOe=Ie({greaterEqualStrict_:JRe}),nOe=Ie({greaterStrict_:QRe}),rOe=Ie({lessEqualStrict_:ZRe}),sOe=Ie({lessStrict_:XRe}),iOe=Ie({notEqualStrict_:KRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","addStrict"),s=he(t,"b","addStrict");return js(n.shape,s.shape,"Error in addStrict: "),ms(n,s)}function oOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","subStrict"),s=he(t,"b","subStrict");return js(n.shape,s.shape,"Error in subStrict: "),nr(n,s)}function uOe(r,t){return Os("strict variants of ops have been deprecated and will be removed in future"),js(r.shape,t.shape,"Error in powStrict: "),ap(r,t)}function lOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","mul"),s=he(t,"b","mul");return js(n.shape,s.shape,"Error in multiplyStrict: "),xt(n,s)}function cOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","div"),s=he(t,"b","div");return js(n.shape,s.shape,"Error in divideStrict: "),tr(n,s)}function hOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","modStrict"),s=he(t,"b","modStrict");return js(n.shape,s.shape,"Error in modStrict: "),rA(n,s)}function fOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","minimumStrict"),s=he(t,"b","minimumStrict");return js(n.shape,s.shape,"Error in minimumStrict: "),nA(n,s)}function dOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","maximumStrict"),s=he(t,"b","maximumStrict");return js(n.shape,s.shape,"Error in maximumStrict: "),tw(n,s)}function pOe(r,t){Os("strict variants of ops have been deprecated and will be removed in future");const n=he(r,"a","squaredDifferenceStrict"),s=he(t,"b","squaredDifferenceStrict");return js(n.shape,s.shape,"Error in squaredDifferenceStrict: "),pA(n,s)}const mOe=Ie({addStrict_:aOe}),gOe=Ie({divStrict_:cOe}),yOe=Ie({maximumStrict_:dOe}),xOe=Ie({minimumStrict_:fOe}),bOe=Ie({modStrict_:hOe}),vOe=Ie({mulStrict_:lOe}),wOe=Ie({powStrict_:uOe}),SOe=Ie({squaredDifferenceStrict_:pOe}),COe=Ie({subStrict_:oOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Oe(r,t="euclidean",n=null,s=!1){r=he(r,"x","norm");const i=kq(r,t,n);let a=i.shape;if(s){const o=Uo(n,r.shape);a=Tb(i.shape,o)}return He(i,a)}function kq(r,t,n=null){if(r.rank===0)return go(r);if(r.rank!==1&&n===null)return kq(He(r,[-1]),t,n);if(r.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return Cn(go(r),n);if(t===1/0)return zc(go(r),n);if(t===-1/0)return Nb(go(r),n);if(t==="euclidean"||t===2)return Tu(Cn(ap(go(r),ur(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return zc(Cn(go(r),n[0]),n[1]-1);if(t===1/0)return zc(Cn(go(r),n[1]),n[0]);if(t===-1/0)return Nb(Cn(go(r),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Tu(Cn(gs(r),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const EOe=Ie({norm_:_Oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DOe(r,t,n){const s=he(r,"indices","scatterND","int32"),i=he(t,"updates","scatterND");w$e(i,s,n);const a={indices:s,updates:i},o={shape:n};return Fe.runKernel(u5e,a,o)}const TOe=Ie({scatterND_:DOe});function NOe(r,t,n,s){if(r.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${r.dtype}.`);if(r.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${r.shape}.`);const i=r.rank>0?r.shape[0]:1,a=r.rank>1?r.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const o=t.size;if(!(t.rank===0||t.rank===1&&o===i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOe(r,t,n,s=0){const i=he(r,"sparseIndices","sparseToDense","int32"),a=he(t,"sparseValues","sparseToDense"),o=he(s,"defaultValue","sparseToDense",a.dtype);NOe(i,a,n,o);const u={sparseIndices:i,sparseValues:a,defaultValue:o},l={outputShape:n};return Fe.runKernel(c5e,u,l)}const Aq=Ie({sparseToDense_:kOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOe(r,t){const n=he(t,"indices","gatherND","int32"),i={params:he(r,"x","gatherND"),indices:n};return Fe.runKernel(LIe,i)}const IOe=Ie({gatherND_:AOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(r,t,n,s,i,a="NHWC",o){let u=r;r.rank===3&&(u=He(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=t;l.rank===3&&(l=He(t,[1,t.shape[0],t.shape[1],t.shape[2]])),ye(u.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${u.shape}.`),ye(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),ye(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=a==="NHWC"?u.shape[3]:u.shape[1],h=a==="NHWC"?l.shape[3]:l.shape[1];ye(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),ye(h===n[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${n[3]}).`),o!=null&&ye(Rs(i),()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${o} but got pad ${i}.`);const f={x:u,dy:l},p={strides:s,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return Fe.runKernel(SIe,f,p)}const mA=Ie({conv2DBackpropFilter_:$Oe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(r,t,n){if(n==null||n==="linear")return r;if(n==="relu")return xt(r,i1(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function yA(r,t){let n=t;const s=xs(r.shape,t.shape);return s.length>0&&(n=Cn(n,s)),He(n,r.shape)}function xA(r,t,n,s){if(t==="linear")return r;if(t==="relu")return uA(r);if(t==="elu")return qk(r);if(t==="relu6")return lA(r);if(t==="prelu")return aA(r,n);if(t==="leakyrelu")return Qk(r,s);throw new Error(`Unknown fused activation ${t}.`)}const bA=(r,t)=>!(r>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FOe({x:r,filter:t,strides:n,pad:s,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:u,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(l=l||"linear",bA(Fe.state.gradientDepth,l)===!1){let D=rp(r,t,n,s,i,a,o);return u!=null&&(D=ms(D,u)),xA(D,l,c,h)}const f=he(r,"x","conv2d"),p=he(t,"filter","conv2d");let g=f,y=!1;f.rank===3&&(y=!0,g=He(f,[1,f.shape[0],f.shape[1],f.shape[2]])),ye(g.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${g.rank}.`),ye(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),o!=null&&ye(Rs(s),()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${s}.`),ye(g.shape[3]===p.shape[2],()=>`Error in conv2d: depth of input (${g.shape[3]}) must match input depth for filter ${p.shape[2]}.`),ye(na(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),ye(i==="NHWC",()=>`Error in conv2d: got dataFormat of ${i} but only NHWC is currently supported.`);const x=Uk(g.shape,p.shape,n,a,s,o);let v;u!=null&&(v=he(u,"bias","fused conv2d"),[v]=Ar(v,f),Tr(x.outShape,v.shape));let S;c!=null&&(S=he(c,"prelu weights","fused conv2d"));const w=(D,I)=>{const[k,A,N,F]=I,$=gA(D,N,l);ye(yh(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const O=jk(A.shape,$,k,n,s),M=mA(A,$,k.shape,n,s),B=[O,M];if(F!=null){const U=yA(F,$);B.push(U)}return B},E={x:g,filter:p,bias:v,preluActivationWeights:S},_={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o,activation:l,leakyreluAlpha:h};return u==null?Pl((I,k,A)=>{let N=Fe.runKernel(eL,E,_);return A([k,I,N]),y&&(N=He(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:w}})(g,p):Pl((I,k,A,N)=>{let F=Fe.runKernel(eL,E,_);return N([k,I,F,A]),y&&(F=He(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:w}})(g,p,v)}const ROe=Ie({fusedConv2d_:FOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OOe(r,t,n,s,i,a=[1,1],o){let u=r;r.rank===3&&(u=He(r,[1,r.shape[0],r.shape[1],r.shape[2]]));let l=t;l.rank===3&&(l=He(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:u,dy:l},h={strides:s,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return Fe.runKernel(NIe,c,h)}const Iq=Ie({depthwiseConv2dNativeBackpropFilter_:OOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MOe(r,t,n,s,i,a=[1,1],o){let u=t,l=!1;t.rank===3&&(l=!0,u=He(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:u,filter:n},h={strides:s,pad:i,dimRoundingMode:o,dilations:a,inputShape:r},f=Fe.runKernel(kIe,c,h);return l?He(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const $q=Ie({depthwiseConv2dNativeBackpropInput_:MOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LOe({x:r,filter:t,strides:n,pad:s,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:u,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:h}){if(bA(Fe.state.gradientDepth,l)===!1){let D=t1(r,t,n,s,i,a,o);return u!=null&&(D=ms(D,u)),xA(D,l,c,h)}const f=he(r,"x","depthwiseConv2d"),p=he(t,"filter","depthwiseConv2d");let g=f,y=!1;f.rank===3&&(y=!0,g=He(f,[1,f.shape[0],f.shape[1],f.shape[2]])),ye(g.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${g.rank}.`),ye(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),ye(g.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${g.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),a==null&&(a=[1,1]),ye(na(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),o!=null&&ye(Rs(s),()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${o} but got pad ${s}.`);const x=Uk(g.shape,p.shape,n,a,s,o,!0);let v;u!=null&&(v=he(u,"bias","fused conv2d"),[v]=Ar(v,f),Tr(x.outShape,v.shape));let S;c!=null&&(S=he(c,"prelu weights","fused depthwiseConv2d"));const w=(D,I)=>{ye(yh(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[k,A,N,F]=I,$=gA(D,N,l),O=$q(A.shape,$,k,n,s,a,o),M=Iq(A,$,k.shape,n,s,a,o);if(F!=null){const B=yA(v,$);return[O,M,B]}return[O,M]},E={x:g,filter:p,bias:v,preluActivationWeights:S},_={strides:n,pad:s,dataFormat:i,dilations:a,dimRoundingMode:o,activation:l,leakyreluAlpha:h};return u==null?Pl((I,k,A)=>{let N=Fe.runKernel(tL,E,_);return A([k,I,N]),y&&(N=He(N,[N.shape[1],N.shape[2],N.shape[3]])),{value:N,gradFunc:w}})(g,p):Pl((I,k,A,N)=>{let F=Fe.runKernel(tL,E,_);return N([k,I,F,A]),y&&(F=He(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:w}})(g,p,v)}const BOe=Ie({fusedDepthwiseConv2d_:LOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe({a:r,b:t,transposeA:n=!1,transposeB:s=!1,bias:i,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:u}){if(bA(Fe.state.gradientDepth,a)===!1){let F=kr(r,t,n,s);return i!=null&&(F=ms(F,i)),xA(F,a,o,u)}let l=he(r,"a","fused matMul"),c=he(t,"b","fused matMul");[l,c]=Ar(l,c);const h=n?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],g=s?c.shape[c.rank-2]:c.shape[c.rank-1],y=l.shape.slice(0,-2),x=c.shape.slice(0,-2),v=Ai(y),S=Ai(x);ye(l.rank>=2&&c.rank>=2&&l.rank===c.rank,()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${l.rank} and ${c.rank}.`),ye(dh(y,x),()=>`Error in fused matMul: outer dimensions (${y}) and (${x}) of Tensors with shapes ${l.shape} and ${c.shape} must match.`),ye(h===f,()=>`Error in fused matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=l.shape.slice(0,-2).concat([p,g]),E=n?He(l,[v,h,p]):He(l,[v,p,h]),_=s?He(c,[S,g,f]):He(c,[S,f,g]);let D;i!=null&&(D=he(i,"bias","fused matMul"),[D]=Ar(D,l),Tr(w,D.shape));let I;o!=null&&(I=he(o,"prelu weights","fused matMul"));const k=(F,$)=>{const[O,M,B,U]=$,V=gA(He(F,B.shape),B,a);let Z,J;if(!n&&!s?(Z=kr(V,M,!1,!0),J=kr(O,V,!0,!1)):!n&&s?(Z=kr(V,M,!1,!1),J=kr(V,O,!0,!1)):n&&!s?(Z=kr(M,V,!1,!0),J=kr(O,V,!1,!1)):(Z=kr(M,V,!0,!0),J=kr(V,O,!0,!0)),i!=null){const ne=yA(U,V);return[Z,J,ne]}else return[Z,J]},A={a:E,b:_,bias:D,preluActivationWeights:I},N={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:u};return i==null?Pl(($,O,M)=>{const B=Fe.runKernel(JM,A,N);return M([$,O,B]),{value:He(B,w),gradFunc:k}})(E,_):Pl(($,O,M,B)=>{const U=Fe.runKernel(JM,A,N);return B([$,O,U,M]),{value:He(U,w),gradFunc:k}})(E,_,D)}const VOe=Ie({fusedMatMul_:POe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zOe(r,t,n,s,i="bilinear",a=0){const o=he(r,"image","cropAndResize"),u=he(t,"boxes","cropAndResize","float32"),l=he(n,"boxInd","cropAndResize","int32"),c=u.shape[0];ye(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),ye(u.rank===2&&u.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${u.shape}.`),ye(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${u.shape}.`),ye(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),ye(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),ye(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const h={image:o,boxes:u,boxInd:l},f={method:i,extrapolationValue:a,cropSize:s};return Fe.runKernel(EIe,h,f)}const UOe=Ie({cropAndResize_:zOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOe(r){const t=he(r,"image","flipLeftRight","float32");ye(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return Fe.runKernel(MIe,n,{})}const jOe=Ie({flipLeftRight_:GOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WOe(r,t,n=0,s=.5){const i=he(r,"image","rotateWithOffset","float32");ye(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const a={image:i},o={radians:t,fillValue:n,center:s};return Fe.runKernel(p5e,a,o)}const HOe=Ie({rotateWithOffset_:WOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function op(r,t,n,s,i,a){s==null&&(s=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=r.shape[0];return n=Math.min(n,o),ye(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),ye(r.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${r.rank}'`),ye(r.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${r.shape[1]}`),ye(t.rank===1,()=>"scores must be a 1D tensor"),ye(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),ye(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:i,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qOe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY){const a=he(r,"boxes","nonMaxSuppression"),o=he(t,"scores","nonMaxSuppression"),u=op(a,o,n,s,i);n=u.maxOutputSize,s=u.iouThreshold,i=u.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:i};return Fe.runKernel(e5e,{boxes:a,scores:o},l)}const KOe=Ie({nonMaxSuppression_:qOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe(r,t,n){const s=YOe(r,t,n),i=s<0?-(s+1):s;r.splice(i,0,t)}function YOe(r,t,n){return QOe(r,t,n||ZOe)}function ZOe(r,t){return r>t?1:r<t?-1:0}function QOe(r,t,n){let s=0,i=r.length,a=0,o=!1;for(;s<i;){a=s+(i-s>>>1);const u=n(t,r[a]);u>0?s=a+1:(i=a,o=!u)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOe(r,t,n,s,i){return vA(r,t,n,s,i,0)}function eMe(r,t,n,s,i,a){return vA(r,t,n,s,i,0,!1,a,!0)}function tMe(r,t,n,s,i,a){return vA(r,t,n,s,i,a,!0)}function vA(r,t,n,s,i,a,o=!1,u=!1,l=!1){const c=[];for(let v=0;v<t.length;v++)t[v]>i&&c.push({score:t[v],boxIndex:v,suppressBeginIndex:0});c.sort(EL);const h=a>0?-.5/a:0,f=[],p=[];for(;f.length<n&&c.length>0;){const v=c.pop(),{score:S,boxIndex:w,suppressBeginIndex:E}=v;if(S<i)break;let _=!1;for(let D=f.length-1;D>=E;--D){const I=nMe(r,w,f[D]);if(I>=s){_=!0;break}if(v.score=v.score*rMe(s,h,I),v.score<=i)break}v.suppressBeginIndex=f.length,_||(v.score===S?(f.push(w),p.push(v.score)):v.score>i&&XOe(c,v,EL))}const g=f.length,y=n-g;u&&y>0&&(f.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const x={selectedIndices:f};return o&&(x.selectedScores=p),l&&(x.validOutputs=g),x}function nMe(r,t,n){const s=r.subarray(t*4,t*4+4),i=r.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),u=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),p=Math.max(i[1],i[3]),g=(u-a)*(l-o),y=(f-c)*(p-h);if(g<=0||y<=0)return 0;const x=Math.max(a,c),v=Math.max(o,h),S=Math.min(u,f),w=Math.min(l,p),E=Math.max(S-x,0)*Math.max(w-v,0);return E/(g+y-E)}function rMe(r,t,n){const s=Math.exp(t*n*n);return n<=r?s:0}function EL(r,t){return r.score-t.score||r.score===t.score&&t.boxIndex-r.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function sMe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY){const a=he(r,"boxes","nonMaxSuppressionAsync"),o=he(t,"scores","nonMaxSuppressionAsync"),u=op(a,o,n,s,i);n=u.maxOutputSize,s=u.iouThreshold,i=u.scoreThreshold;const l=await Promise.all([a.data(),o.data()]),c=l[0],h=l[1],{selectedIndices:f}=JOe(c,h,n,s,i);return a!==r&&a.dispose(),o!==t&&o.dispose(),ea(f,"int32")}const iMe=sMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=he(r,"boxes","nonMaxSuppression"),u=he(t,"scores","nonMaxSuppression"),l=op(o,u,n,s,i,a);n=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c={boxes:o,scores:u},h={maxOutputSize:n,iouThreshold:s,scoreThreshold:i,softNmsSigma:a},f=Fe.runKernel(n5e,c,h);return{selectedIndices:f[0],selectedScores:f[1]}}const oMe=Ie({nonMaxSuppressionWithScore_:aMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function uMe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=0){const o=he(r,"boxes","nonMaxSuppressionAsync"),u=he(t,"scores","nonMaxSuppressionAsync"),l=op(o,u,n,s,i,a);n=l.maxOutputSize,s=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const c=await Promise.all([o.data(),u.data()]),h=c[0],f=c[1],{selectedIndices:p,selectedScores:g}=tMe(h,f,n,s,i,a);return o!==r&&o.dispose(),u!==t&&u.dispose(),{selectedIndices:ea(p,"int32"),selectedScores:ea(g)}}const lMe=uMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cMe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=he(r,"boxes","nonMaxSuppression"),u=he(t,"scores","nonMaxSuppression"),l=op(o,u,n,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,p={boxes:o,scores:u},g={maxOutputSize:c,iouThreshold:h,scoreThreshold:f,padToMaxOutputSize:a},y=Fe.runKernel(t5e,p,g);return{selectedIndices:y[0],validOutputs:y[1]}}const hMe=Ie({nonMaxSuppressionPadded_:cMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fMe(r,t,n,s=.5,i=Number.NEGATIVE_INFINITY,a=!1){const o=he(r,"boxes","nonMaxSuppressionAsync"),u=he(t,"scores","nonMaxSuppressionAsync"),l=op(o,u,n,s,i,null),c=l.maxOutputSize,h=l.iouThreshold,f=l.scoreThreshold,[p,g]=await Promise.all([o.data(),u.data()]),{selectedIndices:y,validOutputs:x}=eMe(p,g,c,h,f,a);return o!==r&&o.dispose(),u!==t&&u.dispose(),{selectedIndices:ea(y,"int32"),validOutputs:ur(x,"int32")}}const dMe=fMe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMe(r,t,n=!1,s=!1){const i=he(r,"images","resizeBilinear");ye(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),ye(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),ye(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=i,o=!1;i.rank===3&&(o=!0,a=He(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={images:a},l={alignCorners:n,halfPixelCenters:s,size:t},c=Fe.runKernel(QW,u,l);return o?He(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Fq=Ie({resizeBilinear_:pMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(r,t,n=!1,s=!1){const i=he(r,"images","resizeNearestNeighbor");ye(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),ye(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),ye(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),ye(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=i,o=!1;i.rank===3&&(o=!0,a=He(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={images:a},l={alignCorners:n,halfPixelCenters:s,size:t},c=Fe.runKernel(ZW,u,l);return o?He(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Rq=Ie({resizeNearestNeighbor_:mMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xu={flipLeftRight:jOe,resizeNearestNeighbor:Rq,resizeBilinear:Fq,rotateWithOffset:HOe,cropAndResize:UOe,nonMaxSuppression:KOe,nonMaxSuppressionAsync:iMe,nonMaxSuppressionWithScore:oMe,nonMaxSuppressionWithScoreAsync:lMe,nonMaxSuppressionPadded:hMe,nonMaxSuppressionPaddedAsync:dMe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gMe=1.7580993408473768,yMe=1.0507009873554805;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oq={kernelName:Pj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,i1(zt(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xMe={kernelName:Vj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=gs(zt(n,"float32")),i=Tu(nr(ur(1),s));return Js(tr(r,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bMe={kernelName:zj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=Tu(nr(gs(zt(n,"float32")),1));return tr(r,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vMe={kernelName:Ok,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{let u=r;const l=xs(n.shape,i);return l.length>0&&(u=Cn(u,l)),He(u,n.shape)},b:()=>{let u=r;const l=xs(s.shape,i);return l.length>0&&(u=Cn(u,l)),He(u,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wMe={kernelName:Uj,saveAllInputs:!0,gradFunc:(r,t)=>{const n={};return t.forEach((s,i)=>{n[i]=()=>r.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SMe={kernelName:Gj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>vr(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CMe={kernelName:jj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>vr(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Me={kernelName:Wj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,Tu(nr(ur(1),gs(zt(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EMe={kernelName:Hj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=Tu(ms(ur(1),gs(zt(n,"float32"))));return tr(r,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DMe={kernelName:Xj,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{const u=ms(gs(n),gs(s));let l=xt(r,tr(s,u));const c=xs(n.shape,i);return c.length>0&&(l=Cn(l,c)),He(l,n.shape)},b:()=>{const u=ms(gs(n),gs(s));let l=Js(xt(r,tr(n,u)));const c=xs(s.shape,i);return c.length>0&&(l=Cn(l,c)),He(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TMe={kernelName:qj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,ms(gs(zt(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NMe={kernelName:Kj,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,nr(ur(1),gs(zt(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kMe(r,t,n,s,i=[1,1,1],a,o){const u=he(r,"dy","avgPool3dGrad"),l=he(t,"input","avgPool3dGrad");let c=u,h=l,f=!1;l.rank===4&&(f=!0,c=He(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=He(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),ye(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),ye(h.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),ye(na(s,i),()=>`Error in avgPool3dGrad: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`),o!=null&&ye(Rs(a),()=>`Error in avgPool3dGrad: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`);const p={dy:c,input:h},g={filterSize:n,strides:s,dilations:i,pad:a,dimRoundingMode:o},y=Fe.runKernel(xIe,p,g);return f?He(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const AMe=Ie({avgPool3dGrad_:kMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IMe={kernelName:Zj,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{filterSize:i,strides:a,dilations:o,pad:u,dimRoundingMode:l}=n,c=o??[1,1,1];return{x:()=>AMe(r,s,i,a,c,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(r,t,n,s,i){const a=he(r,"dy","avgPoolGrad"),o=he(t,"input","avgPoolGrad");ye(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let u=o,l=a,c=!1;o.rank===3&&(c=!0,u=He(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=He(a,[1,a.shape[0],a.shape[1],a.shape[2]])),ye(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),ye(u.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${u.rank}.`);const h={dy:l,input:u},f={filterSize:n,strides:s,pad:i},p=Fe.runKernel(yIe,h,f);return c?He(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const FMe=Ie({avgPoolGrad_:$Me});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RMe={kernelName:Yj,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{filterSize:i,strides:a,pad:o}=n;return{x:()=>FMe(r,s,i,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OMe={kernelName:Qj,inputsToSave:["a","b"],gradFunc:(r,t,n)=>{const[s,i]=t,{transposeA:a,transposeB:o}=n;return!a&&!o?{a:()=>kr(r,i,!1,!0),b:()=>kr(s,r,!0,!1)}:!a&&o?{a:()=>kr(r,i,!1,!1),b:()=>kr(r,s,!0,!1)}:a&&!o?{a:()=>kr(i,r,!1,!0),b:()=>kr(s,r,!1,!1)}:{a:()=>kr(i,r,!0,!0),b:()=>kr(r,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MMe={kernelName:Jj,gradFunc:(r,t,n)=>{const{blockShape:s,crops:i}=n;return{x:()=>nw(r,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMe={kernelName:vIe,gradFunc:(r,t,n)=>{const s=n,i=s.inputShape,a=s.shape,o=Array.from(a);for(let l=i.length-1;l>=0;l--)if(i[l]===a[l])o[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const u=[];for(let l=0;l<o.length;l++)o[l]>1&&u.push(l);return{x:()=>Cn(r,u,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BMe={kernelName:Mk,gradFunc:r=>({x:()=>r.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PMe={kernelName:eW,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VMe={kernelName:tW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>Lo($d(sp(s,i),ip(s,a)),r,vr(r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zMe={kernelName:nW,inputsToSave:["x"],gradFunc:Oq.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UMe={kernelName:rW,saveAllInputs:!0,gradFunc:(r,t,n)=>{const s=t.map(l=>l.shape),{axis:i}=n,a=Uo(i,t[0].shape)[0],o=s.map(l=>l[a]);return Sg(r,o,a).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GMe={kernelName:sW,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,{dilations:a,strides:o,pad:u,dataFormat:l}=n;return ye(yh(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>jk(s.shape,r,i,o,u,l),filter:()=>mA(s,r,i.shape,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jMe={kernelName:iW,inputsToSave:["dy","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,{strides:a,pad:o,dataFormat:u,dimRoundingMode:l}=n;return{dy:()=>rp(r,i,a,o,u,1,l),filter:()=>mA(r,s,i.shape,a,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMe(r,t,n,s,i){let a=r;r.rank===4&&(a=He(r,[1,r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));let o=t;o.rank===4&&(o=He(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),ye(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),ye(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),ye(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),ye(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),ye(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const u={x:a,dy:o},l={strides:s,pad:i,filterShape:n};return Fe.runKernel(CIe,u,l)}const HMe=Ie({conv3DBackpropFilter_:WMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qMe={kernelName:aW,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:s,strides:i,pad:a}=n;ye(yh(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,u]=t;return{x:()=>g4e(o.shape,r,u,i,a),filter:()=>HMe(o,r,u.shape,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KMe={kernelName:oW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(Js(hA(zt(n,"float32"))),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XMe={kernelName:uW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(fA(zt(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YMe={kernelName:lW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{const u=dFe([i],s.rank);let l=Hk(r,i,a,!o);return u!=null&&(l=Id(l,u)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZMe={kernelName:cW,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const{dilations:s,strides:i,pad:a,dimRoundingMode:o}=n,u=s??[1,1];ye(yh(u),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${u}'`);const[l,c]=t;return ye(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),ye(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),ye(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),ye(na(i,u),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${u}'.`),o!=null&&ye(Rs(a),()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`),{x:()=>$q(l.shape,r,c,i,a,s,o),filter:()=>Iq(l,r,c.shape,i,a,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QMe={kernelName:hW,inputsToSave:["x","filter"],gradFunc:(r,t,n)=>{const[s,i]=t,a={x:s,filter:i,dy:r},o={x:s,filter:i,dy:r};return{x:()=>Fe.runKernel(AIe,a,n),filter:()=>Fe.runKernel(IIe,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JMe={kernelName:dW,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t,s={dy:r,y:n};return{x:()=>Fe.runKernel($Ie,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eLe={kernelName:pW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,s=xt(Du(Js(gs(n))),2/Math.sqrt(Math.PI));return{x:()=>xt(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tLe={kernelName:mW,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nLe={kernelName:gW,inputsToSave:["input"],gradFunc:(r,t)=>{const[n]=t;return{input:()=>He(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rLe={kernelName:yW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,Du(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sLe={kernelName:xW,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iLe={kernelName:bW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{const u=tr(r,zt(s,"float32")),l=xs(n.shape,i);return l.length>0?He(Cn(u,l),n.shape):u},b:()=>{let u=xt(r,zt(n,"float32"));const l=xs(s.shape,i);l.length>0&&(u=He(Cn(u,l),s.shape));const c=gs(s);return Js(tr(u,zt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aLe={kernelName:vW,inputsToSave:["x","mean","variance","scale"],gradFunc:(r,t,n)=>{const{varianceEpsilon:s}=n,[i,a,o,u]=t,l=u??ur(1),c=xs(a.shape,i.shape),h=[];if(a.rank===1){for(let _=0;_<i.shape.length-1;++_)h.push(i.shape[_]);h.push(1)}const f=nr(i,a),p=xt(r,l),g=cA(ms(o,ur(s))),y=xt(xt(xt(g,g),g),ur(-.5));return{x:()=>a.rank===1?He(xt(xt(r,Xk(He(g,[1,1,1,a.shape[0]]),h)),l),i.shape):He(xt(xt(r,g),l),i.shape),mean:()=>{let _=xt(xt(g,ur(-1)),p);return a.rank===1&&(_=Cn(_,c)),He(_,a.shape)},variance:()=>{let _=xt(xt(y,f),p);return a.rank===1&&(_=Cn(_,c)),He(_,a.shape)},scale:()=>{const _=xt(f,g);let D=xt(r,_);return a.rank===1&&(D=Cn(D,c)),He(D,a.shape)},offset:()=>{let _=r;return a.rank===1&&(_=Cn(_,c)),He(_,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oLe={kernelName:wW,inputsToSave:["x","indices"],gradFunc:(r,t,n)=>{const[s,i]=t,{axis:a}=n,o=Uo(a,s.shape)[0];return{x:()=>{const l=s.shape,c=i.size,h=l.slice(0,o),f=h.length,p=l.slice(a,l.length).slice(1),g=p.length,y=DL(0,f),x=DL(f+1,f+1+g),v=TL([h,[c],p]),S=He(r,v),w=He(i,[c]),E=TL([[f],y,x]),_=Id(S,E);let D=Nq(_,w,s.shape[o]);const I=dq(E);return D=Id(D,I),D},indices:()=>i}}};function DL(r,t){const n=[];for(let s=r;s<t;++s)n.push(s);return n}function TL(r){const t=[];for(let n=0;n<r.length;++n)for(let s=0;s<r[n].length;++s)t.push(r[n][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uLe={kernelName:SW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>vr(n),b:()=>vr(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lLe={kernelName:CW,gradFunc:r=>({x:()=>zt(r,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cLe={kernelName:_W,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hLe={kernelName:EW,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fLe={kernelName:DW,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dLe={kernelName:TW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{alpha:i}=n,a=Yl(s,0);return{x:()=>Lo(a,r,xt(r,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pLe={kernelName:kW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,ms(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mLe={kernelName:NW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,zt(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gLe={kernelName:qIe,inputsToSave:[],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s]=t,{axis:i}=n;return{logits:()=>{const o=Du(s);return nr(r,xt(Cn(r,i,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yLe(r,t,n,s=5,i=1,a=1,o=.5){const u={x:r,y:t,dy:n},l={depthRadius:s,bias:i,alpha:a,beta:o};return Fe.runKernel(KIe,u,l)}const xLe=Ie({localResponseNormalizationBackprop_:yLe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bLe={kernelName:AW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{depthRadius:a,bias:o,alpha:u,beta:l}=n;return{x:()=>xLe(s,i,r,a,o,u,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(r,t,n,s){return t.rank<n.rank&&(t=He(t,Tb(t.shape,s))),r.rank<n.rank&&(r=He(r,Tb(r.shape,s))),{x:()=>xt(r,zt(n1(n,t),r.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NL={kernelName:IW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const s=n,{reductionIndices:i}=s,a=t[0],o=t[1],u=Uo(i,a.shape),l=Mq(r,o,a,u);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vLe={kernelName:$W,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>xt(r,zt(sp(n,s),"float32")),b:()=>xt(r,zt(J2(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wLe(r,t,n,s,i,a=[1,1,1],o,u){const l=he(r,"dy","maxPool3dGrad"),c=he(t,"input","maxPool3dGrad"),h=he(n,"output","maxPool3dGrad");let f=l,p=c,g=h,y=!1;c.rank===4&&(y=!0,f=He(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=He(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),g=He(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),ye(f.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${f.rank}.`),ye(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),ye(g.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${g.rank}.`),ye(na(i,a),()=>`Error in maxPool3dGrad: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`),u!=null&&ye(Rs(o),()=>`Error in maxPool3dGrad: pad must be an integer when using, dimRoundingMode ${u} but got pad ${o}.`);const x={dy:f,input:p,output:g},v={filterSize:s,strides:i,dilations:a,pad:o,dimRoundingMode:u},S=Fe.runKernel(YIe,x,v);return y?He(S,[S.shape[1],S.shape[2],S.shape[3],S.shape[4]]):S}const SLe=Ie({maxPool3dGrad_:wLe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CLe={kernelName:RW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{filterSize:a,strides:o,dilations:u,pad:l,dimRoundingMode:c}=n,h=u??[1,1,1];return{x:()=>SLe(r,s,i,a,o,h,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Le(r,t,n,s,i,a,o){const u=he(r,"dy","maxPoolGrad"),l=he(t,"input","maxPoolGrad"),c=he(n,"output","maxPoolGrad");ye(l.rank===u.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${u.rank})`),ye(u.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),ye(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),o!=null&&ye(Rs(a),()=>`Error in maxPoolGrad: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`);const h={dy:u,input:l,output:c},f={filterSize:s,strides:i,pad:a,dimRoundingMode:o};return Fe.runKernel(XIe,h,f)}const ELe=Ie({maxPoolGrad_:_Le});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DLe={kernelName:FW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s,i]=t,{filterSize:a,strides:o,pad:u}=n;return{x:()=>ELe(r,s,i,a,o,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TLe={kernelName:OW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{axis:i}=n,a=Uo(i,s.shape),u=fFe(s.shape,a)[1],l=Ai(u);return{x:()=>{const h=s.shape.slice();a.forEach(g=>{h[g]=1});const f=He(r,h);return tr(xt(f,s1(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NLe={kernelName:MW,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(r,t,n)=>{const s=n,{axis:i}=s,[a,o]=t,u=Uo(i,a.shape),l=Mq(r,o,a,u);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kLe={kernelName:LW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t;return{a:()=>xt(r,zt(ip(n,s),"float32")),b:()=>xt(r,zt(Yl(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ALe={kernelName:BW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const s=t[0],{paddings:i}=n,a=i.map(o=>o[0]);return{x:()=>Gr(r,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ILe={kernelName:PW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{const u=xs(n.shape,i);return u.length>0?He(Cn(r,u),n.shape):r},b:()=>{const u=xt(r,Js(Yk(tr(n,s)))),l=xs(s.shape,i);return l.length>0?He(Cn(u,l),s.shape):u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Le={kernelName:VW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{const u=xt(r,zt(s,"float32")),l=xs(n.shape,i);return l.length>0?He(Cn(u,l),n.shape):u},b:()=>{const u=xt(r,zt(n,"float32")),l=xs(s.shape,i);return l.length>0?He(Cn(u,l),s.shape):u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FLe={kernelName:zW,gradFunc:r=>({x:()=>Js(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RLe={kernelName:GW,inputsToSave:["indices"],gradFunc:(r,t)=>{const n=t[0];return{indices:()=>Fd(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OLe={kernelName:UW,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MLe={kernelName:jW,saveAllInputs:!0,gradFunc:(r,t,n)=>{const{axis:s}=n;return Fh(r,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kL={kernelName:WW,inputsToSave:["x"],gradFunc:(r,t,n)=>{const s=t[0],{paddings:i}=n,a=i.map(o=>o[0]);return{x:()=>Gr(r,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LLe={kernelName:HW,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(r,t)=>{const[n,s,i]=t,a=n,o=s,u=Tr(a.shape,o.shape);return{a:()=>{const h=zt(o,"float32");let f=xt(r,xt(h,ap(a,nr(h,ur(1)))));const p=xs(a.shape,u);return p.length>0&&(f=Cn(f,p)),He(f,a.shape)},b:()=>{const h=Yl(a,0),f=Lo(h,r1(a),vr(a));let p=xt(r,xt(i,f));const g=xs(o.shape,u);return g.length>0&&(p=Cn(p,g)),He(p,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BLe={kernelName:qW,inputsToSave:["x","alpha"],gradFunc:(r,t)=>{const[n,s]=t,i=Yl(n,0);return{x:()=>Lo(i,r,xt(r,s)),alpha:()=>{let a=Lo(i,vr(r),xt(r,n));const o=xs(s.shape,r.shape);return o.length>0&&(a=Cn(a,o)),He(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PLe={kernelName:fW,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{const u=tr(r,zt(s,"float32")),l=xs(n.shape,i);return l.length>0?He(Cn(u,l),n.shape):u},b:()=>{let u=xt(r,zt(n,"float32"));const l=xs(s.shape,i);l.length>0&&(u=He(Cn(u,l),s.shape));const c=gs(s);return Js(tr(u,zt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VLe={kernelName:KW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,Js(gs(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zLe={kernelName:JW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t,s=xt(ip(n,6),i1(n));return{x:()=>xt(r,zt(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ULe={kernelName:XW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,zt(i1(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GLe={kernelName:YW,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>He(r,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jLe={kernelName:QW,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[s]=t,i={dy:r,images:s};return{images:()=>Fe.runKernel(o5e,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WLe={kernelName:ZW,inputsToSave:["images"],gradFunc:(r,t,n)=>{const[s]=t,i={dy:r,images:s};return{images:()=>Fe.runKernel(a5e,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HLe={kernelName:eH,gradFunc:(r,t,n)=>{const{dims:s}=n,i=Uo(s,r.shape);return{x:()=>Rd(r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qLe={kernelName:tH,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KLe={kernelName:nH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>Js(tr(r,xt(ap(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XLe={kernelName:rH,inputsToSave:["condition"],gradFunc:(r,t)=>{const[n]=t;return{condition:()=>zt(vr(n),"float32"),t:()=>xt(r,zt(n,r.dtype)),e:()=>xt(r,zt(ew(n),r.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YLe={kernelName:sH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>{const s=Yl(n,ur(0)),i=ur(gMe),a=ur(yMe),o=xt(r,a),u=xt(xt(r,i),Du(zt(n,"float32")));return Lo(s,o,u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZLe={kernelName:lH,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,xt(n,nr(ur(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QLe={kernelName:uH,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JLe={kernelName:aH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(Q2(zt(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e6e={kernelName:oH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(Wk(zt(n,"float32")),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t6e={kernelName:iH,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{begin:i,size:a}=n,o=s.shape,[u,l]=S$e(s,i,a),c=[];for(let h=0;h<r.rank;h++)c.push([u[h],o[h]-u[h]-l[h]]);return{x:()=>iA(r,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6e={kernelName:mH,outputsToSave:[!0],gradFunc:(r,t,n)=>{const[s]=t,{dim:i}=n,a=!0,o=xt(r,s);return{logits:()=>nr(o,xt(Cn(o,[i],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6e={kernelName:cH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,e1(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AL={kernelName:dH,gradFunc:(r,t,n)=>{const{blockShape:s,paddings:i}=n;return{x:()=>Z2(r,s,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IL={kernelName:pH,gradFunc:(r,t,n)=>{const{axis:s}=n;return{x:()=>Ji(r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6e={kernelName:hH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,xt(Tu(zt(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6e={kernelName:l5e,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(r,xt(zt(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6e={kernelName:gH,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=ur(2);return{a:()=>xt(r,xt(i,nr(n,s))),b:()=>xt(r,xt(i,nr(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6e={kernelName:_H,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u6e={kernelName:yH,inputsToSave:["a","b"],gradFunc:(r,t)=>{const[n,s]=t,i=Tr(n.shape,s.shape);return{a:()=>{let u=r;const l=xs(n.shape,i);return l.length>0&&(u=Cn(u,l)),He(u,n.shape)},b:()=>{let u=r;const l=xs(s.shape,i);return l.length>0&&(u=Cn(u,l)),He(Js(u),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l6e={kernelName:fH,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,i=s.shape.slice(),{axis:a}=n;Uo(a,s.shape).forEach(c=>{i[c]=1});const u=He(r,i),l=xt(u,s1(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6e={kernelName:xH,inputsToSave:["x"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>tr(r,gs(Q2(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h6e={kernelName:bH,outputsToSave:[!0],gradFunc:(r,t)=>{const[n]=t;return{x:()=>xt(nr(ur(1),gs(n)),r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f6e={kernelName:Lk,inputsToSave:["x"],gradFunc:(r,t,n)=>{const[s]=t,{reps:i}=n;return{x:()=>{let o=vr(s);if(s.rank===1)for(let u=0;u<i[0];++u)o=ms(o,Gr(r,[u*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)o=ms(o,Gr(r,[u*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)o=ms(o,Gr(r,[u*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let u=0;u<i[0];++u)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)for(let h=0;h<i[3];++h)o=ms(o,Gr(r,[u*s.shape[0],l*s.shape[1],c*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d6e={kernelName:vH,gradFunc:(r,t,n)=>{const s=n,{perm:i}=s,a=dq(i);return{x:()=>Id(r,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p6e={kernelName:wH,gradFunc:(r,t,n)=>{const s=n,{axis:i}=s;return{value:()=>xh(r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m6e={kernelName:SH,inputsToSave:["segmentIds"],gradFunc:(r,t)=>{const[n]=t;return{x:()=>g6e(r,n)}}};function g6e(r,t){const n=tw(t,vr(t)),s=Db(r,n);let i=sp(t,ur(0,"int32"));const a=s.rank-i.rank;for(let u=0;u<a;++u)i=Kk(i,u+1);i=$d(i,s1(s.shape,"bool"));const o=vr(s);return Lo(i,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y6e={kernelName:CH,gradFunc:r=>({x:()=>vr(r)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x6e=[Oq,xMe,bMe,vMe,wMe,SMe,CMe,_Me,EMe,DMe,TMe,NMe,IMe,RMe,OMe,MMe,LMe,BMe,PMe,VMe,zMe,UMe,jMe,GMe,qMe,KMe,XMe,YMe,ZMe,QMe,PLe,JMe,eLe,tLe,nLe,rLe,iLe,sLe,aLe,oLe,uLe,lLe,cLe,hLe,fLe,dLe,pLe,mLe,gLe,bLe,NL,NL,vLe,CLe,DLe,TLe,NLe,kLe,ALe,ILe,$Le,FLe,RLe,OLe,MLe,kL,kL,LLe,BLe,VLe,zLe,ULe,GLe,jLe,WLe,HLe,qLe,KLe,XLe,YLe,ZLe,QLe,JLe,e6e,t6e,n6e,r6e,AL,AL,IL,IL,s6e,a6e,i6e,o6e,u6e,l6e,c6e,h6e,f6e,d6e,p6e,m6e,y6e];for(const r of x6e)m5e(r);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.abs=function(){return this.throwIfDisposed(),go(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.acos=function(){return this.throwIfDisposed(),UH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.acosh=function(){return this.throwIfDisposed(),GH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.addStrict=function(r){return this.throwIfDisposed(),mOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.add=function(r){return this.throwIfDisposed(),ms(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.all=function(r,t){return this.throwIfDisposed(),jH(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.any=function(r,t){return this.throwIfDisposed(),WH(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.argMax=function(r){return this.throwIfDisposed(),HH(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.argMin=function(r){return this.throwIfDisposed(),qH(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.asScalar=function(){return this.throwIfDisposed(),ye(this.size===1,()=>"The array must have only 1 element."),He(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.asType=function(r){return this.throwIfDisposed(),zt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.as1D=function(){return this.throwIfDisposed(),He(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.as2D=function(r,t){return this.throwIfDisposed(),He(this,[r,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.as3D=function(r,t,n){return this.throwIfDisposed(),He(this,[r,t,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.as4D=function(r,t,n,s){return this.throwIfDisposed(),He(this,[r,t,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.as5D=function(r,t,n,s,i){return this.throwIfDisposed(),He(this,[r,t,n,s,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.asin=function(){return this.throwIfDisposed(),KH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.asinh=function(){return this.throwIfDisposed(),XH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.atan=function(){return this.throwIfDisposed(),YH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.atan2=function(r){return this.throwIfDisposed(),ZH(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.atanh=function(){return this.throwIfDisposed(),QH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.avgPool=function(r,t,n,s){return this.throwIfDisposed(),Gk(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.batchToSpaceND=function(r,t){return this.throwIfDisposed(),Z2(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.batchNorm=function(r,t,n,s,i){return this.throwIfDisposed(),_D(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.broadcastTo=function(r){return this.throwIfDisposed(),Eb(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.cast=function(r){return this.throwIfDisposed(),zt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.ceil=function(){return this.throwIfDisposed(),eq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.clipByValue=function(r,t){return this.throwIfDisposed(),tq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.concat=function(r,t){return this.throwIfDisposed(),r instanceof Re&&(r=[r]),Ji([this,...r],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.conv1d=function(r,t,n,s,i,a){return this.throwIfDisposed(),rq(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.conv2dTranspose=function(r,t,n,s,i){return this.throwIfDisposed(),sq(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.conv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),rp(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.cos=function(){return this.throwIfDisposed(),Q2(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.cosh=function(){return this.throwIfDisposed(),Wk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.cumsum=function(r,t,n){return this.throwIfDisposed(),Hk(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.depthToSpace=function(r,t){return this.throwIfDisposed(),iq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.depthwiseConv2D=function(r,t,n,s,i,a){return Os("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),t1(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.depthwiseConv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),t1(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.dilation2d=function(r,t,n,s,i){return this.throwIfDisposed(),aq(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.divNoNan=function(r){return this.throwIfDisposed(),oq(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.divStrict=function(r){return this.throwIfDisposed(),gOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.div=function(r){return this.throwIfDisposed(),tr(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.dot=function(r){return this.throwIfDisposed(),A4e(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.elu=function(){return this.throwIfDisposed(),qk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.equalStrict=function(r){return this.throwIfDisposed(),eOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.equal=function(r){return this.throwIfDisposed(),n1(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.erf=function(){return this.throwIfDisposed(),uq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.exp=function(){return this.throwIfDisposed(),Du(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.expandDims=function(r){return this.throwIfDisposed(),Kk(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.expm1=function(){return this.throwIfDisposed(),lq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.fft=function(){return this.throwIfDisposed(),dA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.flatten=function(){return this.throwIfDisposed(),He(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.floor=function(){return this.throwIfDisposed(),Yk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.floorDiv=function(r){return this.throwIfDisposed(),zk(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.gather=function(r,t){return this.throwIfDisposed(),Db(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.greaterEqualStrict=function(r){return this.throwIfDisposed(),tOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.greaterEqual=function(r){return this.throwIfDisposed(),sp(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.greaterStrict=function(r){return this.throwIfDisposed(),nOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.greater=function(r){return this.throwIfDisposed(),Yl(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.ifft=function(){return this.throwIfDisposed(),Ab(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.irfft=function(){return this.throwIfDisposed(),Cq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.isFinite=function(){return this.throwIfDisposed(),j4e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.isInf=function(){return this.throwIfDisposed(),H4e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.isNaN=function(){return this.throwIfDisposed(),K4e(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.leakyRelu=function(r){return this.throwIfDisposed(),Qk(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.lessEqualStrict=function(r){return this.throwIfDisposed(),rOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.lessEqual=function(r){return this.throwIfDisposed(),ip(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.lessStrict=function(r){return this.throwIfDisposed(),sOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.less=function(r){return this.throwIfDisposed(),J2(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.localResponseNormalization=function(r,t,n,s){return this.throwIfDisposed(),cq(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logSigmoid=function(){return this.throwIfDisposed(),iFe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logSoftmax=function(r){return this.throwIfDisposed(),fq(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logSumExp=function(r,t){return this.throwIfDisposed(),mFe(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.log=function(){return this.throwIfDisposed(),r1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.log1p=function(){return this.throwIfDisposed(),hq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logicalAnd=function(r){return this.throwIfDisposed(),$d(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logicalNot=function(){return this.throwIfDisposed(),ew(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logicalOr=function(r){return this.throwIfDisposed(),eA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.logicalXor=function(r){return this.throwIfDisposed(),vFe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.matMul=function(r,t,n){return this.throwIfDisposed(),kr(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.maxPool=function(r,t,n,s){return this.throwIfDisposed(),tA(this,r,t,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.max=function(r,t){return this.throwIfDisposed(),zc(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.maximumStrict=function(r){return this.throwIfDisposed(),yOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.maximum=function(r){return this.throwIfDisposed(),tw(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.mean=function(r,t){return this.throwIfDisposed(),pq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.min=function(r,t){return this.throwIfDisposed(),Nb(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.minimumStrict=function(r){return this.throwIfDisposed(),xOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.minimum=function(r){return this.throwIfDisposed(),nA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.mirrorPad=function(r,t){return this.throwIfDisposed(),mq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.modStrict=function(r){return this.throwIfDisposed(),bOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.mod=function(r){return this.throwIfDisposed(),rA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.mulStrict=function(r){return this.throwIfDisposed(),vOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.mul=function(r){return this.throwIfDisposed(),xt(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.neg=function(){return this.throwIfDisposed(),Js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.norm=function(r,t,n){return this.throwIfDisposed(),EOe(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.notEqualStrict=function(r){return this.throwIfDisposed(),iOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.notEqual=function(r){return this.throwIfDisposed(),sA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.oneHot=function(r,t=1,n=0){return this.throwIfDisposed(),VH(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.onesLike=function(){return this.throwIfDisposed(),gq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.pad=function(r,t){return this.throwIfDisposed(),iA(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.pool=function(r,t,n,s,i){return this.throwIfDisposed(),UFe(this,r,t,n,s,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.powStrict=function(r){return this.throwIfDisposed(),wOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.pow=function(r){return this.throwIfDisposed(),ap(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.prelu=function(r){return this.throwIfDisposed(),aA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.prod=function(r,t){return this.throwIfDisposed(),oA(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.reciprocal=function(){return this.throwIfDisposed(),xq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.relu=function(){return this.throwIfDisposed(),uA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.relu6=function(){return this.throwIfDisposed(),lA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.reshapeAs=function(r){return this.throwIfDisposed(),He(this,r.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.reshape=function(r){return this.throwIfDisposed(),He(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.resizeBilinear=function(r,t,n){return this.throwIfDisposed(),Fq(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.resizeNearestNeighbor=function(r,t,n){return this.throwIfDisposed(),Rq(this,r,t,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.reverse=function(r){return this.throwIfDisposed(),Rd(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.rfft=function(){return this.throwIfDisposed(),_q(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.round=function(){return this.throwIfDisposed(),bq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.rsqrt=function(){return this.throwIfDisposed(),cA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.selu=function(){return this.throwIfDisposed(),vq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.separableConv2d=function(r,t,n,s,i,a){return this.throwIfDisposed(),vRe(this,r,t,n,s,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sigmoid=function(){return this.throwIfDisposed(),e1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sign=function(){return this.throwIfDisposed(),wq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sin=function(){return this.throwIfDisposed(),hA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sinh=function(){return this.throwIfDisposed(),fA(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.slice=function(r,t){return this.throwIfDisposed(),Gr(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.softmax=function(r){return this.throwIfDisposed(),Sq(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.softplus=function(){return this.throwIfDisposed(),Jk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.spaceToBatchND=function(r,t){return this.throwIfDisposed(),nw(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.split=function(r,t){return this.throwIfDisposed(),Sg(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sqrt=function(){return this.throwIfDisposed(),Tu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.square=function(){return this.throwIfDisposed(),gs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.squaredDifference=function(r){return this.throwIfDisposed(),pA(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.squaredDifferenceStrict=function(r){return this.throwIfDisposed(),SOe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.squeeze=function(r){return this.throwIfDisposed(),Ib(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.stack=function(r,t){this.throwIfDisposed();const n=r instanceof Re?[this,r]:[this,...r];return xh(n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.step=function(r){return this.throwIfDisposed(),i1(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.stridedSlice=function(r,t,n,s,i,a,o,u){return this.throwIfDisposed(),Eq(this,r,t,n,s,i,a,o,u)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.subStrict=function(r){return this.throwIfDisposed(),COe(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sub=function(r){return this.throwIfDisposed(),nr(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.sum=function(r,t){return this.throwIfDisposed(),Cn(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.tan=function(){return this.throwIfDisposed(),Dq(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.tanh=function(){return this.throwIfDisposed(),JH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.tile=function(r){return this.throwIfDisposed(),Xk(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.toBool=function(){return this.throwIfDisposed(),zt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.toFloat=function(){return this.throwIfDisposed(),zt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.toInt=function(){return this.throwIfDisposed(),zt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.topk=function(r,t){return this.throwIfDisposed(),Tq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.transpose=function(r){return this.throwIfDisposed(),Id(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.unique=function(r){return this.throwIfDisposed(),DD(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.unsortedSegmentSum=function(r,t){return this.throwIfDisposed(),Nq(this,r,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.unstack=function(r){return this.throwIfDisposed(),Fh(this,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.where=function(r,t){return this.throwIfDisposed(),Lo(r,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Re.prototype.zerosLike=function(){return this.throwIfDisposed(),vr(this)};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ja;(function(r){r[r.DT_INVALID=0]="DT_INVALID",r[r.DT_FLOAT=1]="DT_FLOAT",r[r.DT_DOUBLE=2]="DT_DOUBLE",r[r.DT_INT32=3]="DT_INT32",r[r.DT_UINT8=4]="DT_UINT8",r[r.DT_INT16=5]="DT_INT16",r[r.DT_INT8=6]="DT_INT8",r[r.DT_STRING=7]="DT_STRING",r[r.DT_COMPLEX64=8]="DT_COMPLEX64",r[r.DT_INT64=9]="DT_INT64",r[r.DT_BOOL=10]="DT_BOOL",r[r.DT_QINT8=11]="DT_QINT8",r[r.DT_QUINT8=12]="DT_QUINT8",r[r.DT_QINT32=13]="DT_QINT32",r[r.DT_BFLOAT16=14]="DT_BFLOAT16",r[r.DT_FLOAT_REF=101]="DT_FLOAT_REF",r[r.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",r[r.DT_INT32_REF=103]="DT_INT32_REF",r[r.DT_UINT8_REF=104]="DT_UINT8_REF",r[r.DT_INT16_REF=105]="DT_INT16_REF",r[r.DT_INT8_REF=106]="DT_INT8_REF",r[r.DT_STRING_REF=107]="DT_STRING_REF",r[r.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",r[r.DT_INT64_REF=109]="DT_INT64_REF",r[r.DT_BOOL_REF=110]="DT_BOOL_REF",r[r.DT_QINT8_REF=111]="DT_QINT8_REF",r[r.DT_QUINT8_REF=112]="DT_QUINT8_REF",r[r.DT_QINT32_REF=113]="DT_QINT32_REF",r[r.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"})(ja||(ja={}));var $L;(function(r){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(r.CheckpointFormatVersion||(r.CheckpointFormatVersion={}))})($L||($L={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b6e={};function Lq(r){return b6e[r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G(r,t,n,s,i){const a=t.inputParams[r];if(a&&a.inputIndexStart!==void 0){const u=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?u+1:a.inputIndexEnd;if(a.type==="tensor")return hi(t.inputNames[a.inputIndexStart],n,s,i);if(a.type==="tensors")return t.inputNames.slice(u,l).map(p=>hi(p,n,s,i));const c=hi(t.inputNames.slice(u)[0],n,s,i),h=c.dataSync();return a.type==="number"?h[0]:fD(c.shape,h)}const o=t.attrParams[r];return o&&o.value}function hi(r,t,n,s){const[i,a]=Di(r);if(s!=null){const u=s.getHashTableHandleByName(i);if(u!=null)return u}const o=n.currentContextIds.find(u=>!!t[$b(i,u)]);return o!==void 0?t[$b(i,o)][a]:void 0}function v6e(r,t,n){return t[$b(r,n.currentContextId)]}function lu(r,t){const[n,s]=Di(r);return[$b(n,t&&t.currentContextId),s]}function $b(r,t){return t?`${r}-${t}`:r}function Di(r){const t=r.split(":");return t.length===1?[r,0]:[t[0],Number(t[t.length-1])]}function Sx(r,t,n){let s=G("pad",r,t,n);if(s==="explicit"){s=G("explicitPaddings",r,t,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)i[a][0]=s[a*2],i[a][1]=s[a*2+1];return i}return s}function cu(r){return r.kept?r:Y2(r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w6e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],S6e=Object.freeze(Object.defineProperty({__proto__:null,json:w6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C6e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_6e=Object.freeze(Object.defineProperty({__proto__:null,json:C6e},Symbol.toStringTag,{value:"Module"})),E6e=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],D6e=Object.freeze(Object.defineProperty({__proto__:null,json:E6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],N6e=Object.freeze(Object.defineProperty({__proto__:null,json:T6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k6e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],A6e=Object.freeze(Object.defineProperty({__proto__:null,json:k6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],$6e=Object.freeze(Object.defineProperty({__proto__:null,json:I6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6e=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],R6e=Object.freeze(Object.defineProperty({__proto__:null,json:F6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O6e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],M6e=Object.freeze(Object.defineProperty({__proto__:null,json:O6e},Symbol.toStringTag,{value:"Module"})),L6e=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]}],B6e=Object.freeze(Object.defineProperty({__proto__:null,json:L6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],V6e=Object.freeze(Object.defineProperty({__proto__:null,json:P6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],U6e=Object.freeze(Object.defineProperty({__proto__:null,json:z6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G6e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],j6e=Object.freeze(Object.defineProperty({__proto__:null,json:G6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W6e=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],H6e=Object.freeze(Object.defineProperty({__proto__:null,json:W6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6e=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],K6e=Object.freeze(Object.defineProperty({__proto__:null,json:q6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X6e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Y6e=Object.freeze(Object.defineProperty({__proto__:null,json:X6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z6e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Q6e=Object.freeze(Object.defineProperty({__proto__:null,json:Z6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}],e8e=Object.freeze(Object.defineProperty({__proto__:null,json:J6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FL{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[S6e,_6e,D6e,N6e,A6e,$6e,R6e,U6e,V6e,M6e,j6e,H6e,K6e,Y6e,Q6e,e8e,B6e],n=[].concat(...t.map(s=>s.json));this.opMappers=n.reduce((s,i)=>(s[i.tfOpName]=i,s),{})}transformGraph(t,n={}){const s=t.node,i=[],a=[],o=[],u=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?i.push(x[v.name]):v.op==="Const"?a.push(x[v.name]):(v.input==null||v.input.length===0)&&o.push(x[v.name]),x),{});let l=[];const c=[];let h={},f={};n!=null&&(h=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));const p=Object.keys(u);p.forEach(x=>{const v=u[x];v.inputNames.forEach(S=>{const[w]=lu(S);v.inputs.push(u[w]),u[w].children.push(v)})}),Object.keys(f).length===0?p.forEach(x=>{const v=u[x];v.children.length===0&&c.push(v)}):Object.keys(f).forEach(x=>{const[v]=lu(x),S=u[v];S!=null&&(S.signatureKey=f[x],c.push(S))}),Object.keys(h).length>0?Object.keys(h).forEach(x=>{const[v]=lu(x),S=u[v];S&&(S.signatureKey=h[x],l.push(S))}):l=i;let g={};t.library!=null&&t.library.function!=null&&(g=t.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const y={nodes:u,inputs:l,outputs:c,weights:a,placeholders:i,signature:n,functions:g};return o.length>0&&(y.initNodes=o),y}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,s)=>(n[t[s].name]=s,n),{})}mapNode(t){const n=Lq(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(i=>i.startsWith("^")?i.substr(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((i,a)=>(i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((i,a)=>{const o=a.type;let u;switch(a.type){case"string":u=TD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=TD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":u=RD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=RD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":u=kD(t.attr,a.tfName,a.defaultValue||0),u===void 0&&a.tfDeprecatedName&&(u=kD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":u=FD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=FD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":u=ND(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=ND(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":u=MD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=MD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":u=$D(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=$D(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":u=OD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=OD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":u=AD(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=AD(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":u=ID(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=ID(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":u=RL(t.attr,a.tfName,a.defaultValue),u===void 0&&a.tfDeprecatedName&&(u=RL(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${t.op}`)}return i[a.name]={value:u,type:o},i},{})),s}mapFunction(t){const n=t.nodeDef,s=[],i=[];let a={};n!=null&&(a=n.reduce((f,p)=>(f[p.name]=this.mapNode(p),p.op==="Const"&&i.push(f[p.name]),f),{}));const o=[],u=[];t.signature.inputArg.forEach(f=>{const[p]=lu(f.name),g={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:wA(f.type),type:"dtype"}},children:[]};g.signatureKey=f.name,o.push(g),a[p]=g}),Object.keys(a).forEach(f=>{const p=a[f];p.inputNames.forEach(g=>{const[y]=lu(g);p.inputs.push(a[y]),a[y].children.push(p)})});const c=t.ret;t.signature.outputArg.forEach(f=>{const[p,g]=lu(c[f.name]),y=a[p];y!=null&&(y.defaultOutput=g,u.push(y))});const h=this.mapArgsToSignature(t);return{nodes:a,inputs:o,outputs:u,weights:i,placeholders:s,signature:h}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:t.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,t.ret),n),{})}}mapArgToTensorInfo(t,n){let s=t.name;return n!=null&&(s=n[s]),{name:s,dtype:t.type}}}function t8e(r){const t=yr().global;if(typeof t.atob<"u")return t.atob(r);if(typeof Buffer<"u")return new Buffer(r,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Bq(r,t){const n=Array.isArray(r)?String.fromCharCode.apply(null,r):t8e(r);return t?n:n.toLowerCase()}function TD(r,t,n,s=!1){const i=r[t];return i!=null?Bq(i.s,s):n}function ND(r,t,n){const s=r[t];return s?s.b:n}function kD(r,t,n){const s=r[t]||{},i=s.i!=null?s.i:s.f!=null?s.f:n;return typeof i=="number"?i:parseInt(i,10)}function wA(r){switch(typeof r=="string"&&(r=ja[r]),r){case ja.DT_FLOAT:return"float32";case ja.DT_INT32:case ja.DT_INT64:case ja.DT_INT8:case ja.DT_UINT8:return"int32";case ja.DT_BOOL:return"bool";case ja.DT_DOUBLE:return"float32";case ja.DT_STRING:return"string";default:return null}}function RL(r,t,n){const s=r[t];return s&&s.func?s.func.name:n}function AD(r,t,n){const s=r[t];return s&&s.type?wA(s.type):n}function ID(r,t,n){const s=r[t];return s&&s.list&&s.list.type?s.list.type.map(i=>wA(i)):n}function Pq(r){if(!r.unknownRank)return r.dim!=null?r.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function $D(r,t,n){const s=r[t];return s&&s.shape?Pq(s.shape):n}function FD(r,t,n){const s=r[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):n}function RD(r,t,n,s=!1){const i=r[t];return i&&i.list&&i.list.s?i.list.s.map(a=>Bq(a,s)):n}function OD(r,t,n){const s=r[t];return s&&s.list&&s.list.shape?s.list.shape.map(i=>Pq(i)):n}function MD(r,t,n){const s=r[t];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n8e{constructor(t,n,s){this.node=t,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(i=>this.getInput(i)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((i,a)=>(i[a]=this.getAttr(a),i),{}))}getInput(t){return hi(t,this.tensorMap,this.context)}getAttr(t,n){const s=this.node.rawAttrs[t];if(s.tensor!=null)return hi(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return kD(this.node.rawAttrs,t,n);if(s.s!=null)return TD(this.node.rawAttrs,t,n);if(s.b!=null)return ND(this.node.rawAttrs,t,n);if(s.shape!=null)return $D(this.node.rawAttrs,t,n);if(s.type!=null)return AD(this.node.rawAttrs,t,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return FD(this.node.rawAttrs,t,n);if(s.list.s!=null)return RD(this.node.rawAttrs,t,n);if(s.list.shape!=null)return OD(this.node.rawAttrs,t,n);if(s.list.b!=null)return MD(this.node.rawAttrs,t,n);if(s.list.type!=null)return ID(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r8e=(r,t,n)=>{switch(r.op){case"BiasAdd":case"AddV2":case"Add":return[ms(G("a",r,t,n),G("b",r,t,n))];case"AddN":return[$$e(G("tensors",r,t,n))];case"FloorMod":case"Mod":return[rA(G("a",r,t,n),G("b",r,t,n))];case"Mul":return[xt(G("a",r,t,n),G("b",r,t,n))];case"RealDiv":case"Div":return[tr(G("a",r,t,n),G("b",r,t,n))];case"DivNoNan":return[oq(G("a",r,t,n),G("b",r,t,n))];case"FloorDiv":return[zk(G("a",r,t,n),G("b",r,t,n))];case"Sub":return[nr(G("a",r,t,n),G("b",r,t,n))];case"Minimum":return[nA(G("a",r,t,n),G("b",r,t,n))];case"Maximum":return[tw(G("a",r,t,n),G("b",r,t,n))];case"Pow":return[ap(G("a",r,t,n),G("b",r,t,n))];case"SquaredDifference":return[pA(G("a",r,t,n),G("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8e=(r,t,n)=>{switch(r.op){case"Abs":case"ComplexAbs":return[go(G("x",r,t,n))];case"Acos":return[UH(G("x",r,t,n))];case"Acosh":return[GH(G("x",r,t,n))];case"Asin":return[KH(G("x",r,t,n))];case"Asinh":return[XH(G("x",r,t,n))];case"Atan":return[YH(G("x",r,t,n))];case"Atan2":return[ZH(G("x",r,t,n),G("y",r,t,n))];case"Atanh":return[QH(G("x",r,t,n))];case"Ceil":return[eq(G("x",r,t,n))];case"Complex":return[ph(G("real",r,t,n),G("imag",r,t,n))];case"Cos":return[Q2(G("x",r,t,n))];case"Cosh":return[Wk(G("x",r,t,n))];case"Elu":return[qk(G("x",r,t,n))];case"Erf":return[uq(G("x",r,t,n))];case"Exp":return[Du(G("x",r,t,n))];case"Expm1":return[lq(G("x",r,t,n))];case"Floor":return[Yk(G("x",r,t,n))];case"Log":return[r1(G("x",r,t,n))];case"Log1p":return[hq(G("x",r,t,n))];case"Imag":return[Zk(G("x",r,t,n))];case"Neg":return[Js(G("x",r,t,n))];case"Reciprocal":return[xq(G("x",r,t,n))];case"Real":return[kb(G("x",r,t,n))];case"Relu":return[uA(G("x",r,t,n))];case"Round":return[bq(G("x",r,t,n))];case"Selu":return[vq(G("x",r,t,n))];case"Sigmoid":return[e1(G("x",r,t,n))];case"Sin":return[hA(G("x",r,t,n))];case"Sign":return[wq(G("x",r,t,n))];case"Sinh":return[fA(G("x",r,t,n))];case"Softplus":return[Jk(G("x",r,t,n))];case"Sqrt":return[Tu(G("x",r,t,n))];case"Square":return[gs(G("x",r,t,n))];case"Tanh":return[JH(G("x",r,t,n))];case"Tan":return[Dq(G("x",r,t,n))];case"ClipByValue":return[tq(G("x",r,t,n),G("clipValueMin",r,t,n),G("clipValueMax",r,t,n))];case"Relu6":return[lA(G("x",r,t,n))];case"Rsqrt":return[cA(hi(r.inputNames[0],t,n))];case"Prod":return[oA(G("x",r,t,n),G("axes",r,t,n))];case"LeakyRelu":return[Qk(G("x",r,t,n),G("alpha",r,t,n))];case"Prelu":return[aA(G("x",r,t,n),G("alpha",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(r,t,n=""){ye(i8e(r,t),()=>n+` Shapes ${r} and ${t} must match`)}function i8e(r,t){if(r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(r[n]!==-1&&t[n]!==-1&&r[n]!==t[n])return!1;return!0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a8e{constructor(t,n,s,i,a,o,u){this.name=t,this.dtype=n,this.maxSize=s,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=o,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=ur(0),bl(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ba(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=n,bl(n),s.written=!0,this.tensors[t]=s}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((s,i)=>this.write(s,n[i]))}gather(t,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let i=0;i<this.size();i++)t.push(i)}if(t.length===0)return Vc([],[0].concat(this.elementShape));const s=this.readMany(t);return ba(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),xh(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return Vc([],[0].concat(this.elementShape));const n=[];for(let i=0;i<this.size();i++)n.push(i);const s=this.readMany(n);return ba(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Ji(s,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,Fh(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const i=t.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:n.size/s,o=[];Fn(()=>{n=He(n,[1,s,a]);for(let l=0;l<t.length;++l){const h=[0,l===0?0:i[l-1],0],f=[1,t[l],a];o[l]=He(Gr(n,h,f),this.elementShape)}return o});const u=[];for(let l=0;l<t.length;l++)u[l]=l;this.writeMany(u,o)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class up{constructor(t,n,s,i=-1){this.tensors=t,this.elementShape=n,this.elementDtype=s,t!=null&&t.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);ba(n,a.shape,"TensorList shape mismatch: "),bl(a)}),this.idTensor=ur(0),this.maxNumElements=i,bl(this.idTensor)}get id(){return this.idTensor.id}copy(){return new up([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);return ba(t,this.elementShape,"TensorList shape mismatch: "),Fn(()=>{const i=this.tensors.map(a=>He(a,t));return xh(i,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=this.tensors.pop();return ba(s.shape,t,"TensorList shape mismatch: "),He(s,t)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(ba(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");bl(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=t}getItem(t,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);return ba(this.tensors[t].shape,n,"TensorList shape mismatch: "),this.tensors[t]}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);ba(this.elementShape,n.shape,"TensorList shape mismatch: "),bl(n),this.tensors[t]=n}gather(t,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);return ba(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size()),t.length===0?Vc([],[0].concat(this.elementShape)):Fn(()=>{const i=t.map(a=>He(this.tensors[a],s));return xh(i,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);return ba(this.elementShape,n,"TensorList shape mismatch: "),this.size()===0?Vc([],[0].concat(this.elementShape)):Fn(()=>{const s=this.tensors.map(i=>He(i,n));return Ji(s,0)})}}function o8e(r,t,n){const s=r.dtype;if(r.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${r.shape}`);if(r.dtype!==n)throw new Error(`Invalid data types; op elements ${r.dtype}, but list elements ${n}`);const i=r.shape.slice(1);ba(i,t,"TensorList shape mismatch: ");const a=Fh(r);return new up(a,t,s)}function u8e(r,t,n){return new up([],r,t,n)}function l8e(r,t,n,s){if(t.length!==r.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${r.shape[0]}`);const i=Math.max(...t);if(s!=null&&s!==-1&&i>=s)throw new Error(`Max index must be < array size (${i}  vs. ${s})`);const a=new up([],n,r.dtype,s),o=Fh(r,0);return t.forEach((u,l)=>{a.setItem(u,o[l])}),a}function c8e(r,t,n){let s=0;const i=t.map(l=>(s+=l,s));if(s!==r.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${r.shape}`);const a=s===0?0:r.size/s,o=Fn(()=>{const l=[];r=He(r,[1,s,a]);for(let c=0;c<t.length;++c){const f=[0,c===0?0:i[c-1],0],p=[1,t[c],a];l[c]=He(Gr(r,f,p),n)}return r.dispose(),l}),u=new up([],n,r.dtype,t.length);for(let l=0;l<o.length;l++)u.setItem(l,o[l]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8e=async(r,t,n)=>{switch(r.op){case"If":case"StatelessIf":{const s=G("thenBranch",r,t,n),i=G("elseBranch",r,t,n),a=G("cond",r,t,n),o=G("args",r,t,n);return(await a.data())[0]?n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=G("body",r,t,n),i=G("cond",r,t,n),a=G("args",r,t,n),o=await n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),u=a.map(h=>h.id);let l=await o[0].data();o.forEach(h=>{!h.kept&&u.indexOf(h.id)===-1&&h.dispose()});let c=a;for(;l[0];){const h=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const f=c.map(g=>g.id);h.forEach(g=>{!g.kept&&u.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()});const p=await n.functionMap[i].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(g=>{!g.kept&&u.indexOf(g.id)===-1&&f.indexOf(g.id)===-1&&g.dispose()})}return c}case"LoopCond":{const s=G("pred",r,t,n);return[cu(s)]}case"Switch":{const s=G("pred",r,t,n);let i=G("data",r,t,n);return i.kept||(i=cu(i)),(await s.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const s=r.inputNames.find(i=>hi(i,t,n)!==void 0);if(s){const i=hi(s,t,n);return[cu(i)]}return}case"Enter":{const s=G("frameName",r,t,n),i=G("tensor",r,t,n);return n.enterFrame(s),[cu(i)]}case"Exit":{const s=G("tensor",r,t,n);return n.exitFrame(),[cu(s)]}case"NextIteration":{const s=G("tensor",r,t,n);return n.nextIteration(),[cu(s)]}case"TensorArrayV3":{const s=G("size",r,t,n),i=G("dtype",r,t,n),a=G("elementShape",r,t,n),o=G("dynamicSize",r,t,n),u=G("clearAfterRead",r,t,n),l=G("identicalElementShapes",r,t,n),c=G("name",r,t,n),h=new a8e(c,i,s,a,l,o,u);return n.addTensorArray(h),[h.idTensor,ur(1)]}case"TensorArrayWriteV3":{const s=G("tensorArrayId",r,t,n),i=G("index",r,t,n),a=G("tensor",r,t,n),o=n.getTensorArray(s.id);return o.write(i,a),[o.idTensor]}case"TensorArrayReadV3":{const s=G("tensorArrayId",r,t,n),i=G("index",r,t,n);return[n.getTensorArray(s.id).read(i)]}case"TensorArrayGatherV3":{const s=G("tensorArrayId",r,t,n),i=G("indices",r,t,n),a=G("dtype",r,t,n);return[n.getTensorArray(s.id).gather(i,a)]}case"TensorArrayScatterV3":{const s=G("tensorArrayId",r,t,n),i=G("indices",r,t,n),a=G("tensor",r,t,n),o=n.getTensorArray(s.id);return o.scatter(i,a),[o.idTensor]}case"TensorArrayConcatV3":{const s=G("tensorArrayId",r,t,n),i=n.getTensorArray(s.id),a=G("dtype",r,t,n);return[i.concat(a)]}case"TensorArraySplitV3":{const s=G("tensorArrayId",r,t,n),i=G("tensor",r,t,n),a=G("lengths",r,t,n),o=n.getTensorArray(s.id);return o.split(a,i),[o.idTensor]}case"TensorArraySizeV3":{const s=G("tensorArrayId",r,t,n),i=n.getTensorArray(s.id);return[ur(i.size(),"int32")]}case"TensorArrayCloseV3":{const s=G("tensorArrayId",r,t,n),i=n.getTensorArray(s.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const s=G("tensorListId",r,t,n),i=G("index",r,t,n),a=G("tensor",r,t,n),o=n.getTensorList(s.id);return o.setItem(i,a),[o.idTensor]}case"TensorListGetItem":{const s=G("tensorListId",r,t,n),i=G("index",r,t,n),a=G("elementShape",r,t,n),o=G("elementDType",r,t,n);return[n.getTensorList(s.id).getItem(i,a,o)]}case"TensorListScatterV2":case"TensorListScatter":{const s=G("indices",r,t,n),i=G("tensor",r,t,n),a=G("elementShape",r,t,n),o=G("numElements",r,t,n),u=l8e(i,s,a,o);return n.addTensorList(u),[u.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=G("elementShape",r,t,n),i=G("elementDType",r,t,n);let a;r.op==="TensorListReserve"?a="numElements":a="maxNumElements";const o=G(a,r,t,n),u=u8e(s,i,o);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const s=G("tensorListId",r,t,n),i=G("indices",r,t,n),a=G("elementShape",r,t,n),o=G("elementDType",r,t,n);return[n.getTensorList(s.id).gather(i,o,a)]}case"TensorListStack":{const s=G("tensorListId",r,t,n),i=G("elementShape",r,t,n),a=G("elementDType",r,t,n),o=G("numElements",r,t,n);return[n.getTensorList(s.id).stack(i,a,o)]}case"TensorListFromTensor":{const s=G("tensor",r,t,n),i=G("elementShape",r,t,n),a=G("elementDType",r,t,n),o=o8e(s,i,a);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":{const s=G("tensorListId",r,t,n),i=n.getTensorList(s.id),a=G("dtype",r,t,n),o=G("elementShape",r,t,n);return[i.concat(a,o)]}case"TensorListPushBack":{const s=G("tensorListId",r,t,n),i=G("tensor",r,t,n),a=n.getTensorList(s.id);return a.pushBack(i),[a.idTensor]}case"TensorListPopBack":{const s=G("tensorListId",r,t,n),i=G("elementShape",r,t,n),a=G("elementDType",r,t,n);return[n.getTensorList(s.id).popBack(i,a)]}case"TensorListSplit":{const s=G("tensor",r,t,n),i=G("elementShape",r,t,n),a=G("lengths",r,t,n),o=c8e(s,a,i);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OL(r,t,n){const[s,i]=G("fusedOps",r,t,n),a=s==="biasadd",o=i==="prelu",u=s==="fusedbatchnorm",l=G("numArgs",r,t,n);if(a){if(o&&l!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");const c=G("strides",r,t,n),h=Sx(r,t,n),f=G("dataFormat",r,t,n).toUpperCase(),p=G("dilations",r,t,n),[g,y]=G("args",r,t,n),x=G("leakyreluAlpha",r,t,n);return{stride:c,pad:h,dataFormat:f,dilations:p,biasArg:g,preluArg:y,activationFunc:i,leakyreluAlpha:x}}const f8e=(r,t,n)=>{switch(r.op){case"Conv1D":{const s=G("stride",r,t,n),i=G("pad",r,t,n),a=G("dataFormat",r,t,n).toUpperCase(),o=G("dilation",r,t,n);return[rq(G("x",r,t,n),G("filter",r,t,n),s,i,a,o)]}case"Conv2D":{const s=G("strides",r,t,n),i=Sx(r,t,n),a=G("dataFormat",r,t,n).toUpperCase(),o=G("dilations",r,t,n);return[rp(G("x",r,t,n),G("filter",r,t,n),[s[1],s[2]],i,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:s,pad:i,dataFormat:a,dilations:o,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:h}=OL(r,t,n);return[ROe({x:G("x",r,t,n),filter:G("filter",r,t,n),strides:[s[1],s[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:i,dataFormat:a,dilations:o,biasArg:u,preluArg:l,activationFunc:c,leakyreluAlpha:h}=OL(r,t,n);return[BOe({x:G("x",r,t,n),filter:G("filter",r,t,n),strides:[s[1],s[2]],pad:i,dataFormat:a,dilations:[o[1],o[2]],bias:u,activation:c,preluActivationWeights:l,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=G("outputShape",r,t,n),i=G("strides",r,t,n),a=Sx(r,t,n);return[sq(G("x",r,t,n),G("filter",r,t,n),s,[i[1],i[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=G("strides",r,t,n),i=Sx(r,t,n),a=G("dilations",r,t,n),o=G("dataFormat",r,t,n).toUpperCase();return[t1(G("input",r,t,n),G("filter",r,t,n),[s[1],s[2]],i,o,[a[1],a[2]])]}case"Conv3D":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("dataFormat",r,t,n).toUpperCase(),o=G("dilations",r,t,n);return[p4e(G("x",r,t,n),G("filter",r,t,n),[s[1],s[2],s[3]],i,a,[o[1],o[2],o[3]])]}case"AvgPool":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("kernelSize",r,t,n);return[Gk(G("x",r,t,n),[a[1],a[2]],[s[1],s[2]],i)]}case"MaxPool":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("kernelSize",r,t,n);return[tA(G("x",r,t,n),[a[1],a[2]],[s[1],s[2]],i)]}case"MaxPoolWithArgmax":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("kernelSize",r,t,n),o=G("includeBatchInIndex",r,t,n),{result:u,indexes:l}=EFe(G("x",r,t,n),[a[1],a[2]],[s[1],s[2]],i,o);return[u,l]}case"AvgPool3D":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("kernelSize",r,t,n);return[X$e(G("x",r,t,n),[a[1],a[2],a[3]],[s[1],s[2],s[3]],i)]}case"MaxPool3D":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("kernelSize",r,t,n);return[CFe(G("x",r,t,n),[a[1],a[2],a[3]],[s[1],s[2],s[3]],i)]}case"Dilation2D":{const s=G("strides",r,t,n),i=G("pad",r,t,n),a=G("dilations",r,t,n),o=s[1],u=s[2],l=a[1],c=a[2];return[aq(G("x",r,t,n),G("filter",r,t,n),[o,u],i,[l,c],"NHWC")]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d8e=(r,t,n)=>{switch(r.op){case"Fill":{const s=G("shape",r,t,n),i=G("dtype",r,t,n),a=G("value",r,t,n);return[L4e(s,a,i)]}case"LinSpace":{const s=G("start",r,t,n),i=G("stop",r,t,n),a=G("num",r,t,n);return[Q4e(s,i,a)]}case"Multinomial":{const s=G("logits",r,t,n),i=G("numSamples",r,t,n),a=G("seed",r,t,n);return[RFe(s,i,a)]}case"OneHot":{const s=G("indices",r,t,n),i=G("depth",r,t,n),a=G("onValue",r,t,n),o=G("offValue",r,t,n);return[VH(s,i,a,o)]}case"Ones":return[s1(G("shape",r,t,n),G("dtype",r,t,n))];case"OnesLike":return[gq(G("x",r,t,n))];case"RandomUniform":return[lRe(G("shape",r,t,n),G("minval",r,t,n),G("maxval",r,t,n),G("dtype",r,t,n))];case"Range":{const s=G("start",r,t,n),i=G("stop",r,t,n),a=G("step",r,t,n);return[cRe(s,i,a,G("dtype",r,t,n))]}case"TruncatedNormal":{const s=G("shape",r,t,n),i=G("mean",r,t,n),a=G("stdDev",r,t,n),o=G("seed",r,t,n);return[zRe(s,i,a,G("dtype",r,t,n),o)]}case"Zeros":return[Fd(G("shape",r,t,n),G("dtype",r,t,n))];case"ZerosLike":return[vr(G("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_(r,t,n){const s=G("boxes",r,t,n),i=G("scores",r,t,n),a=G("maxOutputSize",r,t,n),o=G("iouThreshold",r,t,n),u=G("scoreThreshold",r,t,n),l=G("softNmsSigma",r,t,n);return{boxes:s,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:u,softNmsSigma:l}}const p8e=async(r,t,n)=>{switch(r.op){case"NonMaxSuppressionV5":{const{boxes:s,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:u,softNmsSigma:l}=I_(r,t,n),c=await xu.nonMaxSuppressionWithScoreAsync(s,i,a,o,u,l);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:s,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:u}=I_(r,t,n),l=G("padToMaxOutputSize",r,t,n),c=await xu.nonMaxSuppressionPaddedAsync(s,i,a,o,u,l);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:s,scores:i,maxOutputSize:a,iouThreshold:o,scoreThreshold:u}=I_(r,t,n);return[await xu.nonMaxSuppressionAsync(s,i,a,o,u)]}case"Where":{const s=zt(G("condition",r,t,n),"bool"),i=[await qRe(s)];return s.dispose(),i}case"ListDiff":return SRe(G("x",r,t,n),G("y",r,t,n));default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8e=(r,t,n)=>{switch(r.op){case"TopKV2":{const s=G("x",r,t,n),i=G("k",r,t,n),a=G("sorted",r,t,n),o=Tq(s,i,a);return[o.values,o.indices]}case"Unique":{const s=G("x",r,t,n),i=DD(s);return[i.values,i.indices]}case"UniqueV2":{const s=G("x",r,t,n),i=G("axis",r,t,n),a=DD(s,i);return[a.values,a.indices]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g8e=(r,t,n)=>{switch(r.op){case"Const":return t[r.name];case"PlaceholderWithDefault":const s=G("default",r,t,n);return[hi(r.name,t,n)||s];case"Placeholder":return[hi(r.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=G("x",r,t,n);return[cu(c)]}case"IdentityN":return G("x",r,t,n).map(c=>cu(c));case"Snapshot":const i=G("x",r,t,n);return[cu(i)];case"Shape":return[ea(G("x",r,t,n).shape,"int32")];case"ShapeN":return G("x",r,t,n).map(c=>ea(c.shape));case"Size":return[ur(G("x",r,t,n).size,"int32")];case"Rank":return[ur(G("x",r,t,n).rank,"int32")];case"NoOp":return[ur(1)];case"Print":const a=G("x",r,t,n),o=G("data",r,t,n),u=G("message",r,t,n),l=G("summarize",r,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,l));return[a];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y8e{constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=ur(0),this.tensorMap=new Map,bl(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}async import(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),Fn(()=>{const i=Fh(n),a=s.length,o=i.length;ye(a===o,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${o} elements.`);for(let u=0;u<a;u++){const l=s[u],c=i[u];bl(c),this.tensorMap.set(l,c)}return this.handle})}async find(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return Fn(()=>{const i=[];for(let a=0;a<s.length;a++){const o=s[a],u=this.findWithDefault(o,n);i.push(u)}return xh(i)})}findWithDefault(t,n){const s=this.tensorMap.get(t);return s??n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8e=async(r,t,n,s)=>{switch(r.op){case"HashTable":case"HashTableV2":{const i=G("keyDType",r,t,n),a=G("valueDType",r,t,n),o=new y8e(i,a);return s.addHashTable(r.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const i=G("tableHandle",r,t,n,s),a=G("keys",r,t,n),o=G("values",r,t,n);return[await s.getHashTableById(i.id).import(a,o)]}case"LookupTableFind":case"LookupTableFindV2":{const i=G("tableHandle",r,t,n,s),a=G("keys",r,t,n),o=G("defaultValue",r,t,n);return[await s.getHashTableById(i.id).find(a,o)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8e=(r,t,n)=>{switch(r.op){case"ResizeBilinear":{const s=G("images",r,t,n),i=G("size",r,t,n),a=G("alignCorners",r,t,n),o=G("halfPixelCenters",r,t,n);return[xu.resizeBilinear(s,[i[0],i[1]],a,o)]}case"ResizeNearestNeighbor":{const s=G("images",r,t,n),i=G("size",r,t,n),a=G("alignCorners",r,t,n),o=G("halfPixelCenters",r,t,n);return[xu.resizeNearestNeighbor(s,[i[0],i[1]],a,o)]}case"CropAndResize":{const s=G("image",r,t,n),i=G("boxes",r,t,n),a=G("boxInd",r,t,n),o=G("cropSize",r,t,n),u=G("method",r,t,n),l=G("extrapolationValue",r,t,n);return[xu.cropAndResize(s,i,a,o,u,l)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8e=(r,t,n)=>{switch(r.op){case"Equal":return[n1(G("a",r,t,n),G("b",r,t,n))];case"NotEqual":return[sA(G("a",r,t,n),G("b",r,t,n))];case"Greater":return[Yl(G("a",r,t,n),G("b",r,t,n))];case"GreaterEqual":return[sp(G("a",r,t,n),G("b",r,t,n))];case"Less":return[J2(G("a",r,t,n),G("b",r,t,n))];case"LessEqual":return[ip(G("a",r,t,n),G("b",r,t,n))];case"LogicalAnd":return[$d(G("a",r,t,n),G("b",r,t,n))];case"LogicalNot":return[ew(G("a",r,t,n))];case"LogicalOr":return[eA(G("a",r,t,n),G("b",r,t,n))];case"Select":case"SelectV2":return[Lo(G("condition",r,t,n),G("a",r,t,n),G("b",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8e=(r,t,n)=>{switch(r.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[kr(G("a",r,t,n),G("b",r,t,n),G("transposeA",r,t,n),G("transposeB",r,t,n))];case"Transpose":return[Id(G("x",r,t,n),G("perm",r,t,n))];case"_FusedMatMul":const[s,i]=G("fusedOps",r,t,n),a=s==="biasadd",o=i==="prelu",u=G("numArgs",r,t,n),l=G("leakyreluAlpha",r,t,n);if(a){if(o&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,h]=G("args",r,t,n);return[VOe({a:G("a",r,t,n),b:G("b",r,t,n),transposeA:G("transposeA",r,t,n),transposeB:G("transposeB",r,t,n),bias:c,activation:i,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S8e=(r,t,n)=>{switch(r.op){case"FusedBatchNorm":case"FusedBatchNormV2":return[_D(G("x",r,t,n),G("mean",r,t,n),G("variance",r,t,n),G("offset",r,t,n),G("scale",r,t,n),G("epsilon",r,t,n))];case"FusedBatchNormV3":return[_D(G("x",r,t,n),G("mean",r,t,n),G("variance",r,t,n),G("offset",r,t,n),G("scale",r,t,n),G("epsilon",r,t,n))];case"LRN":return[cq(G("x",r,t,n),G("radius",r,t,n),G("bias",r,t,n),G("alpha",r,t,n),G("beta",r,t,n))];case"Softmax":return[Sq(G("x",r,t,n))];case"LogSoftmax":return[fq(G("x",r,t,n))];case"SparseToDense":return[Aq(G("sparseIndices",r,t,n),G("outputShape",r,t,n),G("sparseValues",r,t,n),G("defaultValue",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8e=(r,t,n)=>{switch(r.op){case"Max":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[zc(G("x",r,t,n),o,u)]}case"Mean":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[pq(G("x",r,t,n),o,u)]}case"Min":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[Nb(G("x",r,t,n),o,u)]}case"Sum":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[Cn(G("x",r,t,n),o,u)]}case"All":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[jH(G("x",r,t,n),o,u)]}case"Any":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[WH(G("x",r,t,n),o,u)]}case"ArgMax":{const o=G("axis",r,t,n);return[HH(G("x",r,t,n),o)]}case"ArgMin":{const o=G("axis",r,t,n);return[qH(G("x",r,t,n),o)]}case"Prod":{const o=G("axis",r,t,n),u=G("keepDims",r,t,n);return[oA(G("x",r,t,n),o,u)]}case"Cumsum":{const o=G("axis",r,t,n),u=G("exclusive",r,t,n),l=G("reverse",r,t,n);return[Hk(G("x",r,t,n),o,u,l)]}case"Bincount":const s=G("x",r,t,n),i=G("weights",r,t,n),a=G("size",r,t,n);return[s4e(s,i,a)];case"DenseBincount":{const o=G("x",r,t,n),u=G("weights",r,t,n),l=G("size",r,t,n),c=G("binaryOutput",r,t,n);return[w4e(o,u,l,c)]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _8e=(r,t,n)=>{switch(r.op){case"ConcatV2":case"Concat":{const s=G("n",r,t,n),i=G("axis",r,t,n);let a=G("tensors",r,t,n);return a=a.slice(0,s),[Ji(a,i)]}case"Gather":{const s=G("x",r,t,n),i=G("indices",r,t,n);return[Db(s,zt(i,"int32"),0)]}case"GatherV2":{const s=G("axis",r,t,n),i=G("batchDims",r,t,n),a=G("x",r,t,n),o=G("indices",r,t,n);return[Db(a,zt(o,"int32"),s,i)]}case"Reverse":{const s=G("dims",r,t,n),i=[];for(let o=0;o<s.length;o++)s[o]&&i.push(o);const a=G("x",r,t,n);return[Rd(a,i)]}case"ReverseV2":{const s=G("axis",r,t,n),i=G("x",r,t,n);return[Rd(i,s)]}case"Slice":{const s=G("begin",r,t,n),i=G("size",r,t,n);return[Gr(G("x",r,t,n),s,i)]}case"StridedSlice":{const s=G("begin",r,t,n),i=G("end",r,t,n),a=G("strides",r,t,n),o=G("beginMask",r,t,n),u=G("endMask",r,t,n),l=G("ellipsisMask",r,t,n),c=G("newAxisMask",r,t,n),h=G("shrinkAxisMask",r,t,n),f=G("x",r,t,n);return[Eq(f,s,i,a,o,u,l,c,h)]}case"Pack":return Fn(()=>{const s=G("axis",r,t,n),i=G("tensors",r,t,n),a=i[0].shape,o=Ib(i[0]).shape,u=i.map(l=>{const c=dh(l.shape,a);if(!c&&!dh(Ib(l).shape,o))throw new Error("the input tensors shape does not match");return c?l:He(l,a)});return[xh(u,s)]});case"Unpack":{const s=G("axis",r,t,n),i=G("tensor",r,t,n);return Fh(i,s)}case"Tile":{const s=G("reps",r,t,n);return[Xk(G("x",r,t,n),s)]}case"Split":case"SplitV":{const s=G("axis",r,t,n),i=G("numOrSizeSplits",r,t,n),a=G("x",r,t,n);return Sg(a,i,s)}case"ScatterNd":{const s=G("indices",r,t,n),i=G("values",r,t,n),a=G("shape",r,t,n);return[TOe(s,i,a)]}case"GatherNd":{const s=G("x",r,t,n),i=G("indices",r,t,n);return[IOe(s,i)]}case"SparseToDense":{const s=G("sparseIndices",r,t,n),i=G("outputShape",r,t,n),a=G("sparseValues",r,t,n),o=G("defaultValue",r,t,n);return[Aq(s,a,i,a.dtype===o.dtype?o:zt(o,a.dtype))]}default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8e=(r,t,n)=>{switch(r.op){case"FFT":return[dA(G("x",r,t,n))];case"IFFT":return[Ab(G("x",r,t,n))];case"RFFT":return[_q(G("x",r,t,n))];case"IRFFT":return[Cq(G("x",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8e=(r,t,n)=>{switch(r.op){case"Cast":return[zt(G("x",r,t,n),G("dtype",r,t,n))];case"ExpandDims":{const s=G("axis",r,t,n);return[Kk(G("x",r,t,n),s)]}case"Squeeze":{const s=G("axis",r,t,n);return[Ib(G("x",r,t,n),s)]}case"Reshape":return[He(G("x",r,t,n),G("shape",r,t,n))];case"MirrorPad":return[mq(G("x",r,t,n),G("padding",r,t,n),G("mode",r,t,n))];case"PadV2":case"Pad":return[iA(G("x",r,t,n),G("padding",r,t,n),G("constantValue",r,t,n))];case"SpaceToBatchND":{const s=G("blockShape",r,t,n),i=G("paddings",r,t,n);return[nw(G("x",r,t,n),s,i)]}case"BatchToSpaceND":{const s=G("blockShape",r,t,n),i=G("crops",r,t,n);return[Z2(G("x",r,t,n),s,i)]}case"DepthToSpace":{const s=G("blockSize",r,t,n),i=G("dataFormat",r,t,n).toUpperCase();return[iq(G("x",r,t,n),s,i)]}case"BroadcastTo":return[Eb(G("x",r,t,n),G("shape",r,t,n))];default:throw TypeError(`Node type ${r.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(r,t,n,s){const i=((a,o,u)=>{switch(a.category){case"arithmetic":return Fn(()=>r8e(a,o,u));case"basic_math":return Fn(()=>s8e(a,o,u));case"control":return h8e(a,o,u);case"convolution":return Fn(()=>f8e(a,o,u));case"creation":return Fn(()=>d8e(a,o,u));case"dynamic":return p8e(a,o,u);case"evaluation":return Fn(()=>m8e(a,o,u));case"image":return Fn(()=>b8e(a,o,u));case"graph":return Fn(()=>g8e(a,o,u));case"logical":return Fn(()=>v8e(a,o,u));case"matrices":return Fn(()=>w8e(a,o,u));case"normalization":return Fn(()=>S8e(a,o,u));case"reduction":return Fn(()=>C8e(a,o,u));case"slice_join":return Fn(()=>_8e(a,o,u));case"spectral":return Fn(()=>E8e(a,o,u));case"transformation":return Fn(()=>D8e(a,o,u));case"hash_table":return x8e(a,o,u,s);case"custom":const l=Lq(a.op);if(l&&l.customExecutor)return l.customExecutor(new n8e(a,o,u));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(r,t,n);return vg(i)?i.then(a=>[].concat(a)):[].concat(i)}class LL{constructor(t={},n={},s={},i={}){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(r,t,n,s){const i=new Set,a=[];let o=null,u=null;const l=new Set,c=Object.keys(r).map(p=>Di(p)[0]);let h=[];s!=null&&(h=s.map(p=>Di(p.name)[0]));const f=[...t];for(;f.length>0;){const p=f.pop();if((Vq(p)||I8e(p)||$8e(p))&&o==null&&(o=p,u=o.children.map(g=>g.name).filter(g=>i.has(g))),i.add(p.name),n[p.name]==null&&c.indexOf(p.name)===-1&&h.indexOf(p.name)===-1){if(p.inputs.length===0){a.push(p.name);continue}p.inputs.forEach(g=>{l.has(g.name)||(l.add(g.name),f.push(g))})}}return{inputs:r,outputs:t,usedNodes:i,missingInputs:a,dynamicNode:o,syncInputs:u}}function T8e(r,t,n){const{usedNodes:s,inputs:i}=n,a=[],o=Object.keys(i).map(h=>Di(h)[0]).map(h=>r.nodes[h]),u=r.initNodes;o.forEach(h=>{s.has(h.name)&&a.push(h)}),r.weights.forEach(h=>{s.has(h.name)&&a.push(h)}),u!=null&&u.forEach(h=>{s.has(h.name)&&a.push(h)});const l=new Set,c=[];for(;a.length>0;){const h=a.pop();l.add(h.name),t[h.name]||c.push(h),h.children.forEach(f=>{!l.has(f.name)&&s.has(f.name)&&f.inputs.every(p=>l.has(p.name))&&a.push(f)})}return c}const N8e=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],k8e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],A8e=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2"];function Vq(r){return N8e.indexOf(r.op)>=0}function I8e(r){return k8e.indexOf(r.op)>=0}function $8e(r){return A8e.indexOf(r.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fb{constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new Fb(t.functions[s],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(s=>t[s].map(i=>i.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}getCompilationKey(t,n){const s=t.map(a=>a.name).sort(),i=n.map(a=>a.name).sort();return s.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)}compile(t,n){const s=BL(t,n,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:a,syncInputs:o}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(i.length>0){const u=n.map(c=>c.name),l=Object.keys(t);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${l}]. Missing the following inputs: [${i}]`)}return T8e(this.graph,this.weightMap,s)}execute(t,n){t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const i=s.map(f=>this.graph.nodes[Di(f)[0]]),a=n.map(f=>Di(f)[0]);let o=a.map(f=>this.graph.nodes[f]);o.length===0&&(o=this._outputs);const u=this.getCompilationKey(i,o);let l=this.compiledMap.get(u);l==null&&(l=this.compile(t,o),this.compiledMap.set(u,l));const c={},h={};return Fn(()=>{const f=new LL(this.weightMap,c,h,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(t).forEach(x=>{const[v,S]=Di(x),w=[];w[S]=t[x],p[v]=w});const g=this.getFrozenTensorIds(p),y={};for(let x=0;x<l.length;x++){const v=l[x];if(!p[v.name]){const S=ML(v,p,f,this._resourceManager);if(vg(S))throw new Error(`The execution of the op '${v.op}' returned a promise. Please use model.executeAsync() instead.`);p[v.name]=S,this.checkTensorForDisposal(v.name,v,p,f,g,a,y)}}return this.parent==null&&f.dispose(g),n.map(x=>hi(x,p,f))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(i=>i.id)));return new Set(n)}checkTensorForDisposal(t,n,s,i,a,o,u){n.category==="control"||o.indexOf(t)!==-1||(s[t].forEach(l=>{l!=null&&(u[l.id]=(u[l.id]||0)+n.children.length)}),n.inputs.forEach(l=>{if(l.category!=="control"){const c=v6e(l.name,s,i);c!=null&&c.forEach(h=>{if(h&&!a.has(h.id)){const f=u[h.id];f===1?(h.dispose(),delete u[h.id]):f!=null&&u[h.id]--}})}}))}async executeAsync(t,n){return this._executeAsync(t,n)}async _executeAsync(t,n,s=!1,i={},a={}){s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));const o=new LL(this.weightMap,i,a,this.functionExecutorMap),u=await this.executeWithControlFlow(t,o,n,s),l=n.map(p=>hi(p,u,o)),c=l.map(p=>p.id),h=Object.keys(t).map(p=>t[p].id),f=new Set([...c,...h,...this.weightIds]);return Object.keys(u).forEach(p=>{u[p].forEach(y=>{y&&!y.isDisposed&&!f.has(y.id)&&y.dispose()})}),this.parent==null&&o.dispose(f),l}async executeFunctionAsync(t,n,s){const i=t.reduce((a,o,u)=>(a[this.inputs[u].name]=o,a),{});return this._executeAsync(i,this.outputNodes,!0,n,s)}async executeWithControlFlow(t,n,s,i){const a=Object.keys(t),o=a.map(E=>this.graph.nodes[Di(E)[0]]),u=s.map(E=>Di(E)[0]);let l=u.map(E=>this.graph.nodes[E]);l.length===0&&(l=this._outputs);const{usedNodes:c,missingInputs:h,dynamicNode:f,syncInputs:p}=BL(t,l,this.weightMap,this._initNodes),g=[...o,...this.graph.weights,...this._initNodes||[]].map(E=>({node:E,contexts:n.currentContext})),y=Object.assign({},this.weightMap);Object.keys(t).forEach(E=>{const[_,D]=Di(E),I=[];I[D]=t[E],y[_]=I});const x={},v=this.getFrozenTensorIds(y),S={};for(;g.length>0;){const E=this.processStack(o,g,n,y,S,v,u,x,c);await Promise.all(E)}f==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=l.filter(E=>!Vq(E)&&!hi(E.name,y,n)).map(E=>E.name);if(w.length>0){let E="";throw f!=null&&(E=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${a}]. Consider providing the following inputs: [${h}]. ${E}`)}return y}processStack(t,n,s,i,a,o,u,l,c){const h=[];for(;n.length>0;){const f=n.pop();s.currentContext=f.contexts;let p="";if(f.node.op==="Enter"&&G("isConstant",f.node,i,s)&&([p]=lu(f.node.name,s)),i[f.node.name]==null){const g=ML(f.node,i,s,this._resourceManager);p||([p]=lu(f.node.name,s));const y=s.currentContext;vg(g)?h.push(g.then(x=>(i[p]=x,s.currentContext=y,this.checkTensorForDisposal(p,f.node,i,s,o,u,l),this.processChildNodes(f.node,n,s,i,a,c),x))):(i[p]=g,this.checkTensorForDisposal(p,f.node,i,s,o,u,l),this.processChildNodes(f.node,n,s,i,a,c))}else this.processChildNodes(f.node,n,s,i,a,c)}return h}processChildNodes(t,n,s,i,a,o){t.children.forEach(u=>{const[l]=lu(u.name,s);a[l]||!o.has(u.name)||(u.op==="Merge"?u.inputNames.some(c=>!!hi(c,i,s))&&(a[l]=!0,n.push({contexts:s.currentContext,node:u})):u.inputNames.every(c=>!!hi(c,i,s))&&(a[l]=!0,n.push({contexts:s.currentContext,node:u})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const s=t[n],[i]=Di(n),a=this.graph.nodes[i];if(a.attrParams.shape&&a.attrParams.shape.value){const o=a.attrParams.shape.value,u=o.length===s.shape.length&&s.shape.every((l,c)=>o[c]===-1||o[c]===l);ye(u,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${o}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&ye(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){const n={};for(const s in t)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[s]!=null){const i=this._signature.inputs[s];n[i.name]=t[s]}else n[s]=t[s];return n}checkInputs(t){const n=Object.keys(t).filter(s=>{const[i]=Di(s);return this.graph.nodes[i]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(t){t.forEach(n=>{const[s]=Di(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class F8e{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8e="?tfjs-format=file",O8e="model.json";class M8e{constructor(t,n={}){this.modelUrl=t,this.loadOptions=n,this.version="n/a",n==null&&(this.loadOptions={}),this.resourceManager=new F8e}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=gL(t,this.loadOptions);else{const n=H5e(t,this.loadOptions);if(n.length===0)n.push(gL(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}async load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=await this.handler.load();return this.loadSync(t)}loadSync(t){this.artifacts=t;const n=this.artifacts.modelTopology;let s;this.artifacts.userDefinedMetadata!=null&&this.artifacts.userDefinedMetadata.signature!=null?s=this.artifacts.userDefinedMetadata.signature:s=this.artifacts.signature,this.signature=s,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const i=L5e(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Fb(FL.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const a=FL.Instance.transformGraph(t.modelInitializer);this.initializer=new Fb(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,n){if(typeof t=="string"){const s=W5e(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,n){return this.execute(t,this.outputNodes)}normalizeInputs(t){if(!(t instanceof Re)&&!Array.isArray(t))return t;if(t=Array.isArray(t)?t:[t],t.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((n,s,i)=>(n[s]=t[i],n),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=this.executor.execute(t,n);return s.length>1?s:s[0]}async executeAsync(t,n){t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(t,n);return s.length>1?s:s[0]}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,s)=>(n[s]=[t[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function zq(r,t={}){if(r==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&r.load==null&&(r.endsWith("/")||(r=r+"/"),r=`${r}${O8e}${R8e}`);const n=new M8e(r,t);return await n.load(),n}/**
    * @license
    * Copyright 2020 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var LD=function(){return(LD=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i]);return r}).apply(this,arguments)};function Uc(r,t,n,s){return new(n||(n=Promise))(function(i,a){function o(c){try{l(s.next(c))}catch(h){a(h)}}function u(c){try{l(s.throw(c))}catch(h){a(h)}}function l(c){var h;c.done?i(c.value):(h=c.value,h instanceof n?h:new n(function(f){f(h)})).then(o,u)}l((s=s.apply(r,[])).next())})}function Gc(r,t){var n,s,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(l){return function(c){return function(h){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(i=2&h[0]?s.return:h[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,h[1])).done)return i;switch(s=0,i&&(h=[2&h[0],i.value]),h[0]){case 0:case 1:i=h;break;case 4:return o.label++,{value:h[1],done:!1};case 5:o.label++,s=h[1],h=[0];continue;case 7:h=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!((i=i.length>0&&i[i.length-1])||h[0]!==6&&h[0]!==2)){o=0;continue}if(h[0]===3&&(!i||h[1]>i[0]&&h[1]<i[3])){o.label=h[1];break}if(h[0]===6&&o.label<i[1]){o.label=i[1],i=h;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(h);break}i[2]&&o.ops.pop(),o.trys.pop();continue}h=t.call(r,o)}catch(f){h=[6,f],s=0}finally{n=i=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}([l,c])}}}const Uq=r=>({startEndTensor:r,startPoint:Gr(r,[0,0],[-1,2]),endPoint:Gr(r,[0,2],[-1,2])}),L8e={strides:[8,16],anchors:[2,6]};function PL(r,t){let n,s,i;if(r.topLeft instanceof Re&&r.bottomRight instanceof Re){const[o,u]=Fn(()=>[Ji([nr(t-1,r.topLeft.slice(0,1)),r.topLeft.slice(1,1)]),Ji([nr(t-1,r.bottomRight.slice(0,1)),r.bottomRight.slice(1,1)])]);n=o,s=u,r.landmarks!=null&&(i=Fn(()=>{const l=nr(ea([t-1,0]),r.landmarks),c=ea([1,-1]);return xt(l,c)}))}else{const[o,u]=r.topLeft,[l,c]=r.bottomRight;n=[t-1-o,u],s=[t-1-l,c],r.landmarks!=null&&(i=r.landmarks.map(h=>[t-1-h[0],h[1]]))}const a={topLeft:n,bottomRight:s};return i!=null&&(a.landmarks=i),r.probability!=null&&(a.probability=r.probability instanceof Re?r.probability.clone():r.probability),a}function VL(r,t){return Fn(()=>{let n;return n=r.hasOwnProperty("box")?r.box:r,((s,i)=>{const a=xt(s.startPoint,i),o=xt(s.endPoint,i),u=nq([a,o],1);return Uq(u)})(n,t).startEndTensor.squeeze()})}class B8e{constructor(t,n,s,i,a,o){this.blazeFaceModel=t,this.width=n,this.height=s,this.maxFaces=i,this.anchorsData=function(u,l,c){const h=[];for(let f=0;f<c.strides.length;f++){const p=c.strides[f],g=Math.floor((l+p-1)/p),y=Math.floor((u+p-1)/p),x=c.anchors[f];for(let v=0;v<g;v++){const S=p*(v+.5);for(let w=0;w<y;w++){const E=p*(w+.5);for(let _=0;_<x;_++)h.push([E,S])}}}return h}(n,s,L8e),this.anchors=ED(this.anchorsData),this.inputSizeData=[n,s],this.inputSize=ea([n,s]),this.iouThreshold=a,this.scoreThreshold=o}async getBoundingBoxes(t,n,s=!0){const[i,a,o]=Fn(()=>{const x=t.resizeBilinear([this.width,this.height]),v=xt(nr(x.div(255),.5),2),S=this.blazeFaceModel.predict(v).squeeze(),w=function(_,D,I){const k=Gr(_,[0,1],[-1,2]),A=ms(k,D),N=Gr(_,[0,3],[-1,2]),F=tr(N,I),$=tr(A,I),O=tr(F,2),M=nr($,O),B=ms($,O),U=xt(M,I),V=xt(B,I);return nq([U,V],1)}(S,this.anchors,this.inputSize),E=Gr(S,[0,0],[-1,1]);return[S,w,e1(E).squeeze()]}),u=console.warn;console.warn=()=>{};const l=xu.nonMaxSuppression(a,o,this.maxFaces,this.iouThreshold,this.scoreThreshold);console.warn=u;const c=await l.array();l.dispose();let h=c.map(x=>Gr(a,[x,0],[1,-1]));n||(h=await Promise.all(h.map(async x=>{const v=await x.array();return x.dispose(),v})));const f=t.shape[1],p=t.shape[2];let g;g=n?tr([p,f],this.inputSize):[p/this.inputSizeData[0],f/this.inputSizeData[1]];const y=[];for(let x=0;x<h.length;x++){const v=h[x],S=Fn(()=>{const w=Uq(v instanceof Re?v:ED(v));if(!s)return w;const E=c[x];let _;return _=n?this.anchors.slice([E,0],[1,2]):this.anchorsData[E],{box:w,landmarks:Gr(i,[E,5],[1,-1]).squeeze().reshape([6,-1]),probability:Gr(o,[E],[1]),anchor:_}});y.push(S)}return a.dispose(),o.dispose(),i.dispose(),{boxes:y,scaleFactor:g}}async estimateFaces(t,n=!1,s=!1,i=!0){const[,a]=function(c){return c instanceof Re?[c.shape[0],c.shape[1]]:[c.height,c.width]}(t),o=Fn(()=>(t instanceof Re||(t=zH(t)),t.toFloat().expandDims(0))),{boxes:u,scaleFactor:l}=await this.getBoundingBoxes(o,n,i);return o.dispose(),n?u.map(c=>{const h=VL(c,l);let f={topLeft:h.slice([0],[2]),bottomRight:h.slice([2],[2])};if(i){const{landmarks:p,probability:g,anchor:y}=c,x=p.add(y).mul(l);f.landmarks=x,f.probability=g}return s&&(f=PL(f,a)),f}):Promise.all(u.map(async c=>{const h=VL(c,l);let f;if(i){const[p,g,y]=await Promise.all([c.landmarks,h,c.probability].map(async E=>E.array())),x=c.anchor,[v,S]=l,w=p.map(E=>[(E[0]+x[0])*v,(E[1]+x[1])*S]);f={topLeft:g.slice(0,2),bottomRight:g.slice(2),landmarks:w,probability:y},(E=>{E.startEndTensor.dispose(),E.startPoint.dispose(),E.endPoint.dispose()})(c.box),c.landmarks.dispose(),c.probability.dispose()}else{const p=await h.array();f={topLeft:p.slice(0,2),bottomRight:p.slice(2)}}return h.dispose(),s&&(f=PL(f,a)),f}))}}async function P8e({maxFaces:r=10,inputWidth:t=128,inputHeight:n=128,iouThreshold:s=.3,scoreThreshold:i=.75}={}){const a=await zq("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0});return new B8e(a,t,n,r,s,i)}var $_={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]};function Gq(r){return[Math.abs(r.endPoint[0]-r.startPoint[0]),Math.abs(r.endPoint[1]-r.startPoint[1])]}function BD(r){return[r.startPoint[0]+(r.endPoint[0]-r.startPoint[0])/2,r.startPoint[1]+(r.endPoint[1]-r.startPoint[1])/2]}function zL(r,t){t===void 0&&(t=1.5);var n=BD(r),s=Gq(r),i=[t*s[0]/2,t*s[1]/2];return{startPoint:[n[0]-i[0],n[1]-i[1]],endPoint:[n[0]+i[0],n[1]+i[1]],landmarks:r.landmarks}}function UL(r,t){var n,s=Math.PI/2-Math.atan2(-(t[1]-r[1]),t[0]-r[0]);return(n=s)-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}function GL(r,t){return[[1,0,r],[0,1,t],[0,0,1]]}function _c(r,t){for(var n=0,s=0;s<r.length;s++)n+=r[s]*t[s];return n}function V8e(r,t){for(var n=[],s=0;s<r.length;s++)n.push(r[s][t]);return n}function jL(r,t){for(var n=[],s=r.length,i=0;i<s;i++){n.push([]);for(var a=0;a<s;a++)n[i].push(_c(r[i],V8e(t,a)))}return n}function WL(r,t){var n=Math.cos(r),s=Math.sin(r),i=[[n,-s,0],[s,n,0],[0,0,1]],a=jL(GL(t[0],t[1]),i);return jL(a,GL(-t[0],-t[1]))}var HL=[1,168],qL=[3,2],z8e=function(){function r(t,n,s,i,a,o){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=t,this.meshDetector=n,this.meshWidth=s,this.meshHeight=i,this.maxContinuousChecks=a,this.maxFaces=o}return r.prototype.transformRawCoords=function(t,n,s,i){var a,o,u,l,c=this,h=Gq({startPoint:n.startPoint,endPoint:n.endPoint}),f=[h[0]/this.meshWidth,h[1]/this.meshHeight],p=t.map(function(w){return[f[0]*(w[0]-c.meshWidth/2),f[1]*(w[1]-c.meshHeight/2),w[2]]}),g=WL(s,[0,0]),y=p.map(function(w){return function(E,_){return[_c(E,_[0]),_c(E,_[1])]}(w,g).concat([w[2]])}),x=(o=[[(a=i)[0][0],a[1][0]],[a[0][1],a[1][1]]],u=[a[0][2],a[1][2]],l=[-_c(o[0],u),-_c(o[1],u)],[o[0].concat(l[0]),o[1].concat(l[1]),[0,0,1]]),v=BD({startPoint:n.startPoint,endPoint:n.endPoint}).concat([1]),S=[_c(v,x[0]),_c(v,x[1])];return y.map(function(w){return[w[0]+S[0],w[1]+S[1],w[2]]})},r.prototype.predict=function(t){return Uc(this,void 0,void 0,function(){var n,s,i,a,o=this;return Gc(this,function(u){switch(u.label){case 0:return this.shouldUpdateRegionsOfInterest()?[4,this.boundingBoxDetector.getBoundingBoxes(t,!1,!0)]:[3,2];case 1:return n=u.sent(),s=n.boxes,i=n.scaleFactor,s.length===0?(this.regionsOfInterest=[],[2,null]):(a=s.map(function(l){var c,h,f={startPoint:l.box.startPoint.squeeze().arraySync(),endPoint:l.box.endPoint.squeeze().arraySync()},p=zL((h=i,{startPoint:[(c=f).startPoint[0]*h[0],c.startPoint[1]*h[1]],endPoint:[c.endPoint[0]*h[0],c.endPoint[1]*h[1]]}));return LD({},p,{landmarks:l.landmarks.arraySync()})}),s.forEach(function(l){l!=null&&l.startPoint!=null&&(l.startEndTensor.dispose(),l.startPoint.dispose(),l.endPoint.dispose())}),this.updateRegionsOfInterest(a),this.runsWithoutFaceDetector=0,[3,3]);case 2:this.runsWithoutFaceDetector++,u.label=3;case 3:return[2,Fn(function(){return o.regionsOfInterest.map(function(l,c){var h;if(l.landmarks.length===468){var f=HL[0],p=HL[1];h=UL(l.landmarks[f],l.landmarks[p])}else f=qL[0],p=qL[1],h=UL(l.landmarks[f],l.landmarks[p]);var g=BD({startPoint:l.startPoint,endPoint:l.endPoint}),y=[g[0]/t.shape[2],g[1]/t.shape[1]],x=xu.rotateWithOffset(t,h,0,y),v=WL(-h,g),S=function(F,$,O){var M=$.shape[1],B=$.shape[2],U=[[F.startPoint[1]/M,F.startPoint[0]/B,F.endPoint[1]/M,F.endPoint[0]/B]];return xu.cropAndResize($,U,[0],O)}({startPoint:l.startPoint,endPoint:l.endPoint},x,[o.meshHeight,o.meshWidth]).div(255),w=o.meshDetector.predict(S),E=w[1],_=w[2],D=He(_,[-1,3]),I=D.arraySync(),k=o.transformRawCoords(I,l,h,v),A=ED(k),N=o.calculateLandmarksBoundingBox(k);return o.regionsOfInterest[c]=LD({},N,{landmarks:A.arraySync()}),{coords:D,scaledCoords:A,box:N,flag:E.squeeze()}})})]}})})},r.prototype.updateRegionsOfInterest=function(t){for(var n=0;n<t.length;n++){var s=t[n],i=this.regionsOfInterest[n],a=0;if(i&&i.startPoint){var o=s.startPoint,u=o[0],l=o[1],c=s.endPoint,h=c[0],f=c[1],p=i.startPoint,g=p[0],y=p[1],x=i.endPoint,v=x[0],S=x[1],w=Math.max(u,g),E=Math.max(l,y),_=(Math.min(h,v)-w)*(Math.min(f,S)-E);a=_/((h-u)*(f-l)+(v-g)*(S-l)-_)}a<.25&&(this.regionsOfInterest[n]=s)}this.regionsOfInterest=this.regionsOfInterest.slice(0,t.length)},r.prototype.clearRegionOfInterest=function(t){this.regionsOfInterest[t]!=null&&(this.regionsOfInterest=this.regionsOfInterest.slice(0,t).concat(this.regionsOfInterest.slice(t+1)))},r.prototype.shouldUpdateRegionsOfInterest=function(){var t=this.regionsOfInterest.length,n=t===0;return this.maxFaces===1||n?n:t!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks},r.prototype.calculateLandmarksBoundingBox=function(t){var n=t.map(function(a){return a[0]}),s=t.map(function(a){return a[1]}),i={startPoint:[Math.min.apply(Math,n),Math.min.apply(Math,s)],endPoint:[Math.max.apply(Math,n),Math.max.apply(Math,s)]};return zL({startPoint:i.startPoint,endPoint:i.endPoint})},r}(),U8e=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]];function G8e(r){var t=r===void 0?{}:r,n=t.maxContinuousChecks,s=n===void 0?5:n,i=t.detectionConfidence,a=i===void 0?.9:i,o=t.maxFaces,u=o===void 0?10:o,l=t.iouThreshold,c=l===void 0?.3:l,h=t.scoreThreshold,f=h===void 0?.75:h;return Uc(this,void 0,void 0,function(){var p,g,y;return Gc(this,function(x){switch(x.label){case 0:return[4,Promise.all([j8e(u,c,f),W8e()])];case 1:return p=x.sent(),g=p[0],y=p[1],[2,new H8e(g,y,s,a,u)]}})})}function j8e(r,t,n){return Uc(this,void 0,void 0,function(){return Gc(this,function(s){return[2,P8e({maxFaces:r,iouThreshold:t,scoreThreshold:n})]})})}function W8e(){return Uc(this,void 0,void 0,function(){return Gc(this,function(r){return[2,zq("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})]})})}function KL(r,t){if(r.mesh instanceof Re){var n=Fn(function(){var u=ea([t-1,0,0]),l=ea([1,-1,1]);return Fn(function(){return[Ji([nr(t-1,r.boundingBox.topLeft.slice(0,1)),r.boundingBox.topLeft.slice(1,1)]),Ji([nr(t-1,r.boundingBox.bottomRight.slice(0,1)),r.boundingBox.bottomRight.slice(1,1)]),nr(u,r.mesh).mul(l),nr(u,r.scaledMesh).mul(l)]})}),s=n[0],i=n[1],a=n[2],o=n[3];return Object.assign({},r,{boundingBox:{topLeft:s,bottomRight:i},mesh:a,scaledMesh:o})}return Object.assign({},r,{boundingBox:{topLeft:[t-1-r.boundingBox.topLeft[0],r.boundingBox.topLeft[1]],bottomRight:[t-1-r.boundingBox.bottomRight[0],r.boundingBox.bottomRight[1]]},mesh:r.mesh.map(function(u){var l=u.slice(0);return l[0]=t-1-u[0],l}),scaledMesh:r.scaledMesh.map(function(u){var l=u.slice(0);return l[0]=t-1-u[0],l})})}var H8e=function(){function r(t,n,s,i,a){this.pipeline=new z8e(t,n,192,192,s,a),this.detectionConfidence=i}return r.getAnnotations=function(){return $_},r.getUVCoords=function(){return U8e},r.prototype.estimateFaces=function(t,n,s){return n===void 0&&(n=!1),s===void 0&&(s=!1),Uc(this,void 0,void 0,function(){var i,a,o,u,l,c=this;return Gc(this,function(h){switch(h.label){case 0:return i=function(f){return f instanceof Re?[f.shape[0],f.shape[1]]:[f.height,f.width]}(t),a=i[1],o=Fn(function(){return t instanceof Re||(t=zH(t)),t.toFloat().expandDims(0)}),C$e()!=="webgl"?[3,2]:(l=yr().get("WEBGL_PACK_DEPTHWISECONV"),yr().set("WEBGL_PACK_DEPTHWISECONV",!0),[4,this.pipeline.predict(o)]);case 1:return u=h.sent(),yr().set("WEBGL_PACK_DEPTHWISECONV",l),[3,4];case 2:return[4,this.pipeline.predict(o)];case 3:u=h.sent(),h.label=4;case 4:return o.dispose(),u!=null&&u.length>0?[2,Promise.all(u.map(function(f,p){return Uc(c,void 0,void 0,function(){var g,y,x,v,S,w,E,_,D,I,k,A,N,F,$=this;return Gc(this,function(O){switch(O.label){case 0:return g=f.coords,y=f.scaledCoords,x=f.box,v=f.flag,S=[v],n||(S=S.concat([g,y])),[4,Promise.all(S.map(function(M){return Uc($,void 0,void 0,function(){return Gc(this,function(B){return[2,M.array()]})})}))];case 1:if(w=O.sent(),E=w[0],v.dispose(),E<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(p),n)return _={faceInViewConfidence:E,mesh:g,scaledMesh:y,boundingBox:{topLeft:ea(x.startPoint),bottomRight:ea(x.endPoint)}},s?[2,KL(_,a)]:[2,_];for(F in D=w.slice(1),I=D[0],k=D[1],y.dispose(),g.dispose(),A={faceInViewConfidence:E,boundingBox:{topLeft:x.startPoint,bottomRight:x.endPoint},mesh:I,scaledMesh:k},s&&(A=KL(A,a)),N={},$_)N[F]=$_[F].map(function(M){return A.scaledMesh[M]});return A.annotations=N,[2,A]}})})}))]:[2,[]]}})})},r}();function q8e(){return ht.useEffect(()=>{let r,t,n,s;return(async()=>{r=document.createElement("video"),r.autoplay=!0,r.muted=!0,r.playsInline=!0,r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.setAttribute("playsinline",""),r.style.position="fixed",r.style.top="50%",r.style.left="25%",r.style.transform="translate(-50%, -50%) scaleX(-1)",r.style.width="480px",r.style.height="360px",r.style.zIndex="9998",r.style.opacity="1",document.body.appendChild(r),n=document.createElement("canvas"),n.width=960,n.height=720,n.style.position="fixed",n.style.top="50%",n.style.left="75%",n.style.transform="translate(-50%, -50%) scaleX(-1)",n.style.zIndex="9999",document.body.appendChild(n),s=n.getContext("2d");const a=await navigator.mediaDevices.getUserMedia({video:!0});r.srcObject=a,console.log("Webcam stream set"),await new Promise(u=>{r.onloadeddata=()=>u()}),console.log("Video is ready"),console.log("Video dimensions:",r.videoWidth,r.videoHeight),t=await G8e({maxFaces:1,iouThreshold:.1,scoreThreshold:.3}),console.log("FaceMesh model loaded");const o=async()=>{try{const u=await t.estimateFaces(r);if(console.log("Predictions:",u),s.clearRect(0,0,n.width,n.height),s.save(),s.translate(n.width/2-r.videoWidth/2,n.height/2-r.videoHeight/2),u.length>0&&u[0].scaledMesh){const l=u[0].scaledMesh,c=l[61],h=l[291],f=l[13],p=l[14],g=l[70],y=l[300],x=l[159],v=p[1]-f[1],S=Math.hypot(h[0]-c[0],h[1]-c[1]),w=Math.abs(g[0]-y[0]),E=g[1]-x[1];let _="cyan";for(let D=0;D<l.length;D++){const[I,k]=l[D];s.beginPath(),s.arc(I,k,2.5,0,2*Math.PI),s.fillStyle=_,s.fill()}}if(s.restore(),u.length>0&&u[0].scaledMesh){const l=u[0].scaledMesh,c=l[168][0],h=l[168][1]}}catch(u){console.error("FaceMesh tracking error:",u)}requestAnimationFrame(o)};o()})(),()=>{var a;r&&(r.pause(),(a=r.srcObject)==null||a.getTracks().forEach(o=>o.stop()),r.remove()),n&&n.remove()}},[]),null}const K8e="/assets/me3-baUNWnQp.jpeg",X8e="/assets/me3swag-DO-AmGZR.jpeg",Y8e="/assets/logo-Bcgfp9xE.png";function Z8e(){const[r,t]=ht.useState("home"),[n,s]=ht.useState(!1);return ht.useEffect(()=>{const i=(o,u)=>{const l=document.createElement("div");l.className="gold-dust",l.style.left=`${o}px`,l.style.top=`${u}px`,document.body.appendChild(l),setTimeout(()=>{l.remove()},500)},a=o=>{i(o.clientX,o.clientY)};return window.addEventListener("mousemove",a),()=>window.removeEventListener("mousemove",a)},[]),ht.useEffect(()=>(document.body.style.cursor="none",()=>{document.body.style.cursor="default"}),[]),Se.jsxs("div",{className:"container",children:[Se.jsx("div",{className:"top-left-sidebar",children:Se.jsxs("select",{value:r,onChange:i=>t(i.target.value),children:[Se.jsx("option",{value:"home",children:"Home"}),Se.jsx("option",{value:"drawbot",children:"Drawbot"}),Se.jsx("option",{value:"about",children:"About"}),Se.jsx("option",{value:"facetracker",children:"Face Tracker"})]})}),r==="home"&&Se.jsxs("div",{children:[Se.jsxs("header",{children:[Se.jsx("h1",{children:"Nishanth Alladi"}),Se.jsx("p",{children:"Welcome to my website!"})]}),Se.jsx("div",{className:"sketch-row",style:{display:"flex",justifyContent:"center",alignItems:"flex-start",gap:"2rem"},children:Se.jsx(Tre,{sketch:Nre})})]}),r==="about"&&Se.jsx("section",{className:"about-section",onClick:()=>s(!n),children:Se.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Se.jsx("h1",{style:{fontSize:"2rem",marginBottom:"1rem"},children:"About Me"}),Se.jsx("img",{src:n?X8e:K8e,alt:"Nishanth Alladi",style:{width:"200px",objectFit:"cover",borderRadius:"12px",boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",cursor:"pointer",transition:"transform 0.3s ease",marginBottom:"1rem"}}),Se.jsx("a",{href:"/resume.pdf",target:"_blank",rel:"noopener noreferrer",style:{fontSize:"1rem",color:"#bfa128",textDecoration:"none",padding:"0.5rem 1rem",border:"1px solid #bfa128",borderRadius:"6px",transition:"background 0.3s ease, color 0.3s ease"},onMouseOver:i=>{i.target.style.background="#bfa128",i.target.style.color="#fff"},onMouseOut:i=>{i.target.style.background="transparent",i.target.style.color="#bfa128"},children:"Resume"})]})}),r==="drawbot"&&Se.jsxs("section",{children:[Se.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[Se.jsx("img",{src:Y8e,alt:"Logo",style:{width:"75px",height:"auto"}}),Se.jsx("h1",{children:"Drawbot"})]}),Se.jsx("p",{children:"The Chess robot that never loses...but also never wins!"}),Se.jsx(Lae,{})]}),r==="facetracker"&&Se.jsx("section",{children:Se.jsx(q8e,{})})]})}fY.createRoot(document.getElementById("root")).render(Se.jsx(Z8e,{}));
